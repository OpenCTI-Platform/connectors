version: '3'
services:
  connector-kaspersky-enrichment:
    image: opencti/connector-kaspersky-enrichment:latest
    environment:
      # Generic parameters (connection with OpenCTI)
      - OPENCTI_URL=http://localhost
      - OPENCTI_TOKEN=ChangeMe
      #  Common parameters for connectors of type INTERNAL_ENRICHMENT
      - CONNECTOR_ID=ChangeMe
      # - CONNECTOR_NAME=Kaspersky Enrichment
      # - CONNECTOR_SCOPE=StixFile,IPv4-Addr,Domain-Name,Hostname,Url
      # - CONNECTOR_LOG_LEVEL=error
      # - CONNECTOR_AUTO=true

      # Connector's custom execution parameters
      # - KASPERSKY_API_BASE_URL=https://tip.kaspersky.com
      - KASPERSKY_API_KEY=ChangeMe
      # - KASPERSKY_MAX_TLP=TLP:AMBER
      # - KASPERSKY_ZONE_OCTI_SCORE_MAPPING=red:100,orange:80,yellow:60,gray:20,green:0
      # - KASPERSKY_FILE_SECTIONS=LicenseInfo,Zone,FileGeneralInfo
      # - KASPERSKY_IPV4_SECTIONS=LicenseInfo,Zone,IpGeneralInfo
      # - KASPERSKY_DOMAIN_SECTIONS=LicenseInfo,Zone,DomainGeneralInfo
      # - KASPERSKY_URL_SECTIONS=LicenseInfo,Zone,UrlGeneralInfo

    restart: always
