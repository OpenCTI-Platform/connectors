# RST IoC Lookup Connector for OpenCTI by RST Cloud

The **RST IoC Lookup Connector** to determine whether observables and indicators are malicious and worth detecting. This connector performs checks on IP addresses, domains, URLs, and hash values via the RST Cloud API. It enhances the capabilities of OpenCTI by providing an affordable way to enrich observables or indicators found on the Internet with related threat information such as malware, threat actors, tools, CVEs, TTPs, and more. ([RST IoC Lookup](https://www.rstcloud.com/rst-ioc-lookup/)).

## Key Features

- **Automatic or Manual Trigger**: Indicators and observables can be automatically checked each time they are updated, or users can initiate a check themselves.
- **Score and Confidence Adjustments**: Users can enrich observables and indicators with score and confidence values to help prioritise them.
- **Add references**: Users can check for additional sources referencing a given indicator and populate these references within the platform.
- **Additional context**: Obtain information on ASN, domain numbers, related organisations, geographical locations, WHOIS data, related malware, actors, tools, campaigns, CVEs, TTPs, sectors, and more.
- **Customisable Detection Flag**: Users can specify whether the detection flag (x_opencti_detection=true) is to be set when the score exceeds a specified threshold.

## Requirements

- OpenCTI Platform version 6.0.x or higher.
- An API Key for accessing RST Cloud.

## Configuration

Configuration of the connector is straightforward. The minimal configuration requires you just enter the RST Cloud API key to be provided and OpenCTI connection settings specified. Below is the full list of parameters you can set:

| Parameter                                | Docker envvar                              | Mandatory | Description                                                                                                                                                                                                                                                                                                                 |
| ---------------------------------------- | ------------------------------------------ | --------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| OpenCTI URL                              | `OPENCTI_URL`                              | Yes       | The URL of the OpenCTI platform.                                                                                                                                                                                                                                                                                            |
| OpenCTI Token                            | `OPENCTI_TOKEN`                            | Yes       | The default connector (or admin) token set in the OpenCTI platform.                                                                                                                                                                                                                                                         |
| Connector ID                             | `CONNECTOR_ID`                             | Yes       | A unique `UUIDv4` identifier for this connector instance.                                                                                                                                                                                                                                                                   |
| Connector Name                           | `CONNECTOR_NAME`                           | Yes       | Name of the connector. For example: `RST IoC Lookup`.                                                                                                                                                                                                                                                                       |
| Connector Scope                          | `CONNECTOR_SCOPE`                          | Yes       | The scope or type of data the connector is importing, either a MIME type or Stix Object. E.g. application/json                                                                                                                                                                                                              |
| Log Level                                | `CONNECTOR_LOG_LEVEL`                      | Yes       | Determines the verbosity of the logs. Options are `debug`, `info`, `warn`, or `error`.                                                                                                                                                                                                                                      |
| Run and Terminate                        | `CONNECTOR_RUN_AND_TERMINATE`              | Yes       | If set to true, the connector will terminate after a successful run. Useful for debugging or one-time runs.                                                                                                                                                                                                                 |
| RST IoC Lookup API Key                   | `RST_IOC_LOOKUP_API_KEY`                   | Yes       | Your API Key for accessing RST Cloud.                                                                                                                                                                                                                                                                                       |
| RST IoC Lookup Base URL                  | `RST_IOC_LOOKUP_BASEURL`                   | No        | By default, use `https://api.rstcloud.net/v1/`. In some cases, you may want to use a local API endpoint                                                                                                                                                                                                                     |
| RST IoC Lookup Max TLP                   | `RST_IOC_LOOKUP_MAX_TLP`                   | Yes       | By default, `TLP:AMBER+STRICT`. Use correct TLP values                                                                                                                                                                                                                                                                      |
| RST IoC Lookup Update Confidence         | `RST_IOC_LOOKUP_UPDATE_CONFIDENCE`         | No        | By default, `true`. Update confidence based on the result of enrichment                                                                                                                                                                                                                                                     |
| RST IoC Lookup Update Score              | `RST_IOC_LOOKUP_UPDATE_SCORE`              | No        | By default, `true`. Update score based on the result of enrichment                                                                                                                                                                                                                                                          |
| RST IoC Lookup Update Valid From         | `RST_IOC_LOOKUP_UPDATE_VALID_FROM`         | No        | By default, `true`. Update `valid_from` using the `last_seen` parameter                                                                                                                                                                                                                                                     |
| RST IoC Lookup Label Format              | `RST_IOC_LOOKUP_LABEL_FORMAT`              | No        | By default, `short`. If `short` is specified, then suffixes such as `_group` or `_actor` are remove making labels more universal. If the exact values are required, can be set to `long`                                                                                                                                    |
| RST IoC Lookup Score Type                | `RST_IOC_LOOKUP_SCORE_TYPE`                | No        | By default, the value is set to `total`. The available options are `last` and `total`. The `last` option means that the connector uses the score calculated by the cloud at the time of last_seen. If `total` is specified, the score will reflect the decayed score according to the difference between last_seen and now. |
| RST IoC Lookup Update Description Action | `RST_IOC_LOOKUP_UPDATE_DESCRIPTION_ACTION` | No        | By default, `overwrite`. The options are `overwrite`, `append`, `prepend`. Defines the merge strategy for the description field.                                                                                                                                                                                            |
| RST IoC Lookup Detection Flag Threshold  | `RST_IOC_LOOKUP_DETECTION_FLAG_THRESHOLD`  | No        | By default, 45. The connector will set detection flag to true if the score bigger than the value specified.                                                                                                                                                                                                                 |
| RST IoC Lookup Timeout                   | `RST_IOC_LOOKUP_TIMEOUT`                   | No        | By default, 10. The value specifed how much time to wait for the resposne from the cloud in seconds.                                                                                                                                                                                                                         |
