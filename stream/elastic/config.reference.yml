---
opencti:
  url: 'http://localhost:8080'
  token: 'ChangeMe'
  ssl_verify: True

connector:
  id: 'ChangeMe'
  type: 'STREAM'
  name: 'OpenCTI Elastic Connector'
  scope: 'elastic'
  confidence_level: 80 # From 0 (Unknown) to 100 (Fully trusted). Used for Sightings reported to OpenCTI
  log_level: 'info'
  entity_name: 'Elastic Detection Cluster'
  entity_description: 'Elasticsearch detection engine cluster'
  live_stream_id: 'live'
  live_stream_listen_delete: true
  start_timestamp: '1655890657402' ### format example Wed, 22 Jun 2022 09:46:24 GMT
  mode: ecs # Options are 'ecs' (indicators only), 'ecs_no_signals' (same as 'ecs' but no signal import) 
            # or 'stix' (raw STIX documents)

# =============================== Elastic Cloud ================================
# The cloud.id setting overwrites the `elastic.hosts`
# You can find the `cloud.id` in the Elastic Cloud web UI.
#cloud.id:
# The cloud.auth setting overwrites the `output.elasticsearch.username` and
# `output.elasticsearch.password` settings. The format is `<user>:<pass>`.
# API key is recommended
#cloud.auth:

output:
  elasticsearch:
    # ---------------------------- Elasticsearch Output ----------------------------
    # Array of hosts to connect to.
    # Scheme and port can be left out and will be set to the default (http and 9200)
    # In case you specify an additional path, the scheme is required: http://localhost:9200/path
    # IPv6 addresses should always be defined as: https://[2001:db8::1]:9200
    hosts: ["localhost:9200"]
    # Authentication credentials - either API key or username/password.
    #api_key: "id:api_key"
    #username: "elastic"
    #password: "changeme"
    ssl_verify: true

    # Optional index name. The default is "opencti" plus the date. Uses Elastic date math syntax.
    # Custom index settings are ignored when ILM is enabled.  Be sure to update
    # `setup.template.pattern` if you change the output index.
    #index: "opencti-{now/d}"

    # Set the following flag to "true" if the elasticsearch access do not have cluster 
    # "monitor" privileges
    #reduced_privileges: false 
  
  # store STIX object labels with the indicators in elasticsearch if in 'ecs' or 'ecs_no_signals' mode. 
  include_labels: False

# ====================== Index Lifecycle Management (ILM) ======================

# Configure index lifecycle management (ILM). These settings create a write
# alias and add additional settings to the index template. When ILM is enabled,
# output.elasticsearch.index is ignored, and the write alias is used to set the
# index name.
setup:
  ilm:
    enabled: True
    policy_name: opencti
    rollover_alias: opencti
    # This pattern uses datemath. See https://www.elastic.co/guide/en/beats/filebeat/current/ilm.html
    pattern: "{now/d}-000001"
    overwrite: False
  template:
    enabled: True
    name: opencti
    # This pattern value is used when applying the template, but also used when applying
    # document updates. Make sure this matches the output indices in all cases.
    pattern: opencti-*
    overwrite: False

elastic:
  # ---------------------------- Sightings Settings ----------------------------

  # (optional) This is to fine tune how we find signals generated by the detection engine
  # These are all the defaults, you don't need to change anything or even include it.
  # You could modify the query if you wanted to add some additional criteria.
  # You could also change the signal_index pattern if you had a non-default space in
  # Kibana that you wanted to use to limit the results
  # signals:
  #   query_interval: '5m'
  #   lookback_interval: '5m'
  #   signal_index: '.siem-signals-*'
  #   query: >
  #     {
  #       "query": {
  #         "bool": {
  #           "must": {
  #             "match": { "signal.rule.type": "threat_match" }
  #           }
  #         }
  #       }
  #     }
  # (optional) TLP to use when importing sightings from Elastic, defaults to empty
  #sightings_tlp:
