version: '3'
services:
  connector-elastic-security-intel:
    image: opencti/connector-elastic-security-intel:latest
    environment:
      - OPENCTI_URL=http://localhost
      - OPENCTI_TOKEN=ChangeMe
      - CONNECTOR_ID=ChangeMe
      - CONNECTOR_LIVE_STREAM_ID=ChangeMe # ID of the live stream created in the OpenCTI UI
      - "CONNECTOR_NAME=Elastic Security Intel"
      - ELASTIC_SECURITY_URL=https://localhost:9200
      - ELASTIC_SECURITY_API_KEY=ChangeMe
      - ELASTIC_SECURITY_CLIENT_CERT= # Optional: Path to client certificate file (PEM format)
      - ELASTIC_SECURITY_CLIENT_KEY= # Optional: Path to client key file (PEM format)
      - ELASTIC_SECURITY_VERIFY_SSL=true
      - ELASTIC_SECURITY_INDICATOR_EXPIRE_TIME=90
      - ELASTIC_SECURITY_BATCH_SIZE=100
    restart: always
