version: '3'
services:
  connector-crowdstrike:
    image: opencti/connector-crowdstrike:3.1.0
    environment:
      - OPENCTI_URL=${OPENCTI_URL}
      - OPENCTI_TOKEN=${OPENCTI_TOKEN}
      - CONNECTOR_ID=${CONNECTOR_ID}
      - CONNECTOR_TYPE=${CONNECTOR_TYPE}
      - CONNECTOR_NAME=${CONNECTOR_NAME}
      - CONNECTOR_SCOPE=${CONNECTOR_SCOPE}
      - CONNECTOR_CONFIDENCE_LEVEL=${CONNECTOR_CONFIDENCE_LEVEL}
      - CONNECTOR_UPDATE_EXISTING_DATA=${CONNECTOR_UPDATE_EXISTING_DATA}
      - CONNECTOR_LOG_LEVEL=${CONNECTOR_LOG_LEVEL}
      - CROWDSTRIKE_BASE_URL=${CROWDSTRIKE_BASE_URL}
      - CROWDSTRIKE_CLIENT_ID=${CROWDSTRIKE_CLIENT_ID}
      - CROWDSTRIKE_CLIENT_SECRET=${CROWDSTRIKE_CLIENT_SECRET}
      - CROWDSTRIKE_TLP=${CROWDSTRIKE_TLP}
      - CROWDSTRIKE_SCOPES=${CROWDSTRIKE_SCOPES}
      - CROWDSTRIKE_ACTOR_START_TIMESTAMP=${CROWDSTRIKE_ACTOR_START_TIMESTAMP}
      - CROWDSTRIKE_REPORT_START_TIMESTAMP=${CROWDSTRIKE_REPORT_START_TIMESTAMP} # BEWARE! A lot of reports!
      - CROWDSTRIKE_REPORT_STATUS=${CROWDSTRIKE_REPORT_STATUS}
      - CROWDSTRIKE_REPORT_INCLUDE_TYPES=${CROWDSTRIKE_REPORT_INCLUDE_TYPES}
      - CROWDSTRIKE_REPORT_TYPE=${CROWDSTRIKE_REPORT_TYPE}
      - CROWDSTRIKE_REPORT_GUESS_MALWARE=${CROWDSTRIKE_REPORT_GUESS_MALWARE} # Use report tags to guess malware
      - CROWDSTRIKE_INDICATOR_START_TIMESTAMP=${CROWDSTRIKE_INDICATOR_START_TIMESTAMP} # BEWARE! A lot of indicators!
      - CROWDSTRIKE_INDICATOR_EXCLUDE_TYPES=${CROWDSTRIKE_INDICATOR_EXCLUDE_TYPES}
      - CROWDSTRIKE_INTERVAL_SEC=${CROWDSTRIKE_INTERVAL_SEC}
    restart: always
