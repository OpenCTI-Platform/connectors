{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://www.filigran.io/connectors/servicenow_config.schema.json",
  "type": "object",
  "properties": {
    "OPENCTI_URL": {
      "description": "The OpenCTI platform URL.",
      "format": "uri",
      "maxLength": 2083,
      "minLength": 1,
      "type": "string"
    },
    "OPENCTI_TOKEN": {
      "description": "The token of the user who represents the connector in the OpenCTI platform.",
      "type": "string"
    },
    "CONNECTOR_TYPE": {
      "default": "EXTERNAL_IMPORT",
      "description": "Should always be set to EXTERNAL_IMPORT for this connector.",
      "type": "string"
    },
    "CONNECTOR_NAME": {
      "default": "ServiceNow",
      "description": "Name of the connector.",
      "type": "string"
    },
    "CONNECTOR_SCOPE": {
      "default": "ServiceNow",
      "description": "The scope or type of data the connector is importing, either a MIME type or Stix Object (for information only).",
      "type": "string"
    },
    "CONNECTOR_LOG_LEVEL": {
      "default": "error",
      "description": "Determines the verbosity of the logs.",
      "enum": [
        "debug",
        "info",
        "warn",
        "error"
      ],
      "type": "string"
    },
    "CONNECTOR_DURATION_PERIOD": {
      "default": "PT24H",
      "description": "Duration between two scheduled runs of the connector (ISO 8601 format).",
      "format": "duration",
      "type": "string"
    },
    "CONNECTOR_QUEUE_THRESHOLD": {
      "default": null,
      "description": "Connector queue max size in Mbytes. Default to 500.",
      "exclusiveMinimum": 0,
      "type": "integer"
    },
    "CONNECTOR_RUN_AND_TERMINATE": {
      "default": null,
      "description": "Connector run-and-terminate flag.",
      "type": "boolean"
    },
    "CONNECTOR_SEND_TO_QUEUE": {
      "default": null,
      "description": "Connector send-to-queue flag.",
      "type": "boolean"
    },
    "CONNECTOR_SEND_TO_DIRECTORY": {
      "default": null,
      "description": "Connector send-to-directory flag.",
      "type": "boolean"
    },
    "CONNECTOR_SEND_TO_DIRECTORY_PATH": {
      "default": null,
      "description": "Connector send-to-directory path.",
      "type": "string"
    },
    "CONNECTOR_SEND_TO_DIRECTORY_RETENTION": {
      "default": null,
      "description": "Connector send-to-directory retention in days.",
      "exclusiveMinimum": 0,
      "type": "integer"
    },
    "SERVICENOW_INSTANCE_NAME": {
      "description": "Corresponds to server instance name (will be used for API requests).",
      "type": "string"
    },
    "SERVICENOW_API_KEY": {
      "description": "Secure identifier used to validate access to ServiceNow APIs.",
      "format": "password",
      "type": "string",
      "writeOnly": true
    },
    "SERVICENOW_API_VERSION": {
      "default": "v2",
      "description": "ServiceNow API version used for REST requests.",
      "enum": [
        "v1",
        "v2"
      ],
      "type": "string"
    },
    "SERVICENOW_API_LEAKY_BUCKET_RATE": {
      "default": 10,
      "description": "Bucket refill rate (in tokens per second). Controls the rate at which API calls are allowed. For example, a rate of 10 means that 10 calls can be made per second, if the bucket is not empty.",
      "exclusiveMinimum": 0,
      "type": "integer"
    },
    "SERVICENOW_API_LEAKY_BUCKET_CAPACITY": {
      "default": 10,
      "description": "Maximum bucket capacity (in tokens). Defines the number of calls that can be made immediately in a burst. Once the bucket is empty, it refills at the rate defined by 'api_leaky_bucket_rate'.",
      "exclusiveMinimum": 0,
      "type": "integer"
    },
    "SERVICENOW_API_RETRY": {
      "default": 5,
      "description": "Maximum number of retry attempts in case of API failure.",
      "exclusiveMinimum": 0,
      "type": "integer"
    },
    "SERVICENOW_API_BACKOFF": {
      "default": "PT30S",
      "description": "Exponential backoff duration between API retries (ISO 8601 duration format).",
      "format": "duration",
      "type": "string"
    },
    "SERVICENOW_IMPORT_START_DATE": {
      "anyOf": [
        {
          "format": "date",
          "type": "string"
        },
        {
          "format": "date-time",
          "type": "string"
        },
        {
          "format": "duration",
          "type": "string"
        }
      ],
      "default": "P30D",
      "description": "Start date of first import (ISO date format)."
    },
    "SERVICENOW_STATE_TO_EXCLUDE": {
      "default": null,
      "description": "List of security incident states to exclude from import.",
      "items": {
        "type": "string"
      },
      "type": "array"
    },
    "SERVICENOW_SEVERITY_TO_EXCLUDE": {
      "default": null,
      "description": "List of security incident severities to exclude from import.",
      "items": {
        "type": "string"
      },
      "type": "array"
    },
    "SERVICENOW_PRIORITY_TO_EXCLUDE": {
      "default": null,
      "description": "List of security incident priorities to exclude from import.",
      "items": {
        "type": "string"
      },
      "type": "array"
    },
    "SERVICENOW_COMMENT_TO_EXCLUDE": {
      "default": null,
      "description": "List of comment types to exclude: private, public, auto",
      "items": {
        "enum": [
          "private",
          "public",
          "auto"
        ],
        "type": "string"
      },
      "type": "array"
    },
    "SERVICENOW_TLP_LEVEL": {
      "default": "red",
      "description": "Traffic Light Protocol (TLP) level to apply on objects imported into OpenCTI.",
      "enum": [
        "clear",
        "green",
        "amber",
        "amber+strict",
        "red"
      ],
      "type": "string"
    },
    "SERVICENOW_OBSERVABLES_DEFAULT_SCORE": {
      "default": 50,
      "description": "Allows you to define a default score for observables and indicators when the 'promote_observables_as_indicators' variable is set to True.",
      "exclusiveMinimum": 0,
      "type": "integer"
    },
    "SERVICENOW_PROMOTE_OBSERVABLES_AS_INDICATORS": {
      "default": true,
      "description": "Boolean to promote observables into indicators.",
      "type": "boolean"
    }
  },
  "required": [
    "OPENCTI_URL",
    "OPENCTI_TOKEN",
    "CONNECTOR_ID",
    "SERVICENOW_INSTANCE_NAME",
    "SERVICENOW_API_KEY"
  ],
  "additionalProperties": true
}