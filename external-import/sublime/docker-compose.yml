version: "3"
services:
  connector-sublime:
    build: .
    container_name: sublime-connector
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=ChangeMe
      - CONNECTOR_ID=a2c156d3-3bbe-4170-b370-bf6faebb56e2
      - CONNECTOR_NAME=Sublime Security
      - CONNECTOR_SCOPE=sublime
      - CONNECTOR_LOG_LEVEL=info
      - CONNECTOR_DURATION_PERIOD=PT3M
      - SUBLIME_URL=https://platform.sublime.security
      - SUBLIME_TOKEN=ChangeMe
      - SUBLIME_INCIDENT_TYPE=phishing  # STIX incident type
      - SUBLIME_INCIDENT_PREFIX=Sublime Alert - 
      - SUBLIME_CASE_PREFIX=Case - 
      - SUBLIME_AUTO_CREATE_CASES=false  # Automatically create cases for incidents
      - SUBLIME_VERDICTS=malicious  # Multiple verdicts can comma-separated like: malicious,suspicious
      - SUBLIME_SET_PRIORITY=true  # Enable priority mapping from attack score verdict
      - SUBLIME_SET_SEVERITY=true  # Enable severity mapping from attack score verdict
      - SUBLIME_CONFIDENCE_LEVEL=80 # 0-100 confidence score
      - SUBLIME_FIRST_RUN_DURATION=PT8H  # Duration for initial data fetch in ISO 8601 format (P14D = 14 days, PT1H = 1 hour)
      - SUBLIME_FORCE_HISTORICAL=false  # Force historical fetch by overriding existing state
      - SUBLIME_BATCH_SIZE=100   # Number of message groups to process per batch (default: 100)

    restart: always
    networks:
      - opencti_default