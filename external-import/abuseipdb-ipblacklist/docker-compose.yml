version: "3"
services:
  connector-abuseipdb-ipblacklist:
    image: opencti/connector-abuseipdb-ipblacklist:latest
    environment:
      # Connector's generic execution parameters
      - OPENCTI_URL=http://localhost
      - OPENCTI_TOKEN=ChangeMe
      # Connector's definition parameters REQUIRED
      - CONNECTOR_ID=ChangeMe
      - CONNECTOR_NAME=AbuseIPDB IP Blacklist
      - CONNECTOR_SCOPE=abuseipdb
      - CONNECTOR_LOG_LEVEL=error
      # - CONNECTOR_DURATION_PERIOD=PT12H # ISO8601 format in String, start with 'P...' for Period

      # Connector's custom execution parameters
      # - ABUSEIPDB_API_URL=https://api.abuseipdb.com/api/v2/blacklist
      - ABUSEIPDB_API_KEY=ChangeMe
      - ABUSEIPDB_SCORE=ChangeMe
      # - ABUSEIPDB_LIMIT=500000
      # - ABUSEIPDB_CREATE_INDICATOR=false
      # - ABUSEIPDB_TLP_LEVEL=clear
      # - ABUSEIPDB_IPVERSION=mixed
      # - ABUSEIPDB_EXCEPT_COUNTRY=
      # - ABUSEIPDB_ONLY_COUNTRY=
    restart: always
