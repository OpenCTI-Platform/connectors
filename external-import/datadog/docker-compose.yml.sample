services:
  connector-datadog:
    build:
      context: .
      args:
        - PYCTI_VERSION=6.8.15
    environment:
      # OpenCTI Configuration
      - OPENCTI_URL=http://localhost:4000
      - OPENCTI_TOKEN=ChangeMe
      
      # Connector Configuration
      - CONNECTOR_ID=ChangeMe  # Generate new UUIDv4: python -c "import uuid; print(uuid.uuid4())"
      - CONNECTOR_TYPE=EXTERNAL_IMPORT
      - CONNECTOR_NAME=DataDog Import
      - CONNECTOR_SCOPE=stix2
      - CONNECTOR_UPDATE_EXISTING_DATA=false
      - CONNECTOR_LOG_LEVEL=info
      - CONNECTOR_AUTO=true
      
      # Authentication (Required)
      - DATADOG_TOKEN=ChangeMe
      - DATADOG_APP_KEY=ChangeMe
      
      # Datadog Specific Configuration
      - DATADOG_API_BASE_URL=https://api.datadoghq.com
      - DATADOG_APP_BASE_URL=ChangeMe
      - DATADOG_IMPORT_INTERVAL=60
      - DATADOG_IMPORT_START_DATE=ChangeMe  # Import start date for initial connector run (ISO 8601 format, e.g., 2024-01-01T00:00:00Z)
      - DATADOG_MAX_TLP=TLP:AMBER
      - DATADOG_IMPORT_ALERTS=true
      - DATADOG_CREATE_INCIDENT_RESPONSE_CASES=false
      # - DATADOG_ALERT_PRIORITIES=
      # - DATADOG_ALERT_TAGS_FILTER=
      - DATADOG_EXTRACT_OBSERVABLES_FROM_ALERTS=true
      - DATADOG_INCLUDE_ALERT_CONTEXT=true
      # Custom tags to apply to all enrichment objects (comma-delimited)
      # - DATADOG_CUSTOM_TAGS=my-company,custom-tag
    restart: always
