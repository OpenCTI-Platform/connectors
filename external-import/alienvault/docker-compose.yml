version: '3'
services:
  connector-alienvault:
    image: opencti/connector-alienvault:latest
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=ChangeMe
      - CONNECTOR_ID=8bbae241-6289-4faf-b7d6-7503bed50bbc  # Optional (default: 8bbae241-6289-4faf-b7d6-7503bed50bbc)
      - CONNECTOR_NAME=AlienVault  # Optional (default: AlienVault)
      - CONNECTOR_SCOPE=alienvault  # Optional (default: alienvault)
      - CONNECTOR_LOG_LEVEL=error  # Optional (default: error)
      - CONNECTOR_DURATION_PERIOD=PT30M  # Optional (default: PT30M) - ISO8601 Format starting with "P" for Period ex: "PT30M" = Period time of 30 minutes
      - ALIENVAULT_BASE_URL=https://otx.alienvault.com  # Optional (default: https://otx.alienvault.com)
      - ALIENVAULT_API_KEY=ChangeMe  # Required
      - ALIENVAULT_TLP=White  # Optional (default: White)
      - ALIENVAULT_CREATE_OBSERVABLES=true  # Optional (default: true)
      - ALIENVAULT_CREATE_INDICATORS=true  # Optional (default: true)
      - ALIENVAULT_PULSE_START_TIMESTAMP=2020-05-01T00:00:00  # Optional (default: 2020-05-01T00:00:00) - ISO 8601 format, UTC - BEWARE! Could be a lot of pulses!
      - ALIENVAULT_REPORT_TYPE=threat-report  # Optional (default: threat-report)
      - ALIENVAULT_REPORT_STATUS=New  # Optional (default: New) - New, In progress, Analyzed and Closed
      - ALIENVAULT_GUESS_MALWARE=false  # Optional (default: false) - Use tags to guess malware
      - ALIENVAULT_GUESS_CVE=false  # Optional (default: false) - Use tags to guess CVE
      - ALIENVAULT_EXCLUDED_PULSE_INDICATOR_TYPES=FileHash-MD5,FileHash-SHA1  # Optional (default: "") - Comma-separated list of Pulse indicator types to exclude
      - ALIENVAULT_ENABLE_RELATIONSHIPS=true  # Optional (default: true) - Enable/Disable relationship creation between SDOs
      - ALIENVAULT_ENABLE_ATTACK_PATTERNS_INDICATES=true  # Optional (default: true) - Enable/Disable "indicates" relationships between indicators and attack patterns
      - ALIENVAULT_FILTER_INDICATORS=false  # Optional (default: false) - Filter indicators by their created datetime
      - ALIENVAULT_DEFAULT_X_OPENCTI_SCORE=50  # Optional (default: 50) - The default x_opencti_score to use for indicators
      - ALIENVAULT_X_OPENCTI_SCORE_IP=60  # Optional (default: uses default_x_opencti_score) - The x_opencti_score to use for IP indicators
      - ALIENVAULT_X_OPENCTI_SCORE_DOMAIN=70  # Optional (default: uses default_x_opencti_score) - The x_opencti_score to use for Domain indicators
      - ALIENVAULT_X_OPENCTI_SCORE_HOSTNAME=75  # Optional (default: uses default_x_opencti_score) - The x_opencti_score to use for Hostname indicators
      - ALIENVAULT_X_OPENCTI_SCORE_EMAIL=70  # Optional (default: uses default_x_opencti_score) - The x_opencti_score to use for Email indicators
      - ALIENVAULT_X_OPENCTI_SCORE_FILE=80  # Optional (default: uses default_x_opencti_score) - The x_opencti_score to use for StixFile indicators
      - ALIENVAULT_X_OPENCTI_SCORE_URL=80  # Optional (default: uses default_x_opencti_score) - The x_opencti_score to use for URL indicators
      - ALIENVAULT_X_OPENCTI_SCORE_MUTEX=60  # Optional (default: uses default_x_opencti_score) - The x_opencti_score to use for Mutex indicators
      - ALIENVAULT_X_OPENCTI_SCORE_CRYPTOCURRENCY_WALLET=80  # Optional (default: uses default_x_opencti_score) - The x_opencti_score to use for Cryptocurrency Wallet indicators
    restart: always
