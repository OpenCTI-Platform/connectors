{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://www.filigran.io/connectors/alienvault_config.schema.json",
  "type": "object",
  "properties": {
    "OPENCTI_URL": {
      "description": "The base URL of the OpenCTI instance.",
      "format": "uri",
      "maxLength": 2083,
      "minLength": 1,
      "type": "string"
    },
    "OPENCTI_TOKEN": {
      "description": "The API token to connect to OpenCTI.",
      "type": "string"
    },
    "CONNECTOR_NAME": {
      "default": "Alienvault",
      "description": "The name of the connector.",
      "type": "string"
    },
    "CONNECTOR_SCOPE": {
      "description": "The scope of the connector, e.g. 'flashpoint'.",
      "items": {
        "type": "string"
      },
      "type": "array"
    },
    "CONNECTOR_LOG_LEVEL": {
      "default": "error",
      "description": "The minimum level of logs to display.",
      "enum": [
        "debug",
        "info",
        "warn",
        "warning",
        "error"
      ],
      "type": "string"
    },
    "CONNECTOR_TYPE": {
      "const": "EXTERNAL_IMPORT",
      "default": "EXTERNAL_IMPORT",
      "type": "string"
    },
    "CONNECTOR_DURATION_PERIOD": {
      "default": "PT1H",
      "description": "The period of time to await between two runs of the connector.",
      "format": "duration",
      "type": "string"
    },
    "ALIENVAULT_BASE_URL": {
      "default": "https://otx.alienvault.com",
      "description": "The base URL for the OTX DirectConnect API.",
      "type": "string"
    },
    "ALIENVAULT_API_KEY": {
      "default": "**********",
      "description": "The OTX Key.",
      "format": "password",
      "type": "string",
      "writeOnly": true
    },
    "ALIENVAULT_TLP": {
      "default": "White",
      "description": "The default TLP marking used if the Pulse does not define TLP.",
      "type": "string"
    },
    "ALIENVAULT_CREATE_OBSERVABLES": {
      "default": true,
      "description": "If true then observables will be created from Pulse indicators and added to the report.",
      "type": "boolean"
    },
    "ALIENVAULT_CREATE_INDICATORS": {
      "default": true,
      "description": "If true then indicators will be created from Pulse indicators and added to the report.",
      "type": "boolean"
    },
    "ALIENVAULT_PULSE_START_TIMESTAMP": {
      "default": "2020-05-01T00:00:00",
      "description": "The Pulses modified after this timestamp will be imported. Timestamp in ISO 8601 format, UTC.",
      "type": "string"
    },
    "ALIENVAULT_REPORT_TYPE": {
      "default": "threat-report",
      "description": "The type of imported reports in the OpenCTI.",
      "type": "string"
    },
    "ALIENVAULT_REPORT_STATUS": {
      "default": "New",
      "description": "The status of imported reports in the OpenCTI.",
      "type": "string"
    },
    "ALIENVAULT_GUESS_MALWARE": {
      "default": false,
      "description": "The Pulse tags are used to guess (queries malwares in the OpenCTI) malwares related to the given Pulse.",
      "type": "boolean"
    },
    "ALIENVAULT_GUESS_CVE": {
      "default": false,
      "description": "The Pulse tags are used to guess (checks whether tag matches (CVE-\\d{4}-\\d{4,7})) vulnerabilities.",
      "type": "boolean"
    },
    "ALIENVAULT_EXCLUDED_PULSE_INDICATOR_TYPES": {
      "default": "FileHash-MD5,FileHash-SHA1",
      "description": "The Pulse indicator types that will be excluded from the import.",
      "type": "string"
    },
    "ALIENVAULT_ENABLE_RELATIONSHIPS": {
      "default": true,
      "description": "If true then the relationships will be created between SDOs.",
      "type": "boolean"
    },
    "ALIENVAULT_ENABLE_ATTACK_PATTERNS_INDICATES": {
      "default": false,
      "description": "If true then the relationships `indicates` will be created between indicators and attack patterns.",
      "type": "boolean"
    },
    "ALIENVAULT_FILTER_INDICATORS": {
      "default": false,
      "description": "This boolean filters out indicators created before the latest pulse datetime, ensuring only recent indicators are processed.",
      "type": "boolean"
    },
    "ALIENVAULT_DEFAULT_X_OPENCTI_SCORE": {
      "default": 50,
      "description": "The default x_opencti_score to use for indicators. If a per indicator type score is not set, this is used.",
      "type": "integer"
    },
    "ALIENVAULT_X_OPENCTI_SCORE_IP": {
      "default": 60,
      "description": "(Optional): The x_opencti_score to use for IP indicators.",
      "type": "integer"
    },
    "ALIENVAULT_X_OPENCTI_SCORE_DOMAIN": {
      "default": 70,
      "description": "(Optional): The x_opencti_score to use for Domain indicators.",
      "type": "integer"
    },
    "ALIENVAULT_X_OPENCTI_SCORE_HOSTNAME": {
      "default": 75,
      "description": "(Optional): The x_opencti_score to use for Hostname indicators.",
      "type": "integer"
    },
    "ALIENVAULT_X_OPENCTI_SCORE_EMAIL": {
      "default": 70,
      "description": "(Optional): The x_opencti_score to use for Email indicators.",
      "type": "integer"
    },
    "ALIENVAULT_X_OPENCTI_SCORE_FILE": {
      "default": 80,
      "description": "(Optional): The x_opencti_score to use for StixFile indicators.",
      "type": "integer"
    },
    "ALIENVAULT_X_OPENCTI_SCORE_URL": {
      "default": 80,
      "description": "(Optional): The x_opencti_score to use for URL indicators.",
      "type": "integer"
    },
    "ALIENVAULT_X_OPENCTI_SCORE_MUTEX": {
      "default": 60,
      "description": "(Optional): The x_opencti_score to use for Mutex indicators.",
      "type": "integer"
    },
    "ALIENVAULT_X_OPENCTI_SCORE_CRYPTOCURRENCY_WALLET": {
      "default": 80,
      "description": "(Optional): The x_opencti_score to use for Cryptocurrency Wallet indicators.",
      "type": "integer"
    },
    "ALIENVAULT_INTERVAL_SEC": {
      "default": "1800",
      "description": "The interval in seconds between each run of the connector.",
      "type": "string"
    }
  },
  "required": [
    "OPENCTI_URL",
    "OPENCTI_TOKEN",
    "CONNECTOR_SCOPE"
  ],
  "additionalProperties": true
}