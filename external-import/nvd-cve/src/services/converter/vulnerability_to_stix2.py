from pycti import OpenCTIConnectorHelper  # type: ignore
from ..client import CVEVulnerability  # type: ignore
from services.utils.config_variables import ConfigCVE  # type: ignore

from services.utils._version import __version__ as APP_VERSION  # type: ignore


class Converter:

    def __init__(self):
        self.config = ConfigCVE()
        self.helper = OpenCTIConnectorHelper(self.config.load)
        self.client_api = CVEVulnerability(
            api_key=self.config.api_key,
            helper=self.helper,
            header=f"OpenCTI-cve/{APP_VERSION}",
        )

    def convert_vulberabilities(self):
        self.client_api.get_vulnerabilities()
