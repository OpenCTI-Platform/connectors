# RST Report Hub Connector for OpenCTI by RST Cloud

The **RST Report Hub Connector** integrates various APT reports, blogs, articles from government bodies, security companies, research groups, cyber communities, and individuals into OpenCTI. RST Cloud manages the conversion of human-readable texts into STIX 2.1 bundles. This connector retrieves data from RST Cloud, importing the PDF version of each report along with a corresponding summary, key ideas, and facts into OpenCTI. It also includes extracted objects and relationships between them, such as Intrusion Sets (threat actors), campaigns, malware, TTPs, tools, geographic data, sectors, CVEs, indicators, and other relevant objects. This integration enhances the capabilities of OpenCTI by providing valuable structured threat intelligence data, enabling CTI analysts to streamline APT report processing through automation via the [RST Report Hub](https://www.rstcloud.com/rst-report-hub/) integration, ultimately saving time. 

No need to manually copy and paste indicators from articles anymore, or extract them from images, or check if they are well-known benign values. If an article includes indicators that are 'noisy' or incorrectly specified by the authors as indicators of compromise, for example, legitimate but temporarily compromised resources, public DNS servers, CDNs, hashes of widely used software, or well-known domains, these indicators are only created as Observables. As the aliases are tracked at the cloud-level, objects with multiple names, such as malware and adversaries, are automatically mapped to a single entity, allowing for the automatic tracking of the same entities across various taxonomies used in different countries and created by different security companies. Definitions of malware and tools and adversary profiles are available as a part of [RST Threat Library](https://www.rstcloud.com/rst-threat-library/).

## Key Features

- **Brilliant Time Saver**: Manual import and processing of threat articles, blogs, reports is a time consuming activity that does not need to happen anymore.
- **Threat Report Library**: Keep all APT reports and their metadata, extracted objects in one place. 
- **OpenCTI Integration**: Seamlessly integrates the fetched data into OpenCTI's data model.

This connector provides users with an enhanced and comprehensive understanding of the cybersecurity threat landscape by leveraging the detailed threat intelligence provided by RST Cloud.

## Requirements
- OpenCTI Platform version 5.10.x or higher.
- An API Key for accessing RST Cloud (trial@rstcloud.net).

## Recommended connectors
This connector is aligned with data populated by common OpenCTI connectors. We recommend to install the following connectors alongside with RST Report Hub Connector:
 - MITRE Datasets (https://github.com/OpenCTI-Platform/connectors/tree/master/external-import/mitre)
 - OpenCTI Datasets (https://github.com/OpenCTI-Platform/connectors/tree/master/external-import/opencti)
 - CISA Known Exploited Vulnerabilities (https://github.com/OpenCTI-Platform/connectors/tree/master/external-import/cisa-known-exploited-vulnerabilities)

## Configuration

Configuring the connector is straightforward. The minimal setup requires entering the RST Cloud API key and specifying the OpenCTI connection settings. Below is the full list of parameters you can configure:

| Parameter                                            | Docker envvar                           | Mandatory | Description                                                                                                                                                                                                                                                        |
| ---------------------------------------------------- | --------------------------------------- | --------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| OpenCTI URL                                          | `OPENCTI_URL`                           | Yes       | The URL of the OpenCTI platform.                                                                                                                                                                                                                                   |
| OpenCTI Token                                        | `OPENCTI_TOKEN`                         | Yes       | The default admin token set in the OpenCTI platform.                                                                                                                                                                                                               |
| Connector ID                                         | `CONNECTOR_ID`                          | Yes       | A unique `UUIDv4` identifier for this connector instance.                                                                                                                                                                                                          |
| Connector Name                                       | `CONNECTOR_NAME`                        | Yes       | Name of the connector. For example: `RST Report Hub`.                                                                                                                                                                                                              |
| Connector Scope                                      | `CONNECTOR_SCOPE`                       | Yes       | The scope or type of data the connector is importing, either a MIME type or Stix Object. E.g. application/json                                                                                                                                                     |
| Log Level                                            | `CONNECTOR_LOG_LEVEL`                   | Yes       | Determines the verbosity of the logs. Options are `debug`, `info`, `warn`, or `error`.                                                                                                                                                                             |
| RST Report Hub Base URL                              | `RST_REPORT_HUB_BASE_URL`               | No        | By default, use https://api.rstcloud.net/v1/. In some cases, you may want to use a local API endpoint                                                                                                                                                              |
| RST Report Hub API Key                               | `RST_REPORT_HUB_API_KEY`                | Yes       | Your API Key for accessing RST Cloud.                                                                                                                                                                                                                              |
| RST Report Hub Connection Timeout                    | `RST_REPORT_HUB_CONNECTION_TIMEOUT`     | No        | Connection timeout to the API. Default (sec): `30`                                                                                                                                                                                                                 |
| RST Report Hub Read Timeout                          | `RST_REPORT_HUB_READ_TIMEOUT`           | No        | Read timeout for each feed. If the connector is unable to fetch a report in time, increase the read timeout. Default (sec): `60`                                                                                                                                   |
| RST Report Hub Retry Delay                           | `RST_REPORT_HUB_RETRY_DELAY`            | No        | Specifies how long to wait in seconds before next attempt to connect to the API. Default (sec): `30`                                                                                                                                                               |
| RST Report Hub Download Retry Count                  | `RST_REPORT_HUB_RETRY_ATTEMPTS`         | No        | Default (attempts): `5`                                                                                                                                                                                                                                            |
| RST Report Hub Fetch Interval                        | `RST_REPORT_HUB_FETCH_INTERVAL`         | No        | Default (sec): `300`                                                                                                                                                                                                                                               |
| RST Report Hub Date to start pulling data from       | `RST_REPORT_HUB_IMPORT_START_DATE`      | No        | Specify the date from which you want to retrieve the reports in the format "%Y%m%d" (for example, 20240527). Data import for each day will occur with a delay equal to the RST_REPORT_HUB_FETCH_INTERVAL. By default, this start date is calculated as 7 days ago. |
| RST Report Hub Language                              | `RST_REPORT_HUB_LANGUAGE`               | No        | Reach out to support@rstcloud.net if you want to update this parameter. Default: `eng`                                                                                                                                                                             |
| RST Report Hub: Ceate observables                    | `RST_REPORT_HUB_CREATE_OBSERVABLES`     | No        | A user can select if observables are to be created in addition to indicators. Options are `true`, `false`. Default: `false`                                                                                                                                        |
| RST Report Hub: Create related-to relationships      | `RST_REPORT_HUB_CREATE_RELATED_TO`      | No        | A user can select if `related-to` relationships are to be created or not. Options are `true`, `false`. Default: `true`                                                                                                                                             |
| RST Report Hub: Create custom attack-pattern         | `RST_REPORT_HUB_CREATE_CUSTOM_TTPS`     | No        | A user can select if `attack-pattern` objects with custom names that are still not present in the MITRE ATT&CK framework are to be created or not. Options are `true`, `false`. Default: `true`                                                                    |
| RST Report Hub: Set the detection flag on indicators | `RST_REPORT_HUB_SET_DETECTION_FLAG`     | No        | A user can select if they want the indicators from reports to be set for detection or not. Options are `true`, `false`. Default: `false`                                                                                                                           |
| RST Report Hub: Avoid populating specified labels    | `RST_REPORT_HUB_REPORT_LABELS_DISABLED` | No        | A user can select a list of labels they want the conenctor to ignore populating when creating Report objects. It does not prevent reports from being created. Options: a comma-separated list of labels. Default: not specified                                    |