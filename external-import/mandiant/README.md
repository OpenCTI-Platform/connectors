# Mandiant Connector

This connector connects to the Mandiant Advantage API V4 and gather all data from a given date.

Url used for the Mandiant API : `https://api.intelligence.mandiant.com`

### Configuration variables

Below are the parameters you'll need to set for OpenCTI:

| Parameter `OpenCTI` | config.yml | Docker environment variable | Mandatory | Description                                          |
|---------------------|------------|-----------------------------|-----------|------------------------------------------------------|
| URL                 | `url`      | `OPENCTI_URL`               | Yes       | The URL of the OpenCTI platform.                     |
| Token               | `token`    | `OPENCTI_TOKEN`             | Yes       | The default admin token set in the OpenCTI platform. |

Below are the parameters you'll need to set for running the connector properly:

| Parameter `Connector` | config.yml          | Docker environment variable   | Default    | Mandatory | Description                                                                                      |
|-----------------------|---------------------|-------------------------------|------------|-----------|--------------------------------------------------------------------------------------------------|
| ID                    | `id`                | `CONNECTOR_ID`                | /          | Yes       | A unique `UUIDv4` identifier for this connector instance.                                        |
| Name                  | `name`              | `CONNECTOR_NAME`              | `Mandiant` | Yes       | Full name of the connector : `Mandiant Cyber Threat Intelligence`.                               |
| Scope                 | `scope`             | `CONNECTOR_SCOPE`             | `mandiant` | Yes       | Must be `mandiant`, not used in this connector.                                                  |
| Run and Terminate     | `run_and_terminate` | `CONNECTOR_RUN_AND_TERMINATE` | `False`    | No        | Launch the connector once if set to True. Takes 2 available values: `True` or `False`.           |
| Duration Period       | `duration_period`   | `CONNECTOR_DURATION_PERIOD`   | /          | Yes       | Determines the time interval between each launch of the connector in ISO 8601, ex: `PT5M`.       |
| Queue Threshold       | `queue_threshold`   | `CONNECTOR_QUEUE_THRESHOLD`   | `500`      | No        | Used to determine the limit (RabbitMQ) in MB at which the connector must go into buffering mode. |
| Log Level             | `log_level`         | `CONNECTOR_LOG_LEVEL`         | /          | Yes       | Determines the verbosity of the logs. Options are `debug`, `info`, `warn`, or `error`.           |

Below are the parameters you'll need to set for Mandiant connector:

| Parameter `Mandiant`                          | config.yml                                      | Docker environment variable                              | Default                               | Mandatory | Description                                                                    |
|-----------------------------------------------|-------------------------------------------------|----------------------------------------------------------|---------------------------------------|-----------|--------------------------------------------------------------------------------|
| API URL                                       | `api_url`                                       | `MANDIANT_API_URL`                                       | https://api.intelligence.mandiant.com | Yes       | URL for the Mandiant API                                                       |
| Api v4 Key ID                                 | `api_v4_key_id`                                 | `MANDIANT_API_V4_KEY_ID`                                 | /                                     | Yes       | Mandiant API Key ID                                                            |
| Api v4 Key Secret                             | `api_v4_key_secret`                             | `MANDIANT_API_V4_KEY_SECRET`                             | /                                     | Yes       | Mandiant API Key Secret                                                        |
| Import Start Date                             | `import_start_date`                             | `MANDIANT_IMPORT_START_DATE`                             | `2023-01-01`                          | No        | Date to start collect data                                                     |
| Indicator Import Start Date                   | `indicator_import_start_date`                   | `MANDIANT_INDICATOR_IMPORT_START_DATE`                   | `2023-01-01`                          | No        | Date to start collect indicators                                               |
| Import Period                                 | `import_period`                                 | `MANDIANT_IMPORT_PERIOD`                                 | `3`                                   | No        | Number of days to fetch in one round trip                                      |
| Indicator Minimum Score                       | `indicator_minimum_score`                       | `MANDIANT_INDICATOR_MINIMUM_SCORE`                       | `80`                                  | No        | Minimum score (based on mscore) that an indicator must have to be processed    |
| Create Notes                                  | `create_notes`                                  | `MANDIANT_CREATE_NOTES`                                  | `False`                               | No        | Create notes                                                                   |
| Remove Statement Marking                      | `remove_statement_marking`                      | `MANDIANT_REMOVE_STATEMENT_MARKING`                      | `False`                               | No        | Remove statement marking                                                       |
| Import Actors                                 | `import_actors`                                 | `MANDIANT_IMPORT_ACTORS`                                 | `True`                                | No        | Enable to collect actors                                                       |
| Import Actors Interval                        | `import_actors_interval`                        | `MANDIANT_IMPORT_ACTORS_INTERVAL`                        | `1`                                   | No        | Interval in hours to check and collect new actors                              |
| Import Actors Aliases                         | `import_actors_aliases`                         | `MANDIANT_IMPORT_ACTORS_ALIASES`                         | `False`                               | No        | Import actors aliases                                                          |
| Import Reports                                | `import_reports`                                | `MANDIANT_IMPORT_REPORTS`                                | `True`                                | No        | Enable to collect reports                                                      |
| Import Reports Interval                       | `import_reports_interval`                       | `MANDIANT_IMPORT_REPORTS_INTERVAL`                       | `1`                                   | No        | Interval in hours to check and collect new reports                             |
| Import Malwares                               | `import_malwares`                               | `MANDIANT_IMPORT_MALWARES`                               | `True`                                | No        | Enable to collect malwares                                                     |
| Import Malwares Interval                      | `import_malwares_interval`                      | `MANDIANT_IMPORT_MALWARES_INTERVAL`                      | `1`                                   | No        | Interval in hours to check and collect new malwares                            |
| Import Malwares Aliases                       | `import_malwares_aliases`                       | `MANDIANT_IMPORT_MALWARES_ALIASES`                       | `False`                               | No        | Import malware aliases                                                         |
| Import Campaigns                              | `import_campaigns`                              | `MANDIANT_IMPORT_CAMPAIGNS`                              | `True`                                | No        | Enable to collect campaigns                                                    |
| Import Campaigns Interval                     | `import_campaigns_interval`                     | `MANDIANT_IMPORT_CAMPAIGNS_INTERVAL`                     | `1`                                   | No        | Interval in hours to check and collect new campaigns                           |
| Import Indicators                             | `import_indicators`                             | `MANDIANT_IMPORT_INDICATORS`                             | `True`                                | No        | Enable to collect indicators                                                   |
| Import Indicators Interval                    | `import_indicators_interval`                    | `MANDIANT_IMPORT_INDICATORS_INTERVAL`                    | `1`                                   | No        | Interval in hours to check and collect new indicators                          |
| Import Vulnerabilities                        | `import_vulnerabilities`                        | `MANDIANT_IMPORT_VULNERABILITIES`                        | `False`                               | No        | Enable to collect vulnerabilities                                              |
| Import Vulnerabilities Interval               | `import_vulnerabilities_interval`               | `MANDIANT_IMPORT_VULNERABILITIES_INTERVAL`               | `1`                                   | No        | Interval in hours to check and collect new vulnerabilities                     |
| Actor Profile Report                          | `actor_profile_report`                          | `MANDIANT_ACTOR_PROFILE_REPORT`                          | `True`                                | No        | Enable to collect report type actor profile                                    |
| Country Profile Report                        | `country_profile_report`                        | `MANDIANT_COUNTRY_PROFILE_REPORT`                        | `True`                                | No        | Enable to collect report type country_profile                                  |
| Event Coverage Implication Report             | `event_coverage_implication_report`             | `MANDIANT_EVENT_COVERAGE_IMPLICATION_REPORT`             | `True`                                | No        | Enable to collect report type event_coverage_implication                       |
| Executive Perspective Report                  | `executive_perspective_report`                  | `MANDIANT_EXECUTIVE_PERSPECTIVE_REPORT`                  | `True`                                | No        | Enable to collect report type executive_perspective                            |
| Ics Security Roundup Report                   | `ics_security_roundup_report`                   | `MANDIANT_ICS_SECURITY_ROUNDUP_REPORT`                   | `True`                                | No        | Enable to collect report type ics_security_roundup                             |
| Industry Reporting Report                     | `industry_reporting_report`                     | `MANDIANT_INDUSTRY_REPORTING_REPORT`                     | `True`                                | No        | Enable to collect report type industry_reporting                               |
| Malware Profile Report                        | `malware_profile_report`                        | `MANDIANT_MALWARE_PROFILE_REPORT`                        | `True`                                | No        | Enable to collect report type malware_profile                                  |
| Network Activitiy Report                      | `network_activity_report`                       | `MANDIANT_NETWORK_ACTIVITY_REPORT`                       | `True`                                | No        | Enable to collect report type network_activity_reports                         |
| Patch Report                                  | `patch_report`                                  | `MANDIANT_PATCH_REPORT`                                  | `True`                                | No        | Enable to collect report type patch_report                                     |
| TTP Deep Dive Report                          | `ttp_deep_dive_report`                          | `MANDIANT_TTP_DEEP_DIVE_REPORT`                          | `True`                                | No        | Enable to collect report type ttp_deep_dive                                    |
| Threat Activity Alert Report                  | `threat_activity_alert_report`                  | `MANDIANT_THREAT_ACTIVITY_ALERT_REPORT`                  | `True`                                | No        | Enable to collect report type threat_activity_alert                            |
| Threat Activity Report                        | `threat_activity_report`                        | `MANDIANT_THREAT_ACTIVITY_REPORT`                        | `True`                                | No        | Enable to collect report type threat_activity_report                           |
| Trends And Forecasting Report                 | `trends_and_forecasting_report`                 | `MANDIANT_TRENDS_AND_FORECASTING_REPORT`                 | `True`                                | No        | Enable to collect report type trends_and_forecasting                           |
| Vulnerability Report                          | `vulnerability_report`                          | `MANDIANT_VULNERABILITY_REPORT`                          | `True`                                | No        | Enable to collect report type vulnerability_report                             |
| Weekly Vulnerability Exploitation Report      | `weekly_vulnerability_exploitation_report`      | `MANDIANT_WEEKLY_VULNERABILITY_EXPLOITATION_REPORT`      | `True`                                | No        | Enable to collect report type weekly_vulnerability_exploitation_report         |
| News Analysis Report                          | `news_analysis_report`                          | `MANDIANT_NEWS_ANALYSIS_REPORT`                          | `True`                                | No        | Enable to collect report type news_analysis                                    |
| Vulnerability Import Software CPE             | `vulnerability_import_software_cpe`             | `MANDIANT_VULNERABILITY_IMPORT_SOFTWARE_CPE`             | `True`                                | No        | Enable to import CPE and version or not                                        |
| Vulnerability Max CPE Relationship            | `vulnerability_max_cpe_relationship`            | `MANDIANT_VULNERABILITY_MAX_CPE_RELATIONSHIP`            | `200`                                 | No        | Enable to define a maximum number of relationships created for a vulnerability |
| Actor Profile Report Type                     | `actor_profile_report_type`                     | `MANDIANT_ACTOR_PROFILE_REPORT_TYPE`                     | `actor-profile`                       | No        | Report type on vocabulary `report_types_ov`                                    |
| Country Profile Report Type                   | `country_profile_report_type`                   | `MANDIANT_COUNTRY_PROFILE_REPORT_TYPE`                   | `country-profile`                     | No        | Report type on vocabulary `report_types_ov`                                    |
| Event Coverage Implication Report Type        | `event_coverage_implication_report_type`        | `MANDIANT_EVENT_COVERAGE_IMPLICATION_REPORT_TYPE`        | `event-coverage`                      | No        | Report type on vocabulary `report_types_ov`                                    |
| Executive Perspective Report Type             | `executive_perspective_report_type`             | `MANDIANT_EXECUTIVE_PERSPECTIVE_REPORT_TYPE`             | `executive-perspective`               | No        | Report type on vocabulary `report_types_ov`                                    |
| Ics Security Roundup Report Type              | `ics_security_roundup_report_type`              | `MANDIANT_ICS_SECURITY_ROUNDUP_REPORT_TYPE`              | `ics-security-roundup`                | No        | Report type on vocabulary `report_types_ov`                                    |
| Industry Reporting Report Type                | `industry_reporting_report_type`                | `MANDIANT_INDUSTRY_REPORTING_REPORT_TYPE`                | `industry`                            | No        | Report type on vocabulary `report_types_ov`                                    |
| Malware Profile Report Type                   | `malware_profile_report_type`                   | `MANDIANT_MALWARE_PROFILE_REPORT_TYPE`                   | `malware-profile`                     | No        | Report type on vocabulary `report_types_ov`                                    |
| Network Activity Report Type                  | `network_activity_report_type`                  | `MANDIANT_NETWORK_ACTIVITY_REPORT_TYPE`                  | `network-activity`                    | No        | Report type on vocabulary `report_types_ov`                                    |
| Patch Report Type                             | `patch_report_type`                             | `MANDIANT_PATCH_REPORT_TYPE`                             | `patch`                               | No        | Report type on vocabulary `report_types_ov`                                    |
| TTP Deep Dive Report Type                     | `ttp_deep_dive_report_type`                     | `MANDIANT_TTP_DEEP_DIVE_REPORT_TYPE`                     | `ttp-deep-dive`                       | No        | Report type on vocabulary `report_types_ov`                                    |
| Threat Activity Alert Report Type             | `threat_activity_alert_report_type`             | `MANDIANT_THREAT_ACTIVITY_ALERT_REPORT_TYPE`             | `threat-alert`                        | No        | Report type on vocabulary `report_types_ov`                                    |
| Threat Activity Report Type                   | `threat_activity_report_type`                   | `MANDIANT_THREAT_ACTIVITY_REPORT_TYPE`                   | `threat-activity`                     | No        | Report type on vocabulary `report_types_ov`                                    |
| Trends And Forecasting Report Type            | `trends_and_forecasting_report_type`            | `MANDIANT_TRENDS_AND_FORECASTING_REPORT_TYPE`            | `trends-forecasting`                  | No        | Report type on vocabulary `report_types_ov`                                    |
| Vulnerability Report Type                     | `vulnerability_report_type`                     | `MANDIANT_VULNERABILITY_REPORT_TYPE`                     | `vulnerability`                       | No        | Report type on vocabulary `report_types_ov`                                    |
| Weekly Vulnerability Exploitation Report Type | `weekly_vulnerability_exploitation_report_type` | `MANDIANT_WEEKLY_VULNERABILITY_EXPLOITATION_REPORT_TYPE` | `vulnerability-exploitation`          | No        | Report type on vocabulary `report_types_ov`                                    |
| News Analysis Report Type                     | `news_analysis_report_type`                     | `MANDIANT_NEWS_ANALYSIS_REPORT_TYPE`                     | `news-analysis`                       | No        | Report type on vocabulary `report_types_ov`                                    |

