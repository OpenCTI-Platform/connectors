from typing import Annotated, Literal

from models.configs import ConfigBaseSettings
from pydantic import (
    Field,
    PlainSerializer,
)

TLPToLower = Annotated[
    Literal["TLP:CLEAR", "TLP:GREEN", "TLP:AMBER", "TLP:AMBER+STRICT", "TLP:RED"],
    PlainSerializer(lambda v: "".join(v), return_type=str),
]


class _ConfigLoaderCISAKEV(ConfigBaseSettings):
    """Interface for loading dedicated configuration."""

    # Config Loader
    catalog_url: str = Field(
        default="https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json",
        description="The URL that hosts the KEV Catalog https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json.",
    )
    create_infrastructures: bool = Field(
        default=True,
        description="Allows you to create or not create an infrastructure in OpenCTI.",
    )
    tlp: TLPToLower = Field(
        default="TLP:CLEAR",
        description="Traffic Light Protocol (TLP) level to apply on objects imported into OpenCTI. Possible values: TLP:CLEAR, TLP:GREEN, TLP:AMBER, TLP:AMBER+STRICT, TLP:RED.",
    )
    interval: int = Field(
        default=7,
        description="[DEPRECATED] Interval in days between two scheduled runs of the connector.",
    )
