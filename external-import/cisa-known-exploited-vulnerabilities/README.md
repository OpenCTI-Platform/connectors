# OpenCTI CISA Connector

For the benefit of the cybersecurity community and network defenders—and to better manage vulnerabilities and keep pace with threat activity—CISA maintains the authoritative source of known exploited vulnerabilities: the Known Exploited Vulnerability (KEV) catalog. CISA strongly recommends all organizations review and monitor the KEV catalog and remediate the listed vulnerabilities to strengthen their security and resilience posture.

Binding Operational Directive (BOD) 22-01, Reducing the Significant Risk of Known Exploited Vulnerabilities, which established the KEV catalog, requires federal civilian executive branch (FCEB) agencies to identify and remediate any vulnerability on their information systems that is listed in the KEV catalog. Although not bound by BOD 22-01, state, local, tribal, and territorial (SLTT) governments and private industry can significantly strengthen their security and resilience posture by remediating the vulnerabilities listed in the KEV catalog as well. CISA strongly recommends all stakeholders include a requirement to immediately address KEV catalog vulnerabilities as part of their vulnerability management plan. Doing so will build collective resilience across the cybersecurity community.

The KEV catalog sends a clear message to all organizations to prioritize remediation efforts on the subset of vulnerabilities that are causing immediate harm based on adversary activity. Organizations should use the KEV catalog as an input to their vulnerability management prioritization framework. Vulnerability management frameworks—such as the Stakeholder-Specific Vulnerability Categorization (SSVC) model—consider a vulnerability's exploitation status and the KEV catalog serves as the authoritative repository of that information.

CISA updates the catalog as exploitation of vulnerabilities becomes known and when vulnerabilities satisfy the following thresholds:
•    The vulnerability has an assigned Common Vulnerabilities and Exposures (CVE) ID.
•    There is reliable evidence that the vulnerability has been actively exploited in the wild.
•    There is a clear remediation action for the vulnerability, such as a vendor-provided update.

This Connector will download the catalog from CISA's website and parse out Identity, Infrastructure, and Vulnerability STIX Objects.  Once the Objects have been parsed out, it will import them via the Connector Helper in PyCTI.
## Installation

### Requirements

- OpenCTI Platform >= 5.2.4


### Configuration variables

Below are the parameters you'll need to set for OpenCTI:

| Parameter `OpenCTI` | config.yml  | Docker environment variable | Mandatory | Description                                          |
|---------------------|-------------|-----------------------------|-----------|------------------------------------------------------|
| URL                 | `url`       | `OPENCTI_URL`               | Yes       | The URL of the OpenCTI platform.                     |
| Token               | `token`     | `OPENCTI_TOKEN`             | Yes       | The default admin token set in the OpenCTI platform. |

Below are the parameters you'll need to set for running the connector properly:

| Parameter `Connector` | config.yml          | Docker environment variable   | Default     | Mandatory | Description                                                                                      |
|-----------------------|---------------------|-------------------------------|-------------|-----------|--------------------------------------------------------------------------------------------------|
| ID                    | `id`                | `CONNECTOR_ID`                | /           | Yes       | A unique `UUIDv4` identifier for this connector instance.                                        |
| Name                  | `name`              | `CONNECTOR_NAME`              | `CISA KEV ` | Yes       | Full name of the connector : `CISA Known Exploited Vulnerability`.                               |
| Scope                 | `scope`             | `CONNECTOR_SCOPE`             | `cisa`      | Yes       | Must be `cisa`, not used in this connector.                                                      |
| Run and Terminate     | `run_and_terminate` | `CONNECTOR_RUN_AND_TERMINATE` | `False`     | No        | Launch the connector once if set to True. Takes 2 available values: `True` or `False`.           |
| Duration Period       | `duration_period`   | `CONNECTOR_DURATION_PERIOD`   | /           | Yes       | Determines the time interval between each launch of the connector in ISO 8601, ex: `P7D`.        |
| Queue Threshold       | `queue_threshold`   | `CONNECTOR_QUEUE_THRESHOLD`   | `500`       | No        | Used to determine the limit (RabbitMQ) in MB at which the connector must go into buffering mode. |
| Log Level             | `log_level`         | `CONNECTOR_LOG_LEVEL`         | /           | Yes       | Determines the verbosity of the logs. Options are `debug`, `info`, `warn`, or `error`.           |

Below are the parameters you'll need to set for CISA Connector:

| Parameter `Cisa`       | config.yml               | Docker environment variable   | Default      | Mandatory | Description                                                                                                              |
|------------------------|--------------------------|-------------------------------|--------------|-----------|--------------------------------------------------------------------------------------------------------------------------|
| Catalog Url            | `catalog_url`            | `CISA_CATALOG_URL`            | /            | Yes       | The URL that hosts the KEV Catalog `https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json` |
| Create Infrastructures | `create_infrastructures` | `CISA_CREATE_INFRASTRUCTURES` | /            | Yes       | Allows you to create or not create an infrastructure in opencti                                                          |
| TLP                    | `tlp`                    | `CISA_TLP`                    | `TLP:CLEAR`  | Yes       | TLP for data coming from this connector                                                                                  |

### Additional information

<!--
Any additional information about this connector
* What information is ingested/updated/changed
* What should the user take into account when using this connector
* ...
-->

