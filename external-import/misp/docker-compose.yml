version: '3'
services:
  connector-misp:
    # image: opencti/connector-misp:latest
    build: .
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=d434ce02-e58e-4cac-8b4c-42bf16748e88
      - CONNECTOR_ID=fae73097-aa2c-4460-96ee-1aa975ce1945 # Optional (default: 'fae73097-aa2c-4460-96ee-1aa975ce1945')
      - CONNECTOR_NAME=MISP # Optional (default: 'MISP')
      - CONNECTOR_SCOPE=misp # Optional (default: 'misp')
      - CONNECTOR_LOG_LEVEL=info # Optional (default: 'error')
      - CONNECTOR_DURATION_PERIOD=PT5M # Optional (default: 5 minutes)
      - MISP_URL=http://example.com
      - MISP_KEY=ChangeMe
      - MISP_SSL_VERIFY=true # Optional (default: false)
      - MISP_CLIENT_CERT= # Optional (default: '')
      - MISP_REFERENCE_URL= # Optional (default: value of `url`)
      - MISP_DATE_FILTER_FIELD=date_from # Optional (default: 'timestamp')
      - MISP_DATETIME_ATTRIBUTE=date # Optional (default: 'timestamp')
      - MISP_CREATE_REPORTS=true # Optional (default: true)
      - MISP_CREATE_INDICATORS=true # Optional (default: true)
      - MISP_CREATE_OBSERVABLES=true # Optional (default: true)
      - MISP_CREATE_OBJECT_OBSERVABLES=true # Optional (default: false)
      - MISP_REPORT_DESCRIPTION_ATTRIBUTE_FILTER= # Optional (default: '', example: "type=comment,category=Internal reference")
      - MISP_CREATE_TAGS_AS_LABELS=true # Optional (default: true)
      - MISP_GUESS_THREATS_FROM_TAGS=false # Optional (default: false)
      - MISP_AUTHOR_FROM_TAGS=false # Optional (default: false)
      - MISP_MARKINGS_FROM_TAGS=false # Optional (default: false)
      - MISP_KEEP_ORIGINAL_TAGS_AS_LABEL="" # Optional (default: '')
      - MISP_ENFORCE_WARNING_LIST=false # Optional (default: false)
      - MISP_REPORT_TYPE=misp-event # Optional (default: 'misp-event')
      - MISP_IMPORT_FROM_DATE=2010-01-01 # Optional (default: '')
      - MISP_IMPORT_TAGS= # Optional (default: '')
      - MISP_IMPORT_TAGS_NOT= # Optional (default: '')
      - MISP_IMPORT_CREATOR_ORGS= # Optional (default: '')
      - MISP_IMPORT_CREATOR_ORGS_NOT= # Optional (default: '')
      - MISP_IMPORT_OWNER_ORGS= # Optional (default: '')
      - MISP_IMPORT_OWNER_ORGS_NOT= # Optional (default: '')
      - MISP_IMPORT_KEYWORD= # Optional (default: '')
      - MISP_IMPORT_DISTRIBUTION_LEVELS=0,1,2,3 # Optional (default: '')
      - MISP_IMPORT_THREAT_LEVELS=1,2,3,4 # Optional (default: '')
      - MISP_IMPORT_ONLY_PUBLISHED=false # Optional (default: false)
      - MISP_IMPORT_WITH_ATTACHMENTS=false # Optional (default: false)
      - MISP_IMPORT_TO_IDS_NO_SCORE=40 # Optional (default: '')
      - MISP_IMPORT_UNSUPPORTED_OBSERVABLES_AS_TEXT=false # Optional (default: false)
      - MISP_IMPORT_UNSUPPORTED_OBSERVABLES_AS_TEXT_TRANSPARENT=true # Optional (default: true)
      - MISP_PROPAGATE_LABELS=false # Optional (default: false)
    restart: always
    networks:
      - filigran_default
networks:
  filigran_default:
    external: true
