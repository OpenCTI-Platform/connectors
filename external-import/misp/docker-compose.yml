version: '3'
services:
  connector-misp:
    image: opencti/connector-misp:latest
    environment:
      - OPENCTI_URL=http://localhost
      - OPENCTI_TOKEN=ChangeMe
      - CONNECTOR_ID=ChangeMe
      - CONNECTOR_NAME=MISP
      - CONNECTOR_SCOPE=misp
      - CONNECTOR_LOG_LEVEL=info
      - CONNECTOR_DURATION_PERIOD=PT5M
      - MISP_URL=http://example.com
      - MISP_KEY=ChangeMe
      - MISP_SSL_VERIFY=true
      - MISP_CLIENT_CERT=
      - MISP_REFERENCE_URL=
      - MISP_DATE_FILTER_FIELD=date_from
      - MISP_DATETIME_ATTRIBUTE=date
      - MISP_CREATE_REPORTS=true
      - MISP_CREATE_INDICATORS=true
      - MISP_CREATE_OBSERVABLES=true
      - MISP_CREATE_OBJECT_OBSERVABLES=true
      - MISP_REPORT_DESCRIPTION_ATTRIBUTE_FILTER=
      - MISP_CREATE_TAGS_AS_LABELS=true
      - MISP_GUESS_THREATS_FROM_TAGS=false
      - MISP_AUTHOR_FROM_TAGS=false
      - MISP_MARKINGS_FROM_TAGS=false
      - MISP_KEEP_ORIGINAL_TAGS_AS_LABEL=
      - MISP_ENFORCE_WARNING_LIST=false
      - MISP_REPORT_TYPE=misp-event
      - MISP_IMPORT_FROM_DATE=2025-06-01
      - MISP_IMPORT_TAGS=
      - MISP_IMPORT_TAGS_NOT=
      - MISP_IMPORT_CREATOR_ORGS=
      - MISP_IMPORT_CREATOR_ORGS_NOT=
      - MISP_IMPORT_OWNER_ORGS=
      - MISP_IMPORT_OWNER_ORGS_NOT=
      - MISP_IMPORT_KEYWORD=
      - MISP_IMPORT_DISTRIBUTION_LEVELS=0,1,2,3
      - MISP_IMPORT_THREAT_LEVELS=1,2,3,4
      - MISP_IMPORT_ONLY_PUBLISHED=false
      - MISP_IMPORT_WITH_ATTACHMENTS=false
      - MISP_IMPORT_TO_IDS_NO_SCORE=40
      - MISP_IMPORT_UNSUPPORTED_OBSERVABLES_AS_TEXT=false
      - MISP_IMPORT_UNSUPPORTED_OBSERVABLES_AS_TEXT_TRANSPARENT=true
      - MISP_PROPAGATE_LABELS=false
      - BATCH_CHUNK_SIZE=9999
    restart: always
