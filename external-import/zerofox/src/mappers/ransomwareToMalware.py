from typing import List, Union
from stix2 import Malware as stixMalware, Relationship
from zerofox.domain import Ransomware
from datetime import datetime


def ransomware_to_malware(now: str, entry: Ransomware) -> List[Union[stixMalware, Relationship]]:
    ransomware_name = entry.ransomware_name[0] if entry.ransomware_name and len(
        entry.ransomware_name) > 0 else ""
    ransomware = stixMalware(
        name=f"Ransomware {ransomware_name} -- {entry.sha256}",
        description=f"Ransomware with note -- {entry.ransom_note}",
        labels=entry.tags,
        first_seen=entry.created_at,
        created=now,
        malware_types="ransomware",
        is_family=False,
    )

    return (
        [ransomware]
    )
