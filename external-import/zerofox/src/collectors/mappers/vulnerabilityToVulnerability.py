from typing import List

from stix2 import ExternalReference
from stix2 import Vulnerability as StixVulnerability
from zerofox.domain.vulnerabilities import Vulnerability


def vulnerability_to_vulnerability(
    now: str, entry: Vulnerability
) -> List[StixVulnerability]:
    summary = f"\n\nSummary: {entry.summary}" if entry.summary else ""
    remediation = f"\n\nRemediation: {entry.remediation}" if entry.remediation else ""

    vulnerability = StixVulnerability(
        name=entry.cve,
        description=f"{entry.description}{summary}{remediation}",
        external_references=[
            ExternalReference(source_name="cve", external_id=entry.cve)
        ],
        created=now,
        modified=entry.updated_at,
    )
    return [vulnerability]
