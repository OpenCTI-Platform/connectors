from typing import List

from open_cti import vulnerability
from stix2 import Vulnerability as StixVulnerability
from zerofox.domain.vulnerabilities import Vulnerability


def vulnerability_to_vulnerability(
    created_by, now: str, entry: Vulnerability
) -> List[StixVulnerability]:
    """
    Based on a ZeroFox Vulnerability object, creates a STIX Vulnerability object.
    """
    summary = f"\n\nSummary: {entry.summary}" if entry.summary else ""
    remediation = f"\n\nRemediation: {entry.remediation}" if entry.remediation else ""

    vuln = vulnerability(
        created_by=created_by,
        cve=entry.cve,
        description=f"{entry.description}{summary}{remediation}",
        created=now,
        modified=entry.updated_at,
    )
    return [vuln]
