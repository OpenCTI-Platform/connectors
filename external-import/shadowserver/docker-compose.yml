version: "3"
services:
  connector:
    image: opencti/connector-shadowserver:6.6.11
    environment:
      # OpenCTI configuration
      OPENCTI_URL: ${OPENCTI_URL}
      OPENCTI_TOKEN: ${OPENCTI_TOKEN}
      # Common connector configuration
      CONNECTOR_ID: ${CONNECTOR_ID}
      CONNECTOR_LOG_LEVEL: ${CONNECTOR_LOG_LEVEL}
      CONNECTOR_DURATION_PERIOD: ${CONNECTOR_DURATION_PERIOD}
      CONNECTOR_NAME: ${CONNECTOR_NAME}
      CONNECTOR_SCOPE: ${CONNECTOR_SCOPE}
      # Deprecated configuration
      CONNECTOR_RUN_EVERY: ${CONNECTOR_RUN_EVERY} # Deprecated, use CONNECTOR_DURATION_PERIOD instead
      # Connector configuration
      SHADOWSERVER_API_KEY: ${SHADOWSERVER_API_KEY}
      SHADOWSERVER_API_SECRET: ${SHADOWSERVER_API_SECRET}
      SHADOWSERVER_MARKING: ${SHADOWSERVER_MARKING}
      SHADOWSERVER_CREATE_INCIDENT: ${SHADOWSERVER_CREATE_INCIDENT}
      SHADOWSERVER_INCIDENT_SEVERITY: ${SHADOWSERVER_INCIDENT_SEVERITY}
      SHADOWSERVER_INCIDENT_PRIORITY: ${SHADOWSERVER_INCIDENT_PRIORITY}
