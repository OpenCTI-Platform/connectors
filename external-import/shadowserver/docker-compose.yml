version: '3'
services:
  connector-shadowserver:
    image: opencti/connector-shadowserver:latest
    environment:
      # OpenCTI configuration
      - OPENCTI_URL=http://localhost
      - OPENCTI_TOKEN=ChangeMe
      # Common connector configuration
      - CONNECTOR_ID=ChangeMe
      - CONNECTOR_NAME=Shadowserver
      - CONNECTOR_SCOPE=shadowserver
      - CONNECTOR_LOG_LEVEL=error
      - CONNECTOR_DURATION_PERIOD=PT1H
      # Connector configuration
      - SHADOWSERVER_API_KEY=ChangeMe
      - SHADOWSERVER_API_SECRET=ChangeMe
      - SHADOWSERVER_MARKING=TLP:AMBER
      - SHADOWSERVER_CREATE_INCIDENT=false
      - SHADOWSERVER_INCIDENT_SEVERITY=medium
      - SHADOWSERVER_INCIDENT_PRIORITY=P2
      - SHADOWSERVER_MAX_THREADS=8
      - SHADOWSERVER_REPORT_TYPES=
      - SHADOWSERVER_INITIAL_LOOKBACK=30
      - SHADOWSERVER_LOOKBACK=3
    restart: always
