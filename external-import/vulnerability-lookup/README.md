# CIRCL CVE Vulnerability Lookup Connector

This OpenCTI connector integrates with the [CIRCL Vulnerability API](https://vulnerability.circl.lu/) and the CISA Known Exploited Vulnerabilities feed. It enriches your threat intelligence platform by ingesting:

- **Vulnerability** entities (CVE)
- **CVSS** scoring details
- **CWE** labels from problem types
- **Software** observables using CPE strings
- **`has` Relationships** between software and vulnerabilities
- **Sighting** relationships (seen, exploited, patched, etc.)
- **Organizational Identities** for reported sightings


---
### **!!! The image will need to be built locally as it is not published to docker/opencti repo yet !!!**

## üöß Docker Compose Example

```yaml
version: '3'
services:
  connector-vulnerability-lookup:
    image: your-custom-image-name:latest
    container_name: connector-vulnerability-lookup
    restart: always
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=CHANGE_ME
      - CONNECTOR_ID=auto
      - CONNECTOR_TYPE=EXTERNAL_IMPORT
      - CONNECTOR_NAME=CIRCL Vulnerability Lookup
      - CONNECTOR_SCOPE=cve
      - CONNECTOR_RUN_INTERVAL=360
      - CONNECTOR_CONFIDENCE_LEVEL=70
      - CONNECTOR_LOG_LEVEL=info
      - CONNECTOR_MARKING_DEFINITION=CHANGE_ME
      - CIRCL_API_URL=https://vulnerability.circl.lu/api
      - CIRCL_KEV_LIST_URL=https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json
      - CIRCL_VENDOR_FILTERS=Microsoft,Adobe,Cisco
      - CIRCL_USE_VENDOR_FILTERING=false
    volumes:
      - ./path/to/config.yml:/opt/opencti-vulnerability-lookup/config.yml
```

---

## ‚öôÔ∏è Configuration Options

You can configure via **environment variables** or a `config.yml` file.

### Required
| Variable | Description |
|----------|-------------|
| `OPENCTI_URL` | OpenCTI API base URL |
| `OPENCTI_TOKEN` | API token for authentication |
| `CONNECTOR_MARKING_DEFINITION` | Marking definition ID to apply |

### Optional
| Variable | Description | Default |
|----------|-------------|---------|
| `CONNECTOR_RUN_INTERVAL` | Minutes between connector runs | 360 |
| `CONNECTOR_CONFIDENCE_LEVEL` | Confidence score for created objects | 50 |
| `CIRCL_API_URL` | CIRCL API base | `https://vulnerability.circl.lu/api` |
| `CIRCL_KEV_LIST_URL` | CISA KEV list URL | Provided by default |
| `CIRCL_VENDOR_FILTERS` | Comma-separated vendor filters | [] |
| `CIRCL_USE_VENDOR_FILTERING` | Enable vendor filtering logic | false |

---

## üëÄ Features
- Enriches OpenCTI with CVE and software relationship data.
- Adds CVSS3 scoring including parsed vector components.
- Applies CWE tags for known problem types.
- Fetches and links real-world sightings as STIX `Sighting` objects.
- Deduplicates software entities using cache logic.

---

## ‚ö†Ô∏è Notes
- For best results, ensure `CONNECTOR_MARKING_DEFINITION` and `OPENCTI_TOKEN` are set.
- Custom STIX properties (like CPE) use the OpenCTI schema.
- Labeling and sightings automatically generate related identities and labels.

---

## üéì Resources
- CIRCL API: https://vulnerability.circl.lu/api
- CISA KEV Feed: https://www.cisa.gov/known-exploited-vulnerabilities
- OpenCTI Docs: https://www.opencti.io/docs/

---

Happy threat hunting! ‚ú®


