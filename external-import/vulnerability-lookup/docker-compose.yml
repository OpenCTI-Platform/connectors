services:
  connector-vulnerability-lookup:
    build:
      context: .
    image: opencti/connector-vulnerability-lookup
    environment:
      - OPENCTI_URL=http://opencti:8080
      - OPENCTI_TOKEN=changeme
      - CONNECTOR_ID=changeme
      - CONNECTOR_TYPE=EXTERNAL_IMPORT
      - "CONNECTOR_NAME=Vulnerability Lookup CVE Connector"
      - CONNECTOR_SCOPE=cve
      - CONNECTOR_RUN_INTERVAL=1440  # daily
      - CONNECTOR_CONFIDENCE_LEVEL=70
      - CONNECTOR_MARKING_DEFINITION=changeme
      - CONNECTOR_LOG_LEVEL=info
      - CIRCL_API_URL=https://vulnerability.circl.lu/api
      - CIRCL_KEV_LIST_URL=https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json
      - USE_VENDOR_FILTERING=false # or true
      - CIRCL_VENDOR_FILTERS=Microsoft,Adobe,Cisco #filter vendor
    restart: always
networks:
  default:
    external: true
    name: opencti_default