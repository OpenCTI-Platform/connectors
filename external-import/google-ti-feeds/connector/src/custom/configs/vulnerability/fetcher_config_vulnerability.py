"""GTI fetcher configurations for vulnerabilities.

This module defines configurations for fetching vulnerability entities
from the Google Threat Intelligence API using the generic fetcher system.
"""

from connector.src.custom.exceptions import (
    GTIVulnerabilityFetchError,
)
from connector.src.custom.models.gti.gti_vulnerability_model import (
    GTIVulnerabilityData,
    GTIVulnerabilityResponse,
)
from connector.src.utils.fetchers.generic_fetcher_config import GenericFetcherConfig

GTI_VULNERABILITY_FETCHER_CONFIG = GenericFetcherConfig(
    entity_type="vulnerabilities",
    endpoint="/collections/{entity_id}",
    display_name="vulnerabilities",
    exception_class=GTIVulnerabilityFetchError,
    response_model=GTIVulnerabilityData,
    method="GET",
    headers={"accept": "application/json"},
    timeout=60.0,
    response_key="data",
)

GTI_MAIN_VULNERABILITY_FETCHER_CONFIG = GenericFetcherConfig(
    entity_type="vulnerabilities",
    endpoint="/collections",
    display_name="Vulnerabilities",
    exception_class=GTIVulnerabilityFetchError,
    response_model=GTIVulnerabilityResponse,
    method="GET",
    headers={"accept": "application/json"},
    timeout=60.0,
    response_key=None,
)

VULNERABILITY_FETCHER_CONFIGS = {
    "vulnerabilities": GTI_VULNERABILITY_FETCHER_CONFIG,
    "main_vulnerabilities": GTI_MAIN_VULNERABILITY_FETCHER_CONFIG,
}
