"""Exception for errors when converting GTI malware families to STIX malware objects."""

from typing import Optional

from connector.src.custom.exceptions.convert_errors.gti_entity_conversion_error import (
    GTIEntityConversionError,
)


class GTIMalwareConversionError(GTIEntityConversionError):
    """Exception raised when there's an error converting a GTI malware family to STIX format."""

    def __init__(
        self,
        message: str,
        malware_id: Optional[str] = None,
        malware_name: Optional[str] = None,
    ):
        """Initialize the exception.

        Args:
            message: Error message
            malware_id: ID of the malware family that failed to convert
            malware_name: Name of the malware family, if available

        """
        super().__init__(message, malware_id, "Malware")
        self.malware_name = malware_name

        if malware_name and not self.args[0].endswith(f"(name: {malware_name})"):
            self.args = (f"{self.args[0]} (name: {malware_name})",)
